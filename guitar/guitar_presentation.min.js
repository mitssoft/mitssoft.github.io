var zd={},Ed;for(Ed in window)zd[Ed]=!0;var b4w="object"===typeof b4w?b4w:function(a){var n={};a.module=n;var k={};a.ha=function(a,e){var y=n[a];y&&(y.vk=null);k[e||"__b4w_default"]=null};a.register=function(a,e){n[a]||(n[a]=e)};a.require=function(a,e){if(!n[a])throw Error('Module "'+a+'" not found');e=e||"__b4w_default";k[e]||(k[e]=function(a){return function(b){var e=n[b];if(!e)throw Error('Module "'+b+'" not found');e.vk||(e.vk={});e.vk[a]||(e.vk[a]={},e(e.vk[a],k[a]));return e.vk[a]}}(e));return k[e](a)};a.module_check=function(a){return n[a]?
!0:!1};a.get_namespace=function(a){for(var e in k)if(k[e]==a)return e;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.app=function(a,n){function k(){var a=p.lo();document.addEventListener("visibilitychange",function(){document.hidden?(a=p.lo(),p.pause()):a||p.nh()},!1)}function b(){var a=0,c=d.le(),h=p.lo(),m=!0;p.Om(function(){if(0==a%10){var d=c.getBoundingClientRect();d.top>window.innerHeight||0>d.bottom?(m&&(h=p.lo()),p.pause(),m=!1):h||m||(p.nh(),m=!0)}a++})}function e(a,c,h,m){var b=document.createElement("canvas"),e=document.getElementById(a);b.style.position="absolute";b.style.left=0;b.style.top=
0;b.style.width=e.offsetWidth+"px";b.style.height=e.offsetHeight+"px";b.width=e.offsetWidth*window.devicePixelRatio;b.height=e.offsetHeight*window.devicePixelRatio;c?(c=document.createElement("canvas"),c.style.position="absolute",b.style.left=0,b.style.top=0,c.style.pointerEvents="none"):c=null;e||(G.error('Warning: canvas container "'+a+'" not found, appending to body'),e=document.body);e.appendChild(b);if(!p.yf(b,c))return h&&F("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
m),!1;c&&d.rr(c,"LAST");return!0}function y(a,c){a?(c&&(document.getElementById(c).style.display="block"),m=document.getElementById(a)):(m=document.createElement("div"),m.innerHTML=0,m.style.cssText="position:absolute;top: 23px;right: 20px;font-size: 45px;line-height: 50px;font-weight: bold;color: #000;",d.rr(m,"JUST_AFTER_CANVAS"))}function g(a,d){var c=String(a);d&&(c+="/"+String(d));m.innerHTML=c}function B(a){a=document.getElementById(a);var d=a.cloneNode(!0);a.parentNode.replaceChild(d,a);return d}
function w(a,d,c){var h=Math.max(C.sP(a),1),m=z.fl(a,Y);d=q.Cb(m,d,W);d[1]=0;D.normalize(d,d);D.scale(d,h*c,d);c=z.xf(a,Z);D.add(c,d,c);C.kc(a,c)}function t(a,d){var c=C.qE(a,ha);if(c.up!=c.down){var h=C.cl(a,ja)[1],c=(c.down-h)/(c.down-c.up),h=C.pE(a,ha),c=Math.max(c,2/h.max);C.rE(a,0,c*d)}}function f(a,d,c,h){z.Ef(a,5*d,5*c,5*h)}function r(a,d,c){var h=C.cz(a),m=Math.abs(d);c=Math.pow(m*c,1-Math.pow(m*c,.15));z.Ef(a,0,0>d?.001<h?-h*c:0:c/(1-c)*h,0)}function l(a,d,c,h){for(var m=c*d;0<a;--a)c+=m,
h+=m,m=c*d;return h}function A(a,d,c,h,m){m?(m=C.bT(a,W),a=C.xf(a),a=D.dist(m,a)+h,h=0<d?l(d,-c,a,h):l(-d,c/(1-c),a,h)):h-=2*d*c;return h}function x(a,d,m,b,e){function v(a,d,c,xa){if(1==c){C.gg(a,F);var m=H?.003*F.trans:.003*F.rot;c=h.Xe(a,d,0);h.fg(a,d,0)===h.Lp?(lb+="X"==xa?-c*m:0,ib+="Y"==xa?-c*m:0):h.fg(a,d,0)===h.Jp&&(a=H?.003*F.rot:7.5E-4*F.trans,Sb+="X"==xa?-c*a:0,Yb+="Y"==xa?-c*a:0)}}function p(a){C.gg(a,F);nb-=.05*F.zoom}function l(a){C.gg(a,F);Db-=.002*F.trans}function g(a){C.gg(a,F);nb+=
.05*F.zoom}function k(a){C.gg(a,F);Db+=.002*F.trans}function G(a,d,c,xa){if(1==c){c=h.Xe(a,d,1);C.gg(a,F);if(H)m=.003*F.trans,b=7.5E-4*F.rot;else var m=.003*F.rot,b=7.5E-4*F.trans;if(1===h.fg(a,d,0))Ha+="X"==xa?-c*m:0,Ma+="Y"==xa?-c*m:0;else if(2===h.fg(a,d,0)||3===h.fg(a,d,0))fb+="X"==xa?-c*b:0,ta+="Y"==xa?-c*b:0}}function S(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function P(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function x(a){return a[0]&&(a[1]||-.1>a[2])}function y(a){return a[0]&&(a[1]||.1<a[2])}
function M(a){return a[0]&&(a[1]||a[2]||a[3])}function T(a,d,c){if(1==c)switch(c=h.Xe(a,d,0),C.gg(a,F),d){case "FORWARD":O?ha[0]=1:H?(d=C.cl(a,ja)[1],d=Math.abs(d)>=Math.PI/4?q.Mi:q.md,w(a,d,.5*F.trans*c)):Y?r(a,-F.zoom,c):f(a,0,-F.trans*c,0);break;case "BACKWARD":O?ha[0]=-1:H?(d=C.cl(a,ja)[1],d=Math.abs(d)>=Math.PI/4?q.lf:q.uc,w(a,d,.5*F.trans*c)):Y?r(a,F.zoom,c):f(a,0,F.trans*c,0);break;case "UP":H?t(a,30*-F.zoom*c):O||f(a,0,0,-F.trans*c);break;case "DOWN":H?t(a,30*F.zoom*c):O||f(a,0,0,F.trans*
c);break;case "LEFT":O?ha[1]=1:H?w(a,q.vt,.5*F.trans*c):f(a,-F.trans*c,0,0);break;case "RIGHT":O?ha[1]=-1:H?w(a,q.Ke,.5*F.trans*c):f(a,F.trans*c,0,0);break;case "ROT_LEFT":Y?C.Yo(a,.75*-F.rot*c,0):C.Ln(a,.75*F.rot*c,0);break;case "ROT_RIGHT":Y?C.Yo(a,.75*F.rot*c,0):C.Ln(a,.75*-F.rot*c,0);break;case "ROT_UP":Y?C.Yo(a,0,.75*-F.rot*c):C.Ln(a,0,.75*F.rot*c);break;case "ROT_DOWN":Y?C.Yo(a,0,.75*F.rot*c):C.Ln(a,0,.75*-F.rot*c)}else switch(d){case "FORWARD":case "BACKWARD":O&&(ha[0]=0);break;case "LEFT":case "RIGHT":O&&
(ha[1]=0)}O&&(N.ry(O,ha[0],ha[1]),a=C.Vq(a,X),N.ys(O,a[0],a[1]))}V=a;Q=d;R=m;var B=u.uw();L(B);var Y=!1,O=null,H=!1;switch(C.Uh(B)){case C.bb:Y=!a;break;case C.wc:O=u.sD();break;case C.Uf:return;case C.xc:H=!0}var F=C.gg(B,ia);a=h.yq();if(N.Ow(B)){var J=h.Dv(B,null,!0);h.ja(B,"CAMERA_COLLISION",h.Bg,[J],null,function(a,d){var c=h.fg(a,d,0).coll_dist;if(0>c){var xa=h.fg(a,d,0).coll_norm,m=W;D.scale(xa,-.25*c,m);c=z.xf(a,Z);D.add(c,m,c);z.nS(a,c)}})}if(O){var J=z.xf(B),n=z.fl(B),n=q.kv(n);J[1]-=.5;
N.Es(O,J,n);K.VK(B,O);var ha=new Float32Array(2),Fa=!0;N.xs(O,N.Oz);h.Kk(B,"TOGGLE_CHAR_MOVE_TYPE",h.mf,h.fJ,function(){Fa=!Fa;N.xs(O,Fa?N.Oz:N.HI)})}var Ia=c.dM(),J=Ia.length?Ia[Ia.length-1]:0,sa,wa,Ba,Ka,Ja,La;d?sa=wa=Ba=Ka=Ja=La=d=J=h.Ev(0):(sa=h.dc(h.dA),wa=h.dc(h.bA),Ba=h.dc(h.Xz),Ka=h.dc(h.Yz),Ja=h.dc(h.lJ),La=h.dc(h.gJ),d=h.zq(c.Bp,J),J=h.zq(c.Cp,J));var xa=h.dc(h.cA),ab=h.dc(h.Zz),Kb=h.dc(h.$z),na=h.dc(h.aA),n=h.Jk(c.xp,Ia),Lb=h.Jk(c.yp,Ia),qa=h.Jk(c.zp,Ia),Ia=h.Jk(c.Ap,Ia);H||(h.ja(B,"FORWARD",
h.Ua,[a,sa,Lb],x,T),h.ja(B,"BACKWARD",h.Ua,[a,wa,Lb],y,T));Y?(h.ja(B,"ROT_UP",h.Ua,[a,xa,Ja,Ia],S,T),h.ja(B,"ROT_DOWN",h.Ua,[a,ab,La,Ia],P,T),h.ja(B,"ROT_LEFT",h.Ua,[a,Kb,Ba,qa],S,T),h.ja(B,"ROT_RIGHT",h.Ua,[a,na,Ka,qa],P,T)):H?(h.ja(B,"LEFT",h.Ua,[a,Kb,Ba,n],S,T),h.ja(B,"RIGHT",h.Ua,[a,na,Ka,n],P,T),h.ja(B,"FORWARD",h.Ua,[a,xa,sa,Lb],S,T),h.ja(B,"BACKWARD",h.Ua,[a,ab,wa,Lb],P,T),h.ja(B,"UP",h.Ua,[a,La,Ia],y,T),h.ja(B,"DOWN",h.Ua,[a,Ja,Ia],x,T)):(h.ja(B,"UP",h.Ua,[a,Ja,d],M,T),h.ja(B,"DOWN",h.Ua,
[a,La,J],M,T),h.ja(B,"LEFT",h.Ua,[a,Ba,n],x,T),h.ja(B,"RIGHT",h.Ua,[a,Ka,n],y,T),h.ja(B,"ROT_UP",h.Ua,[a,xa,Ia],x,T),h.ja(B,"ROT_DOWN",h.Ua,[a,ab,Ia],y,T),h.ja(B,"ROT_LEFT",h.Ua,[a,Kb,qa],x,T),h.ja(B,"ROT_RIGHT",h.Ua,[a,na,qa],y,T));if(!m){var Ga=0;m=h.Hv(b);var Oa=0,Ia=h.Jv(b);h.ja(B,"MOUSE_WHEEL",h.Ag,[m],null,function(a,d,c){1==c&&(d=h.Xe(a,d,0),C.gg(a,F),Y||H?Ga=A(a,d,F.zoom,Ga,Y):(F.trans*=1+d*F.zoom,C.oS(a,F)))});h.ja(B,"TOUCH_ZOOM",h.Ag,[Ia],null,function(a,d,c){1==c&&(c=h.Xe(a,d,0),C.gg(a,
F),h.fg(a,d,0)===h.Kp&&(Oa=A(a,c,.03*F.zoom,Oa,Y)))});h.ja(B,"ZOOM_INTERPOL",h.Bg,[a],null,function(a,d){if(Y||H)if(1E-5<Math.abs(Ga)||1E-5<Math.abs(Oa)){var c=h.Xe(a,d,0),xa=q.lc(Ga,0,c,.1*I);Ga-=xa;c=q.lc(Oa,0,c,.15*I);Oa-=c;H?t(a,-(xa+c)):(xa=C.cz(a)+xa+c,xa=Math.max(xa,.001),C.dT(a,xa))}else Oa=Ga=0})}var Ha=0,Ma=0,fb=0,ta=0,Db=0,nb=0;Y?(h.ja(B,"GMPD_PAN_Y_POS",h.Ua,[d],null,g),h.ja(B,"GMPD_PAN_Y_NEG",h.Ua,[J],null,p),h.ja(B,"GMPD_PAN_X_POS",h.Ua,[n],function(a){return-.1>a[0]},l),h.ja(B,"GMPD_PAN_X_NEG",
h.Ua,[n],function(a){return.1<a[0]},k)):H&&(h.ja(B,"GMPD_PAN_X_POS",h.Ua,[qa],function(a){return-.1>a[0]},l),h.ja(B,"GMPD_PAN_X_NEG",h.Ua,[qa],function(a){return.1<a[0]},k));if(e){e=h.Lk("X",window);m=h.Lk("Y",window);d=h.on(b);var J=h.on(window),fc=!1,n=function(a){a[2]?fc=!0:a[0]||(fc=!1);return fc&&a[0]};h.ja(B,"MOUSE_X",h.Bg,[J,e,d],n,G,"X");h.ja(B,"MOUSE_Y",h.Bg,[J,m,d],n,G,"Y");e=c.da(c.Nc,window);c.az(e,!1)}else e=h.Lk("X",b),m=h.Lk("Y",b),d=h.on(b),h.ja(B,"MOUSE_X",h.Ag,[d,e],null,G,"X"),
h.ja(B,"MOUSE_Y",h.Ag,[d,m],null,G,"Y");var lb=0,ib=0,Sb=0,Yb=0;e=h.Bq("X",b);b=h.Bq("Y",b);h.ja(B,"TOUCH_X",h.Ag,[e],null,v,"X");h.ja(B,"TOUCH_Y",h.Ag,[b],null,v,"Y");h.ja(B,"ROT_TRANS_INTERPOL",h.Bg,[a],null,function(a,d){if(1E-5<Math.abs(Ha)||1E-5<Math.abs(Ma)||1E-5<Math.abs(lb)||1E-5<Math.abs(ib)||1E-5<Math.abs(fb)||1E-5<Math.abs(ta)||1E-5<Math.abs(Sb)||1E-5<Math.abs(Yb)||1E-5<Math.abs(Db)||1E-5<Math.abs(nb)){var c=h.Xe(a,d,0),xa=q.lc(Ha,0,c,.08*I),m=q.lc(Ma,0,c,.08*I);Ha-=xa;Ma-=m;var b=q.lc(lb,
0,c,.12*I),e=q.lc(ib,0,c,.12*I);lb-=b;ib-=e;var f=q.lc(fb,0,c,.08*I),z=q.lc(ta,0,c,.08*I);fb-=f;ta-=z;var D=q.lc(Sb,0,c,.12*I),v=q.lc(Yb,0,c,.12*I);Sb-=D;Yb-=v;var p=q.lc(Db,0,c,.08*I),c=q.lc(nb,0,c,.08*I);Db-=p;nb-=c;Y?(C.Yo(a,xa+b,m+e),m=C.cz(a),C.cT(a,m*(f+D+p),m*(z+v+c))):H?(xa+b&&w(a,q.Ke,.2*(xa+b)),m+e&&(z=C.cl(a,ja)[1],w(a,Math.abs(z)>Math.PI/4?q.lf:q.uc,.2*(m+e))),C.rE(a,f+D+p,0)):(C.Ln(a,.5*(xa+b),.5*(m+e)),O&&(f=C.Vq(a,X),N.ys(O,f[0],f[1])))}});h.Kk(B,"DEC_STEREO_DIST",h.mf,h.jJ,function(a){var d=
C.RD(a);C.RG(a,.9*d)});h.Kk(B,"INC_STEREO_DIST",h.mf,h.mJ,function(a){var d=C.RD(a);C.RG(a,1.1*d)})}function L(a){var d=C.Uh(a),c=h.Cv(function(){var c=C.Uh(a),m=c!=d;d=c;return m});h.ja(a,"CHANGE_MOVE_STYLE",h.Bg,[c],null,function(){M();x(V,Q,R)})}function M(){for(var a=u.uw(),d="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE".split(" "),c=0;c<d.length;c++)h.Ko(a,d[c]);
C.Uh(a)==C.wc&&u.sD()&&K.remove(a)}function F(a,d,c,m){var h=document.createElement("div"),b=document.createElement("div"),e=document.createElement("div");if(m)for(var f=0;f<m.length;f++){var z=document.getElementById(m[f]);z&&z.parentNode.removeChild(z)}h.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";b.style.cssText="color:#fff;font-size:24px;";e.style.cssText="color:#fff;font-size:20px;";b.innerHTML=a;e.innerHTML=d+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
c+'">'+c.replace("https://www.","")+"</a>";h.appendChild(b);h.appendChild(e);document.body.appendChild(h)}function J(a,d,c,m,h){function b(){var f=performance.now()-e;h(d+f*(c-d)/m);(f>=m||!a.parentNode)&&p.mR(b)}var e=performance.now();p.Om(b)}n("animation");var C=n("camera"),H=n("config"),K=n("constraints"),d=n("container"),h=n("controls"),v=n("data"),P=n("debug"),c=n("input"),p=n("main"),N=n("physics"),G=n("print"),u=n("scenes"),z=n("transform"),q=n("util"),D=n("vec3"),I=1,m=null,V=!1,Q=!1,R=!1,
X=new Float32Array(2),ja=new Float32Array(2),W=new Float32Array(3),Z=new Float32Array(3);new Float32Array(3);var Y=new Float32Array(4),ia={},ha={};a.yf=function(a){function c(){var a=e(D,w,G,q),m=d.Wq();if(a){var h=d.le();d.mi();r&&(y(I,u),p.TR(g));S&&(k(),b());l&&p.Om(function(){h.style.height=h.clientWidth/l+"px"});z&&p.Om(d.mi);t&&p.Om(function(){d.mw()});f(m,!0)}else f(m,!1)}function m(a){a.keyCode==h.kJ&&(p.lo()?p.nh():p.pause())}function f(){}a=a||{};var z=!1,D=null,q=null,I=null,l=0,u=null,
V=!0,S=!0,G=!0,Q=!1,r=!1,A=!1,t=!1,K;for(K in a)switch(K){case "canvas_container_id":D=a.canvas_container_id;break;case "callback":f=a.callback;break;case "autoresize":z=a.autoresize;break;case "do_not_use_onload":break;case "show_hud_debug_info":A=a.show_hud_debug_info;break;case "sfx_mix_mode":Q=a.sfx_mix_mode;break;case "show_fps":r=a.show_fps;break;case "track_container_position":t=a.track_container_position;break;case "fps_wrapper_id":u=a.fps_wrapper_id;break;case "fps_elem_id":I=a.fps_elem_id;
break;case "error_purge_elements":q=a.error_purge_elements;break;case "report_init_failure":G=a.report_init_failure;break;case "pause_invisible":S=a.pause_invisible;break;case "key_pause_enabled":V=a.key_pause_enabled;break;case "force_container_ratio":l=a.force_container_ratio;break;default:H.set(K,a[K])}V&&document.addEventListener("keydown",m,!1);H.set("show_hud_debug_info",A);H.set("sfx_mix_mode",Q);var w=A||Q||null;"complete"==document.readyState?window.setTimeout(c,0):window.addEventListener("load",
c,!1);window.addEventListener("unload",function(){v.ha()},!1)};a.mi=function(){G.kb("app.resize_to_container","container.resize_to_container");d.mi()};a.l1=function(a,d){var c=B(a);c.addEventListener("mouseup",function(){d(c.value)},!1)};a.k1=function(a,d){var c=B(a);c.addEventListener("change",function(){var a=c.checked;d(void 0!=a?a:c.value)},!1)};a.m1=function(a,d){var c=B(a);c.addEventListener("keypress",function(a){d(a.keyCode,c.value)},!1)};a.ON=x;a.CX=M;a.O0=function(a){G.ag("app.set_camera_move_style",
["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var d=u.uw();C.zy(d,a)};a.OX=function(a){function d(a){return a[0]&&(a[1]||a[2])}function c(a,d,b){if(1==b)switch(b=h.Xe(a,d,0),d){case "FORWARD":m?N.um(a,1):z.Ef(a,0,0,1*b);break;case "BACKWARD":m?N.um(a,-1):z.Ef(a,0,0,-1*b);break;case "LEFT":m?N.tm(a,-1):z.Ef(a,1*b,0,0);break;case "RIGHT":m?N.tm(a,1):z.Ef(a,-1*b,0,0)}else switch(d){case "FORWARD":case "BACKWARD":m&&N.um(a,0);break;case "LEFT":case "RIGHT":m&&
N.tm(a,0)}}var m=N.Fd(a)||N.Gd(a),b=h.yq(),e=h.dc(h.dA),f=h.dc(h.bA),D=h.dc(h.Xz),v=h.dc(h.Yz),q=h.dc(h.cA),I=h.dc(h.Zz),p=h.dc(h.$z),l=h.dc(h.aA);h.ja(a,"FORWARD",h.Ua,[b,e,q],d,c);h.ja(a,"BACKWARD",h.Ua,[b,f,I],d,c);h.ja(a,"LEFT",h.Ua,[b,D,p],d,c);h.ja(a,"RIGHT",h.Ua,[b,v,l],d,c)};a.EX=function(a){for(var d=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<d.length;c++)h.Ko(a,d[c])};a.MX=function(){G.fc("app.enable_controls() deprecated")};a.DX=function(){G.fc("app.disable_controls() deprecated")};a.NX=
function(){h.Kk(null,"CAMERA_SHOT",h.mf,h.hJ,function(){P.pQ()});h.Kk(null,"LIGHT_SHOT",h.mf,h.iJ,function(){P.sQ()});h.Kk(null,"TELEMETRY",h.mf,h.nJ,function(){P.Ox()})};a.C0=function(a,d,c){function m(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?d():(document.removeEventListener("fullscreenchange",m,!1),document.removeEventListener("webkitfullscreenchange",m,!1),document.removeEventListener("mozfullscreenchange",
m,!1),document.removeEventListener("MSFullscreenChange",m,!1),c())}d=d||function(){};c=c||function(){};document.addEventListener("fullscreenchange",m,!1);document.addEventListener("webkitfullscreenchange",m,!1);document.addEventListener("mozfullscreenchange",m,!1);document.addEventListener("MSFullscreenChange",m,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():G.error("B4W App: request fullscreen method is not supported")};
a.VX=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof a&&G.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.YW=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.B0=F;a.HZ=function(a){a=!!a;var d=decodeURIComponent(location.href.toString());if(-1==
d.indexOf("?"))return null;for(var d=d.split("?")[1].split("&"),c={},m=0;m<d.length;m++){var h=d[m].split("="),b=h[0];1<h.length?(h=h[1],a?b in c?c[b].push(h):c[b]=[h]:c[b]=h):a?b in c||(c[b]=[]):c[b]=""}return c};a.oN=function(a,d,c,m,h,b,e,f){function z(h){a&&(D[d]=b+h+e,c>m&&h<=m||c<m&&h>=m)&&(D[d]=b+m+e,f())}if(a&&d&&isFinite(c)&&isFinite(m)&&isFinite(h)){b=b||"";e=e||"";f=f||function(){};var D=a.style,v=d.charAt(0).toUpperCase()+d.slice(1);if(void 0==D[d])if(void 0!=D["webkit"+v])d="webkit"+
v;else if(void 0!=D["ms"+v])d="ms"+v;else if(void 0!=D["moz"+v])d="moz"+v;else return;J(a,c,m,h,z)}};a.rL=function(a,d,c,m,h,b){function e(h){a&&(0<=h&&a.setAttribute(d,h),c>m&&h<=m||c<m&&h>=m)&&(a.setAttribute(d,m),b())}a&&d&&isFinite(c)&&isFinite(m)&&isFinite(h)&&(b=b||function(){},J(a,c,m,h,e))};a.hR=function(d){if(d.length){var c=d.shift(),m=c.elem,h=c.prop,b=c.from,e=c.to,f=c.duration,z=c.opt_prefix,D=c.opt_suffix,v=function(){c.cb&&c.cb();a.hR(d)};"css"==c.type?a.oN(m,h,b,e,f,z,D,v):"attr"==
c.type&&a.rL(m,h,b,e,f,v)}};a.P0=function(a){I=a};a.yY=function(){return I}};b4w.module.animation=function(a,n){var k=n("__animation"),b=n("__armature"),e=n("__obj_util"),y=n("__print"),g=n("__tsr");a.yc=k.yc;a.tA=k.tA;a.uA=k.uA;a.vA=k.vA;a.wA=k.wA;a.xA=k.xA;a.yA=k.yA;a.Cu=k.Cu;a.Gm=k.Gm;a.lA=k.lA;a.xu=k.xu;a.yu=k.yu;a.oA=k.oA;a.nA=k.nA;a.mA=k.mA;a.Hp=k.Hp;a.Gz=k.Gz;a.Hz=k.Hz;a.st=k.st;var B=g.create();a.Xb=function(a){return k.Xb(a)};a.dD=function(a){return k.BF(a)?k.dD(a):[]};a.EY=function(a,b){if(!k.Xb(a))return null;b=b||k.yc;return k.GO(a,b)};a.apply=function(a,b,e){if(e>
k.Cu)y.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=e||k.yc;if(k.Xb(a)){var g=k.Gw(a,b);if(-1!=g&&g!=e){y.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+g+'").');return}}k.nU(a,b)?k.apply(a,b,e):y.error('No fcurves in action "'+b+'"')}};a.remove=function(a){k.remove(a)};a.jG=function(a,b){k.Xb(a)&&(b=b||k.yc,k.jG(a,b))};a.Zp=function(a){k.Zp(a)};a.play=function(a,b,e){k.Xb(a)?(e=e||k.yc,k.play(a,
b,e),k.JT(a,0,e,!0)):y.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){k.Xb(a)&&(b=b||k.yc,k.stop(a,b))};a.$h=function(a,b){if(!k.Xb(a))return!1;b=b||k.yc;return k.$h(a,b)};a.Tl=function(a,b,e){k.Xb(a)&&(e=e||k.yc,k.Tl(a,b,e))};a.wy=function(a,b){k.Xb(a)&&k.wy(a,b)};a.a1=function(a,b){if(k.Xb(a)){b=b||k.yc;var e=k.xw(a,b),g=k.ww(a,b);k.Tl(a,e+g-k.oJ,b)}};a.Vn=function(a,b){if(!k.Xb(a))return 0;b=b||k.yc;return k.nD(a,b)};a.PG=function(a,b,e){k.Xb(a)&&(e=e||k.yc,k.PG(a,
b||1,e))};a.OD=function(a,b){if(!k.Xb(a))return 0;b=b||k.yc;return a.W[b]?k.OD(a,b):0};a.xw=function(a,b){return k.Xb(a)&&(b=b||k.yc,a.W[b])?k.xw(a,b):-1};a.ww=function(a,b){return k.Xb(a)&&(b=b||k.yc,a.W[b])?k.ww(a,b):-1};a.Qo=function(a,b,e){k.Xb(a)&&(e=e||k.yc,k.Qo(a,b,e))};a.gD=function(a,b){if(!k.Xb(a))return null;b=b||k.yc;return k.gD(a,b)};a.$A=function(a,b,e,g){g=g||k.yc;k.Xb(a)&&k.$A(a,b,e,g)};a.SC=function(a){return k.SC(a)};a.wY=function(a,g,f){y.kb("get_bone_translation","armature.get_bone_tsr");
if(!e.Cj(a))return null;if(!b.YL(a,g))return y.error('There is no bone: "',g,'" in "',a.name,'".'),null;f||(f=new Float32Array(3));b.Uq(a,g,!1,B);f[0]=B[0];f[1]=B[1];f[2]=B[2];return f};a.PY=function(){y.fc("get_first_armature_object() deprecated");return null};a.Gw=function(a,b){return k.Xb(a)&&b?k.Gw(a,b):null};a.eD=function(a,b){return k.Xb(a)?k.eD(a,b):null};a.aB=function(a,b){return k.aB(a,b)};a.DZ=function(a){return a.g.Ih};a.NG=function(a,b,f){e.Cj(a)?(b=Math.min(Math.max(b,0),1),a.g.Ih!=b&&
k.NG(a,b,f||0)):y.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.__animation=function(a,n){function k(a,d){var c=a.W[d];c&&c.jw&&c.In&&(c.In=!1,c.jw(a,d))}function b(a,d,c){c=a.W[c];c.type=30;var m=d.pa,b=d.La-m+1;c.start=m;c.length=b;c.ge=m;c.Eg=d.name;for(b=m=0;b<a.Fc.length;b++){var h=a.Fc[b];if(h==d)break;else m+=h.La-h.pa+1}c.jI=m}function e(a,d){a.type=50;a.Eg=d.name;a.start=d.pa;a.length=d.La-a.start;d.nd||(a.length+=d.gx)}function y(a){return a.replace(/_B4W_BAKED$/,"")}function g(a,d){if(a.animation_data){var c=a.animation_data.action;c&&60==
c.j.type&&d.push(c)}for(var c=a.nodes,m=0;m<c.length;m++){var b=c[m];b.node_group&&(b=b.node_group.node_tree)&&g(b,d)}}function B(a){return V.Pc(a)&&a.g.Fc?!0:!1}function w(a,d,c){var m=a.W;if(-1==c)for(c=0;8>c;c++){var b=m[c];b&&(b.ge=d,f(a,0,c,!0))}else if(b=m[c])b.ge=d,f(a,0,c,!0)}function t(a,d,c){if(-1==d)for(d=0;8>d;d++){var m=a[d];m&&c(m)}else(m=a[d])&&c(m)}function f(a,d,c,m){F(a,d,c,m);k(a,c);a.g.Wi&&(H(a,d),C(a,d))}function r(a,c,m){var b=c.frame_range;if(b[0]>b[1])return X.warn('Incompatible action "'+
c.name+'" has been applied to object "'+a.name+'"'),!1;var h=c.j,e=a.W[m];e.Eg=c.name;e.Hu=b;e.SA=h.MF;e.QA=h.lB;e.Kg.set(h.Kg);e.start=b[0];e.length=b[1]-b[0];e.ge=b[0];switch(h.type){case 10:if(V.Cj(a)){e.type=10;var f=l(a,c);if(!f){for(var f=a.g.Oe,b=[],z=[],D=c.j.Ex,v=0;v<D;v++){for(var q in f){var I=f[q],p=I.$s,g=c.j.dv[q];g?ha.copy(g.subarray(8*v,8*v+8),p):ha.identity(p);I.at=!1}I=K(f);b.push(I.trans);z.push(I.Wa)}f={trans:b,Wa:z};a.wk.push(c,f)}e.trans=f.trans;e.Wa=f.Wa;e=f;f=a.g;q=f.Ns;z=
a.W[m];b=z.Ky;a:{D=f.aH;for(v=0;v<D.length;v+=2)if(c==D[v]){D=D[v+1];break a}D=null}if(D)z.Ky=D;else{for(z=0;z<q.length;z++){for(var D=q[z].Fk,v=[],I=[],p=e.trans,g=e.Wa,u=0;u<p.length;u++){var S=d(p[u],g[u],D);v.push(S.trans);I.push(S.Wa)}b.push({trans:v,Wa:I})}f.aH.push(c,b)}f.Wi&&(c=f.et,m>c[1]?(e=c[1],c[1]=m,c[0]=e):m>c[0]&&m<c[1]&&(c[0]=m),A(a))}break;case 40:V.mo(a)&&(e.volume=h.Ea.volume||null,e.pitch=h.Ea.pitch||null,e.type=40);break;case 70:V.wr(a)&&(e.color=h.Ea.color||null,e.Rg=h.Ea.energy||
null,e.type=70);break;case 60:if("MESH"==a.type){e.type=60;q=l(a,c);if(!q){q=[];b=[];z=[];D=[];v=[];I=c.j;for(f in I.Ea)for(p=c.name+"%join%"+f,g=0;g<a.A.length;g++)for(u=a.A[g].X,S=0;S<u.length;S++){var k=u[S],xa=k.rF,U=k.sF;xa&&(xa=L(f,p,I,b,q,xa),U=L(f,p,I,D,z,U),(xa||U)&&v.push(k))}q={mU:q,values:b,yR:z,zR:D,Qr:v};a.wk.push(c,q)}e.El=q.mU;e.uF=q.values;e.Dl=q.yR;e.tF=q.zR;e.Qr=q.Qr}break;case 20:if(f=h.Ea.tsr){e.type=20;q=l(a,c);if(!q){q=c.j.Ex;b=[];z=[];for(D=0;D<q;D++)b.push(f.subarray(8*D,
8*D+4)),z.push(f.subarray(8*D+4,8*D+8));q={trans:b,Wa:z};a.wk.push(c,q)}e.trans=q.trans;e.Wa=q.Wa;Q.Gx(a)&&Q.UT(a,e.trans[0],e.Wa[0])}else return X.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:V.$w(a)&&(e.Rg=h.Ea["light_settings.environment_energy"]||null,e.ne=h.Ea.horizon_color||null,e.Je=h.Ea.zenith_color||null,e.PC=h.Ea["mist_settings.intensity"]||null,e.NC=h.Ea["mist_settings.depth"]||null,e.QC=h.Ea["mist_settings.start"]||null,e.OC=h.Ea["mist_settings.height"]||
null,e.MC=h.Ea.b4w_fog_color||null,e.type=80)}V.Cj(a)&&10!=h.type&&x(a,m);return!0}function l(a,d){for(var c=a.wk,m=0;m<c.length;m+=2)if(d==c[m])return c[m+1];return null}function A(a){var d=a.g.et;if(-1!=d[0]&&-1!=d[1]){var c=a.W;a=c[d[1]].ge;var m=Math.floor(a),b=a-m,d=c[d[0]];a=d.ge;m=Math.floor(a);d.ge=m+b}}function x(a,d){var c=a.g.et,m=c[1];c[0]=-1;c[1]=-1;if(-1!=d)for(var b=a.W;0<=m;m--){var h=b[m];if(h&&10==h.type)if(m>c[1])c[1]=m;else{m>c[0]&&(c[1]=m);break}}}function L(a,d,c,m,b,h){for(var e=
!1,f=0;f<h.length;f+=2)d==h[f]&&(b.push(h[f+1]),m.push(new Float32Array(c.Ea[a])),e=!0);return e}function M(a){a=a.j;for(var d in a.Ea)if(-1!=d.indexOf("nodes"))return!0;return!1}function F(a,d,c,m){if((c=a.W[c])&&null!=c.type&&(c.play||m)){var b=a.g,h=c.ge,e=c.start,f=c.length,h=h+c.speed*d*Y.Dc(),D=c.type,z=c.speed;if(0<=z&&h>=e+f||0>z&&h<e)switch(m||(c.In=!0),c.behavior){case 10:h=0<=z?(h-e)%f+e:e+f-1E-6;break;case 20:h=0<=z?e:e+f-1E-6;c.play=!1;break;case 30:h=0<=z?e+f-1E-6:e,c.play=!1}c.ge=h;
switch(D){case 10:if(!b.Wi){m=J(c);d=m[0];var v=m[1];m=m[2];b.Kd=c.Wa[d];b.te=c.Wa[v];b.Td=c.trans[d];b.Ee=c.trans[v];b.Ue=m;m=b.Ns;c=c.Ky;for(var q=0;q<m.length;q++){var I=m[q],p=c[q];I.Kd=p.Wa[d];I.te=p.Wa[v];I.Td=p.trans[d];I.Ee=p.trans[v];I.Ue=b.Ue}ia.o(a)}break;case 20:m=J(c);var b=ba,v=m[0],q=m[1],I=m[2],p=c.trans,g=p[v][1],h=p[v][2],e=p[q][1],f=p[q][2];b[0]=(1-I)*p[v][0]+I*p[q][0];b[1]=(1-I)*g+I*e;b[2]=(1-I)*h+I*f;v=ca;h=m[0];q=m[1];I=m[2];p=c.Wa;g=S;g[0]=p[h][0];g[1]=p[h][1];g[2]=p[h][2];
g[3]=p[h][3];h=Aa;h[0]=p[q][0];h[1]=p[q][1];h[2]=p[q][2];h[3]=p[q][3];ja.slerp(g,h,I,v);q=m[2];I=c.trans;m=(1-q)*I[m[0]][3]+q*I[m[1]][3];a.parent&&a.fs&&(q=ra,ha.qh(b,m,v,q),ha.multiply(a.fs,q,q),ha.Vh(q,b),ha.Fw(q,v),m=ha.Oc(q));c.kz&&(q=aa,ia.xf(a,q),ka.Yl(b,q,d,c.kz,b));c.Vx&&(q=S,ia.fl(a,q),ka.fH(v,q,d,c.Vx,v));h=c.Kg;h[0]&&ia.Fs(a,b);h[1]&&ia.Ds(a,v);h[2]&&ia.Ey(a,m);ia.o(a);R.u(a);break;case 30:m=c.ge-c.start;0>m&&(m=0);m>=c.length&&(m=c.length);a=Math.floor(m);d=a+1;m-=a;10!=c.behavior&&d==
c.length&&(d=--a,m=1);c=c.jI;Ca[0]=a+c;Ca[1]=d+c;Ca[2]=m;m=Ca;b.sz=m[0];b.iI=m[2];break;case 40:m=J(c);d=m[0];b=m[1];m=m[2];c.volume&&Z.sS(a,(1-m)*c.volume[d]+m*c.volume[b]);c.pitch&&Z.$Q(a,(1-m)*c.pitch[d]+m*c.pitch[b]);break;case 50:d=10==c.behavior?(h-e)/Y.Dc():h/Y.Dc();Q.lS(a,c.Eg,d);break;case 60:m=J(c);d=m[0];b=m[1];m=m[2];p=c.uF;g=c.El;a=c.tF;v=c.Dl;q=c.Qr;for(c=0;c<g.length;c++)for(h=p[c],I=g[c],e=(1-m)*h[d]+m*h[b],h=0;h<q.length;h++)q[h].Nj[I]=e;for(c=0;c<v.length;c++)for(p=a[c],I=v[c],p=
la.lerp(p.subarray(3*d,3*d+3),p.subarray(3*b,3*b+3),m,ba),h=0;h<q.length;h++)q[h].qe[3*I]=p[0],q[h].qe[3*I+1]=p[1],q[h].qe[3*I+2]=p[2];break;case 70:m=J(c);d=m[0];b=m[1];m=m[2];h=c.Kg;(f=c.Rg)&&h[0]&&E.aS(a.$b,(1-m)*f[d]+m*f[b]);(c=c.color)&&h[1]&&(ba[0]=(1-m)*c[3*d]+m*c[3*b],ba[1]=(1-m)*c[3*d+1]+m*c[3*b+1],ba[2]=(1-m)*c[3*d+2]+m*c[3*b+2],E.$R(a.$b,ba));e=a.A;for(c=0;c<e.length;c++)oa.GT(a,e[c].Ta);break;case 80:m=J(c);d=m[0];b=m[1];m=m[2];h=c.Kg;e=a.A;z=oa.qa(e[0].Ta,"MAIN_OPAQUE");f=c.Rg;f=h[0]?
(1-m)*f[d]+m*f[b]:z.Rg;D=c.ne;h[1]?(ba[0]=(1-m)*D[3*d]+m*D[3*b],ba[1]=(1-m)*D[3*d+1]+m*D[3*b+1],ba[2]=(1-m)*D[3*d+2]+m*D[3*b+2],D=ba):D=z.ne;var u=c.Je;h[2]?(aa[0]=(1-m)*u[3*d]+m*u[3*b],aa[1]=(1-m)*u[3*d+1]+m*u[3*b+1],aa[2]=(1-m)*u[3*d+2]+m*u[3*b+2],z=aa):z=z.Je;u=c.PC;h[3]&&(v=(1-m)*u[d]+m*u[b]);u=c.NC;h[4]&&(q=(1-m)*u[d]+m*u[b]);u=c.QC;h[5]&&(I=(1-m)*u[d]+m*u[b]);u=c.OC;h[6]&&(p=(1-m)*u[d]+m*u[b]);c=c.MC;h[7]&&(ca[0]=(1-m)*c[3*d]+m*c[3*b],ca[1]=(1-m)*c[3*d+1]+m*c[3*b+1],ca[2]=(1-m)*c[3*d+2]+m*c[3*
b+2],g=ca);for(c=0;c<e.length;c++)d=a.A[c].Ta,(h[0]||h[1]||h[2])&&oa.ty(d,f,D,z),h[3]&&oa.RR(d,v),h[4]&&oa.PR(d,q),h[5]&&oa.SR(d,I),h[6]&&oa.QR(d,p),h[7]&&oa.xy(d,g);break;default:ka.l("Unknown animation type:"+D)}}}function J(a){var c=a.Hu[0],d=a.Hu[1]-c,c=a.ge-c;0>c&&(c=0);c>=d&&(c=d);c/=a.SA;d=Math.floor(c);a=a.QA[d]?c-d:0;c=Math.ceil(d+a);Ca[0]=d;Ca[1]=c;Ca[2]=a;return Ca}function C(a,c){var d=a.g,m=d.Ih,b=d.et,h=b[0],b=b[1];if(-1!=b){if(-1!=h){var e=a.W[h];if(e.play||0==c){var f=J(e),D=f[0],
z=f[1];d.Ue=f[2];var f=e.Wa[D],q=e.Wa[z],D=e.trans[D],z=e.trans[z]}else m=1}else m=1;b=a.W[b];if(b.play||0==c){var h=J(b),v=h[0],I=h[1];d.Ue=h[2]}else if(-1!=h&&e.play)m=0;else return;h=b.Wa[v];e=b.Wa[I];v=b.trans[v];I=b.trans[I];if(1==m)d.Kd.set(h),d.te.set(e),d.Td.set(v),d.Ee.set(I);else if(0==m)d.Kd.set(f),d.te.set(q),d.Td.set(D),d.Ee.set(z);else{for(b=0;b<f.length;b+=4){for(var p=ca,g=S,u=0;4>u;u++)p[u]=f[b+u],g[u]=h[b+u];ja.slerp(p,g,m,p);for(u=0;4>u;u++)d.Kd[b+u]=p[u];for(u=0;4>u;u++)p[u]=q[b+
u],g[u]=e[b+u];ja.slerp(p,g,m,p);for(u=0;4>u;u++)d.te[b+u]=p[u]}ka.nB(D,v,m,d.Td);ka.nB(z,I,m,d.Ee)}ia.o(a);da.ST(a)}}function H(a,c){var d=a.g,m=d.Ih,b=d.Mu;if(0!=b){var m=d.Lu-m,h=b*c;ka.sign(m)==ka.sign(b)&&Math.abs(h)<Math.abs(m)?d.Ih+=h:(d.Ih=d.Lu,d.Mu=0)}}function K(a){var c=[],d=[],m=new Float32Array(4),b=new Float32Array(4),h;for(h in a){var e=a[h],f=m,D=b,z=e.kq,q=z[z.length-1],v=q.mz;q.at||ha.identity(v);for(q=z.length-1;0<=q;q--){var I=z[q],p=I.mz;if(I.at)v=p;else{var u=I.Bi,g=I.$s;ha.invert(u,
ra);ha.multiply(g,ra,ra);ha.multiply(u,ra,ra);ha.multiply(v,ra,p);v=p;I.at=!0}}z=I.mz;f[0]=z[0];f[1]=z[1];f[2]=z[2];f[3]=z[3];D[0]=z[4];D[1]=z[5];D[2]=z[6];D[3]=z[7];ja.normalize(D,D);e=e.Lh;for(f=0;4>f;f++)D=4*e+f,c[D]=m[f],d[D]=b[f]}return{trans:c,Wa:d}}function d(a,c,d){var m=[],b=[];new Float32Array(4);new Float32Array(4);for(var h in d)for(var e=d[h],f=e.Lh,e=e.Uv,z=0;4>z;z++){var D=4*e+z,q=4*f+z;m[D]=a[q];b[D]=c[q]}m=new Float32Array(m);b=new Float32Array(b);return{trans:m,Wa:b}}function h(a){var c=
a.j,d;if(c.dv)d=10;else if(c.Ea)if("volume"in c.Ea||"pitch"in c.Ea)d=40;else if(M(a))d=60;else{var m;a:{if(a.j.Ea){m=a.fcurves;for(var b in m)if("color"==b&&!m[b][3]){m=!0;break a}if("energy"==b){m=!0;break a}}m=!1}if(m)d=70;else if(m=a.j.Ea,"light_settings.environment_energy"in m||"horizon_color"in m||"zenith_color"in m||"mist_settings.intensity"in m||"mist_settings.depth"in m||"mist_settings.start"in m||"mist_settings.height"in m||"b4w_fog_color"in m)d=80;else{a:{if(a.j.Ea)for(d in a=a.fcurves,
a)if("location"==d||"rotation_quaternion"==d||"scale"==d){d=!0;break a}d=!1}d=d?20:0}}else d=0;c.type=d}function M(a){if(a=a.j.Ea)for(var c in a)if(-1!=c.indexOf("nodes"))return!0;return!1}function v(a,c){c[0]=c[1]=c[2]=0;for(var d in a)"location"==d?c[0]=1:"rotation_quaternion"==d?c[1]=1:"scale"==d&&(c[2]=1)}function P(a,c){c[0]=c[1]=0;for(var d in a)"energy"==d?c[0]=1:"color"==d&&(c[1]=1)}function c(a,c){c[0]=c[1]=c[2]=0;c[3]=c[4]=c[5]=0;c[6]=c[7]=0;for(var d in a)"light_settings.environment_energy"==
d?c[0]=1:"horizon_color"==d?c[1]=1:"zenith_color"==d?c[2]=1:"mist_settings.intensity"==d?c[3]=1:"mist_settings.depth"==d?c[4]=1:"mist_settings.start"==d?c[5]=1:"mist_settings.height"==d?c[6]=1:"b4w_fog_color"==d&&(c[7]=1)}function p(a,c,d,m,b,h,e){var f=a+(c-a)/2,z=N(f,m,b,h,e)-d;return.02>Math.abs(z)?f:0<z?p(a,f,d,m,b,h,e):p(f,c,d,m,b,h,e)}function N(a,c,d,m,b){var h=1-a;return c*h*h*h+3*d*h*h*a+3*m*h*a*a+b*a*a*a}function G(a,c){var d={type:null,Eg:null,Hu:null,SA:0,QA:null,Kg:new Int8Array(8),Wa:null,
trans:null,Ky:[],play:!1,behavior:20,ge:0,start:0,length:0,kz:0,Vx:0,In:!1,jI:null,speed:1,volume:null,pitch:null,color:null,Rg:null,Je:null,ne:null,PC:null,NC:null,QC:null,OC:null,MC:null,uF:[],El:[],tF:[],Dl:[],Qr:null};if(!a.W.length)for(var m=0;8>m;m++)a.W.push(null);a.W[c]=d;-1==za.indexOf(a)&&za.push(a)}function u(a,c){ia.o(a);R.u(a);f(a,0,c,!0)}function z(a,c,d){d=d||0;if(V.Pc(a)){var m=q(a,c);if(m)return G(a,d),b(a,m,d),u(a,d),!0;if((m=D(a,c))&&"EMITTER"==m.Wr){G(a,d);c=m.name;for(var m=d,
h=a.A,f=0;f<h.length;f++)for(var z=h[f].X,v=0;v<z.length;v++){var I=z[v].Qa;I&&I.name==c&&e(a.W[m],I)}u(a,d);return!0}}if(m=ka.Lc("name",c,ma)||ka.Lc("name",c+"_B4W_BAKED",ma)){G(a,d);if(r(a,m,d))return u(a,d),!0;a.W[d]=null}X.error('Unsupported object: "'+a.name+'" or animation name: "'+c+'"');return!1}function q(a,c){for(var d=0;d<a.Fc.length;d++){var m=a.Fc[d];if(m.name===c)return m}return null}function D(a,c){for(var d=a.A,m=0;m<d.length;m++)for(var b=d[m].X,h=0;h<b.length;h++){var e=b[h].Qa;
if(e&&e.name===c)return e}return null}function I(a){a=a.modifiers;for(var c=0;c<a.length;c++){var d=a[c];if("ARMATURE"==d.type)return d.object}return null}var m=n("__config"),V=n("__obj_util"),Q=n("__particles"),R=n("__physics"),X=n("__print"),ja=n("__quat"),W=n("__reformer"),Z=n("__sfx"),Y=n("__time"),ia=n("__transform"),ha=n("__tsr"),ka=n("__util"),la=n("__vec3"),da=n("__armature"),E=n("__lights"),oa=n("__scenes"),U=m.Xi,ea=m.v;a.oJ=1E-6;a.lA=0;a.xu=10;a.yu=20;a.oA=30;a.nA=40;a.mA=50;a.Hp=60;a.uJ=
70;a.tJ=80;a.yc=0;a.tA=1;a.uA=2;a.vA=3;a.wA=4;a.xA=5;a.yA=6;a.Cu=7;a.Gm=-1;a.Gz=10;a.Hz=20;a.st=30;var Ca=Array(3),ba=new Float32Array(3),aa=new Float32Array(3),ca=new Float32Array(4),S=new Float32Array(4),Aa=new Float32Array(4),ra=ha.create();new Float32Array(16);var za=[],ma=[];a.yD=function(){return ka.trunc((ea.eF-50)/4)};a.SC=function(a){return a/Y.Dc()};a.update=function(a){for(var c=0;c<za.length;c++){for(var d=za[c],m=0;8>m;m++)F(d,a,m);d.g.Wi&&(H(d,a),C(d,a))}for(c=0;c<za.length;c++)for(d=
za[c],m=0;8>m&&d.W.length;m++)k(d,m)};a.FO=function(){return ma};a.dD=function(a){var c=[];if(B(a))for(var d=0;d<a.Fc.length;d++)c.push(a.Fc[d].name);for(var m=[],d=0;d<ma.length;d++){var b=ma[d],h=b.j;20==h.type?m.push(b):10==h.type&&"ARMATURE"==a.type?m.push(b):40==h.type&&"SPEAKER"==a.type?m.push(b):80==h.type&&"WORLD"==a.type&&m.push(b)}if("MESH"==a.type)for(d=0;d<a.pf.length;d++)b=a.pf[d],60==b.j.type&&m.push(b);for(d=0;d<m.length;d++)c.push(y(m[d].name));if(Q.Gx(a)&&Q.zF(a))for(a=a.A,d=0;d<
a.length;d++)for(m=a[d].X,b=0;b<m.length;b++)(h=m[b].Qa)&&c.push(h.name);return c};a.b2=y;a.eD=function(a,c){var d=a.W[c];return d?d.type:0};a.Zp=function(a){for(var c=0,d=a.A,m=0;m<d.length;m++)for(var h=d[m].X,f=0;f<h.length;f++){var z=h[f].Qa;z&&"EMITTER"==z.Wr&&!h[f].dg&&(G(a,c),e(a.W[c],z),u(a,c),a.W[c].behavior=z.nd?10:a.Vi,c++)}d=a.pf.slice();for(m=0;m<d.length;m++)h=d[m],G(a,c),r(a,h,c)?(u(a,c),a.W[c].behavior=a.Vi,c++):a.W[c]=null;B(a)&&(G(a,c),b(a,a.Fc[0],c),u(a,c),a.W[c].behavior=a.Vi)};
a.Ku=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:ka.l("Wrong animation behavior")}};a.JO=function(a){var c=[];a=a.data.materials;for(var d=0;d<a.length;d++){var m=a[d].node_tree;m&&g(m,c)}return c};a.play=function(a,c,d){t(a.W,d,function(a){a.play=!0;a.jw=c?c:null;a.In=!1});a.g.Wi&&A(a)};a.stop=function(a,c){t(a.W,c,function(a){a.play=!1;a.jw=null;a.In=!1})};a.$h=function(a,c){var d=a.W;if(-1==c)for(var m=0;8>m;m++){if(d[m]&&d[m].play)return!0}else if(d=
d[c])return d.play;return!1};a.Tl=w;a.wy=function(a,c){c=c||0;t(a.W,c,function(d){w(a,d.start,c)})};a.nD=function(a,c){var d=a.W[c];return d&&d.ge?d.ge:0};a.zE=function(a,c){var d=a.W[c];return d&&10==d.behavior};a.Qo=function(a,c,d){t(a.W,d,function(a){a.behavior=c})};a.gD=function(a,c){var d=a.W[c];return d&&d.behavior};a.$A=function(a,c,d,m){t(a.W,m,function(a){a.kz=c||0;a.Vx=d||0})};a.jG=function(a,c){if(-1==c)for(var d=0;8>d;d++)a.W[d]=null;else a.W[c]=null;a.g.Wi&&x(a,c)};a.JT=f;a.BF=function(a){if("ARMATURE"==
a.type||a.$p||"WORLD"==a.type)return!0;for(var c=0;c<a.pf.length;c++){var d=a.pf[c].j.type;if(20==d||10==d||40==d&&"SPEAKER"==a.type||70==d&&"LAMP"==a.type||60==d&&"MESH"==a.type)return!0}return Q.Gx(a)&&Q.zF(a)||"MESH"==a.type&&a.Fc.length?!0:!1};a.rB=function(a,c){if("ARMATURE"==c.type||I(a)||"WORLD"==c.type)return!0;for(var d=0;d<c.pf.length;d++){var m=c.pf[d].j.type;if(20==m||10==m||40==m&&"SPEAKER"==c.type||60==m&&"MESH"==c.type)return!0}return Q.FL(a)&&Q.EL(a)||"MESH"==c.type&&a.data.b4w_vertex_anim.length?
!0:!1};a.Xb=function(a){return Boolean(a.W.length)};a.ML=K;a.ZN=d;a.HK=function(a){function d(a,c){for(var m=0;m<c;m++){var b=a.subarray(8*m+4,8*m+8);ja.normalize(b,b)}}function m(a,c){if(-1<a.indexOf("location"))var d=0,b=c;else-1<a.indexOf("rotation_quaternion")?(d=4,b=0==c?3:c-1):-1<a.indexOf("scale")?(d=3,b=0):(d=0,b=c);return d+b}function b(a,c,d,m,h){if(-1<d.search(e)){a=c;d=d.split('"')[1];var xa=f}else 8==h?(d="tsr",xa=f):xa=1<h?new Float32Array(h):0;if(!a[d]){h=a;c=d;if("object"==typeof xa&&
xa.length)for(var z=xa.length,D=new Float32Array(m*z),q=0;q<m;q++)for(var v=0;v<z;v++)D[q*z+v]=xa[v];else if("number"==typeof xa)for(D=new Float32Array(m),q=0;q<m;q++)D[q]=xa;else ka.l("Wrong storage default value");h[c]=D}return a[d]}var e=new RegExp(/pose.bones\[\".+\"\]/g),f=ha.create(),z=a.j={type:0,Ex:0,MF:0,Ea:null,dv:null,lB:null,Kg:new Int8Array(8)};z.MF=1/U.pj;var D=a.fcurves,q={},I={},p=0,u;for(u in D){var g=D[u],l;for(l in g){var S=g[l],k=S.Yd;W.WL(S,a);S=S.num_channels;p||(p=k.length);
for(var S=b(q,I,u,p,S),V=S.length/p,xa=m(u,l|0),G=0;G<p;G++)S[G*V+xa]=k[G]}}if(ka.Un(q)){for(var Q in q)"tsr"==Q&&d(q[Q],p);z.Ea=q}if(ka.Un(I)){for(var r in I)d(I[r],p);z.dv=I}z.Ex=p;z.lB=a.yK;"tsr"in q&&v(D,z.Kg);("color"in q||"energy"in q)&&P(D,z.Kg);("light_settings.environment_energy"in q||"horizon_color"in q||"zenith_color"in q||"mist_settings.intensity"in q||"mist_settings.depth"in q||"mist_settings.start"in q||"mist_settings.height"in q||"b4w_fog_color"in q)&&c(D,z.Kg);h(a);ma.push(a)};a.IO=
function(a,c){return(c-a)*U.pj+1};a.hL=function(a,c,d,m,b,h){var e=new Float32Array(2),f=new Float32Array(2),z=new Float32Array(2),q=new Float32Array(2),D=c[1],v=c[2],I=c[a.last_frame_offset+1];a=c[a.last_frame_offset+2];for(var u=0,g=0,l=null;b<=h;b++)if(b<D)for(var S=0;S<U.pj;S++)d[u++]=v;else if(b>I)for(S=0;S<U.pj;S++)d[u++]=a;else{var xa=c[g],k=3;0===xa&&(k+=2);0===l&&(k+=2);var V=2===xa?0:1;if(c[g+1]==c[g+k+1])l=xa,g+=k;else{S=0;b==c[g+1]&&(V&&(m[u]=1),d[u]=c[g+2],u++,S++);if(b==I)for(;S<U.pj;S++)d[u++]=
a;else for(e[0]=c[g+1],e[1]=c[g+2],0!==xa?(f[0]=0,f[1]=0):0===l?(f[0]=c[g+5],f[1]=c[g+6]):(f[0]=c[g+3],f[1]=c[g+4]),0!==xa?(z[0]=0,z[1]=0):(z[0]=c[g+k+3],z[1]=c[g+k+4]),q[0]=c[g+k+1],q[1]=c[g+k+2];S<U.pj;S++){var G=b+S/U.pj;switch(xa){case 0:var Q=e,r=f,A=z,K=q,P=[],R=[],x=void 0,y=void 0,t=void 0,x=void 0;P[0]=Q[0]-r[0];P[1]=Q[1]-r[1];R[0]=K[0]-A[0];R[1]=K[1]-A[1];t=K[0]-Q[0];x=Math.abs(P[0]);y=Math.abs(R[0]);0!=x+y&&x+y>t&&(x=t/(x+y),r[0]=Q[0]-x*P[0],r[1]=Q[1]-x*P[1],A[0]=K[0]-x*R[0],A[1]=K[1]-
x*R[1]);V&&(m[u]=1);d[u]=N(p(0,1,G,e[0],f[0],z[0],q[0]),e[1],f[1],z[1],q[1]);u++;break;case 1:V&&(m[u]=1);Q=e[0];r=e[1];A=(q[1]-r)/(q[0]-Q);d[u]=A*G+(r-A*Q);u++;break;case 2:V&&(m[u]=1);d[u]=c[g+2];u++;break;default:ka.l("Unknown keyframe interpolation mode: "+xa)}}b+1==c[g+k+1]&&(l=xa,g+=k)}}};a.apply=z;a.cL=function(a,c,d){d=d||0;var m=ka.Lc("uuid",c,ma);if(m){G(a,d);if(r(a,m,d)){u(a,d);return}a.W[d]=null}X.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.nU=function(a,c){var d=
ka.Lc("name",c,ma)||ka.Lc("name",c+"_B4W_BAKED",ma);if(d){if(0==d.j.type)return!1}else if(!(D(a,c)||V.Pc(a)&&q(a,c)))return!1;return!0};a.Gw=function(a,c){for(var d=a.W,m=0;m<d.length;m++){var b=d[m];if(b&&y(b.Eg)==y(c))return m}return-1};a.GO=function(a,c){var d=a.W[c];return d&&d.Eg?y(d.Eg):null};a.remove=function(a){a.W.length=0;a=za.indexOf(a);-1!=a&&za.splice(a,1)};a.lR=function(a){for(var c=ma.length-1;0<=c;c--)ma[c].zK==a&&ma.splice(c,1)};a.aB=function(a,c){if(!a.W.length)return z(a,c,0)?0:
-1;for(var d=0;d<a.W.length;d++)if(!a.W[d])return z(a,c,d)?d:-1};a.NG=function(a,c,d){a.g.Mu=(c-a.g.Ih)/d;a.g.Lu=c};a.PG=function(a,c,d){t(a.W,d,function(a){a.speed=c})};a.OD=function(a,c){return a.W[c].speed};a.xw=function(a,c){return a.W[c].start};a.ww=function(a,c){return a.W[c].length};a.ha=function(){za.length=0;ma.length=0};a.cO=function(a){var c=(a[0]||a[1]||a[2]).Yd.length,d=ca,m=ba,b=Boolean(a[0]);b||(a[0]={Yd:new Float32Array(c),num_channels:8});var h=Boolean(a[1]);h||(a[1]={Yd:new Float32Array(c),
num_channels:8});var e=Boolean(a[2]);e||(a[2]={Yd:new Float32Array(c),num_channels:8});a[3]={Yd:new Float32Array(c),num_channels:8};for(var f=0;f<c;f++)m[0]=b?a[0].Yd[f]:0,m[1]=h?a[1].Yd[f]:0,m[2]=e?a[2].Yd[f]:0,ka.Sh(m,d),a[0].Yd[f]=d[3],a[1].Yd[f]=d[0],a[2].Yd[f]=d[1],a[3].Yd[f]=d[2]};a.iD=I;a.FS=function(a,c){for(var d=7,m=0,b=0;b<ma.length;b++){var h=ma[b];if(h.name==c){m=h.j.type;break}}0==m&&(q(a,c)?m=30:(b=D(a,name))&&"EMITTER"==b.Wr&&(m=50));for(b=0;8>b;b++)if(h=a.W[b]){if(h.type==m)return b}else b<
d&&(d=b);return d}};b4w.module.__config=function(a,n){function k(){return b4w.module_check(a.qd.iq)}function b(){for(var b=a.qd,k=null,y=document.getElementsByTagName("script"),t=0;t<y.length;t++){for(var f=y[t].src,r=0;r<b.IE.length;r++)if(0<=f.indexOf(b.IE[r])){k=f;break}if(null!==k)break}k||(e.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),k=document.location.href);b=k.indexOf("?");0<=b&&(k=k.substring(0,b));return k.substring(0,k.lastIndexOf("/")+1)}var e=n("__print"),
y=n("__util");a.Pi=1;a.Oi=2;a.rk=3;a.Au=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!0};a.zM=y.ia(a.context);a.v={alpha_sort:!0,alpha_sort_threshold:.1,Ij:[5,7],Df:1E4,console_verbose:!1,do_not_load_resources:!1,it:!1,RC:1.5,iO:10,background_color:[0,0,0,0],canvas_resolution_factor:1,nm:3,allow_cors:!1,lw:!1,Vp:!0,show_hud_debug_info:!1,AX:!0,Ul:!0,stereo:"NONE",Go:!0,gd:!0,Rd:!0,Qk:!0,hl:!0,gq:!0,Jj:!0,Hk:!0,antialiasing:!0,smaa:!1,debug_view:!1,AI:!1,Mn:!0,Xr:!0,
Ic:!0,water_dynamic:!0,ti:!0,Ks:!0,Rb:1024,di:512,fI:!0,precision:"highp",quality:a.Oi,Up:!0,FQ:!1,YG:!1,Zv:!1,nI:!1,zf:!1,$v:!1,Sw:!1,tv:!1,L1:!1,Po:!1,allow_hidpi:!1,IC:!1,tx:!1,enable_selectable:!0,enable_outlining:!0,Yg:!0,eF:128,lr:!1,JC:!1,lx:[0,0],Dn:!1,YF:!0,Ju:!1,url_params:null,ld:!0,rc:4,sG:!1,nG:!1,JB:!1,media_auto_activation:!0,dF:4,Hr:!1,VA:!1,gl_debug:!1,WC:"",EB:!1};a.xN=y.ia(a.v);a.Xi={Sq:-1,TC:!1,pj:1};a.controls={BQ:1/120};a.Ne={dir:"ASSETS=assets/",wQ:15,prevent_caching:!0,
rx:!1,Sv:!1};a.kL=y.ia(a.Ne);a.qd={shaders_dir:"",BS:"include/",F1:"postprocessing/",iq:"built_in_data",IE:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js guitar_presentation.min.js".split(" "),oG:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.qP={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{Bj:.064,Jh:.035,ni:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],ym:.11,Yh:.062,Kh:.004}};a.r=
{enabled:!0,Df:60,ap:"",hv:!1,ping:!1,fp:!0};a.QQ=y.ia(a.r);a.Rl={er:1024,tn:384,mC:32,qN:128,pN:256,NF:.25,YQ:.5,XQ:1};a.ER=y.ia(a.Rl);a.P={Bz:!0,Lr:!1,hB:!1,KB:!1,AC:!1};a.zS=y.ia(a.P);a.hc={outlining_overview_mode:!1,jh:[1,.4,.05],Il:.2,Jl:3.8,Kl:1};a.Fq={enabled:!1,ZS:"COPY",YS:0,ES:"COLOR"};a.tN=y.ia(a.Fq);a.fL=function(){var b=a.v,e=a.r,k=a.Rl;switch(b.quality){case a.rk:b.Ul=!0;b.ti=!0;b.Rd=!0;b.Qk=!0;b.hl=!0;b.gq=!0;b.Go=!0;b.gd=!0;b.Mn=!0;b.Xr=!0;b.Ic=!0;k.er=2048;b.nm=3;b.Vp=!0;b.it=!1;
b.precision="highp";b.water_dynamic=!0;b.Ks=!0;b.antialiasing=!0;b.smaa=!1;b.Hk=!0;b.Jj=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Yg=!0;b.rc=16;e.Df=120;break;case a.Oi:b.Ul=!0;b.ti=!0;b.Rd=!0;b.Qk=!0;b.hl=!0;b.gq=!0;b.Go=!0;b.gd=!0;b.Mn=!0;b.Xr=!0;b.Ic=!0;k.er=1024;b.nm=3;b.Vp=!0;b.it=!1;b.precision="highp";b.water_dynamic=!0;b.Ks=!0;b.antialiasing=!0;b.smaa=!1;b.Hk=!0;b.Jj=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Yg=!0;b.rc=4;e.Df=60;break;case a.Pi:b.Ul=!1,b.ti=!1,b.Rd=!1,b.Qk=!1,b.hl=!1,
b.gq=!1,b.Go=!1,b.gd=!1,b.Mn=!1,b.Xr=!1,b.Ic=!1,k.er=512,b.nm=2,b.Vp=!1,b.it=!0,b.precision="mediump",b.water_dynamic=!1,b.Ks=!1,b.antialiasing=!1,b.smaa=!1,b.Hk=!1,b.Jj=!1,b.allow_hidpi=!1,b.enable_outlining=!1,b.Yg=!1,b.rc=1,e.Df=60}};a.set=function(b,k){switch(b){case "allow_cors":a.v.allow_cors=k;break;case "allow_hidpi":a.v.allow_hidpi=k;break;case "alpha":a.context.alpha=k;break;case "alpha_sort":a.v.alpha_sort=k;break;case "alpha_sort_threshold":a.v.alpha_sort_threshold=k;break;case "anaglyph_use":e.SN();
a.v.stereo=k?"ANAGLYPH":a.v.stereo;break;case "animation_framerate":a.Xi.Sq=k;break;case "antialiasing":a.v.antialiasing=k;break;case "assets_dds_available":a.Ne.Sv=k;break;case "assets_min50_available":a.Ne.rx=k;break;case "audio":a.P.Bz=k;break;case "background_color":a.v.background_color=k;break;case "built_in_module_name":a.qd.iq=k;break;case "canvas_resolution_factor":a.v.canvas_resolution_factor=k;break;case "console_verbose":a.v.console_verbose=k;break;case "do_not_load_resources":a.v.do_not_load_resources=
k;break;case "gamepad_setting_cont":a.v.WC=k;break;case "stereo":a.v.stereo=k;break;case "media_auto_activation":a.v.media_auto_activation=k;break;case "physics_enabled":a.r.enabled=k;break;case "physics_uranium_path":a.r.ap=k;break;case "physics_calc_fps":a.r.hv=k;break;case "physics_use_workers":a.r.fp=k;break;case "precision":a.v.precision=k;break;case "prevent_caching":a.Ne.prevent_caching=k;break;case "quality":a.v.quality=k;break;case "sfx_mix_mode":a.P.Lr=k;break;case "shaders_dir":a.qd.shaders_dir=
k;break;case "show_hud_debug_info":a.v.show_hud_debug_info=k;break;case "smaa":a.v.smaa=k;break;case "smaa_search_texture_path":a.qd.smaa_search_texture_path=k;break;case "smaa_area_texture_path":a.qd.smaa_area_texture_path=k;break;case "debug_view":a.v.debug_view=k;break;case "enable_selectable":a.v.enable_selectable=k;break;case "enable_outlining":a.v.enable_outlining=k;break;case "outlining_overview_mode":a.hc.outlining_overview_mode=k;break;case "glow_materials":a.v.Yg=k;break;case "url_params":a.v.url_params=
k;break;case "gl_debug":a.v.gl_debug=k;break;default:e.error("Unknown config property: "+b)}};a.get=function(b){switch(b){case "allow_cors":return a.v.allow_cors;case "allow_hidpi":return a.v.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.v.alpha_sort;case "alpha_sort_threshold":return a.v.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.v.stereo;case "animation_framerate":return a.Xi.Sq;case "antialiasing":return a.v.antialiasing;case "assets_dds_available":return a.Ne.Sv;
case "assets_min50_available":return a.Ne.rx;case "audio":return a.P.Bz;case "background_color":return a.v.background_color;case "built_in_module_name":return a.qd.iq;case "canvas_resolution_factor":return a.v.canvas_resolution_factor;case "console_verbose":return a.v.console_verbose;case "do_not_load_resources":return a.v.do_not_load_resources;case "gamepad_setting_cont":return a.v.WC;case "is_mobile_device":return a.v.zf;case "stereo":return a.v.stereo;case "media_auto_activation":return a.v.media_auto_activation;
case "physics_enabled":return a.r.enabled;case "physics_uranium_path":return a.r.ap;case "physics_calc_fps":return a.r.hv;case "physics_use_workers":return a.r.fp;case "precision":return a.v.precision;case "prevent_caching":return a.Ne.prevent_caching;case "quality":return a.v.quality;case "sfx_mix_mode":return a.P.Lr;case "shaders_dir":return a.qd.shaders_dir;case "show_hud_debug_info":return a.v.show_hud_debug_info;case "smaa":return a.v.smaa;case "smaa_search_texture_path":return a.qd.smaa_search_texture_path;
case "smaa_area_texture_path":return a.qd.smaa_area_texture_path;case "debug_view":return a.v.debug_view;case "enable_selectable":return a.v.enable_selectable;case "enable_outlining":return a.v.enable_outlining;case "outlining_overview_mode":return a.hc.outlining_overview_mode;case "glow_materials":return a.v.Yg;case "url_params":return a.v.url_params;case "gl_debug":return a.v.gl_debug;default:e.error("Unknown config property: "+b)}};a.reset=function(){a.context=y.ia(a.zM);a.v=y.ia(a.xN);a.Ne=y.ia(a.kL);
a.r=y.ia(a.QQ);a.Rl=y.ia(a.ER);a.P=y.ia(a.zS);a.Fq=y.ia(a.tN)};a.uE=k;a.fS=function(){var e=a.qd,y=a.r;k()||""!=e.shaders_dir||(e.shaders_dir=b()+"../shaders/");if(k())e.smaa_search_texture_path="smaa_search_texture.png",e.smaa_area_texture_path="smaa_area_texture.png";else if(""==e.smaa_search_texture_path||""==e.smaa_area_texture_path){var w=b()+e.oG;e.smaa_search_texture_path=e.smaa_search_texture_path||w+"smaa_search_texture.png";e.smaa_area_texture_path=e.smaa_area_texture_path||w+"smaa_area_texture.png"}y.enabled&&
""==y.ap&&(w=b()+e.oG,y.ap=w+"uranium.js")};a.Iw=function(){return a.Ne.dir.replace("ASSETS=","")}};b4w.module.__print=function(a){function n(a,b){var e=[];-1<a[0].indexOf("%c")?e.push(a[0].replace("%c","%c"+b+": ")):e.push(b+": "+a[0]);for(var k=1;k<a.length;k++)e.push(a[k]);return e}function k(){g++;var a=n(arguments,"B4W ERROR");console.error.apply(console,a)}function b(a){a in w||(w[a]=a,k([a]))}function e(a,e){b(a+"() is deprecated, use "+e+"() instead.")}var y=!1,g=0,B=0,w={};a.pS=function(a){y=a};a.mx=function(){console.log.apply(console,arguments)};a.log=function(){if(y){var a=n(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=k;a.fc=b;a.kb=e;a.ag=function(a,f){switch(1<f.length){case !0:b(a+"() is deprecated, use "+f.slice(0,-1).join("(), ")+"() or "+f[f.length-1]+"() instead.");break;case !1:e(a,f[0])}};a.SN=function(){b('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){B++;var a=n(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=n(arguments,"B4W INFO");console.info.apply(console,a)};a.VN=function(){g++;
var a=n(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.WN=function(){B++;var a=n(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){y&&console.time.apply(console,arguments)};a.timeEnd=function(){y&&console.timeEnd.apply(console,arguments)};a.group=function(){y&&console.group.apply(console,arguments)};a.groupCollapsed=function(){y&&console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){y&&console.groupEnd.apply(console,arguments)};a.clear=
function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.gP=function(){return B};a.PO=function(){return g};a.OB=function(){g=B=0}};b4w.module.print=b4w.module.__print;b4w.module.__util=function(a,n){function k(a){return 0<a?1:0>a?-1:0}function b(a){var c=a[0],d=a[1],m=a[2],b=a[3],h=Math.sqrt(c*c+d*d+m*m),h=1/h;a[0]=c*h;a[1]=d*h;a[2]=m*h;a[3]=b*h}function e(a,c){var d=c;switch(typeof a){case "number":return y(a,d);case "string":return g(a,d);case "boolean":return y(a|0,d);case "function":case "undefined":return y(0,d);case "object":if(a){switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return y(0,
d)}if(a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength)for(var m=0;m<a.length;m++)d=y(a[m],d);else if(a instanceof Array)for(m=0;m<a.length;m++)d=e(a[m],d);else for(m in a)d=e(a[m],d)}else d=y(0,d)}return d}function y(a,c){var d=c;Q[0]=a;d=(d<<5)-d+R[0];d&=d;d=(d<<5)-d+R[1];return d&d}function g(a,c){for(var d=c,m=0;m<a.length;m++)d=(d<<5)-d+a.charCodeAt(m),d&=d;return d}function B(a){return(34*a+1)*a%289}function w(a){return a-Math.floor(a)}function t(a){return f((34*a+5)*a)}function f(a){return a-
289*Math.floor(a/289)}function r(a){return a-7*Math.floor(a/7)}function l(a){a&&d.error.apply(d,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";}function A(a,c,d){a-=c;d-=c;return c+(a-Math.floor(a/d)*d)}function x(a){return A(a,0,2*Math.PI)}function L(a,c){if(a&&c){var d=a instanceof Array;if(d!=c instanceof Array)return!1;var m=
a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(m!=(c.buffer instanceof ArrayBuffer&&"undefined"!==c.byteLength))return!1;if(d){if(a.length!=c.length)return!1;for(d=0;d<a.length;d++)if(!M(a[d],c[d]))return!1}else if(m){if(a.length!=c.length)return!1;for(d=0;d<a.length;d++)if(a[d]!=c[d])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==c}for(var b in a)if(!M(a[b],c[b]))return!1;
for(b in c)if(!(b in a))return!1}return!0}return!(a||c)}function M(a,c){if(typeof a!=typeof c)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==c;case "object":return L(a,c);default:return!0}}function F(a){if(""==a)return".";var c=0==a.indexOf("/")|0;c&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(c=2);a=a.split("/");for(var d=[],m=0;m<a.length;m++){var b=a[m];""!=b&&"."!=b&&(".."!=b||!c&&!d.length||d.length&&".."==d[d.length-1]?d.push(b):d.length&&d.pop())}a=d.join("/");
for(m=0;m<c;m++)a="/"+a;return a||"."}var J=n("__boundings"),C=n("__mat3"),H=n("__mat4"),K=n("__math"),d=n("__print"),h=n("__tsr"),v=n("__quat"),P=n("__vec3"),c=n("__vec4"),p=0,N={},G=[E,oa,U,ea,Ca],u=new Float32Array(3),z=new Float32Array(3),q=new Float32Array(4),D=new Float32Array(4),I=new Float32Array(9),m=new Float32Array(16),V=new Float32Array(16),Q=new Float64Array(1),R=new Uint32Array(Q.buffer),X=new Float32Array([0,0,0]),ja=new Float32Array([0,0,0,1]),W=new Float32Array([0,0,0,1,0,0,0,1]),
Z=new Float32Array([1,1,1]),Y=new Float32Array([1,0,0]),ia=new Float32Array([0,1,0]),ha=new Float32Array([0,0,1]),ka=new Float32Array([-1,0,0]),la=new Float32Array([0,-1,0]),da=new Float32Array([0,0,-1]),E=0,oa=1,U=2,ea=4,Ca=5,ba=Math.floor(44488.07041494893),aa=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,
0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.AA=X;a.Bu=ja;a.aW=W;a.Eu=Z;a.Ke=Y;a.uc=ia;a.lf=ha;a.vt=ka;a.md=la;a.Mi=da;a.BA=E;a.IA=oa;a.JA=U;a.DA=3;a.FA=ea;a.LA=Ca;a.CA=6;a.HA=7;a.Fu=8;a.EA=9;a.GA=10;a.KA=11;a.OI=aa;a.Af=function(a){return"undefined"!=typeof a};a.NE=function(a,c,d){for(var m=[],b=d.length,h=0;h<b;h++){var e=d[h];e[a]==c&&m.push(e)}return m};a.hO=function(a,c){var d=a.length,m=new Float32Array(d+c.length);m.set(a);m.set(c,d);return m};a.oT=
function(a,c){var d=a.length,m=new Uint32Array(d+c.length);m.set(a);m.set(c,d);return m};a.eM=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.iL=function(a,c){var d=[],m={},b=c.length,h,e;for(h=0;h<b;h++)m[c[h]]=!0;b=a.length;for(h=0;h<b;h++)e=a[h],e in m&&d.push(e);return d};a.sign=k;a.L_=function(a,c,d){for(var m=d.length,b=0;b<m;b++)if(d[b][a]==c)return!0;return!1};a.Lc=function(a,c,d){for(var m=0;m<d.length;m++){var b=d[m];if(b[a]===c)return b}return null};
a.J_=function(a,c,d,m,b){for(var h=0;h<b.length;h++){var e=b[h];if(e[a]==c&&e[d]==m)return e}return null};a.WO=function(a,c){for(var d=0;d<a.length;d++)if(a[d].uuid==c)return d;return-1};a.bL=function(a,c){for(var d=0;d<a.length;d++)if(a[d]==c)return;a.push(c)};a.fX=function(a){for(var c=0;c<a.length-1;c++)for(var d=a[c],m=c+1;m<a.length;m++)if(d==a[m])return!1;return!0};a.jT=function(a,c,d,m){m||(m=new Float32Array(16));H.identity(m);m[12]=a;m[13]=c;m[14]=d};var ca=1;a.iR=function(){ca=(69069*ca+
5)%Math.pow(2,32);return Math.round(ca/65536)%32768/32767};a.QS=function(a){ca=a};a.ef=function(a){var c=a[0]%ba*48271-3399*Math.floor(a[0]/ba);a[0]=0<c?c:c+2147483647;return(a[0]-1)/2147483646};a.pr=function(a,c){c||(c=[]);c[0]=5E4+Math.floor(a);return c};a.Sh=function(a,c){c||(c=new Float32Array(4));var d=Math.cos(a[1]/2),m=Math.cos(a[2]/2),b=Math.cos(a[0]/2),h=Math.sin(a[1]/2),e=Math.sin(a[2]/2),f=Math.sin(a[0]/2);c[0]=d*m*f+h*e*b;c[1]=h*m*b+d*e*f;c[2]=d*e*b-h*m*f;c[3]=d*m*b-h*e*f;return c};a.Hx=
function(a,c,d){var m=a[0],b=a[1];a=a[2];var h=Math.cos(m/2),e=Math.cos(b/2),f=Math.cos(a/2),z=Math.sin(m/2),b=Math.sin(b/2),q=Math.sin(a/2);if(-1<G.indexOf(c))var D=Math.cos((m+a)/2),v=Math.sin((m+a)/2),I=Math.cos((m-a)/2),p=Math.sin((m-a)/2),u=Math.cos((a-m)/2),k=Math.sin((a-m)/2);switch(c){case E:d[0]=e*v;d[1]=b*I;d[2]=b*p;d[3]=e*D;break;case oa:d[0]=b*p;d[1]=e*v;d[2]=b*I;d[3]=e*D;break;case U:d[0]=b*I;d[1]=b*p;d[2]=e*v;d[3]=e*D;break;case 3:d[0]=e*v;d[1]=b*k;d[2]=b*u;d[3]=e*D;break;case ea:d[0]=
b*u;d[1]=e*v;d[2]=b*k;d[3]=e*D;break;case Ca:d[0]=b*k;d[1]=b*u;d[2]=e*v;d[3]=e*D;break;case 6:d[0]=z*e*f+h*b*q;d[1]=h*b*f-z*e*q;d[2]=h*e*q+z*b*f;d[3]=h*e*f-z*b*q;break;case 7:d[0]=h*e*q+z*b*f;d[1]=z*e*f+h*b*q;d[2]=h*b*f-z*e*q;d[3]=h*e*f-z*b*q;break;case 8:d[0]=h*b*f-z*e*q;d[1]=h*e*q+z*b*f;d[2]=z*e*f+h*b*q;d[3]=h*e*f-z*b*q;break;case 9:d[0]=z*e*f-h*b*q;d[1]=h*e*q-z*b*f;d[2]=h*b*f+z*e*q;d[3]=h*e*f+z*b*q;break;case 10:d[0]=h*b*f+z*e*q;d[1]=z*e*f-h*b*q;d[2]=h*e*q-z*b*f;d[3]=h*e*f+z*b*q;break;case 11:d[0]=
h*e*q-z*b*f,d[1]=h*b*f+z*e*q,d[2]=z*e*f-h*b*q,d[3]=h*e*f+z*b*q}return d};a.bG=function(a,d,c){var m=a[0],b=a[1],h=a[2];a=a[3];switch(d){case E:c[0]=Math.atan2(m*b+h*a,b*a-m*h);c[1]=Math.acos(1-2*(b*b+h*h));c[2]=Math.atan2(m*b-h*a,m*h+b*a);break;case oa:c[0]=Math.atan2(m*a+b*h,h*a-m*b);c[1]=Math.acos(1-2*(m*m+h*h));c[2]=Math.atan2(b*h-m*a,m*b+h*a);break;case U:c[0]=Math.atan2(m*h+b*a,m*a-b*h);c[1]=Math.acos(1-2*(m*m+b*b));c[2]=Math.atan2(m*h-b*a,m*a+b*h);break;case 3:c[0]=Math.atan2(m*h-b*a,m*b+h*
a);c[1]=Math.acos(1-2*(b*b+h*h));c[2]=Math.atan2(m*h+b*a,h*a-m*b);break;case ea:c[0]=Math.atan2(m*b-h*a,m*a+b*h);c[1]=Math.acos(1-2*(m*m+h*h));c[2]=Math.atan2(m*b+h*a,m*a-b*h);break;case Ca:c[0]=Math.atan2(b*h-m*a,m*h+b*a);c[1]=Math.acos(1-2*(m*m+b*b));c[2]=Math.atan2(m*a+b*h,b*a-m*h);break;case 6:c[0]=Math.atan2(2*(m*a-b*h),1-2*(m*m+b*b));c[1]=Math.asin(2*(m*h+b*a));c[2]=Math.atan2(2*(h*a-m*b),1-2*(b*b+h*h));break;case 7:c[0]=Math.atan2(2*(b*a-m*h),1-2*(b*b+h*h));c[1]=Math.asin(2*(m*b+h*a));c[2]=
Math.atan2(2*(m*a-b*h),1-2*(m*m+h*h));break;case 8:c[0]=Math.atan2(2*(h*a-m*b),1-2*(m*m+h*h));c[1]=Math.asin(2*(m*a+b*h));c[2]=Math.atan2(2*(b*a-m*h),1-2*(m*m+b*b));break;case 9:c[0]=Math.atan2(2*(m*a+b*h),1-2*(m*m+h*h));c[1]=Math.asin(2*(h*a-m*b));c[2]=Math.atan2(2*(m*h+b*a),1-2*(b*b+h*h));break;case 10:c[0]=Math.atan2(2*(m*h+b*a),1-2*(m*m+b*b));c[1]=Math.asin(2*(m*a-b*h));c[2]=Math.atan2(2*(m*b+h*a),1-2*(m*m+h*h));break;case 11:c[0]=Math.atan2(2*(m*b+h*a),1-2*(b*b+h*h)),c[1]=Math.asin(2*(b*a-m*
h)),c[2]=Math.atan2(2*(m*a+b*h),1-2*(m*m+b*b))}return c};a.TN=function(a){var c=C.create(),d=Math.cos(a[0]),m=Math.cos(a[1]),b=Math.cos(a[2]),h=Math.sin(a[0]),e=Math.sin(a[1]);a=Math.sin(a[2]);var f=d*b,z=d*a,q=h*b,D=h*a;c[0]=m*b;c[1]=m*a;c[2]=-e;c[3]=e*q-z;c[4]=e*D+f;c[5]=m*h;c[6]=e*f+D;c[7]=e*z-q;c[8]=m*d;return c};a.aG=function(a,c){var d=a[0],m=a[1],b=a[2],h=a[3],e=b*b,f=d*m+b*h;.499999<f?(c[0]=0,c[1]=2*Math.atan2(d,h),c[2]=Math.PI/2):-.499999>f?(c[0]=0,c[1]=-2*Math.atan2(d,h),c[2]=-Math.PI/2):
(c[0]=Math.atan2(2*d*h-2*m*b,1-2*d*d-2*e),c[1]=Math.atan2(2*m*h-2*d*b,1-2*m*m-2*e),c[2]=Math.asin(2*d*m+2*b*h));return c};a.Cb=function(a,c,d){d||(d=new Float32Array(3));P.transformQuat(c,a,d);return d};a.Yv=function(a,c,d){d||(d=new Float32Array(4));a=P.normalize(a,u);var m=P.dot(c,a);a=P.cross(c,a,z);m=Math.acos(m);d[0]=a[0]*Math.sin(m/2);d[1]=a[1]*Math.sin(m/2);d[2]=a[2]*Math.sin(m/2);d[3]=Math.cos(m/2);return d};a.kT=function(a,c,d,m){m||(m=new Float32Array(4));P.transformQuat(d,c,m);m[3]=-P.dot(a,
m)};a.DN=function(a){var c=h.B(a.g.i);switch(a.type){case "CAMERA":u[0]=0;u[1]=-1;u[2]=0;P.transformQuat(u,c,u);z[0]=0;z[1]=0;z[2]=-1;break;case "MESH":u[0]=0;u[1]=0;u[2]=1;P.transformQuat(u,c,u);z[0]=0;z[1]=0;z[2]=1;break;case "EMPTY":u[0]=0,u[1]=1,u[2]=0,P.transformQuat(u,c,u),z[0]=0,z[1]=1,z[2]=0}u[1]=0;P.normalize(u,u);a=P.dot(u,z);return Math.acos(a)*(0<-u[0]*z[2]?-1:1)};a.nB=function(a,c,d,m){if(0!=d){m=m||[];for(var b=0;b<a.length;b++)m[b]=(1-d)*a[b]+d*c[b]}};a.w2=function(){p++;return p.toString(16)};
a.Zo=function(a){N[a]||(N[a]=0);var c=a+N[a];N[a]++;return c};a.sf=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.Bc=function(a){var c={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,wa:0,ab:null,N:[],ba:c,Oa:[],kd:{I:J.bc(),na:J.kf(),R:J.bc(),Ga:J.kf()}}};a.Oh=function(a){return JSON.parse(JSON.stringify(a))};a.ia=function(c){if(!(c instanceof Object))return c;var d;d=c.constructor;
switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:d=new d(c);break;case Array:d=new d(c.length);for(var m=0;m<c.length;m++)d[m]=a.ia(c[m]);break;default:for(m in d=new d,c)d[m]=a.ia(c[m])}return d};a.dn=function(a){var c=a instanceof Array?[]:{},d;for(d in a)if(a[d]instanceof Object){var m=a[d].constructor;switch(m){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c[d]=
new m(a[d]);break;case Array:c[d]=a[d].slice(0);break;default:c[d]=a[d]}}else c[d]=a[d];return c};a.Jr=function(a,c){c||(c=new Float32Array(4));C.fromMat4(a,I);var d=I[0],m=I[3],b=I[6],h=I[1],e=I[4],f=I[7],z=I[2],q=I[5],D=I[8],d=Math.sqrt(d*d+m*m+b*b)||1,h=Math.sqrt(h*h+e*e+f*f)||1,z=Math.sqrt(z*z+q*q+D*D)||1;I[0]/=d;I[3]/=d;I[6]/=d;I[1]/=h;I[4]/=h;I[7]/=h;I[2]/=z;I[5]/=z;I[8]/=z;v.fromMat3(I,c);v.normalize(c,c);return c};a.cF=function(a,c){c||(c=new Float32Array(3));c[0]=a[12];c[1]=a[13];c[2]=a[14];
return c};a.bF=function(a){q[0]=.577350269189626;q[1]=.577350269189626;q[2]=.577350269189626;q[3]=0;c.transformMat4(q,a,q);return c.length(q)};a.Nq=function(a,c){var d=c.left,m=c.right,h=c.top,e=c.bottom,f=c.near,z=c.far;d[0]=a[3]+a[0];d[1]=a[7]+a[4];d[2]=a[11]+a[8];d[3]=a[15]+a[12];m[0]=a[3]-a[0];m[1]=a[7]-a[4];m[2]=a[11]-a[8];m[3]=a[15]-a[12];h[0]=a[3]-a[1];h[1]=a[7]-a[5];h[2]=a[11]-a[9];h[3]=a[15]-a[13];e[0]=a[3]+a[1];e[1]=a[7]+a[5];e[2]=a[11]+a[9];e[3]=a[15]+a[13];f[0]=a[3]+a[2];f[1]=a[7]+a[6];
f[2]=a[11]+a[10];f[3]=a[15]+a[14];z[0]=a[3]-a[2];z[1]=a[7]-a[6];z[2]=a[11]-a[10];z[3]=a[15]-a[14];b(d);b(m);b(h);b(e);b(f);b(z)};a.P1=function(a,c,d){return d<-K.df(a,c.left)||d<-K.df(a,c.right)||d<-K.df(a,c.top)||d<-K.df(a,c.bottom)||d<-K.df(a,c.near)||d<-K.df(a,c.far)?!0:!1};a.NN=function(a,c,d,m,b){h=P.dot(d,c.far);e=P.dot(m,c.far);f=P.dot(b,c.far);h=Math.sqrt(h*h+e*e+f*f);if(h<-K.df(a,c.near)||h<-K.df(a,c.far))return!0;var h=P.dot(d,c.left),e=P.dot(m,c.left),f=P.dot(b,c.left);if(Math.sqrt(h*h+
e*e+f*f)<-K.df(a,c.left))return!0;h=P.dot(d,c.right);e=P.dot(m,c.right);f=P.dot(b,c.right);if(Math.sqrt(h*h+e*e+f*f)<-K.df(a,c.right))return!0;h=P.dot(d,c.top);e=P.dot(m,c.top);f=P.dot(b,c.top);if(Math.sqrt(h*h+e*e+f*f)<-K.df(a,c.top))return!0;h=P.dot(d,c.bottom);e=P.dot(m,c.bottom);f=P.dot(b,c.bottom);return Math.sqrt(h*h+e*e+f*f)<-K.df(a,c.bottom)?!0:!1};a.Nl=function(a,c,d,m){m||(m=0);for(var b=a.length,h=0;h<b;h+=3){var e=a[h],f=a[h+1],z=a[h+2];d[m+h]=c[0]*e+c[4]*f+c[8]*z+c[12];d[m+h+1]=c[1]*
e+c[5]*f+c[9]*z+c[13];d[m+h+2]=c[2]*e+c[6]*f+c[10]*z+c[14]}};a.qU=function(a,c,d){for(var m=0,m=0,b=a.length,h=0;h<b;h+=3){var e=a[h],f=a[h+1],z=a[h+2];d[m+h]=c[0]*e+c[4]*f+c[8]*z;d[m+h+1]=c[1]*e+c[5]*f+c[9]*z;d[m+h+2]=c[2]*e+c[6]*f+c[10]*z}};a.aT=function(a,c,d){for(var m=0,m=0,b=a.length,h=0;h<b;h+=4){var e=a[h],f=a[h+1],z=a[h+2];d[m+h]=c[0]*e+c[4]*f+c[8]*z;d[m+h+1]=c[1]*e+c[5]*f+c[9]*z;d[m+h+2]=c[2]*e+c[6]*f+c[10]*z;d[m+h+3]=a[h+3]}};a.oU=function(a,d,m){m||(m=new Float32Array(3));q[0]=a[0];q[1]=
a[1];q[2]=a[2];q[3]=0;c.transformMat4(q,d,q);m[0]=q[0];m[1]=q[1];m[2]=q[2]};a.hY=function(a,c){var d=a.length;d||l("flatten(): Wrong or empty array");var m=a[0].length;m||l("flatten(): Wrong or empty subarray");c||(c=new Float32Array(d*m));for(var b=0;b<d;b++)for(var h=0;h<m;h++)c[b*m+h]=a[b][h];return c};a.pU=function(a){for(var c=[],d=0;d<a.length;d+=3){var m=new Float32Array([a[d],a[d+1],a[d+2]]);c[d/3]=m}return c};a.fq=function(c,d,m,b){if(b<m)return m;var h=m+Math.floor((b-m)/2);return c[h]>
d?a.fq(c,d,m,h-1):c[h]<d?a.fq(c,d,h+1,b):h};a.Ph=function(a,c){for(var d=0;d<a.length;d++)if(a[d]!=c[d])return!1;return!0};a.oX=function(a,c,d){for(var m=0;m<a.length;m++)if(Math.abs(a[m]-c[m])>d)return!1;return!0};a.L0=function(a,c,d){d||(d=new Float32Array(16));for(var m=0;12>m;m++)d[m]=a[m]*c;d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.mT=function(a,c,d,b,h){h||(h=new Float32Array(16));c=H.fromRotationTranslation(d,b,m);H.multiply(c,a,h);return h};a.Ec=function(a,c,d,b,h){h||(h=
new Float32Array(3));d=H.fromRotationTranslation(d,b,m);1!==c&&(b=H.identity(V),c=P.set(c,c,c,u),H.scale(b,c,b),H.multiply(d,b,d));P.transformMat4(a,d,h);return h};a.q2=function(a,d,b,h,e){e||(e=new Float32Array(4));d=H.fromRotationTranslation(b,h,m);c.transformMat4(a,d,e);return e};a.x_=function(a,c,d,b,h){h||(h=new Float32Array(3));c=H.fromRotationTranslation(d,b,m);H.invert(c,c);P.transformMat4(a,c,h);return h};a.o2=function(a,c,d){d||(d=new Float32Array(16));H.fromRotationTranslation(c,a,d);a=
a[3];for(c=0;12>c;c++)d[c]*=a;return d};a.V_=function(c,d,m){a.cF(c,d);d[3]=a.bF(c);a.Jr(c,m)};a.AW=function(a){for(var c=[],d=0;d<a.length;d++)c.push(a[d]);return JSON.stringify(c)};a.AR=function(a,c,d,m){m||(m=new Float32Array(3));P.subtract(c,a,u);P.transformQuat(u,d,u);P.subtract(c,u,m)};a.uO=function(){u[0]=0;u[1]=0;u[2]=0;var a=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),m=new Float32Array(16),b=new Float32Array(16),h=new Float32Array(16);H.lookAt(u,[-1,0,0],[0,-1,0],
a);H.scale(a,[-1,1,1],a);H.scale(a,[-1,1,-1],c);H.lookAt(u,[0,-1,0],[0,0,-1],d);H.scale(d,[1,1,-1],d);H.scale(d,[1,-1,-1],m);H.lookAt(u,[0,0,-1],[0,-1,0],b);H.scale(b,[-1,1,1],b);H.scale(b,[-1,1,-1],h);return[a,c,d,m,b,h]};a.yO=function(){u[0]=0;u[1]=0;u[2]=0;var a=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),m=new Float32Array(16),b=new Float32Array(16),h=new Float32Array(16);H.lookAt(u,[1,0,0],[0,-1,0],a);H.scale(a,[-1,1,-1],c);H.lookAt(u,[0,1,0],[0,0,1],d);H.scale(d,[1,-1,
-1],m);H.lookAt(u,[0,0,1],[0,-1,0],b);H.scale(b,[-1,1,-1],h);return[a,c,d,m,b,h]};a.sB=function(a,c){return e(a,c)};a.nE=e;a.h_=g;a.tQ=function(a,c){c[15]=1;c[14]=0;c[13]=0;c[12]=0;c[11]=0;c[10]=a[8];c[9]=a[7];c[8]=a[6];c[7]=0;c[6]=a[5];c[5]=a[4];c[4]=a[3];c[3]=0;c[2]=a[2];c[1]=a[1];c[0]=a[0];return c};a.$F=function(a,c){c||(c=a);var d=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<d?(c[3]=2*Math.acos(a[3]),d=1/Math.sqrt(d),c[0]=a[0]*d,c[1]=a[1]*d,c[2]=a[2]*d):(c[3]=0,c[0]=1,c[1]=0,c[2]=0);return c};a.trunc=function(a){return isNaN(a)||
"undefined"==typeof a?NaN:a|0};a.jb=function(a){return a*Math.PI/180};a.Ld=function(a){return 180*a/Math.PI};a.Ny=function(a){var c=.366025403784439*a[0]+.366025403784439*a[1],d=Math.floor(a[0]+c),m=Math.floor(a[1]+c),b=.211324865405187*d+.211324865405187*m,c=a[0]-d+b;a=a[1]-m+b;var h=c>a?1:0,e=1-h,b=c+.211324865405187-h,f=a+.211324865405187-e,z=c+-.577350269189626,q=a+-.577350269189626,d=d%289,m=m%289,D=B(B(m)+d),e=B(B(m+e)+d+h),v=B(B(m+1)+d+1),d=Math.max(.5-(c*c+a*a),0),m=Math.max(.5-(b*b+f*f),
0),h=Math.max(.5-(z*z+q*q),0),I=2*w(.024390243902439*D)-1,p=2*w(.024390243902439*e)-1,u=2*w(.024390243902439*v)-1,D=Math.abs(I)-.5,e=Math.abs(p)-.5,v=Math.abs(u)-.5,I=I-Math.floor(I+.5),p=p-Math.floor(p+.5),u=u-Math.floor(u+.5),d=d*d*d*d*(1.79284291400159-.85373472095314*(I*I+D*D)),m=m*m*m*m*(1.79284291400159-.85373472095314*(p*p+e*e)),h=h*h*h*h*(1.79284291400159-.85373472095314*(u*u+v*v));return 130*(d*(I*c+D*a)+m*(p*b+e*f)+h*(u*z+v*q))};a.xB=function(a){var c=1/7,d=c/2,m=f(Math.floor(a[0])),b=f(Math.floor(a[1])),
h=w(a[0]);a=w(a[1]);var e=h-.5,z=h-1.5,h=a-.5;a-=1.5;var q=t(m),D=t(m+1),v=q,m=D,q=t(q+b),D=t(D+b),v=t(v+b+1),m=t(m+b+1),b=e+.7*(r(q)*c+d),I=z+.7*(r(D)*c+d),e=e+.7*(r(v)*c+d),z=z+.7*(r(m)*c+d),q=h+.7*(r(Math.floor(q*c))*c+d),h=h+.7*(r(Math.floor(D*c))*c+d),v=a+.7*(r(Math.floor(v*c))*c+d),c=a+.7*(r(Math.floor(m*c))*c+d);return Math.min(b*b+q*q,I*I+h*h,e*e+v*v,z*z+c*c)};a.Ux=function(a,c,d,m,b){b||(b=new Float32Array(4));a=P.transformQuat(c,a,u);c=d[0];var h=d[1];d=d[2];I[0]=h*h+d*d;I[1]=-h*c;I[2]=
-d*c;I[3]=-c*h;I[4]=c*c+d*d;I[5]=-d*h;I[6]=-c*d;I[7]=-h*d;I[8]=c*c+h*h;P.transformMat3(a,I,a);P.normalize(a,a);v.rotationTo(m,a,b);return b};a.kv=function(a,c){c||(c=new Float32Array(4));var d=q,m=D,d=v.setAxisAngle([0,1,0],Math.PI,v.create()),m=v.setAxisAngle([1,0,0],Math.PI/2,v.create());v.multiply(d,m,d);v.multiply(a,d,c);return c};a.ha=function(){p=0;N={}};a.S=function(a,c,d){return Math.min(Math.max(a,c),d)};a.lc=function(a,c,d,m){d=Math.exp(-d/m);return(1-d)*a+d*c};a.Yl=function(a,c,d,m,b){b||
(b=new Float32Array(a.length));d=Math.exp(-d/m);for(m=0;m<b.length;m++)b[m]=(1-d)*a[m]+d*c[m];return b};a.fH=function(a,c,d,m,b){b||(b=new Float32Array(a.length));v.slerp(a,c,Math.exp(-d/m),b)};a.y_=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.bi=function(a,c){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(c&&c==a.length||!c)return!0;return!1};a.VB=function(a,c){var d=C.fromQuat(a,I);z[0]=0;z[1]=1;z[2]=0;u[0]=d[3];u[1]=d[4];u[2]=d[5];
var m=P.cross(z,u,u);P.normalize(m,m);var b=d[7];!c&&0<b&&(m[0]*=-1,m[1]*=-1,m[2]*=-1);z[0]=d[0];z[1]=d[1];z[2]=d[2];P.normalize(z,z);v.rotationTo(z,m,D);v.multiply(D,a,a)};a.fD=function(a,c,d,m){d=d*c-.5;var b=m*c-.5;m=d-Math.floor(d);var h=b-Math.floor(b);d=Math.floor(d);var b=Math.floor(b),e=c-1,f=a[b*c+d],z=a[b*c+Math.min(d+1,e)],q=a[Math.min(b+1,e)*c+d];a=a[Math.min(b+1,e)*c+Math.min(d+1,e)];return(f*(1-m)+z*m)*(1-h)+(q*(1-m)+a*m)*h};a.Zj=function(a){for(var c=0,d=0;3>d;d++)0<(a&1<<d)&&c++;return c};
a.pG=function(a){for(var c=[0,0,0],d=0;3>d;d++)0<(a&1<<d)&&(c[2-d]=1);return c};a.Lo=function(a,c){var d=0;(1==c||2==c)&&0<(a&4)&&d++;2==c&&0<(a&2)&&d++;return d};a.rw=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"==a?c:c&3|8).toString(16)})};a.Un=function(a){var c=0,d;for(d in a)a.hasOwnProperty(d)&&c++;return c};a.dG=function(a){if(!a.length)return null;var c=Math.floor(Math.random()*a.length);return a[c]};a.FI=function(a,
c,d){d||(d=new Float32Array(3));d[0]=a[0]-c[0];d[1]=0;d[2]=a[2]-c[2];P.normalize(d,d)};a.lT=function(a,c,d){var m=a[0],b=a[1];a=a[2];var h=c[0],e=c[1],f=c[2];c=c[3];var z=e*a-f*b,q=f*m-h*a,D=h*b-e*m,v=e*D-f*q,f=f*z-h*D,h=h*q-e*z;d[0]=m+2*z*c+2*v;d[1]=b+2*q*c+2*f;d[2]=a+2*D*c+2*h};a.assert=function(a){a||l("Assertion failed")};a.l=l;a.qf=A;a.Dg=x;a.Cw=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.rH=function(a,c){for(var d in a){var m=!0,b=a[d],h=c[d];switch(typeof b){case "number":case "string":case "boolean":m=
b==h;break;case "object":m=L(b,h)}if(!m)return!1}return!0};a.Tx=function(a,c){var d=a[0],m=a[2],b=a[3];c[0]=a[1];c[1]=m;c[2]=b;c[3]=d};a.XC=function(a){a+=1;132651<a&&d.error("Color ID pool depleted");var c=Math.floor(a/2601);a%=2601;var m=Math.floor(a/51);return new Float32Array([c/51,m/51,a%51/51])};a.jx=function(a,d,m,b){q.set(a);q[3]=d;u[0]=m[3];u[1]=m[4];u[2]=m[5];D.set(u);D[3]=0;a=c.dot(q,D);if(0==a)return null;P.copy(m,u);D.set(u);D[3]=1;a=-c.dot(q,D)/a;b[0]=m[0]+a*m[3];b[1]=m[1]+a*m[4];b[2]=
m[2]+a*m[5];return b};a.$O=function(a,c,d,m){var b=c[0]-a[0],h=d[0]-a[0],e=c[1]-a[1],f=d[1]-a[1];c=c[2]-a[2];a=d[2]-a[2];m[0]=e*a-c*f;m[1]=h*c-b*a;m[2]=b*f-e*h;return m};a.rX=function(a,c){for(var d=0;d<a.length;d++)c[d]=a[d];return c};a.rG=function(a,c,d){var m=P.dot(a,c);-.9999999>m?(P.cross(Y,a,u),1E-6>P.length(u)&&P.cross(ia,a,u),P.normalize(u,u),v.setAxisAngle(u,Math.PI,d)):(P.cross(a,c,u),d.set(u),d[3]=1+m,v.normalize(d,d));return d};a.cj=function(a,c,d){if(c==d)return d-a;a=x(a);c=x(c);d=x(d);
c=2*Math.PI-c;d=x(d+c);a=x(a+c);return a>d?(d-=a,a=2*Math.PI-a,-d>a?a:d):0};a.dk=function(a,c,d){isFinite(c)&&isFinite(d)&&(a=clamp(a,c,d));return a*a*(3-2*a)};a.lerp=function(a,c,d){return c+a*(d-c)};a.jL=function(a,c){for(var d=0;d<a.length;d++)for(var m=0;m<c.length;m++)if(c[m]==a[d])return!0;return!1};a.wX=function(a){for(var c=Array(a),d=0;d<a;d++)c[d]=0;return c};a.mI=function(a,c){for(var d=Math.max(a.length,c.length),m=0;m<d;m++){var b=k((m>=a.length?0:a[m])-(m>=c.length?0:c[m]));if(b)return b}return 0};
a.Gi=function(a){return a.join(".")};a.pH=function(a){return a.split(".").map(function(a){return a|0})};a.T1=function(a,c){c[0]=Math.pow(a[0],2.2);c[1]=Math.pow(a[1],2.2);c[2]=Math.pow(a[2],2.2);return c};a.M_=function(a,c){c[0]=Math.pow(a[0],1/2.2);c[1]=Math.pow(a[1],1/2.2);c[2]=Math.pow(a[2],1/2.2);return c};a.qo=function(a){var c=a.split("://",2);return 1<c.length?(c[1]=F(c[1]),c.join("://")):F(a)};a.an=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.MN=function(a,c,d,m){m[0]=a[0];
m[1]=c[0];m[2]=d[0];m[3]=a[1];m[4]=c[1];m[5]=d[1];m[6]=a[2];m[7]=c[2];m[8]=d[2];return m}};b4w.module.__boundings=function(a,n){function k(a,d){for(var b=a[0],e=a[1],f=a[2],c=a[0],p=a[1],k=a[2],l=3;l<a.length;l+=3)var u=a[l],z=a[l+1],q=a[l+2],b=Math.max(b,u),e=Math.max(e,z),f=Math.max(f,q),c=Math.min(c,u),p=Math.min(p,z),k=Math.min(k,q);d.max_x=b;d.max_y=e;d.max_z=f;d.min_x=c;d.min_y=p;d.min_z=k;return d}function b(a,d){d||(d=new Float32Array(24));var b=a.max_x,e=a.max_y,f=a.max_z,c=a.min_x,p=a.min_y,k=a.min_z;d[0]=c;d[1]=p;d[2]=k;d[3]=b;d[4]=p;d[5]=k;d[6]=b;d[7]=e;d[8]=k;d[9]=c;d[10]=
e;d[11]=k;d[12]=c;d[13]=p;d[14]=f;d[15]=b;d[16]=p;d[17]=f;d[18]=b;d[19]=e;d[20]=f;d[21]=c;d[22]=e;d[23]=f;return d}function e(){return{$d:new Float32Array(3),ae:new Float32Array(3),be:new Float32Array(3),O:new Float32Array([0,0,0])}}function y(a,d,b,e){return{$d:new Float32Array(a),ae:new Float32Array(d),be:new Float32Array(b),O:new Float32Array([e[0],e[1],e[2]])}}function g(a,d){var b=r.PL(a,F),b=d?r.JL(a,b,C):l.identity(C),b=r.dO(b,J);f.copy(a,x);f.transformMat3(x,b,x);for(var e=x[0],k=e,c=x[1],
p=c,g=x[2],G=g,u=0,z=0,q=0,D=0,I=0,m=0,V=3;V<a.length;V+=3)x[0]=a[V],x[1]=a[V+1],x[2]=a[V+2],f.transformMat3(x,b,x),u=x[0],z=x[1],q=x[2],u>e&&(e=u),u<k&&(k=u),z>c&&(c=z),z<p&&(p=z),q>g&&(g=q),q<G&&(G=q);c-=p;g-=G;e=Math.max(e-k,1E-9);c=Math.max(c,1E-9);g=Math.max(g,1E-9);k=l.identity(C);k[0]=0!=e?1/e:1E8;k[4]=0!=c?1/c:1E8;k[8]=0!=g?1/g:1E8;l.transpose(b,H);x[0]=a[0];x[1]=a[1];x[2]=a[2];f.transformMat3(x,b,x);f.transformMat3(x,k,x);f.transformMat3(x,H,x);u=x[0];z=x[0];q=x[1];D=x[1];I=x[2];m=x[2];for(V=
3;V<a.length;V+=3)x[0]=a[V],x[1]=a[V+1],x[2]=a[V+2],f.transformMat3(x,b,x),f.transformMat3(x,k,x),f.transformMat3(x,H,x),u=Math.max(u,x[0]),z=Math.min(z,x[0]),q=Math.max(q,x[1]),D=Math.min(D,x[1]),I=Math.max(I,x[2]),m=Math.min(m,x[2]);V=Math.sqrt((u-z)*(u-z)+(q-D)*(q-D)+(I-m)*(I-m))/2;V=Math.min(V,1);M[0]=(u+z)/2;M[1]=(q+D)/2;M[2]=(I+m)/2;u=M;k=l.identity(C);k[0]=e;k[4]=c;k[8]=g;f.transformMat3(u,b,u);f.transformMat3(u,k,u);f.transformMat3(u,H,u);k=[b[0],b[3],b[6]];z=[b[1],b[4],b[7]];b=[b[2],b[5],
b[8]];f.scale(k,e*V,k);f.scale(z,c*V,z);f.scale(b,g*V,b);return y(k,z,b,u)}function B(a,d,b){f.add(d,b,a.O);f.scale(a.O,.5,a.O);a.mb=f.distance(a.O,d);return a}var w=n("__tsr"),t=n("__util"),f=n("__vec3"),r=n("__math"),l=n("__mat3");n("__quat");var A=new Float32Array(24),x=new Float32Array(3),L=new Float32Array(3),M=new Float32Array(3),F=new Float32Array(3),J=new Float32Array(9),C=new Float32Array(9),H=new Float32Array(9);new Float32Array(9);a.uq=function(a,d){d.min_x=a.min_x;d.max_x=a.max_x;d.min_y=
a.min_y;d.max_y=a.max_y;d.min_z=a.min_z;d.max_z=a.max_z};a.LW=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.bc=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.KL=function(a){var d=a.max_x-a.min_x,b=a.max_y-a.min_y;b<d&&(d=b);a=a.max_z-a.min_z;a<d&&(d=a);return d};a.Jn=function(a,d){var b=a.max_y,e=a.max_z,f=a.min_x,c=a.min_y,p=a.min_z;a.max_x=Math.max(d.max_x,a.max_x);a.max_y=Math.max(d.max_y,b);a.max_z=Math.max(d.max_z,
e);a.min_x=Math.min(d.min_x,f);a.min_y=Math.min(d.min_y,c);a.min_z=Math.min(d.min_z,p)};a.wL=k;a.Gg=function(e,d,h){h||(h=a.bc());e=b(e,A);w.pm(e,d,e);return k(e,h)};a.Kn=b;a.I1=function(b,d,h){h||(h=a.bc());var e=d.min_x,f=d.max_x,c=d.min_y,p=d.max_y,k=d.min_z;d=d.max_z;if(e>=b.max_x||f<=b.min_x||c>=b.max_y||p<=b.min_y||k>=b.max_z||d<=b.min_z)return h.min_x=-.1,h.max_x=.1,h.min_y=-.1,h.max_y=.1,h.min_z=-.2,h.max_z=-.1,h;h.min_x=Math.max(b.min_x,e);h.max_x=Math.min(b.max_x,f);h.min_y=Math.max(b.min_y,
c);h.max_y=Math.min(b.max_y,p);h.min_z=Math.max(b.min_z,k);h.max_z=Math.min(b.max_z,d);return h};a.a2=function(b,d,h){h||(h=a.bc());var e=b.max_x-b.min_x,f=b.max_y-b.min_y,c=b.max_z-b.min_z;h.min_x=b.min_x-.5*(d-1)*e;h.max_x=b.max_x+.5*(d-1)*e;h.min_y=b.min_y-.5*(d-1)*f;h.max_y=b.max_y+.5*(d-1)*f;h.min_z=b.min_z-.5*(d-1)*c;h.max_z=b.max_z+.5*(d-1)*c;return h};a.ev=function(b,d,h){h||(h=a.Ki());w.Ec(b.O,d,h.O);h.mb=b.mb*w.Oc(d);return h};a.Gk=function(a,d,b){b||(b=e());w.Ec(a.O,d,b.O);f.copy(a.$d,
b.$d);f.copy(a.ae,b.ae);f.copy(a.be,b.be);w.Tc(b.$d,d,b.$d);w.Tc(b.ae,d,b.ae);w.Tc(b.be,d,b.be);return b};a.xq=function(a,d){return{mb:a,O:new Float32Array(d)}};a.Ki=function(){return{O:new Float32Array([0,0,0]),mb:0}};a.kf=e;a.nn=y;a.yL=function(){return{O:new Float32Array([0,0,0]),mb:1E12}};a.UN=function(a,d){var b=f.subtract(d.O,a.O,f.create());0==f.length(b)&&f.set(1,0,0,b);var e=f.normalize(b,f.create()),b=f.scale(e,a.mb,f.create());f.add(b,a.O,b);var k=f.scale(e,-a.mb,f.create());f.add(k,a.O,
k);var c=f.scale(e,d.mb,f.create());f.add(c,d.O,c);var p=f.scale(e,-d.mb,f.create());f.add(p,d.O,p);b=[b,k,c,p];e=f.normalize(e,f.create());k=b[0];c=b[0];for(p=1;p<b.length;p++){var l=f.dot(b[p],e);l<f.dot(k,e)&&(k=b[p]);l>f.dot(c,e)&&(c=b[p])}e=[k,c];b=e[0];e=e[1];a.O=f.scale(f.add(b,e,f.create()),.5,f.create());a.mb=f.length(f.subtract(e,b,f.create()))/2};a.wq=g;a.gv=function(a,d){var b=t.ia(a),e=w.Vh(d,F);f.subtract(b.O,e,b.O);return b};a.WB=function(a,d){var b=d.max_y,e=d.min_y,f=Math.max(0,b-
e-2*a);return{mb:a,height:f,O:new Float32Array([0,(b+e)/2,0])}};a.YB=function(a,d){var b=d.max_y,e=d.min_y,f=Math.max(0,b-e);return{mb:a,height:f,O:new Float32Array([0,(b+e)/2,0])}};a.XB=function(a,d){var b=d.max_y,e=d.min_y,f=Math.max(0,b-e);return{mb:a,height:f,O:new Float32Array([0,(b+e)/2,0])}};a.VW=function(a,d){return a.min_x>d.max_x||a.max_x<d.min_x?!1:a.min_y>d.max_y||a.max_y<d.min_y?!1:a.min_z>d.max_z||a.max_z<d.min_z?!1:!0};a.jR=function(a){for(var d=0,b=0,e=0,f=0,c=0,p=0,k=0,l=0,u=0,z=
0,q=0,D=0,I=0,m=0,V=0;V<a.submeshes.length;V++){var Q=a.submeshes[V];if(Q.position.length){d=f=Q.position[0];b=c=Q.position[1];e=p=Q.position[2];break}}for(V=0;V<a.submeshes.length;V++){for(var Q=a.submeshes[V],r=Q.position,k=z=Q.position[0],l=q=Q.position[1],u=D=Q.position[2],x=0;x<r.length/3;x++)var y=r[3*x],L=r[3*x+1],t=r[3*x+2],d=Math.max(y,d),b=Math.max(L,b),e=Math.max(t,e),f=Math.min(y,f),c=Math.min(L,c),p=Math.min(t,p),k=Math.max(y,k),l=Math.max(L,l),u=Math.max(t,u),z=Math.min(y,z),q=Math.min(L,
q),D=Math.min(t,D),I=Math.max(Math.sqrt(y*y+L*L+t*t),I),m=Math.max(Math.sqrt(y*y+t*t),m);r=Q.boundings.bounding_box;r.max_x=k;r.min_x=z;r.max_y=l;r.min_y=q;r.max_z=u;r.min_z=D;r=A;r[0]=z;r[1]=q;r[2]=D;r[3]=k;r[4]=q;r[5]=D;r[6]=k;r[7]=l;r[8]=D;r[9]=z;r[10]=l;r[11]=D;r[12]=z;r[13]=q;r[14]=u;r[15]=k;r[16]=q;r[17]=u;r[18]=k;r[19]=l;r[20]=u;r[21]=z;r[22]=l;r[23]=u;k=g(r,!1);Q.boundings.bounding_ellipsoid_center=k.O;Q.boundings.bounding_ellipsoid_axes=[k.$d[0],k.ae[1],k.be[2]]}a.b4w_bounding_box.max_x=
d;a.b4w_bounding_box.min_x=f;a.b4w_bounding_box.max_y=b;a.b4w_bounding_box.min_y=c;a.b4w_bounding_box.max_z=e;a.b4w_bounding_box.min_z=p;a.b4w_bounding_box_source.max_x=d;a.b4w_bounding_box_source.min_x=f;a.b4w_bounding_box_source.max_y=b;a.b4w_bounding_box_source.min_y=c;a.b4w_bounding_box_source.max_z=e;a.b4w_bounding_box_source.min_z=p;a.b4w_bounding_sphere_radius=I;a.b4w_bounding_cylinder_radius=m;r=A;r[0]=f;r[1]=c;r[2]=p;r[3]=d;r[4]=c;r[5]=p;r[6]=d;r[7]=b;r[8]=p;r[9]=f;r[10]=b;r[11]=p;r[12]=
f;r[13]=c;r[14]=e;r[15]=d;r[16]=c;r[17]=e;r[18]=d;r[19]=b;r[20]=e;r[21]=f;r[22]=b;r[23]=e;k=g(r,!1);a.b4w_bounding_ellipsoid_center=k.O;a.b4w_bounding_ellipsoid_axes=[k.$d[0],k.ae[1],k.be[2]]};a.TO=function(b){var d=b.subarray(0,3),h=b.subarray(6,9),e=b.subarray(12,15),k=b.subarray(18,21);b=f.subtract(h,d,x);f.normalize(b,b);var c=t.$O(d,h,e,L),c=f.cross(c,b,c);f.normalize(c,c);var p=f.create(),l=f.create();f.subtract(h,d,M);l[0]=f.dot(M,b);l[1]=f.dot(M,c);h=f.create();f.subtract(e,d,M);h[0]=f.dot(M,
b);h[1]=f.dot(M,c);e=f.create();f.subtract(k,d,M);e[0]=f.dot(M,b);e[1]=f.dot(M,c);k=a.Ki();e=[p,l,h,e];p=B(k,e[0],e[1]);for(k=2;k<e.length;k++)if(f.distance(p.O,e[k])>p.mb){for(var g=p,p=e,l=e[k],h=k-1,g=B(g,l,p[0]),u=1;u<=h;u++)if(f.distance(g.O,p[u])>g.mb){for(var z=g,g=p,q=l,D=p[u],I=u-1,z=B(z,q,D),m=0;m<=I;m++)if(f.distance(z.O,g[m])>z.mb){var V=q,r=D,A=g[m],y=f.subtract(r,A,M),y=f.squaredLength(y),w=f.subtract(V,A,M),C=f.squaredLength(w),w=f.subtract(V,r,M),F=f.squaredLength(w),w=y*(C+F-y),Y=
C*(F+y-C),y=F*(y+C-F),C=w+Y+y;f.copy(V,z.O);f.scale(z.O,w/C,z.O);f.scaleAndAdd(z.O,r,Y/C,z.O);f.scaleAndAdd(z.O,A,y/C,z.O);z.mb=f.distance(z.O,V)}g=z}p=g}k=p;b=f.scale(b,k.O[0],M);f.scaleAndAdd(b,c,k.O[1],b);f.add(b,d,k.O);return k}};b4w.module.__tsr=function(a,n){function k(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function b(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function e(a,b,e,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=b;f[4]=e[0];f[5]=e[1];f[6]=e[2];f[7]=e[3];return f}function y(a,b,e){var f=b[0],k=b[1],l=b[2],g=b[3],d=b[4],h=b[5],v=b[6];b=b[7];var r=a[0]*g,c=a[1]*g,p=a[2]*g;a=b*r+h*p-v*c;var g=b*c+v*r-d*p,A=b*p+d*c-h*r,r=-d*r-h*c-v*p;e[0]=a*b+r*-d+g*-v-A*-h;e[1]=g*b+r*-h+A*-d-a*-v;e[2]=A*b+r*-v+a*-h-g*-d;
e[0]+=f;e[1]+=k;e[2]+=l;return e}var g=n("__mat4"),B=n("__quat"),w=n("__util"),t=n("__vec3"),f=Math.sin(-Math.PI/4),r=-f,l=new Float32Array(3),A=new Float32Array(4),x=new Float32Array(16);a.create=k;a.oY=function(a,b,e,f,l,g,r,d){var h=k();h[0]=a;h[1]=b;h[2]=e;h[3]=f;h[4]=l;h[5]=g;h[6]=r;h[7]=d;return h};a.Zf=b;a.pY=function(a,e,f,k,l,g,r,d){var h=b();h[0]=a;h[1]=e;h[2]=f;h[3]=k;h[4]=l;h[5]=g;h[6]=r;h[7]=d;return h};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];
b[6]=a[6];b[7]=a[7];return b};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.qh=e;a.ff=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.ve=function(a,b){b[3]=a;return b};a.mS=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.ri=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.q=function(a){return a.subarray(0,3)};a.Vh=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Oc=function(a){return a[3]};a.B=function(a){return a.subarray(4,
8)};a.Fw=function(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b};a.invert=function(a,b){var e=1/a[3];if(!e)return null;var f=a[0],k=a[1],l=a[2];A[0]=a[4];A[1]=a[5];A[2]=a[6];A[3]=a[7];B.invert(A,A);var g=A[0],d=A[1],h=A[2],v=A[3],f=f*e,k=k*e,r=l*e,l=v*f+d*r-h*k,c=v*k+h*f-g*r,p=v*r+g*k-d*f,f=-g*f-d*k-h*r;b[0]=-(l*v+f*-g+c*-h-p*-d);b[1]=-(c*v+f*-d+p*-g-l*-h);b[2]=-(p*v+f*-h+l*-d-c*-g);b[3]=e;b[4]=g;b[5]=d;b[6]=h;b[7]=v;return b};a.GH=function(a,b){var e=a[3];g.fromRotationTranslation(a.subarray(4,
8),a.subarray(0,3),b);for(var f=0;12>f;f++)b[f]*=e};a.Wg=function(a,b){var f=w.cF(a,l),k=w.bF(a),g=w.Jr(a,A);e(f,k,g,b)};a.multiply=function(a,b,e){y(b,a,e);e[3]=a[3]*b[3];var f=a[4],k=a[5],l=a[6];a=a[7];var g=b[4],d=b[5],h=b[6];b=b[7];e[4]=f*b+a*g+k*h-l*d;e[5]=k*b+a*d+l*g-f*h;e[6]=l*b+a*h+f*d-k*g;e[7]=a*b-f*g-k*d-l*h;return e};a.mT=function(a,b,e){var f=b[3];b=g.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),x);for(var k=0;12>k;k++)b[k]*=f;g.multiply(b,a,e);return e};a.Ec=y;a.p2=function(a,
b,e){var f=b[3],k=a[0]-b[0],l=a[1]-b[1],g=a[2]-b[2];a=b[4];var d=b[5],h=b[6];b=b[7];var v=a*a+d*d+h*h+b*b,v=v?1/v:0;a=-a*v;d=-d*v;h=-h*v;b*=v;var v=b*k+d*g-h*l,r=b*l+h*k-a*g,c=b*g+a*l-d*k,k=-a*k-d*l-h*g;e[0]=v*b+k*-a+r*-h-c*-d;e[1]=r*b+k*-d+c*-a-v*-h;e[2]=c*b+k*-h+v*-d-r*-a;e[0]/=f;e[1]/=f;e[2]/=f;return e};a.pm=function(a,b,e,f){f||(f=0);var k=a.length,l=b[0],g=b[1],d=b[2],h=b[3],v=b[4],r=b[5],c=b[6];b=b[7];for(var p=0;p<k;p+=3){var A=a[p]*h,G=a[p+1]*h,u=a[p+2]*h,z=b*A+r*u-c*G,q=b*G+c*A-v*u,D=b*
u+v*G-r*A,A=-v*A-r*G-c*u;e[f+p]=z*b+A*-v+q*-c-D*-r;e[f+p+1]=q*b+A*-r+D*-v-z*-c;e[f+p+2]=D*b+A*-c+z*-r-q*-v;e[f+p]+=l;e[f+p+1]+=g;e[f+p+2]+=d}};a.QH=function(a,b,e,f){f||(f=0);var k=a.length,l=b[3],g=b[4],d=b[5],h=b[6];b=b[7];for(var v=0;v<k;v+=3){var r=a[v]*l,c=a[v+1]*l,p=a[v+2]*l,A=b*r+d*p-h*c,G=b*c+h*r-g*p,u=b*p+g*c-d*r,r=-g*r-d*c-h*p;e[f+v]=A*b+r*-g+G*-h-u*-d;e[f+v+1]=G*b+r*-d+u*-g-A*-h;e[f+v+2]=u*b+r*-h+A*-d-G*-g}};a.Tc=function(a,b,e){var f=b[3],k=b[4],l=b[5],g=b[6];b=b[7];var d=a[0]*f,h=a[1]*
f,v=a[2]*f;a=b*d+l*v-g*h;var f=b*h+g*d-k*v,r=b*v+k*h-l*d,d=-k*d-l*h-g*v;e[0]=a*b+d*-k+f*-g-r*-l;e[1]=f*b+d*-l+r*-k-a*-g;e[2]=r*b+d*-g+a*-l-f*-k};a.RH=function(a,b,e,f){f||(f=0);var k=a.length,l=b[3],g=b[4],d=b[5],h=b[6];b=b[7];for(var v=0;v<k;v+=4){var r=a[v]*l,c=a[v+1]*l,p=a[v+2]*l,A=b*r+d*p-h*c,G=b*c+h*r-g*p,u=b*p+g*c-d*r,r=-g*r-d*c-h*p;e[f+v]=A*b+r*-g+G*-h-u*-d;e[f+v+1]=G*b+r*-d+u*-g-A*-h;e[f+v+2]=u*b+r*-h+A*-d-G*-g;e[f+v+3]=a[v+3]}};a.translate=function(a,b,e){var f=a[3],k=a[4],l=a[5],g=a[6],
d=a[7],h=b[0]*f,v=b[1]*f,r=b[2]*f;b=d*h+l*r-g*v;var f=d*v+g*h-k*r,c=d*r+k*v-l*h,h=-k*h-l*v-g*r;e[0]=a[0]+b*d+h*-k+f*-g-c*-l;e[1]=a[1]+f*d+h*-l+c*-k-b*-g;e[2]=a[2]+c*d+h*-g+b*-l-f*-k;e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];return e};a.Xw=function(a,b,e,f){t.lerp(a.subarray(0,3),b.subarray(0,3),e,f.subarray(0,3));var k=a[3];f[3]=k+e*(b[3]-k);B.slerp(a.subarray(4,8),b.subarray(4,8),e,f.subarray(4,8));return f};a.YX=function(a,b,e,f){var k=a.subarray(0,3),l=b.subarray(0,3),g=f.subarray(0,3);
g[0]=l[0]*(e+1)-k[0]*e;g[1]=l[1]*(e+1)-k[1]*e;g[2]=l[2]*(e+1)-k[2]*e;f[3]=b[3]*(e+1)-a[3]*e;a=a.subarray(4,8);b=b.subarray(4,8);k=f.subarray(4,8);k[0]=b[0]*(e+1)-a[0]*e;k[1]=b[1]*(e+1)-a[1]*e;k[2]=b[2]*(e+1)-a[2]*e;k[3]=b[3]*(e+1)-a[3]*e;B.normalize(k,k);return f};a.AP=function(a,b,e,f,k){k[0]=a[0]+b*e[0];k[1]=a[1]+b*e[1];k[2]=a[2]+b*e[2];k[3]=a[3];e=f[0];var l=f[1];f=f[2];var g=a[4],d=a[5],h=a[6],v=a[7];k[4]=.5*(e*v+l*h-f*d);k[5]=.5*(l*v+f*g-e*h);k[6]=.5*(f*v+e*d-l*g);k[7]=.5*(-e*g-l*d-f*h);k[4]=
a[4]+k[4]*b;k[5]=a[5]+k[5]*b;k[6]=a[6]+k[6]*b;k[7]=a[7]+k[7]*b;a=k[4];b=k[5];e=k[6];l=k[7];a=a*a+b*b+e*e+l*l;0<a&&(a=1/Math.sqrt(a),k[4]*=a,k[5]*=a,k[6]*=a,k[7]*=a)};a.HH=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var e=a[4],k=a[5],l=a[6],g=a[7];b[4]=e*r+g*f;b[5]=k*r+l*f;b[6]=l*r-k*f;b[7]=g*r-e*f};a.hT=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__vec3=function(a){var n="undefined"!==typeof Float32Array?Float32Array:Array,k=Math.random;a.create=function(){var a=new n(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var e=new n(3);e[0]=a[0];e[1]=a[1];e[2]=a[2];return e};a.fromValues=function(a,e,k){var g=new n(3);g[0]=a;g[1]=e;g[2]=k;return g};a.copy=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];return e};a.set=function(a,e,k,g){g[0]=a;g[1]=e;g[2]=k;return g};a.add=function(a,e,k){k[0]=a[0]+e[0];k[1]=a[1]+e[1];k[2]=a[2]+e[2];
return k};a.subtract=function(a,e,k){k[0]=a[0]-e[0];k[1]=a[1]-e[1];k[2]=a[2]-e[2];return k};a.sub=a.subtract;a.multiply=function(a,e,k){k[0]=a[0]*e[0];k[1]=a[1]*e[1];k[2]=a[2]*e[2];return k};a.mul=a.multiply;a.divide=function(a,e,k){k[0]=a[0]/e[0];k[1]=a[1]/e[1];k[2]=a[2]/e[2];return k};a.div=a.divide;a.min=function(a,e,k){k[0]=Math.min(a[0],e[0]);k[1]=Math.min(a[1],e[1]);k[2]=Math.min(a[2],e[2]);return k};a.max=function(a,e,k){k[0]=Math.max(a[0],e[0]);k[1]=Math.max(a[1],e[1]);k[2]=Math.max(a[2],
e[2]);return k};a.scale=function(a,e,k){k[0]=a[0]*e;k[1]=a[1]*e;k[2]=a[2]*e;return k};a.scaleAndAdd=function(a,e,k,g){g[0]=a[0]+e[0]*k;g[1]=a[1]+e[1]*k;g[2]=a[2]+e[2]*k;return g};a.distance=function(a,e){var k=e[0]-a[0],g=e[1]-a[1],B=e[2]-a[2];return Math.sqrt(k*k+g*g+B*B)};a.dist=a.distance;a.squaredDistance=function(a,e){var k=e[0]-a[0],g=e[1]-a[1],B=e[2]-a[2];return k*k+g*g+B*B};a.sqrDist=a.squaredDistance;a.length=function(a){var e=a[0],k=a[1];a=a[2];return Math.sqrt(e*e+k*k+a*a)};a.len=a.length;
a.squaredLength=function(a){var e=a[0],k=a[1];a=a[2];return e*e+k*k+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,e){e[0]=-a[0];e[1]=-a[1];e[2]=-a[2];return e};a.inverse=function(a,e){e[0]=1/a[0];e[1]=1/a[1];e[2]=1/a[2];return e};a.normalize=function(a,e){var k=a[0],g=a[1],B=a[2],k=k*k+g*g+B*B;0<k&&(k=1/Math.sqrt(k),e[0]=a[0]*k,e[1]=a[1]*k,e[2]=a[2]*k);return e};a.dot=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]};a.cross=function(a,e,k){var g=a[0],B=a[1];a=a[2];var w=e[0],t=e[1];e=e[2];
k[0]=B*e-a*t;k[1]=a*w-g*e;k[2]=g*t-B*w;return k};a.lerp=function(a,e,k,g){var B=a[0],w=a[1];a=a[2];g[0]=B+k*(e[0]-B);g[1]=w+k*(e[1]-w);g[2]=a+k*(e[2]-a);return g};a.i_=function(a,e,k,g,B,w){var t=B*B,f=t*(2*B-3)+1,r=t*(B-2)+B,l=t*(B-1);B=t*(3-2*B);w[0]=a[0]*f+e[0]*r+k[0]*l+g[0]*B;w[1]=a[1]*f+e[1]*r+k[1]*l+g[1]*B;w[2]=a[2]*f+e[2]*r+k[2]*l+g[2]*B;return w};a.kB=function(a,e,k,g,B,w){var t=1-B,f=t*t,r=B*B,l=f*t,f=3*B*f,t=3*r*t;B*=r;w[0]=a[0]*l+e[0]*f+k[0]*t+g[0]*B;w[1]=a[1]*l+e[1]*f+k[1]*t+g[1]*B;w[2]=
a[2]*l+e[2]*f+k[2]*t+g[2]*B;return w};a.random=function(a,e){a=a||1;var y=2*k()*Math.PI,g=2*k()-1,B=Math.sqrt(1-g*g)*a;e[0]=Math.cos(y)*B;e[1]=Math.sin(y)*B;e[2]=g*a;return e};a.transformMat4=function(a,e,k){var g=a[0],B=a[1];a=a[2];var w=e[3]*g+e[7]*B+e[11]*a+e[15],w=w||1;k[0]=(e[0]*g+e[4]*B+e[8]*a+e[12])/w;k[1]=(e[1]*g+e[5]*B+e[9]*a+e[13])/w;k[2]=(e[2]*g+e[6]*B+e[10]*a+e[14])/w;return k};a.transformMat3=function(a,e,k){var g=a[0],B=a[1];a=a[2];k[0]=g*e[0]+B*e[3]+a*e[6];k[1]=g*e[1]+B*e[4]+a*e[7];
k[2]=g*e[2]+B*e[5]+a*e[8];return k};a.transformQuat=function(a,e,k){var g=a[0],B=a[1],w=a[2];a=e[0];var t=e[1],f=e[2];e=e[3];var r=e*g+t*w-f*B,l=e*B+f*g-a*w,A=e*w+a*B-t*g,g=-a*g-t*B-f*w;k[0]=r*e+g*-a+l*-f-A*-t;k[1]=l*e+g*-t+A*-a-r*-f;k[2]=A*e+g*-f+r*-t-l*-a;return k};a.rotateX=function(a,e,k,g){var B=[],w=[];B[0]=a[0]-e[0];B[1]=a[1]-e[1];B[2]=a[2]-e[2];w[0]=B[0];w[1]=B[1]*Math.cos(k)-B[2]*Math.sin(k);w[2]=B[1]*Math.sin(k)+B[2]*Math.cos(k);g[0]=w[0]+e[0];g[1]=w[1]+e[1];g[2]=w[2]+e[2];return g};a.rotateY=
function(a,e,k,g){var B=[],w=[];B[0]=a[0]-e[0];B[1]=a[1]-e[1];B[2]=a[2]-e[2];w[0]=B[2]*Math.sin(k)+B[0]*Math.cos(k);w[1]=B[1];w[2]=B[2]*Math.cos(k)-B[0]*Math.sin(k);g[0]=w[0]+e[0];g[1]=w[1]+e[1];g[2]=w[2]+e[2];return g};a.rotateZ=function(a,e,k,g){var B=[],w=[];B[0]=a[0]-e[0];B[1]=a[1]-e[1];B[2]=a[2]-e[2];w[0]=B[0]*Math.cos(k)-B[1]*Math.sin(k);w[1]=B[0]*Math.sin(k)+B[1]*Math.cos(k);w[2]=B[2];g[0]=w[0]+e[0];g[1]=w[1]+e[1];g[2]=w[2]+e[2];return g};a.forEach=function(){var b=a.create();return function(a,
k,g,B,w,t){k||(k=3);g||(g=0);for(B=B?Math.min(B*k+g,a.length):a.length;g<B;g+=k)b[0]=a[g],b[1]=a[g+1],b[2]=a[g+2],w(b,t,b),a[g]=b[0],a[g+1]=b[1],a[g+2]=b[2];return a}}();a.hW=function(b,e){var k=a.fromValues(b[0],b[1],b[2]),g=a.fromValues(e[0],e[1],e[2]);a.normalize(k,k);a.normalize(g,g);k=a.dot(k,g);return 1<k?0:Math.acos(k)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var n="undefined"!==typeof Float32Array?Float32Array:Array,k=Math.random;a.create=function(){var a=new n(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var e=new n(4);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];return e};a.fromValues=function(a,e,k,g){var B=new n(4);B[0]=a;B[1]=e;B[2]=k;B[3]=g;return B};a.copy=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];return e};a.set=function(a,e,k,g,B){B[0]=a;B[1]=e;B[2]=k;B[3]=g;return B};a.add=function(a,e,k){k[0]=
a[0]+e[0];k[1]=a[1]+e[1];k[2]=a[2]+e[2];k[3]=a[3]+e[3];return k};a.subtract=function(a,e,k){k[0]=a[0]-e[0];k[1]=a[1]-e[1];k[2]=a[2]-e[2];k[3]=a[3]-e[3];return k};a.sub=a.subtract;a.multiply=function(a,e,k){k[0]=a[0]*e[0];k[1]=a[1]*e[1];k[2]=a[2]*e[2];k[3]=a[3]*e[3];return k};a.mul=a.multiply;a.divide=function(a,e,k){k[0]=a[0]/e[0];k[1]=a[1]/e[1];k[2]=a[2]/e[2];k[3]=a[3]/e[3];return k};a.div=a.divide;a.min=function(a,e,k){k[0]=Math.min(a[0],e[0]);k[1]=Math.min(a[1],e[1]);k[2]=Math.min(a[2],e[2]);k[3]=
Math.min(a[3],e[3]);return k};a.max=function(a,e,k){k[0]=Math.max(a[0],e[0]);k[1]=Math.max(a[1],e[1]);k[2]=Math.max(a[2],e[2]);k[3]=Math.max(a[3],e[3]);return k};a.scale=function(a,e,k){k[0]=a[0]*e;k[1]=a[1]*e;k[2]=a[2]*e;k[3]=a[3]*e;return k};a.scaleAndAdd=function(a,e,k,g){g[0]=a[0]+e[0]*k;g[1]=a[1]+e[1]*k;g[2]=a[2]+e[2]*k;g[3]=a[3]+e[3]*k;return g};a.distance=function(a,e){var k=e[0]-a[0],g=e[1]-a[1],B=e[2]-a[2],w=e[3]-a[3];return Math.sqrt(k*k+g*g+B*B+w*w)};a.dist=a.distance;a.squaredDistance=
function(a,e){var k=e[0]-a[0],g=e[1]-a[1],B=e[2]-a[2],w=e[3]-a[3];return k*k+g*g+B*B+w*w};a.sqrDist=a.squaredDistance;a.length=function(a){var e=a[0],k=a[1],g=a[2];a=a[3];return Math.sqrt(e*e+k*k+g*g+a*a)};a.len=a.length;a.squaredLength=function(a){var e=a[0],k=a[1],g=a[2];a=a[3];return e*e+k*k+g*g+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,e){e[0]=-a[0];e[1]=-a[1];e[2]=-a[2];e[3]=-a[3];return e};a.inverse=function(a,e){e[0]=1/a[0];e[1]=1/a[1];e[2]=1/a[2];e[3]=1/a[3];return e};a.normalize=
function(a,e){var k=a[0],g=a[1],B=a[2],w=a[3],t=k*k+g*g+B*B+w*w;0<t&&(t=1/Math.sqrt(t),e[0]=k*t,e[1]=g*t,e[2]=B*t,e[3]=w*t);return e};a.dot=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]*e[3]};a.lerp=function(a,e,k,g){var B=a[0],w=a[1],t=a[2];a=a[3];g[0]=B+k*(e[0]-B);g[1]=w+k*(e[1]-w);g[2]=t+k*(e[2]-t);g[3]=a+k*(e[3]-a);return g};a.random=function(b,e){b=b||1;e[0]=k();e[1]=k();e[2]=k();e[3]=k();a.normalize(e,e);a.scale(e,b,e);return e};a.transformMat4=function(a,e,k){var g=a[0],B=a[1],w=
a[2];a=a[3];k[0]=e[0]*g+e[4]*B+e[8]*w+e[12]*a;k[1]=e[1]*g+e[5]*B+e[9]*w+e[13]*a;k[2]=e[2]*g+e[6]*B+e[10]*w+e[14]*a;k[3]=e[3]*g+e[7]*B+e[11]*w+e[15]*a;return k};a.transformQuat=function(a,e,k){var g=a[0],B=a[1],w=a[2],t=e[0],f=e[1],r=e[2];e=e[3];var l=e*g+f*w-r*B,A=e*B+r*g-t*w,x=e*w+t*B-f*g,g=-t*g-f*B-r*w;k[0]=l*e+g*-t+A*-r-x*-f;k[1]=A*e+g*-f+x*-t-l*-r;k[2]=x*e+g*-r+l*-f-A*-t;k[3]=a[3];return k};a.forEach=function(){var b=a.create();return function(a,k,g,B,w,t){k||(k=4);g||(g=0);for(B=B?Math.min(B*
k+g,a.length):a.length;g<B;g+=k)b[0]=a[g],b[1]=a[g+1],b[2]=a[g+2],b[3]=a[g+3],w(b,t,b),a[g]=b[0],a[g+1]=b[1],a[g+2]=b[2],a[g+3]=b[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,n){var k=n("__vec3"),b=n("__vec4"),e=n("__mat3"),y="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new y(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=k.create(),e=k.fromValues(1,0,0),w=k.fromValues(0,1,0);return function(t,f,r){var l=k.dot(t,f);if(-.9999999>l)return k.cross(e,t,b),1E-6>k.length(b)&&k.cross(w,t,b),k.normalize(b,b),a.setAxisAngle(b,Math.PI,r),r;if(.9999999<l)return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r;k.cross(t,
f,b);r[0]=b[0];r[1]=b[1];r[2]=b[2];r[3]=1+l;return a.normalize(r,r)}}();a.setAxes=function(){var b=e.create();return function(e,k,t,f){b[0]=k[0];b[3]=k[1];b[6]=k[2];b[1]=t[0];b[4]=t[1];b[7]=t[2];b[2]=-e[0];b[5]=-e[1];b[8]=-e[2];return a.normalize(a.fromMat3(b,f),f)}}();a.clone=b.clone;a.fromValues=b.fromValues;a.copy=b.copy;a.set=b.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,e){b*=.5;var k=Math.sin(b);e[0]=k*a[0];e[1]=k*a[1];e[2]=k*a[2];e[3]=Math.cos(b);
return e};a.add=b.add;a.multiply=function(a,b,e){var k=a[0],f=a[1],r=a[2];a=a[3];var l=b[0],A=b[1],x=b[2];b=b[3];e[0]=k*b+a*l+f*x-r*A;e[1]=f*b+a*A+r*l-k*x;e[2]=r*b+a*x+k*A-f*l;e[3]=a*b-k*l-f*A-r*x;return e};a.mul=a.multiply;a.scale=b.scale;a.rotateX=function(a,b,e){b*=.5;var k=a[0],f=a[1],r=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);e[0]=k*b+a*l;e[1]=f*b+r*l;e[2]=r*b-f*l;e[3]=a*b-k*l;return e};a.rotateY=function(a,b,e){b*=.5;var k=a[0],f=a[1],r=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);e[0]=k*
b-r*l;e[1]=f*b+a*l;e[2]=r*b+k*l;e[3]=a*b-f*l;return e};a.rotateZ=function(a,b,e){b*=.5;var k=a[0],f=a[1],r=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);e[0]=k*b+f*l;e[1]=f*b-k*l;e[2]=r*b+a*l;e[3]=a*b-r*l;return e};a.calculateW=function(a,b){var e=a[0],k=a[1],f=a[2];b[0]=e;b[1]=k;b[2]=f;b[3]=Math.sqrt(Math.abs(1-e*e-k*k-f*f));return b};a.dot=b.dot;a.lerp=b.lerp;a.slerp=function(a,b,e,k){var f=a[0],r=a[1],l=a[2];a=a[3];var A=b[0],x=b[1],y=b[2];b=b[3];var n,F,J;F=f*A+r*x+l*y+a*b;0>F&&(F=-F,A=-A,x=-x,
y=-y,b=-b);1E-6<1-F?(n=Math.acos(F),J=Math.sin(n),F=Math.sin((1-e)*n)/J,e=Math.sin(e*n)/J):F=1-e;k[0]=F*f+e*A;k[1]=F*r+e*x;k[2]=F*l+e*y;k[3]=F*a+e*b;return k};a.S1=function(){var b=a.create(),e=a.create();return function(k,t,f,r,l,A){a.slerp(k,r,l,b);a.slerp(t,f,l,e);a.slerp(b,e,2*l*(1-l),A);return A}}();a.invert=function(a,b){var e=a[0],k=a[1],f=a[2],r=a[3],l=e*e+k*k+f*f+r*r,l=l?1/l:0;b[0]=-e*l;b[1]=-k*l;b[2]=-f*l;b[3]=r*l;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=b.length;a.len=a.length;a.squaredLength=b.squaredLength;a.sqrLen=a.squaredLength;a.normalize=b.normalize;a.fromMat3=function(a,b){var e=a[0]+a[4]+a[8];if(0<e)e=Math.sqrt(e+1),b[3]=.5*e,e=.5/e,b[0]=(a[5]-a[7])*e,b[1]=(a[6]-a[2])*e,b[2]=(a[1]-a[3])*e;else{var k=0;a[4]>a[0]&&(k=1);a[8]>a[3*k+k]&&(k=2);var f=(k+1)%3,r=(k+2)%3,e=Math.sqrt(a[3*k+k]-a[3*f+f]-a[3*r+r]+1);b[k]=.5*e;e=.5/e;b[3]=(a[3*f+r]-a[3*r+f])*e;b[f]=(a[3*f+k]+a[3*k+f])*e;b[r]=(a[3*r+k]+a[3*k+r])*e}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var n="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new n(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};a.clone=function(a){var b=new n(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,b){if(b===a){var e=a[1],y=a[2],g=a[5];b[1]=a[3];b[2]=a[6];b[3]=e;b[5]=a[7];b[6]=y;b[7]=g}else b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8];return b};a.invert=function(a,b){var e=a[0],y=a[1],g=a[2],B=a[3],w=a[4],t=a[5],f=a[6],r=a[7],l=a[8],A=l*w-t*r,x=-l*B+t*f,L=
r*B-w*f,n=e*A+y*x+g*L;if(!n)return null;n=1/n;b[0]=A*n;b[1]=(-l*y+g*r)*n;b[2]=(t*y-g*w)*n;b[3]=x*n;b[4]=(l*e-g*f)*n;b[5]=(-t*e+g*B)*n;b[6]=L*n;b[7]=(-r*e+y*f)*n;b[8]=(w*e-y*B)*n;return b};a.adjoint=function(a,b){var e=a[0],y=a[1],g=a[2],B=a[3],w=a[4],t=a[5],f=a[6],r=a[7],l=a[8];b[0]=w*l-t*r;b[1]=g*r-y*l;b[2]=y*t-g*w;b[3]=t*f-B*l;b[4]=e*l-g*f;b[5]=g*B-e*t;b[6]=B*r-w*f;b[7]=y*f-e*r;b[8]=e*w-y*B;return b};a.determinant=function(a){var b=a[3],e=a[4],y=a[5],g=a[6],B=a[7],w=a[8];return a[0]*(w*e-y*B)+a[1]*
(-w*b+y*g)+a[2]*(B*b-e*g)};a.multiply=function(a,b,e){var y=a[0],g=a[1],B=a[2],w=a[3],t=a[4],f=a[5],r=a[6],l=a[7];a=a[8];var A=b[0],x=b[1],L=b[2],n=b[3],F=b[4],J=b[5],C=b[6],H=b[7];b=b[8];e[0]=A*y+x*w+L*r;e[1]=A*g+x*t+L*l;e[2]=A*B+x*f+L*a;e[3]=n*y+F*w+J*r;e[4]=n*g+F*t+J*l;e[5]=n*B+F*f+J*a;e[6]=C*y+H*w+b*r;e[7]=C*g+H*t+b*l;e[8]=C*B+H*f+b*a;return e};a.mul=a.multiply;a.translate=function(a,b,e){var y=a[0],g=a[1],B=a[2],w=a[3],t=a[4],f=a[5],r=a[6],l=a[7];a=a[8];var A=b[0];b=b[1];e[0]=y;e[1]=g;e[2]=B;
e[3]=w;e[4]=t;e[5]=f;e[6]=A*y+b*w+r;e[7]=A*g+b*t+l;e[8]=A*B+b*f+a;return e};a.rotate=function(a,b,e){var y=a[0],g=a[1],B=a[2],w=a[3],t=a[4],f=a[5],r=a[6],l=a[7];a=a[8];var A=Math.sin(b);b=Math.cos(b);e[0]=b*y+A*w;e[1]=b*g+A*t;e[2]=b*B+A*f;e[3]=b*w-A*y;e[4]=b*t-A*g;e[5]=b*f-A*B;e[6]=r;e[7]=l;e[8]=a;return e};a.scale=function(a,b,e){var y=b[0];b=b[1];e[0]=y*a[0];e[1]=y*a[1];e[2]=y*a[2];e[3]=b*a[3];e[4]=b*a[4];e[5]=b*a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];return e};a.pO=function(a,b){b[0]=1;b[1]=0;b[2]=
0;b[3]=0;b[4]=1;b[5]=0;b[6]=a[0];b[7]=a[1];b[8]=1;return b};a.nO=function(a,b){var e=Math.sin(a),y=Math.cos(a);b[0]=y;b[1]=e;b[2]=0;b[3]=-e;b[4]=y;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};a.oO=function(a,b){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=a[1];b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};a.fromMat2d=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=0;b[3]=a[2];b[4]=a[3];b[5]=0;b[6]=a[4];b[7]=a[5];b[8]=1;return b};a.fromQuat=function(a,b){var e=a[0],y=a[1],g=a[2],B=a[3],w=e+e,t=y+y,f=g+g,e=e*w,r=y*w,y=y*t,l=g*w,A=
g*t,g=g*f,w=B*w,t=B*t,B=B*f;b[0]=1-y-g;b[3]=r-B;b[6]=l+t;b[1]=r+B;b[4]=1-e-g;b[7]=A-w;b[2]=l-t;b[5]=A+w;b[8]=1-e-y;return b};a.normalFromMat4=function(a,b){var e=a[0],y=a[1],g=a[2],B=a[3],w=a[4],t=a[5],f=a[6],r=a[7],l=a[8],A=a[9],x=a[10],L=a[11],n=a[12],F=a[13],J=a[14],C=a[15],H=e*t-y*w,K=e*f-g*w,d=e*r-B*w,h=y*f-g*t,v=y*r-B*t,P=g*r-B*f,c=l*F-A*n,p=l*J-x*n,l=l*C-L*n,N=A*J-x*F,A=A*C-L*F,x=x*C-L*J,L=H*x-K*A+d*N+h*l-v*p+P*c;if(!L)return null;L=1/L;b[0]=(t*x-f*A+r*N)*L;b[1]=(f*l-w*x-r*p)*L;b[2]=(w*A-t*
l+r*c)*L;b[3]=(g*A-y*x-B*N)*L;b[4]=(e*x-g*l+B*p)*L;b[5]=(y*l-e*A-B*c)*L;b[6]=(F*P-J*v+C*h)*L;b[7]=(J*d-n*P-C*K)*L;b[8]=(n*v-F*d+C*H)*L;return b};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.mO=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var n="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new n(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var b=new n(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.copy=function(a,b){b[0]=a[0];
b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,b){if(b===a){var e=a[1],y=a[2],g=a[3],B=a[6],w=a[7],t=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=e;b[6]=a[9];b[7]=a[13];b[8]=y;b[9]=B;b[11]=a[14];b[12]=g;b[13]=
w;b[14]=t}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};a.invert=function(a,b){var e=a[0],y=a[1],g=a[2],B=a[3],w=a[4],t=a[5],f=a[6],r=a[7],l=a[8],A=a[9],x=a[10],L=a[11],n=a[12],F=a[13],J=a[14],C=a[15],H=e*t-y*w,K=e*f-g*w,d=e*r-B*w,h=y*f-g*t,v=y*r-B*t,P=g*r-B*f,c=l*F-A*n,p=l*J-x*n,N=l*C-L*n,G=A*J-x*F,u=A*C-L*F,z=x*C-L*J,q=H*z-K*u+d*G+h*N-v*p+P*c;if(!q)return null;
q=1/q;b[0]=(t*z-f*u+r*G)*q;b[1]=(g*u-y*z-B*G)*q;b[2]=(F*P-J*v+C*h)*q;b[3]=(x*v-A*P-L*h)*q;b[4]=(f*N-w*z-r*p)*q;b[5]=(e*z-g*N+B*p)*q;b[6]=(J*d-n*P-C*K)*q;b[7]=(l*P-x*d+L*K)*q;b[8]=(w*u-t*N+r*c)*q;b[9]=(y*N-e*u-B*c)*q;b[10]=(n*v-F*d+C*H)*q;b[11]=(A*d-l*v-L*H)*q;b[12]=(t*p-w*G-f*c)*q;b[13]=(e*G-y*p+g*c)*q;b[14]=(F*K-n*h-J*H)*q;b[15]=(l*h-A*K+x*H)*q;return b};a.adjoint=function(a,b){var e=a[0],y=a[1],g=a[2],B=a[3],w=a[4],t=a[5],f=a[6],r=a[7],l=a[8],A=a[9],x=a[10],L=a[11],n=a[12],F=a[13],J=a[14],C=a[15];
b[0]=t*(x*C-L*J)-A*(f*C-r*J)+F*(f*L-r*x);b[1]=-(y*(x*C-L*J)-A*(g*C-B*J)+F*(g*L-B*x));b[2]=y*(f*C-r*J)-t*(g*C-B*J)+F*(g*r-B*f);b[3]=-(y*(f*L-r*x)-t*(g*L-B*x)+A*(g*r-B*f));b[4]=-(w*(x*C-L*J)-l*(f*C-r*J)+n*(f*L-r*x));b[5]=e*(x*C-L*J)-l*(g*C-B*J)+n*(g*L-B*x);b[6]=-(e*(f*C-r*J)-w*(g*C-B*J)+n*(g*r-B*f));b[7]=e*(f*L-r*x)-w*(g*L-B*x)+l*(g*r-B*f);b[8]=w*(A*C-L*F)-l*(t*C-r*F)+n*(t*L-r*A);b[9]=-(e*(A*C-L*F)-l*(y*C-B*F)+n*(y*L-B*A));b[10]=e*(t*C-r*F)-w*(y*C-B*F)+n*(y*r-B*t);b[11]=-(e*(t*L-r*A)-w*(y*L-B*A)+l*
(y*r-B*t));b[12]=-(w*(A*J-x*F)-l*(t*J-f*F)+n*(t*x-f*A));b[13]=e*(A*J-x*F)-l*(y*J-g*F)+n*(y*x-g*A);b[14]=-(e*(t*J-f*F)-w*(y*J-g*F)+n*(y*f-g*t));b[15]=e*(t*x-f*A)-w*(y*x-g*A)+l*(y*f-g*t);return b};a.determinant=function(a){var b=a[0],e=a[1],y=a[2],g=a[3],B=a[4],w=a[5],t=a[6],f=a[7],r=a[8],l=a[9],A=a[10],x=a[11],n=a[12],M=a[13],F=a[14];a=a[15];return(b*w-e*B)*(A*a-x*F)-(b*t-y*B)*(l*a-x*M)+(b*f-g*B)*(l*F-A*M)+(e*t-y*w)*(r*a-x*n)-(e*f-g*w)*(r*F-A*n)+(y*f-g*t)*(r*M-l*n)};a.multiply=function(a,b,e){var y=
a[0],g=a[1],B=a[2],w=a[3],t=a[4],f=a[5],r=a[6],l=a[7],A=a[8],x=a[9],n=a[10],M=a[11],F=a[12],J=a[13],C=a[14];a=a[15];var H=b[0],K=b[1],d=b[2],h=b[3];e[0]=H*y+K*t+d*A+h*F;e[1]=H*g+K*f+d*x+h*J;e[2]=H*B+K*r+d*n+h*C;e[3]=H*w+K*l+d*M+h*a;H=b[4];K=b[5];d=b[6];h=b[7];e[4]=H*y+K*t+d*A+h*F;e[5]=H*g+K*f+d*x+h*J;e[6]=H*B+K*r+d*n+h*C;e[7]=H*w+K*l+d*M+h*a;H=b[8];K=b[9];d=b[10];h=b[11];e[8]=H*y+K*t+d*A+h*F;e[9]=H*g+K*f+d*x+h*J;e[10]=H*B+K*r+d*n+h*C;e[11]=H*w+K*l+d*M+h*a;H=b[12];K=b[13];d=b[14];h=b[15];e[12]=H*y+
K*t+d*A+h*F;e[13]=H*g+K*f+d*x+h*J;e[14]=H*B+K*r+d*n+h*C;e[15]=H*w+K*l+d*M+h*a;return e};a.mul=a.multiply;a.translate=function(a,b,e){var y=b[0],g=b[1];b=b[2];var B,w,t,f,r,l,A,x,n,M,F,J;a===e?(e[12]=a[0]*y+a[4]*g+a[8]*b+a[12],e[13]=a[1]*y+a[5]*g+a[9]*b+a[13],e[14]=a[2]*y+a[6]*g+a[10]*b+a[14],e[15]=a[3]*y+a[7]*g+a[11]*b+a[15]):(B=a[0],w=a[1],t=a[2],f=a[3],r=a[4],l=a[5],A=a[6],x=a[7],n=a[8],M=a[9],F=a[10],J=a[11],e[0]=B,e[1]=w,e[2]=t,e[3]=f,e[4]=r,e[5]=l,e[6]=A,e[7]=x,e[8]=n,e[9]=M,e[10]=F,e[11]=J,
e[12]=B*y+r*g+n*b+a[12],e[13]=w*y+l*g+M*b+a[13],e[14]=t*y+A*g+F*b+a[14],e[15]=f*y+x*g+J*b+a[15]);return e};a.scale=function(a,b,e){var y=b[0],g=b[1];b=b[2];e[0]=a[0]*y;e[1]=a[1]*y;e[2]=a[2]*y;e[3]=a[3]*y;e[4]=a[4]*g;e[5]=a[5]*g;e[6]=a[6]*g;e[7]=a[7]*g;e[8]=a[8]*b;e[9]=a[9]*b;e[10]=a[10]*b;e[11]=a[11]*b;e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.rotate=function(a,b,e,y){var g=e[0],B=e[1];e=e[2];var w=Math.sqrt(g*g+B*B+e*e),t,f,r,l,A,x,n,M,F,J,C,H,K,d,h,v,P,c,p,N;if(1E-7>Math.abs(w))return null;
w=1/w;g*=w;B*=w;e*=w;t=Math.sin(b);f=Math.cos(b);r=1-f;b=a[0];w=a[1];l=a[2];A=a[3];x=a[4];n=a[5];M=a[6];F=a[7];J=a[8];C=a[9];H=a[10];K=a[11];d=g*g*r+f;h=B*g*r+e*t;v=e*g*r-B*t;P=g*B*r-e*t;c=B*B*r+f;p=e*B*r+g*t;N=g*e*r+B*t;g=B*e*r-g*t;B=e*e*r+f;y[0]=b*d+x*h+J*v;y[1]=w*d+n*h+C*v;y[2]=l*d+M*h+H*v;y[3]=A*d+F*h+K*v;y[4]=b*P+x*c+J*p;y[5]=w*P+n*c+C*p;y[6]=l*P+M*c+H*p;y[7]=A*P+F*c+K*p;y[8]=b*N+x*g+J*B;y[9]=w*N+n*g+C*B;y[10]=l*N+M*g+H*B;y[11]=A*N+F*g+K*B;a!==y&&(y[12]=a[12],y[13]=a[13],y[14]=a[14],y[15]=a[15]);
return y};a.rotateX=function(a,b,e){var y=Math.sin(b);b=Math.cos(b);var g=a[4],n=a[5],w=a[6],t=a[7],f=a[8],r=a[9],l=a[10],A=a[11];a!==e&&(e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);e[4]=g*b+f*y;e[5]=n*b+r*y;e[6]=w*b+l*y;e[7]=t*b+A*y;e[8]=f*b-g*y;e[9]=r*b-n*y;e[10]=l*b-w*y;e[11]=A*b-t*y;return e};a.rotateY=function(a,b,e){var y=Math.sin(b);b=Math.cos(b);var g=a[0],n=a[1],w=a[2],t=a[3],f=a[8],r=a[9],l=a[10],A=a[11];a!==e&&(e[4]=a[4],e[5]=a[5],e[6]=a[6],
e[7]=a[7],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);e[0]=g*b-f*y;e[1]=n*b-r*y;e[2]=w*b-l*y;e[3]=t*b-A*y;e[8]=g*y+f*b;e[9]=n*y+r*b;e[10]=w*y+l*b;e[11]=t*y+A*b;return e};a.rotateZ=function(a,b,e){var y=Math.sin(b);b=Math.cos(b);var g=a[0],n=a[1],w=a[2],t=a[3],f=a[4],r=a[5],l=a[6],A=a[7];a!==e&&(e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);e[0]=g*b+f*y;e[1]=n*b+r*y;e[2]=w*b+l*y;e[3]=t*b+A*y;e[4]=f*b-g*y;e[5]=r*b-n*y;e[6]=l*b-w*y;e[7]=A*b-t*y;return e};
a.pO=function(a,b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=a[0];b[13]=a[1];b[14]=a[2];b[15]=1;return b};a.oO=function(a,b){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a[1];b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=a[2];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.nO=function(a,b,e){var y=b[0],g=b[1];b=b[2];var n=Math.sqrt(y*y+g*g+b*b),w;if(1E-7>Math.abs(n))return null;n=1/n;y*=n;g*=n;b*=n;n=Math.sin(a);a=Math.cos(a);w=1-a;e[0]=y*y*w+a;e[1]=g*y*w+b*
n;e[2]=b*y*w-g*n;e[3]=0;e[4]=y*g*w-b*n;e[5]=g*g*w+a;e[6]=b*g*w+y*n;e[7]=0;e[8]=y*b*w+g*n;e[9]=g*b*w-y*n;e[10]=b*b*w+a;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.lY=function(a,b){var e=Math.sin(a),y=Math.cos(a);b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=y;b[6]=e;b[7]=0;b[8]=0;b[9]=-e;b[10]=y;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.mY=function(a,b){var e=Math.sin(a),y=Math.cos(a);b[0]=y;b[1]=0;b[2]=-e;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=e;b[9]=0;b[10]=y;b[11]=0;b[12]=0;b[13]=0;
b[14]=0;b[15]=1;return b};a.nY=function(a,b){var e=Math.sin(a),y=Math.cos(a);b[0]=y;b[1]=e;b[2]=0;b[3]=0;b[4]=-e;b[5]=y;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromRotationTranslation=function(a,b,e){var y=a[0],g=a[1],n=a[2],w=a[3],t=y+y,f=g+g,r=n+n;a=y*t;var l=y*f,y=y*r,A=g*f,g=g*r,n=n*r,t=w*t,f=w*f,w=w*r;e[0]=1-(A+n);e[1]=l+w;e[2]=y-f;e[3]=0;e[4]=l-w;e[5]=1-(a+n);e[6]=g+t;e[7]=0;e[8]=y+f;e[9]=g-t;e[10]=1-(a+A);e[11]=0;e[12]=b[0];e[13]=b[1];e[14]=b[2];
e[15]=1;return e};a.jY=function(a,b,e,n){var g=a[0],B=a[1],w=a[2],t=a[3],f=g+g,r=B+B,l=w+w;a=g*f;var A=g*r,g=g*l,x=B*r,B=B*l,w=w*l,f=t*f,r=t*r,t=t*l,l=e[0],L=e[1];e=e[2];n[0]=(1-(x+w))*l;n[1]=(A+t)*l;n[2]=(g-r)*l;n[3]=0;n[4]=(A-t)*L;n[5]=(1-(a+w))*L;n[6]=(B+f)*L;n[7]=0;n[8]=(g+r)*e;n[9]=(B-f)*e;n[10]=(1-(a+x))*e;n[11]=0;n[12]=b[0];n[13]=b[1];n[14]=b[2];n[15]=1;return n};a.kY=function(a,b,e,n,g){var B=a[0],w=a[1],t=a[2],f=a[3],r=B+B,l=w+w,A=t+t;a=B*r;var x=B*l,B=B*A,L=w*l,w=w*A,t=t*A,r=f*r,l=f*l,f=
f*A,A=e[0],M=e[1];e=e[2];var F=n[0],J=n[1];n=n[2];g[0]=(1-(L+t))*A;g[1]=(x+f)*A;g[2]=(B-l)*A;g[3]=0;g[4]=(x-f)*M;g[5]=(1-(a+t))*M;g[6]=(w+r)*M;g[7]=0;g[8]=(B+l)*e;g[9]=(w-r)*e;g[10]=(1-(a+L))*e;g[11]=0;g[12]=b[0]+F-(g[0]*F+g[4]*J+g[8]*n);g[13]=b[1]+J-(g[1]*F+g[5]*J+g[9]*n);g[14]=b[2]+n-(g[2]*F+g[6]*J+g[10]*n);g[15]=1;return g};a.fromQuat=function(a,b){var e=a[0],n=a[1],g=a[2],B=a[3],w=e+e,t=n+n,f=g+g,e=e*w,r=n*w,n=n*t,l=g*w,A=g*t,g=g*f,w=B*w,t=B*t,B=B*f;b[0]=1-n-g;b[1]=r+B;b[2]=l-t;b[3]=0;b[4]=r-
B;b[5]=1-e-g;b[6]=A+w;b[7]=0;b[8]=l+t;b[9]=A-w;b[10]=1-e-n;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.frustum=function(a,b,e,n,g,B,w){var t=1/(b-a),f=1/(n-e),r=1/(g-B);w[0]=2*g*t;w[1]=0;w[2]=0;w[3]=0;w[4]=0;w[5]=2*g*f;w[6]=0;w[7]=0;w[8]=(b+a)*t;w[9]=(n+e)*f;w[10]=(B+g)*r;w[11]=-1;w[12]=0;w[13]=0;w[14]=B*g*2*r;w[15]=0;return w};a.perspective=function(a,b,e,n,g){a=1/Math.tan(a/2);var B=1/(e-n);g[0]=a/b;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=a;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=(n+e)*B;g[11]=-1;g[12]=
0;g[13]=0;g[14]=2*n*e*B;g[15]=0;return g};a.n0=function(a,b,e,n){var g=Math.tan(a.upDegrees*Math.PI/180),B=Math.tan(a.downDegrees*Math.PI/180),w=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var t=2/(w+a),f=2/(g+B);n[0]=t;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=f;n[6]=0;n[7]=0;n[8]=-((w-a)*t*.5);n[9]=(g-B)*f*.5;n[10]=e/(b-e);n[11]=-1;n[12]=0;n[13]=0;n[14]=e*b/(b-e);n[15]=0;return n};a.ortho=function(a,b,e,n,g,B,w){var t=1/(a-b),f=1/(e-n),r=1/(g-B);w[0]=-2*t;w[1]=0;w[2]=0;w[3]=
0;w[4]=0;w[5]=-2*f;w[6]=0;w[7]=0;w[8]=0;w[9]=0;w[10]=2*r;w[11]=0;w[12]=(a+b)*t;w[13]=(n+e)*f;w[14]=(B+g)*r;w[15]=1;return w};a.lookAt=function(k,b,e,n){var g,B,w,t,f,r,l,A,x=k[0],L=k[1];k=k[2];w=e[0];t=e[1];B=e[2];l=b[0];e=b[1];g=b[2];if(1E-7>Math.abs(x-l)&&1E-7>Math.abs(L-e)&&1E-7>Math.abs(k-g))return a.identity(n);b=x-l;e=L-e;l=k-g;A=1/Math.sqrt(b*b+e*e+l*l);b*=A;e*=A;l*=A;g=t*l-B*e;B=B*b-w*l;w=w*e-t*b;(A=Math.sqrt(g*g+B*B+w*w))?(A=1/A,g*=A,B*=A,w*=A):w=B=g=0;t=e*w-l*B;f=l*g-b*w;r=b*B-e*g;(A=Math.sqrt(t*
t+f*f+r*r))?(A=1/A,t*=A,f*=A,r*=A):r=f=t=0;n[0]=g;n[1]=t;n[2]=b;n[3]=0;n[4]=B;n[5]=f;n[6]=e;n[7]=0;n[8]=w;n[9]=r;n[10]=l;n[11]=0;n[12]=-(g*x+B*L+w*k);n[13]=-(t*x+f*L+r*k);n[14]=-(b*x+e*L+l*k);n[15]=1;return n};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.mO=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__math=function(a,n){function k(a,b){for(var e=a[1],f=1,g=2;g<a.length;g++)4!=g&&8!=g&&Math.abs(a[g])>Math.abs(e)&&(e=a[g],f=g);for(var k=Math.floor(f/3),f=f%3,e=.5*Math.atan(2*e/(a[3*k+k]-a[3*f+f])),g=0;g<b.length;g++)b[g]=0==g||4==g||8==g?1:0;b[f+3*k]=-Math.sin(e);b[k+3*f]=Math.sin(e);b[k+3*k]=Math.cos(e);b[f+3*f]=Math.cos(e);return b}function b(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}var e=n("__vec3"),y=n("__mat3"),g=new Float32Array(3),B=new Float32Array(9),w=new Float32Array(9),
t=new Float32Array(9),f=new Float32Array(9);a.vZ=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];return b};a.wZ=function(a,b){b=b||new Float32Array(3);return e.copy(a,b)};a.MG=function(a,b){e.copy(b,a)};a.Ay=function(a,b){e.normalize(b,g);a[3]=g[0];a[4]=g[1];a[5]=g[2]};a.MW=function(a,b,e){e=e||new Float32Array(3);e[0]=a[0]+a[3]*b;e[1]=a[1]+a[4]*b;e[2]=a[2]+a[5]*b};a.PL=function(a,b){for(var f=0;f<a.length;f+=3)b[0]+=a[f],b[1]+=a[f+1],b[2]+=a[f+2];return e.scale(b,3/a.length,
b)};a.JL=function(a,b,e){for(var f=0;f<e.length;f++)e[f]=0;for(f=0;f<a.length;f+=3){var g=a[f]-b[0],k=a[f+1]-b[1],t=a[f+2]-b[2];e[0]+=g*g;e[1]+=g*k;e[2]+=g*t;e[4]+=k*k;e[5]+=k*t;e[8]+=t*t}e[3]=e[1];e[6]=e[2];e[7]=e[5];for(f=0;f<e.length;f++)e[f]*=3/a.length;return e};a.dO=function(a,e){var g=y.copy(a,B);if(5E-4>b(g))return y.identity(e);var x=k(g,w),n=y.transpose(x,t);y.multiply(g,n,f);y.multiply(x,f,g);for(var M=y.copy(x,e),F=1;5E-4<=b(g)&&100>F;)x=k(g,w),n=y.transpose(x,t),y.multiply(g,n,f),y.multiply(x,
f,g),y.multiply(x,M,M),F++;return M};a.df=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}};b4w.module.__obj_util=function(a,n){function k(a){if(!(a instanceof Object))return a;var b=null,e=null,g=null,x=null;a.fa&&(b=a.fa,a.fa=null);a.Sc&&(e=a.Sc,a.Sc=null);a.Oa&&(g=a.Oa,a.Oa=null);a.rb&&(x=a.rb,a.rb=null);var t;t=a.constructor;switch(t){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:t=new t(a);break;case Array:t=new t(a.length);for(var n=0;n<a.length;n++)t[n]=k(a[n]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:t=
a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:t=null;break;case Function:t=a;break;default:for(n in t=new t,a)t[n]=k(a[n])}b&&(t.fa=b,a.fa=b);e&&(t.Sc=e,a.Sc=e);g&&(t.Oa=g,a.Oa=g);x&&(t.rb=x,a.rb=x);return t}function b(a,b){for(var e=a.A,g=0;g<e.length;g++){var k=e[g];if(k.Ta==b)return k}return null}function e(a){return a.ji?a.parent:a.parent?e(a.parent):null}var y=n("__tsr"),g=n("__util"),B=n("__vec3"),w=n("__vec4"),t=n("__config").v;new Float32Array(4);new Float32Array(4);new Float32Array(4);
y.create();y.create();a.Mk=function(a){a={id:0,type:a,Ad:0,i:y.Zf(),Fz:y.Zf(),EI:y.Zf(),pivot:new Float32Array(3),wb:new Float32Array(3),il:0,jl:0,xE:!1,yE:!1,rq:null,kh:0,Ws:!1,hf:B.create(),use_panning:!1,lb:0,hp:1,gp:1,ip:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,je:null,pT:!1,$a:null,va:null,fb:null,Kc:null,Jc:null,cf:null,Hn:!0,Hl:{Il:1,Jl:1,Kl:0},Qe:null,se:null,jc:new Float32Array(4),Pn:0,En:0,po:0,tl:0,Pk:!1,ye:!1,Qd:!1,Pd:!1,rd:!1,fd:!1,Md:!1,pg:"",Ig:!1,Ie:!1,Iq:!1,$f:!1,Ic:!1,
kj:!1,xj:!1,Cr:!1,oi:!1,Vr:!1,hc:!1,Ur:!1,FF:!1,vr:!1,Ar:!1,nw:!1,kp:0,zg:0,Ch:0,Pg:0,Og:0,Hg:0,bh:"",ad:null,eq:!1,rf:!1,av:!1,Tm:"",Sm:!1,Ue:0,time:0,sz:0,iI:0,dh:0,On:!1,Fc:!1,Pf:!1,si:[],ml:!1,Wi:!1,Ih:1,Mu:0,Lu:1,et:new Int8Array([-1,-1]),Ns:[],fF:[],aH:[],Kd:null,te:null,Td:null,Ee:null,Oe:null,Fk:null,Px:null,Tu:null,Su:null,Dk:null,R:null,Yu:null,Wu:null,Xu:null,Pe:null,Ga:null,ci:1E4};B.copy(g.uc,a.hf);return a};a.pn=function(a,b,e){e||(e=a);return{name:a,Ei:g.rw(),Qj:e,type:b,bj:!1,Ha:!1,
io:!1,dp:!1,g:null,zb:null,P:null,$b:null,$p:null,anchor:null,Vk:null,Kr:null,A:[],Fc:[],zd:[],zv:[],W:[],Ho:[],af:[],wk:[],Kf:null,$j:[],parent:null,ji:!1,xo:"",ot:null,fs:null,hk:!1,pb:"",vq:"AUTO",Ed:!1,Ze:!1,Ej:!1,r:null,n:null,Se:null,Vd:null,Wk:null,CB:null,Nx:[],Hf:{ds:"NO_COLLISION",ep:!1,hI:!1,jg:0,lI:0,kI:0,Qv:0,ky:0,hQ:!1,iQ:!1,jQ:!1,kQ:!1,lQ:!1,mQ:!1,hn:0,fn:0,jn:0,pz:!1,qq:"BOX",cp:!1},EF:{Xs:0,Ix:0,re:0,$x:0},Vi:0,pf:[],yx:!1,pF:!1,gF:[]}};a.Av=function(a){return a instanceof Array?
a.slice():a};a.AM=function(a){for(var b=[],e=0;e<a.length;e++){var g=a[e],x={},t;for(t in g)g[t]==g.I?x.I=k(g.I):g[t]==g.na?x.na=k(g.na):x[t]=g[t];b.push(x)}return b};a.Ik=k;a.Ha=function(a){return a.Ha};a.EP=function(a){return"MESH"==a.type&&a.Ha};a.Pm=function(a,b){a.A.push({Ta:b,sr:!1,X:[],ng:[],Mg:null,Hy:[],Fj:0,AF:!1,U:[],$G:[]})};a.Xp=function(a,e,l){b(a,e).X.push(l)};a.A0=function(a,b){for(var e=a.A,g=0;g<e.length;g++)if(e[g].Ta==b){e.splice(g,1);break}};a.aa=b;a.aI=function(a,b){for(var e=
0;e<a.length;e++)w.copy(b,a[e].g.jc)};a.ly=function(a,b,e){for(var g=0;g<a.A.length;g++){var k=a.A[g];e&&k.Ta!=e||(k.sr=b)}};a.ar=function(a,b){for(var e=[],g=b?t.dF-1:t.dF,k=0;k<a.length;k++){var n=a[k];n.$b.bD&&e.length<g&&e.push(n)}return e.length?e:a[0]?[a[0]]:[]};a.GB=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var e=b.material-1,g=a.data.materials;if(0<=e&&e<g.length&&("ADD"==g[e].game_settings.alpha_blend||"ALPHA"==g[e].game_settings.alpha_blend||"ALPHA_SORT"==
g[e].game_settings.alpha_blend))return!0}return!1};a.hM=function(a){a=a.A;for(var b=0;b<a.length;b++)for(var e=a[b].X,g=0;g<e.length;g++)for(var k=e[g].Tb.Qg,t=0;t<k.length;t++){var n=k[t];if("USE_ZUP_MODEL_MATRIX_INVERSE"==n[0]&&"1"==n[1])return!0}return!1};a.YC=function(a,b){return a+"*"+b};a.DD=function(a){return a.ji?null:a.parent};a.Xg=e;a.Aw=function(a,b){for(var l=[],g=0;g<b.length;g++){var k=b[g];e(k)==a&&l.push(k)}return l};a.Ew=function(a){return a.g.Ad};a.Pc=function(a){return"MESH"===
a.type};a.Cj=function(a){return"ARMATURE"===a.type};a.mo=function(a){return"SPEAKER"===a.type};a.la=function(a){return"CAMERA"===a.type};a.wr=function(a){return"LAMP"===a.type};a.fo=function(a){return"EMPTY"===a.type};a.F_=function(a){return"LINE"===a.type};a.$w=function(a){return"WORLD"===a.type}};b4w.module.__particles=function(a,n){function k(){r.l("_rand() undefined")}function b(a,b,e,l,g,d){var h=a.Gq,v=a.wf,k=a.time;a=a.SF;for(var c=0;c<h.length;c+=4){var p=h[c];if(k>a&&k>=p&&p>a||k<a&&(p>a||k>=p))for(p=0;8>p;p++)v[8*c+p]=l[p],x[p]=l[p];else for(p=0;8>p;p++)x[p]=v[8*c+p];p=L;p[0]=b[3*c];p[1]=b[3*c+1];p[2]=b[3*c+2];f.Ec(p,x,p);g[3*c]=p[0];g[3*c+1]=p[1];g[3*c+2]=p[2];var r=L;r[0]=e[3*c];r[1]=e[3*c+1];r[2]=e[3*c+2];f.Tc(r,x,r);d[3*c]=r[0];d[3*c+1]=r[1];d[3*c+2]=r[2];for(p=1;4>p;p++)g[3*(c+
p)]=g[3*c],g[3*(c+p)+1]=g[3*c+1],g[3*(c+p)+2]=g[3*c+2],d[3*(c+p)]=r[0],d[3*(c+p)+1]=r[1],d[3*(c+p)+2]=r[2]}}function e(a){a?(r.QS(a),k=function(){return r.iR()}):k=function(){return Math.random()}}var y=n("__config"),g=n("__batch"),B=n("__geometry"),w=n("__textures"),t=n("__time"),f=n("__tsr"),r=n("__util"),l=n("__vec3"),A=y.v,x=new Float32Array(8),L=new Float32Array(3),M=[];a.update=function(){for(var a=0;a<M.length;a++)for(var e=M[a],f=e.A,l=0;l<f.length;l++)for(var g=e,d=f[l].X,h=0;h<d.length;h++){var v=
d[h],k=v.Qa;k&&k.kt&&!v.dg&&(b(k,k.Ml,k.wF,g.g.i,k.Qx,k.Dx),k.EQ=!0)}};a.Gx=function(a){a=a.A;for(var b=0;b<a.length;b++)for(var e=a[b].X,f=0;f<e.length;f++)if(e[f].Qa)return!0;return!1};a.zF=function(a){a=a.A;for(var b=0;b<a.length;b++)for(var e=a[b].X,f=0;f<e.length;f++){var l=e[f].Qa;if(l&&"EMITTER"==l.Wr)return!0}return!1};a.FL=function(a){return 0<a.particle_systems.length};a.EL=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;
return!1};a.nP=function(a){for(var b=0;b<a.particle_systems.length;b++){var e=a.particle_systems[b].settings;if("HAIR"==e.type&&e.b4w_dynamic_grass)return!0}return!1};a.yP=function(a,b,e){var f=a.Qa={name:b.name,Wr:b.settings.type,time:0,SF:-1,kt:!1,pa:0,La:0,EH:0,gx:0,SE:0,nd:!1,jg:0,zx:0,bE:0,nj:0,ke:0,BI:0,size:0,XA:0,WA:0,RB:0,QB:new Float32Array(16),Ml:null,Qx:null,wF:null,Dx:null,Gq:null,Vv:null,wf:null,HF:null,CH:0,DH:0};f.pa=b.settings.frame_start;f.La=b.settings.frame_end;f.EH=(f.La-f.pa)/
t.Dc();f.gx=b.settings.lifetime;f.SE=f.gx/t.Dc();f.nd=b.settings.b4w_cyclic?1:0;f.jg=b.settings.mass;f.zx=b.settings.normal_factor;f.bE=9.81*b.settings.effector_weights.gravity;f.nj=b.settings.b4w_fade_in/t.Dc();f.ke=b.settings.b4w_fade_out/t.Dc();f.BI=b.settings.effector_weights.wind;f.kt="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var l,d,h;a.Mw?(l=e.halo.size,d=e.halo.hardness,30>d?(d=.5,h=.9):40>d?(d=.1,h=1):50>d?(d=0,h=.8):(d=0,h=.5)):(l=b.settings.particle_size,h=d=1);f.size=l;f.XA=d;f.WA=
h;e.use_nodes&&"BILLBOARD"==b.settings.render_type&&(g.Od(a,"NODES",1),g.Od(a,"PARTICLE_BATCH",1),a.H2=!0,a.$n=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&A.Up&&(l=[],w.IL(b[0].texture.color_ramp,w.sA,l),l=new Uint8Array(l.map(function(a){return r.S(255*a,0,255)})),g.ZK(a,l,w.sA),g.Od(a,"USE_COLOR_RAMP",1));e=e.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(e[0]&&"STRAND"==e[0].texture_coords&&e[0].texture&&
"BLEND"==e[0].texture.type&&e[0].texture.use_color_ramp){e=e[0].texture.color_ramp.elements;b=Math.min(4*e.length,a.length);for(l=0;l<b;l+=4)d=e[l/4],a[l]=d.position,a[l+1]=d.color[0],a[l+2]=d.color[1],a[l+3]=d.color[2];f.RB=e.length}f.QB.set(a)};a.vO=function(a,f,g,A){var x=a.Qa,d=A.i,h=g.settings.count,v=g.settings.frame_start/t.Dc(),n=g.settings.frame_end/t.Dc(),c=g.settings.lifetime/t.Dc(),p=g.settings.lifetime_random,N=g.settings.emit_from,G=g.settings.factor_random;if(g.settings.use_rotations)var u=
g.settings.angular_velocity_mode,z=g.settings.angular_velocity_factor;else u="NONE",z=0;var q=g.settings.b4w_randomize_emission,D=g.settings.b4w_cyclic;x.CH=g.settings.billboard_tilt;x.DH=g.settings.billboard_tilt_random;e(g.seed);var I;f=B.GC(f,["a_position","a_normal"],null,A);switch(N){case "VERT":var m=f.N[0].a_position;I=f.N[0].a_normal;f=m.length/3;N=[];for(g=0;g<h;g++)A=Math.round((f-1)*k()),N.push(A),N.push(A),N.push(A),N.push(A);f=[];for(g=0;g<N.length;g++)f.push(m[3*N[g]]),f.push(m[3*N[g]+
1]),f.push(m[3*N[g]+2]);m=new Float32Array(f);f=[];for(g=0;g<N.length;g++)f.push(I[3*N[g]]),f.push(I[3*N[g]+1]),f.push(I[3*N[g]+2]);I=new Float32Array(f);break;case "FACE":m=[];I=[];g=[];r.pr(0,g);N=B.tw(f,h,!1,g);r.pr(0,g);f=B.tw(f,h,!0,g);for(g=0;g<N.length;g++)m.push(N[g][0],N[g][1],N[g][2]),m.push(N[g][0],N[g][1],N[g][2]),m.push(N[g][0],N[g][1],N[g][2]),m.push(N[g][0],N[g][1],N[g][2]),I.push(f[g][0],f[g][1],f[g][2]),I.push(f[g][0],f[g][1],f[g][2]),I.push(f[g][0],f[g][1],f[g][2]),I.push(f[g][0],
f[g][1],f[g][2]);m=new Float32Array(m);I=new Float32Array(I);break;case "VOLUME":r.l("Particle emission from volume is not supported");break;default:r.l("Wrong emit from option")}I=[m,I];m=I[0];I=I[1];x.Ml=new Float32Array(m);x.wF=new Float32Array(I);x.Qx=new Float32Array(m.length);x.Dx=new Float32Array(I.length);N=[];n=(n-v)/h;for(f=0;f<h;f++)g=q?n*f+10*n*(.5-k()):n*f,D||(g+=v),N.push(g),N.push(g),N.push(g),N.push(g);v=new Float32Array(N);x.Gq=new Float32Array(v);x.Vv=new Float32Array(v);if(x.kt){x.wf=
new Float32Array(8*v.length);for(q=0;q<8*v.length;q++)for(D=0;8>D;D++)x.wf[8*q+D]=d[D];b(x,m,I,d,m,I)}d=r.Bc("EMITTER_PARTICLES");q=r.sf();q.a_position=m;q.a_normal=I;d.N[0]=q;a.Rh=B.rp;a=[];for(q=0;q<h;q++)a.push(4*q,4*q+2,4*q+1,4*q,4*q+3,4*q+2);a=new Uint16Array(a);d.ab=a;a=d.ba;q=[];for(D=0;D<h;D++)q.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);q=new Float32Array(q);a.a_p_bb_vertex=q;d.wa=m.length/3;a=[];p*=c;for(q=0;q<h;q++)D=p*k(),a.push(c-D),a.push(c-D),a.push(c-D),a.push(c-D);c=d.ba;p=[];for(q=0;q<h;q++)D=
Math.random(),p.push(a[4*q],v[4*q],D),p.push(a[4*q+1],v[4*q+1],D),p.push(a[4*q+2],v[4*q+2],D),p.push(a[4*q+3],v[4*q+3],D);p=new Float32Array(p);c.a_p_data=p;c=d.ba;p=[];for(a=0;a<h;a++){v=[k()-.5,k()-.5,k()-.5];l.normalize(v,v);p.push(G*v[0]);p.push(G*v[1]);p.push(G*v[2]);switch(u){case "NONE":p.push(0);break;case "SPIN":case "VELOCITY":p.push(z);break;case "RAND":p.push(2*z*(k()-.5));break;default:r.l("Undefined velocity factor")}v=p.slice(-4);for(q=0;12>q;q++)p.push(v[q%4])}h=new Float32Array(p);
c.a_p_vels=h;x.HF=new Float32Array(d.ba.a_p_data);return d};a.lS=function(a,b,e){a=a.A;for(var f=0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d].Qa;h&&h.name==b&&!g[d].dg&&(h.SF=h.time,h.time=e)}};a.bR=function(a){for(var b=a.wa,e=a.N[0].a_position,f=a.ba.a_texcoord,g=[],d=[],h=0;h<b;h++)d.push(e[3*h]),d.push(e[3*h+1]),g.push(e[3*h+2]);g=new Float32Array(g);d=new Float32Array(d);a.ba.a_lf_dist=g;a.ba.a_lf_bb_vertex=d;a.ba.a_texcoord=f;return a};a.y1=function(a,b,e){a=a.A;for(var f=
0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d].Qa;h&&h.name==b&&(h.size=e)}};a.j1=function(a,b,e){a=a.A;for(var f=0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d].Qa;h&&h.name==b&&(h.zx=e)}};a.W0=function(a,b,e){a=a.A;for(var f=0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d],v=h.Qa;if(v&&v.name==b){var l=v.Gq;if(1==e)var c=l;else if(0==e)for(var c=v.Vv,p=0;p<c.length;p+=4)c[p]=1E4,c[p+1]=c[p],c[p+2]=c[p],c[p+3]=c[p];else for(var k=4/e,c=v.Vv,G=0,
p=0;p<c.length;p+=4)p>=G?(c[p]=l[p],G+=k):c[p]=1E4,c[p+1]=c[p],c[p+2]=c[p],c[p+3]=c[p];h=h.oa;if(h.ed.a_p_data){v=v.HF;for(p=0;p<v.length;p+=3)v[p+1]=c[Math.round(p/3)];B.AT(h,v)}}}};a.UT=function(a,b,e){a=a.A;for(var f=0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d].Qa;if(h&&h.kt)for(var v=0;v<8*h.Gq.length;v++)h.wf[8*v]=b[0],h.wf[8*v+1]=b[1],h.wf[8*v+2]=b[2],h.wf[8*v+3]=b[3],h.wf[8*v+4]=e[0],h.wf[8*v+5]=e[1],h.wf[8*v+6]=e[2],h.wf[8*v+7]=e[3]}};a.OT=function(a,b,e){if(b.$r){for(var f=
[],g=0;g<e;g++)f.push(1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1);a.ba.a_tangent=new Float32Array(f)}if(b.Jx){f=[];for(g=0;g<e;g++)f.push(g,g,g,g);a.ba[b.Jx.name]=new Float32Array(f)}};a.NT=function(a){-1==M.indexOf(a)&&M.push(a)};a.nR=function(a){a=M.indexOf(a);-1!=a&&M.splice(a,1)};a.ha=function(){M.length=0}};b4w.module.__batch=function(a,n){function k(a){a={type:a,sb:"",id:0,cy:0,en:-1,Gl:"",qC:-1,Eq:-1,Tv:0,tf:0,Nk:[],fa:[],Sc:[],Cf:[],ln:[],jk:null,Gc:{},rb:null,Tb:{vm:null,Yk:null,Qg:[],Mj:[]},Cl:"",aq:[],m0:null,oa:null,Pf:!1,hj:!1,sC:!1,Fx:0,ro:0,GE:0,HE:0,aE:0,Jw:0,Cd:new Float32Array(3),fe:new Float32Array(16),Ui:!1,eb:!1,wM:!1,Ka:!1,Dh:!1,Db:!1,Fe:!1,$f:!1,ye:!1,Pd:!1,Qd:!1,rd:!1,fd:!1,Md:!1,Ic:!1,UF:!1,Rh:E.Am,Sf:!1,mv:!1,dg:!1,gR:"",G1:"",dE:!1,hE:0,eE:0,iE:0,jE:0,gE:new Float32Array(3),fE:new Float32Array(3),
Mw:!1,xk:0,Tk:0,xn:1,os:0,Rs:0,Py:1,Yr:0,wn:0,Mm:1,vF:0,sx:0,Pj:0,iG:0,ie:Array(2),Zl:new Float32Array(3),zi:new Float32Array(3),Uo:new Float32Array(3),uf:new Float32Array(4),qj:new Float32Array(4),ql:null,dx:null,bx:null,ax:null,cx:null,$n:!1,mk:!1,water_dynamic:!1,yz:!1,xI:!1,yI:0,zI:0,wI:0,pt:.1,Is:0,Ms:0,Rq:0,LC:new Float32Array(2),KC:new Float32Array(2),kw:new Float32Array(2),Hs:new Float32Array(3),Ls:new Float32Array(3),Oj:null,Io:!1,Qa:null,TE:0,$r:!1,Jx:null,Nj:null,El:null,rF:null,qe:null,
Dl:null,sF:null,R:null,Ga:null,I:null,na:null};a.uf[3]=1;a.wM=!0;a.Ka=!0;a.TE=1;return a}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.sb=a.eb?a.Dh?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.sb=a.Pd?"CAST":"RECEIVE";break;case "COLOR_ID":a.sb=a.Dh?"COLOR_ID_XRAY":"COLOR_ID"}}function e(a){var c=a.oa;a.oa=null;var d=ea.Ik(a);a.oa=c;d.oa=c;return d}function y(a,c){for(var d=[],b=0;b<a.length;b++){var m=a[b],e=m.ya.g,h=ha.bc();ha.uq(e.Dk,h);var f=m.data.b4w_bounding_cylinder_radius,
z=m.data.b4w_bounding_sphere_radius,q=m.data.b4w_bounding_sphere_center,D=m.data.b4w_bounding_ellipsoid_axes,I=m.data.b4w_bounding_ellipsoid_center;if(e.rf){var f=Math.max(Math.abs(h.max_x),Math.abs(h.min_x)),z=Math.max(Math.abs(h.max_y),Math.abs(h.min_y)),p=Math.max(Math.abs(h.max_z),Math.abs(h.min_z)),p=Math.sqrt(f*f+z*z+p*p),f=Math.sqrt(f*f+z*z);h.max_x=h.max_y=h.max_z=p;h.min_x=h.min_y=h.min_z=-p;z=p;q[0]=q[1]=q[2]=0;D[0]=D[1]=D[2]=p;I[0]=I[1]=I[2]=0}e.R=h;p=ha.Gg(h,e.i);e.I=p;w(e,f,f,h);h=ha.xq(z,
q);e.Pe=h;h=ha.ev(h,e.i);e.Yc=h;D=ha.nn([D[0],0,0],[0,D[1],0],[0,0,D[2]],I);e.Ga=D;D=ha.Gk(D,e.i);e.na=D;d=d.concat(B(m,e,c))}return d}function g(a,d){for(var b=[],e=[],h={},f=0;f<a.length;f++){var z=a[f],q=z.ya.g,D=ha.bc();ha.uq(q.Dk,D);var p=ha.Gg(D,q.i),g=ha.xq(z.data.b4w_bounding_sphere_radius,z.data.b4w_bounding_sphere_center),u=ha.ev(g,q.i),v=z.data.b4w_bounding_ellipsoid_axes,v=ha.nn([v[0],0,0],[0,v[1],0],[0,0,v[2]],z.data.b4w_bounding_ellipsoid_center),l=ha.Gk(v,q.i);q.R=D;q.I=p;q.Pe=g;q.Yc=
u;q.Ga=v;q.na=l;D={};D.ye=q.ye;D.Pd=q.Pd;D.Qd=q.Qd;D.oi=q.oi;D.Vr=q.Vr;D.hc=q.hc;D.Ur=q.Ur;D.Hl=q.Hl;D.rd=q.rd;D.fd=q.fd;D.Md=q.Md;D.Qe=q.Qe;D.se=q.se;D.pg=q.pg;D.Ig=q.Ig;D.Ie=q.Ie;D.bh=q.bh;D.ad=q.ad;D.rf=q.rf;D.Tm=q.Tm;D.Sm=q.Sm;D.Ic=q.Ic;D.kj=q.kj;D.Iq=q.Iq;D.$f=q.$f;D.en=z.b4w_cluster_data.cluster_id;D.ci=q.ci;D.po=q.po;D.tl=q.tl;D.Pk=q.Pk;q=JSON.stringify(D);h[q]=h[q]||[];h[q].push(z)}for(var k in h){D=JSON.parse(k);delete D.en;var z=h[k],q=ea.Mk("STATIC"),wa;for(wa in D)q[wa]=D[wa];q.Ad=a[0].ya.g.Ad;
q.zg=0;q.Ch=0;q.Pg=0;q.Og=0;q.Hg=0;q.xj=!1;for(f=0;f<z.length;f++)D=z[f].ya,0==f?(q.I=T.ia(D.g.I),q.Yc=T.ia(D.g.Yc)):(ha.Jn(q.I,D.g.I),ha.UN(q.Yc,D.g.Yc));q.na=ha.kf();q.Ga=ha.kf();q.R=T.ia(q.I);q.Pe=T.ia(q.Yc);e.push({g:q,GL:z})}for(h=0;h<e.length;h++)for(f=e[h].g,k=e[h].GL,wa=0;wa<k.length;wa++){z=k[wa];q=z.ya.g;D=B(z,f,d);p=ma.create();q.rf&&!q.av?ma.ff(ma.q(q.i),p):ma.copy(q.i,p);g={};if(f.Ie||f.rf)g.au_center_pos=[p[0],p[1],p[2]];f.Ie&&(g.au_wind_bending_amp=[q.zg],g.au_wind_bending_freq=[z.b4w_wind_bending_freq],
g.au_detail_bending_amp=[z.b4w_detail_bending_amp],g.au_detail_bending_freq=[z.b4w_detail_bending_freq],g.au_branch_bending_amp=[z.b4w_branch_bending_amp]);for(u=0;u<D.length;u++){var V=D[u].g,v=D[u].Ae,l=D[u].G;V.vr?V.rf?E.US(v,p):E.Vy(v,p):("COLOR_ID"==l.type&&(D[u].g=q,l.Gl=z.uuid,c(l,q),V=m(q),I(l,V)),v=E.Vy(v,p),E.TS(v,g))}b=b.concat(D)}return b}function B(a,d,b){var e=[],h=t(b,d,!d.Pk,!1),z=m(d),p=a.data,g=p.materials,v=Array(g.length),l=Array(g.length),wa=Aa.Nb(b,"MAIN_OPAQUE"),V=!1;wa&&(V=
wa.Er.length?!0:!1);for(var U=0;U<h.length;U++)for(var G=h[U],r=0;r<g.length;r++){var Q=g[r];if((!Q.b4w_lens_flares||V)&&!E.mE(p,r)){var A=k(G);"COLOR_ID"==G&&(A.mv=!(a.b4w_do_not_render||Q.b4w_do_not_render));"MAIN"==G?v[r]=A:"DEBUG_VIEW"==G&&(l[r]=A);A.en=a.b4w_cluster_data.cluster_id;if(D(A,Q)){"SHADOW"==G&&v[r]&&(A.Fe=v[r].Fe);A.Rh=d.Pf||d.$f?E.rp:E.Am;c(A,d);for(var x=A,R=a.particle_systems,n=0;n<R.length;n++){var N=R[n].settings.b4w_vcol_from_name,Y=R[n].settings.b4w_vcol_to_name;""!==N&&""!==
Y&&(x.Gc[N]={tj:!1,src:[{name:N,$e:7}]})}"DYNAMIC"==d.type&&(A.Gl=a.uuid);I(A,z);var w=E.FC(p,r,A.ln,d.Fk,A.Gc,A.jk),P=w.kd;P.I=ha.Gg(P.R,a.ya.g.i);P.na=ha.Gk(P.Ga,a.ya.g.i);Q.b4w_lens_flares&&(w=Ca.bR(w));e.push({G:A,Ae:w,Hd:[Q.name],g:d,ue:[a]})}}}for(U=0;U<l.length;U++)l[U]&&(l[U].Eq=v[U].id,I(l[U],l[U].cy));var sa=a.particle_systems;if(0<sa.length&&e.length){for(var Ba=!1,B=!1,U=0;U<sa.length;U++){var Ka=sa[U],H=Ka.settings;H.use_render_emitter&&(Ba=!0);"HAIR"!=H.type||"OBJECT"!=H.render_type&&
"GROUP"!=H.render_type&&Ka.transforms.length||(B=!0);if(Ba&&B)break}var y=e[0].G.Gc,K;if(B){var C;if(1<g.length){for(var L=a.ya.g,S={},F=0;F<sa.length;F++){var ob=sa[F].settings;if("HAIR"==ob.type&&("OBJECT"==ob.render_type||"GROUP"==ob.render_type)){var Sa=ob.b4w_vcol_from_name,Na=ob.b4w_vcol_to_name;""!==Sa&&""!==Na&&(S[Sa]=T.ia(y[Sa]))}}"a_bending_col_main"in y&&(S.a_bending_col_main=T.ia(y.a_bending_col_main));"a_bending_col_detail"in y&&(S.a_bending_col_detail=T.ia(y.a_bending_col_detail));C=
E.GC(p,[],S,L)}else C=e[0].Ae;K=C}else K=null;for(var Fa,X=K,da=a.ya,Ja=[],J=a.particle_systems,M=a.data,ia=0;ia<J.length;ia++){var ba=J[ia],W=ba.settings;if(W.count)if("EMITTER"==W.type){if("DYNAMIC"==d.type){var La=k("PARTICLES");La.R=d.R;La.Ga=d.Ga;La.I=d.I;La.na=d.na;var Z,O=M.materials,ka=ba.settings.material-1;ka>=O.length&&(la.warn('Wrong material used for rendering particle system "'+ba.name+'"'),ka=0);Z=O[ka];"HALO"===ba.settings.render_type&&"HALO"===Z.type&&(La.Mw=!0);f(La,Z);var ja=La,
oa=a,Ia=ba.settings;switch(Ia.b4w_billboard_align){case "VIEW":u(ja,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":u(ja,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":u(ja,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":u(ja,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:T.l("Wrong billboard align value")}u(ja,"BILLBOARD",0);var aa=Ia.b4w_enable_soft_particles&&ea.GB(oa,Ia);u(ja,"SOFT_PARTICLES",0<Ia.b4w_particles_softness&&aa&&fa.Hq?1:0);u(ja,"SOFT_STRENGTH",ra.H(Ia.b4w_particles_softness));
ra.V(ja.Tb,"WORLD_SPACE","WORLD"==Ia.b4w_coordinate_system?1:0);La.$f=!0;La.Gl=da.name+"_"+W.uuid;La.gR=ba.name;I(La,z);Ca.yP(La,ba,Z);var za=Ca.vO(La,M,ba,da.g);Ca.OT(za,La,W.count);Ca.NT(da);c(La,da.g);Ja.push({G:La,Ae:za,Hd:[Z.name],g:d,ue:[a]})}}else if("HAIR"==W.type){var ya=T.pr(ba.seed);W.b4w_dynamic_grass&&(d.kj=!0);var Da=ca.HB(fa.lx)&&!W.b4w_initial_rand_rotation&&!W.b4w_hair_billboard,pa=4;Da&&(pa=8);if(ba.transforms.length)var Ea=ba.transforms;else for(var ua=E.tw(X,W.count,!1,ya),Ea=
new Float32Array(ua.length*pa),eb=0;eb<ua.length;eb++){var md=.75+.5*T.ef(ya);Ea[eb*pa]=ua[eb][0];Ea[eb*pa+1]=ua[eb][1];Ea[eb*pa+2]=ua[eb][2];Ea[eb*pa+3]=md;Da&&(Ea[eb*pa+4]=1,Ea[eb*pa+5]=0,Ea[eb*pa+6]=0,Ea[eb*pa+7]=0)}var yb=Aa.Nb(b,"GRASS_MAP")?!0:!1;if("OBJECT"==W.render_type)var Gb=[t(b,W.dupli_object.ya.g,!d.Pk,!0)],qc=q(a,d,y,X,[W.dupli_object],Gb,[Ea],W,ba,yb,ya,!1),Ja=Ja.concat(qc);else if("GROUP"==W.render_type){for(var Va=W.dupli_group.objects,Gb=[],eb=0;eb<Va.length;eb++){var Ab=t(b,Va[eb].ya.g,
!d.Pk,!0);Gb.push(Ab)}for(var Hb=!1,Bb=[],eb=0;eb<Va.length;eb++)Bb.push(Va[eb].ya);if(W.use_whole_group){for(var Ib,Jb=Ea,rc=Bb,Zb=Da,sc=pa,pb={},rb=new Float32Array([0,0,0,1]),Pa=0;Pa<Jb.length;Pa+=sc)for(var bb=0;bb<rc.length;bb++){var lc=ga.create();ga.scale(ma.q(rc[bb].g.i),ma.Oc(rc[bb].g.i),lc);var gb=ga.clone([Jb[Pa],Jb[Pa+1],Jb[Pa+2]]);pb[bb]||(pb[bb]=new Float32Array(Jb.length));Zb&&(pb[bb][Pa+4]=rb[0]=Jb[Pa+4],pb[bb][Pa+5]=rb[1]=Jb[Pa+5],pb[bb][Pa+6]=rb[2]=Jb[Pa+6],pb[bb][Pa+7]=rb[3]=Jb[Pa+
7],T.Tx(rb,rb),T.lT(lc,rb,lc));ga.add(gb,lc,gb);pb[bb][Pa]=gb[0];pb[bb][Pa+1]=gb[1];pb[bb][Pa+2]=gb[2];pb[bb][Pa+3]=Jb[Pa+3]}Ib=pb;Hb=!0}else{var wc;if(W.use_group_count){for(var Cb=Ea,hb=Bb,Ub=W.dupli_weights,ic=ya,Ec=Da,jb=pa,Wa={},$b=[],va=0;va<hb.length;va++)for(var Nb=hb[va],Ya=Nb.Qj||Nb.name,Ob=0;Ob<Ub.length;Ob++){var Qa=Ub[Ob];Ya==Qa.name&&$b.push(Qa)}Ub.length!=$b.length&&la.error("dupli weights match failed");for(va=0;va<Cb.length;va+=jb){for(var kb,jc=$b,ub=[0],Ta=0;Ta<jc.length;Ta++)ub[Ta+
1]=ub[Ta]+jc[Ta].count;for(var Za=ub[ub.length-1]*T.ef(ic),cb=0,Ta=0;Ta<ub.length;Ta++)if(Za>=ub[Ta]&&Za<ub[Ta+1]){cb=Ta;break}kb=cb;Wa[kb]=Wa[kb]||[];Wa[kb].push(Cb[va],Cb[va+1],Cb[va+2],Cb[va+3]);Ec&&Wa[kb].push(Cb[va+4],Cb[va+5],Cb[va+6],Cb[va+7])}for(kb in Wa)Wa[kb]=new Float32Array(Wa[kb]);wc=Wa}else{for(var sb=Ea,ac=ya,Pb=Da,$a=pa,db=Bb.length,mb={},qb=0;qb<sb.length;qb+=$a){var zb=Math.floor(db*T.ef(ac));mb[zb]=mb[zb]||[];mb[zb].push(sb[qb],sb[qb+1],sb[qb+2],sb[qb+3]);Pb&&mb[zb].push(sb[qb+
4],sb[qb+5],sb[qb+6],sb[qb+7])}for(zb in mb)mb[zb]=new Float32Array(mb[zb]);wc=mb}Ib=wc}qc=q(a,d,y,X,Va,Gb,Ib,W,ba,yb,ya,Hb);Ja=Ja.concat(qc)}"INSTANCE"==W.b4w_wind_bend_inheritance&&da.g.Ie&&la.warn('Emitter object "'+da.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else T.l("Unknown particle settings type")}Fa=Ja;e=Ba?e.concat(Fa):Fa}return e}function w(a,c,d,b){a.Yu=ha.YB(c,b);a.Wu=
ha.WB(d,b);a.Xu=ha.XB(c,b)}function t(a,c,d,b){var m=[];b||(c.oi&&Aa.Nb(a,"COLOR_PICKING")||c.hc&&Aa.Nb(a,"OUTLINE_MASK"))&&m.push("COLOR_ID");d&&(m.push("MAIN"),m.push("NODES_GLOW"),Aa.Nb(a,"DEBUG_VIEW")&&m.push("DEBUG_VIEW"),Aa.Nb(a,"SHADOW_RECEIVE")&&m.push("SHADOW"),Aa.Nb(a,"GRASS_MAP")&&m.push("GRASS_MAP"));m.push("PHYSICS");if(c.Pd||c.fd)for(a=null,c.Pd&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),c.fd&&(c=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?T.iL(a,c):c),
c=a,a=0;a<c.length;a++)d=m.indexOf(c[a]),-1!==d&&m.splice(d,1);return m}function f(a,c){var d;switch(a.type){case "MAIN":if(c.b4w_do_not_render)d=!1;else{if(c.use_nodes&&"HALO"!=c.type)J(a,c,"MAIN");else{A(a,c);d=c.game_settings.alpha_blend;a.Dh=c.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.Pj=c.offset_z;a.zi.set([1,1,1]);var b=c.texture_slots;O.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf);if(c.b4w_lens_flares){Q(a,"special_lens_flares.glslv","special_lens_flares.glslf");
G(a,"a_position");G(a,"a_texcoord");var m=za.Cc(b[0],null);R(a,m)}else{Q(a,"main.glslv","main_stack.glslf");c.use_shadeless||(d=U.Gv(c.uuid,c.name,{Fe:c.use_shadeless,yn:c.diffuse_shader,$l:c.specular_shader}),a.Tb.Mj=U.sq(d));var e=x("use_map_color_diffuse",b),h=x("use_map_color_spec",b),f=x("use_map_normal",b),q=x("use_map_mirror",b),z=x("use_stencil",b);d=e[0];h=h[0];f=f[0];q=q[0];e=e[1];b=z[0]&&x("use_rgb_to_intensity",b)[0];if(d){switch(d.blend_type){case "MIX":u(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");
break;case "MULTIPLY":u(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}m=za.Cc(d,null);R(a,m,"u_colormap0");a.wn=d.diffuse_color_factor;a.Mm=d.use_map_alpha?d.alpha_factor:0;a.zi.set(d.scale)}z=d&&d==h;h&&(z||(m=za.Cc(h,null),R(a,m,"u_specmap0")),a.Rs=h.specular_color_factor);if(f&&(G(a,"a_normal"),G(a,"a_tangent"),a.$r=!0,m=za.Cc(f,null),R(a,m,"u_normalmap0"),a.vF=f.normal_factor,m=f.texture,m.b4w_use_map_parallax&&fa.Xr)){var D=ra.H(m.b4w_parallax_steps),p=ra.H(m.b4w_parallax_lod_dist);u(a,
"PARALLAX",1);u(a,"PARALLAX_STEPS",D);u(a,"PARALLAX_LOD_DIST",p);a.Yr=m.b4w_parallax_scale}q&&(m=za.Cc(q,null),R(a,m,"u_mirrormap"),a.sx=q.mirror_factor);if(q=d&&e&&b?1:0)m=za.Cc(e,null),R(a,m,"u_colormap1"),m=za.Cc(b,null),R(a,m,"u_stencil0");(m=d||h||f)&&a.zi.set(m.scale);u(a,"TEXTURE_SPEC",void 0==h?0:1);u(a,"ALPHA_AS_SPEC",z?1:0);u(a,"TEXTURE_STENCIL_ALPHA_MASK",q);G(a,"a_position");G(a,"a_normal");(d||h||f)&&G(a,"a_texcoord");if(c.b4w_water){a.mk=!0;a.water_dynamic=c.b4w_water_dynamic;c.b4w_water_shore_smoothing&&
!a.eb?(la.warn('Material: "'+c.name+'" is opaque.',"Disabling shore smoothing."),a.yz=!1):a.yz=c.b4w_water_shore_smoothing;Q(a,"special_water.glslv","special_water.glslf");q=U.Gv(c.uuid,c.name,{Fe:!1,yn:c.diffuse_shader,$l:c.specular_shader});a.Tb.Mj=U.sq(q);G(a,"a_position");fa.AI?(G(a,"a_polyindex"),a.Ka=!0,a.wireframe_edge_color=[0,0,0],da.QD()?u(a,"DEBUG_WIREFRAME",1):u(a,"DEBUG_WIREFRAME",2)):u(a,"DEBUG_WIREFRAME",0);z=c.texture_slots;q=x("use_map_normal",z);m=x("use_map_mirror",z)[0];q.length&&
(D=za.Cc(q[0]),R(a,D,"u_normalmap0"),a.pt=c.b4w_water_norm_uv_velocity);u(a,"NUM_NORMALMAPS",q.length);a.Oj=Array(q.length);for(D=0;D<q.length;D++)a.Oj[D]=new Float32Array(2),a.Oj[D].set([q[D].scale[0],q[D].scale[1]]);m&&(D=za.Cc(m),R(a,D,"u_mirrormap"),a.sx=m.mirror_factor);m=null;if(fa.Mn)for(D=0;D<z.length;D++){var I=z[D];if(!0===I.texture.b4w_water_foam){m=I;break}}m?(u(a,"FOAM",1),D=za.Cc(m),R(a,D,"u_foam"),a.Rq=c.b4w_foam_factor,a.LC.set(m.texture.b4w_foam_uv_freq),a.KC.set(m.texture.b4w_foam_uv_magnitude),
a.kw[0]=m.scale[0],a.kw[1]=m.scale[1]):u(a,"FOAM",0);for(D=0;D<z.length;D++)if(I=z[D],!0===I.texture.b4w_shore_dist_map){var g=I;break}g&&fa.Up?(g=za.Cc(g),R(a,g,"u_shore_dist_map"),u(a,"SHORE_PARAMS",1),g=I.texture.b4w_shore_boundings,u(a,"MAX_SHORE_DIST",ra.H(I.texture.b4w_max_shore_dist)),u(a,"SHORE_MAP_SIZE_X",ra.H(g[0]-g[1])),u(a,"SHORE_MAP_SIZE_Y",ra.H(g[2]-g[3])),u(a,"SHORE_MAP_CENTER_X",ra.H((g[0]+g[1])/2)),u(a,"SHORE_MAP_CENTER_Y",ra.H((g[2]+g[3])/2))):u(a,"SHORE_PARAMS",0);if(c.b4w_generated_mesh)u(a,
"GENERATED_MESH",1),a.xI=!0,a.yI=c.b4w_water_num_cascads,a.zI=c.b4w_water_subdivs,a.wI=c.b4w_water_detailed_dist;else{G(a,"a_normal");if(m||q.length)G(a,"a_texcoord"),G(a,"a_tangent"),a.$r=!0;u(a,"GENERATED_MESH",0)}if(c.b4w_water_dynamic){var I=ra.H(c.b4w_water_dst_noise_scale0),g=ra.H(c.b4w_water_dst_noise_scale1),q=ra.H(c.b4w_water_dst_noise_freq0),z=ra.H(c.b4w_water_dst_noise_freq1),m=ra.H(c.b4w_water_dir_min_shore_fac),D=ra.H(c.b4w_water_dir_freq),p=ra.H(c.b4w_water_dir_noise_scale),v=ra.H(c.b4w_water_dir_noise_freq),
k=ra.H(c.b4w_water_dir_min_noise_fac),wa=ra.H(c.b4w_water_dst_min_fac),V=ra.H(c.b4w_water_waves_hor_fac);u(a,"DST_NOISE_SCALE_0",I);u(a,"DST_NOISE_SCALE_1",g);u(a,"DST_NOISE_FREQ_0",q);u(a,"DST_NOISE_FREQ_1",z);u(a,"DIR_MIN_SHR_FAC",m);u(a,"DIR_FREQ",D);u(a,"DIR_NOISE_SCALE",p);u(a,"DIR_NOISE_FREQ",v);u(a,"DIR_MIN_NOISE_FAC",k);u(a,"DST_MIN_FAC",wa);u(a,"WAVES_HOR_FAC",V)}M(a,c);F(a,c);a.Hs.set(c.b4w_shallow_water_col);a.Ls.set(c.b4w_shore_water_col);a.Is=c.b4w_shallow_water_col_fac;a.Ms=c.b4w_shore_water_col_fac;
u(a,"ABSORB",ra.H(c.b4w_water_absorb_factor));u(a,"SSS_STRENGTH",ra.H(c.b4w_water_sss_strength));u(a,"SSS_WIDTH",ra.H(c.b4w_water_sss_width))}"HALO"===c.type&&(Q(a,"halo.glslv","halo.glslf"),r(a,c),a.ln=["a_position"]);u(a,"TEXCOORD",0);u(a,"NORMAL_TEXCOORD",0);d&&l(a,d,"TEXTURE_COLOR0_CO");e&&l(a,e,"TEXTURE_COLOR1_CO");b&&l(a,b,"TEXTURE_STENCIL_ALPHA_MASK_CO");h&&l(a,h,"TEXTURE_SPEC_CO");f&&l(a,f,"TEXTURE_NORM_CO");u(a,"SHADELESS",c.use_shadeless?1:0);a.Fe=c.use_shadeless}d=c.game_settings.alpha_blend;
u(a,"ALPHA","OPAQUE"===d?0:1);u(a,"ALPHA_CLIP","CLIP"===d?1:0);u(a,"DOUBLE_SIDED_LIGHTING",c.b4w_double_sided_lighting?1:0);c.use_vertex_color_paint?(u(a,"VERTEX_COLOR",1),G(a,"a_color")):u(a,"VERTEX_COLOR",0);a.xk=c.ambient;a.xn=c.diffuse_intensity;a.Tk=c.emit;a.Uo.set(c.specular_color);a.Py=c.specular_alpha;M(a,c);F(a,c);c.b4w_wettable?u(a,"WETTABLE",1):u(a,"WETTABLE",0);L(a,c);c.b4w_refractive&&!a.eb?(la.warn('Material "'+c.name+'" is not blend. Disabling refractions.'),a.Io=!1):a.Io=c.b4w_refractive;
a.iG=c.b4w_refr_bump}d=!0}break;case "NODES_GLOW":d=J(a,c,"GLOW");break;case "SHADOW":if(c.b4w_lens_flares||c.b4w_water||c.b4w_do_not_render||"HALO"===c.type)d=!1;else if(A(a,c),a.eb)d=!1;else{h=c.game_settings.alpha_blend;c.use_nodes&&"CLIP"==h?J(a,c,"SHADOW"):(Q(a,"shadow.glslv","shadow.glslf"),O.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf));G(a,"a_position");G(a,"a_normal");u(a,"ALPHA","OPAQUE"===h?0:1);a.zi.set([1,1,1]);if((d=x("use_map_color_diffuse",c.texture_slots)[0])&&
"CLIP"===h){switch(d.blend_type){case "MIX":u(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":u(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.zi.set(d.scale);u(a,"TEXTURE_COLOR",1);G(a,"a_texcoord");if("IMAGE"==d.texture.j.source||"ENVIRONMENT_MAP"==d.texture.j.source||"CANVAS"==d.texture.j.source)h=za.Cc(d),R(a,h,"u_colormap0");"NONE"==d.texture.j.source&&(h=za.Cc(d),R(a,h,"u_colormap0"))}else u(a,"TEXTURE_COLOR",0);d=!0}break;case "PHYSICS":c.b4w_collision?(a.ep=
c.b4w_use_ghost,a.pb=c.b4w_collision_id,a.hn=c.b4w_collision_margin,a.fn=c.b4w_collision_group,a.jn=c.b4w_collision_mask,a.Pn=c.physics.friction,a.En=c.physics.elasticity,d=!0):c.b4w_water?(a.mk=!0,a.xU=c.b4w_water_dynamic,a.dst_noise_scale0=c.b4w_water_dst_noise_scale0,a.dst_noise_scale1=c.b4w_water_dst_noise_scale1,a.dst_noise_freq0=c.b4w_water_dst_noise_freq0,a.dst_noise_freq1=c.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=c.b4w_water_dir_min_shore_fac,a.dir_freq=c.b4w_water_dir_freq,a.dir_noise_scale=
c.b4w_water_dir_noise_scale,a.dir_noise_freq=c.b4w_water_dir_noise_freq,a.dir_min_noise_fac=c.b4w_water_dir_min_noise_fac,a.dst_min_fac=c.b4w_water_dst_min_fac,a.waves_hor_fac=c.b4w_water_waves_hor_fac,d=!0):d=!1;break;case "COLOR_ID":if(c.b4w_lens_flares||"HALO"===c.type)d=!1;else{A(a,c);a.Sf=!1;a.Ka=!0;a.eb=!1;h=c.game_settings.alpha_blend;a.Dh=c.b4w_render_above_all&&"OPAQUE"!=h&&"CLIP"!=h;c.use_nodes&&"CLIP"==h?J(a,c,"COLOR_ID"):(Q(a,"color_id.glslv","color_id.glslf"),O.set(c.diffuse_color[0],
c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf));G(a,"a_position");u(a,"ALPHA","OPAQUE"===h?0:1);a.zi.set([1,1,1]);if((d=x("use_map_color_diffuse",c.texture_slots)[0])&&"CLIP"===h){switch(d.blend_type){case "MIX":u(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":u(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.zi.set(d.scale);u(a,"TEXTURE_COLOR",1);G(a,"a_texcoord");if("IMAGE"==d.texture.j.source||"ENVIRONMENT_MAP"==d.texture.j.source)h=za.Cc(d),R(a,h,"u_colormap0");
"NONE"==d.texture.j.source&&(h=za.Cc(d),R(a,h,"u_colormap0"))}else u(a,"TEXTURE_COLOR",0);d=!0}break;case "GRASS_MAP":!c.b4w_terrain||c.b4w_do_not_render?d=!1:(A(a,c),a.eb=!1,a.Sf=!1,a.Ka=!0,Q(a,"grass_map.glslv","grass_map.glslf"),G(a,"a_position"),d=c.b4w_dynamic_grass_size?c.b4w_dynamic_grass_size:null,h=c.b4w_dynamic_grass_color?c.b4w_dynamic_grass_color:null,a.Gc.a_grass_size={tj:!0,src:[]},d?(a.Gc.a_grass_size.src.push({name:d,$e:4}),u(a,"DYNAMIC_GRASS_SIZE",1)):u(a,"DYNAMIC_GRASS_SIZE",0),
a.Gc.a_grass_color={tj:!0,src:[]},h?(a.Gc.a_grass_color.src.push({name:h,$e:7}),u(a,"DYNAMIC_GRASS_COLOR",1)):u(a,"DYNAMIC_GRASS_COLOR",0),d=!0);break;case "DEBUG_VIEW":d=P(a,c);break;case "PARTICLES":a:if(c.b4w_do_not_render)d=!1;else{d=c.texture_slots;if(a.Mw)Q(a,"particle_system.glslv","particle_system_stack.glslf"),u(a,"HALO_PARTICLES",1),r(a,c);else{h={Fe:!1,yn:c.diffuse_shader,$l:c.specular_shader};if(c.use_nodes){Q(a,"particle_system.glslv","particle_system.glslf");J(a,c,"PARTICLES");d=!0;
break a}Q(a,"particle_system.glslv","particle_system_stack.glslf");h=U.Gv(c.uuid,c.name,h);a.Tb.Mj=U.sq(h);if(d=x("use_map_color_diffuse",d)[0]){u(a,"TEXTURE_COLOR",1);switch(d.blend_type){case "MIX":u(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":u(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.wn=d.diffuse_color_factor;a.Mm=d.use_map_alpha?d.alpha_factor:0;d=za.Cc(d);R(a,d)}}O.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf);a.xk=c.ambient;
a.xn=c.diffuse_intensity;a.Tk=c.emit;a.Uo.set(c.specular_color);a.Py=c.specular_alpha;G(a,"a_position");G(a,"a_normal");d=c.game_settings.alpha_blend;u(a,"ALPHA","OPAQUE"===d?0:1);u(a,"ALPHA_CLIP","CLIP"===d?1:0);u(a,"PARTICLES_SHADELESS",c.use_shadeless?1:0);M(a,c);F(a,c);A(a,c);d=c.game_settings.alpha_blend;a.Dh=c.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.Pj=c.offset_z;d=!0}break;default:T.l("Wrong batch type: "+a.type)}return d}function r(a,c){var d=c.halo;u(a,"NUM_RINGS",d.ring_count);u(a,
"NUM_LINES",d.line_count);u(a,"NUM_STARS",d.star_tip_count);u(a,"SKY_STARS",c.b4w_halo_sky_stars?1:0);a.hE=d.size;a.eE=d.hardness/20;a.gE.set(d.b4w_halo_rings_color);a.fE.set(d.b4w_halo_lines_color);a.iE=1/c.b4w_halo_stars_blend_height;a.jE=c.b4w_halo_stars_min_height;a.dE=!0}function l(a,c,d){switch(c.texture_coords){case "UV":case "ORCO":u(a,d,"TEXTURE_COORDS_UV_ORCO");u(a,"TEXCOORD",1);break;case "NORMAL":u(a,d,"TEXTURE_COORDS_NORMAL");u(a,"NORMAL_TEXCOORD",1);break;default:u(a,d,0)}}function A(a,
c){var d=c.game_settings,b=d.alpha_blend;switch(b){case "ALPHA_SORT":a.eb=!0;a.Sf=!0;a.Ka=!0;a.Ui=!1;break;case "ALPHA":a.eb=!0;a.Sf=!1;a.Ka=!0;a.Ui=!1;break;case "CLIP":a.eb=!1;a.Sf=!1;a.Ka=!0;a.Ui=!0;break;case "ADD":a.eb=!0;a.Sf=!1;a.Ka=!1;a.Ui=!1;break;case "OPAQUE":a.eb=!1;a.Sf=!1;a.Ka=!0;a.Ui=!1;break;default:T.l("Unknown alpha blend mode: "+b)}a.Db=d.use_backface_culling}function x(a,c){for(var d=[],b=c.length,m=0;m<b;m++){var e=c[m];1==e[a]&&e.texture&&e.texture.j&&d.push(e)}return d}function L(a,
c){var d=c.raytrace_transparency;a.qj[0]=d.fresnel;a.qj[1]=1-d.fresnel_factor/5;d=c.raytrace_mirror;a.os=d.reflect_factor;a.qj[2]=d.fresnel;a.qj[3]=1-d.fresnel_factor/5}function M(a,c){var d,b=0;switch(c.specular_shader){case "PHONG":case "COOKTORR":d=c.specular_hardness;break;case "WARDISO":d=c.specular_slope;break;case "TOON":d=c.specular_toon_size;b=c.specular_toon_smooth;break;case "BLINN":d=c.specular_ior;b=c.specular_hardness;break;default:la.error("unsupported specular shader: "+c.specular_shader+
' (material "'+c.name+'")'),d=c.specular_hardness}a.Zl[0]=c.specular_intensity;a.Zl[1]=d;a.Zl[2]=b}function F(a,c){switch(c.diffuse_shader){case "LAMBERT":a.ie[0]=0;a.ie[1]=0;break;case "OREN_NAYAR":a.ie[0]=c.roughness;a.ie[1]=0;break;case "FRESNEL":a.ie[0]=c.diffuse_fresnel;a.ie[1]=c.diffuse_fresnel_factor;break;case "MINNAERT":a.ie[0]=c.darkness;a.ie[1]=0;break;case "TOON":a.ie[0]=c.diffuse_toon_size;a.ie[1]=c.diffuse_toon_smooth;break;default:la.error("unsupported diffuse shader: "+c.diffuse_shader+
' (material "'+c.name+'")'),a.ie[0]=0,a.ie[1]=0}}function J(a,c,d){if(!c.use_nodes||c.b4w_do_not_render)return!1;var b;switch(d){case "MAIN":Q(a,"main.glslv","main.glslf");b=!1;break;case "GLOW":Q(a,"main.glslv","main.glslf");b=!0;break;case "SHADOW":Q(a,"shadow.glslv","shadow.glslf");b=!1;break;case "COLOR_ID":Q(a,"color_id.glslv","color_id.glslf"),b=!1}var m=c.node_tree;d=U.yM(m,c.uuid,!1,c.name,d);if(!d.Pa)return la.error('Failed to create node graph for material "'+c.name+'", disable nodes'),
v(a,c),!0;a.Cl=d.id;a.$n=!0;u(a,"NODES",1);u(a,"DOUBLE_SIDED_LIGHTING",c.b4w_double_sided_lighting?1:0);G(a,"a_position");c.use_orco_tex_coord&&G(a,"a_orco_tex_coord");A(a,c);a.Pj=c.offset_z;var e=c.game_settings.alpha_blend;b?(u(a,"ALPHA",1),u(a,"ALPHA_CLIP",0)):(u(a,"ALPHA","OPAQUE"===e?0:1),u(a,"ALPHA_CLIP","CLIP"===e?1:0));a.Dh=c.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;O.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf);a.Tk=c.emit;a.xk=c.ambient;L(a,c);c.b4w_wettable?
u(a,"WETTABLE",1):u(a,"WETTABLE",0);var h=null,f=!1;oa.ma(d.Pa,function(d,b){switch(b.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var m=b.data.name,e=b.data.value;a.jk||(a.jk={});a.jk[e]=m;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":m=b.data.name;a.Gc[m]={tj:!0,src:[{name:b.data.value}]};e=0;if("GEOMETRY_VC"==b.type)e=7;else for(var q=0;q<b.Sa.length;q++){var z="RGB".indexOf(b.Sa[q].identifier);-1<z&&(e|=1<<2-z)}a.Gc[m].src[0].$e=
e;break;case "TEX_COORD_NO":case "GEOMETRY_NO":G(a,"a_normal");break;case "MATERIAL_BEGIN":G(a,"a_normal");f=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":m=b.data.name;e=b.data.value;if(!e.j){la.warn('Wrong texture "'+b.data.value.name+'" in material "'+c.name+'".');v(a,c);break}!1!==e.j.Tp&&(e.j.Tp="TEXTURE_ENVIRONMENT"!=b.type?!0:!1);R(a,e.j,m);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":u(a,"CALC_TBN_SPACE",1);G(a,"a_normal");G(a,"a_tangent");a.$r=!0;m=b.data.name;e=b.data.value;
e.j.Tp=!1;R(a,e.j,m);break;case "LAMP":b.data&&(a.ql=b.data);break;case "B4W_REFRACTION":a.eb?a.Io=!0:(a.Io=!0,la.warn('Material "'+c.name+'" is not blend. Disabling refractions.'));break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":h||(h=b.data.Ja);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&b.data&&(a.Jx=b.data);break;case "VECT_TRANSFORM":switch(Number(b.Mb[1][1])){case U.xK:u(a,"USE_ZUP_MODEL_MATRIX_INVERSE",1);break;case U.wK:u(a,"USE_ZUP_VIEW_MATRIX",1);break;case U.vK:u(a,"USE_ZUP_MODEL_MATRIX",
1);break;case U.uK:u(a,"USE_ZUP_MODEL_MATRIX",1);u(a,"USE_ZUP_VIEW_MATRIX",1);break;case U.tK:u(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1);break;case U.sK:u(a,"USE_ZUP_MODEL_MATRIX_INVERSE",1),u(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1)}break;case "B4W_VECTOR_VIEW":u(a,"USE_ZUP_VIEW_MATRIX",1);break;case "B4W_REFLECT":u(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1)}});h&&R(a,h,"u_nodes_texture");f||(a.Fe=!0);b=a.Tb.Mj=U.sq(d.Pa);C(m,a,c.name);m=a.El;d=a.Dl;for(e=0;e<b.length;e++){var q=b[e];switch(q.id){case "VALUE":var z=
q.Zr[0];if(z)for(var D=0;D<m.length;D+=2)if(m[D]==z){q.Mb.push(["VALUE_IND",m[D+1]]);break}break;case "RGB":if(z=q.Zr[0])for(D=0;D<d.length;D+=2)if(d[D]==z){q.Mb.push(["RGB_IND",d[D+1]]);break}}}u(a,"NUM_VALUES",a.Nj.length);u(a,"NUM_RGBS",a.qe.length);return!0}function C(a,c,d){var b=[],m=[],e=[],h=[],f=[],q=[];H(a,d,a.animation_data,b,m,e,h,f,q);c.Nj=b;c.El=m;c.rF=e;c.qe=h;c.Dl=f;c.sF=q}function H(a,c,b,m,e,h,f,q,z){for(var D=0;D<a.nodes.length;D++){var I=a.nodes[D];if("VALUE"==I.type){var p=d(c,
I.name);m.push(I.outputs[0].default_value);e.push(p,e.length/2)}else"RGB"==I.type?(p=d(c,I.name),I=I.outputs[0].default_value.slice(0,3),f.push(I[0],I[1],I[2]),q.push(p,q.length/2)):"GROUP"==I.type&&(p=I.node_group.node_tree,H(p,d(c,I.name),p.animation_data,m,e,h,f,q,z))}if(b)for((a=b.action)&&a.j.type==Da.Hp&&K(a,c,h,e,z,q),b=b.nla_tracks,m=0;m<b.length;m++)for(f=b[m].strips,D=0;D<b[m].strips.length;D++)(a=f[D].action)&&a.j.type==Da.Hp&&K(a,c,h,e,z,q)}function K(a,c,b,m,e,f){var q=a.j.Ea,z;for(z in q){var D=
d(c,z.match(/"(.*?)"/)[1]),q=h(m,D);null!=q?(D=d(a.name,z),b.push(D,q)):(q=h(f,D),null!=q&&(D=d(a.name,z),e.push(D,q)))}}function d(a,c){return a+"%join%"+c}function h(a,c){for(var d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null}function v(a,c){switch(a.type){case "SHADOW":Q(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":Q(a,"color_id.glslv","color_id.glslf");break;default:Q(a,"main.glslv","main_stack.glslf")}u(a,"SHADELESS",1);G(a,"a_position");G(a,"a_normal");O.set(1,0,1,1,a.uf);
if(c){var d=c.game_settings.alpha_blend;u(a,"ALPHA","OPAQUE"===d?0:1);u(a,"ALPHA_CLIP","CLIP"===d?1:0);u(a,"VERTEX_COLOR",0);a.Pj=c.offset_z;A(a,c)}return!0}function P(a,c){if(c&&(c.b4w_lens_flares||c.b4w_do_not_render))return!1;Q(a,"debug_view.glslv","debug_view.glslf");G(a,"a_position");G(a,"a_normal");G(a,"a_polyindex");a.Ka=!0;a.wireframe_edge_color=[0,0,0];return!0}function c(a,c){if("PHYSICS"!==a.type){"DYNAMIC"==c.type?(c.vr?u(a,"AU_QUALIFIER","attribute"):u(a,"AU_QUALIFIER","uniform"),u(a,
"STATIC_BATCH",0)):(u(a,"AU_QUALIFIER","attribute"),u(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(da.QD()?u(a,"WIREFRAME_QUALITY",1):u(a,"WIREFRAME_QUALITY",0),a.hj?(u(a,"DEBUG_SPHERE",1),a.sC?u(a,"DEBUG_SPHERE_DYNAMIC",1):u(a,"DEBUG_SPHERE_DYNAMIC",0)):u(a,"DEBUG_SPHERE",0),u(a,"ALPHA",1));c.Pf&&(a.Pf=c.Pf);c.Ie?(""!==c.bh?(a.Gc.a_bending_col_main={tj:!0,src:[{name:c.bh,$e:4}]},G(a,"a_bending_col_main"),""!==c.ad.QE&&""!==c.ad.PE&&""!==c.ad.GF?(a.Gc.a_bending_col_detail={tj:!0,src:[{name:c.ad.QE,
$e:4},{name:c.ad.PE,$e:2},{name:c.ad.GF,$e:1}]},G(a,"a_bending_col_detail"),G(a,"a_normal"),u(a,"DETAIL_BEND",1)):u(a,"DETAIL_BEND",0),u(a,"MAIN_BEND_COL",1)):u(a,"MAIN_BEND_COL",0),u(a,"WIND_BEND",1)):u(a,"WIND_BEND",0);c.eq?u(a,"BEND_CENTER_ONLY",1):u(a,"BEND_CENTER_ONLY",0);u(a,"BILLBOARD_PRES_GLOB_ORIENTATION",c.av|0);c.rf?u(a,"BILLBOARD",1):u(a,"BILLBOARD",0);c.rf&&c.vr?u(a,"HAIR_BILLBOARD",1):u(a,"HAIR_BILLBOARD",0);c.Sm?u(a,"BILLBOARD_SPHERICAL",1):u(a,"BILLBOARD_SPHERICAL",0);switch(c.Tm){case "RANDOM":u(a,
"BILLBOARD_RANDOM",1);u(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":u(a,"BILLBOARD_RANDOM",0);u(a,"BILLBOARD_JITTERED",1);break;default:u(a,"BILLBOARD_RANDOM",0),u(a,"BILLBOARD_JITTERED",0)}c.Ic&&fa.Up?u(a,"DYNAMIC_GRASS",1):u(a,"DYNAMIC_GRASS",0);a.Ic=c.Ic;"PARTICLES"!=a.type&&(a.$f=c.$f);a.ye=c.ye;a.Pd=c.Pd;a.Qd=c.Qd&&!a.Fe&&!(a.eb&&fa.Zv);a.rd=c.rd;a.fd=c.fd;a.Md=c.Md;c.ml?(G(a,"a_influence"),u(a,"SKINNED",1),fa.Ju?(u(a,"DISABLE_TANGENT_SKINNING",1),u(a,"FRAMES_BLENDING",0)):(u(a,"DISABLE_TANGENT_SKINNING",
0),c.On?u(a,"FRAMES_BLENDING",1):u(a,"FRAMES_BLENDING",0)),u(a,"MAX_BONES",c.dh)):(u(a,"SKINNED",0),u(a,"FRAMES_BLENDING",0),u(a,"DISABLE_TANGENT_SKINNING",0));c.Fc?(u(a,"VERTEX_ANIM",1),fa.nI?u(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):u(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):u(a,"VERTEX_ANIM",0);c.ml&&c.Fc&&T.l("Skinning and vertex animation are mutually exlusive");c.Iq?u(a,"DISABLE_FOG",1):u(a,"DISABLE_FOG",0)}}function p(a,c,d){if(c.length){for(var b=ea.ar(c,fa.Rd&&d.b4w_enable_ssao),
m=a.Tb,e=0,h=0;h<a.Tb.Mj.length;h++){var f=a.Tb.Mj[h];if("LIGHTING_LAMP"==f.id){var q=c[e++%c.length],z=q.$b;"AREA"==z.type&&(q=c[e++%c.length],z=q.$b);var D=ea.aa(q,d);if("SPOT"==z.type||"POINT"==z.type)var I=Math.cos(z.am/2);if("SPOT"==z.type)var p=z.Ss*(1-I);D=D.Fj;q=b.indexOf(q);f.Mb=[["LAMP_TYPE",z.type],["LAMP_IND",D],["LAMP_LIGHT_FACT_IND",Math.floor(D/2)],["LAMP_FAC_CHANNELS",0==D%2?"rg":"ba"],["LAMP_SPOT_SIZE",ra.H(I||.01)],["LAMP_SPOT_BLEND",ra.H(p||.01)],["LAMP_LIGHT_DIST",ra.H(z.distance)],
["LAMP_SHADOW_MAP_IND",q]]}}if(a.ql){d=0;for(var g in a.ql)d++;a.dx=new Float32Array(3*d);a.bx=new Float32Array(3*d);a.ax=new Float32Array(3*d);a.cx=new Float32Array(4*d);ra.V(m,"NUM_LAMP_LIGHTS",d);for(h=0;h<c.length;h++)N(a,c[h])}}}function N(a,c){if(c.Ei in a.ql){var d=a.ql[c.Ei];a.dx.set(ma.q(c.g.i),3*d);a.bx.set(c.$b.direction,3*d);a.ax.set(c.$b.kn,3*d);var b=sa,m=c.$b;b[0]=-1;b[1]=-1;b[2]=-1;b[3]=m.ik?1:0;switch(m.type){case "POINT":b[2]=m.distance;break;case "SPOT":b[2]=m.distance;var e=b[0]=
Math.cos(m.am/2);b[1]=m.Ss*(1-e)}a.cx.set(b,4*d)}}function G(a,c){var d=a.ln;-1==d.indexOf(c)&&d.push(c)}function u(a,c,d){ra.V(a.Tb,c,d)}function z(a,c){if("PHYSICS"==a.type)0<c.Oa.length&&E.VS(c,c.N[0]),a.Ae=c;else{var d=a.Sf,b=a.Rh;a.dE&&"PARTICLES"!=a.type&&(c=E.YN(c));a.xI&&(c=ba.CO(a.yI,a.zI,a.wI));d=E.XS(c,d,b,a.Gc);a.oa=d;a.$f||d.or||a.Pf||(d.yj=null,d.sd=null);d=c.N.length;a.Fx=c.wa*d;a:switch(a.Rh){case E.Am:case E.sp:case E.rp:b=!0;break a;default:b=!1}b?E.IP(c)?a.ro=c.ab.length/3*d:a.ro=
c.wa/3*d:a.ro=0}}function q(a,d,b,e,h,f,q,z,p,g,v,u){var l=a.ya,wa=[],U=z.b4w_dynamic_grass;if(!g&&U)return wa;for(var V="INSTANCE"==z.b4w_wind_bend_inheritance,G="INSTANCE"==z.b4w_shadow_inheritance,r="INSTANCE"==z.b4w_reflection_inheritance,Q=[],A=[],x=0;x<h.length;x++){var t=h[x].ya.g,R=T.dn(d);R.rf=z.b4w_hair_billboard;R.Tm=z.b4w_hair_billboard_type;R.Sm="SPHERICAL"==z.b4w_hair_billboard_geometry;R.Ic=U;R.vr=!0;V?(R.Ie=t.Ie,R.kp=t.kp,R.Ch=t.Ch,R.Pg=t.Pg,R.bh=t.bh,R.Og=t.Og,R.Hg=t.Hg,R.zg=t.zg,
R.ad=t.ad,R.eq=!1):(R.Ie=l.g.Ie,R.kp=l.g.kp,R.Ch=l.g.Ch,R.Pg=l.g.Pg,R.bh=l.g.bh,R.Og=l.g.Og,R.Hg=l.g.Hg,R.zg=l.g.zg,R.ad=l.g.ad,R.eq=!0);G?(R.ye=t.ye,R.Pd=t.Pd,R.Qd=t.Qd):(R.ye=l.g.ye,R.Pd=l.g.Pd,R.Qd=l.g.Qd);r?(R.rd=t.rd,R.fd=t.fd,R.Md=t.Md,R.Qe=t.Qe,R.se=t.se,R.pg=t.pg):(R.rd=l.g.rd,R.fd=l.g.fd,R.Md=l.g.Md,R.Qe=l.g.Qe,R.se=l.g.se,R.pg=l.g.pg);Q.push(R);var n=q[x];n||(n=new Float32Array);u&&T.pr(p.seed,v);var N=new Float32Array(3),Y=new Float32Array([0,0,0,1]),w=[],P=ca.HB(fa.lx)&&!z.b4w_initial_rand_rotation&&
!z.b4w_hair_billboard,ea=4;P&&(ea=8);for(var sa=0;sa<n.length;sa+=ea){N[0]=n[sa];N[1]=n[sa+1];N[2]=n[sa+2];var Ba=n[sa+3]*ma.Oc(t.i);if(z.b4w_initial_rand_rotation){switch(z.b4w_rotation_type){case "XYZ":var B=new Float32Array([T.ef(v),T.ef(v),T.ef(v)]);ga.normalize(B,B);break;case "Z":B=new Float32Array([0,1,0]);break;default:T.l("Unsupported random rotation type: "+z.b4w_rotation_type)}aa.setAxisAngle(B,z.b4w_rand_rotation_strength*(2*Math.PI*T.ef(v)-Math.PI),Y)}else P&&(Y.set(n.subarray(sa+4,sa+
8)),T.Tx(Y,Y),z.use_whole_group||(z.use_rotation_dupli?aa.multiply(Y,ma.B(t.i),Y):aa.multiply(Y,Ea,Y)));var Ka=ma.qh(N,Ba,Y,ma.create());w.push(Ka)}A.push(w)}for(var H={},x=0;x<h.length;x++){var Ca=h[x],ob=f[x],R=Q[x],Sa={};R.Ie&&(Sa.au_wind_bending_amp=[R.zg],Sa.au_wind_bending_freq=[R.Ch],Sa.au_detail_bending_freq=[R.Pg],Sa.au_detail_bending_amp=[R.Og],Sa.au_branch_bending_amp=[R.Hg],R.zg=0,R.Ch=0,R.Pg=0,R.Og=0,R.Hg=0);var y=m(R),w=A[x];if(w.length){for(var K=Ca.data,C=K.materials,L=Array(C.length),
S=Array(C.length),sa=0;sa<C.length;sa++)if(!E.mE(K,sa))for(var F=0;F<ob.length;F++){var Fa=ob[F],da=k(Fa),X=C[sa];"COLOR_ID"==Fa&&(da.mv=!(Ca.b4w_do_not_render||X.b4w_do_not_render));"MAIN"==Fa?L[sa]=da:"DEBUG_VIEW"==Fa&&(S[sa]=da);da.en=a.b4w_cluster_data.cluster_id;if(D(da,X)){"SHADOW"==Fa&&L[sa]&&(da.Fe=L[sa].Fe);da.Rh=E.Am;c(da,R);da.Gl=z.uuid;"JITTERED"==z.b4w_hair_billboard_type&&(da.GE=z.b4w_hair_billboard_jitter_amp,da.HE=z.b4w_hair_billboard_jitter_freq);U&&(da.aE=z.b4w_dynamic_grass_scale_threshold);
V||(delete da.Gc.a_bending_col_main,delete da.Gc.a_bending_col_detail);I(da,y);var Ja=E.FC(K,sa,da.ln,d.Fk,da.Gc,da.jk),J=E.qQ(Ja,Sa,w,l),M=J,ia=w;M.ba.au_center_pos=new Float32Array(3*M.wa);for(var ha=ia.length,ba=M.wa/ha,W=0;W<ha;W++)for(var La=ia[W],Z=3*ba*W,O=0;O<ba;O++)M.ba.au_center_pos[Z+3*O]=La[0],M.ba.au_center_pos[Z+3*O+1]=La[1],M.ba.au_center_pos[Z+3*O+2]=La[2];J=M;if(R.Ie&&R.eq){var ja=J,ka=l.g.i;ja.ba.a_emitter_center=new Float32Array(3*ja.wa);var oa=ga.fromValues(0,0,0);ma.Ec(oa,ka,
oa);for(var Ia=0;Ia<ja.wa;Ia++)ja.ba.a_emitter_center[3*Ia]=oa[0],ja.ba.a_emitter_center[3*Ia+1]=oa[1],ja.ba.a_emitter_center[3*Ia+2]=oa[2];J=ja}var Aa=z.b4w_vcol_from_name,ra=z.b4w_vcol_to_name,za=da,ya=b,Da=!V,pa=K,ua=[];if(""!==Aa&&""!==ra){var Ab,Hb=ra,Bb=za.Gc,Ib=[],Jb=void 0;for(Jb in Bb)for(var rc=Bb[Jb].src,Zb=0,sc=0;sc<rc.length;sc++){var pb=rc[sc].$e;Hb==rc[sc].name&&Ib.push(Jb,pb,Zb);Zb+=T.Zj(pb)}Ab=Ib;if(0<Ab.length)for(var rb=0;rb<Ab.length;rb+=3)ua.push({Fn:Aa,Mq:7,as:Ab[rb],bs:Ab[rb+
1],Jq:Ab[rb+2]});else E.lP(za.ln,"a_color")&&ra==pa.active_vcol_name&&ua.push({Fn:Aa,Mq:7,as:"a_color",bs:7,Jq:0})}Da&&("a_bending_col_main"in ya&&ua.push({Fn:"a_bending_col_main",Mq:4,as:"a_bending_col_main",bs:4,Jq:0}),"a_bending_col_detail"in ya&&ua.push({Fn:"a_bending_col_detail",Mq:7,as:"a_bending_col_detail",bs:7,Jq:0}));for(var Pa=J,bb=w,lc=e,gb=ua,wc=da.Gc,Cb=!1,hb=0;hb<gb.length;hb++){var Ub=gb[hb].Fn,ic=lc.ba[Ub];if(ic&&0<ic.length){Cb=!0;break}}if(Cb){var Ec,jb=l.g.R,Wa=lc.N[0].a_position,
$b=bb,va=H,Nb=new Float32Array(3),Ya=new Float32Array(3),Ob=new Uint32Array($b.length);if(!("verts_indices"in va)){va.Jg=new Float32Array(3);va.Fg=new Float32Array(3);va.vz=new Uint32Array(Wa.length/3);va.so=new Uint32Array(Wa.length/3);va.Jg[0]=(jb.max_x-jb.min_x)/20;va.Jg[1]=(jb.max_y-jb.min_y)/20;va.Jg[2]=(jb.max_z-jb.min_z)/20;va.Fg[0]=jb.min_x;va.Fg[1]=jb.min_y;va.Fg[2]=jb.min_z;for(var Qa=0;Qa<Wa.length/3;Qa++){var kb=T.trunc((Wa[3*Qa]-va.Fg[0])/va.Jg[0]),jc=T.trunc((Wa[3*Qa+1]-va.Fg[1])/va.Jg[1]),
ub=T.trunc((Wa[3*Qa+2]-va.Fg[2])/va.Jg[2]),kb=T.S(kb,0,19),jc=T.S(jc,0,19),ub=T.S(ub,0,19);va.vz[Qa]=Qa;va.so[Qa]=ub*Math.pow(20,2)+20*jc+kb}E.gH(va.so,va.vz,E.Du,!0);va.kk=new Uint32Array(Math.pow(20,3));for(Qa=0;Qa<va.so.length;Qa++)va.kk[va.so[Qa]]++;delete va.so;for(Qa=1;Qa<va.kk.length;Qa++)va.kk[Qa]+=va.kk[Qa-1]}for(var Ta=0;Ta<$b.length;Ta++){Nb[0]=$b[Ta][0];Nb[1]=$b[Ta][1];Nb[2]=$b[Ta][2];for(var Za=1E10,cb=-1,sb=T.trunc((Nb[0]-va.Fg[0])/va.Jg[0]),ac=T.trunc((Nb[1]-va.Fg[1])/va.Jg[1]),Pb=
T.trunc((Nb[2]-va.Fg[2])/va.Jg[2]),sb=T.S(sb,0,19),ac=T.S(ac,0,19),Pb=T.S(Pb,0,19),$a=Pb*Math.pow(20,2)+20*ac+sb,db=va.kk[$a],mb=0==$a?0:va.kk[$a-1];mb<db;mb++){var qb=va.vz[mb];Ya[0]=Wa[3*qb];Ya[1]=Wa[3*qb+1];Ya[2]=Wa[3*qb+2];ga.sub(Ya,Nb,Ya);var zb=ga.sqrLen(Ya);zb<=Za&&(Za=zb,cb=qb)}if(-1==cb)for(mb=0;mb<Wa.length/3;mb++)Ya[0]=Wa[3*mb],Ya[1]=Wa[3*mb+1],Ya[2]=Wa[3*mb+2],ga.sub(Ya,Nb,Ya),zb=ga.sqrLen(Ya),zb<=Za&&(Za=zb,cb=mb);Ob[Ta]=cb}Ec=Ob;for(var gd=Pa.wa/bb.length,hb=0;hb<gb.length;hb++){var Vb=
gb[hb].as,Ic=gb[hb].bs,Ub=gb[hb].Fn,kc=gb[hb].Mq,ic=lc.ba[Ub];switch(Vb){case "a_bending_col_main":var tc=1;break;case "a_bending_col_detail":tc=3;break;case "a_color":tc=3;break;default:for(var bc=tc=0;bc<wc[Vb].src.length;bc++)tc+=T.Zj(wc[Vb].src[bc].$e)}if(ic&&0<ic.length){var mc=T.Zj(kc),Ac=T.Zj(Ic),Jc=kc&Ic,xc=T.pG(Jc);Jc!=Ic&&la.error("Wrong color extraction from "+Ub+" to "+Vb+".");if("a_bending_col_main"==Vb||"a_bending_col_detail"==Vb)Pa.ba[Vb]=new Float32Array(Pa.wa*Ac);for(bc=0;bc<bb.length;bc++){var cc=
Ec[bc],Qb=cc*mc,Oc=bc*gd*tc;if(-1!=cc)for(var dc=0;dc<gd;dc++)for(var ec=dc*tc,Wb=0;Wb<xc.length;Wb++)xc[Wb]&&(Pa.ba[Vb][Oc+ec+(gb[hb].Jq+T.Lo(Ic,Wb))]=ic[Qb+T.Lo(kc,Wb)])}}else Pa.ba[Vb]=new Float32Array(0)}}J=Pa;wa.push({G:da,Ae:J,Hd:[X.name],g:R,ue:[a]})}}for(sa=0;sa<S.length;sa++)S[sa]&&(S[sa].Eq=L[sa].id,I(S[sa],S[sa].cy))}}return wa}function D(a,c){var d=!0;"NODES_GLOW"==a.type&&(d=U.FB(c));return d=d&&f(a,c)}function I(a,c){var d=null,b=null,m=a.R,e=a.Ga,h=a.I,f=a.na;a.R=null;a.Ga=null;a.I=
null;a.na=null;for(var q=0;q<a.fa.length;q++){var z=a.fa[q].ce;z&&(d||(d={}),d[q]=z,a.fa[q].ce=null);if(z=a.fa[q].Ba)b||(b={}),b[q]=z,a.fa[q].Ba=null}a.id=0;a.cy=c;a.id=T.sB(a,c);a.R=m;a.Ga=e;a.I=h;a.na=f;if(d)for(var D in d)a.fa[D].ce=d[D];if(b)for(D in b)a.fa[D].Ba=b[D]}function m(a){var c=a.Oe;a.Oe=null;var d=T.sB(a,0);a.Oe=c;return d}function V(a,d,b,e,h,f){var q=k("DEBUG_VIEW");Q(q,"debug_view.glslv","debug_view.glslf");q.hj=!0;q.Ka=!0;q.Gl=b;h&&(q.sC=!0);c(q,d);d=m(d);I(q,d);e?(d=h?a.O:[0,0,
0],e=ba.sw(1,d),b=[ga.length(a.$d),ga.length(a.ae),ga.length(a.be)],E.tG(e,b,d),h||(ma.ff(a.O,wa),h=ga.normalize(a.$d,ua),d=ga.normalize(a.ae,Fa),a=ga.normalize(a.be,Ia),a=T.MN(h,d,a,Ka),ya.invert(a,a),a=aa.fromMat3(a,sa),ma.ri(a,wa),ma.ve(1,wa),E.Vy(e,wa))):e=ba.sw(a.mb,a.O);q.R=T.ia(f.R);q.Ga=T.ia(f.Ga);q.I=T.ia(f.I);q.na=T.ia(f.na);E.Vs(e,1,!0);e.ba.a_polyindex=E.Oq(e);z(q,e);return q}function Q(a,c,d){a.Tb.vm=c;a.Tb.Yk=d;ra.NR(a.Tb)}function R(a,c,d){1==a.fa.length&&0==a.Sc.length&&a.Sc.push("default0");
d=d||"default"+String(a.fa.length);-1==a.Sc.indexOf(d)&&(a.fa.push(c),a.Sc.push(d));a.rb&&S.fB(a)}function X(a){a.Tb||T.l("No shaders info for batch "+a.name);a.rb=ra.KO(a.Tb);S.pL(a.rb);S.lL(a);S.fB(a)}function ja(a,c,d){a=a.A[0].X;for(var b=0;b<a.length;b++)if(a[b].type==d&&!a[b].dg&&-1!=a[b].Cf.indexOf(c))return a[b];return null}function W(a,c,d){a=a.A[0].X;for(var b=0;b<a.length;b++)if(a[b].type==d&&a[b].dg&&-1!=a[b].Cf.indexOf(c))return a[b];return null}function Z(a,c){a.uf.set(c.uf);a.xn=c.xn;
a.Uo.set(c.Uo);a.Rs=c.Rs;a.Zl.set(c.Zl);a.Tk=c.Tk;a.xk=c.xk;a.wn=c.wn;a.Mm=c.Mm;a.os=c.os;a.qj.set(c.qj);a.Yr=c.Yr;a.Hs.set(c.Hs);a.Is=c.Is;a.Ls.set(c.Ls);a.Ms=c.Ms;a.Rq=c.Rq;a.pt=c.pt}function Y(a,c){for(var d=a.El,b=0;b<d.length;b+=2)if(d[b]==c)return d[b+1];return null}function ia(a,c){for(var d=a.Dl,b=0;b<d.length;b+=2)if(d[b]==c)return d[b+1];return null}var ha=n("__boundings"),ka=n("__config"),la=n("__print"),da=n("__extensions"),E=n("__geometry"),oa=n("__graph"),U=n("__nodemat"),ea=n("__obj_util"),
Ca=n("__particles"),ba=n("__primitives"),aa=n("__quat"),ca=n("__reformer"),S=n("__renderer"),Aa=n("__scenegraph"),ra=n("__shaders"),za=n("__textures"),ma=n("__tsr"),T=n("__util"),Da=n("__animation"),ga=n("__vec3"),O=n("__vec4"),ya=n("__mat3"),fa=ka.v,pa=["MAIN"],Ea=new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]),ua=new Float32Array(3),Fa=new Float32Array(3),Ia=new Float32Array(3),sa=new Float32Array(4),wa=ma.create(),Ba=new Float32Array(24),Ka=ya.create();a.DU=Ja;var Ja="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),
La={};a.tL=function(a){return La[a]||null};a.uL=function(a,c){La[a]=c};a.u_=k;a.BO=function(a,c,d,m){for(var e=[],h=[],f=0;f<c.length;f++){var q=c[f],D=q.ya;D.io||(ea.Ha(D)?e.push(q):h.push(q))}for(var f=[],f=f.concat(y(e,a.j.Pa)),D=f=f.concat(g(h,a.j.Pa)),e=[],h=[],I={},f=0;f<D.length;f++){var v=D[f].G,u=D[f].g,l=null;if(v.id in I){var wa=I[v.id],k=h[wa].G,U=h[wa].g,G=null,r=null,Q=v.R,A=v.Ga,R=v.I,x=v.na;v.R=null;v.Ga=null;v.I=null;v.na=null;var t=k.R,n=k.Ga,N=k.I,Y=k.na;k.R=null;k.Ga=null;k.I=
null;k.na=null;for(q=0;q<v.fa.length;q++){var w=v.fa[q].ce;w&&(G||(G={}),G[q]=w,v.fa[q].ce=null);if(w=v.fa[q].Ba)r||(r={}),r[q]=w,v.fa[q].Ba=null}T.rH(v,k)&&T.rH(u,U)&&(l=h[wa]);v.R=Q;v.Ga=A;v.I=R;v.na=x;k.R=t;k.Ga=n;k.I=N;k.na=Y;if(G)for(q in G)v.fa[q].ce=G[q];if(r)for(q in r)v.fa[q].Ba=r[q];if(!l){do v.id++;while(I[v.id])}}l||(l={G:v,g:D[f].g,ue:[],Wy:[],Hd:[]},I[v.id]=h.length,h.push(l));l.ue=l.ue.concat(D[f].ue);D[f].Ae&&D[f].Ae.wa&&l.Wy.push(D[f].Ae);if(l.Hd.length)for(q=0;q<D[f].Hd.length;q++)v=
D[f].Hd[q],-1==l.Hd.indexOf(v)&&l.Hd.push(v);else l.Hd=D[f].Hd;E.gH(l.Hd,l.Wy,E.nK,!1)}for(f=0;f<h.length;f++){D=h[f].Wy;if(0==D.length)q=T.Bc(T.Zo("%empty"));else if(1==D.length)q=D[0];else{I=[];for(q=0;q<D.length;q++)E.JP(D[q])||I.push(q);if(I.length<D.length)for(q=0;q<I.length;q++)E.Vs(D[I[q]]);q=E.WS(D)}"PARTICLES"!=h[f].G.type&&(D=q.kd,h[f].G.R=T.ia(D.R),h[f].G.Ga=T.ia(D.Ga),h[f].G.I=T.ia(D.I),h[f].G.na=T.ia(D.na));e.push({G:h[f].G,g:h[f].g,Ae:q,Hd:h[f].Hd,ue:h[f].ue})}for(h=0;h<e.length;h++)if(D=
e[h].G,D.Cf=e[h].Hd,z(D,e[h].Ae),p(D,d,a),"STATIC"==e[h].g.type&&"COLOR_ID"!=D.type){f=T.Zo("%meta%"+D.type+"%"+D.Cf.join("%")+"%");I=ea.pn(f,"MESH");I.g=T.ia(e[h].g);ea.Pm(I,a);ea.Xp(I,a,D);m.push(I);l=[];for(q=0;q<e[h].ue.length;q++){f=e[h].ue[q];f=f.ya;ha.Kn(f.g.I,Ba);for(v=0;v<Ba.length;v++)l.push(Ba[v]);"MAIN"==D.type&&f.gF.push(I)}I.g.na=ha.wq(l,!0);I.g.Ga=ha.gv(I.g.na,I.g.i)}else for(I=[],q=0;q<e[h].ue.length;q++)f=e[h].ue[q],f=f.ya,-1==I.indexOf(f.name)&&(ea.Xp(f,a,D),I.push(f.name));if(fa.debug_view){for(h=
0;h<e.length;h++)if(d=e[h].g,"DYNAMIC"==d.type&&(f=e[h].ue[0].ya,-1<pa.indexOf(e[h].G.type))){q=ea.aa(f,a);D=q.X;I=!1;for(q=0;q<D.length;q++)D[q].hj&&(I=!0);I||(d=V(d.Ga,d,f.name,!0,!0,d),ea.Xp(f,a,d))}for(h=0;h<m.length;h++)f=m[h],d=f.g,q=ea.aa(f,a),D=q.X,-1<pa.indexOf(D[0].type)&&(d=V(D[0].na,d,f.name,!0,!1,D[0]),ea.Xp(f,a,d));for(h=0;h<e.length;h++)D=e[h].G,"DEBUG_VIEW"==D.type&&(D.qC=h)}for(h=0;h<c.length;h++)for(q=ea.aa(c[h].ya,a),D=q.X,q=0;q<D.length;q++)b(D[q]);for(h=0;h<m.length;h++)for(q=
ea.aa(m[h],a),D=q.X,q=0;q<D.length;q++)b(D[q])};a.SK=function(a,c,d){var m=a.j.Ez,h=k("MAIN");Q(h,"special_skydome.glslv","special_skydome.glslf");if(c.procedural_skydome)u(h,"PROCEDURAL_SKYDOME",1),h.UF=!0;else{var f=m.My;if(f){u(h,"WO_SKYTEX",1);var q=za.Cc(m.eH,null);R(h,q,"u_sky");f.invert&&u(h,"MTEX_NEGATIVE",1);f.iU&&u(h,"MTEX_RGBTOINT",1);u(h,"BLENDTYPE",f.AL);f.eU&&u(h,"WOMAP_BLEND",1);f.fU&&u(h,"WOMAP_HORIZ",1);f.hU&&u(h,"WOMAP_ZENUP",1);f.gU&&u(h,"WOMAP_ZENDOWN",1)}m.jU&&u(h,"WO_SKYBLEND",
1);m.kU&&u(h,"WO_SKYPAPER",1);m.lU&&u(h,"WO_SKYREAL",1)}c.rd&&(h.rd=!0,c.fd&&(h.fd=!0));h.Pj=99999;G(h,"a_position");c=ba.xO();z(h,c);b(h);m=ea.aa(d,a);d.g.kj=!0;d.g.R=ha.bc();d.g.Pe=ha.Ki();d.g.I=ha.bc();d.g.Yc=ha.Ki();d.g.Ga=ha.kf();d.g.na=ha.kf();h.Ga=ha.kf();h.na=ha.kf();h.R=ha.bc();h.I=ha.bc();I(h);m.X.push(h);Aa.Nb(a.j.Pa,"DEBUG_VIEW")&&(a=e(h),a.type="DEBUG_VIEW",a.sb="",P(a),u(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),c.ba.a_polyindex=E.Oq(c),z(a,c),a.Eq=h.id,I(a),m.X.push(a))};a.Fv=function(a,c,
d){d=ea.aa(a,d).X;var b=[];Aa.Nb(c,"SHADOW_CAST");var m=Aa.Nb(c,"MAIN_PLANE_REFLECT"),h=Aa.Nb(c,"MAIN_CUBE_REFLECT"),f=Aa.Nb(c,"OUTLINE_MASK");c=Aa.Nb(c,"COLOR_PICKING");for(var q=0;q<d.length;q++){var D=d[q],z=null;"SHADOW"==D.type&&"RECEIVE"==D.sb&&D.ye&&(z=e(D),z.sb="CAST");"MAIN"!=D.type&&"PARTICLES"!=D.type||!m&&!h||!D.rd||(z=e(D),z.sb="REFLECT",z.Qa=D.Qa,z.Sf&&(z.Sf=!1,z.Ka=!1));"COLOR_ID"==D.type&&D.mv&&f&&a.g.hc&&(c&&a.g.oi?(z=e(D),z.sb="OUTLINE"):D.sb="OUTLINE");z&&(z.dg=!0,I(z,a.g.id),b.push(z))}d.push.apply(d,
b)};a.bS=w;a.zU=function(a,c,d){c?c=d*(c.max_y-c.min_y):(c=1,T.l("No bounding box for mesh"));if(0==c)return 0;a=c*Math.tan(T.jb(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/c};a.vL=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.ZK=function(a,c,d){c=za.$C(c,d);R(a,c,"u_color_ramp_tex")};a.uT=v;a.tT=p;a.ZR=N;a.eB=function(a,c){u(a,"CSM_SECTION0",0);u(a,"CSM_SECTION1",0);u(a,"CSM_SECTION2",0);u(a,"CSM_SECTION3",0);u(a,"NUM_CAST_LAMPS",
0);if(c){u(a,"NUM_CAST_LAMPS",c.Bf.length);fa.Hr&&u(a,"MAC_OS_SHADOW_HACK",1);for(var d=0;d<c.csm_num;d++)u(a,"CSM_SECTION"+String(d),1);u(a,"SHADOW_TEX_RES",ra.H(c.csm_resolution));u(a,"CSM_FADE_LAST_CASCADE",c.fade_last_cascade?1:0);u(a,"CSM_BLEND_BETWEEN_CASCADES",c.blend_between_cascades?1:0)}else u(a,"SHADOW_TEX_RES",0),u(a,"CSM_FADE_LAST_CASCADE",0),u(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.Od=u;a.yw=function(a,c){return ra.OO(a.Tb,c)};a.rT=z;a.sT=I;a.OL=m;a.tX=V;a.Bk=R;a.wR=function(a,c,d){d=
a.Sc.indexOf(d);-1<d&&(a.fa[d]=c)};a.bN=function(a,c){var d=k("MAIN");d.eb=!0;O.set(c[0],c[1],c[2],.5,d.uf);d.Rh=E.sp;z(d,a);Q(d,"main.glslv","main_stack.glslf");u(d,"SHADELESS",1);X(d);return d};a.Uc=X;a.AO=function(a,c){for(var d=0;d<c.length;d++){var m=c[d].ya,e=k("LINE");Q(e,"line.glslv","line.glslf");e.eb=!0;var h=ba.zO();z(e,h);b(e);e.R=ha.bc();e.I=ha.bc();e.Ga=ha.kf();e.na=ha.kf();ea.Pm(m,a);ea.aa(m,a).X.push(e);X(e)}};a.XL=function(a){return a.rb.zo.length?a.rb.Mx.u_cube_fog?!0:!1:!1};a.KM=
function(){var a=k("DEPTH_PACK");a.Db=!0;a.Ka=!1;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");X(a);return a};a.Iv=function(a){var c=k("POSTPROCESSING");Q(c,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":u(c,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":u(c,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":u(c,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":u(c,"POST_EFFECT",
"POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":u(c,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":u(c,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":u(c,"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":u(c,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;case "FLIP_CUBEMAP_COORDS":u(c,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:T.l("Wrong postprocessing effect: "+a)}c.Db=!0;c.Ka=!1;a=ba.qc();z(c,a);X(c);return c};a.eN=function(a){var c=k("SSAO");c.Ka=
!1;c.Db=!0;var d=ba.qc();z(c,d);Q(c,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");u(c,"SSAO_QUALITY","SSAO_QUALITY_"+a.lH);u(c,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:za.DO("SSAO_TEXTURE",a)};d={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=za.Cc(a,d);R(c,a,"u_ssao_special_tex");
X(c);return c};a.fN=function(a){var c=k("SSAO_BLUR");c.Ka=!1;c.Db=!0;var d=ba.qc();z(c,d);Q(c,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");u(c,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);X(c);return c};a.LM=function(){var a=k("DOF");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");u(a,"DEPTH_RGBA",1);X(a);return a};a.UM=function(){var a=k("OUTLINE");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv",
"postprocessing/outline.glslf");X(a);return a};a.NM=function(){var a=k("GLOW_COMBINE");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");X(a);return a};a.OM=function(a,c,d){var b=k("GOD_RAYS");b.Ka=!1;b.Db=!0;var m=ba.sO();z(b,m);Q(b,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");u(b,"DEPTH_RGBA",a?1:0);u(b,"WATER_EFFECTS",c?1:0);u(b,"STEPS_PER_PASS",ra.H(d,1));X(b);return b};a.PM=function(){var a=k("GOD_RAYS_COM");a.Ka=!1;
a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");u(a,"SAFARI_CANVAS_ALPHA_HACK",fa.sG?1:0);X(a);return a};a.XM=function(){var a=k("SKY");a.Ka=!1;a.Db=!0;var c=ba.tO();z(a,c);Q(a,"procedural_skydome.glslv","procedural_skydome.glslf");u(a,"WATER_EFFECTS",1);X(a);return a};a.DM=function(a){var c=k("ANTIALIASING");c.Ka=!1;c.Db=!0;var d=ba.qc();z(c,d);Q(c,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");fa.YF?(u(c,
"AA_METHOD","AA_METHOD_FXAA_QUALITY"),u(c,"AA_QUALITY",a.rO)):u(c,"AA_METHOD","AA_METHOD_FXAA_LIGHT");X(c);return c};a.cN=function(a){var c=k("SMAA"),d=ba.qc();z(c,d);Q(c,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");u(c,"AA_METHOD","AA_METHOD_SMAA_HIGH");u(c,"SMAA_PASS",a);u(c,"SMAA_PREDICATION",0);u(c,"SMAA_REPROJECTION",0);X(c);c.Ka=!1;c.Db=!0;return c};a.IM=function(){var a=k("COMPOSITING");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");
X(a);return a};a.TM=function(){var a=k("MOTION_BLUR");a.Db=!0;a.Ka=!1;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");X(a);return a};a.gN=function(a){var c=k("STEREO");c.Db=!0;c.Ka=!1;var d=ba.qc();z(c,d);Q(c,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");u(c,"ANAGLYPH","ANAGLYPH"===a?1:0);X(c);return c};a.QM=function(){var a=k("LUMINANCE");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");
X(a);return a};a.EM=function(){var a=k("LUMINANCE");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");X(a);return a};a.RM=function(){var a=k("LUMINANCE_X_BLUR");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");X(a);return a};a.FM=function(){var a=k("POSTPROCESSING");a.Db=!0;a.Ka=!1;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");
X(a);return a};a.GM=function(){var a=k("BLOOM");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");X(a);return a};a.kN=function(){var a=k("VELOCITY");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");X(a);return a};a.CM=function(){var a=k("ANCHOR_VISIBILITY");a.Ka=!0;a.Db=!0;a.Rh=E.Rz;Q(a,"anchors.glslv","anchors.glslf");var c=ba.aD(1);z(a,c);u(a,"ANCHOR_NUM",1);X(a);a.Ml=
new Float32Array([0,0,0]);return a};a.VM=function(){var a=k("PERFORMANCE");a.Ka=!1;a.Db=!0;var c=ba.qc();z(a,c);Q(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");u(a,"POST_EFFECT","POST_EFFECT_X_BLUR");X(a);return a};a.qT=function(a,c){var d=c.length/3;if(d!=a.Ml.length/3){var b=ba.aD(d);z(a,b);u(a,"ANCHOR_NUM",d);X(a)}a.Ml=c};a.QY=function(a){if(!a.A.length)return null;a=a.A[0];return a.X.length?a.X[0]:null};a.fY=ja;a.gY=W;a.f1=Z;a.UW=function(a,c){for(var d=a.A[0].X,
b=0;b<d.length;b++)if(d[b].type==c)return!0;return!1};a.MB=function(a){for(var c=a.fa,d=0;d<c.length;d++){var b=c[d];b.Nh&&za.yN(b.hb)}a.oa.Nh&&E.tM(a.oa);a.rb.Nh&&ra.vM(a.rb);a.Cl&&(c=U.BD(a.Cl))&&c.LB&&U.uM(a.Cl)};a.wP=function(a,c,d,b){for(var m=["MAIN","SHADOW","COLOR_ID"],e=!1,h=0;h<m.length;h++){var f=m[h],q=ja(a,c,f),D=ja(d,b,f);if(q&&D){var e=!0,z=W(d,b,f);"MAIN"==f&&(Z(D,q),z&&Z(z,q));for(f=0;f<D.Sc.length;f++){var I=D.Sc[f];if(-1!==Ja.indexOf(I)){var p=q.Sc.indexOf(I);-1!==p&&(D.fa[f]=q.fa[p],
z&&(I=z.Sc.indexOf(I),-1!==I&&(z.fa[I]=q.fa[p])))}}}}e||la.error("Wrong objects for inheriting material!")};a.eS=function(a,c,d){var b=c[0],m=ja(a,b,"MAIN");if(null===m)la.error('Material "'+b+'" was not found in the object "'+a.name+'".');else if(c=c.join("%join%"),m=Y(m,c),null!==m)for(c=0;c<a.A.length;c++)for(var e=a.A[c].X,h=0;h<e.length;h++){var f=e[h];-1!=f.Cf.indexOf(b)&&f.Nj&&(f.Nj[m]=d)}else la.error('Value node "'+c+'" was not found in the object "'+a.name+'".')};a.dS=function(a,c,d,b,m){var e=
c[0],h=c.join("%join%");c=ia(ja(a,e,"MAIN"),h);if(null!=c)for(h=0;h<a.A.length;h++)for(var f=a.A[h].X,q=0;q<f.length;q++){var D=f[q];-1!=D.Cf.indexOf(e)&&D.qe&&(D.qe[3*c]=d,D.qe[3*c+1]=b,D.qe[3*c+2]=m)}else la.error('RGB node "'+h+'" was not found in the object "'+a.name+'".')};a.gZ=function(a,c){var d=c.join("%join%"),b=ja(a,c[0],"MAIN"),m=Y(b,d);if(null!=m)return b.Nj[m];la.error('Value node "'+d+'" was not found in the object "'+a.name+'".');return null};a.fZ=function(a,c,d){var b=c.join("%join%");
c=ja(a,c[0],"MAIN");var m=ia(c,b);if(null!=m)return d[0]=c.qe[3*m],d[1]=c.qe[3*m+1],d[2]=c.qe[3*m+2],d;la.error('RGB node "'+b+'" was not found in the object "'+a.name+'".');return null};a.ha=function(){La={}}};b4w.module.__extensions=function(a,n){function k(a){if(a in B)return B[a];var b=g.getExtension(a)||null;B[a]=b;e.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}var b=n("__config"),e=n("__print"),y=b.v,g=null,B={};a.xe=function(a){g=a};a.ID=function(){return k("WEBGL_compressed_texture_s3tc")||k("WEBKIT_WEBGL_compressed_texture_s3tc")||k("MOZ_WEBGL_compressed_texture_s3tc")};a.NO=function(){return y.ld?{}:k("WEBGL_depth_texture")||k("WEBKIT_WEBGL_depth_texture")||k("MOZ_WEBGL_depth_texture")};
a.HO=function(){return k("EXT_texture_filter_anisotropic")||k("WEBKIT_EXT_texture_filter_anisotropic")||k("MOZ_EXT_texture_filter_anisotropic")};a.zw=function(){return k("WEBGL_debug_shaders")};a.GD=function(){return k("WEBGL_debug_renderer_info")};a.pD=function(){return y.ld?{}:k("OES_element_index_uint")};a.QD=function(){return y.ld?null:k("OES_standard_derivatives")};a.Bw=function(){return k("EXT_disjoint_timer_query")};a.ha=function(){B={}}};b4w.module.__geometry=function(a,n){function k(a,c){for(var d=1;d<a.Oa.length;d++){for(var b=a.Oa[d].pd,e=b.a_position,h=b.a_normal,f=c.a_position,q=c.a_normal,z=e.length,p=a.Oa[d].qr,g=0;g<z;g++)f[g]+=p*e[g],q[g]+=p*h[g];b=b.a_tangent;e=c.a_tangent;h=b.length;for(g=0;g<h;g++)e[g]+=p*b[g]}}function b(a){return 65536<a.wa?h.pD()?!1:!0:!1}function e(a){return 0<a.ab.length?!0:!1}function y(a,c,d){if(!e(a))return a;d||v.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.wa*(c||
1)+", will use drawArrays","color: #aa0");c=a.ab;d=a.wa;var b=a.ba,h=a.N,f;for(f in b){var q=b[f],z=L(q,d);b[f]=g(c,q,z)}for(b=0;b<h.length;b++){var p=h[b];for(f in p)q=p[f],z=L(q,d),p[f]=g(c,q,z)}for(b=0;b<a.Oa.length;b++){f=a.Oa[b].pd;for(var u in f)q=f[u],z=L(q,d),f[u]=g(c,q,z)}a.wa=c.length;a.ab=new Uint16Array(0);return a}function g(a,c,d){if(0==c.length)return new Float32Array(0);for(var b=new Float32Array(a.length*d),e=0;e<a.length;e++)for(var h=a[e],f=0;f<d;f++)b[d*e+f]=c[d*h+f];return b}
function B(a,d){var b=a.sd,e=a.ed[d];if(e)return b.subarray(e.offset,e.offset+e.length);c.l("extract_array() failed; invalid name: "+d)}function w(d,b){var m,e;switch(b){case a.Am:case a.sp:m=q.TRIANGLES;e=q.STATIC_DRAW;break;case a.Rz:m=q.POINTS;e=q.STATIC_DRAW;break;case a.rp:m=q.TRIANGLES;e=q.DYNAMIC_DRAW;break;case a.JI:m=q.POINTS;e=q.DYNAMIC_DRAW;break;case a.KI:m=q.LINES;e=q.STATIC_DRAW;break;default:c.l("Wrong draw_mode")}d.mode=m;d.bp=e}function t(a){a.yj?(a.Zg||(a.Zg=q.createBuffer()),q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,
a.Zg),q.bufferData(q.ELEMENT_ARRAY_BUFFER,a.yj,a.bp),a.Dq=a.yj.byteLength):a.Dq=0;a.Fi||(a.Fi=q.createBuffer());q.bindBuffer(q.ARRAY_BUFFER,a.Fi);q.bufferData(q.ARRAY_BUFFER,a.sd,a.bp);a.tC=a.sd.byteLength}function f(a){for(var b=a[0],m=c.Bc("JOIN_"+a.length+"_SUBMESHES"),e=0,h=0;h<a.length;h++)e+=a[h].ab.length;m.ab=new Uint32Array(e);var f=e=0,q=0;if(0<a[0].Oa.length)for(var p=0;p<a[0].Oa.length;p++){for(h=0;h<a.length;h++)e+=a[h].Oa[p].pd.a_position.length,f+=a[h].Oa[p].pd.a_normal.length,q+=a[h].Oa[p].pd.a_tangent.length;
h={a_position:new Float32Array(e),a_normal:new Float32Array(f),a_tangent:new Float32Array(q)};m.Oa.push({qr:a[0].Oa[p].qr,pd:h})}for(h=e=0;h<a.length;h++)e+=a[h].wa;m.wa=e;var f=a[0],g;for(g in f.ba){for(h=e=0;h<a.length;h++)e+=a[h].ba[g].length;m.ba[g]=new Float32Array(e)}for(g in f.N[0]){for(h=e=0;h<a.length;h++)e+=a[h].N[0][g].length;for(h=0;h<f.N.length;h++)m.N[h]=m.N[h]||{},m.N[h][g]=new Float32Array(e)}h=m.kd;h.I=c.ia(b.kd.I);h.na=c.ia(b.kd.na);h.R=c.ia(b.kd.R);h.Ga=c.ia(b.kd.Ga);f=e=0;q=[];
for(b=0;b<a.length;b++){var p=a[b],v=p.ab,u=p.wa,l=p.ba;d.Kn(p.kd.I,z);d.Jn(h.I,p.kd.I);for(g=0;g<z.length;g++)q.push(z[g]);for(g=0;g<v.length;g++)m.ab[e+g]=v[g]+f;var e=e+v.length,k;for(k in l){var v=l[k],G=f*L(v,u);m.ba[k].set(v,G)}for(g=0;g<p.N.length;g++){var l=p.N[g],r=m.N[g];for(k in l)v=l[k],G=f*L(v,u),r[k].set(v,G)}f+=u}m.kd.na=d.wq(q,!0);if(0<m.Oa.length)for(b=0;b<m.Oa.length;b++)for(k=m.Oa[b].pd,g=f=e=h=0;g<a.length;g++)q=a[g].Oa[b].pd,k.a_position.set(q.a_position,h),k.a_normal.set(q.a_normal,
e),k.a_tangent.set(q.a_tangent,f),h+=q.a_position.length,e+=q.a_normal.length,f+=q.a_tangent.length;return m}function r(a,b,m,e,h,f){var q=a.submeshes[b],z=q.base_length,p=a.materials[b],g=c.Bc("SUBMESH_"+a.name+"_"+p.name);g.wa=z;var u=!1;if(A(m,"a_texcoord")){var k=null,G=a.materials[b];b=a.submeshes[b];if(G.texture_slots.length)switch(G=G.texture_slots[0],G.texture_coords){case "UV":G=a.uv_textures.indexOf(G.uv_layer);0==G?k=new Float32Array(b.texcoord):1==G&&(k=new Float32Array(b.texcoord2));
break;case "ORCO":for(var r=a.b4w_bounding_box_source,k=new Float32Array(2*b.base_length),G=(r.max_x+r.min_x)/2,t=(r.max_z+r.min_z)/2,n=r.max_x-r.min_x,r=r.max_z-r.min_z,E=0,N=0;N<b.position.length;N+=3)k[E++]=(b.position[N]-G)/n+.5,k[E++]=(t-b.position[N+2])/r+.5}null===k&&(k=new Float32Array(2*b.base_length));b=k}else b=new Float32Array(0);if(A(m,"a_orco_tex_coord")){k=a.b4w_bounding_box_source;G=new Float32Array(3*q.base_length);t=k.max_x-k.min_x;n=k.max_y-k.min_y;r=k.max_z-k.min_z;for(N=E=0;N<
q.position.length;N+=3)0==t?G[E++]=.5:G[E++]=c.S(parseFloat(((q.position[N]-k.min_x)/t).toFixed(5)),0,1),0==r?G[E++]=.5:G[E++]=c.S(parseFloat(((k.max_z-q.position[N+2])/r).toFixed(5)),0,1),0==n?G[E++]=.5:G[E++]=c.S(parseFloat(((q.position[N+1]-k.min_y)/n).toFixed(5)),0,1);k=G}else k=new Float32Array(0);var U,G=q.group;if(A(m,"a_influence")&&e){t=new Float32Array(4*z);n=G.length/z;r=new Float32Array(n);for(E=0;E<n;E++)for(U in r[E]=-1,e)if(N=e[U],N.oI===E){r[E]=N.Uv;break}var w=3<n?n:4;e=new Float32Array(w);
U=new Uint32Array(w);for(var E=new Float32Array(4),N=new Float32Array(w),w=new Uint32Array(w),P=new Float32Array(4),B=0;B<z;B++)e.set(N),U.set(w),E.set(P),t.set(x(G,n,B,z,r,e,U,E),4*B)}else t=new Float32Array(0);U=t;e=h?c.ia(h):{};e.a_color={tj:!0};e.a_color.src=A(m,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,$e:7}]:[];h={a_texcoord:b,a_influence:U,a_orco_tex_coord:k};U=q.vertex_colors;b=q.color;k=a.name;G=[];for(t=0;t<U.length;t++)G.push(U[t].name);for(var H in e)if(t=e[H].src,t.length){for(r=
n=0;r<t.length;r++)n+=c.Zj(t[r].$e);h[H]=new Float32Array(n*z);for(r=E=0;r<t.length;r++){var ca=t[r].name,N=t[r].$e,w=c.pG(N),K=G.indexOf(ca);-1==K&&c.l('vertex color "'+ca+'" for mesh "'+k+'" not found.');P=U[K].mask;B=c.Zj(P);(N&P)!==N&&v.error("Wrong color extraction from "+ca+" to "+H+".");for(var L=ca=0;L<K;L++)ca+=c.Zj(U[L].mask);K=ca*z;for(ca=0;ca<z;ca++)for(L=0;3>L;L++)w[L]&&(h[H][ca*n+(E+c.Lo(N,L))]=b[K+ca*B+c.Lo(P,L)]);E+=B}}else h[H]=new Float32Array(0);H=a.uv_textures;e=q.texcoord;U=q.texcoord2;
if(f)for(var F in f){b=H.indexOf(F);if(0==b)var J=new Float32Array(e);else 1==b&&(J=new Float32Array(U));h[f[F]]=J}g.ba=h;g.ab=new Uint32Array(q.indices);f=q.position.length/z/3;J=(F=A(m,"a_normal")&&q.normal.length?!0:!1)&&A(m,"a_tangent")&&q.tangent.length?!0:!1;H=p.texture_slots[0];H=F&&p.texture_slots.length&&A(m,"a_tangent")&&"ORCO"==H.texture_coords&&H.use_map_normal?!0:!1;0<a.b4w_shape_keys.length&&(u=!0);for(h=0;h<f;h++){p=l(q,m,z,F,J,H,h,a.name);if(u)if(e={},e.name=a.b4w_shape_keys[h].name,
g.Oa.push(e),0!=h){e.pd=p;e.qr=a.b4w_shape_keys[h].value;continue}else e.pd=l(q,m,z,F,J,H,h,a.name),e.qr=1;g.N.push(p)}if(1<f&&!u){a=g.N[0];var p={},M;for(M in a)p[M]=new Float32Array(a[M]);g.N.push(p)}A(m,"a_polyindex")&&(y(g,1,!0),g.ba.a_polyindex=C(g));m=q.boundings;q=m.bounding_ellipsoid_axes;m={R:{max_x:m.bounding_box.max_x,max_y:m.bounding_box.max_y,max_z:m.bounding_box.max_z,min_x:m.bounding_box.min_x,min_y:m.bounding_box.min_y,min_z:m.bounding_box.min_z},Ga:d.nn([q[0],0,0],[0,q[1],0],[0,0,
q[2]],m.bounding_ellipsoid_center,[0,0,0,1]),I:null,na:null};g.kd=m;return g}function l(a,d,b,e,h,f,q,z){var g={},u=new Float32Array(3*b),l=new Float32Array(e?3*b:0),k=new Float32Array(h||f?4*b:0),r=q*b*3;u.set(a.position.subarray(r,r+3*b),0);e&&(r=q*b*3,l.set(a.normal.subarray(r,r+3*b),0));if(h)r=q*b*4,k.set(a.tangent.subarray(r,r+4*b),0);else if(f)for(a=k,v.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+z+'". Please add a UV-map.'),z=0;z<b;z++)d=
N,e=G,d[0]=l[3*z],d[1]=l[3*z+1],d[2]=l[3*z+2],p.cross(d,c.lf,e),0==p.length(e)&&p.cross(d,c.Ke,e),p.normalize(e,e),a[4*z]=e[0],a[4*z+1]=e[1],a[4*z+2]=e[2],a[4*z+3]=1;else if(e&&A(d,"a_tangent"))for(k=new Float32Array(4*b),b=0;b<k.length;b++)k[b]=1;g.a_position=u;g.a_normal=l;g.a_tangent=k;return g}function A(a,c){return-1<a.indexOf(c)?!0:!1}function x(c,d,b,e,h,f,q,z){for(var g=!0,p=0;p<d;p++){var v=c[p*e+b];if(-1!==v){var u=h[p];-1!==u&&(f[p]=v,q[p]=u,g=!1)}}if(g)return z;M(f,q,a.Du,!1);for(p=c=
0;4>p;p++)c+=f[p];if(.01>c)return z;for(p=0;4>p;p++)f[p]/=c;if(.01>Math.abs(f[0]-1))z[0]=q[0]+1;else for(p=0;4>p;p++)z[p]=q[p]+f[p];return z}function L(a,d){if(0==d)return 0;var b=a.length,e=b/d;e!=Math.floor(e)&&c.l("Array size mismatch during geometry calculation: array length="+b+", base length="+d);return e}function M(c,d,b,e){for(var h=c.length,f=h,q=!1,z=e?-1:1;1<f||q;){1<f&&(f=Math.floor(f/1.247330950103979));for(var q=!1,p=0;f+p<h;p++)if(b==a.Du?0>z*(c[p]-c[p+f]):c[p]<c[p+f]&&e)q=c[p],c[p]=
c[p+f],c[p+f]=q,q=d[p],d[p]=d[p+f],d[p+f]=q,q=!0}}function F(a,c,d){var b=[],e=[];p.subtract(c,a,b);p.subtract(d,a,e);p.normalize(b,b);p.normalize(e,e);return Math.acos(p.dot(b,e))}function J(a,c,d){c||(c=[]);d=d?a.N[0].a_normal:a.N[0].a_position;if(e(a)){a=a.ab;for(var b=a.length/3,h=0;h<b;h++){var f=new Float32Array(9),q=a[3*h];f[0]=d[3*q];f[1]=d[3*q+1];f[2]=d[3*q+2];q=a[3*h+1];f[3]=d[3*q];f[4]=d[3*q+1];f[5]=d[3*q+2];q=a[3*h+2];f[6]=d[3*q];f[7]=d[3*q+1];f[8]=d[3*q+2];c[h]=f}}else for(h=0;h<d.length;h++)f=
new Float32Array(9),f[0]=d[9*h],f[1]=d[9*h+1],f[2]=d[9*h+2],f[3]=d[9*h+3],f[4]=d[9*h+4],f[5]=d[9*h+5],f[6]=d[9*h+6],f[7]=d[9*h+7],f[8]=d[9*h+8],c[h]=f;return c}function C(a){for(var c=new Float32Array(a.wa),d=0;d<a.wa;d++)c[d]=d%3;return c}function H(a,c,d){var b=p.dist(a,c);a=p.dist(a,d);c=p.dist(c,d);d=(b+a+c)/2;return d*(d-b)*(d-a)*(d-c)}function K(a,c,d,b,e){d-=c;for(var h=0;h<d;h+=b)h%b==e&&vec3.normalize(a.subarray(h+c-e,h+c+1),a.subarray(h+c-e,h+c+1))}var d=n("__boundings"),h=n("__extensions"),
v=n("__print"),P=n("__tsr"),c=n("__util"),p=n("__vec3"),N=new Float32Array(3),G=new Float32Array(3),u=new Float32Array(3),z=new Float32Array(24);a.sp=10;a.Rz=20;a.rp=30;a.JI=40;a.KI=50;a.Du=0;a.nK=1;a.Am=a.sp;var q=null;a.xe=function(a){q=a};a.zX=function(a){var c=_buffers[a];q.deleteBuffer(c.Zg);q.deleteBuffer(c.Fi);delete _buffers[a]};a.XS=function(a,c,m,h){b(a)&&y(a);var f=a.ab,z=a.wa,p=a.N,g={},v;for(v in a.ba)v in h&&!h[v].tj||(g[v]=a.ba[v]);h={yj:null,sd:null,Qw:0,count:0,ed:{},mode:0,bp:0,
Dq:0,tC:0,Fi:null,Zg:null,or:null,Oa:null,Nh:!0};0<a.Oa.length&&k(a,p[0]);if(f.length)if(v=f.length,65536>=z)var u=new Uint16Array(f),l=q.UNSIGNED_SHORT;else u=new Uint32Array(f),l=q.UNSIGNED_INT;else v=z,u=null;var G=0,r=p.length,A;for(A in p[0])var x=p[0][A],G=G+x.length*r;for(A in g)x=g[A],G+=x.length;A=new Float32Array(G);var G=0,r={},n;for(n in g){var E=g[n];if(x=E.length)A.set(E,G),r[n]={HW:n,ih:L(E,z),offset:G,frames:1,length:x},G+=x}g=p.length;for(n in p[0])if(E=p[0][n],x=E.length,E=L(E,z),
x){r[n]={ih:E,offset:G,frames:g,length:x};1<g&&(r[n+"_next"]={ih:E,offset:G+x,frames:g,length:x});for(var N=0;N<g;N++)E=p[N][n],A.set(E,G),G+=x}h.count=v;h.yj=u;h.sd=A;h.Qw=l;h.ed=r;w(h,m);t(h);c&&e(a)&&(h.or={zQ:new Float32Array(f.length),AQ:new Float32Array(f.length),EN:new Float32Array(f.length/3),GI:new Float32Array(3),xL:d.KL(a.kd.R)});h.Oa=a.Oa;return h};a.VS=k;a.JP=b;a.IP=e;a.Vs=y;a.BT=function(a,c,d){w(a,c);a.count=d.length;a.yj=d;a.Qw=d instanceof Uint16Array?q.UNSIGNED_SHORT:q.UNSIGNED_INT};
a.AT=function(a,d){var b=a.sd,e=a.ed,h=e.a_p_data;h?(3!=h.ih&&c.l('invalid num_comp for "a_p_data"'),b.set(d,h.offset)):(b=b.length,h=new Float32Array(b+d.length),h.set(a.sd),h.set(d,b),a.sd=h,e.a_p_data={ih:3,offset:b});t(a)};a.WX=B;a.U_=function(a){a.bp=q.STATIC_DRAW};a.rQ=function(a){a.bp=q.DYNAMIC_DRAW};a.YH=t;a.tM=function(a){a.Zg&&q.deleteBuffer(a.Zg);a.Fi&&q.deleteBuffer(a.Fi)};a.mE=function(a,c){return a.submeshes[c].base_length?!1:!0};a.Vy=function(a,c){for(var d=0;d<a.N.length;d++){var b=
a.N[d].a_position;P.pm(b,c,b,0);b=a.N[d].a_normal;0<b.length&&P.QH(b,c,b,0);b=a.N[d].a_tangent;0<b.length&&P.RH(b,c,b,0)}(d=a.ba.au_center_pos)&&d.length&&P.pm(d,c,d,0);return a};a.US=function(a,d){var b=a.ba.au_center_pos;if(b&&b.length){var e=new Float32Array(b);P.pm(e,d,e,0);for(var h=0;h<a.N.length;h++)for(var f=0;f<e.length;f++)a.N[h].a_position[f]+=e[f]-b[f];b.set(e)}else c.l('Attribute "au_center_pos" is missing in particle submesh')};a.TS=function(a,c){var d=a.wa,b;for(b in c){var e=c[b].length;
a.ba[b]=new Float32Array(e*d);for(var h=0;h<d;h++)for(var f=0;f<e;f++)a.ba[b][h*e+f]=c[b][f]}};a.WS=f;a.qQ=function(a,b,e,f){if(!a.wa)return c.Bc("EMPTY");var q=e.length;65536<a.wa*q&&!h.pD()&&y(a,q);var p=a.ab,g=a.wa,v=a.ba,u=a.N,l;for(l in b){var k=b[l].length,G=k*g;v[l]=new Float32Array(G);for(var r=0;r<g;r++)for(G=0;G<k;G++)v[l][r*k+G]=b[l][G]}b=c.Bc("CLONE_"+q+"_SUBMESHES");b.wa=g*q;b.ab=new Uint32Array(p.length*q);l=b.kd;k=d.bc();d.Ki();for(var A=[],r=0;r<q;r++)for(k=p.length*r,l=g*r,G=0;G<
p.length;G++)b.ab[k+G]=p[G]+l;for(var x in v)for(p=v[x],G=p.length*q,k=L(p,g),b.ba[x]=new Float32Array(G),r=0;r<q;r++)l=g*k*r,b.ba[x].set(p,l);for(x in u[0])for(r=0;r<u.length;r++)for(p=u[r][x],G=p.length*q,k=L(p,g),b.N[r]=b.N[r]||{},b.N[r][x]=new Float32Array(G),G=0;G<q;G++)switch(v=e[G],l=g*k*G,x){case "a_position":P.pm(p,v,b.N[r][x],l);break;case "a_normal":P.QH(p,v,b.N[r][x],l);break;case "a_tangent":P.RH(p,v,b.N[r][x],l);break;default:c.l("Wrong attribute name: "+x)}l=b.kd;k=d.bc();A=[];for(r=
0;r<q;r++)for(k=d.Gg(a.kd.R,e[r],k),d.Jn(l.R,k),k=d.Gg(k,f.g.i,k),d.Jn(l.I,k),d.Kn(k,z),G=0;G<z.length;G++)A.push(z[G]);l.na=d.wq(A,!0);l.Ga=d.gv(l.na,f.g.i);return b};a.FC=r;a.YN=function(a){var d=a.wa,b=a.N[0].a_position,e=new Float32Array(12*d),h=new Float32Array(8*d);a=new Uint32Array(4*a.ab.length);for(var f=new Float32Array(4*d),q=0;q<d;q++){e[12*q]=b[3*q];e[12*q+1]=b[3*q+1];e[12*q+2]=b[3*q+2];e[12*q+3]=b[3*q];e[12*q+4]=b[3*q+1];e[12*q+5]=b[3*q+2];e[12*q+6]=b[3*q];e[12*q+7]=b[3*q+1];e[12*q+
8]=b[3*q+2];e[12*q+9]=b[3*q];e[12*q+10]=b[3*q+1];e[12*q+11]=b[3*q+2];h[8*q]=-.5;h[8*q+1]=-.5;h[8*q+2]=-.5;h[8*q+3]=.5;h[8*q+4]=.5;h[8*q+5]=.5;h[8*q+6]=.5;h[8*q+7]=-.5;a[6*q]=4*q+2;a[6*q+1]=4*q+1;a[6*q+2]=4*q;a[6*q+3]=4*q+2;a[6*q+4]=4*q;a[6*q+5]=4*q+3;var z=Math.random();f[4*q]=z;f[4*q+1]=z;f[4*q+2]=z;f[4*q+3]=z}b=c.Bc("HALO");b.N=[];b.N[0]={};b.wa=4*d;b.N[0].a_position=e;b.ba.a_halo_bb_vertex=h;b.ba.a_random_vals=f;b.ab=a;return b};a.lP=A;a.GC=function(a,b,e,h){for(var q=[],z=0;z<a.submeshes.length;z++){var p=
r(a,z,b,null,e,null);if(p.wa){var g=p.kd;h&&(g.I=d.Gg(g.R,h.i),g.na=d.Gk(g.Ga,h.i));q.push(p)}}return 0==q.length?c.Bc("EMPTY"):1==q.length?q[0]:f(q)};a.zT=function(a,c,d){for(var b=a.yj,e=B(a,"a_position"),h=a.or,f=h.zQ,z=h.AQ,h=h.EN,p=b,g=p.length/3,v=0;v<g;v++){var l=p[3*v],u=p[3*v+1],k=p[3*v+2],G=e[3*l+1],r=e[3*l+2],A=e[3*u+1],x=e[3*u+2],U=e[3*k+1],t=e[3*k+2];f[3*v]=(e[3*l]+e[3*u]+e[3*k])/3;f[3*v+1]=(G+A+U)/3;f[3*v+2]=(r+x+t)/3}P.pm(f,c,z);c=z.length/3;for(e=0;e<c;e++)f=z[3*e]-d[0],p=z[3*e+1]-
d[1],g=z[3*e+2]-d[2],h[e]=f*f+p*p+g*g;d=b;b=h.length;if(!(2>b))for(z=b,e=!1;1<z||e;)for(1<z&&(z=Math.floor(z/1.247330950103979)),e=!1,c=0;z+c<b;c++)0>h[c]-h[c+z]&&(e=h[c],h[c]=h[c+z],h[c+z]=e,e=d,f=c,p=c+z,g=e[3*f],v=e[3*f+1],l=e[3*f+2],e[3*f]=e[3*p],e[3*f+1]=e[3*p+1],e[3*f+2]=e[3*p+2],e[3*p]=g,e[3*p+1]=v,e[3*p+2]=l,e=!0);b=d;q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,a.Zg);q.bufferData(q.ELEMENT_ARRAY_BUFFER,b,q.DYNAMIC_DRAW)};a.gH=M;a.LL=function(a,c,d){for(var b=c.length/3,e=a.length/3,h=[],f=Array(3),
q=Array(3),z=Array(3),g=0;g<e;g++){for(var v=a[3*g],l=a[3*g+1],u=a[3*g+2],k=0;3>k;k++)f[k]=c[3*v+k],q[k]=c[3*l+k],z[k]=c[3*u+k];if(d)var k=F(f,q,z),G=F(q,z,f),r=Math.PI-k-G;else r=G=k=1;var A=h,x;x=f;var U=z,t=[],n=[],N=[];p.subtract(q,x,t);p.subtract(U,x,n);p.cross(t,n,N);p.normalize(N,N);x=N;for(U=0;3>U;U++)t=3*l+U,n=3*u+U,A[3*v+U]=k*x[U],A[t]=G*x[U],A[n]=r*x[U]}if(d)for(var w in d)for(g=d[w],a=0;3>a;a++){c=3*g[0]+a;for(e=1;e<g.length;e++)f=3*g[e]+a,h[c]+=h[f];for(e=1;e<g.length;e++)f=3*g[e]+a,
h[f]=h[c]}for(g=0;g<b;g++){d=g;w=h;a=new Float32Array(3);for(c=0;3>c;c++)e=3*d+c,a[c]=w[e];p.normalize(a,a);for(c=0;3>c;c++)e=3*d+c,w[e]=a[c]}return h};a.NL=function(a,c,d){for(var b={},e=c.length/3,h=0;h<e;h++){var f=String(c[3*h])+String(c[3*h+1])+String(c[3*h+2]);b[f]=[]}e=a.length;for(h=0;h<e;h++)c=a[h],f=String(d[3*c])+String(d[3*c+1])+String(d[3*c+2]),f in b&&b[f].push(c);return b};a.tw=function(a,d,b,e){var h=J(a,null,!1);if(b)var f=J(a,null,!0);var q=h.length,z=new Float32Array(q),p=N,g=G;
for(a=0;a<q;a++){var v=h[a];p.set(v.subarray(0,3));g.set(v.subarray(3,6));u.set(v.subarray(6));z[a]=Math.sqrt(H(p,g,u))}p=new Float32Array(q);p[0]=z[0];for(a=1;a<q;a++)p[a]=p[a-1]+z[a];q=p[z.length-1];z=[];for(a=0;a<d;a++){var g=q*c.ef(e),g=c.fq(p,g,0,p.length-1),v=b?f[g]:h[g],g=a,l=v,k=e,v=void 0,v=new Float32Array(3),r=l[0],A=l[1],x=l[2],t=l[3],n=l[4],U=l[5],w=l[6],P=l[7],B=l[8],l=c.ef(k),k=c.ef(k);1<l+k&&(l=1-l,k=1-k);var K=1-l-k,A=K*A+l*n+k*P,x=K*x+l*U+k*B;v[0]=K*r+l*t+k*w;v[1]=A;v[2]=x;z[g]=
v}return z};a.XX=J;a.Oq=C;a.s2=H;a.tG=function(a,c,d){a=a.N[0].a_position;for(var b=0;b<a.length;b+=3)a[b]=(a[b]-d[0])*c[0]+d[0],a[b+1]=(a[b+1]-d[1])*c[1]+d[1],a[b+2]=(a[b+2]-d[2])*c[2]+d[2]};a.gL=function(a,c,d){var b=a.A[0].X;a=a.g.si;for(var e=1;e<a.length;e++)a[e].name==c&&(a[e].value=d);for(e=0;e<b.length;e++)if(!b[e].dg&&b[e].Pf&&!b[e].hj){d=b[e].oa.ed;c=b[e].oa.sd;q.bindBuffer(q.ARRAY_BUFFER,b[e].oa.Fi);var h=d.a_position,f=b[e],z=c,p=a;if(h){for(var g=h.offset,h=h.length+g,v=f.oa.Oa[0].pd.a_position,
l=g;l<h;l++)z[l]=v[l-g];for(l=1;l<f.oa.Oa.length;l++){var v=f.oa.Oa[l].pd.a_position,u=p[l].value;if(u)for(var k=g;k<h;k++)z[k]+=u*v[k-g]}q.bufferSubData(q.ARRAY_BUFFER,4*g,z.subarray(g))}h=d.a_normal;f=b[e];z=c;p=a;if(h){g=h.offset;h=h.length+g;v=f.oa.Oa[0].pd.a_normal;for(l=g;l<h;l++)z[l]=v[l-g];for(l=1;l<f.oa.Oa.length;l++)if(v=f.oa.Oa[l].pd.a_normal,u=p[l].value)for(k=g;k<h;k++)z[k]+=u*v[k-g];K(z,g,h,3,2);q.bufferSubData(q.ARRAY_BUFFER,4*g,z.subarray(g))}p=d.a_tangent;d=b[e];f=a;if(p){z=p.offset;
p=p.length+z;h=d.oa.Oa[0].pd.a_tangent;for(g=z;g<p;g++)c[g]=h[g-z];for(g=1;g<d.oa.Oa.length;g++)if(h=d.oa.Oa[g].pd.a_tangent,l=f[g].value)for(v=z;v<p;v++)c[v]+=l*h[v-z];K(c,z,p,4,3);q.bufferSubData(q.ARRAY_BUFFER,4*z,c.subarray(z))}}};a.mM=function(a){return a.g.Pf};a.CZ=function(a){var c=[];if(a.g)for(var d=1;d<a.g.si.length;d++)c.push(a.g.si[d].name);return c};a.BZ=function(a,c){if(a.g)for(var d=1;d<a.g.si.length;d++)if(c==a.g.si[d].name)return a.g.si[d].value;return 0};a.oP=function(a,c){var d=
a.g.si;if(d)for(var b=1;b<d.length;b++)if(d[b].name==c)return!0;return!1};a.XZ=function(a){return a&&a.g&&a.g.$f?!0:!1};a.GX=function(c,d,b){var e=c.oa;if(e){for(var h=b?d.length/3/2:d.length/3-1,f=new Float32Array(12*h),q=new Float32Array(12*h),z=new Uint16Array(6*h),p=0;p<h;p++){if(b)var g=6*p,v=6*p+3;else g=3*p,v=3*(p+1);var l=d[g],u=d[g+1],g=d[g+2],k=d[v],G=d[v+1],v=d[v+2],r=k-l,A=G-u,x=v-g;f[12*p]=l;f[12*p+1]=u;f[12*p+2]=g;q[12*p]=r;q[12*p+1]=A;q[12*p+2]=x;f[12*p+3]=k;f[12*p+4]=G;f[12*p+5]=v;
q[12*p+3]=-r;q[12*p+4]=-A;q[12*p+5]=-x;f[12*p+6]=l;f[12*p+7]=u;f[12*p+8]=g;q[12*p+6]=-r;q[12*p+7]=-A;q[12*p+8]=-x;f[12*p+9]=k;f[12*p+10]=G;f[12*p+11]=v;q[12*p+9]=r;q[12*p+10]=A;q[12*p+11]=x;z[6*p]=4*p;z[6*p+1]=4*p+1;z[6*p+2]=4*p+2;z[6*p+3]=4*p;z[6*p+4]=4*p+3;z[6*p+5]=4*p+1}b=0;for(var U in e.ed)d=e.ed[U],b+=f.length/3*d.ih;e.sd=new Float32Array(b);b=e.sd;a.BT(e,c.Rh,z);c=0;for(U in e.ed)switch(d=e.ed[U],U){case "a_position":b.set(f,c);d.offset=c;d.length=f.length;c+=d.length;break;case "a_direction":b.set(q,
c);d.offset=c;d.length=q.length;c+=d.length;break;default:d.offset=c,d.length=f.length/3*d.ih,z=new Float32Array(d.length),b.set(z,c),c+=d.length}t(e)}}};b4w.module.__graph=function(a,n){function k(a,c,d){d||(d=null);b(a,c)?G.l("Graph already has node with given ID"):a.K.push(c,d)}function b(a,c){for(var d=a.K,b=0;b<d.length;b+=2)if(d[b]==c)return!0;return!1}function e(a,c,d,e){e||(e=null);b(a,c)&&b(a,d)?a.Aa.push(c,d,e):G.l("Wrong node IDs")}function y(a,c){b(a,c)||G.l("Node not found");for(var d=a.K,e=0;e<d.length;e+=2)d[e]==c&&(d.splice(e,2),e-=2)}function g(a,c,d,b){P(a,c,d)||G.l("Edge not found");a=a.Aa;for(var e=0,h=0;h<a.length;h+=3)if(a[h]==
c&&a[h+1]==d){if(-1==b)a.splice(h,3);else{if(b==e){a.splice(h,3);break}e++}h-=3}}function B(a){a=a.K;for(var c=-1,d=0;d<a.length;d+=2)c=Math.max(c,a[d]);return++c}function w(a,c){for(var d=a.K,b=0;b<d.length;b+=2)if(d[b+1]==c)return d[b];return-1}function t(a){var c=[],b={};f(a,b);for(var e=a.K,h=0;h<e.length;h+=2)0==d(a,e[h])&&r(a,e[h],b,c);return{K:c,Aa:a.Aa.slice(0)}}function f(a,c){for(var d=a.K,b=0;b<d.length;b+=2)c[d[b]]=!1}function r(a,c,d,b){if(!d[c]){d[c]=!0;for(var e=0;e<K(a,c);e++)r(a,
h(a,c,e),d,b);b.unshift(c,H(a,c))}}function l(a,c,b,e){if(!b[c]){b[c]=!0;if(10==e||30==e)for(var m=0;m<K(a,c);m++){var f=h(a,c,m);l(a,f,b,e)}if(20==e||30==e)for(m=0;m<d(a,c);m++)f=v(a,c,m),l(a,f,b,e)}}function A(a){for(var c=a.Aa,d=0;d<c.length;d+=3){var e=c[d+1];b(a,c[d])&&b(a,e)||(c.splice(d,3),d-=3)}}function x(a){for(var c=[],d=a.K,b=0;b<d.length;b+=2){var e=d[b];K(a,e)||c.push(e)}return c}function L(a){var c=a.K;a=a.Aa;for(var d=[],b=[],e=[],h=0;h<c.length;h++)e[c[2*h]]=h,d.push(h,c[2*h+1]);
for(h=0;h<a.length;h+=3)b.push(e[a[h]],e[a[h+1]],a[h+2]);return{K:d,Aa:b}}function M(a,c,b){if(b.Yf==b.fi){for(var e=0,m=0;e<b.fi;e++)-1!=b.Lg[e]&&(a[m]=e,c[m]=b.Lg[e],m++);return!0}if(b.fi>b.Bl||b.xi>b.yi||b.km>b.mm||b.jm>b.lm)return!1;for(var m=e=-1,f=!1;!f&&F(b,u,e,m);)if(e=u[0],m=u[1],J(b,e,m)){var p;p=b;f={};f.Qn=p.Qn;f.Rn=p.Rn;f.Bx=p.Bx;f.Kq=p.Kq;f.fi=p.fi;f.Bl=p.Bl;f.gi=p.gi;f.Yf=f.Tr=p.Yf;f.jm=p.jm;f.km=p.km;f.xi=p.xi;f.lm=p.lm;f.mm=p.mm;f.yi=p.yi;f.Lm=-1;f.Lg=p.Lg;f.fj=p.fj;f.zj=p.zj;f.Aj=
p.Aj;f.Rj=p.Rj;f.Sj=p.Sj;f.Js=p.Js;p.Js[0]+=1;var f=p=f,g=e,l=m,k=f.Qn,G=f.Rn,r=f.fi,A=f.Bl,x=f.Lg,t=f.fj,n=f.zj,N=f.Aj,w=f.Rj,E=f.Sj;C(g<r);C(l<A);C(f.Yf<r);C(f.Yf<A);r=++f.Yf;f.Lm=g;n[g]||(n[g]=r,f.jm++,w[g]&&f.xi++);w[g]||(w[g]=r,f.km++,n[g]&&f.xi++);N[l]||(N[l]=r,f.lm++,E[l]&&f.yi++);E[l]||(E[l]=r,f.mm++,N[l]&&f.yi++);x[g]=l;t[l]=g;for(x=0;x<d(k,g);x++)t=v(k,g,x),n[t]||(n[t]=r,f.jm++,w[t]&&f.xi++);for(x=0;x<K(k,g);x++)t=h(k,g,x),w[t]||(w[t]=r,f.km++,n[t]&&f.xi++);for(x=0;x<d(G,l);x++)t=v(G,l,
x),N[t]||(N[t]=r,f.lm++,E[t]&&f.yi++);for(x=0;x<K(G,l);x++)t=h(G,l,x),E[t]||(E[t]=r,f.mm++,N[t]&&f.yi++);f=M(a,c,p);C(1>=p.Yf-p.Tr);C(-1!=p.Lm);t=p.Qn;g=p.Rn;l=p.Yf;k=p.Lm;G=p.Lg;n=p.fj;r=p.zj;N=p.Aj;A=p.Rj;w=p.Sj;if(p.Tr<l){r[k]==l&&(r[k]=0);for(E=0;E<d(t,k);E++)x=v(t,k,E),r[x]==l&&(r[x]=0);A[k]==l&&(A[k]=0);for(E=0;E<K(t,k);E++)x=h(t,k,E),A[x]==l&&(A[x]=0);t=G[k];N[t]==l&&(N[t]=0);for(E=0;E<d(g,t);E++)x=v(g,t,E),N[x]==l&&(N[x]=0);w[t]==l&&(w[t]=0);for(E=0;E<K(g,t);E++)x=h(g,t,E),w[x]==l&&(w[x]=
0);G[k]=-1;n[t]=-1;p.Yf=p.Tr;p.Lm=-1}}return f}function F(a,c,d,b){-1==d&&(d=0);-1==b?b=0:b++;var e=a.xi,h=a.yi,f=a.km,p=a.mm,g=a.jm,v=a.lm,l=a.Yf,u=a.fi,k=a.Bl,r=a.Lg,G=a.fj,A=a.zj,x=a.Aj,t=a.Rj,n=a.Sj;if(e>l&&h>l)for(;d<u&&(-1!=r[d]||0==t[d]||0==A[d]);)d++,b=0;else if(f>l&&p>l)for(;d<u&&(-1!=r[d]||0==t[d]);)d++,b=0;else if(g>l&&v>l)for(;d<u&&(-1!=r[d]||0==A[d]);)d++,b=0;else if(0==d&&0!=a.gi){for(A=0;A<u&&-1!=r[d=a.gi[A]];)A++;A==u&&(d=u)}else for(;d<u&&-1!=r[d];)d++,b=0;if(e>l&&h>l)for(;b<k&&(-1!=
G[b]||0==n[b]||0==x[b]);)b++;else if(f>l&&p>l)for(;b<k&&(-1!=G[b]||0==n[b]);)b++;else if(g>l&&v>l)for(;b<k&&(-1!=G[b]||0==x[b]);)b++;else for(;b<k&&-1!=G[b];)b++;return d<u&&b<k?(c[0]=d,c[1]=b,!0):!1}function J(a,b,e){var f=a.Qn,m=a.Rn,p=a.Bl,g=a.Lg,l=a.fj,u=a.zj,k=a.Aj,r=a.Rj,G=a.Sj;C(b<a.fi);C(e<p);C(-1==g[b]);C(-1==l[e]);if(!(0,a.Bx)(H(f,b),H(m,e)))return!1;for(var A=p=0,x=0,t=0,n=0,N=0,w=0;w<K(f,b);w++){var E=h(f,b,w);if(-1!=g[E]){var B=g[E];if(!P(m,e,B)||!c(a.Kq,f,b,E,m,e,B))return!1}else u[E]&&
x++,r[E]&&p++,u[E]||r[E]||n++}for(w=0;w<d(f,b);w++)if(E=v(f,b,w),-1!=g[E]){if(B=g[E],!P(m,B,e)||!c(a.Kq,f,E,b,m,B,e))return!1}else u[E]&&x++,r[E]&&p++,u[E]||r[E]||n++;for(w=0;w<K(m,e);w++)if(B=h(m,e,w),-1!=l[B]){if(E=l[B],!P(f,b,E))return!1}else k[B]&&t++,G[B]&&A++,k[B]||G[B]||N++;for(w=0;w<d(m,e);w++)if(B=v(m,e,w),-1!=l[B]){if(E=l[B],!P(f,E,b))return!1}else k[B]&&t++,G[B]&&A++,k[B]||G[B]||N++;return x<=t&&p<=A&&n<=N}function C(a){a||G.l("Assertion failed")}function H(a,c){for(var d=a.K,b=0;b<d.length;b+=
2)if(d[b]==c)return d[b+1];return null}function K(a,c){for(var d=a.Aa,b=0,e=0;e<d.length;e+=3)d[e]==c&&b++;return b}function d(a,c){for(var d=a.Aa,b=0,e=0;e<d.length;e+=3)d[e+1]==c&&b++;return b}function h(a,c,d){a=a.Aa;for(var b=0,e=0;e<a.length;e+=3)if(a[e]==c){if(b==d)return a[e+1];b++}return-1}function v(a,c,d){a=a.Aa;for(var b=0,e=0;e<a.length;e+=3)if(a[e+1]==c){if(b==d)return a[e];b++}return-1}function P(a,c,d){a=a.Aa;for(var b=0;b<a.length;b+=3)if(a[b]==c&&a[b+1]==d)return!0;return!1}function c(a,
c,d,b,e,h,f){for(var g=p(c,d,b),l=p(e,h,f),v=0;v<g;v++){for(var u=!1,k=0;k<l;k++)if(a(N(c,d,b,v),N(e,h,f,k))){u=!0;break}if(!u)return!1}return!0}function p(a,c,d){var b=0;a=a.Aa;for(var e=0;e<a.length;e+=3)a[e]==c&&a[e+1]==d&&b++;return b}function N(a,c,d,b){a=a.Aa;for(var e=0,h=0;h<a.length;h+=3)if(a[h]==c&&a[h+1]==d){if(e==b)return a[h+2];e++}return null}n("__print");var G=n("__util"),u=[-1,-1];a.wu=-1;a.XU=10;a.pp=20;a.bW=30;a.create=function(){for(var a=arguments,c=[],d=[],b=0;b<a.length;b++){var e=
a[b];switch(e.length){case 2:c.push(e[0],e[1]);break;case 3:d.push(e[0],e[1],e[2]);break;default:G.l("Wrong graph constructor params")}}return{K:c,Aa:d}};a.clone=function(a,c,d){if(c)for(var b=Array(a.K.length),e=0;e<a.K.length;e+=2)b[e]=a.K[e],b[e+1]=c(a.K[e+1]);else b=G.ia(a.K);if(d)for(c=Array(a.Aa.length),e=0;e<a.Aa.length;e+=3)c[e]=a.Aa[e],c[e+1]=a.Aa[e+1],c[e+2]=d(a.Aa[e+2]);else c=G.ia(a.Aa);return a={K:b,Aa:c}};a.uX=function(a,c){for(var d=[],b=[],e=0;e<a.length;e++)d.push(a[e][0],a[e][1]);
for(e=0;e<c.length;e++)b.push(c[e][0],c[e][1],c[e][2]);return{K:d,Aa:b}};a.zk=k;a.b_=b;a.Wc=e;a.Jf=y;a.li=g;a.ps=function(a,c,d,b){P(a,c,d)||G.l("Edge not found");a=a.Aa;for(var e=0;e<a.length;e+=3)if(a[e]==c&&a[e+1]==d&&a[e+2][0]==b[0]&&a[e+2][1]==b[1]){a.splice(e,3);break}};a.C=function(a,c){if(-1==w(a,c)){var d=B(a);k(a,d,c);return d}G.l("Non-unique attribute")};a.vR=function(a,c,d,b,e){a=a.Aa;for(var h=0;h<a.length;h+=3)a[h]==c&&a[h+1]==d&&a[h+2]==b&&(a[h+2]=e)};a.YK=function(a,c,d){var b;d=d||
[];b=b||[];for(var h={},f=0;f<a.K.length;f+=2){var p=a.K[f],g=a.K[f+1],v=B(c);k(c,v,g);h[p]=v}for(f=0;f<a.Aa.length;f+=3)g=h[a.Aa[f]],v=h[a.Aa[f+1]],p=a.Aa[f+2],e(c,g,v,p);for(f=0;f<d.length;f+=3)g=h[d[f]],a=d[f+1],p=d[f+2],e(c,g,a,p);for(f=0;f<b.length;f+=3)d=b[f],v=h[b[f+1]],p=b[f+2],e(c,d,v,p)};a.Sn=B;a.Ff=w;a.m=function(a,c,d,b){c=w(a,c);d=w(a,d);-1!=c&&-1!=d?e(a,c,d,b):G.l("Attributes not found")};a.ma=function(a,c){for(var d=a.K,b=0;b<d.length&&!c(d[b],d[b+1]);b+=2);};a.Of=function(a,c){for(var d=
a.Aa,b=0;b<d.length&&!c(d[b],d[b+1],d[b+2]);b+=3);};a.wg=function(a,c,d){for(var b=a.Aa,e=0;e<b.length;e+=3)if(b[e+1]==c){var h=b[e];if(d(h,H(a,h),b[e+2]))break}};a.Ai=function(a,c,d){for(var b=a.Aa,e=0;e<b.length;e+=3)if(b[e]==c){var h=b[e+1];if(d(h,H(a,h),b[e+2]))break}};a.iz=t;a.iT=function(a){a=t(a).K;for(var c=[],d=0;d<a.length;d+=2)c.push(a[d+1]);return c};a.z_=function(){};a.Us=function(a,c,d){b(a,c)||G.l("No such node");var e={};f(a,e);l(a,c,e,d);c=[];for(var h in e)e[h]&&(h=Number(h),c.push(h,
H(a,h)));a={K:c,Aa:a.Aa.slice(0)};A(a);return a};a.rv=A;a.bP=function(a){for(var c=[],b=a.K,e=0;e<b.length;e+=2){var h=b[e];d(a,h)||c.push(h)}return c};a.Wn=x;a.match=function(a,c,d,b){var e={};e.Qn=L(a);e.Rn=L(c);e.Bx=d||function(a,c){return a==c};e.Kq=b||function(a,c){return a==c};b=a.K.length/2;var h=c.K.length/2;e.fi=b;e.Bl=h;e.gi=0;e.Yf=e.Tr=0;e.xi=e.jm=e.km=0;e.yi=e.lm=e.mm=0;e.Lm=-1;e.Lg=Array(b);e.fj=Array(h);e.zj=Array(b);e.Aj=Array(h);e.Rj=Array(b);e.Sj=Array(h);e.Js=[1];for(d=0;d<b;d++)e.Lg[d]=
-1,e.zj[d]=0,e.Rj[d]=0;for(d=0;d<h;d++)e.fj[d]=-1,e.Aj[d]=0,e.Sj[d]=0;h=Array(b);b=Array(b);if(M(h,b,e)){for(d=0;d<h.length;d++)h[d]=a.K[2*h[d]],b[d]=c.K[2*b[d]];return[h,b]}return null};a.YO=function(a,c){for(var d=a.K,b=1;b<d.length;b+=2)if(d[b]==c)return d[b-1];return null};a.Ra=H;a.mg=K;a.nr=d;a.eg=h;a.vj=v;a.IY=p;a.me=N;a.replace=function(a,c,d){for(var b=a.Aa,e=B(a),h=0;h<c.length;h++){var f=c[h];y(a,f);for(var p=0;p<b.length;p+=3)b[p]==f&&(b[p]=e),b[p+1]==f&&(b[p+1]=e),b[p]==b[p+1]&&(b.splice(p,
3),p-=3)}k(a,e,d)};a.kR=function(a,c,d,b,e){P(a,c,d)||G.l("Edge not found");a=a.Aa;for(var h=0;h<a.length;h+=3)a[h]==c&&a[h+1]==d&&(a[h]=b,a[h+1]=e)};a.RN=function(a,c){function d(a,c){if(-1!=p.indexOf(a)){var b=p.slice(p.indexOf(a));if(-1!=e[b[b.length-1]].indexOf(b[0])){v.push([a,b[b.length-1]]);return}}p.push(a);for(b=0;b<c.length;b++)c[b]in e&&d(c[b],e[c[b]])}c||(c=x(a)[0]);var b=a.Aa;if(b.length&&-1!=b.indexOf(c)){for(var e={},h=0,f=0;f<b.length;f+=3)b[f+1]in e?e[b[f+1]].push(b[f]):e[b[f+1]]=
[b[f]],h++;var p=[],v=[];d(c,e[c]);for(f=0;f<v.length;f++)for(var l=h=0;l<b.length;l+=3)v[f][1]==b[l+1]&&v[f][0]==b[l]&&g(a,b[l],b[l+1],h),h++}};a.sN=function(a,c,d){var b=a.K;a=a.Aa;var e;e="digraph debug {\n    node [shape=box];\n";for(var h=0;h<b.length;h+=2){var f=b[h],p=b[h+1],p=c?c(f,p):String(f);e+="    ";e+=String(f)+' [label="'+p.replace(/\"/g,'\\"')+'"];\n'}for(h=0;h<a.length;h+=3)c=a[h],b=a[h+1],p=a[h+2],e+="    ",e+=String(c)+" -> "+String(b),d&&(e+=' [label="'+d(c,b,p)+'"]'),e+=";\n";
return e+="}"}};b4w.module.__nodemat=function(a,n){function k(a,c,d,e,h){var f=Da.p(),f=g(c,h,f.uuid);if(f in pa)return pa[f];var m={Pa:null,id:f,LB:!0};if("SHADOW"!=h&&"COLOR_ID"!=h){c=S.create();for(var q=a.nodes,z=0;z<q.length;z++)if(null==G(c,q[z],0,e,h))return pa[f]=null,m;if(d&&-1==p(a,c,"GROUP_OUTPUT","group"))return m;z=la(c);q=d?a.links:a.links.slice();if(!da(c,q,z))return m;if(d)return m.Pa=c,m;for(z=0;z<q.length;z++){d=q[z];for(var u=A(d.from_node,c),U=A(d.to_node,c),D=0;D<u.length;D++)for(var I=0;I<U.length;I++){var n=
u[D],N=U[I],E=S.Ra(c,n),P=S.Ra(c,N);if(!ha(c,n,N,E,P,d))return pa[f]=null,m}}l(c);a="GLOW"==h?p(a,c,"B4W_GLOW_OUTPUT","material",!0):p(a,c,"OUTPUT","material",!1,!0);-1==a&&(c=w(),a=0);x(c);a=S.Us(c,a,S.pp);b(a,e);t(a);M(a);v(a);r(a,e,h);ba(a)}else e=k(a,c,d,e,"MAIN"),e=S.clone(e.Pa,function(a){var c=ga.dn(a);c.L=ga.ia(a.L);c.Sa=ga.ia(a.Sa);return c}),a=p(a,e,"OUTPUT","material",!1,!0),B(e,a),a=S.Us(e,a,S.pp),t(a);m.Pa=a;return pa[f]=m}function b(a,c){var d=[];S.ma(a,function(a,c){"MATERIAL"!=c.type&&
"MATERIAL_EXT"!=c.type||d.push({IQ:a,node:c})});for(var b=0;b<d.length;++b){var h=d[b].IQ,f=d[b].node,m=S.Sn(a);S.zk(a,m,f.data.uQ);var q=S.Sn(a);S.zk(a,q,f.data.vQ);S.Wc(a,m,q,[4,2]);for(var p={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},g=S.nr(a,h),z=[],v=[],l=[],u={},k=0;k<g;k++){var r=S.vj(a,h,k);r in u||(u[r]=0);var G=S.me(a,r,h,u[r]++);z.push([r,h,G]);var U=p[G[1]];if(U)switch(U[0]){case "MATERIAL_END":v.push([r,q,[G[0],U[1]]]);
break;case "LIGHTING_APPLY":l.push([r,[G[0],U[1]]])}else v.push([r,m,G])}e(a,f.data.value,m,q,l,c);for(k=0;k<z.length;k++)S.ps(a,z[k][0],z[k][1],z[k][2]);for(k=0;k<v.length;k++)S.Wc(a,v[k][0],v[k][1],v[k][2]);f=S.mg(a,h);m=[];p=[];g={};for(k=0;k<f;k++)z=S.eg(a,h,k),z in g||(g[z]=0),G=S.me(a,h,z,g[z]++),m.push([h,z,G]),p.push([q,z,G]);for(k=0;k<m.length;k++)S.ps(a,m[k][0],m[k][1],m[k][2]);for(k=0;k<p.length;k++)S.Wc(a,p[k][0],p[k][1],p[k][2]);S.Jf(a,h)}}function e(a,c,d,b,e,h){var f={name:"LIGHTING_AMBIENT",
type:"LIGHTING_AMBIENT"},m=G(a,f,0,h,null),q=m;y(a,d,m,"E");y(a,d,m,"A");y(a,d,m,"D");m=Da.p();m=za.Pb(m,"LAMP",za.vc);if(!c.Fe)for(var p,g,z=0;z<m.length;z++){var v=m[z].$b,f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};p=G(a,f,0,h,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};g=G(a,f,0,h,null);y(a,q,g,"color");y(a,q,g,"specular");y(a,p,g,"ldir");y(a,d,g,"normal");y(a,d,g,"D");y(a,d,g,"S");y(a,p,g,"lcolorint");y(a,d,p,"shadow_factor");q="COOKTORR"==c.$l?"SPECULAR_PHONG":"SPECULAR_"+c.$l;f=
{name:q,type:q};f=G(a,f,0,h,null);y(a,p,f,"ldir");y(a,p,f,"lfac");y(a,d,f,"normal");y(a,f,g,"sfactor");"SPECULAR_PHONG"!=q&&"SPECULAR_BLINN"!=q||y(a,p,f,"norm_fac");y(a,d,f,"sp_params");q="HEMI"==v.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+c.yn;f={name:q,type:q};f=G(a,f,0,h,null);y(a,p,f,"ldir");y(a,p,f,"lfac");y(a,d,f,"normal");y(a,p,f,"norm_fac");y(a,f,g,"lfactor");"DIFFUSE_LAMBERT"!=q&&y(a,d,f,"dif_params");for(p=0;p<e.length;p++)S.Wc(a,e[p][0],g,e[p][1]);q=g}y(a,q,b,"color");y(a,q,b,"specular")}function y(a,
c,d,b){for(var e=S.Ra(a,c),h=S.Ra(a,d),f,m=0;m<h.L.length;m++)if(b==h.L[m].identifier){f=m;break}for(var q,m=0;m<e.Sa.length;m++)if(b==e.Sa[m].identifier){q=m;break}void 0!=f&&void 0!=q&&S.Wc(a,c,d,[q,f])}function g(a,c,d){switch(c){case "GLOW":return a+d+"11";case "COLOR_ID":case "SHADOW":return a+d+"00";default:return a+d+"10"}}function B(a,c){S.Of(a,function(d,b,e){var h=S.Ra(a,b);b==c&&"Color"==h.L[e[1]].identifier&&S.ps(a,d,b,e)})}function w(){var a=S.create(),c={data:null,Mb:[],Ea:[],L:[{Ya:new Float32Array([0,
0,0]),identifier:"Color",Yb:!1,name:"Color"},{Ya:1,identifier:"Alpha",Yb:!1,name:"Alpha"}],Sa:[],type:"OUTPUT",Hi:[]};S.zk(a,0,c);return a}function t(a){S.ma(a,function(c,d){for(var b=d.L,e=d.Sa,h=0;h<b.length;h++)f(a,b[h],c,h,1);for(h=0;h<e.length;h++)f(a,e[h],c,h,0)})}function f(a,c,d,b,e){if(c.Yb){var h=!0;S.Of(a,function(a,c,f){if(!e&&a==d&&f[0]==b||e&&c==d&&f[1]==b)h=!1});h&&(c.Yb=!1)}}function r(a,c,d){var b=[];S.Of(a,function(e,h,f){var m=S.Ra(a,e),q=S.Ra(a,h),m=ga.bi(m.Sa[f[0]].Ya),q=ga.bi(q.L[f[1]].Ya);
if(m!=q){var p,g={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},z={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};m&&!q?p=N("vector_to_scalar","B4W_VECTOSCAL",[g],[z]):!m&&q&&(p=N("scalar_to_vector","B4W_SCALTOVEC",[z],[g]));G(a,p,0,c,d);b.push([e,h,a.K[a.K.length-2],f])}});for(var e=0;e<b.length;++e)S.ps(a,b[e][0],b[e][1],b[e][3]),S.Wc(a,b[e][0],b[e][2],[b[e][3][0],0]),S.Wc(a,b[e][2],b[e][1],[0,b[e][3][1]])}function l(a){var c=[];S.ma(a,function(d,b){switch(b.type){case "B4W_TRANSLUCENCY":S.Of(a,
function(a,e,h){a==d&&"Translucency"==b.Sa[h[0]].name&&c.push(a,e,[h[0]+1,h[1]+1])})}});for(var d=0;d<c.length;d+=3)S.Wc(a,c[d],c[d+1],c[d+2])}function A(a,c){var d=[];S.ma(c,function(c,b){b.name==a.name&&d.push(c)});if(d.length)return d;ga.l("Node not found")}function x(a){var c=[];S.ma(a,function(a,d){"B4W_PARALLAX"!=d.type&&"REROUTE"!=d.type||c.push(a,d)});for(var d=0;d<c.length;d+=2){var b=c[d],e=c[d+1];if("B4W_PARALLAX"==e.type){var h=L(a,b);if(-1!=h){var f=S.vj(a,h,0);S.li(a,h,b,-1);-1!=f&&
S.li(a,f,h,-1);b=S.Ra(a,h);e.data=b.data;e.Ea[0]=b.Ea[0];S.Jf(a,h)}e.L.splice(1,1)}else if("REROUTE"==e.type){for(var e=S.vj(a,b,0),m=S.mg(a,b),h=[],f=[],q=[],p=0;p<m;p++){var g=S.eg(a,b,p),z=f.indexOf(g);-1!=z?q[z]+=1:(f.push(g),q.push(1),h.push(b,g))}if(-1!=e)for(m=S.me(a,e,b,0)[0],p=0;p<f.length;p++)for(g=0;g<q[p];g++)z=S.me(a,b,f[p],g)[1],S.Wc(a,e,f[p],[m,z]);for(p=0;p<h.length;p+=2)S.li(a,h[p],h[p+1],-1)}}}function L(a,c){for(var d=a.Aa,b=0;b<d.length;b+=3)if(d[b+1]==c&&1==d[b+2][1])return d[b];
return-1}function M(a){J(a);K(a);F(a)}function F(a){var c=[],d="",b="",e={};S.ma(a,function(a,h){if("GEOMETRY_UV"==h.type||"UVMAP"==h.type||"TEX_COORD_UV"==h.type){c.push(a,h);var f=h.data.value;d?d==f||b||(b=f,e[b]=0):(d=f,e[d]=0);e[f]++}});for(var f in e)if(2>e[f]){for(var m=0;m<c.length;m+=2)c[m+1].data.value==f&&c.splice(m,2);delete e[f];d==f&&(d=b,b="");b==f&&(b="")}if(!(3>c.length)){var m={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},q={default_value:[0,0,0],identifier:"UV_cycles",
is_linked:!1,name:"UV_cycles"};f=N("merged_uv","UV_MERGED",[],[m,q]);f.uv_layer=d;G(a,f,0,"",void 0);var p=a.K[a.K.length-2];f=a.K[a.K.length-1];if(b){q=N("merged_uv","UV_MERGED",[],[m,q]);q.uv_layer=b;G(a,q,0,"",void 0);var g=a.K[a.K.length-2],q=a.K[a.K.length-1]}else q=null;for(var z=-1,v=null,m=0;m<c.length;m+=2){var l=c[m],u=c[m+1];h(u,c[1])?(z=p,v=f):q&&(z=g,v=q);for(var k=[],r=S.mg(a,l),U={},D=0;D<r;D++){var A=S.eg(a,l,D);A in U||(U[A]=0);var x=S.me(a,l,A,U[A]++);k.push(l,A,x);x=x.splice(0,
x.length);switch(u.type){case "GEOMETRY_UV":x[0]=0;v.Sa[0].Yb=!0;break;case "UVMAP":case "TEX_COORD_UV":x[0]=1,v.Sa[1].Yb=!0}S.Wc(a,z,A,x)}for(var D=0;D<k.length;D+=3)S.li(a,k[D],k[D+1],0);S.Jf(a,l)}}}function J(a){var c=[];S.ma(a,function(a,d){"GEOMETRY_VC"!=d.type&&"GEOMETRY_NO"!=d.type&&"GEOMETRY_FB"!=d.type&&"GEOMETRY_VW"!=d.type&&"GEOMETRY_GL"!=d.type&&"GEOMETRY_LO"!=d.type&&"GEOMETRY_OR"!=d.type||c.push(a,d)});for(var b=[],e=0;e<c.length;e+=2){for(var h=c[e],f=c[e+1],m=!0,q=0;q<b.length;q++){var p=
b[q];if(d(f,p.Zd)){m=[];q=S.mg(a,h);for(v=0;v<q;v++){var g=S.eg(a,h,v),z=S.me(a,h,g,0);m.push(h,g,z);S.Wc(a,p.id,g,z)}for(var v=0;v<m.length;v+=3)S.li(a,m[v],m[v+1],0);S.Jf(a,h);m=!1;break}}m&&(p={id:h,Zd:f},b.push(p))}}function C(a){for(var c={},d=0;d<a.K.length;d+=2){var b=a.K[d];c[b]={Qm:{},wE:!1}}for(d=0;d<a.Aa.length;d+=3)c[a.Aa[d+1]].Qm[a.Aa[d]]=!0;for(b in c)H(b,c);for(b in c)c[b]=Object.keys(c[b].Qm).map(function(a){return parseInt(a)});return c}function H(a,c){var d=c[a];if(!d.wE){var b=
ga.ia(d),e;for(e in d.Qm){H(e,c);var d=c[e],h;for(h in d.Qm)b.Qm[h]=!0}b.wE=!0;c[a]=b}}function K(a){var c=[];S.ma(a,function(a,d){"TEXTURE_COLOR"!=d.type&&"TEXTURE_NORMAL"!=d.type||c.push(a,d)});if(c.length){for(var b=C(a),e=[],h=0;h<c.length;h+=2){for(var f=c[h],m=c[h+1],q=!0,p=0;p<e.length;p++){var g=e[p];if(!(3<=g.wl.length||!d(m,g.Zd)||-1<b[f].indexOf(g.id)||-1<b[g.id].indexOf(f))){for(var z=!1,v=0;v<g.wl.length;v++){var l=g.wl[v].id;if(-1<b[f].indexOf(l)||-1<b[l].indexOf(f)){z=!0;break}}if(!z){for(var p=
[],l=S.nr(a,f),u={},v=0;v<l;v++)z=S.vj(a,f,v),z in u||(u[z]=0),q=S.me(a,z,f,u[z]++),p.push(z,f,q);for(var l=[],u=S.mg(a,f),k={},v=0;v<u;v++)z=S.eg(a,f,v),z in k||(k[z]=0),q=S.me(a,f,z,k[z]++),l.push(f,z,q);q=p.concat(l);for(v=0;v<q.length;v+=3)S.li(a,q[v],q[v+1],0);S.Jf(a,f);v={id:f,Zd:m,KN:p,LN:l};g.wl.push(v);q=!1;break}}}q&&(g={id:f,Zd:m,wl:[]},e.push(g))}for(h=0;h<e.length;h++){g=e[h];b=g.wl.length;for(p=0;p<b;p++){m=g.wl[p];v=m.Zd;f=m.KN;m=m.LN;g.Zd.L[p+1].Yb=v.L[0].Yb;g.Zd.L[p+1].Ya=v.L[0].Ya;
g.Zd.Sa[2*(p+1)].Yb=v.Sa[0].Yb;g.Zd.Sa[2*(p+1)].Ya=v.Sa[0].Ya;g.Zd.Sa[2*(p+1)+1].Yb=v.Sa[1].Yb;g.Zd.Sa[2*(p+1)+1].Ya=v.Sa[1].Ya;for(v=0;v<f.length;v+=3)z=f[v],q=f[v+2],q[1]+=p+1,S.Wc(a,z,g.id,q);for(v=0;v<m.length;v+=3)z=m[v+1],q=m[v+2],q[0]+=2*(p+1),S.Wc(a,g.id,z,q);g.Zd.Mb.push(["USE_uv"+(p+2),1])}S.Jf(a,g.id);S.zk(a,g.id,g.Zd)}}}function d(a,c){if(a.type!==c.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==c.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.uuid==c.data.value.uuid;default:return!1}}function h(a,c){var d=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=d.indexOf(a.type)&&-1!=d.indexOf(c.type)?a.data.value==c.data.value:!1}function v(a){var d=[],b=[];S.ma(a,function(a,c){"GEOMETRY_VC"==c.type&&d.push(a,c);"GEOMETRY_VW"==c.type&&b.push(a,c)});P(a,d);c(a,b)}function P(a,c){for(var d=0;d<c.length;d+=2){for(var b=c[d],e=c[d+1],h=!1,f=[],m=[],q=[[],[],[]],p=S.mg(a,b),g=0;g<p;g++){var z=
S.eg(a,b,g);if("SEPRGB"!=S.Ra(a,z).type){h=!1;break}f.push(b,z);for(var v={},l=S.mg(a,z),h=0;h<l;h++){var u=S.eg(a,z,h);u in v||(v[u]=0);var k=S.me(a,z,u,v[u]++);f.push(z,u);q[k[0]].push(b,u,k)}m.push(z);h=!0}if(h){for(g=b=p=0;g<q.length;g++)q[g].length&&(p++,b|=1<<2-g);if(p){e.type+=p;e.Sa=[];for(g=0;g<q.length;g++)if(q[g].length)for(e.Sa.push({Ya:0,identifier:"RGB"[g],Yb:!0,name:"RGB"[g]}),h=0;h<q[g].length;h+=3)q[g][h+2][0]=ga.Lo(b,g);for(g=0;g<f.length;g+=2)S.li(a,f[g],f[g+1],0);for(g=0;g<m.length;g++)S.Jf(a,
m[g]);for(g=0;g<q.length;g++)for(h=0;h<q[g].length;h+=3)S.Wc(a,q[g][h],q[g][h+1],q[g][h+2])}}}}function c(a,c){for(var d=0;d<c.length;d+=2){for(var b=c[d],e=!0,h=[],f=S.mg(a,b),m=0;m<f;m++){var q=S.eg(a,b,m);if("B4W_REFLECT"==S.Ra(a,q).type){var p=S.me(a,b,q,0),g=S.me(a,b,q,1);p&&1==p[1]||g&&1==g[1]?e=!1:h.push(b,q)}else e=!1}for(m=0;m<h.length;m+=2)f=a,p=h[m],q=h[m+1],g=S.Ra(f,q),g.type+="_WORLD",S.li(f,p,q,0),g.L.splice(0,1),p=S.vj(f,q,0),p!=S.wu&&(S.me(f,p,q,0)[1]=0);e&&S.Jf(a,b)}}function p(a,
c,d,b,e,h){a=a.nodes;for(var f=null,m=0;m<a.length;m++){var q=a[m];e?"GROUP"==q.type&&q.node_tree_name==d&&(f=q):q.type==d&&(f=q)}return f?A(f,c)[0]:(h||ma.error('No "'+d+'" node in node '+b),-1)}function N(a,c,d,b){return{name:a,type:c,inputs:d,outputs:b}}function G(a,c,d,b,e){var h=c.name,f=c.type,q=[],p=[],g=[],v=[],l=null,k=[];switch(f){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":p=
Z(c);g=Y(c);ma.warn(f+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":p=Z(c);g=Y(c);break;case "UVMAP":var r=c.uv_layer;r||(f="EMPTY_UV");if("EMPTY_UV"!=f){var l=D("param_"+f+"_a"),U=D("param_"+f+"_v");q.push(ia(l));q.push(ia(U));v.push(ia(U));l={name:l,value:r}}g=Y(c);break;case "UV_MERGED":l=D("param_UV_MERGED_a");U=D("param_UV_MERGED_v");q.push(ia(l));q.push(ia(U));g.push(X(c,"UV_geom"));g.push(X(c,"UV_cycles"));v.push(ia(U));l={name:l,value:c.uv_layer};
break;case "CAMERA":p=[];g=Y(c);break;case "COMBRGB":case "COMBHSV":p=Z(c);g=Y(c);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==f?(aa(c,0,0)&&k.push(["READ_R",1]),aa(c,1,0)&&k.push(["READ_G",1]),aa(c,2,0)&&k.push(["READ_B",1]),aa(c,3,0)&&k.push(["READ_A",1])):(aa(c,0,-1)&&k.push(["READ_R",1]),aa(c,1,-1)&&k.push(["READ_G",1]),aa(c,2,-1)&&k.push(["READ_B",1]));p=Z(c);g=Y(c);l={value:c};break;case "PARTICLE_INFO":p=Z(c);g=Y(c);for(U=0;U<c.outputs.length;U++){var A=c.outputs[U],x=A.identifier,
t=ia("v_param_PART_INFO_"+x.replace(" ",""));if(A.is_linked)switch(x){case "Size":k.push(["PART_INFO_SIZE",T.H(1)]);break;case "Age":k.push(["PART_INFO_AGE",T.H(1)]);break;case "Lifetime":k.push(["PART_INFO_LT",T.H(1)]);break;case "Location":k.push(["PART_INFO_LOC",T.H(1)]);break;case "Index":l=r=ia("a_param_PART_INFO_"+A.identifier.replace(" ",""));k.push(["PART_INFO_IND",T.H(1)]);break;case "Velocity":k.push(["PART_INFO_VEL",T.H(1)]);break;case "Angular Velocity":k.push(["PART_INFO_A_VEL",T.H(1)])}"Age"!=
x&&"Lifetime"!=x&&"Size"!=x&&(q.push(t),v.push(t))}r&&q.push(r);break;case "GEOMETRY":if(!I(c))return!0;f=m(c,d);if(!f)return ma.error("Geometry output is not supported"),null;switch(f){case "GEOMETRY_UV":(r=c.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(l=D("param_GEOMETRY_UV_a"),U=D("param_GEOMETRY_UV_v"),q.push(ia(l)),q.push(ia(U)),v.push(ia(U)),l={name:l,value:r});g.push(X(c,"UV"));break;case "GEOMETRY_VC":(r=c.color_layer)||(f="EMPTY_VC");"EMPTY_VC"!=f&&(l=D("param_GEOMETRY_VC_a"),U=D("param_GEOMETRY_VC_v"),
q.push(ia(l)),q.push(ia(U)),v.push(ia(U)),l={name:l,value:r});g.push(X(c,"Vertex Color"));break;case "GEOMETRY_NO":g.push(X(c,"Normal"));break;case "GEOMETRY_FB":g.push(X(c,"Front/Back"));break;case "GEOMETRY_VW":g.push(X(c,"View"));break;case "GEOMETRY_GL":g.push(X(c,"Global"));break;case "GEOMETRY_LO":g.push(X(c,"Local"));break;case "GEOMETRY_OR":r=D("param_GEOMETRY_OR_v"),q.push(ia(r)),g.push(X(c,"Orco")),v.push(ia(r))}break;case "TEX_COORD":if(!I(c))return!0;f=V(c,d);if(!f)return ma.error("Texture coordinate output is not supported"),
null;switch(f){case "TEX_COORD_UV":(r=c.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(l=D("param_TEX_COORD_UV_a"),U=D("param_TEX_COORD_UV_v"),q.push(ia(l)),q.push(ia(U)),v.push(ia(U)),l={name:l,value:c.uv_layer});g.push(X(c,"UV"));break;case "TEX_COORD_NO":g.push(X(c,"Normal"));break;case "TEX_COORD_GE":r=D("param_TEX_COORD_GE_v");q.push(ia(r));g.push(X(c,"Generated"));v.push(ia(r));break;case "TEX_COORD_OB":g.push(X(c,"Object"));ma.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');
break;case "TEX_COORD_CA":g.push(X(c,"Camera"));break;case "TEX_COORD_WI":g.push(X(c,"Window"));ma.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":g.push(X(c,"Reflection")),ma.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;case "GROUP":r=c.node_tree_name;switch(r){case "B4W_LINEAR_TO_SRGB":if(!u(c,[1],[1])){l=z(c,b,e);break}f="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!u(c,
[1],[1])){l=z(c,b,e);break}f="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!u(c,[1],[1])){l=z(c,b,e);break}f="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!u(c,[1,1],[1])){l=z(c,b,e);break}f="B4W_REFLECT";break;case "B4W_REFRACTION":if(!u(c,[1,0],[1])){l=z(c,b,e);break}f="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!u(c,[1,1,0,0,0],[1])){l=z(c,b,e);break}f="B4W_PARALLAX";U=D("temp_texture");v.push(ia(U));break;case "B4W_CLAMP":if(!u(c,[1],[1])){l=z(c,b,e);break}f="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!u(c,
[0,0,0,0,0],[0])){l=z(c,b,e);break}f="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!u(c,[],[0])){l=z(c,b,e);break}f="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!u(c,[0,0,0],[0])){l=z(c,b,e);break}f="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":f="B4W_GLOW_OUTPUT";break;default:l=z(c,b,e)}p=Z(c);g=Y(c);"B4W_TRANSLUCENCY"==r&&(r=W("TranslucencyParams","TranslucencyParams",[0,0,0,0]),r.Yb=g[0].Yb,g.push(r));break;case "LAMP":l=c.lamp;if(!l)return ma.error("There is no lamp in node: "+c.name),null;g.push(X(c,
"Color"));g.push(X(c,"Light Vector"));g.push(X(c,"Distance"));g.push(X(c,"Visibility Factor"));l.uuid in ua?k.push(["LAMP_INDEX",String(ua[l.uuid])]):(ua[l.uuid]=Fa,k.push(["LAMP_INDEX",String(Fa++)]));l=ua;break;case "LIGHTING_AMBIENT":p=[W("E","E",[0,0,0],!0),W("A","A",[0,0,0],!0),W("D","D",[0,0,0],!0)];g=[W("color","color",[0,0,0],!0),W("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":g=[W("E","E",[0,0,0],!0),W("A","A",[0,0,0],!0),W("D","D",[0,0,0],!0),W("S","S",[0,0,0],!0),W("normal",
"normal",[0,0,0],!0),W("dif_params","dif_params",[0,0],!0),W("sp_params","sp_params",[0,0],!0),W("shadow_factor","shadow_factor",0,!0),W("translucency_color","translucency_color",0,!0),W("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":p=[W("color","color",[0,0,0],!0),W("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":p=[W("shadow_factor","shadow_factor",0,!0)];g=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("lcolorint","lcolorint",[0,0,
0],!0),W("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":p=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("normal","normal",[0,0,0],!0),W("norm_fac","norm_fac",0,!0)];g=[W("lfactor","lfactor",0,!0)];break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":p=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("normal","normal",[0,0,0],!0),W("norm_fac","norm_fac",0,!0),W("dif_params","dif_params",[0,0],!0)];g=[W("lfactor","lfactor",
0,!0)];break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":p=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("normal","normal",[0,0,0],!0),W("norm_fac","norm_fac",0,!0),W("sp_params","sp_params",[0,0],!0)];g=[W("sfactor","sfactor",0,!0)];break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":p=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("normal","normal",[0,0,0],!0),W("sp_params","sp_params",[0,0],!0)];g=[W("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":p=[W("color","color",
[0,0,0,0],!0),W("specular","specular",[0,0,0],!0),W("lfactor","lfactor",0,!0),W("sfactor","sfactor",0,!0),W("ldir","ldir",[0,0,0],!0),W("normal","normal",[0,0,0],!0),W("translucency_params","translucency_params",[0,0,0,0],!0),W("D","D",[0,0,0],!0),W("S","S",[0,0,0],!0),W("lcolorint","lcolorint",[0,0,0],!0),W("translucency_color","translucency_color",0,!0)];g=[W("color","color",[0,0,0,0],!0),W("specular","specular",[0,0,0],!0)];break;case "NORMAL":p=Z(c);g=Y(c);r=X(c,"Normal");v.push(ia(D("param_NORMAL_Normal"),
r.Ya,3));break;case "MAPPING":r=c.vector_type;f="MAPPING";p.push(R(c,"Vector"));g.push(X(c,"Vector"));var U=c.rotation,A=c.scale,x=c.translation,t=Aa.create(),n=ga.TN(U);"TEXTURE"==r&&(A[0]=A[0]||1,A[1]=A[1]||1,A[2]=A[2]||1);var N=new Float32Array([A[0],0,0,0,A[1],0,0,0,A[2]]);Aa.multiply(n,N,t);t=ga.tQ(t,ra.create());switch(r){case "POINT":t[12]=x[0];t[13]=x[1];t[14]=x[2];break;case "TEXTURE":t[12]=x[0];t[13]=x[1];t[14]=x[2];t=ra.invert(t,t);break;case "NORMAL":ra.invert(t,t),ra.transpose(t,t)}switch(r){case "NORMAL":k.push(["MAPPING_IS_NORMAL",
1]);case "TEXTURE":k.push(["MAPPING_TRS_MATRIX",T.H(t,16)]);break;case "POINT":0!==O.length(U)?k.push(["MAPPING_TRS_MATRIX",T.H(t,16)]):(0!==O.length(A)&&k.push(["MAPPING_SCALE",T.H(A,3)]),0!==O.length(x)&&k.push(["MAPPING_TRANSLATION",T.H(x,3)]));break;case "VECTOR":0!==O.length(U)?k.push(["MAPPING_TRS_MATRIX",T.H(t,16)]):0!==O.length(A)&&k.push(["MAPPING_SCALE",T.H(A,3)])}c.use_min&&k.push(["MAPPING_MIN_CLIP",T.H(c.min,3)]);c.use_max&&k.push(["MAPPING_MAX_CLIP",T.H(c.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":l=
[];r=[];U=[];A=[W("E","E",[0,0,0],!0),W("A","A",[0,0,0],!0),W("D","D",[0,0,0],!0),W("S","S",[0,0,0],!0),W("normal","normal",[0,0,0],!0),W("dif_params","dif_params",[0,0],!0),W("sp_params","sp_params",[0,0],!0),W("shadow_factor","shadow_factor",0,!0)];x=[W("color","color",[0,0,0],!0),W("specular","specular",[0,0,0],!0),W("normal","normal",[0,0,0],!0)];t=[X(c,"Color"),X(c,"Alpha"),X(c,"Normal")];n=[];N=R(c,"Color");N.Ya.splice(3);U.push(N);p.push(N);N=R(c,"Spec");N.Ya.splice(3);U.push(N);p.push(N);
(N=R(c,"DiffuseIntensity"))||(N=R(c,"Refl"));N.Ya=c.diffuse_intensity;U.push(N);p.push(N);var E=R(c,"Normal");E.Ya.splice(3);U.push(E);p.push(E);"MATERIAL_EXT"==f?((N=R(c,"Emit"))||(N=W("Emit","Emit",0)),U.push(N),p.push(N),(N=R(c,"Translucency"))?(N.Ya=0,N.name="Translucency",N.identifier="Translucency"):N=W("Translucency","Translucency",0),p.push(N),(N=R(c,"Translucency"))?(N.Ya=[0,0,0,0],N.name="TranslucencyParams",N.identifier="TranslucencyParams"):N=W("TranslucencyParams","TranslucencyParams",
[0,0,0,0]),p.push(N),g=R(c,"Reflectivity"),N=R(c,"Ray Mirror"),g?(N=g,g="Reflectivity"):N?g="Ray Mirror":(N=g,g="Reflectivity"),N||(N=W(g,g,0)),p.push(N),x.push(N),(N=R(c,"SpecTra"))||(N=W("SpecTra","SpecTra",0)),p.push(N),x.push(N),(N=R(c,"Alpha"))||(N=W("Alpha","Alpha",c.alpha)),p.push(N),x.push(N),t.push(X(c,"Diffuse")),t.push(X(c,"Spec")),l.push(["MATERIAL_EXT",1]),r.push(["MATERIAL_EXT",1])):(U.push(W("emit_intensity","emit_intensity",0)),x.push(W("reflect_factor","reflect_factor",0)),x.push(W("specular_alpha",
"specular_alpha",0)),x.push(W("alpha_in","alpha_in",0)),t.push(W("diffuse_out","diffuse_out",0)),t.push(W("spec_out","spec_out",0)),l.push(["MATERIAL_EXT",0]),r.push(["MATERIAL_EXT",0]));n.push(ia(D("param_MATERIAL_alpha"),c.alpha));n.push(ia(D("param_MATERIAL_spec_alpha"),c.specular_alpha));g=t;E.Yb&&l.push(["USE_MATERIAL_NORMAL",1]);c.use_diffuse&&(l.push(["USE_MATERIAL_DIFFUSE",1]),r.push(["USE_MATERIAL_DIFFUSE",1]));c.use_specular&&r.push(["USE_MATERIAL_SPECULAR",1]);var N=[],w=0;switch(c.specular_shader){case "COOKTORR":case "PHONG":E=
c.specular_hardness;break;case "WARDISO":E=c.specular_slope;break;case "TOON":E=c.specular_toon_size;w=c.specular_toon_smooth;break;case "BLINN":E=c.specular_ior;w=c.specular_hardness;break;default:ma.error("unsupported specular shader: "+c.specular_shader+' (material "'+c.material_name+'")'),E=c.specular_hardness}var P,ea;switch(c.diffuse_shader){case "LAMBERT":ea=P=0;break;case "OREN_NAYAR":P=c.roughness;ea=0;break;case "FRESNEL":P=c.diffuse_fresnel;ea=c.diffuse_fresnel_factor;break;case "MINNAERT":P=
c.darkness;ea=0;break;case "TOON":P=c.diffuse_toon_size;ea=c.diffuse_toon_smooth;break;default:ma.error("unsupported diffuse shader: "+c.diffuse_shader+' (material "'+c.material_name+'")'),ea=P=0}N.push(ia(D("param_MATERIAL_diffuse"),[P,ea],2));N.push(ia(D("param_MATERIAL_spec"),[c.specular_intensity,E,w],3));l.push(["SHADELESS_MAT",c.use_shadeless?1:0]);E={name:c.name,value:{$l:c.specular_shader,yn:c.diffuse_shader,Fe:c.use_shadeless}};l={name:c.name,value:{$l:c.specular_shader,yn:c.diffuse_shader,
Fe:c.use_shadeless},uQ:{name:"material_begin",type:"MATERIAL_BEGIN",L:U,Sa:A,Ea:N,data:E,Mb:l,Hi:[]},vQ:{name:"material_end",type:"MATERIAL_END",L:x,Sa:t,Ea:n,data:E,Mb:r,Hi:[]}};break;case "MATH":switch(c.operation){case "ADD":f="MATH_ADD";break;case "SUBTRACT":f="MATH_SUBTRACT";break;case "MULTIPLY":f="MATH_MULTIPLY";break;case "DIVIDE":f="MATH_DIVIDE";break;case "SINE":f="MATH_SINE";break;case "COSINE":f="MATH_COSINE";break;case "TANGENT":f="MATH_TANGENT";break;case "ARCSINE":f="MATH_ARCSINE";
break;case "ARCCOSINE":f="MATH_ARCCOSINE";break;case "ARCTANGENT":f="MATH_ARCTANGENT";break;case "POWER":f="MATH_POWER";break;case "LOGARITHM":f="MATH_LOGARITHM";break;case "MINIMUM":f="MATH_MINIMUM";break;case "MAXIMUM":f="MATH_MAXIMUM";break;case "ROUND":f="MATH_ROUND";break;case "LESS_THAN":f="MATH_LESS_THAN";break;case "GREATER_THAN":f="MATH_GREATER_THAN";break;case "MODULO":f="MATH_MODULO";break;case "ABSOLUTE":f="MATH_ABSOLUTE";break;default:return ma.error("Unsupported MATH operation: "+c.operation),
null}k.push(["MATH_USE_CLAMP",Number(c.use_clamp)]);p=Z(c);g=Y(c);break;case "MIX_RGB":switch(c.blend_type){case "MIX":f="MIX_RGB_MIX";break;case "ADD":f="MIX_RGB_ADD";break;case "MULTIPLY":f="MIX_RGB_MULTIPLY";break;case "SUBTRACT":f="MIX_RGB_SUBTRACT";break;case "SCREEN":f="MIX_RGB_SCREEN";break;case "DIVIDE":f="MIX_RGB_DIVIDE";break;case "DIFFERENCE":f="MIX_RGB_DIFFERENCE";break;case "DARKEN":f="MIX_RGB_DARKEN";break;case "LIGHTEN":f="MIX_RGB_LIGHTEN";break;case "OVERLAY":f="MIX_RGB_OVERLAY";break;
case "DODGE":f="MIX_RGB_DODGE";break;case "BURN":f="MIX_RGB_BURN";break;case "HUE":f="MIX_RGB_HUE";break;case "SATURATION":f="MIX_RGB_SATURATION";break;case "VALUE":f="MIX_RGB_VALUE";break;case "COLOR":f="MIX_RGB_COLOR";break;case "SOFT_LIGHT":f="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":f="MIX_RGB_LINEAR_LIGHT";break;default:return ma.error("Unsupported MIX_RGB blend type: "+c.blend_type),null}k.push(["MIX_RGB_USE_CLAMP",Number(c.use_clamp)]);p=Z(c);g=Y(c);break;case "OUTPUT":p=Z(c);g=[];break;
case "RGB":r=b+"%join%"+c.name;r={name:"-1",value:r};v.push(r);g.push(X(c,"Color"));break;case "SEPRGB":case "SEPHSV":p=Z(c);g=Y(c);break;case "TEXTURE":f=Q(c);if("TEXTURE_EMPTY"==f)g.push(X(c,"Color")),g.push(X(c,"Normal")),g.push(X(c,"Value"));else if("TEXTURE_ENVIRONMENT"==f)p.push(R(c,"Vector")),g.push(X(c,"Color")),g.push(X(c,"Value"));else{if("TEXTURE_NORMAL"==f&&"ENVIRONMENT_MAP"==c.texture.type)return ma.error("Wrong output for ENVIRONMENT_MAP texture: "+c.name),null;for(l=0;4>l;++l)l?(N=
W("Vector"+l,"Vector"+l,[0,0,0]),"TEXTURE_COLOR"==f&&(U=W("Color"+l,"Color"+l,[0,0,0]),A=W("Value"+l,"Value"+l,0)),"TEXTURE_NORMAL"==f&&(U=W("Normal"+l,"Normal"+l,[0,0,0]),A=W("Value"+l,"Value"+l,0))):(N=R(c,"Vector"),"TEXTURE_COLOR"==f&&(U=X(c,"Color"),A=X(c,"Value")),"TEXTURE_NORMAL"==f&&(U=X(c,"Normal"),A=X(c,"Value"))),p.push(N),g.push(U),g.push(A)}U=D("param_TEXTURE_texture");v.push(ia(U));l={name:U,value:c.texture};break;case "VALTORGB":p=Z(c);g=Y(c);l={value:c};r=c.color_ramp.interpolation;
"CONSTANT"!=r&&"LINEAR"!=r&&ma.warn("Color Ramp node is not fully supported.");break;case "VALUE":f="VALUE";r=b+"%join%"+c.name;r={name:"-1",value:r};v.push(r);g.push(X(c,"Value"));break;case "VECT_MATH":switch(c.operation){case "ADD":f="VECT_MATH_ADD";break;case "SUBTRACT":f="VECT_MATH_SUBTRACT";break;case "AVERAGE":f="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":f="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":f="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":f="VECT_MATH_NORMALIZE";break;default:return ma.error("Unsupported VECT_MATH operation: "+
c.operation),null}p=Z(c);g=Y(c);break;case "VECT_TRANSFORM":switch(c.vector_type){case "POINT":k.push(["VECTOR_TYPE",T.H(0)]);break;case "VECTOR":k.push(["VECTOR_TYPE",T.H(1)]);break;case "NORMAL":k.push(["VECTOR_TYPE",T.H(2)]);break;default:return ma.error("Unsupported VECT_TRANSFORM vector_type: "+c.vector_type),null}p=c.convert_from;g=c.convert_to;if("WORLD"==p)if("WORLD"==g)p=0;else if("OBJECT"==g)p=1;else if("CAMERA"==g)p=2;else return ma.error("Unsupported VECT_TRANSFORM convert_to: "+c.convert_to),
null;else if("OBJECT"==p)if("WORLD"==g)p=3;else if("OBJECT"==g)p=4;else if("CAMERA"==g)p=5;else return ma.error("Unsupported VECT_TRANSFORM convert_to: "+c.convert_to),null;else if("CAMERA"==p)if("WORLD"==g)p=6;else if("OBJECT"==g)p=7;else if("CAMERA"==g)p=8;else return ma.error("Unsupported VECT_TRANSFORM convert_to: "+c.convert_to),null;else return ma.error("Unsupported VECT_TRANSFORM convert_from: "+c.convert_from),null;k.push(["CONVERT_TYPE",T.H(p)]);p=Z(c);g=Y(c);break;default:p=Z(c),g=Y(c)}f=
{name:h,type:f,Hi:q,L:p,Sa:g,Ea:v,data:l,Mb:k};h=S.Sn(a);S.zk(a,S.Sn(a),f);if(!(f="GEOMETRY"!=c.type&&"TEX_COORD"!=c.type)){a:{f=c.outputs;for(v=q=0;v<f.length;v++)if(f[v].is_linked&&q++>d){f=!0;break a}f=!1}f=!f}return f||null!=G(a,c,++d,b,e)?h:null}function u(a,c,d){for(var b=a.inputs,e=a.outputs,h=a.node_tree_name,f=0;f<c.length;f++){var m=b[f],q=c[f];if(!m||m.default_value instanceof Array!=q)return ma.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',h,'".Processing as general node group.'),
!1}for(f=0;f<d.length;f++)if(c=e[f],b=d[f],!c||c.default_value instanceof Array!=b)return ma.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',h,'".Processing as general node group.'),!1;return!0}function z(a,c,d){var b=a.node_group.node_tree,e={},h;for(h in b)if("links"==h||"nodes"==h){e[h]=[];for(var f=0;f<b[h].length;f++){e[h][f]={};for(var m in b[h][f])if("links"==h){e[h][f][m]={};for(var p in b[h][f][m])e[h][f][m][p]=q(b[h][f][m][p])}else e[h][f][m]=q(b[h][f][m])}}else e[h]=
q(b[h]);b=a.node_tree_name;if("B4W_REPLACE"==b||"B4W_LEVELS_OF_QUALITY"==b)h=N("Group input","GROUP_INPUT",[],a.inputs),f=N("Group output","GROUP_OUTPUT",a.outputs,[]),m=null,m="B4W_REPLACE"==b||"B4W_LEVELS_OF_QUALITY"==b&&(Ia.quality==ca.Pi||Ia.lw)?{from_node:h,from_socket:h.outputs[1],to_node:f,to_socket:f.inputs[0]}:{from_node:h,from_socket:h.outputs[0],to_node:f,to_socket:f.inputs[0]},e.nodes=[h,f],e.links=[m];b=a.name;h=e.nodes;f=e.links;for(m=0;m<h.length;m++)h[m].name=ka(h[m].type,b,h[m].name);
for(m=0;m<f.length;m++)f[m].from_node.name=ka(f[m].from_node.type,b,f[m].from_node.name),f[m].to_node.name=ka(f[m].to_node.type,b,f[m].to_node.name);return{GQ:k(e,a.node_group.uuid,!0,c,d).Pa,HQ:e.links}}function q(a){var c=typeof a;return"string"!=c&&"number"!=c&&"boolean"!=c&&a?ga.dn(a):a}function D(a){fa[a]||(fa[a]=0);var c=a+"_"+fa[a],c=c.replace(/ /g,"_").replace(/\//g,"_");fa[a]++;return c}function I(a){a=a.outputs;for(var c=0;c<a.length;c++)if(a[c].is_linked)return!0;return!1}function m(a,
c){for(var d=a.outputs,b=0,e=0;e<d.length;e++){var h=d[e];if(h.is_linked&&!(b++<c))switch(h.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function V(a,c){for(var d=a.outputs,b=0,e=0;e<d.length;e++){var h=d[e];if(h.is_linked&&!(b++<c))switch(h.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function Q(a){if(!a.texture)return"TEXTURE_EMPTY";for(var c=a.outputs,d=!1,b=!1,e=!1,h=0;h<c.length;h++){var f=c[h];if(f.is_linked)switch(f.identifier){case "Color":d=!0;break;case "Normal":b=!0;break;case "Value":e=!0;break;default:ga.l("Unknown texture output")}}if(d)return b&&
ma.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(b)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function R(a,c){for(var d=a.inputs,b=0;b<d.length;b++){var e=d[b];if(e.identifier==c)return ja(e)}return null}function X(a,c){for(var d=a.outputs,b=0;b<d.length;b++){var e=d[b];if(e.identifier==c)return ja(e)}return null}function ja(a){var c=
a.name,d=a.identifier,b=a.is_linked;a=a.default_value;a=ga.bi(a)?a.slice(0):a;return{name:c,identifier:d,Yb:b,Ya:a}}function W(a,c,d,b){return{name:a,identifier:c,Yb:b||!1,Ya:d}}function Z(a){for(var c=[],d=0;d<a.inputs.length;d++){var b=ja(a.inputs[d]);b.Ya.length&&b.Ya.splice(3);c.push(b)}return c}function Y(a){for(var c=[],d=0;d<a.outputs.length;d++){var b=ja(a.outputs[d]);c.push(b)}return c}function ia(a,c,d){c=null===c||void 0===c?null:T.H(c,d);return{name:a,value:c}}function ha(a,c,d,b,e,h){var f=
[],m=h.from_socket.identifier;h=h.to_socket.identifier;var q=b.Sa;for(b=0;b<q.length;b++)if(q[b].identifier==m){f.push(b);break}e=e.L;for(b=0;b<e.length;b++)if(e[b].identifier==h){f.push(b);break}2==f.length&&S.Wc(a,c,d,f);return!0}function ka(a,c,d){return"GROUP_INPUT"==a?c+"*GI*"+d:"GROUP_OUTPUT"==a?c+"*GO*"+d:c+"%join%"+d}function la(a){var c=[];S.ma(a,function(a,d){"GROUP"==d.type&&c.push(d)});return c}function da(a,c,d){for(var b=0;b<d.length;b++){var e=d[b].data.GQ,h=d[b].data.HQ;if(!e)return!1;
S.ma(e,function(c,d){S.zk(a,S.Sn(a),d)});for(e=0;e<h.length;e++)c.push(h[e]);Ca(d[b],c,a)}return!0}function E(a,c,d,b,e,h){switch(a.type){case "GROUP":a.name==c&&b.push(d);break;case "GROUP_INPUT":a.name.indexOf(c+"*GI*")||e.push(d);break;case "GROUP_OUTPUT":a.name.indexOf(c+"*GO*")||h.push(d)}}function oa(a,c,d){for(var b=[],e=0;e<d.length;e++){for(var h=d[e],f=null,m=0;m<c.length;m++)if(h.from_socket.identifier==c[m].to_socket.identifier){f=c[m];break}f?(h.from_node=f.from_node,h.from_socket=f.from_socket):
b.push(h)}for(e=0;e<c.length;e++)a.splice(a.indexOf(c[e]),1);return b}function U(a,c){if(c.length)for(var d=c[0].from_node.name,b=0;b<a.length;b++)a[b].from_node.name==d&&c.push(a[b])}function ea(a,c,d,b){for(var e=0;e<b.length;e++){for(var h=b[e],f,m=0;m<d.L.length;m++)if(h.from_socket.identifier==d.L[m].identifier){f=d.L[m].Ya;break}for(var m=h,q=c,p=f,g=A(m.to_node,q),v=0;v<g.length;v++)for(var l=S.Ra(q,g[v]),z=0;z<l.L.length;z++){var u=l.L[z];if(u.identifier==m.to_socket.identifier){l=u.Ya instanceof
Object?0:1;if((p instanceof Object?0:1)==l)u.Ya=p;else switch(l){case 0:u=u.Ya;u[0]=u[1]=u[2]=p;break;case 1:u.Ya=(p[0]+p[1]+p[2])/3}break}}h=a.indexOf(h);-1!=h&&a.splice(h,1)}}function Ca(a,c,d){for(var b=a.name,e=[],h=[],f=[],m=[],q=0;q<c.length;q++){var p=c[q];E(p.from_node,b,p,e,f,m);E(p.to_node,b,p,h,f,m)}h=oa(c,h,f);e=oa(c,m,e);U(c,h);ea(c,d,a,h);if(e.length){var g;S.ma(d,function(a,c){"GROUP_OUTPUT"!=c.type||c.name.indexOf(b+"*GO*")||(g=c)});ea(c,d,g,e)}}function ba(a){var c=[],d=[];S.ma(a,
function(a,b){switch(b.type){case "VALTORGB":c.push(b);break;case "CURVE_VEC":case "CURVE_RGB":d.push(b)}});var b=0,e=a=null,h=c.length+d.length;if(c.length){a=ya.HM(c,ya.II);for(var f=0;f<c.length;f++)c[f].Mb.push(["NODE_TEX_ROW",T.H((b+.5)/h)]),b++}if(d.length)for(e=ya.jN(d,ya.Pz),f=0;f<d.length;f++)d[f].Mb.push(["NODE_TEX_ROW",T.H((b+.5)/h)]),b++;f=null;a&&e?(f=new Uint8Array(a.length+e.length),f.set(a),f.set(e,a.length)):f=a?a:e;a=f?ya.$C(f,ya.Pz):null;for(f=0;f<c.length;f++)c[f].data.Ja=a;for(f=
0;f<d.length;f++)d[f].data.Ja=a}function aa(a,c,d){a=a.curve_mapping.curves_data[c];return 2==a.length&&a[0][0]<d+.01&&a[0][1]<d+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var ca=n("__config");n("__debug");var S=n("__graph"),Aa=n("__mat3"),ra=n("__mat4"),za=n("__objects"),ma=n("__print"),T=n("__shaders"),Da=n("__scenes"),ga=n("__util"),O=n("__vec3"),ya=n("__textures"),fa={},pa={},Ea={},ua={},Fa=0;new Float32Array(4);var Ia=ca.v;a.eW=0;a.xK=1;a.wK=2;a.vK=3;a.dW=4;a.uK=5;a.tK=6;a.sK=7;a.cW=8;a.BD=function(a){return pa[a]};
a.uM=function(a){delete pa[a]};a.yM=k;a.Gv=function(a,c,d){var b=Da.p();a=g(a,"MAIN",b.uuid);if(a in Ea)return Ea[a];var b=S.create(),h={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},f=G(b,h,0,c,null),h={name:"LIGHTING_END",type:"LIGHTING_END"},h=G(b,h,0,c,null);e(b,d,f,h,[[f,[8,10]],[f,[9,6]]],c);t(b);return Ea[a]=b};a.sq=function(a){var c=[],d={};fa={};var b=S.iz(a);S.ma(b,function(a,b){var e;e=[];for(var h=[],f=[],m=[],q=[],p=[],g=0;g<b.L.length;g++){var v=b.L[g];if(v.Yb)e.push(null),h.push(null);
else{e.push(D("in_"+b.type+"_"+v.identifier));var l=T.H(v.Ya,0);Ia.YG&&(0<=b.type.indexOf("MIX_RGB_")&&("Color1"==v.identifier||"Color2"==v.identifier||"Fac"==v.identifier)||0<=b.type.indexOf("MATH_")&&("Value"==v.identifier||"Value_001"==v.identifier)||0<=b.type.indexOf("VECT_MATH_")&&"Vector_001"==v.identifier||0<=b.type.indexOf("LIGHTING_APPLY")||0<=b.type.indexOf("MATERIAL_END")||0<=b.type.indexOf("MATERIAL_BEGIN"))&&(v=l,v=v.replace(/(,)/g,"$1 "),v=v.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,
"$1ZERO_VALUE_NODES$3"),v=v.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1UNITY_VALUE_NODES$3"),l=v=v.replace(/\s+/g,""));h.push(l)}}for(g=0;g<b.Sa.length;g++)v=b.Sa[g],v.Yb?f.push(null):f.push(D("out_"+b.type+"_"+v.identifier));for(g=0;g<b.Ea.length;g++)v=b.Ea[g],m.push(v.name),q.push(v.value);for(g=0;g<b.Hi.length;g++)p.push(b.Hi[g].name);e={id:b.type,L:e,Tw:h,Sa:f,Ea:m,Zr:q,Hi:p,Mb:JSON.parse(JSON.stringify(b.Mb))};c.push(e);d[a]=e});S.Of(b,function(a,c,e){var h=S.Ra(b,a);S.Ra(b,c);var f=h.Sa[e[0]];
a=d[a].Sa;c=d[c].L;h=a[e[0]]||D("out_"+h.type+"_"+f.identifier);a[e[0]]=h;c[e[1]]=h});return c};a.FB=function(a){if(a.node_tree)for(var c=0;c<a.node_tree.nodes.length;c++){var d=a.node_tree.nodes[c];if("GROUP"==d.type&&"B4W_GLOW_OUTPUT"==d.node_tree_name)return!0}return!1};a.ha=function(){for(var a in pa)delete pa[a];for(a in Ea)delete Ea[a];for(var c in ua)delete ua[c];Fa=0}};b4w.module.__debug=function(a,n){function k(a){a=a.split("\n");for(var d=0;d<a.length;d++)a[d]=d+1+" "+a[d];return a=a.join("\n")}function b(){var a=t.Bw();if(a){var d=a.createQueryEXT();a.beginQueryEXT(a.TIME_ELAPSED_EXT,d)}else d=performance.now();return d}function e(){var c=d;return c&&c.debug_view_mode==a.Bm}function y(a,d){var b=t.Bw(),e=0;if(b){b.endQueryEXT(b.TIME_ELAPSED_EXT);for(var h=0;h<a.length;h++){var f=a[h],q=b.getQueryObjectEXT(f,b.QUERY_RESULT_AVAILABLE_EXT),g=F.getParameter(b.GPU_DISJOINT_EXT);
q&&!g&&(e=b.getQueryObjectEXT(f,b.QUERY_RESULT_EXT)/1E6,d&&(e=A.lc(e,d,1,10)),a.splice(h,1),h--)}}else e=performance.now()-a.pop(),d&&(e=A.lc(e,d,1,10));return e}function g(a,d){typeof a!=typeof d&&A.l("Structure assertion failed: incompatible types");if(null!==a&&null!==d&&"object"==typeof a){for(var b in a)b in d||A.l("Structure assertion failed: missing key in the first object: "+b);for(b in d)b in a||A.l("Structure assertion failed: missing key in the second object: "+b),typeof a[b]!=typeof d[b]&&
A.l("Structure assertion failed: incompatible types for key "+b)}}var B=n("__compat"),w=n("__config"),t=n("__extensions"),f=n("__print"),r=n("__textures"),l=n("__time"),A=n("__util"),x=n("__graph"),L=w.v,M={},F=null,J={},C=[],H=-1,K=-1,d=null,h=null,v=!1;a.vp=0;a.Gt=1;a.wp=2;a.Ft=3;a.tp=4;a.Et=5;a.Dt=6;a.Bm=7;a.xe=function(a){var d="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),b;for(b in d){var e=d[b];e in a&&(M[a[e]]=e)}F=
a};a.MR=function(a){d=a};a.GY=function(){return d};a.pv=function(a){if(L.gl_debug){var d=F.getError();d!=F.NO_ERROR&&(d in M?A.l("GL Error: "+d+", gl."+M[d]+" ("+a+")"):A.l("Unknown GL error: "+d+" ("+a+")"))}};a.ZL=function(){if(L.gl_debug||L.EB)switch(F.checkFramebufferStatus(F.FRAMEBUFFER)){case F.FRAMEBUFFER_COMPLETE:break;case F.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case F.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");
break;case F.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case F.FRAMEBUFFER_UNSUPPORTED:f.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case F.YU:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:f.error("FRAMEBUFFER CHECK FAILED")}};a.cM=function(){if(-1!=H)return H;F.bindFramebuffer(F.FRAMEBUFFER,F.createFramebuffer());var a=r.qn("DEBUG",r.uk);r.resize(a,1,1);F.framebufferTexture2D(F.FRAMEBUFFER,
F.DEPTH_ATTACHMENT,a.ac,a.hb,0);F.checkFramebufferStatus(F.FRAMEBUFFER)!=F.FRAMEBUFFER_COMPLETE?(H=!0,f.warn("depth-only issue was found")):H=!1;F.bindFramebuffer(F.FRAMEBUFFER,null);return H};a.iM=function(){if(-1!=K)return K;F.bindRenderbuffer(F.RENDERBUFFER,F.createRenderbuffer());F.renderbufferStorageMultisample(F.RENDERBUFFER,L.rc,F.RGBA8,1,1);var a=F.getRenderbufferParameter(F.RENDERBUFFER,F.RENDERBUFFER_SAMPLES);a!=L.rc?(K=!0,f.warn("multisample issue was found: requested "+L.rc+", got "+a),
F.getError()==F.INVALID_OPERATION&&f.warn("the error from multisample issue detected, ignoring")):K=!1;F.bindRenderbuffer(F.RENDERBUFFER,null);return K};a.fM=function(){return B.qv("Firefox")&&F.getError()==F.OUT_OF_MEMORY?(f.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.jM=function(a,d,b){if(L.gl_debug&&!F.getShaderParameter(a,F.COMPILE_STATUS)){var e=L.VA&&t.zw();e&&(b=e.getTranslatedShaderSource(a));b=k(b);f.error("shader compilation failed:\n"+b+"\n"+F.getShaderInfoLog(a)+" ("+d+
")");A.l("Engine failed: see above for error messages")}};a.kM=function(a,d,b,e,h,g){if(L.gl_debug&&!F.getProgramParameter(a,F.LINK_STATUS)){var q=L.VA&&t.zw();q&&(h=q.getTranslatedShaderSource(b),g=q.getTranslatedShaderSource(e));h=k(h);g=k(g);f.error("shader linking failed:\n"+h+"\n\n\n"+g+"\n"+F.getProgramInfoLog(a)+" ("+d+")");A.l("Engine failed: see above for error messages")}};a.dy=function(a){if(L.show_hud_debug_info||"PERFORMANCE"==a.type)a.bw||a.Nk.push(b())};a.sR=function(a){"MAIN"==a.type&&
e()&&a.Nk.push(b())};a.ey=function(a){if((L.show_hud_debug_info||"PERFORMANCE"==a.type)&&!a.bw){var d=y(a.Nk,a.tf);d&&(a.tf=d)}};a.tR=function(a){if("MAIN"==a.type&&e()){var d=y(a.Nk,a.tf);d&&(a.tf=d)}};a.AE=e;a.fR=function(a){var d=y(a.Nk,a.tf);d&&(a.tf=d)};a.UX=function(a){J[a]=a in J?J[a]+1:1};a.update=function(){for(var a in J)f.log(a,J[a]),J[a]=0};a.Pq=function(){for(var a=[performance.now()],d=0;d<arguments.length;d++){var b=arguments[d];if(A.bi(b))for(var e=0;e<b.length;e++)a.push(b[e]);else a.push(arguments[d])}C.push(a)};
a.nF=function(){for(var a=1,d=0;d<C.length;d++){var b=C[d];b[1]==arguments[0]&&a++}b=[a];for(d=0;d<arguments.length;d++)if(a=arguments[d],A.bi(a))for(var e=0;e<a.length;e++)b.push(a[e]);else b.push(arguments[d]);C.push(b)};var P=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.TF=function(a){a||(a=1);for(var d=0,b={},e=Math.max(0,performance.now()-1E3*a),h=0;h<C.length;h++){var g=C[h];a=g[0];if(!(a<e)){var q=String(g[1]);b[q]||(b[q]=P[d++%P.length]);a=["%c"+
(a/1E3).toFixed(6),b[q],q];for(q=2;q<g.length;q++)a.push(g[q]);f.log.apply(this,a)}}C.splice(0)};a.Ox=function(a){a||(a=1);for(var d={},b=Math.max(0,performance.now()-1E3*a),e=0;e<C.length;e++){var h=C[e];a=h[0];if(!(a<b))for(var g=2;g<h.length;g++){var q=String(h[1]);3<h.length&&(q+="_"+String(g-2));d[q]||(d[q]=q+"\n");d[q]+=String(a)+" "+h[g]+"\n"}}a="";for(q in d)a+=d[q]+"\n\n";f.log(a);C.splice(0)};a.WW=function(a){function d(a){return-1<b.indexOf(a)?!0:!1}var b=navigator.userAgent.toLowerCase();
switch(a.toLowerCase()){case "chrome":return d("mozilla")&&d("applewebkit")&&d("chrome");case "firefox":return d("mozilla")&&d("gecko")&&d("firefox");case "msie":return d("mozilla")&&d("trident")&&d("msie");case "opera":return d("opera")&&d("presto");case "safari":return d("mozilla")&&d("applewebkit")&&d("safari")&&!d("chrome");default:return!1}};a.DB=function(a){if(A.bi(a)){for(var d=0;d<a.length;d++)if(!isFinite(a[d]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.BW=function(a,d){a.constructor!=
d&&A.l("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+d+">")};a.EW=g;a.FW=function(a){v?g(a,h):v=!0;h=a};a.HC=function(a,d,b,e,h){(a=a||null)||A.l("Stage load callback is undefined");d=d||5E3;b=b||0;e=e||100;100<e&&A.l("Max percentage must be less than 100");0>b&&A.l("Min percentage must be greater than 0");b>e&&A.l("Max percentage must be greater than min percentage");var f=l.yk(b,e,d,function(d){d=d.toFixed();a(d);100==d&&(l.mq(f),h&&h())})};a.$_=function(a){return x.sN(a,
function(a,c){var d=c.type+"("+c.name+")",b=c.L,d=d+"\n\nINPUTS:";if(b.length)for(var e=0;e<b.length;e++)d+="\n"+b[e].identifier+": ",d=b[e].Yb?d+"linked":d+b[e].Ya;else d+="\n---";b=c.Sa;d+="\n\nOUTPUTS:";if(b.length)for(e=0;e<b.length;e++)d+="\n"+b[e].identifier+": ",d=b[e].Yb?d+("linked(default "+b[e].Ya+")"):d+"not used";else d+="\n---";e="";switch(c.type){case "GEOMETRY_UV":e="\nuv_layer: "+c.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":e="\ntexture: "+c.data.value.name+"\n("+
c.data.value.r_.bg+")"}""==e&&(e="\n---");return d=d+"\n\nDATA:"+e},function(d,b,e){d=x.Ra(a,d);b=x.Ra(a,b);return d.Sa[e[0]].identifier+"\n==>\n"+b.L[e[1]].identifier})};a.ha=function(){d=null}};b4w.module.__compat=function(a,n){function k(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function b(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function e(){return!window.ActiveXObject&&"ActiveXObject"in window}var y=n("__config"),g=n("__debug"),B=n("__extensions"),
w=n("__print"),t="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.kA=256;var f=y.Xi,r=y.v,l=y.context,A=y.Rl,x=y.P,L=y.r;a.BN=function(a){a.getError()==a.INVALID_ENUM&&w.warn("Possible Tegra invalid enum issue detected, ignoring")};a.XR=function(n){r.eF=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS);r.Rb=n.getParameter(n.MAX_TEXTURE_SIZE);
r.di=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE);r.ld?(r.rc=Math.min(r.rc,n.getParameter(n.MAX_SAMPLES)),k("Firefox")&&(w.warn("Firefox and WebGL 2 detected, applying framebuffer hack"),r.EB=!0)):r.rc=1;k("Firefox")&&"NONE"!==r.stereo&&(w.warn("Firefox and Stereo rendering detected, disable texture reusage"),r.JC=!0);r.ld&&g.iM()&&(r.rc=1);var F=Boolean(B.NO());k("Firefox/28.0")&&(k("Linux")||k("Macintosh"))&&(w.warn("Firefox 28 detected, applying depth hack"),F=!1);k("Windows Phone")||(k("iPad")||
k("iPhone")?(w.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound."),l.alpha||(r.background_color[3]=1),r.nI=!0,r.smaa=!1,r.Rd=!1,r.precision="highp",r.Sw=!0,A.tn=256):k("Mac OS X")&&k("Safari")&&!k("Chrome")&&(w.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),r.sG=!0,x.hB=!0,x.KB=!0));
k("Windows")&&(k("Chrome/40")||k("Firefox/33")||k("Firefox/34")||k("Firefox/35")||k("Firefox/36"))&&(w.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),r.tv=!0);k("Chrome")&&!b()&&y.uE()&&(w.warn('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),r.JB=!0);k("Mac OS X")&&(r.Hr=!0,w.warn("OS X detected, applying shadows hack."));b()&&(w.warn("Mobile detected, applying various hacks for video textures."),
r.zf=!0,k("iPad")||k("iPhone")||k("Windows Phone")||(w.warn("Mobile (not iOS) detected, disable playback rate for video textures."),x.AC=!0));(k("Firefox/35.0")||k("Firefox/36.0"))&&k("Windows")&&(w.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),r.IC=!0);if(k("iPhone")||e()||k("Edge"))w.warn("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),r.Po=!0;10>n.getParameter(n.MAX_VARYING_VECTORS)&&(w.warn("Not enough varyings, disable shadows on blend objects"),
r.Zv=!0);k("Windows Phone")&&(w.warn("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),r.debug_view=!1,r.precision="highp",r.Yg=!1,r.Rd=!1,r.smaa=!1,r.Ul=!1,r.Go=!1,r.gd=!1,r.YF=!1);if(k("UCBrowser")||k("Firefox")&&r.zf)w.warn("Mobile Firefox or UCBrowser detected, disable workers."),L.fp=!1;var J=B.GD();if(J){var C=n.getParameter(J.UNMASKED_VENDOR_WEBGL),J=n.getParameter(J.UNMASKED_RENDERER_WEBGL),H=/\b4\d{2}\b/;k("Macintosh")&&-1<
J.indexOf("Intel HD Graphics 3000")&&(w.warn("OS X / Intel HD 3000 detected, applying depth hack"),F=!1);-1<C.indexOf("ARM")&&H.test(J)&&(w.warn("ARM Mali-400 series detected, applying depth and frames blending hacks"),F=!1,f.TC=!0);-1<C.indexOf("ARM")&&-1<J.indexOf("Mali-T604")&&(w.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),r.precision="highp",r.Ul=!1);-1<C.indexOf("ARM")&&-1<J.indexOf("Mali-T760")&&(w.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),
r.precision="highp",r.Rd=!1,r.Ju=!0);-1<C.indexOf("Qualcomm")&&-1<J.indexOf("Adreno")&&(w.warn("Qualcomm Adreno detected, applying shader constants hack."),r.YG=!0,-1<J.indexOf("305")&&(w.warn('Qualcomm Adreno305 detected, set "highp" precision.'),r.precision="highp"),-1<J.indexOf("330")&&(w.warn('Qualcomm Adreno330 detected, set "highp" precision.'),r.precision="highp"),-1<J.indexOf("420")&&(w.warn("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
r.Rb=4096,r.di=4096));-1<C.indexOf("NVIDIA")&&-1<J.indexOf("Tegra 3")&&(w.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),r.lw=!0);k("Windows")&&k("Chrome")&&!k("Edge")&&(J.match(/NVIDIA GeForce 8..0/)||J.match(/NVIDIA GeForce 9..0/)||J.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(w.warn("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),r.di=a.kA,r.nG=!0);C="";for(H=0;H<t.length;H++)if(-1<
J.indexOf(t[H])){C=t[H];break}C&&(w.warn("Architecture "+C+" detected. Blending between frames and shadows on blend objects will be disabled."),r.Ju=!0,r.Zv=!0)}0==n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(w.warn("Vertex textures are not allowed. Disabling vertex textures"),r.Up=!1);F||(r.Mn=!1,r.Ic=!1,r.water_dynamic=!1,r.ti=!1,r.Ks=!1,r.smaa=!1);r.fI=Boolean(B.ID());r.Hq=F;if(n.getShaderPrecisionFormat)var K=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);n.getShaderPrecisionFormat&&
0!==K.precision||(r.precision="mediump");e()&&(w.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),A.tn=512);if(e()&&k("Touch")||k("Edge"))w.warn("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),r.lr=!0;128>=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS)&&(w.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),r.lw=!0);k("Chrome")&&!k("Edge")&&w.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called.");
if(k("Chrome")&&!k("Edge")||k("Firefox"))r.$v=!0;b()&&k("Firefox")&&(w.log("Mobile firefox detected. Applying autoplay media hack."),r.tx=!0);k("Edge")&&(w.warn("Microsoft Edge detected, set up new minimal texture size."),r.Dn=!0);k("SamsungBrowser")&&(w.warn("Default Android browser detected, setting max cubemap size to 1024, setting max texture size to 1024."),r.Rb=1024,r.di=1024)};a.qv=k;a.Xv=b;a.dL=function(){k("Firefox/35.0")&&k("Windows")&&(w.warn("Windows/Firefox 35 detected, forcing context's alpha"),
y.context.alpha=!0)};a.jo=e};b4w.module.__textures=function(a,n){function k(){return{name:"",type:0,source:"",Oy:"",width:0,height:0,yv:1,Tp:!0,ek:1024,Gn:!1,ce:null,ac:0,hb:null,Ge:null,ko:!1,Ah:-1,Ba:null,Al:0,Vg:0,pa:0,ub:0,Zk:0,kg:!1,oh:1,Qc:null,py:0,oy:0,ak:-1,qy:!1,Sl:-1,nt:!1,$T:!1,gk:!1,jt:!1,repeat:!0,Nh:!0}}function b(c,d,b,h){var f=c.type,q=new Uint8Array([204,204,204,255]),g=k();switch(f){case "DATA_TEX2D":case "IMAGE":var p=E.createTexture(),v=E.TEXTURE_2D;E.bindTexture(v,p);E.texImage2D(v,0,E.RGBA,1,1,0,E.RGBA,
E.UNSIGNED_BYTE,q);c.image&&"MOVIE"==c.image.source&&(g.ko=!0,g.pa=c.frame_start,g.ub=c.frame_offset,g.Zk=c.frame_duration,g.$T=c.use_auto_refresh,g.gk=c.use_cyclic,g.Al=c.movie_length,g.jt=c.b4w_nla_video,0!=g.ub&&m.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":p=E.createTexture();v=E.TEXTURE_2D;E.bindTexture(v,p);if("NONE"==c.b4w_source_type)return null;if("SCENE"==c.b4w_source_type)if(c.b4w_source_id&&(b=
Q.Lc("name",c.b4w_source_id,b)))g.ek=c.b4w_source_size,b.Le=b.Le||[],b.Le.push(c),E.texImage2D(v,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,q);else return null;break;case "ENVIRONMENT_MAP":p=E.createTexture();v=E.TEXTURE_CUBE_MAP;E.bindTexture(v,p);b="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var l=0;6>l;l++)E.texImage2D(E["TEXTURE_CUBE_MAP_"+b[l]],0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,q);break;case "BLEND":return null;case "NODE_TEX":p=E.createTexture();v=E.TEXTURE_2D;
E.bindTexture(v,p);E.texImage2D(v,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,q);break;default:return m.error('texture "'+c.name+'" has unsupported type "'+f+'"'),null}"NONE"==f&&(!c.b4w_enable_canvas_mipmapping||"CANVAS"!=c.b4w_source_type)||"DATA_TEX2D"==f||"IMAGE"==f&&"MOVIE"==c.image.source||"NODE_TEX"==f?E.texParameteri(v,E.TEXTURE_MIN_FILTER,E.LINEAR):E.texParameteri(v,E.TEXTURE_MIN_FILTER,oa[Z.nm]);E.texParameteri(v,E.TEXTURE_MAG_FILTER,E.LINEAR);q=v;b=c.b4w_anisotropic_filtering;"DEFAULT"===b&&
(b=d);"OFF"!==b&&Z.Vp&&(d=I.HO())&&(b=parseFloat(b.split("x")[0]),E.texParameterf(q,d.TEXTURE_MAX_ANISOTROPY_EXT,b));"REPEAT"!=c.extension||c.b4w_shore_dist_map?(g.repeat=!1,E.texParameteri(v,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE),E.texParameteri(v,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE)):(E.texParameteri(v,E.TEXTURE_WRAP_S,E.REPEAT),E.texParameteri(v,E.TEXTURE_WRAP_T,E.REPEAT));g.type=a.Ri;g.width=1;g.height=1;g.hb=p;g.ac=v;"CANVAS"==c.b4w_source_type&&"NONE"==f?(f=c.b4w_source_id,p=c.b4w_source_size,g.Gn=
c.b4w_enable_canvas_mipmapping,g.Oy=f,g.source="CANVAS",v=document.createElement("canvas"),v.width=p,v.height=p,g.ce=v.getContext("2d"),h in la||(la[h]={}),la[h][f]=g,e(g)):"SCENE"==c.b4w_source_type&&"NONE"==f?(g.Oy=c.b4w_source_id,g.source="SCENE"):(g.source=f,E.generateMipmap(v),E.bindTexture(v,null));g.name=c.name;return c.j=g}function e(a){"CANVAS"!=a.source&&Q.l("Wrong texture");var c=a.ac;E.bindTexture(c,a.hb);var d=x(a),b=L(a),e=M(a),h=a.ce.canvas;E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);E.texImage2D(c,
0,b,d,e,h);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!1);a.Gn&&E.generateMipmap(c);E.bindTexture(c,null);a.width=h.width;a.height=h.height}function y(a){var c=a.ac;E.bindTexture(c,a.hb);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Ba.length?a.kg?w(a,a.Ba,a.width*a.oh,a.height*a.oh,!1):E.texImage2D(c,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,a.Ba):E.texImage2D(c,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,a.Ba);E.bindTexture(c,null)}function g(a){var c=a.ac;E.bindTexture(c,a.hb);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);
a.kg?w(a,a.Qc[a.ak],a.width*a.oh,a.height*a.oh,!1):E.texImage2D(c,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,a.Qc[a.ak]);E.bindTexture(c,null)}function B(){ia||(ia=document.createElement("canvas"));return ia}function w(a,c,d,b,e){e||(f(E.TEXTURE_2D),E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,c));E.bindTexture(E.TEXTURE_2D,null);R.HN(a,d,b,ka,ha)}function t(a,c,d,b){for(var e=0;6>e;e++){var h=b[e],f=B();f.width=d;f.height=d;var m=f.getContext("2d");"POSITIVE_Y"==h[0]||"NEGATIVE_Y"==h[0]?(m.translate(0,
d),m.scale(1,-1)):(m.translate(d,0),m.scale(-1,1));m.drawImage(a,h[1]*c,h[2]*c,c,c,0,0,d,d);E.texImage2D(E["TEXTURE_CUBE_MAP_"+h[0]],0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,f)}}function f(a){ka||(ka=E.createFramebuffer());E.bindTexture(a,null);ha||(ha=E.createTexture());E.bindTexture(a,ha);E.texParameteri(a,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(a,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);E.texParameteri(a,E.TEXTURE_MAG_FILTER,E.LINEAR);E.texParameteri(a,E.TEXTURE_MIN_FILTER,E.LINEAR)}function r(a,c,d,
b,e){var h=a.source,g=a.hb,p=a.ac,v=1,z=1;E.bindTexture(p,g);if(4==c.length){var k=!0;c=new Uint8Array([255*c[0],255*c[1],255*c[2],255*c[3]])}if("IMAGE"==h)if(k)E.texImage2D(p,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,c),a.width=1,a.height=1;else if(d){z=q.ZD(c);k=Q.an(z.width)||Q.an(z.height);if(z.width>Z.Rb||z.height>Z.Rb){m.error('Texture "'+b+'" has unsupported size: '+z.width+"x"+z.height+". Max available: "+Z.Rb+"x"+Z.Rb+".");return}v=z.width;z=z.height;k&&(a.kg=!0,f(p),v=A(v*a.oh),z=A(z*a.oh));
q.WT(E,I.ID(),c,!0);a.kg&&(w(a,null,v,z,!0),E.bindTexture(p,g),E.generateMipmap(p));a.width=v;a.height=z;a.yv=q.LO(c)}else{E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);a.ko?Z.Po?(v=c[0].width,z=c[0].height):(v=c.videoWidth,z=c.videoHeight):(v=c.width,z=c.height);a.width=v;a.height=z;if(v>Z.Rb||v>Z.Rb)m.warn('Texture "'+b+'" has unsupported size: '+v+"x"+z+". Max available: "+Z.Rb+"x"+Z.Rb+". Reduced image size will be used."),a.oh=Math.min(Z.Rb/v,Z.Rb/z),a.kg=!0;a.ko&&(Z.Po?(e in da||(da[e]={}),da[e][a.name]=
a,a.Qc=c,a.py=c.length,a.Vg=a.oy*a.Al/c.length,c=c[0]):(e in da||(da[e]={}),da[e][a.name]=a,a.Ba=c,a.Ba.loop=a.gk,a.Vg=c.duration?a.Al/c.duration:V.Dc(),Y.AC||(c.playbackRate=V.Dc()/a.Vg,Y.KB&&2<c.playbackRate&&(c.playbackRate=2)),l(a)));v=A(a.width*a.oh);z=A(a.height*a.oh);a.kg?(b=B(),g=b.getContext("2d"),b.width=v,b.height=z,g.drawImage(c,0,0,a.width,a.height,0,0,v,z),E.texImage2D(p,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,b)):Q.an(a.width)||Q.an(a.height)?(w(a,c,v,z,!1),a.kg=!0):E.texImage2D(p,0,E.RGBA,
E.RGBA,E.UNSIGNED_BYTE,c);g=a.hb;E.bindTexture(p,g);a.ko||E.generateMipmap(p);E.bindTexture(p,null);a.width=v;a.height=z}else if("ENVIRONMENT_MAP"==h)if(v=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],k){for(b=0;6>b;b++)E.texImage2D(E["TEXTURE_CUBE_MAP_"+v[b][0]],0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,c);a.width=3;a.height=2}else{E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!1);if(c.width%3||c.height%2){m.error('Cubemap texture "'+b+'" has unsupported size: '+
c.width+"x"+c.height+". The width must be multiple of three and the height - multiple of two.");return}z=c.width/3;if(z>Z.di)m.warn('Cubemap texture "'+b+'" has unsupported size: '+c.width+"x"+c.height+". Max available: "+3*Z.di+"x"+2*Z.di+". Reduced image size will be used."),b=A(Z.di/z*z),a.kg=!0;else if(b=A(z),3*b>Z.Rb||2*b>Z.Rb)a.kg=!0;if(a.kg||Z.nG)t(c,z,b,v);else{k=c;g=b;f(E.TEXTURE_2D);E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,k);E.bindTexture(E.TEXTURE_2D,null);for(k=0;6>k;k++)E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+
k,0,E.RGBA,g,g,0,E.RGBA,E.UNSIGNED_BYTE,null);E.bindTexture(a.ac,null);E.bindFramebuffer(E.FRAMEBUFFER,ka);for(k=0;6>k;k++)R.GN(a,E.TEXTURE_CUBE_MAP_POSITIVE_X+k,g,z,ha,k);E.bindFramebuffer(E.FRAMEBUFFER,null);E.bindTexture(a.ac,a.hb);E.texParameteri(a.ac,E.TEXTURE_MIN_FILTER,oa[Z.nm]);E.texParameteri(a.ac,E.TEXTURE_MAG_FILTER,E.LINEAR)}D.fM()&&(m.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),t(c,z,u.kA,v));a.width=3*b;a.height=2*b;E.generateMipmap(p)}else if("DATA_TEX2D"==
h||"NODE_TEX"==h)E.texImage2D(p,0,E.RGBA,c.width,c.height,0,E.RGBA,E.UNSIGNED_BYTE,c.data),a.width=c.width,a.height=c.height;E.bindTexture(p,null)}function l(a){a.Ba.j0=function(){y(a)}}function A(a){return Q.an(a)?Q.S(Math.pow(2,parseInt(a).toString(2).length),2,Z.Rb):a}function x(c){var d;switch(c.type){case a.Ri:d=E.RGBA;break;case a.Qp:d=E.RGB;break;case a.Jm:d=E.RGBA;break;case a.Km:d=E.RGB;break;case a.uk:d=E.DEPTH_COMPONENT;break;default:Q.l("Wrong texture type")}return d}function L(c){var d;
switch(c.type){case a.Ri:d=Z.ld?E.RGBA8:E.RGBA;break;case a.Qp:d=Z.ld?E.RGB8:E.RGB;break;case a.Jm:d=Z.ld?E.RGBA8:E.RGBA;break;case a.Km:d=Z.ld?E.RGB8:E.RGB;break;case a.uk:d=Z.ld?E.DEPTH_COMPONENT24:E.DEPTH_COMPONENT;break;default:Q.l("Wrong texture type")}return d}function M(c){var d;switch(c.type){case a.Ri:d=E.UNSIGNED_BYTE;break;case a.Qp:d=E.UNSIGNED_BYTE;break;case a.Jm:d=E.FLOAT;break;case a.Km:d=E.FLOAT;break;case a.uk:d=E.UNSIGNED_INT;break;default:Q.l("Wrong texture type")}return d}function F(a){return a&&
a.name&&a.Ge?!0:!1}function J(a,c,d){var e=null;switch(a){case "SSAO_TEXTURE":e={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};b(e,null,c,0);e.image={filepath:null};break;case "NODE_TEX":e={name:d,type:"NODE_TEX",extension:"CLIP",b4w_anisotropic_filtering:"OFF"},b(e,null,c,0),e.image={filepath:null}}return e}function C(a,c){if(c in da&&a in da[c]){var d=da[c][a];d.Ba?d.Ba.play():d.Qc&&(d.qy=!0);return!0}return!1}function H(a,c){if(c in da&&a in da[c]){var d=
da[c][a];d.Ba?d.Ba.pause():d.Qc&&(d.qy=!1);return!0}return!1}function K(a,c){if(c in da&&a in da[c]){var d=da[c][a];d.Ba?d.Ba.currentTime=d.ub/d.Vg:d.Qc&&(d.ak=h(d,d.ub),g(d));return!0}return!1}function d(a){return a.Ba?!a.Ba.paused:a.Qc?a.qy:!1}function h(a,c){return Math.round(c*a.py/a.Al)}function v(a,c){if(X.Ha(a))return P(a,c);for(var d=a.gF,b=0;b<d.length;b++){var e=P(d[b],c);if(e)return e}return null}function P(a,c){for(var d=null,b=a.A,e=0;e<b.length;e++)for(var h=b[e].X,f=0;f<h.length;f++)for(var m=
h[f],q=0;q<m.fa.length;q++)if(m.fa[q].name==c){d=m.fa[q];break}return d}function c(a,c,d){var b=a.elements;a=a.interpolation;for(var e=0;e<c;e++){var h=e/(c-1),f=p(b,h,!0),m=N(b,h,!0);if(f&&m)if("CONSTANT"==a)d.push.apply(d,f.color);else{var q=d,g=f,v=m;g==v?q.push.apply(q,g.color):(q.push(ja.Fr(v.color[0],v.position,g.color[0],g.position,h)),q.push(ja.Fr(v.color[1],v.position,g.color[1],g.position,h)),q.push(ja.Fr(v.color[2],v.position,g.color[2],g.position,h)),q.push(ja.Fr(v.color[3],v.position,
g.color[3],g.position,h)))}m&&!f&&d.push.apply(d,m.color);f&&!m&&d.push.apply(d,f.color)}}function p(a,c,d){for(var b=null,e=0;e<a.length;e++){var h=d?c-a[e].position:c-a[e][1][0];0<=h&&(b?h<=(d?c-b.position:c-a[e][1][0])&&(b=a[e]):b=a[e])}return b}function N(a,c,d){for(var b=null,e=0;e<a.length;e++){var h=d?a[e].position-c:a[e][1][0]-c;0<=h&&(b?h<=(d?b.position-c:b[1][0]-c)&&(b=a[e]):b=a[e])}return b}function G(a,c){var d=a.texture,b=d.j,d=d.image;b&&c&&d&&r(b,c,d.Xd,d.filepath);return b}var u=n("__compat"),
z=n("__config"),q=n("__dds"),D=n("__debug"),I=n("__extensions"),m=n("__print"),V=n("__time"),Q=n("__util"),R=n("__renderer"),X=n("__obj_util"),ja=n("__curve"),W=n("__vec3"),Z=z.v,Y=z.P,ia=null,ha=null,ka=null;a.of=0;a.F=0;a.rK=0;a.pK=0;a.qK=0;a.oK=0;a.Ri=10;a.Qp=20;a.Jm=30;a.Km=40;a.uk=50;a.Op=60;a.Mp=70;a.Pp=80;a.Np=90;a.Pz=128;a.II=128;a.sA=128;var la={},da={},E=null,oa;a.xe=function(c){oa=[c.NEAREST_MIPMAP_NEAREST,c.NEAREST_MIPMAP_LINEAR,c.LINEAR_MIPMAP_NEAREST,c.LINEAR_MIPMAP_LINEAR];a.of=c.NEAREST;
a.F=c.LINEAR;a.rK=c.NEAREST_MIPMAP_NEAREST;a.pK=c.LINEAR_MIPMAP_NEAREST;a.qK=c.NEAREST_MIPMAP_LINEAR;a.oK=c.LINEAR_MIPMAP_LINEAR;E=c};a.zY=function(a,c){return c in la&&a in la[c]?la[c][a].ce:null};a.D2=function(a,c){return c in la&&a in la[c]?(e(la[c][a]),!0):!1};a.qn=function(c,d){var b=k();b.name=c;b.type=d;b.source="NONE";if(d==a.Op||d==a.Mp||d==a.Pp||d==a.Np)b.Ge=E.createRenderbuffer();else{var e=E.TEXTURE_2D,h=E.createTexture();E.bindTexture(e,h);E.texParameteri(e,E.TEXTURE_MAG_FILTER,E.LINEAR);
E.texParameteri(e,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(e,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(e,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);E.bindTexture(e,null);b.ac=e;b.hb=h}return b};a.JM=function(c){var d=E.createTexture(),b=E.TEXTURE_CUBE_MAP;E.bindTexture(b,d);E.texParameteri(b,E.TEXTURE_MAG_FILTER,E.LINEAR);E.texParameteri(b,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(b,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(b,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);for(var e="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
h=0;6>h;h++)E.texImage2D(E[e[h]],0,E.RGBA,c,c,0,E.RGBA,E.UNSIGNED_BYTE,null);E.bindTexture(b,null);b=k();b.name="CUBEMAP";b.type=a.Ri;b.source="NONE";b.width=3*c;b.height=2*c;b.yv=1;b.hb=d;b.ac=E.TEXTURE_CUBE_MAP;return b};a.vy=function(a,c,d){if(!F(a)){var b=a.ac;E.bindTexture(b,a.hb);c&&E.texParameteri(b,E.TEXTURE_MIN_FILTER,c);d&&E.texParameteri(b,E.TEXTURE_MAG_FILTER,d);E.bindTexture(b,null)}};a.OY=function(c){if(F(c))return{min:a.of,oQ:a.of};var d=c.ac;E.bindTexture(d,c.hb);c=E.getTexParameter(d,
E.TEXTURE_MIN_FILTER);var b=E.getTexParameter(d,E.TEXTURE_MAG_FILTER);E.bindTexture(d,null);return{min:c,oQ:b}};a.resize=function(c,d,b){d=Math.max(d,Z.Dn?2:1);b=Math.max(b,Z.Dn?2:1);if(c.width!=d||c.height!=b){switch(c.type){case a.Op:E.bindRenderbuffer(E.RENDERBUFFER,c.Ge);E.renderbufferStorage(E.RENDERBUFFER,E.RGB565,d,b);E.bindRenderbuffer(E.RENDERBUFFER,null);break;case a.Mp:E.bindRenderbuffer(E.RENDERBUFFER,c.Ge);E.renderbufferStorage(E.RENDERBUFFER,E.DEPTH_COMPONENT16,d,b);E.bindRenderbuffer(E.RENDERBUFFER,
null);break;case a.Pp:E.bindRenderbuffer(E.RENDERBUFFER,c.Ge);E.renderbufferStorageMultisample(E.RENDERBUFFER,Z.rc,E.RGBA8,d,b);E.bindRenderbuffer(E.RENDERBUFFER,null);break;case a.Np:E.bindRenderbuffer(E.RENDERBUFFER,c.Ge);E.renderbufferStorageMultisample(E.RENDERBUFFER,Z.rc,E.DEPTH_COMPONENT24,d,b);E.bindRenderbuffer(E.RENDERBUFFER,null);break;default:var e=c.ac;E.bindTexture(e,c.hb);var h=x(c),f=L(c),q=M(c);E.texImage2D(e,0,f,d,b,0,h,q,null);E.bindTexture(e,null)}d>Z.Rb||b>Z.Rb?m.error('Slink texture "'+
c.name+'" has unsupported size: '+d+"x"+b+". Max available: "+Z.Rb+"x"+Z.Rb+"."):(c.width=d,c.height=b)}};a.hN=b;a.dI=y;a.cI=g;a.ht=r;a.yN=function(a){E.deleteTexture(a)};a.ol=function(a){return a&&a.name&&(a.hb||a.Ge)?!0:!1};a.ll=F;a.B_=function(c){return c.type==a.Jm||c.type==a.Km?!0:!1};a.eP=function(c){var d=0;switch(c.type){case a.Ri:case a.Qp:d=4;break;case a.Jm:case a.Km:d=16;break;case a.uk:d=3;break;case a.Op:case a.Mp:d=2;break;case a.Pp:d=4*Z.rc;break;case a.Np:d=3*Z.rc}return d};a.DO=
J;a.ha=function(){if(!Z.Po)for(var a in da)for(var c in da[a])da[a][c].Ba.pause(),da[a][c].Ba.src="",da[a][c].Ba.load();la={};da={}};a.pause=function(){for(var a in da)for(var c in da[a]){var b=da[a][c];d(b)&&(H(c,a),b.nt=!0)}};a.reset=function(){for(var a in da)for(var c in da[a])K(c,a),da[a][c].nt=!1};a.play=function(a){for(var c in da)for(var d in da[c]){var b=da[c][d];if(!a||b.nt)C(d,c),b.nt=!1}};a.L2=function(a,c){return c in da&&a in da[c]?da[c][a].jt:!1};a.QF=C;a.Lx=H;a.mG=K;a.UR=function(a,
c,d){d in da&&a in da[d]&&(a=da[d][a],a.Ba?a.Ba.currentTime=c/a.Vg:a.Qc&&(a.ak=c,g(a)))};a.sI=d;a.tI=function(a){return a.Ba||a.Qc?a.Ba?2<=a.Ba.readyState:!0:0};a.pI=function(a){return a.Ba||a.Qc?a.Ba?Math.round(a.Ba.currentTime*a.Vg):a.ak:0};a.rI=function(a){return a.Ba||a.Qc?a.Ba?a.ub:h(a,a.ub):0};a.sU=function(a){if(!a.Ba&&!a.Qc)return 0;var c=Math.min(a.Zk,a.Al-a.ub);return a.Ba?a.ub+c:h(a,a.ub+c)};a.us=function(a,c){return Math.round(c*a.oy*(V.Dc()/a.Vg))};a.qI=function(a){return Math.min(a.Zk,
a.Al-a.ub)};a.rU=h;a.AY=function(a,c){var d=v(a,c);return d&&"CANVAS"==d.source?d.ce:null};a.E2=function(a,c){var d=v(a,c);return d&&"CANVAS"==d.source?(e(d),!0):!1};a.CS=function(a){for(var c={},d=0;d<a.length;d++){for(var b=a[d].fa,h=[],f=0;f<b.length;f++){var m=b[f];if("CANVAS"==m.source)if(m.name in c)m=c[m.name];else{var q=b[f],m=k();m.name=q.name;m.source="CANVAS";m.width=q.width;m.height=q.height;m.Gn=q.Gn;m.type=q.type;q=document.createElement("canvas");q.width=m.width;q.height=m.height;m.ce=
q.getContext("2d");m.ac=E.TEXTURE_2D;m.hb=E.createTexture();E.bindTexture(E.TEXTURE_2D,m.hb);m.Gn?E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,oa[Z.nm]):E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR);E.bindTexture(E.TEXTURE_2D,null);q=m;q.ce.drawImage(b[f].ce.canvas,0,0);e(q);c[m.name]=m}h.push(m)}a[d].fa=h}};a.HM=function(a,d){for(var b=[],e=0;e<a.length;e++)c(a[e].data.value.color_ramp,d,b);return new Uint8Array(b.map(function(a){return Q.S(255*
a,0,255)}))};a.IL=c;a.jN=function(a,c){for(var d=new Float32Array(3),b=new Float32Array(3),e=[],h=0;h<a.length;h++){for(var f=a[h].data.value,m=[],q=f.curve_mapping.curves_data,g=f.curve_mapping.curve_extend,v=f.curve_mapping.curves_handle_types,f=0;f<q.length;f++){for(var l=g[f],z=q[f],u=[],k=v[f],r=0;r<z.length;r++)u.push([new Float32Array(3),new Float32Array(z[r].concat(0)),new Float32Array(3)]);ja.jv(u[0],null,u[1],k[0],k[0]);for(r=1;r<u.length-1;r++)ja.jv(u[r],u[r-1],u[r+1],k[r],k[r]);ja.jv(u[u.length-
1],u[u.length-2],null,k[u.length-1],k[u.length-1]);if(2<u.length){if("AUTO"==k[0]){W.subtract(u[0][2],u[0][1],d);r=W.length(d);W.copy(u[1][0],b);b[0]<u[0][1][0]&&(b[0]=u[0][1][0]);W.subtract(b,u[0][1],b);var G=W.length(b);1E-8<G&&(W.scale(b,r/G,b),W.add(u[0][1],b,u[0][2]),W.subtract(u[0][1],b,u[0][0]))}z=u.length-1;"AUTO"==k[0]&&(W.subtract(u[z][0],u[z][1],d),r=W.length(d),W.copy(u[z-1][2],b),b[0]>u[z][1][0]&&(b[0]=u[z][1][0]),W.subtract(b,u[z][1],b),G=W.length(b),1E-8<G&&(W.scale(b,r/G,b),W.add(u[z][1],
b,u[z][0]),W.subtract(u[z][1],b,u[z][2])))}for(z=0;z<u.length-1;z++)ja.BM(u[z][1],u[z][2],u[z+1][0],u[z+1][1]);z=[];3>=q.length?(r=Math.round(-c/2),k=Math.round(c/2)):(r=0,k=c);for(;r<k;r++){var G=r/(k-1),D=p(u,G,!1),A=N(u,G,!1);D&&A?z.push(ja.kB(G,D[1],D[2],A[0],A[1],.001)):A&&!D?"EXTRAPOLATED"==l?(G=A[1][0]==A[2][0]?A[1][1]:ja.UE(G,A[1],A[2]),z.push(G)):z.push(A[1][1]):D&&!A&&("EXTRAPOLATED"==l?(G=D[0][0]==D[1][0]?D[1][1]:ja.UE(G,D[0],D[1]),z.push(G)):z.push(D[1][1]))}m.push(z)}e.push(m)}d=[];for(r=
0;r<e.length;r++)for(m=e[r],f=0;f<m[0].length;f++)3>=m.length?(b=Q.S(127.5*(m[0][f]+1),0,255),h=Q.S(127.5*(m[1][f]+1),0,255),q=Q.S(127.5*(m[2][f]+1),0,255),z=255):(b=Q.S(255*m[0][f],0,255),h=Q.S(255*m[1][f],0,255),q=Q.S(255*m[2][f],0,255),z=Q.S(255*m[3][f],0,255)),d.push(b,h,q,z);return new Uint8Array(d)};a.RW=function(a,c,d){return(a=v(a,c))?(r(a,d,!1,d.src,0),!0):!1};a.Cc=G;a.$C=function(a,c){var d={texture:J("NODE_TEX",null)};return G(d,{width:c,height:a.length/(4*c),data:a})}};b4w.module.__dds=function(a,n){function k(a,b,e,f){var g=new Uint16Array(4),k=new Uint16Array(e*f),t=0,n=0,w=0,B=n=t=0,K=0,d=0,h=0,v=e/4;f/=4;for(var P=0;P<f;P++)for(var c=0;c<v;c++)w=b+4*(P*v+c),g[0]=a[w],g[1]=a[w+1],t=g[0]&31,n=g[0]&2016,B=g[0]&63488,K=g[1]&31,d=g[1]&2016,h=g[1]&63488,g[2]=5*t+3*K>>3|5*n+3*d>>3&2016|5*B+3*h>>3&63488,g[3]=5*K+3*t>>3|5*d+3*n>>3&2016|5*h+3*B>>3&63488,t=a[w+2],n=4*P*e+4*c,k[n]=g[t&3],k[n+1]=g[t>>2&3],k[n+2]=g[t>>4&3],k[n+3]=g[t>>6&3],n+=e,k[n]=g[t>>8&3],k[n+1]=g[t>>
10&3],k[n+2]=g[t>>12&3],k[n+3]=g[t>>14],t=a[w+3],n+=e,k[n]=g[t&3],k[n+1]=g[t>>2&3],k[n+2]=g[t>>4&3],k[n+3]=g[t>>6&3],n+=e,k[n]=g[t>>8&3],k[n+1]=g[t>>10&3],k[n+2]=g[t>>12&3],k[n+3]=g[t>>14];return k}function b(a,b,e,x){var n=new Int32Array(e,0,31),y,F,J,C,H,K;if(542327876!=n[0])return B.error("Invalid magic number in DDS header"),0;if(!n[20]&4)return B.error("Unsupported format, must contain a FourCC code"),0;y=n[21];switch(y){case w:F=8;J=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case t:F=16;J=
b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case f:F=16;J=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return B.error("Unsupported FourCC code:",g(y)),null}K=1;n[2]&131072&&!1!==x&&(K=Math.max(1,n[7]));C=n[4];H=n[3];n=n[1]+4;if(b)for(y=0;y<K;++y)x=Math.max(4,C)/4*Math.max(4,H)/4*F,b=new Uint8Array(e,n,x),a.compressedTexImage2D(a.TEXTURE_2D,y,J,C,H,0,b),n+=x,C=Math.max(.5*C,1),H=Math.max(.5*H,1);else if(y==w)Math.max(4,C),Math.max(4,H),b=new Uint16Array(e),e=k(b,n/2,C,H),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,C,H,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,e),x&&a.generateMipmap(a.TEXTURE_2D);else return B.error("No manual decoder for",g(y),"and no native support"),0;return K}function e(a,e,f,g,k,t){var n=new XMLHttpRequest;n.open("GET",f,!0);n.responseType="arraybuffer";n.onload=function(){if(200==n.status){a.bindTexture(a.TEXTURE_2D,g);var f=b(a,e,n.response,k);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<f?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}t&&
t(g)};n.send(null);return g}function y(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function g(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var B=n("__print"),w=y("DXT1"),t=y("DXT3"),f=y("DXT5");a.KX=k;a.WT=b;a.ZD=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.LO=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case w:b=6;break;case t:case f:b=4;break;default:B.error("Unsupported FourCC code:",g(a))}return b};
a.R_=e;a.Q_=function(a,b,f,g){var k=a.createTexture();e(a,b,f,k,!0,g);return k}};b4w.module.__time=function(a,n){function k(){return-1!==b.Xi.Sq?b.Xi.Sq:f}var b=n("__config");n("__print");var e=0,y=0,g=[],B=0,w=0,t=[],f=-1;a.SG=function(a){e=a;y=performance.now();for(a=0;a<g.length;a++){var b=g[a];e>b.gw&&(g.splice(a,1),a--,b.callback())}for(a=0;a<t.length;a++){var b=t[a],f=1-(b.gw-e)/b.duration,f=Math.min(f,1);b.callback(b.from+f*(b.to-b.from));1==f&&(t.splice(a,1),a--)}};a.Xn=function(){return e};a.TG=function(a,b){var f;B++;f=B;g.push({id:f,callback:a,gw:e+(performance.now()-
y+b)/1E3});return f};a.oq=function(a){for(var b=0;b<g.length;b++)if(g[b].id==a){g.splice(b,1);break}};a.mq=function(a){for(var b=t.length;b--;)if(t[b].id==a){t.splice(b,1);break}};a.yk=function(a,b,f,g){f/=1E3;var k;w++;k=w;t.push({id:k,callback:g,from:a,to:b,gw:e+f,duration:f});g(a);return k};a.reset=function(){y=e=0;g.length=0;w=B=t.length=0};a.Dc=k;a.VR=function(a){f=a};a.Vn=function(a){return a*k()}};b4w.module.__renderer=function(a,n){function k(a){for(var b=a.k,l=a.D,c=0;c<l.length;c++){var p=l[c];if(p.ec){var k=p.lg,p=p.G;f.sR(p);f.AE()&&"DEBUG_VIEW"==p.type&&(p.Tv=A.lc(B.tL(p.Eq),p.Tv,1,15));var r=a,u=b,z=k,q=p,D=q.rb;C.useProgram(D.Pl);for(var k=q.oa,x=q.aq,m=D.SH,t=m.length;t--;){var n=m[t];n.qw(C,n.Hj,r,z,q,u)}if(D.Pr&&!D.Ax){D.zo.length||g(D);m=D.zo;for(t=m.length;t--;)n=m[t],n.qw(C,n.Hj,r,z,q,u);D.Pr=!1}C.depthMask(q.Ka);q.Db?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE);u=q.fa;for(q=
0;q<u.length;q++)t=u[q],C.activeTexture(C.TEXTURE0+q),C.bindTexture(t.ac,t.hb);if("SKY"==r.type){u=r;D=D.fk;q=u.k.Wb.hb;t=u.gj;for(n=0;6>n;n++)if(m=y(n),d.tv?(C.bindTexture(C.TEXTURE_CUBE_MAP,q),C.texImage2D(m,0,C.RGBA,1,1,0,C.RGBA,C.UNSIGNED_BYTE,J)):(C.uniformMatrix4fv(D.u_cube_view_matrix,!1,t[n]),C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,m,q,0),e(k,x,z.sz)),u.Nr&&3!=n){var m=u,w=n,H=K;d.tv?H.set(J):(C.readPixels(191,191,1,1,C.RGBA,C.UNSIGNED_BYTE,H),255!=H[0]&&255!=H[1]&&255!=H[2]||
C.readPixels(191,220,1,1,C.RGBA,C.UNSIGNED_BYTE,H));var F=H[0],L=H[1],H=H[2],F=F/255,L=L/255,H=H/255;2===w?(m.fe[3]=F,m.fe[7]=L,m.fe[11]=H):2>w?(m.fe[4*w]=F,m.fe[4*w+1]=L,m.fe[4*w+2]=H):(m.fe[4*(w-2)]=F,m.fe[4*(w-2)+1]=L,m.fe[4*(w-2)+2]=H)}r.un+=6}else e(k,x,z.sz),r.un++;f.tR(p);f.AE()&&"MAIN"==p.type&&B.uL(p.id,p.tf)}}}function b(a){if(a){var b=(a.Xa?C.COLOR_BUFFER_BIT:0)|(a.Za?C.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=F;break;case "SHADOW_CAST":a=x;break;case "SHADOW_RECEIVE":a=
L;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=M;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=F;break;default:a=d.background_color}}else b=C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT,a=d.background_color;C.colorMask(!0,!0,!0,!0);C.depthMask(!0);C.clearColor(a[0],a[1],a[2],a[3]);C.clear(b)}function e(a,d,b){C.bindBuffer(C.ARRAY_BUFFER,a.Fi);for(var c=0;c<d.length;c++){var e=d[c];C.enableVertexAttribArray(e.Hj);C.vertexAttribPointer(e.Hj,
e.ih,C.FLOAT,!1,0,e.sL+e.kO*b)}a.Zg?(C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,a.Zg),C.drawElements(a.mode,a.count,a.Qw,0)):C.drawArrays(a.mode,0,a.count);for(c=0;c<d.length;c++)e=d[c],C.disableVertexAttribArray(e.Hj)}function y(a){switch(a){case 0:return C.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return C.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return C.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return C.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return C.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return C.TEXTURE_CUBE_MAP_NEGATIVE_Z}}
function g(a){var d=a.fk,b=[],c=[],e={},f;for(f in d){var g=!1;switch(f){case "u_proj_matrix":var u=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.Bb)},g=!0;break;case "u_view_matrix":u=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.nb)};g=!0;break;case "u_view_tsr":case "u_view_tsr_frag":u=function(a,c,d,b,e,h){h.jc?a.uniformMatrix3fv(c,!1,h.Yx):a.uniformMatrix3fv(c,!1,h.jf)};g=!0;break;case "u_view_zup_tsr":u=function(a,c,d,b,e,h){h.jc?a.uniformMatrix3fv(c,!1,h.Zx):a.uniformMatrix3fv(c,!1,h.wz)};
g=!0;break;case "u_view_zup_tsr_inverse":u=function(a,c,d,b,e,h){h.jc?a.uniformMatrix3fv(c,!1,h.gG):a.uniformMatrix3fv(c,!1,h.uI)};g=!0;break;case "u_shadow_cast_billboard_view_tsr":u=function(a,c,d,b,e,h){a.uniformMatrix3fv(c,!1,h.Gy)};g=!0;break;case "u_view_proj_prev":u=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.eR)};g=!0;break;case "u_view_proj_matrix":u=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.Qf)};g=!0;break;case "u_view_proj_inverse":u=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,
!1,h.vI)};g=!0;break;case "u_sky_vp_inverse":u=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.sg)};g=!0;break;case "u_camera_eye":case "u_camera_eye_frag":u=function(a,c,d,b,e,h){a.uniform3fv(c,l.Vh(h.i,H))};g=!0;break;case "u_camera_quat":u=function(a,c,d,b,e,h){a.uniform4fv(c,l.B(h.i))};g=!0;break;case "u_view_max_depth":u=function(a,c,d,b,e,h){a.uniform1f(c,h.far)};g=!0;break;case "u_camera_range":u=function(a,c,d,b,e,h){a.uniform2f(c,h.near,h.far)};break;case "u_csm_center_dists":u=function(a,
c,d,b,e,h){a.uniform4fv(c,h.lC)};break;case "u_cam_water_depth":u=function(a,c,d){a.uniform1f(c,d.lv)};g=!0;break;case "u_waves_height":u=function(a,c,d){a.uniform1f(c,d.zz)};break;case "u_waves_length":u=function(a,c,d){a.uniform1f(c,d.Az)};break;case "u_fog_color_density":u=function(a,c,d){a.uniform4fv(c,d.od)};break;case "u_fog_params":u=function(a,c,d){a.uniform4fv(c,d.Te)};break;case "u_underwater_fog_color_density":u=function(a,c,d){a.uniform4fv(c,d.Rf)};break;case "u_bloom_key":u=function(a,
c,d){a.uniform1f(c,d.bloom_key)};break;case "u_bloom_edge_lum":u=function(a,c,d){a.uniform1f(c,d.bloom_edge_lum)};break;case "u_time":u=function(a,c,d){a.uniform1f(c,d.time)};g=!0;break;case "u_wind":u=function(a,c,d){a.uniform3fv(c,d.Bh)};g=!0;break;case "u_sky_tex_dvar":u=function(a,c,d){a.uniform1f(c,d.cH)};break;case "u_sky_tex_fac":u=function(a,c,d){a.uniform4fv(c,d.dH)};break;case "u_sky_tex_color":u=function(a,c,d){a.uniform3fv(c,d.bH)};break;case "u_horizon_color":u=function(a,c,d){a.uniform3fv(c,
d.ne)};break;case "u_zenith_color":u=function(a,c,d){a.uniform3fv(c,d.Je)};break;case "u_environment_energy":u=function(a,c,d){a.uniform1f(c,d.Sg)};break;case "u_sky_color":u=function(a,c,d){a.uniform3fv(c,d.Xl)};break;case "u_rayleigh_brightness":u=function(a,c,d){a.uniform1f(c,d.rayleigh_brightness)};break;case "u_mie_brightness":u=function(a,c,d){a.uniform1f(c,d.mie_brightness)};break;case "u_spot_brightness":u=function(a,c,d){a.uniform1f(c,d.spot_brightness)};break;case "u_scatter_strength":u=
function(a,c,d){a.uniform1f(c,d.scatter_strength)};break;case "u_rayleigh_strength":u=function(a,c,d){a.uniform1f(c,d.rayleigh_strength)};break;case "u_mie_strength":u=function(a,c,d){a.uniform1f(c,d.mie_strength)};break;case "u_rayleigh_collection_power":u=function(a,c,d){a.uniform1f(c,d.rayleigh_collection_power)};break;case "u_mie_collection_power":u=function(a,c,d){a.uniform1f(c,d.mie_collection_power)};break;case "u_mie_distribution":u=function(a,c,d){a.uniform1f(c,d.mie_distribution)};break;
case "u_light_positions":u=function(a,c,d){a.uniform3fv(c,d.Er)};break;case "u_light_directions":u=function(a,c,d){a.uniform3fv(c,d.hx)};break;case "u_light_color_intensities":u=function(a,c,d){a.uniform3fv(c,d.Dr)};break;case "u_light_factors":u=function(a,c,d){a.uniform4fv(c,d.ix)};break;case "u_sun_quaternion":u=function(a,c,d){a.uniform4fv(c,d.uH)};break;case "u_sun_intensity":u=function(a,c,d){a.uniform3fv(c,d.tH)};break;case "u_sun_direction":u=function(a,c,d){a.uniform3fv(c,d.Xy)};break;case "u_height":u=
function(a,c,d,b,e,h){a.uniform1f(c,h.height)};g=!0;break;case "u_model_tsr":u=function(a,c,d,b){a.uniformMatrix3fv(c,!1,b.i)};g=!0;break;case "u_model_zup_tsr":u=function(a,c,d,b){a.uniformMatrix3fv(c,!1,b.Fz)};g=!0;break;case "u_model_zup_tsr_inverse":u=function(a,c,d,b){a.uniformMatrix3fv(c,!1,b.EI)};g=!0;break;case "u_transb":u=function(a,c,d,b){a.uniform4fv(c,b.Td)};g=!0;break;case "u_transa":u=function(a,c,d,b){a.uniform4fv(c,b.Ee)};g=!0;break;case "u_arm_rel_trans":u=function(a,c,d,b){a.uniform4fv(c,
b.Tu)};g=!0;break;case "u_arm_rel_quat":u=function(a,c,d,b){a.uniform4fv(c,b.Su)};g=!0;break;case "u_quat":u=function(a,c,d,b){a.uniform4fv(c,l.B(b.i))};g=!0;break;case "u_quatsb":u=function(a,c,d,b){a.uniform4fv(c,b.Kd)};g=!0;break;case "u_quatsa":u=function(a,c,d,b){a.uniform4fv(c,b.te)};g=!0;break;case "u_frame_factor":u=function(a,c,d,b){a.uniform1f(c,b.Ue)};g=!0;break;case "au_center_pos":u=function(){};g=!0;break;case "au_wind_bending_amp":u=function(a,c,d,b){a.uniform1f(c,b.zg)};g=!0;break;
case "au_wind_bending_freq":u=function(a,c,d,b){a.uniform1f(c,b.Ch)};g=!0;break;case "au_detail_bending_freq":u=function(a,c,d,b){a.uniform1f(c,b.Pg)};g=!0;break;case "au_detail_bending_amp":u=function(a,c,d,b){a.uniform1f(c,b.Og)};g=!0;break;case "au_branch_bending_amp":u=function(a,c,d,b){a.uniform1f(c,b.Hg)};g=!0;break;case "u_node_values":u=function(a,c,d,b,e){a.uniform1fv(c,e.Nj)};g=!0;break;case "u_node_rgbs":u=function(a,c,d,b,e){a.uniform3fv(c,e.qe)};g=!0;break;case "u_diffuse_color":u=function(a,
c,d,b,e){a.uniform4fv(c,e.uf)};g=!0;break;case "u_diffuse_intensity":u=function(a,c,d,b,e){a.uniform1f(c,e.xn)};g=!0;break;case "u_diffuse_params":u=function(a,c,d,b,e){a.uniform2fv(c,e.ie)};g=!0;break;case "u_emit":u=function(a,c,d,b,e){a.uniform1f(c,e.Tk)};g=!0;break;case "u_ambient":u=function(a,c,d,b,e){a.uniform1f(c,e.xk)};g=!0;break;case "u_specular_color":u=function(a,c,d,b,e){a.uniform3fv(c,e.Uo)};g=!0;break;case "u_specular_alpha":u=function(a,c,d,b,e){a.uniform1f(c,e.Py)};g=!0;break;case "u_specular_params":u=
function(a,c,d,b,e){a.uniform3fv(c,e.Zl)};g=!0;break;case "u_reflect_factor":u=function(a,c,d,b,e){a.uniform1f(c,e.os)};g=!0;break;case "u_mirror_factor":u=function(a,c,d,b,e){a.uniform1f(c,e.sx)};g=!0;break;case "u_grass_map_dim":u=function(a,c,d,b,e){a.uniform3fv(c,e.Cd)};g=!0;break;case "u_grass_size":u=function(a,c,d,b,e){a.uniform1f(c,e.Jw)};g=!0;break;case "u_scale_threshold":u=function(a,c,d,b,e){a.uniform1f(c,e.aE)};g=!0;break;case "u_cube_fog":u=function(a,c,d,b,e){a.uniformMatrix4fv(c,!1,
e.fe)};break;case "u_jitter_amp":u=function(a,c,d,b,e){a.uniform1f(c,e.GE)};g=!0;break;case "u_jitter_freq":u=function(a,c,d,b,e){a.uniform1f(c,e.HE)};g=!0;break;case "u_debug_view_mode":u=function(a,c,d){a.uniform1i(c,d.debug_view_mode)};break;case "u_debug_colors_seed":u=function(a,c,d){a.uniform1f(c,d.debug_colors_seed)};break;case "u_debug_render_time_threshold":u=function(a,c,d){a.uniform1f(c,d.rC)};break;case "u_wireframe_edge_color":u=function(a,c,d,b,e){a.uniform3fv(c,e.wireframe_edge_color)};
break;case "u_cluster_id":u=function(a,c,d,b,e){a.uniform1f(c,e.en)};g=!0;break;case "u_batch_debug_id_color":u=function(a,c,d,b,e){a.uniform1f(c,e.qC)};g=!0;break;case "u_batch_debug_main_render_time":u=function(a,c,d,b,e){a.uniform1f(c,e.Tv)};g=!0;break;case "u_subpixel_jitter":u=function(a,c,d){a.uniform2fv(c,d.MP)};g=!0;break;case "u_subsample_indices":u=function(a,c,d){a.uniform4fv(c,d.NP)};g=!0;break;case "u_refr_bump":u=function(a,c,d,b,e){a.uniform1f(c,e.iG)};g=!0;break;case "u_line_width":u=
function(a,c,d,b,e){a.uniform1f(c,e.TE)};g=!0;break;case "u_lamp_light_positions":u=function(a,c,d,b,e){a.uniform3fv(c,e.dx)};break;case "u_lamp_light_directions":u=function(a,c,d,b,e){a.uniform3fv(c,e.bx)};break;case "u_lamp_light_color_intensities":u=function(a,c,d,b,e){a.uniform3fv(c,e.ax)};break;case "u_lamp_light_factors":u=function(a,c,d,b,e){a.uniform4fv(c,e.cx)};break;case "u_halo_size":u=function(a,c,d,b,e){a.uniform1f(c,e.hE)};g=!0;break;case "u_halo_hardness":u=function(a,c,d,b,e){a.uniform1f(c,
e.eE)};g=!0;break;case "u_halo_rings_color":u=function(a,c,d,b,e){a.uniform3fv(c,e.gE)};g=!0;break;case "u_halo_lines_color":u=function(a,c,d,b,e){a.uniform3fv(c,e.fE)};g=!0;break;case "u_halo_stars_blend":u=function(a,c,d,b,e){a.uniform1f(c,e.iE)};g=!0;break;case "u_halo_stars_height":u=function(a,c,d,b,e){a.uniform1f(c,e.jE)};g=!0;break;case "u_fresnel_params":u=function(a,c,d,b,e){a.uniform4fv(c,e.qj)};g=!0;break;case "u_texture_scale":u=function(a,c,d,b,e){a.uniform3fv(c,e.zi)};g=!0;break;case "u_parallax_scale":u=
function(a,c,d,b,e){a.uniform1f(c,e.Yr)};g=!0;break;case "u_color_id":u=function(a,c,d,b){a.uniform3fv(c,b.rq)};g=!0;break;case "u_line_points":u=function(a,c,d,b,e){a.uniform3fv(c,e.N_)};g=!0;break;case "u_diffuse_color_factor":u=function(a,c,d,b,e){a.uniform1f(c,e.wn)};g=!0;break;case "u_alpha_factor":u=function(a,c,d,b,e){a.uniform1f(c,e.Mm)};g=!0;break;case "u_specular_color_factor":u=function(a,c,d,b,e){a.uniform1f(c,e.Rs)};g=!0;break;case "u_normal_factor":u=function(a,c,d,b,e){a.uniform1f(c,
e.vF)};g=!0;break;case "u_normalmap0_scale":u=function(a,c,d,b,e){a.uniform2fv(c,e.Oj[0])};g=!0;break;case "u_normalmap1_scale":u=function(a,c,d,b,e){a.uniform2fv(c,e.Oj[1])};g=!0;break;case "u_normalmap2_scale":u=function(a,c,d,b,e){a.uniform2fv(c,e.Oj[2])};g=!0;break;case "u_normalmap3_scale":u=function(a,c,d,b,e){a.uniform2fv(c,e.Oj[3])};g=!0;break;case "u_foam_factor":u=function(a,c,d,b,e){a.uniform1f(c,e.Rq)};g=!0;break;case "u_foam_uv_freq":u=function(a,c,d,b,e){a.uniform2fv(c,e.LC)};g=!0;break;
case "u_foam_mag":u=function(a,c,d,b,e){a.uniform2fv(c,e.KC)};g=!0;break;case "u_foam_scale":u=function(a,c,d,b,e){a.uniform2fv(c,e.kw)};g=!0;break;case "u_water_norm_uv_velocity":u=function(a,c,d,b,e){a.uniform1f(c,e.pt)};g=!0;break;case "u_shallow_water_col":u=function(a,c,d,b,e){a.uniform3fv(c,e.Hs)};g=!0;break;case "u_shore_water_col":u=function(a,c,d,b,e){a.uniform3fv(c,e.Ls)};g=!0;break;case "u_water_shallow_col_fac":u=function(a,c,d,b,e){a.uniform1f(c,e.Is)};g=!0;break;case "u_water_shore_col_fac":u=
function(a,c,d,b,e){a.uniform1f(c,e.Ms)};g=!0;break;case "u_p_length":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.EH)};g=!0;break;case "u_p_cyclic":u=function(a,c,d,b,e){a.uniform1i(c,e.Qa.nd)};g=!0;break;case "u_p_max_lifetime":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.SE)};g=!0;break;case "u_p_fade_in":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.nj)};g=!0;break;case "u_p_fade_out":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.ke)};g=!0;break;case "u_p_size":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.size)};g=
!0;break;case "u_p_alpha_start":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.XA)};g=!0;break;case "u_p_alpha_end":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.WA)};g=!0;break;case "u_p_nfactor":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.zx)};g=!0;break;case "u_p_gravity":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.bE)};g=!0;break;case "u_p_mass":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.jg)};g=!0;break;case "u_p_color_ramp":u=function(a,c,d,b,e){a.uniform4fv(c,e.Qa.QB)};g=!0;break;case "u_p_wind_fac":u=function(a,
c,d,b,e){a.uniform1f(c,e.Qa.BI)};g=!0;break;case "u_texel_size":u=function(a,c,d){a.uniform2fv(c,d.fz)};g=!0;break;case "u_p_time":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.time)};g=!0;break;case "u_p_tilt":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.CH)};g=!0;break;case "u_p_tilt_rand":u=function(a,c,d,b,e){a.uniform1f(c,e.Qa.DH)};g=!0;break;case "u_position":u=function(a,c,d,b,e){a.uniform3fv(c,e.Ml)};g=!0;break;case "u_va_frame_factor":u=function(a,c,d,b){a.uniform1f(c,b.iI)};g=!0;break;case "u_normal_offset":u=
function(a,c,d){a.uniform1f(c,d.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":u=function(a,c,d,b,e,h){a.uniform4fv(c,h.cs)};break;case "u_v_light_ts":u=function(a,c,d){a.uniform4fv(c,d.mt)};g=!0;break;case "u_v_light_r":u=function(a,c,d){a.uniform4fv(c,d.lt)};g=!0;break;case "u_v_light_tsr":u=function(a,c,d){a.uniformMatrix3fv(c,!1,d.rz)};g=!0;break;case "u_p_light_matrix0":u=function(a,c,d){a.uniformMatrix4fv(c,!1,d.Tj[0])};g=!0;break;case "u_p_light_matrix1":u=function(a,c,d){a.uniformMatrix4fv(c,
!1,d.Tj[1])};g=!0;break;case "u_p_light_matrix2":u=function(a,c,d){a.uniformMatrix4fv(c,!1,d.Tj[2])};g=!0;break;case "u_p_light_matrix3":u=function(a,c,d){a.uniformMatrix4fv(c,!1,d.Tj[3])};g=!0;break;case "u_motion_blur_exp":u=function(a,c,d){a.uniform1f(c,d.hF)};g=!0;break;case "u_motion_blur_decay_threshold":u=function(a,c,d){a.uniform1f(c,d.mb_decay_threshold)};g=!0;break;case "u_refl_plane":u=function(a,c,d,b){a.uniform4fv(c,b.jc)};g=!0;break;case "u_radial_blur_step":u=function(a,c,d){a.uniform1f(c,
d.ns)};break;case "u_god_rays_intensity":u=function(a,c,d){a.uniform1f(c,d.god_rays_intensity)};break;case "u_ssao_radius_increase":u=function(a,c,d){a.uniform1f(c,d.dm)};break;case "u_ssao_blur_discard_value":u=function(a,c,d){a.uniform1f(c,d.ssao_blur_discard_value)};g=!0;break;case "u_ssao_influence":u=function(a,c,d){a.uniform1f(c,d.cm)};break;case "u_ssao_dist_factor":u=function(a,c,d){a.uniform1f(c,d.bm)};break;case "u_dof_dist":u=function(a,c,d,b,e,h){h.dof_on?a.uniform1f(c,h.dof_distance):
a.uniform1f(c,0)};g=!0;break;case "u_dof_front":u=function(a,c,d,b,e,h){a.uniform1f(c,h.dof_front)};g=!0;break;case "u_dof_rear":u=function(a,c,d,b,e,h){a.uniform1f(c,h.dof_rear)};g=!0;break;case "u_outline_intensity":u=function(a,c,d,b){a.uniform1f(c,b.kh)};g=!0;break;case "u_outline_color":u=function(a,c,d){a.uniform3fv(c,d.jh)};break;case "u_draw_outline":u=function(a,c,d){a.uniform1f(c,d.dw)};g=!0;break;case "u_glow_mask_small_coeff":u=function(a,c,d){a.uniform1f(c,d.small_glow_mask_coeff)};g=
!0;break;case "u_glow_mask_large_coeff":u=function(a,c,d){a.uniform1f(c,d.large_glow_mask_coeff)};g=!0;break;case "u_brightness":u=function(a,c,d){a.uniform1f(c,d.brightness)};break;case "u_contrast":u=function(a,c,d){a.uniform1f(c,d.contrast)};break;case "u_exposure":u=function(a,c,d){a.uniform1f(c,d.exposure)};break;case "u_saturation":u=function(a,c,d){a.uniform1f(c,d.saturation)};break;case "u_enable_hmd_stereo":u=function(a,c,d){a.uniform1i(c,d.enable_hmd_stereo)};break;case "u_distortion_params":u=
function(a,c,d){a.uniform4fv(c,d.jj)};break;case "u_chromatic_aberration_coefs":u=function(a,c,d){a.uniform4fv(c,d.chromatic_aberration_coefs)};break;default:u=null}u&&(u={name:f,qw:u,Hj:d[f]},g?b.push(u):(c.push(u),e[f]=u))}a.SH=b;c.length?(a.zo=c,a.Mx=e):a.Ax=!0}var B=n("__batch"),w=n("__camera"),t=n("__config"),f=n("__debug"),r=n("__textures"),l=n("__tsr"),A=n("__util"),x=[1,1,1,1],L=[1,1,1,1],M=[0,0,0,1],F=[0,0,0,0],J=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,
.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var C=null,H=new Float32Array(3),K=new Uint8Array(4);new Float32Array(9);new Float32Array(8);var d=t.v;a.xe=function(a){var b=d.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);C=a};a.Sk=function(a){if(a.ec)if("RESOLVE"==a.type){f.dy(a);var e=a.k;C.bindFramebuffer(C.READ_FRAMEBUFFER,
e.ow);C.bindFramebuffer(C.DRAW_FRAMEBUFFER,e.Ve);var g=0;e.Wb&&(g|=C.COLOR_BUFFER_BIT);e.he&&(g|=C.DEPTH_BUFFER_BIT);C.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,g,C.NEAREST);f.ey(a);f.pv("draw resolve")}else if("COPY"==a.type)f.dy(a),e=a.k,C.bindFramebuffer(C.FRAMEBUFFER,e.ow),C.bindTexture(C.TEXTURE_2D,e.Wb.hb),C.copyTexSubImage2D(C.TEXTURE_2D,0,0,0,0,0,e.width,e.height,0),f.ey(a),f.pv("draw copy");else{f.dy(a);e=a.k;C.bindFramebuffer(C.FRAMEBUFFER,e.Ve);a.Uu&&(g=e.Wb,C.framebufferTexture2D(C.FRAMEBUFFER,
C.COLOR_ATTACHMENT0,g.ac,g.hb,0));C.viewport(0,0,e.width,e.height);"MAIN_CUBE_REFLECT"!=a.type&&"MAIN_CUBE_REFLECT_BLEND"!=a.type&&b(a);a.eb?C.enable(C.BLEND):C.disable(C.BLEND);a.Zc?C.enable(C.DEPTH_TEST):C.disable(C.DEPTH_TEST);switch(a.type){case "SHADOW_CAST":C.enable(C.POLYGON_OFFSET_FILL);C.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);C.cullFace(C.BACK);break;case "MAIN_PLANE_REFLECT":case "MAIN_PLANE_REFLECT_BLEND":C.disable(C.POLYGON_OFFSET_FILL);C.cullFace(C.FRONT);
break;case "DEBUG_VIEW":C.enable(C.POLYGON_OFFSET_FILL);C.polygonOffset(-4,-4);C.cullFace(C.BACK);break;case "MAIN_GLOW":if(1<d.rc){C.enable(C.POLYGON_OFFSET_FILL);C.polygonOffset(-2,-2);break}default:C.disable(C.POLYGON_OFFSET_FILL),C.cullFace(C.BACK)}if("MAIN_CUBE_REFLECT"==a.type||"MAIN_CUBE_REFLECT_BLEND"==a.type)for(var e=a.k,g=e.Wb.hb,c=0;6>c;c++){var p=y(c);e.nb=a.gj[c];l.Wg(e.nb,e.jf);w.iv(e);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,p,g,0);b(a);for(var p=a.D,r=0;r<p.length;r++)p[r].ec=
p[r].cw[c];k(a)}else k(a);f.ey(a);f.pv("draw subscene: "+a.type);C.bindFramebuffer(C.FRAMEBUFFER,null)}};a.clear=function(a){C.bindFramebuffer(C.FRAMEBUFFER,a.k.Ve);b(a)};a.lL=function(a){var d=a.aq;d.length=0;var b=a.oa;a=a.rb;b&&a||A.l("Incomplete batch");b=b.ed;a=a.attributes;for(var c in a){var e=b[c];d.push({Hj:a[c],sL:4*e.offset,kO:1<e.frames?4*e.length:0,ih:e.ih})}};a.pL=g;a.fB=function(a){var d=a.rb,b=a.fa;a=a.Sc;C.useProgram(d.Pl);for(var c=0;c<b.length;c++)C.uniform1i(d.fk[a[c]],c)};a.Xx=
function(a,d,b,c,e,f){c||(c=1);e||(e=1);f||(f=new Uint8Array(4*c*e));f.length!=4*c*e&&A.l("read_pixels(): Wrong storage");C.bindFramebuffer(C.FRAMEBUFFER,a);C.readPixels(d,b,c,e,C.RGBA,C.UNSIGNED_BYTE,f);C.bindFramebuffer(C.FRAMEBUFFER,null);return f};a.vT=function(a){var d=a.rb;d.Ax||(C.useProgram(d.Pl),d.zo.length||g(d),d=d.Mx.u_cube_fog,d.qw(C,d.Hj,null,null,a,null))};a.rR=function(a,d){var b=C.createFramebuffer();C.bindFramebuffer(C.FRAMEBUFFER,b);if(r.ll(a)){var c=a.Ge;C.framebufferRenderbuffer(C.FRAMEBUFFER,
C.COLOR_ATTACHMENT0,C.RENDERBUFFER,c)}else if(r.ol(a)){var e=a,c=e.hb,e=e.ac==C.TEXTURE_CUBE_MAP?C.TEXTURE_CUBE_MAP_NEGATIVE_Z:e.ac;C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,e,c,0)}r.ll(d)?(c=d.Ge,C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.RENDERBUFFER,c)):r.ol(d)&&(e=d,c=e.hb,e=e.ac,C.framebufferTexture2D(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,e,c,0));f.ZL();C.bindFramebuffer(C.FRAMEBUFFER,null);return b};a.qR=function(a,d,b,c,e){null==a?(C.bindFramebuffer(C.FRAMEBUFFER,
a),C.viewport(0,0,c,e),C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT)):(r.ll(d)?C.deleteRenderbuffer(d.Ge):r.ol(d)&&C.deleteTexture(d.hb),r.ll(b)?C.deleteRenderbuffer(b.Ge):r.ol(b)&&C.deleteTexture(b.hb),C.deleteFramebuffer(a))};a.s_=function(){};a.GN=function(a,d,b,c,f,g){a=a.hb;C.viewport(0,0,b,b);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,d,a,0);d=B.Iv("FLIP_CUBEMAP_COORDS");a=d.rb;C.activeTexture(C.TEXTURE0);C.bindTexture(C.TEXTURE_2D,f);var l=f=0;b!=c&&(f=1/(6*c),l=1/(4*c));C.uniform1i(a.fk.u_tex_number,
g);C.uniform2fv(a.fk.u_delta,[f,l]);C.useProgram(a.Pl);e(d.oa,d.aq,0);C.bindTexture(C.TEXTURE_2D,null)};a.HN=function(a,d,b,c,f){C.bindFramebuffer(C.FRAMEBUFFER,c);c=a.hb;a=a.ac;C.bindTexture(a,c);C.viewport(0,0,d,b);C.texImage2D(a,0,C.RGBA,d,b,0,C.RGBA,C.UNSIGNED_BYTE,null);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,a,c,0);d=B.Iv("NONE");b=d.rb;C.bindTexture(a,null);C.activeTexture(C.TEXTURE0);C.bindTexture(a,f);C.useProgram(b.Pl);e(d.oa,d.aq,0);C.bindFramebuffer(C.FRAMEBUFFER,null);
C.bindTexture(a,null)};a.ha=function(){}};b4w.module.__camera=function(a,n){function k(a,c,d,b,e){Ca.kc(a,c);d&&F(a,c,d);H(a,b);K(a,e)}function b(a,d,b,e,h,f,m,g){var p=a.g;Ca.kc(a,d);p.pivot.set(b);F(a,d,b);H(a,e);K(a,h);P(a,f);c(a,m);p.use_panning=g}function e(a,c,b,e,h,f,m,g){var l=a.g;Ca.kc(a,c);l.wb.set(b);F(a,c,b);v(a,e);d(a,h);p(a,f);N(a,m);l.Hn=g}function y(a,c,d){var b=a.g,e=ba.q(b.i),h=ba.B(b.i),b=ya;b.set(aa.uc);b[3]=0;a=r(a,ra)[1];h=aa.Cb(h,aa.md,ma);da.MG(ua,e);da.Ay(ua,h);if(!aa.jx(b,-c,ua,d)||Math.abs(a)<Aa)oa.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
d[0]=e[0],d[1]=0,d[2]=e[2];return d}function g(c){for(var d=c.g,b=0;b<c.A.length;b++){var e=c.A[b].U[0];if(e.type==a.Wd)switch(d.lb){case a.bb:var h=ba.q(d.i);d.il=ca.dist(h,d.pivot);d.jl=e.top;break;case a.xc:h=ba.q(d.i),d.il=ca.dist(h,d.wb),d.jl=e.top}}}function B(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function w(c){switch(c){case "STATIC":return a.Uf;
case "TARGET":return a.bb;case "EYE":return a.wc;case "HOVER":return a.xc;default:aa.l("Unknown move style")}}function t(c){var d={type:c,name:"",J1:1,width:0,height:0,Ve:null,ow:null,Wb:null,he:null,ib:0,Bd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,Dd:S.create(),i:new Float32Array(9),nb:new Float32Array(16),Bb:new Float32Array(16),Qf:new Float32Array(16),vI:new Float32Array(16),eR:new Float32Array(16),sg:new Float32Array(16),jf:ba.Zf(),wz:ba.Zf(),uI:ba.Zf(),Yx:ba.Zf(),Zx:ba.Zf(),gG:ba.Zf(),Gy:ba.Zf(),
dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,je:null,dof_on:!1,YE:new Float32Array(3),$k:B(),im:0,gf:0,jc:null,rn:null,Lv:null,lC:new Float32Array(4),cs:new Float32Array(4)};d.Dd[0]=d.Dd[2]=45;d.Dd[1]=d.Dd[3]=55;if(c==a.zc)return d;switch(c){case a.Vc:A(d,40,.1,1E3);break;case a.Wd:A(d,2.5,.1,1E3);break;case a.Cg:break;case a.Fh:break;case a.Si:break;case a.cc:case a.nc:case a.wd:case a.xd:aa.l("Stereo camera may only be created from perspective one");break;default:aa.l("Unknown camera type")}return d}
function f(c,d,b){c.type!=a.cc&&c.type!=a.nc&&c.type!=a.wd&&c.type!=a.xd&&aa.l("set_stereo_params(): wrong camera type");if(c.type==a.cc||c.type==a.nc)c.im=d;c.gf=b;V(c,c.ib);if(ea.za()&&(d=ea.p(),c=d.j.Rc))for(d=E.aa(ea.bl(d),d).U,b=0;b<d.length;b++)ja(d[b],c)}function r(a,c){return l(ba.B(a.g.i),c)}function l(a,c){var d=aa.Cb(a,aa.uc,ma),b=aa.Cb(a,aa.lf,T),e=-Math.asin(d[1]/ca.length(d)),d=Math.abs(e)>Math.PI/4?ca.scale(b,-aa.sign(e),Da):ca.scale(d,-aa.sign(b[1]),Da),h=Math.atan(Math.abs(d[0]/d[2]));
0<b[1]&&(e=aa.sign(e)*Math.PI-e);b=h;0>d[2]&&(b=Math.PI-b);0>d[0]&&(b=2*Math.PI-b);c[0]=b;c[1]=e;return c}function A(c,d,b,e,h){switch(c.type){case a.Vc:case a.cc:case a.nc:c.Bd=d;c.ib=1;break;case a.Wd:c.top=d;c.ib=1;break;case a.Cg:delete c.Bd;c.Bd=d;c.ib=h/d;break;case a.Fh:c.top=d;c.ib=h/d;break;case a.wd:case a.xd:break;default:oa.error("set_frustum(): Unsupported camera type: "+c.type)}c.near=b;c.far=e}function x(c,d){var b=la.fromRotationTranslation(ba.B(d.g.i),ba.q(d.g.i),pa);la.rotateX(b,
-Math.PI/2,b);la.invert(b,c.nb);if(ea.za())var b=ea.p(),e=ea.qa(b,"STEREO");if(c.type==a.cc||e&&e.enable_hmd_stereo&&c.type==a.wd)c.nb[12]+=c.gf/2;else if(c.type==a.nc||e&&e.enable_hmd_stereo&&c.type==a.xd)c.nb[12]-=c.gf/2;if(c.jc){ba.Wg(c.nb,c.Yx);ba.HH(c.Yx,c.Zx);ba.invert(c.Zx,c.gG);var b=c.jc[0],e=c.jc[1],h=c.jc[2],f=c.jc[3],m=pa;m[0]=1-2*b*b;m[1]=-2*b*e;m[2]=-2*b*h;m[3]=0;m[4]=-2*b*e;m[5]=1-2*e*e;m[6]=-2*e*h;m[7]=0;m[8]=-2*b*h;m[9]=-2*e*h;m[10]=1-2*h*h;m[11]=0;m[12]=-2*b*f;m[13]=-2*e*f;m[14]=
-2*h*f;m[15]=1;la.multiply(c.nb,m,c.nb);V(c,c.ib,!0);b=ya;e=pa;la.invert(c.nb,e);la.transpose(e,e);S.transformMat4(c.jc,e,b);e=fa;e[0]=(aa.sign(b[0])+c.Bb[8])/c.Bb[0];e[1]=(aa.sign(b[1])+c.Bb[9])/c.Bb[5];e[2]=-1;e[3]=(1+c.Bb[10])/c.Bb[14];S.scale(b,2/(b[0]*e[0]+b[1]*e[1]+b[2]*e[2]+b[3]*e[3]),b);c.Bb[2]=b[0];c.Bb[6]=b[1];c.Bb[10]=b[2]+1;c.Bb[14]=b[3]}ba.Wg(c.nb,c.jf);ba.HH(c.jf,c.wz);ba.invert(c.wz,c.uI);R(c);Q(c);ba.copy(d.g.i,c.i)}function L(c,d,b,e){la.lookAt(d,b,e,c.nb);b=ea.p();b=ea.qa(b,"STEREO");
ea.za()&&(b=ea.p(),b=ea.qa(b,"STEREO"));if(c.type==a.cc||b&&b.enable_hmd_stereo&&c.type==a.wd)c.nb[12]+=c.gf/2;else if(c.type==a.nc||b&&b.enable_hmd_stereo&&c.type==a.xd)c.nb[12]-=c.gf/2;ba.Wg(c.nb,c.jf);R(c);Q(c);ba.ff(d,c.i)}function M(a,c,d){d=ca.subtract(d,c,ma);ca.length(d)&&(ca.normalize(d,d),d=aa.rG(aa.md,d,ga),Ca.rg(a,d));Ca.kc(a,c)}function F(a,c,d){var b=a.g,e=0<aa.Cb(ba.B(a.g.i),aa.lf,ma)[1];M(a,c,d);e?(c=ca.copy(b.hf,ma),ca.negate(c,c),ha.Qh(a,c,!0)):ha.Qh(a,b.hf,!0)}function J(a,c){var d=
a.g,b=c.U;b||aa.l("Wrong object");for(var e=c.$G,h=0;h<e.length;h++){var f=e[h];ca.copy(ba.q(d.i),f.YE)}for(h=0;h<b.length;h++)if(f=b[h],x(f,a),aa.Nq(f.Qf,f.$k),f.je&&f.dof_on){var e=ba.q(d.i),m=Ca.xf(f.je,ma),e=ca.dist(e,m);f.dof_distance=e}}function C(c){var d=c.g;d.lb==a.bb&&(d.Ws=0<aa.Cb(ba.B(c.g.i),aa.lf,ma)[1])}function H(c,d){var b=c.g;if(d){b.$a=b.$a||{};b.$a.left=d.left;b.$a.right=d.right;b.$a.rl=d.left;b.$a.Ql=d.right;b.$a.camera_space=Boolean(d.camera_space);var e=c.g;!(b=e.$a)||e.lb!=
a.wc&&e.lb!=a.bb||(e=r(c,ra),b.camera_space?(b.left+=e[0],b.right+=e[0]):(b.rl-=e[0],b.Ql-=e[0]),b.left=aa.Dg(b.left),b.right=aa.Dg(b.right),b.rl=aa.Dg(b.rl),b.Ql=aa.Dg(b.Ql))}else b.$a=null}function K(a,c){var d=a.g;c?(d.va=d.va||{},d.va.down=c.down,d.va.up=c.up,d.va.Rk=c.down,d.va.qm=c.up,d.va.camera_space=Boolean(c.camera_space),h(a)):d.va=null}function d(a,c){var d=a.g;if(!c){var b=r(a,ra);c={down:b[1],up:b[1]}}d.va=d.va||{};d.va.down=c.down;d.va.up=c.up;h(a);d.fb&&d.va&&m(a)}function h(c){var d=
c.g,b=d.va;if(b)switch(d.lb){case a.wc:case a.bb:c=r(c,ra);b.camera_space?(b.up+=c[1],b.down+=c[1]):(b.qm-=c[1],b.Rk-=c[1]);b.up=aa.qf(b.up,-Math.PI,Math.PI);b.down=aa.qf(b.down,-Math.PI,Math.PI);b.qm=aa.qf(b.qm,-Math.PI,Math.PI);b.Rk=aa.qf(b.Rk,-Math.PI,Math.PI);break;case a.xc:b.up=aa.qf(b.up,-Math.PI,Math.PI),b.down=aa.qf(b.down,-Math.PI,Math.PI),b.up=aa.S(b.up,-Math.PI/2,0),b.down=aa.S(b.down,-Math.PI/2,0)}}function v(a,c){var d=a.g;if(!c){var b=Ca.Fl(a,d.wb);c={min:b,max:b}}d.fb=d.fb||{};d.fb.min=
c.min;d.fb.max=c.max;d.fb&&d.va&&m(a)}function P(a,c){var d=a.g;c?(d.fb=d.fb||{},d.fb.min=c.min,d.fb.max=c.max):d.fb=null}function c(a,c){var d=a.g;c?(d.cf=d.cf||{},d.cf.min_y=c.min_y,d.cf.max_y=c.max_y):d.cf=null}function p(a,c){var d=a.g;c?(d.Jc=d.Jc||{},d.Jc.min=c.min,d.Jc.max=c.max):d.Jc=null}function N(a,c){var d=a.g;c?(d.Kc=d.Kc||{},d.Kc.min=c.min,d.Kc.max=c.max):d.Kc=null}function G(c){var d=c.g;if(E.la(c))for(var b=c.A,e=0;e<b.length;e++){var h=b[e].U;if(h[0].type===a.Wd){switch(d.lb){case a.bb:var f=
ba.q(d.i),f=ca.dist(f,d.pivot),f=f/d.il*d.jl;break;case a.xc:f=ba.q(d.i);f=ca.distance(f,d.wb);f=f/d.il*d.jl;break;default:f=h[0].top}for(var m=0;m<h.length;m++){var g=h[m];g.top=f;V(g,g.ib)}J(c,b[e])}}}function u(c){var d=c.g,b=d.lb;if(b===a.bb||b===a.wc){if(d.$a){var e=d.$a.left,h=d.$a.right,f=r(c,ra);(f=b==a.bb?aa.cj(f[0],e,h):aa.cj(f[0],h,e))&&(b==a.bb?q(c,f,0):z(c,f,0))}d.va&&(e=d.va.down,h=d.va.up,f=r(c,ra),(f=b==a.bb?aa.cj(f[1],h,e):aa.cj(f[1],e,h))&&(b==a.bb?q(c,0,f):z(c,0,f)));if(b===a.bb&&
d.fb){var f=c.g,e=ba.q(f.i),h=ca.subtract(e,f.pivot,ma),m=ca.length(h);m>f.fb.max?(ca.scale(h,f.fb.max/m,h),ca.add(f.pivot,h,e)):m<f.fb.min&&(m=aa.Cb(ba.B(f.i),aa.md,T),ca.scale(m,100*f.fb.min,m),ca.add(h,m,h),ca.scale(h,-f.fb.min/ca.length(h),h),ca.add(f.pivot,h,e))}}b===a.bb&&d.cf&&(d=c.g,f=d.pivot[1],e=aa.S(d.pivot[1],d.cf.min_y,d.cf.max_y),e!=f&&(f=ca.set(0,e-f,0,ma),ca.add(d.pivot,f,d.pivot),d=ba.q(d.i),ca.add(d,f,d)));b===a.xc&&(b=c.g,b.Jc&&(f=aa.S(b.wb[0],b.Jc.min,b.Jc.max)-b.wb[0],b.wb[0]+=
f,d=ba.q(b.i),d[0]+=f),b.Kc&&(f=aa.S(b.wb[2],b.Kc.min,b.Kc.max)-b.wb[2],b.wb[2]+=f,d=ba.q(b.i),d[2]+=f),b=c.g,d=r(c,ra)[1],(b=aa.cj(d,b.va.up,b.va.down))&&D(c,0,b))}function z(a,c,d,b,e){var h=a.g,f=c,m=d;if(b||e)a=r(a,za),b&&(f=c-a[0]),e&&(m=d-a[1]);if(f||m)c=U.identity(ga),f&&(f=U.setAxisAngle(h.hf,f,O),U.multiply(c,f,c)),h=ba.B(h.i),m&&(f=aa.Cb(h,aa.Ke,ma),m=U.setAxisAngle(f,m,O),U.normalize(m,m),U.multiply(c,m,c)),U.multiply(c,h,h)}function q(a,c,d,b,e){var h=a.g,f=c,m=d;if(b||e){var g=r(a,za);
b&&(f=c-g[0]);e&&(m=d-g[1])}I(a,a.g.pivot,f,m);a=r(a,za);a=aa.qf(a[1],-Math.PI,Math.PI);h.Ws=Math.abs(a)>Math.PI/2}function D(a,c,d,b,e){var h=a.g,f=c,g=d;if(b||e){var p=r(a,za);b&&(f=c-p[0]);e&&(g=d-p[1])}h.Hn||(f=0);I(a,h.wb,f,g);g&&m(a)}function I(a,c,d,b){var e=a.g;if(d||b){a=U.identity(ga);d&&(d=U.setAxisAngle(aa.uc,d,O),U.multiply(a,d,a));d=ba.B(e.i);if(b){var h=aa.Cb(d,aa.Ke,ma);b=U.setAxisAngle(h,b,O);U.normalize(b,b);U.multiply(a,b,a)}b=ba.q(e.i);aa.AR(b,c,a,b);U.multiply(a,d,d)}}function m(a){var c=
a.g,d=r(a,ra)[1],b=a.g;a=b.va;b=b.fb;a.down-a.up?(d=(a.down-d)/(a.down-a.up),d=Math.max(d,0)):d=0;d=d*(b.max-b.min)+b.min;a=ba.q(c.i);b=aa.Cb(ba.B(c.i),aa.md,ma);ca.normalize(b,b);ca.scale(b,d,b);ca.subtract(c.wb,b,a)}function V(c,d,b){switch(c.type){case a.Vc:d||aa.l("No aspect ratio"),c.ib=d;case a.Cg:la.perspective(aa.jb(c.Bd),c.ib,c.near,c.far,c.Bb);break;case a.Wd:d||aa.l("No aspect ratio"),c.ib=d;case a.Fh:d=c.top*c.ib;la.ortho(-d,d,-c.top,c.top,c.near,c.far,c.Bb);break;case a.Si:la.ortho(c.left,
c.right,c.bottom,c.top,c.near,c.far,c.Bb);break;case a.cc:case a.nc:d||aa.l("No aspect ratio");c.ib=d;var e=Math.tan(c.Bd*Math.PI/360);d=c.near*e;var h=c.ib*c.im*e;c.type==a.cc?(e=h-c.gf/2,h+=c.gf/2):(e=h+c.gf/2,h-=c.gf/2);e=-(c.near/c.im*e);h*=c.near/c.im;la.frustum(e,h,-d,d,c.near,c.far,c.Bb);c.left=e;c.right=h;break;case a.wd:case a.xd:if(ea.za())if(e=ea.p(),(e=ea.qa(e,"STEREO"))&&e.enable_hmd_stereo){d=Math.tan(aa.jb(c.Dd[0]));var e=Math.tan(aa.jb(c.Dd[1])),h=Math.tan(aa.jb(c.Dd[2])),f=Math.tan(aa.jb(c.Dd[3]));
c.top=c.near*d;c.right=c.near*e;c.bottom=-c.near*h;c.left=-c.near*f;la.frustum(c.left,c.right,c.bottom,c.top,c.near,c.far,c.Bb)}else d||(d=c.ib),la.perspective(aa.jb(c.Bd),d,c.near,c.far,c.Bb);break;case a.zc:return;default:aa.l("Wrong camera type: "+c.type)}b||(R(c),Q(c))}function Q(a){la.copy(a.nb,a.sg);a.sg[12]=0;a.sg[13]=0;a.sg[14]=0;a.sg[15]=1;la.multiply(a.Bb,a.sg,a.sg);la.invert(a.sg,a.sg)}function R(a){la.copy(a.nb,a.Qf);la.multiply(a.Bb,a.Qf,a.Qf);la.invert(a.Qf,a.vI)}function X(c,d,b,e,
h){e||(e=new Float32Array(24));d||(d=c.near);b||(b=c.far);var f,m,g,p,v,l,q,u;switch(c.type){case a.zc:aa.l("Extraction from NONE camera is not possible");break;case a.Vc:case a.Cg:f=d*Math.tan(c.Bd*Math.PI/360);p=-f;m=f*c.ib;g=-m;v=b/d*f;u=-v;l=v*c.ib;q=-l;break;case a.Wd:case a.Fh:g=c.top*c.ib;f=v=c.top;m=l=g;p=u=-c.top;g=q=-g;break;case a.Si:f=v=c.top;m=l=c.right;p=u=c.bottom;g=q=c.left;break;case a.cc:case a.nc:v=d/c.near;f=d*Math.tan(c.Bd*Math.PI/360);p=-f;m=c.right*v;g=c.left*v;q=b/d;v=f*q;
u=-v;l=m*q;q*=g;break;case a.wd:case a.xd:v=d/c.near;f=c.top*v;p=c.bottom*v;m=c.right*v;g=c.left*v;q=b/d;v=f*q;u=p*q;l=m*q;q*=g;break;default:aa.l("Wrong camera type: "+c.type)}e[0]=g;e[1]=p;e[2]=-d;e[3]=m;e[4]=p;e[5]=-d;e[6]=m;e[7]=f;e[8]=-d;e[9]=g;e[10]=f;e[11]=-d;e[12]=q;e[13]=u;e[14]=-b;e[15]=q;e[16]=v;e[17]=-b;e[18]=l;e[19]=v;e[20]=-b;e[21]=l;e[22]=u;e[23]=-b;h&&(d=pa,la.invert(c.nb,d),aa.Nl(e,d,e,0));return e}function ja(a,c){if(c.enable_csm){var d=c.csm_num;if(!a.rn){var b=c.csm_num;a.rn=Array(b);
for(var e=0;e<b;e++)a.rn[e]=new Float32Array(3);a.Lv=new Float32Array(b)}for(b=0;b<d;b++){var e=0==b?a.near:W(c,a,b-1),h=W(c,a,b),e=X(a,e,h,Ea),e=ia.TO(e);a.rn[b].set(e.O);a.Lv[b]=e.mb;a.lC[b]=ca.length(e.O);a.cs[b]=Z(c.first_cascade_blur_radius,c.last_cascade_blur_radius,d,b)}}else a.cs[0]=c.first_cascade_blur_radius}function W(a,c,d){var b=a.csm_num,e=aa.S(a.csm_first_cascade_border,c.near,c.far);a=aa.S(a.csm_last_cascade_border,c.near,c.far);return aa.S(Z(e,a,b,d),c.near,c.far)}function Z(a,c,
d,b){switch(b){case 0:break;case d-1:a=c;break;default:a=0==a?0:a*Math.pow(c/a,b/(d-1))}return a}function Y(a,c){c||(c=new Float32Array(3));ca.copy(ba.q(a.g.i),c);return c}var ia=n("__boundings");n("__config");var ha=n("__constraints"),ka=n("__container"),la=n("__mat4"),da=n("__math"),E=n("__obj_util"),oa=n("__print"),U=n("__quat"),ea=n("__scenes"),Ca=n("__transform"),ba=n("__tsr"),aa=n("__util"),ca=n("__vec3"),S=n("__vec4");a.zc=10;a.Vc=20;a.Wd=30;a.Cg=40;a.Fh=50;a.Si=60;a.cc=70;a.nc=80;a.wd=90;
a.xd=100;a.Uf=0;a.bb=2;a.wc=3;a.xc=4;var Aa=aa.jb(.5),ra=new Float32Array(2),za=new Float32Array(2),ma=new Float32Array(3),T=new Float32Array(3),Da=new Float32Array(3),ga=new Float32Array(4),O=new Float32Array(4),ya=new Float32Array(4),fa=new Float32Array(4),pa=new Float32Array(16),Ea=new Float32Array(24),ua=new Float32Array(6);a.RL=function(c,d){var h=d.g,f=c.data;switch(f.type){case "PERSP":var m=t(a.Vc);if(f.angle_y)var p=aa.Ld(f.angle_y);A(m,p,f.clip_start,f.clip_end);break;case "ORTHO":m=t(a.Wd),
A(m,f.ortho_scale/2,f.clip_start,f.clip_end)}m.name=d.name;p=d.A;p[0].U.push(m);for(var v=1;v<p.length;v++){var q=aa.ia(m);p[v].U.push(q)}h.pT=!1;h.lb=w(f.b4w_move_style);h.dof_distance=f.dof_distance;m=f.dof_object;h.je=m?m.ya:null;h.dof_front=f.b4w_dof_front;h.dof_rear=f.b4w_dof_rear;h.dof_power=f.b4w_dof_power;h.hp=f.b4w_trans_velocity;h.gp=f.b4w_rot_velocity;h.ip=f.b4w_zoom_velocity;m=d.g.lb;p=c.data;v=null;m!=a.bb&&m!=a.wc||!p.b4w_use_horizontal_clamping||(v={left:p.b4w_rotation_left_limit,right:p.b4w_rotation_right_limit,
camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},m==a.wc&&(v.left*=-1,v.right*=-1));m=v;p=d.g.lb;v=c.data;q=null;p!=a.bb&&p!=a.wc||!v.b4w_use_vertical_clamping?p==a.xc&&v.b4w_use_zooming&&(v.b4w_hover_angle_min<=v.b4w_hover_angle_max?(q={down:v.b4w_hover_angle_min,up:v.b4w_hover_angle_max},q.down*=-1,q.up*=-1):oa.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(q={down:v.b4w_rotation_down_limit,up:v.b4w_rotation_up_limit,camera_space:"LOCAL"==v.b4w_vertical_clamping_type},
p==a.bb&&(q.down*=-1,q.up*=-1));var p=q,v=d.g.lb,q=c.data,l=null;v==a.bb&&q.b4w_use_target_distance_limits&&q.b4w_distance_min<=q.b4w_distance_max?l={min:q.b4w_distance_min,max:q.b4w_distance_max}:v===a.xc&&q.b4w_use_zooming&&(q.b4w_distance_min<=q.b4w_distance_max?l={min:q.b4w_distance_min,max:q.b4w_distance_max}:oa.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));v=l;q=c.data;l=null;d.g.lb==a.xc&&q.b4w_use_horizontal_clamping&&q.b4w_horizontal_translation_min<=q.b4w_horizontal_translation_max&&
(l={min:q.b4w_horizontal_translation_min,max:q.b4w_horizontal_translation_max});var q=l,z=c.data,l=null;d.g.lb==a.xc&&z.b4w_use_vertical_clamping&&z.b4w_vertical_translation_min<=z.b4w_vertical_translation_max&&(l={min:z.b4w_vertical_translation_min,max:z.b4w_vertical_translation_max},z=-l.min,l.min=-l.max,l.max=z);var z=c.data,r=null;d.g.lb==a.bb&&z.b4w_use_pivot_limits&&(r={min_y:z.b4w_pivot_z_min,max_y:z.b4w_pivot_z_max});z=r;switch(h.lb){case a.wc:h=ba.q(d.g.i);k(d,h,null,m,p);break;case a.bb:h=
ba.q(d.g.i);b(d,h,f.b4w_target,m,p,v,z,f.b4w_use_panning);break;case a.xc:h=ba.q(d.g.i),m=y(d,c.data.b4w_hover_zero_level,T),e(d,h,m,v,p,q,l,f.b4w_enable_hover_hor_rotation)}u(d);g(d)};a.vS=k;a.xS=b;a.wS=e;a.bo=g;a.MM=B;a.X_=w;a.pc=t;a.TW=function(a,c){switch(c){case "COLOR":case "CUBEMAP":return Boolean(a.Wb);case "DEPTH":return Boolean(a.he);case "SCREEN":return!Boolean(a.Wb)&&!Boolean(a.he);default:aa.l("Wrong attachment type: "+c)}};a.ws=function(a,c,d){switch(c){case "COLOR":case "CUBEMAP":a.Wb=
d;break;case "DEPTH":a.he=d;break;case "SCREEN":a.Wb=null;a.he=null;break;default:aa.l("Wrong attachment type: "+c)}};a.vY=function(a,c){switch(c){case "COLOR":case "CUBEMAP":return a.Wb;case "DEPTH":return a.he;case "SCREEN":return null;default:aa.l("Wrong attachment type: "+c)}};a.Ir=function(c,d){(c.type!=a.Vc||d!=a.cc&&d!=a.nc&&d!=a.wd&&d!=a.xd)&&aa.l("make_stereo(): wrong camera type");c.type=d;f(c,6,.065)};a.jS=f;a.cl=r;a.kD=l;a.Vq=function(a,c){r(a,c);c[0]=aa.Dg(c[0]+Math.PI);c[1]*=-1;return c};
a.zs=A;a.WR=function(c,d,b,e,h,f,m){switch(c.type){case a.Si:c.left=d;c.right=b;c.bottom=e;c.top=h;c.near=f;c.far=m;break;default:oa.error("set_frustum_asymmetric(): Unsupported camera type: "+c.type)}};a.Uh=function(a){return a.g.lb};a.rS=x;a.D1=L;a.Fy=function(a,c,d){var b=ma;b[0]=0;b[1]=-1;b[2]=0;ca.transformQuat(b,d,b);b[0]+=c[0];b[1]+=c[1];b[2]+=c[2];var e=T;e[0]=0;e[1]=0;e[2]=-1;ca.transformQuat(e,d,e);L(a,c,b,e)};a.Cs=M;a.cS=F;a.DT=J;a.CT=function(c){var d=c.g;u(c);G(c);switch(d.lb){case a.bb:var b=
ba.q(d.i);ha.BR(b,ba.B(d.i),d.pivot);for(var e=0;e<c.A.length;e++)for(var h=c.A[e].U,m=0;m<h.length;m++){var g=h[m];g.type!=a.cc&&g.type!=a.nc||f(g,ca.dist(b,d.pivot),g.gf)}ha.Qh(c,d.hf);break;case a.wc:c.zb||ha.Qh(c,d.hf)}C(c)};a.oz=C;a.IG=H;a.UG=K;a.kr=d;a.jr=v;a.OR=P;a.gS=c;a.YR=p;a.qS=N;a.MT=G;a.Mo=z;a.qs=q;a.No=D;a.C_=function(c){switch(c.type){case a.Vc:case a.Wd:case a.cc:case a.nc:return!0;default:return!1}};a.cD=function(c){switch(c.type){case a.Vc:case a.Cg:case a.cc:case a.nc:return aa.jb(c.Bd);
default:return oa.error("get_angular_diameter(): Unsupported camera type: "+c.type),0}};a.qi=V;a.iv=Q;a.tB=R;a.XN=X;a.mL=function(a){a=a.g;var c=ia.bc();c.min_x=-1;c.max_x=1;c.min_y=-1;c.max_y=1;c.min_z=-1;c.max_z=1;a.R=c;var d=ia.xq(1,[0,0,0]);a.Pe=d;a.Wu=ia.WB(1,c);a.Yu=ia.YB(1,c);a.Xu=ia.XB(1,c)};a.nl=function(c){return E.la(c)&&c.g&&c.g.lb==a.Uf};a.sa=function(c){return E.la(c)&&c.g&&c.g.lb==a.bb};a.Gb=function(c){return E.la(c)&&c.g&&c.g.lb==a.wc};a.Ia=function(c){return E.la(c)&&c.g&&c.g.lb==
a.xc};a.yr=function(c){return E.la(c)&&c.g&&c.A[0].U[0].type==a.Wd};a.nz=ja;a.nN=W;a.Rx=function(c,d,b){c=c.A[0].U[0];switch(c.type){case a.Vc:case a.Cg:case a.Wd:case a.Fh:case a.cc:case a.nc:case a.wd:case a.xd:var e=ya;e.set(d);e[3]=1;S.transformMat4(e,c.Qf,e);d=-e[1]/e[3];b[0]=(e[0]/e[3]+1)/2*c.width;b[1]=(d+1)/2*c.height;ka.tU(b[0],b[1],b,c);2<b.length&&(b[2]=(e[2]/Math.abs(e[3])+1)/2);return b;default:return oa.error("Non-compatible camera"),b}};a.QO=function(a){return a.A[0].U[0]};a.el=function(c,
d){switch(c.type){case a.Vc:case a.Cg:case a.cc:case a.nc:var b=Math.tan(aa.jb(c.Bd)/2);switch(d){case "LEFT":return-b*c.ib;case "RIGHT":return b*c.ib;case "TOP":return b;case "BOTTOM":return-b}break;case a.Wd:case a.Fh:switch(d){case "LEFT":return-c.top*c.ib;case "RIGHT":return c.top*c.ib;case "TOP":return c.top;case "BOTTOM":return-c.top}break;case a.Si:switch(d){case "LEFT":return c.left;case "RIGHT":return c.right;case "TOP":return c.top;case "BOTTOM":return c.bottom}break;case a.wd:case a.xd:switch(d){case "LEFT":return Math.tan(aa.jb(c.Dd[3]));
case "RIGHT":return Math.tan(aa.jb(c.Dd[1]));case "TOP":return Math.tan(aa.jb(c.Dd[0]));case "BOTTOM":return Math.tan(aa.jb(c.Dd[2]))}break;default:aa.l("Unknown camera type")}};a.KP=function(c){switch(c.type){case a.Wd:case a.Fh:case a.Si:return!0;default:return!1}};a.RO=function(c,d){switch(c.type){case a.Vc:case a.Cg:case a.cc:case a.nc:var b=aa.jb(c.Bd);return d?b*c.ib:b;default:return 0}};a.Ro=function(a,c,d){a=a.g;ba.ff(c,a.i);ca.copy(d,a.pivot)};a.Bs=function(a,c){var d=a.g,b=ca.subtract(c,
d.wb,ma),b=ca.add(b,ba.q(d.i),b);Ca.kc(a,b);ca.copy(c,d.wb)};a.kS=function(a,c){var d=a.g,b=ca.subtract(c,d.pivot,ma),b=ca.add(b,ba.q(d.i),b);Ca.kc(a,b);ca.copy(c,d.pivot)};a.rD=Y;a.zy=function(c,d){c.g.lb=d;c.g.$a=null;c.g.va=null;c.g.fb=null;c.g.Jc=null;c.g.Kc=null;g(c);switch(d){case a.xc:var b=ba.q(c.g.i),h=y(c,0,T);e(c,b,h,null,null,null,null,c.g.Hn);break;case a.bb:b=Y(c,ma),h=aa.Cb(ba.B(c.g.i),aa.md,T),h=ca.scaleAndAdd(b,h,10,h),ca.copy(h,c.g.pivot)}};a.rt=function(a){a=a.g;a.lb=0;ca.set(0,
0,0,a.pivot);ca.set(0,0,0,a.wb);a.Ws=!1;a.use_panning=!1;a.$a=null;a.va=null;a.fb=null;a.Jc=null;a.Kc=null;a.cf=null;a.Hn=!0};a.uy=function(a,c){for(var d=0;d<a.length;d++){var b=a[d];70!=b.type&&80!=b.type&&90!=b.type&&100!=b.type||f(b,b.im,c)}};a.yy=function(a,c,d){var b=ea.p();a=E.aa(a,b).U;for(b=0;b<a.length;b++){var e=a[b];if(90==e.type||100==e.type)90==e.type&&S.copy(c,e.Dd),100==e.type&&S.copy(d,e.Dd),e.jc||V(e),R(e),Q(e)}}};b4w.module.__constraints=function(a,n){function k(a){var c={};c.type=a;return c}function b(a,c){a.zb&&a.zb.ua&&e(a.zb.ua,a);if(c.ua){var d=c.ua;-1==d.zd.indexOf(a)?d.zd.push(a):L.l("Descendant object override is forbidden")}a.zb=c}function e(a,c){var d=a.zd.indexOf(c);-1!=d?a.zd.splice(d,1):L.l("No descendant object")}function y(a,d,b){switch(d.type){case 1:var e=x.B(a.g.i),g=d.ua.g.i;b=x.B(d.ua.g.i);d.hd?(A.copy(d.hd,e),A.multiply(b,e,e)):A.copy(b,e);var l=x.Ec(d.offset,g,C);x.ff(l,a.g.i);x.ve(d.Oo*
x.Oc(d.ua.g.i),a.g.i);break;case 9:l=x.q(a.g.i);e=x.B(a.g.i);g=d.ua.g.i;b=x.B(d.ua.g.i);A.multiply(A.invert(d.Uj,d.Uj),e,e);A.multiply(b,e,e);x.Ec(d.offset,g,l);A.copy(b,d.Uj);break;case 10:l=x.q(a.g.i);e=x.B(a.g.i);g=d.ua.g.i;b=x.B(d.ua.g.i);A.multiply(A.invert(d.Uj,d.Uj),e,e);A.multiply(b,e,e);x.Ec(d.offset,g,l);A.copy(b,d.Uj);l=x.B(a.g.i);e=A.multiply(x.B(d.ua.g.i),d.hd,h);e=f.kD(e,F);l=f.kD(l,J);f.Mo(a,L.cj(l[0],e[0]+d.rM,e[0]+d.qM),L.cj(l[1],e[1]+d.pM,e[1]+d.sM));break;case 13:var l=x.q(a.g.i),
e=x.B(a.g.i),g=d.ua.g.i,k=x.q(g),m=d.HS,n=C,Q=h;x.Ec(d.offset,g,n);L.Yl(n,l,b,m,l);g=C;M.sub(k,l,g);M.normalize(g,g);var H=e,l=v,k=l.subarray(0,3),n=l.subarray(3,6),y=l.subarray(6,9);M.copy(g,n);M.negate(n,n);M.normalize(n,n);Boolean(.999999<Math.abs(M.dot(g,L.uc)))?(g=r.fromQuat(A.normalize(H,Q),P),M.copy(g.subarray(0,3),k)):M.cross(L.uc,n,k);M.normalize(k,k);M.cross(k,n,y);M.normalize(y,y);A.fromMat3(l,Q);A.normalize(Q,Q);L.fH(Q,e,b,.16*m,e);break;case 2:e=x.B(a.g.i);b=c;t.Uq(d.ua,d.aj,!0,b);x.multiply(d.ua.g.i,
b,b);e[0]=b[4];e[1]=b[5];e[2]=b[6];e[3]=b[7];d.hd&&(A.copy(d.hd,e),A.multiply(e,d.hd,e));x.ve(d.Oo*b[3],a.g.i);l=x.q(a.g.i);x.Ec(d.offset,b,l);break;case 3:l=x.q(a.g.i);e=x.B(a.g.i);b=x.q(d.ua.g.i);B(l,e,b);break;case 4:l=x.q(a.g.i);e=x.B(a.g.i);b=d.target;B(l,e,b);break;case 5:l=x.q(a.g.i);e=x.B(a.g.i);b=x.q(d.ua.g.i);B(l,e,b);e=M.dist(l,b);if(e=e>d.vf?e-d.vf:e<d.zn?e-d.zn:0)M.sub(b,l,C),M.normalize(C,C),M.scale(C,e,C),M.add(l,C,l);break;case 6:l=x.q(a.g.i);e=x.B(a.g.i);b=d.target;B(l,e,b);e=M.dist(l,
b);if(e=e>d.vf?e-d.vf:e<d.zn?e-d.zn:0)M.sub(b,l,C),M.normalize(C,C),M.scale(C,e,C),M.add(l,C,l);break;case 7:g=d.ua.g.i;l=x.q(a.g.i);x.Ec(d.offset,g,l);break;case 8:k=x.q(d.ua.g.i);l=x.q(a.g.i);M.add(k,d.offset,l);break;case 14:e=x.B(a.g.i);g=d.ua.g.i;b=x.B(d.ua.g.i);d.hd?(A.copy(d.hd,e),A.multiply(b,e,e)):A.copy(b,e);l=x.q(a.g.i);x.Ec(d.offset,g,l);break;case 11:x.multiply(d.ua.g.i,d.dt,a.g.i);break;case 12:l=d.dt;b=c;t.Uq(d.ua,d.aj,!0,b);x.multiply(d.ua.g.i,b,b);x.multiply(b,l,a.g.i);break;case 15:e=
d.ua,b=f.QO(e),l=x.q(a.g.i),g=f.el(b,"LEFT"),k=f.el(b,"RIGHT"),m=f.el(b,"TOP"),Q=f.el(b,"BOTTOM"),n="heights"==d.hor_units?m-Q:k-g,d.RE?(g=f.el(b,"LEFT"),l[0]=g+n*d.fx):(k=f.el(b,"RIGHT"),l[0]=k-n*d.fx),g="heights"==d.vert_units?m-Q:k-g,l[2]=d.IH?-(m-g*d.hz):-(Q+g*d.hz),f.KP(b)?l[1]=-d.distance:(l[1]=-1,M.normalize(l,l),M.scale(l,d.distance/Math.abs(l[1]),l)),x.Tc(l,e.g.i,l),M.add(x.q(e.g.i),l,l),l=x.B(a.g.i),e=x.B(e.g.i),d.hd?(A.copy(d.hd,l),A.multiply(e,l,l)):A.copy(e,l)}"CAMERA"==a.g.type&&(l=
a.g.hf,10==d.type&&(b=x.B(d.ua.g.i),l=M.transformQuat(l,b,p)),f.oz(a),w(a,l))}function g(a,d){switch(d.type){case 1:var b=d.target.g.i,e=c;x.invert(a.g.i,e);x.multiply(e,b,e);t.JR(a,d.aj,e)}a.yx=!0}function B(a,c,b){var e=C;L.Cb(c,L.md,e);M.normalize(e,e);var h=H;M.subtract(b,a,h);M.normalize(h,h);a=L.rG(e,h,d);A.multiply(a,c,c);A.normalize(c,c)}function w(a,c,d){var b=a.g,e=x.B(b.i),g=L.Cb(e,L.uc,C);M.normalize(g,g);if(.999999<Math.abs(M.dot(c,g)))g=A.identity(h);else{var p=M.cross(c,g,H);M.normalize(p,
p);b.lb==f.bb?b.Ws&&M.negate(p,p):(b=L.Cb(e,L.lf,K),0<M.dot(b,c)&&M.negate(p,p));b=L.Cb(e,L.Ke,K);M.normalize(b,b);var m=L.S(M.dot(b,p),-1,1),g=-.999999>=m?A.setAxisAngle(g,Math.acos(m),h):A.rotationTo(b,p,h);A.normalize(g,g)}A.multiply(g,e,e);d&&(d=L.Cb(e,L.Mi,C),0>M.dot(c,d)&&A.rotateY(e,Math.PI,e));f.oz(a)}var t=n("__armature"),f=n("__camera"),r=n("__mat3"),l=n("__print"),A=n("__quat"),x=n("__tsr"),L=n("__util"),M=n("__vec3");a.QU=1;a.PU=2;a.UU=3;a.VU=4;a.KU=5;a.LU=6;a.RU=7;a.JU=8;a.OU=9;a.NU=
10;a.HU=11;a.IU=12;a.MU=13;a.SU=14;a.TU=15;a.EU=1;var F=new Float32Array(2),J=new Float32Array(2),C=new Float32Array(3),H=new Float32Array(3),K=new Float32Array(3),d=new Float32Array(4),h=new Float32Array(4),v=new Float32Array(9),P=new Float32Array(9),c=x.create(),p=new Float32Array(3);a.YA=function(a,c,d,e,h){var f=k(1);f.ua=c;f.offset=new Float32Array(d);f.hd=e?new Float32Array(e):null;f.Oo=h;b(a,f);y(a,f,0)};a.TK=function(a,c,d,e,h,f){var g=k(2);g.ua=c;g.aj=d;g.offset=new Float32Array(e);g.hd=
h?new Float32Array(h):null;g.Oo=f;b(a,g);y(a,g,0)};a.RK=function(a,c,d,e){var h=k(9),f=x.B(a.g.i),g=x.B(c.g.i);h.ua=c;h.offset=new Float32Array(d);h.Uj=new Float32Array(g);e&&(A.copy(e,f),A.multiply(g,f,f));b(a,h);y(a,h,0)};a.QK=function(a,c,d,e,h,f,g,m){var p=k(10),l=x.B(a.g.i),v=x.B(c.g.i);p.ua=c;p.offset=new Float32Array(d);p.Uj=new Float32Array(v);p.qM=L.Dg(h);p.rM=L.Dg(f);p.sM=L.qf(g,-Math.PI,Math.PI);p.pM=L.qf(m,-Math.PI,Math.PI);e?(p.hd=new Float32Array(e),A.copy(e,l),A.multiply(v,l,l)):p.hd=
A.create();b(a,p);y(a,p,0)};a.PK=function(a,c,d,e){var h=k(13);h.ua=c;h.offset=new Float32Array(d);h.HS=e;b(a,h);y(a,h,0)};a.XK=function(a,c,d,e){var h=k(14);h.ua=c;h.offset=new Float32Array(d);h.Oo=1;h.hd=e?new Float32Array(e):null;b(a,h);y(a,h,0)};a.z0=e;a.$K=function(a,c){var d=k(3);d.ua=c;b(a,d);y(a,d,0)};a.aL=function(a,c){var d=k(4);d.target=new Float32Array(c);b(a,d);y(a,d,0)};a.LK=function(a,c,d,e){var h=k(5);h.ua=c;h.zn=d;h.vf=e;b(a,h);y(a,h,0)};a.MK=function(a,c,d,e){var h=k(6);h.target=
new Float32Array(c);h.zn=d;h.vf=e;b(a,h);y(a,h,0)};a.WK=function(a,c){var d=k(7);d.ua=c;d.offset=new Float32Array([0,.5,0]);b(a,d);y(a,d,0)};a.KK=function(a,c,d){var e=k(8);e.ua=c;e.offset=new Float32Array(d);b(a,e);y(a,e,0)};a.IK=function(a,c,d){var e=k(11);e.ua=c;e.dt=new Float32Array(d);b(a,e);y(a,e,0)};a.JK=function(a,c,d,e){var h=k(12);h.ua=c;h.aj=d;h.dt=new Float32Array(e);b(a,h);y(a,h,0)};a.Pu=function(a,c,d){var e=k(15);e.ua=c;if(L.Af(d.left))e.RE=!0,e.fx=d.left;else if(L.Af(d.right))e.RE=
!1,e.fx=d.right;else{l.error("append_stiff_viewport: Wrong positioning params");return}if(L.Af(d.top))e.IH=!0,e.hz=d.top;else if(L.Af(d.bottom))e.IH=!1,e.hz=d.bottom;else{l.error("append_stiff_viewport: Wrong positioning params");return}L.Af(d.distance)?(e.distance=d.distance,e.hd=L.Af(d.rotation)?new Float32Array(d.rotation):null,e.hor_units=L.Af(d.hor_units)?d.hor_units:"widths",e.vert_units=L.Af(d.vert_units)?d.vert_units:"heights",b(a,e),y(a,e,0)):l.error("append_stiff_viewport: Wrong positioning params")};
a.ET=function(a,c){a.zb&&y(a,a.zb,c)};a.UK=function(a,c,d,b,e){var h=k(1);h.aj=d;h.target=c;h.offset=new Float32Array(b);h.hd=e?new Float32Array(e):null;h.Oo=1;c=h.target;d=h.aj;b=a.g.Oe[d];e=c.zv;for(var f=0;f<e;f++){var m=e[f];if(m[0]==a&&m[1]==d){e.splice(f,1);break}}c.zv.push([a,d]);b.zb=h;g(a,h)};a.wT=function(a,c){var d=a.g.Oe[c];d.zb&&g(a,d.zb)};a.BR=B;a.Qh=w;a.bM=function(a){return a.zb?!0:!1};a.remove=function(a){a.zb.ua&&e(a.zb.ua,a);a.zb=null};a.FZ=function(a){return a.zb?a.zb.type:null};
a.Ye=function(a){a=a.zb;return!a||11!=a.type&&12!=a.type?!1:!0};a.Xq=function(a){if((a=a.zb)&&11==a.type)return a.ua.g.i;if(a&&12==a.type){var d=c;t.Uq(a.ua,a.aj,!0,d);x.multiply(a.ua.g.i,d,d);return d}return null};a.We=function(a){a=a.zb;return!a||11!=a.type&&12!=a.type?null:a.dt}};b4w.module.__armature=function(a,n){function k(a){a=a.g;for(var b=a.Ns,e=a.fF,f=0;f<b.length;f++){for(var g=b[f],l=e[f],k=0;k<l.length;k+=2)for(var r=l[k],d=l[k+1],h=0;4>h;h++)g.Kd[r+h]=a.Kd[d+h],g.te[r+h]=a.te[d+h],g.Td[r+h]=a.Td[d+h],g.Ee[r+h]=a.Ee[d+h];g.Ue=a.Ue}}function b(a,e,g,l){var k=a.TH,r=a.Bi,A=a.bt,n=a.LF;n?(n=n.bt,e?y.multiply(n,k,A):(e=f,y.invert(n,e),y.multiply(e,A,k))):e?y.copy(k,A):y.copy(A,k);k=t;y.invert(r,k);y.multiply(A,k,k);r=a.Lh;g[4*r]=k[0];g[4*r+1]=k[1];g[4*r+2]=k[2];g[4*
r+3]=k[3];l[4*r]=k[4];l[4*r+1]=k[5];l[4*r+2]=k[6];l[4*r+3]=k[7];a=a.yC;for(r=0;r<a.length;r++)A=a[r],A.zb||b(A,!0,g,l)}var e=n("__util"),y=n("__tsr"),g=n("__quat"),B=n("__mat4"),w=n("__vec3"),t=y.create(),f=y.create(),r=new Float32Array(4),l=new Float32Array(4),A=new Float32Array(4);a.Di=function(a,b){for(var f=a.data.bones,g=a.pose.bones,l={},k=0;k<g.length;k++){var r=g[k],A=r.bone,d=A.name,h=l[d]={Lh:0,oI:-1,LF:null,yC:[],kq:[],zb:null,lz:y.create(),TH:y.create(),Bi:y.create(),bt:y.create(),$s:y.create(),
mz:y.create(),at:!1,yH:new Float32Array(3)},d=new Float32Array(A.matrix_local),v=new Float32Array(16);B.invert(d,v);var r=new Float32Array(r.matrix_basis),n=h.yH;w.subtract(A.tail_local,A.head_local,n);e.oU(n,v,n);y.Wg(d,h.Bi);y.Wg(r,h.$s);y.copy(h.Bi,h.bt)}for(k=0;k<f.length;k++){d=f[k].name;r=e.Lc("name",d,g);h=l[d];A=r.parent_recursive;h.kq.push(h);for(v=0;v<A.length;v++)r=A[v],r=r.name,r=l[r],h.kq.push(r);A.length?(r=A[0],r=r.name,r=l[r],h.LF=r,y.invert(r.Bi,t),y.multiply(t,h.Bi,h.lz),r.yC.push(h)):
y.copy(h.Bi,h.lz);h.Lh=k;h.name=d;y.multiply(h.lz,h.$s,h.TH)}b.g.Oe=l};a.Uq=function(a,b,e,k){var n=a.g,w=n.Ue;b=n.Oe[b];var B=b.Lh;a=b.Bi;var K=n.Td,d=n.Ee,h=n.Kd,n=n.te,v=K[4*B+1],P=K[4*B+2],c=K[4*B+3],p=d[4*B+1],N=d[4*B+2],G=d[4*B+3];r[0]=(1-w)*K[4*B]+w*d[4*B];r[1]=(1-w)*v+w*p;r[2]=(1-w)*P+w*N;r[3]=(1-w)*c+w*G;l[0]=h[4*B];l[1]=h[4*B+1];l[2]=h[4*B+2];l[3]=h[4*B+3];A[0]=n[4*B];A[1]=n[4*B+1];A[2]=n[4*B+2];A[3]=n[4*B+3];g.slerp(l,A,w,l);w=t;y.mS(r,w);y.ri(l,w);e?(e=f,y.translate(a,b.yH,e),y.multiply(w,
e,w)):y.multiply(w,a,w);y.copy(w,k)};a.JR=function(a,e,f){var g=a.g;e=g.Oe[e];var l=g.Td,r=g.Kd;y.copy(f,e.bt);b(e,!1,l,r);g.Ue=0;k(a)};a.ST=k;a.xT=b;a.YL=function(a,b){return b in a.g.Oe}};b4w.module.__container=function(a,n){var k,b,e,y,g;function B(a,c){k=a;b=c}function w(){var a=d.getBoundingClientRect();B(a.left,a.top)}function t(){return K.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function f(b,e,f){if(!b||!e){b=a.zt;e=a.yt;var g=v;g.style.width=a.zt+"px";g.style.height=a.yt+"px"}var g=d,l=h;!1!==f&&(g.style.width=b+"px",g.style.height=e+"px",l&&(l.style.width=b+"px",l.style.height=e+"px"));l&&(l.width=b,l.height=e,x.$o());f=Math.floor(b*K.canvas_resolution_factor);e=Math.floor(e*
K.canvas_resolution_factor);t()&&(f*=window.devicePixelRatio,e*=window.devicePixelRatio);if(l=F.wj())l=l.j,f=Math.floor(f*l.Nd),e=Math.floor(e*l.Nd);g.width=f;g.height=e;if(f>c.drawingBufferWidth||e>c.drawingBufferHeight)M.warn("Canvas size exceeds platform limits, downscaling"),l=Math.min(c.drawingBufferWidth/f,c.drawingBufferHeight/e),f*=l,e*=l,g.width=f,g.height=e;F.XG(f,e,f/b);F.za()&&C.o(F.p().Gh);A.IT(g.width,g.height);A.hg()&&(r.update(),F.update(J.Xn(),0),r.eI())}var r=n("__anchors"),l=n("__config"),
A=n("__data"),x=n("__hud"),L=n("__input"),M=n("__print"),F=n("__scenes"),J=n("__time"),C=n("__transform"),H=n("__util"),K=l.v,d=null,h=null,v=null,P=!1;y=e=0;g=1;k=b=0;var c=null;a.zt=320;a.yt=240;a.xe=function(a){c=a};a.Wq=function(){return d};a.lD=function(){return h};a.le=function(){return v};a.yf=function(a,c){a&&a.parentNode?(d=a,h=c,v=a.parentNode):H.l("canvas container is not available")};a.rr=function(a,c){c=c||"LAST";switch(c){case "FIRST":v.insertBefore(a,v.firstElementChild);break;case "JUST_BEFORE_CANVAS":v.insertBefore(a,
d);break;case "JUST_AFTER_CANVAS":d.nextElementSibling?v.insertBefore(a,d.nextElementSibling):v.appendChild(a,d);break;case "LAST":v.appendChild(a,d);break;default:M.error(c+" invalid stack order")}};a.VD=function(){return e};a.UD=function(){return y};a.xG=B;a.UH=w;a.yS=function(a,c,d){e=a;y=c;g=d;w()};a.mw=function(){P=!0};a.pq=function(a,c,d){d||(d=new Float32Array(2));var e=d;P&&(w(),P=!1);e[0]=a-k;a=d;P&&(w(),P=!1);a[1]=c-b;return d};a.Xm=function(a,c,d,b){d||(d=new Float32Array(2));d[0]=a*g;
d[1]=c*g;b&&(a=b.width/e,d[0]*=a,d[1]*=a);return d};a.tU=function(a,c,d,b){d||(d=new Float32Array(2));d[0]=a/g;d[1]=c/g;b&&(a=b.width/e,d[0]/=a,d[1]/=a)};a.vE=function(c){return c&&c.parentNode?c.parentNode==v?!0:a.vE(c.parentNode):!1};a.HP=t;a.gO=function(a){var c=document.getElementsByTagName("script");a=H.qo(a);for(var d=0;d<c.length;d++)if(c[d].src==a)return c[d];return null};a.resize=f;a.mi=function(a){var c=v,b=d,e=c.clientWidth,c=c.clientHeight;if(a||e!=b.clientWidth||c!=b.clientHeight)(a=
"HMD"===K.stereo&&L.YD())&&a.isPresenting||f(e,c,!0)}};b4w.module.__anchors=function(a,n){function k(){h=!0;A.le().addEventListener("mouseup",function(){function a(){return"visible"==e.style.visibility&&!p&&!l}if(!v&&!K){var c=d;if(c)if("visible"==c.lastElementChild.style.visibility)b(),d=null;else if(1==c.style.opacity){var e=c.lastElementChild,h=e.firstElementChild,f=h.innerHTML;e.style.visibility="visible";var g=Math.min(parseInt(e.style.width)||200,B(f)-24),m=w(f,g),p=!1,l=!1,f=c.offsetWidth-24,c=c.offsetHeight-16;m==c&&(e.style.height=m+"px");g!=
f?(v=p=!0,J.yk(f,g,200,function(c){c==g&&(p=!1,l||(v=!1),a&&(h.style.visibility="visible"));e.style.width=c+"px"})):p=!1;m!=c?(v=l=!0,J.yk(c,m,200,function(c){c==m&&(l=!1,p||(v=!1),a&&(h.style.visibility="visible"));e.style.height=c+"px"})):l=!1}}})}function b(){var a=d.lastElementChild;a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function e(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function y(a){a.style.cssText+=
"background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}function g(a,c,h){var f=document.createElement("div"),g=document.createElement("span");h&&(f.style.width=
h+"px");y(f);e(g);g.innerHTML=a;f.style.visibility="hidden";g.style.visibility="hidden";f.appendChild(g);c.appendChild(f);c.addEventListener("mousedown",function(){v||c==d||1!=c.style.opacity||K||(d&&"visible"==d.lastElementChild.style.visibility&&b(),d=c)})}function B(a){var c=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;e(d);y(c);c.appendChild(d);document.body.appendChild(c);a=c.offsetWidth+1;document.body.removeChild(c);return a}function w(a,c){var d=document.createElement("div"),
b=document.createElement("span");b.innerHTML=a;e(b);y(d);d.style.width=c+"px";d.style.display="inline-block";d.appendChild(b);document.body.appendChild(d);b=d.offsetHeight-16;document.body.removeChild(d);return b}function t(){for(var a=0,c=0;c<H.length;c++)H[c].Ok&&a++;P=new Float32Array(3*a)}function f(a,c){return c.depth-a.depth}var r=n("__batch"),l=n("__camera"),A=n("__container"),x=n("__objects"),L=n("__print"),M=n("__renderer"),F=n("__scenes"),J=n("__time"),C=n("__tsr"),H=[],K=!1,d=null,h=!1,
v=!1,P=new Float32Array(0),c=new Uint8Array(16),p=new Float32Array(2),N=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<H.length;c++)if(H[c].Ca==a){c=!0;break a}c=!1}if(!c){c=a.anchor.Ok&&Boolean(F.qa(F.wj(),"ANCHOR_VISIBILITY"));c={type:a.anchor.type,Ca:a,x:0,y:0,depth:0,Yi:"out",Ok:c,element:null,zl:null,GK:a.anchor.xQ,Wp:0,Nu:0,Lq:a.anchor.Lq};switch(c.type){case "ANNOTATION":var d=c.GK,b=document.createElement("div"),f=document.createElement("span"),p="",m=a.name,l=A.le();a=x.Yq(a);
b.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;padding:            8px 12px;position:           absolute;";b.style.visibility="hidden";l.appendChild(b);a&&(p=a.description||p,m=a.title||m);f.innerHTML=m;f.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
e(f);b.appendChild(f);p&&g(p,b,d);c.element=b;c.Wp=c.element.offsetHeight;c.Nu=c.element.offsetWidth;break;case "ELEMENT":c.element=document.getElementById(a.anchor.Lq),c.element?(c.Wp=c.element.offsetHeight,c.Nu=c.element.offsetWidth):(L.warn("Anchor HTML element was not found, making it generic"),c.type="GENERIC")}H.push(c);t();h||k()}};a.remove=function(a){for(var c=0;c<H.length;c++){var d=H[c];if(d.Ca==a){"ANNOTATION"==d.type&&(a=d,A.le().removeChild(a.element));H.splice(c,1);t();break}}};a.update=
function(){for(var a=0,c=H.length;c--;){var b=H[c];b.Ok&&P.set(C.q(b.Ca.g.i),3*a++);var e,h=b,g=N;e=F.bl(F.wj());e=g=l.Rx(e,C.q(h.Ca.g.i),g);h=e[0];g=e[1];e=e[2];if(h!=b.x||g!=b.y||e!=b.depth){switch(b.type){case "ANNOTATION":var m=b.element;m.style.left=Math.floor(h)+"px";m.style.top=Math.floor(g-b.Wp)+"px";break;case "ELEMENT":var m=b.element,p=m.getBoundingClientRect();m.style.cssText+="left:"+Math.floor(h-p.width/2)+"px;top:"+Math.floor(g-p.height/2)+"px;"}b.x=h;b.y=g;b.depth=e;b.zl&&b.zl(h,g,
b.Yi,b.Ca,m)}}H.sort(f);for(c=0;c<H.length;c++)b=H[c],"GENERIC"!=b.type&&(b.element.style.zIndex=d==b.element?H.length:c);0<a&&(a=F.qa(F.wj(),"ANCHOR_VISIBILITY").D[0].G,r.qT(a,P))};a.eI=function(){for(var a=A.le(),d=H.length;d--;){var b=H[d],e=b.Ca,h=b.x,f=b.y,g=b.depth,g=0>h||0>f||0>g||1<g||F.Yw(e)||h>=a.clientWidth||f>=a.clientHeight?"out":"visible";if(b.Ok&&"out"!=g){var g=b,l=F.qa(F.wj(),"ANCHOR_VISIBILITY").k,v=A.Xm(g.x,g.y,p,l);M.Xx(l.Ve,v[0],l.height-v[1],2,2,c);g=1020==c[0]+c[4]+c[8]+c[12]?
"visible":"out"==g.Yi||0==c[0]+c[4]+c[8]+c[12]?"covered":g.Yi}if(g!=b.Yi){switch(b.type){case "ANNOTATION":case "ELEMENT":var k=b.element;if(!k)break;"out"==g?(k.style.visibility="hidden",k.children.length&&(k.children[0].style.visibility="hidden")):"visible"==g?(k.style.visibility="visible",k.children.length&&(k.children[0].style.visibility="visible"),k.style.opacity=1):(k.style.visibility="visible",k.style.opacity=.1,k.children.length&&(k.children[0].style.visibility="visible"),"ANNOTATION"==b.type&&
1<k.children.length&&(l=k.children[1],l.style.visibility="hidden",l.children.length&&(l.children[0].style.visibility="hidden")))}b.Yi=g;b.zl&&b.zl(h,f,b.Yi,e,k)}}};a.GW=function(a,c){for(var d=0;d<H.length;d++)H[d].Ca==a&&(H[d].zl=c)};a.BX=function(a){for(var c=0;c<H.length;c++)H[c].Ca==a&&(H[c].zl=null)};a.ha=function(){for(var a=0;a<H.length;a++){var c=H[a];"ANNOTATION"==c.type&&A.le().removeChild(c.element)}H.length=0};a.BP=function(a){for(var c=0;c<H.length;c++)if(H[c].Ca==a)return!0;return!1};
a.JY=function(a){for(var c=0;c<H.length;c++)if(H[c].Ca==a)return H[c].Lq;return!1};a.pause=function(){K=!0};a.nh=function(){K=!1};a.RQ=function(a,c){for(var d=-1,b=0;b<H.length;b++){var e;if(e="visible"==H[b].Yi){var h=H[b];e=Math.round(h.Nu);var f=Math.round(h.Wp),g=h.x,h=h.y;e=a>=g&&a<=g+e&&c<h&&c>=h-f?!0:!1}if(e)if(0>d)var p=H[b].depth,d=b;else H[b].depth<p&&(d=b,p=H[b].depth)}return 0>d?null:H[d].Ca}};b4w.module.__objects=function(a,n){function k(a){var c=a.A;a=a.g;for(var d=0;d<c.length;d++){var b=c[d].Ta;b.j.outline&&a.kh&&N.xR(b)}}function b(a){a.g.kh=0;a=ia.indexOf(a);-1!=a&&ia.splice(a,1)}function e(a){if(a.Vk)for(var c=a.A,d=0;d<c.length;d++)N.XH(c[d].Ta,a)}function y(a,c){for(var b=a.A,e=c.A,h=0;h<b.length;h++){for(var f=!1,m=0;m<e.length;m++)if(b[h].Ta==e[m].Ta){f=!0;break}f||g(c,b[h].Ta)&&d.Pm(c,b[h].Ta)}}function g(a,c){return!c.NA&&"SPEAKER"==a.type||!c.AK&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function B(a,c){if(a.dg_parent&&a.dg_parent.Gu||a.parent&&a.parent.Gu)return!0;switch(a.type){case "MESH":var d=a.b4w_do_not_batch,b=a.b4w_collision,e=a.b4w_vehicle,f=a.b4w_floating,g=a.b4w_character,m=h.nP(a),p=H.qB(a),v=0<a.data.b4w_shape_keys.length,k=a.b4w_dynamic_geometry;if(!(d=l.rB(a,c)||d||b||e||v||f||m||g||p||k))a:{d=a.data;for(b=0;b<d.materials.length;b++){e=d.materials[b];if(!(f=e.b4w_lens_flares))b:{if(e=e.node_tree)for(e=e.nodes,f=0;f<e.length;f++)if(g=e[f],"VECT_TRANSFORM"==
g.type&&(m=g.convert_from,p=g.convert_to,!(!g.Sa[0].Yb||"WORLD"==m&&"CAMERA"==p||"CAMERA"==m&&"WORLD"==p||"OBJECT"==m&&"OBJECT"==p))){f=!0;break b}f=!1}if(f){d=!0;break a}}d=!1}return d;case "EMPTY":return d=H.qB(a),b=a.b4w_do_not_batch,e=Boolean(a.b4w_anchor),l.rB(a,c)||d||b||e;default:return!0}}function w(a,c){var d=a.animation_data,b=a.data?a.data.animation_data:null;d&&d.action&&(d=d.action,(d.j.type==l.yu||d.j.type==l.xu&&"ARMATURE"==c.type||d.j.type==l.uJ&&"LAMP"==c.type||d.j.type==l.tJ&&"WORLD"==
c.type)&&c.pf.push(d));b&&b.action&&("SPEAKER"==c.type||"LAMP"==c.type)&&c.pf.push(b.action);"MESH"==c.type&&c.pf.push.apply(c.pf,l.JO(a))}function t(a,c,d){c=X[c]||[];for(var b=[],e=0;e<c.length;e++){var h=c[e];if(h.g.Ad==d||-1==d)for(var f=h.A,g=0;g<f.length;g++)f[g].Ta==a&&b.push(h)}return b}function f(a,c,b,e){for(var h=null,f=0;f<c.length;f++){var g=c[f];if((b?g.Qj:g.name)==a&&(g.g.Ad==e||-1==e)&&(h=g,!d.Xg(h)))break}return h}function r(a){X.ALL.push(a);X[a.type]||(X[a.type]=[]);X[a.type].push(a);
var c=a.g.se;if(null!=c)for(var d=0;d<Y.length;d++){var b=Y[d];b.g.se==c&&b.Ho.push(a)}}var l=n("__animation"),A=n("__batch"),x=n("__boundings"),L=n("__camera"),M=n("__config"),F=n("__constraints"),J=n("__geometry"),C=n("__lights"),H=n("__nla"),K=n("__nodemat"),d=n("__obj_util"),h=n("__particles"),v=n("__physics"),P=n("__print"),c=n("__primitives"),p=n("__quat"),N=n("__scenes"),G=n("__sfx"),u=n("__transform"),z=n("__textures"),q=n("__tsr"),D=n("__util"),I=n("__vec3"),m=n("__armature"),V=n("__anchors"),
Q=M.v,R=M.hc;a.Qz=-1;var X={ALL:[]},ja=new Float32Array(24),W=0,Z=0,Y=[],ia=[],ha=new Float32Array(3),ka=new Float32Array(4);a.It=0;a.Ht=1;a.Hc=2;a.vc=-1;a.update=function(a){for(var c=X.ARMATURE,d=0;d<ia.length;d++){var e=ia[d],h=e,f=a,g=0,m=h.EF;0==m.Xs&&(m.Xs=f);f-=m.Xs;if(m.$x&&f/m.re>=m.$x)b(h);else{f%=m.re;if(f<m.Ix)switch(m=f/(m.Ix/5),f=Math.floor(m),f){case 0:g=(m-f)/2;break;case 1:g=(m-f)/2+.5;break;case 2:g=1;break;case 3:g=1-(m-f)/2;break;case 4:g=.5-(m-f)/2}h.g.kh=g}e.g.kh&&k(e)}if(c)for(d=
0;d<c.length;d++)a=c[d],a.yx&&(u.o(a),a.yx=!1)};a.LG=function(a,c){a.g.kh=c;k(a)};a.Ck=function(a,c,d,b){var e=a.EF;e.Xs=0;e.Ix=c;e.re=d;e.$x=b;-1==ia.indexOf(a)&&ia.push(a)};a.nq=b;a.Di=function(a,c){c.Ei=a.uuid;c.bj=!0;w(a,c);a.Gu=c.Ha=B(a,c);a.BK=!0;c.Ed=a.b4w_vehicle;c.Ze=a.b4w_character;c.Ej=a.b4w_floating;c.hk=a.b4w_collision;c.pb=a.b4w_collision_id;c.vq=a.b4w_correct_bounding_offset;var b=a.game;c.Hf={ds:b.physics_type,ep:b.use_ghost,hI:b.use_sleep,jg:b.mass,lI:b.velocity_min,kI:b.velocity_max,
Qv:b.damping,ky:b.rotation_damping,hQ:b.lock_location_x,iQ:b.lock_location_y,jQ:b.lock_location_z,kQ:b.lock_rotation_x,lQ:b.lock_rotation_y,mQ:b.lock_rotation_z,hn:b.collision_margin,fn:b.collision_group,jn:b.collision_mask,pz:b.use_collision_bounds,qq:b.collision_bounds_type,cp:b.use_collision_compound};if(b=a.b4w_vehicle_settings)c.Vd={name:b.name,Id:b.part,$S:b.suspension_rest_length,Yy:b.suspension_compression,$y:b.suspension_stiffness,Zy:b.suspension_damping,Dz:b.wheel_friction,iy:b.roll_influence,
qx:b.max_suspension_travel_cm,Nn:b.force_max,Vm:b.brake_max,fm:b.steering_max,vl:b.max_speed_angle,vn:b.delta_tach_angle,Vo:b.speed_ratio,Xo:b.steering_ratio,eo:b.inverse_control,oj:b.floating_factor,nk:b.water_lin_damp,ok:b.water_rot_damp,vH:b.synchronize_position};if(b=a.b4w_floating_settings)c.Wk={name:b.name,Id:b.part,oj:b.floating_factor,nk:b.water_lin_damp,ok:b.water_rot_damp,vH:b.synchronize_position};if(b=a.b4w_character_settings)c.CB={wU:b.walk_speed,CR:b.run_speed,SS:b.step_height,PP:b.jump_strength,
yU:b.waterline};for(b=0;b<a.constraints.length;b++){var e=a.constraints[b];"RIGID_BODY_JOINT"==e.type&&c.Nx.push({target:e.target.ya,TQ:e.pivot_type,UQ:e.pivot_x,VQ:e.pivot_y,WQ:e.pivot_z,$d:e.axis_x,ae:e.axis_y,be:e.axis_z,bU:e.use_limit_x,cU:e.use_limit_y,dU:e.use_limit_z,XT:e.use_angular_limit_x,YT:e.use_angular_limit_y,ZT:e.use_angular_limit_z,ZP:e.limit_max_x,$P:e.limit_max_y,aQ:e.limit_max_z,bQ:e.limit_min_x,cQ:e.limit_min_y,dQ:e.limit_min_z,TP:e.limit_angle_max_x,UP:e.limit_angle_max_y,VP:e.limit_angle_max_z,
WP:e.limit_angle_min_x,XP:e.limit_angle_min_y,YP:e.limit_angle_min_z})}b=c.g=d.Mk("MESH"===c.type?c.Ha?"DYNAMIC":"STATIC":c.type);a.parent?(c.parent=a.parent.ya,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(c.xo=a.parent_bone),a.pinverse_tsr&&(c.fs=q.create(),q.copy(a.pinverse_tsr,c.fs))):a.dg_parent&&(c.parent=a.dg_parent.ya,c.ji=!0);var e=a.location,h=a.scale[0];D.Tx(a.rotation_quaternion,ka);u.kc(c,e);u.rg(c,ka);u.ve(c,h);c.dp=a.b4w_use_default_animation;c.Vi=l.Ku(a.b4w_anim_behavior);a.b4w_object_tags&&
(c.Kr={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,QW:a.b4w_object_tags.category});a.b4w_viewport_alignment&&(c.ot={DK:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":m.Di(a,c);e=b.Oe;h=l.ML(e);a.b4w_animation_mixing?(b.Kd=new Float32Array(h.Wa),b.te=new Float32Array(h.Wa),b.Td=new Float32Array(h.trans),b.Ee=new Float32Array(h.trans)):(b.Kd=h.Wa,b.te=h.Wa,b.Td=h.trans,b.Ee=h.trans);for(var f in e){var g=e[f];
1==g.kq.length&&m.xT(g,!0,h.trans,h.Wa)}b.Px=h;b.Ue=0;b.Wi=a.b4w_animation_mixing;break;case "MESH":b.Pk=a.b4w_do_not_render;b.Dk=A.vL(a.data.b4w_bounding_box);b.oi=R.outlining_overview_mode||a.b4w_selectable;b.Vr=a.b4w_selectable;b.hc=R.outlining_overview_mode||a.b4w_outlining;b.Ur=a.b4w_outlining;b.FF=R.outlining_overview_mode||a.b4w_outline_on_select;b.rf=a.b4w_billboard;b.av=a.b4w_pres_glob_orientation;b.Tm="BASIC";b.Sm="SPHERICAL"==a.b4w_billboard_geometry;f=b.Hl;f.Il=a.b4w_outline_settings.outline_duration;
f.Jl=a.b4w_outline_settings.outline_period;f.Kl=a.b4w_outline_settings.outline_relapses;b.oi&&(b.rq=D.XC(W),W++);for(f=0;f<a.data.b4w_vertex_anim.length;f++)e=a.data.b4w_vertex_anim[f],c.Fc.push({name:e.name,pa:e.frame_start,La:e.frame_end,JW:e.averaging,KW:e.averaging_interval,EK:e.allow_nla});c.g.Fc=c.Fc.length?!0:!1;"MESH"!=a.type&&D.l("Wrong object type: "+a.name);f=c.g;if(a.data.b4w_shape_keys.length)for(f.Pf=!0,e=0;e<a.data.b4w_shape_keys.length;e++)h={},h.value=a.data.b4w_shape_keys[e].value,
h.name=a.data.b4w_shape_keys[e].name,f.si.push(h);else f.Pf=!1;b.ye=a.b4w_shadow_cast;b.Qd=a.b4w_shadow_receive;b.Pd=a.b4w_shadow_cast_only&&b.ye;b.rd=a.b4w_reflexible;b.fd=a.b4w_reflexible_only&&b.rd;b.Md=a.b4w_reflective;b.pg=a.b4w_reflection_type;b.Ig=a.b4w_caustics;b.Ie=a.b4w_wind_bending;b.kp=a.b4w_wind_bending_angle;f=A.zU(a.b4w_wind_bending_angle,b.Dk,a.scale[0]);b.zg=f;b.Ch=a.b4w_wind_bending_freq;b.Pg=a.b4w_detail_bending_freq;b.Og=a.b4w_detail_bending_amp;b.Hg=a.b4w_branch_bending_amp;b.xj=
!1;b.bh=a.b4w_main_bend_stiffness_col;f=a.b4w_detail_bend_colors;b.ad={};b.ad.QE=f.leaves_stiffness_col;b.ad.PE=f.leaves_phase_col;b.ad.GF=f.overall_stiffness_col;b.kj=a.b4w_do_not_cull;b.Iq=a.b4w_disable_fogging;b.$f=a.b4w_dynamic_geometry;"MESH"!==a.type&&D.l("Wrong object");f=a.data.materials[0];b.Pn=f.physics.friction;b.En=f.physics.elasticity;b.po=0;b.ci=-1;b.tl=a.b4w_lod_transition;b.Cr=!0;break;case "LINE":b.kj=!0;b.R=x.bc();b.Pe=x.Ki();b.Ga=x.kf();b.I=x.bc();b.Yc=x.Ki();b.na=x.kf();break;
case "CAMERA":L.RL(a,c);L.mL(c);break;case "LAMP":C.QP(a,c);break;case "SPEAKER":c.P=G.aN();b=!1;for(f=0;f<c.A.length;f++)if(c.A[f].Ta.b4w_enable_audio){b=!0;break}b&&G.Di(a,c);break;case "EMPTY":b.R=x.bc(),f=x.Ki(),b.Pe=f,a.field&&(c.Vk={type:a.field.type,qH:a.field.strength}),a.b4w_anchor&&(c.anchor={type:a.b4w_anchor.type,Ok:a.b4w_anchor.detect_visibility,Lq:a.b4w_anchor.element_id,xQ:a.b4w_anchor.max_width})}r(c)};a.VT=function(a,c){c.Ei=a.uuid;c.bj=!0;w(a,c);a.Gu=c.Ha=B(a,c);a.BK=!0;c.g=d.Mk(c.type);
c.dp=a.b4w_use_default_animation;c.Vi=l.Ku(a.b4w_anim_behavior);r(c)};a.KT=function(a,c){var b=c.g;if(c.parent){!c.ji&&c.Hf.cp&&c.parent.Hf.cp&&(c.hk=!1);for(var e=!1,h=0;h<c.A.length;h++)if(c.A[h].Ta.Jb){e=!0;break}if(h=e)h=c.Hf,h=c.Ed||c.Ej||v.Ze(c)||c.hk&&!h.ep&&0<h.jg&&("DYNAMIC"==h.ds||"RIGID_BODY"==h.ds);if(h)h=c.ji?q.copy(b.i,q.create()):b.i,q.multiply(c.parent.g.i,h,b.i),u.kc(c,q.q(b.i)),u.ve(c,q.Oc(b.i)),u.rg(c,q.B(b.i));else if(c.ji||!c.xo)if(h=q.copy(b.i,q.create()),c.ot&&"CAMERA"==c.parent.type){h=
{distance:c.ot.distance,rotation:q.B(h)};switch(c.ot.DK){case "TOP_LEFT":h.top=0;h.left=0;break;case "TOP":h.top=0;h.left=.5;break;case "TOP_RIGHT":h.top=0;h.right=0;break;case "LEFT":h.top=.5;h.left=0;break;case "CENTER":h.top=.5;h.left=.5;break;case "RIGHT":h.top=.5;h.right=0;break;case "BOTTOM_LEFT":h.bottom=0;h.left=0;break;case "BOTTOM":h.bottom=0;h.left=.5;break;case "BOTTOM_RIGHT":h.bottom=0,h.right=0}F.Pu(c,c.parent,h)}else F.IK(c,c.parent,h);else h=q.copy(b.i,q.create()),F.JK(c,c.parent,
c.xo,h)}if("ARMATURE"==c.type)for(e=a.pose.bones,h=0;h<e.length;h++){var f=e[h],g=f.constraints;if(g)for(var m=0;m<g.length;m++){var k=g[m];"COPY_TRANSFORMS"!=k.type||k.subtarget||k.mute||F.UK(c,k.target.ya,f.name,D.AA,D.Bu)}}if("MESH"==c.type)var A=l.iD(a);if(A){g=A.ya;h=g.g.Px;e=c.g;f=a.data;c.$p=g;f=f.vertex_groups;if(f.length){var g=g.g.Oe,m=0,k={},n;for(n in g){var t=D.Lc("name",n,f);t&&(k[n]={oI:t.index,Lh:g[n].Lh,Uv:m++})}e.Fk=k;n=m;f=l.yD();e.dh=n;n>2*f?(e.ml=!1,P.error('too many bones for "'+
a.name+'" / '+e.dh+" bones (max "+f+" with blending, "+2*f+" without blending). Skinning will be disabled.")):e.ml=!0}n=l.ZN(h.trans,h.Wa,b.Fk);A.b4w_animation_mixing?(b.Kd=new Float32Array(n.Wa),b.te=new Float32Array(n.Wa),b.Td=new Float32Array(n.trans),b.Ee=new Float32Array(n.trans)):(b.Kd=n.Wa,b.te=n.Wa,b.Td=n.trans,b.Ee=n.trans);b.Tu=new Float32Array(4);b.Su=p.create();b.Px=n;b.Ue=0}if(b.Md)if(b=c.g,"CUBE"==b.pg)b.Qe=Z++;else if("PLANE"==b.pg){a:{A=a.constraints;for(n=0;n<A.length;n++)if(h=A[n],
"LOCKED_TRACK"==h.type&&"REFLECTION PLANE"==h.name){if(h.target.ya){A=h.target.ya;break a}P.warn('Reflection plane target "'+h.target.name+'" for object: "'+c.name+"\" is not present on the scene. Using object's Z-axis.")}A=null}A||(A=D.Zo("%reflection%"),A=d.pn(A,"EMPTY"),n=d.Mk("EMPTY"),A.g=n,y(c,A),F.YA(A,c,[0,0,0],null,1),r(A));n=null;for(h=0;h<Y.length;h++)if(Y[h]==A){n=h;break}null==n&&(n=Y.length,Y.push(A));A.g.se=n;b.se=n;A.Ho.push(c)}};a.FT=e;a.sX=y;a.aM=g;a.LT=function(a){for(var c=0;c<
a.length;c++){var d=a[c];!d.g||"DYNAMIC"!=d.g.type&&"CAMERA"!=d.g.type||u.o(d);d.dp&&l.BF(d)&&(l.Zp(d),d.W.length&&l.play(d,null,l.Gm))}};a.Yq=function(a){return D.ia(a.Kr)};a.ha=function(){Z=W=0;Y.length=0;ia.length=0;X={ALL:[]}};a.copy=function(a,c,b){var e=c,h=d.Xg(a);c=h?d.YC(h.name,c):c;if(f(c,X.ALL,!1,-1)){for(var h=1,g;;){g="."+(3>String(h).length?("000"+String(h)).slice(-3):String(h));if(!f(c+g,X.ALL,!1,-1))break;h++}P.error('Object "'+c+'" already exists. Name was replaced by "'+c+g+'".');
e+=g;c+=g}e=d.pn(c,a.type,e);e.bj=a.bj;e.Ha=a.Ha;e.io=a.io;e.dp=a.dp;e.g=d.Ik(a.g);e.Kr=d.Ik(a.Kr);y(a,e);e.wk=d.Av(a.wk);e.parent=d.Av(a.parent);e.ji=a.ji;e.xo=a.xo;e.Fc=d.Av(a.Fc);e.Vi=a.Vi;!a.r||a.Ed||a.Ze||a.Ej||(e.hk=a.hk,e.r=null);e.pb=a.pb;e.vq=a.vq;e.Hf=d.Ik(a.Hf);c=[];for(h=0;h<a.A.length;h++){var m=e.A[h];g=a.A[h].X;if(b){for(var m=m.X,p=0;p<g.length;p++)if(!g[p].dg){var l=d.Ik(g[p]);m.push(l);c.push(g[p].oa)}for(p=0;p<g.length;p++)if(g[p].dg){l=d.Ik(g[p]);m.push(l);for(var v=0;v<c.length;v++)c[v]==
g[p].oa&&(l.oa=m[v].oa)}for(p=0;p<m.length;p++)m[p].oa&&J.YH(m[p].oa),m[p].Gl=e.Ei,A.sT(m[p],A.OL(e.g));z.CS(m)}else m.X=d.AM(g)}d.ly(e,!1);r(e);e.g.xE=!0;e.g.yE=b;e.g.rq=D.XC(W);W++;return e};a.yT=function(a){for(var d=a.g,b=a.A[0].X,e,h,f,g,m,p,l,v,k,q,r,n,t=[],z=0;z<b.length;z++){var w=b[z];if("MAIN"==w.type){var I=b[0].oa.sd,P=b[0].oa.ed.a_position.offset;e=g=I[P];h=m=I[P+1];f=p=I[P+2]}}for(z=0;z<b.length;z++)if(w=b[z],w.oa&&w.na&&w.I){var I=w.oa.sd,P=w.oa.ed.a_position.offset,G=w.oa.ed.a_position.length+
P;l=q=I[P];v=r=I[P+1];k=n=I[P+2];for(var D=P;D<G;D+=3){var P=I[D],B=I[D+1],Y=I[D+2];l=Math.max(P,l);v=Math.max(B,v);k=Math.max(Y,k);q=Math.min(P,q);r=Math.min(B,r);n=Math.min(Y,n)}w.R.max_x=l.toFixed(3);w.R.max_y=v.toFixed(3);w.R.max_z=k.toFixed(3);w.R.min_x=q.toFixed(3);w.R.min_y=r.toFixed(3);w.R.min_z=n.toFixed(3);x.Gg(w.R,d.i,w.I);x.Kn(w.I,ja);for(I=t.length=0;I<ja.length;I++)t.push(ja[I]);w.na=x.wq(t,!0);w.Ga=x.gv(w.na,d.i);"MAIN"==w.type&&(e=Math.max(l,e),h=Math.max(v,h),f=Math.max(k,f),g=Math.min(q,
g),m=Math.min(r,m),p=Math.min(n,p))}l={max_x:parseFloat(e.toFixed(3)),max_y:parseFloat(h.toFixed(3)),max_z:parseFloat(f.toFixed(3)),min_x:parseFloat(g.toFixed(3)),min_y:parseFloat(m.toFixed(3)),min_z:parseFloat(p.toFixed(3))};r=e-g;k=h-m;v=f-p;g=.5*(e+g);q=.5*(h+m);n=.5*(f+p);var y=g,N=n;m=Math.max(r,Math.max(k,v))/2;p=Math.max(r,v)/2;var H=[g/(r?r:1),q/(k?k:1),n/(v?v:1)],t=.5;if(d.rf)P=Math.max(Math.abs(l.max_x),Math.abs(l.min_x)),B=Math.max(Math.abs(l.max_y),Math.abs(l.min_y)),Y=Math.max(Math.abs(l.max_z),
Math.abs(l.min_z)),f=Math.sqrt(P*P+B*B+Y*Y),z=Math.sqrt(P*P+B*B),l.max_x=l.max_y=l.max_z=f,l.min_x=l.min_y=l.min_z=-f,p=z,m=f,P=new Float32Array([0,0,0]),e=new Float32Array([m,m,m]),f=new Float32Array([0,0,0]);else{for(z=0;z<b.length;z++)if(w=b[z],"MAIN"==w.type)for(I=w.oa.sd,G=b[z].oa.ed,P=G.a_position.offset,G=G.a_position.length+P,D=P;D<G;D+=3){var P=I[D],B=I[D+1],Y=I[D+2],K=Math.sqrt((g-P)*(g-P)+(q-B)*(q-B)+(n-Y)*(n-Y));if(K>m){var w=g-m*(P-g)/K,R=q-m*(B-q)/K,K=n-m*(Y-n)/K;g=(w+P)/2;q=(R+B)/2;
n=(K+Y)/2;m=Math.sqrt((g-P)*(g-P)+(q-B)*(q-B)+(n-Y)*(n-Y))}R=Math.sqrt((y-P)*(y-P)+(N-Y)*(N-Y));R>p&&(w=y-p*(P-y)/R,K=N-p*(Y-N)/R,y=(w+P)/2,N=(K+Y)/2,p=Math.sqrt((y-P)*(y-P)+(N-Y)*(N-Y)));P/=r?r:1;B/=k?k:1;Y/=v?v:1;K=Math.sqrt((H[0]-P)*(H[0]-P)+(H[1]-B)*(H[1]-B)+(H[2]-Y)*(H[2]-Y));K>t&&(w=H[0]-t*(P-H[0])/K,R=H[1]-t*(B-H[1])/K,K=H[2]-t*(Y-H[2])/K,H[0]=(w+P)/2,H[1]=(R+B)/2,H[2]=(K+Y)/2,t=Math.sqrt((H[0]-P)*(H[0]-P)+(H[1]-B)*(H[1]-B)+(H[2]-Y)*(H[2]-Y)))}z=r?r*H[0]:e;h=k?k*H[1]:h;f=v?v*H[2]:f;e=t*r;I=
t*k;G=t*v;P=new Float32Array([g,q,n]);e=new Float32Array([e,I,G]);f=new Float32Array([z,h,f]);p=parseFloat(p.toFixed(3))}d.R=l;A.bS(d,p,p,l);l=x.xq(m,P);d.Pe=l;l=x.nn([e[0],0,0],[0,e[1],0],[0,0,e[2]],f);d.Ga=l;u.o(a);if(Q.debug_view)for(z=0;z<b.length;z++)if("DEBUG_VIEW"===b[z].type&&b[z].hj){a=c.sw(1,l.O);J.tG(a,[l.$d[0],l.ae[1],l.be[2]],l.O);J.Vs(a,1,!0);a.ba.a_polyindex=J.Oq(a);A.rT(b[z],a);break}};a.Pb=t;a.aP=function(a,c){for(var d=X.ALL||[],b=[],e=0;e<d.length;e++){var h=d[e];if((h.g.Ad==c||
-1==c)&&h.bj)for(var f=h.A,g=0;g<f.length;g++)f[g].Ta==a&&b.push(h)}return b};a.uj=function(a){var c=X.ALL;if(-1==a)return c;for(var d=[],b=0;b<c.length;b++){var e=c[b];e.g.Ad==a&&d.push(e)}return d};a.JS=function(a){var c=t(a,"LAMP",-1);if(c.length==a.j.b0){for(var b=[],e=0;e<c.length;e++){var h=c[e],h=d.aa(h,a);b[h.Fj]=e}for(e=0;e<b.length-1;e++)for(h=e+1;h<b.length;h++){var f=c[b[e]].$b,g=c[b[h]].$b;if(g.rm&&g.ik&&(!f.rm||!f.ik)||!f.rm&&(g.rm||!f.ik&&g.ik))f=b[e],b[e]=b[h],b[h]=f}for(e=0;e<b.length;e++)h=
c[b[e]],d.aa(h,a).Fj=e,N.ZH(c[b[e]],a)}};a.C2=function(a){for(var c=t(a,"LAMP",-1),b=t(a,"MESH",-1),e=0;e<b.length;e++)for(var h=d.aa(b[e],a).X,f=0;f<h.length;f++){var g=h[f];"MAIN"==g.type&&(A.tT(g,c,a),A.Uc(g))}};a.Sr=function(a,c,d,b,e){for(var h=0;h<a.A.length;h++)for(var f=a.A[h].X,g=0;g<f.length;g++){for(var m=f[g],p=0;p<m.fa.length;p++)m.fa[p].Nh=c;m.oa.Nh=d;m.rb.Nh=b;""!==m.Cl&&(m=K.BD(m.Cl))&&(m.LB=e)}};a.LD=function(){for(var a=[],c=X.MESH,d=0;d<c.length;d++){var b=c[d];b.g.oi&&b.bj&&a.push(b)}return a};
a.sZ=function(){for(var a=[],c=X.MESH,d=0;d<c.length;d++){var b=c[d];b.g.hc&&b.bj&&a.push(b)}return a};a.gc=function(c,b,e,h){var g=null,m=X.ALL;switch(c){case a.It:g=f(b,m,!0,e);break;case a.Ht:a:{for(c=0;c<m.length;c++)if(g=m[c],g.Qj==e&&(g.g.Ad==h||-1==h)){var p=d.Xg(g);if(p&&p.Qj==b)break a}g=null}break;case a.Hc:a:{for(h=0;h<m.length;h++){c=m[h];for(var g=b.length-1,p=c,l=!0;0<=g&&l;)l=p&&p.Qj==b[g]&&(p.g.Ad==e||-1==e),p&&(p=d.Xg(p)),g--;if(l&&!p){g=c;break a}}g=null}}return g};a.cr=function(a,
c){return f("%meta_world%"+a,X.WORLD,!0,c)};a.es=function(c,d){var b=N.wj();if(!b)return P.error("No active scene"),null;var e=V.RQ(c,d);if(e)return e;e=N.SQ(b,c,d);if(!e)return null;for(var b=t(b,"MESH",-1),h=0;h<b.length;h++){var f=b[h].g,g=f.rq;if(g&&3>Math.abs(255*g[0]-e[0])&&3>Math.abs(255*g[1]-e[1])&&3>Math.abs(255*g[2]-e[2]))return f.hc&&f.FF&&(R.outlining_overview_mode?a.Ck(b[h],R.Il,R.Jl,R.Kl):(e=f.Hl,a.Ck(b[h],e.Il,e.Jl,e.Kl))),b[h]}return null};a.WG=function(a,c){for(var d=t(a,"EMPTY",
-1),b=0;b<d.length;b++){var h=d[b];if(h.Vk&&"WIND"===h.Vk.type)var f=h}if(!f)return P.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=D.jb(c.wind_dir),I.set(Math.sin(d),0,Math.cos(d),ha),D.Yv(ha,D.uc,ka),u.rg(f,ka));"number"==typeof c.wind_strength&&(f.Vk.qH=c.wind_strength);e(f)};a.Jo=function(a){F.bM(a)&&F.remove(a);var c=X.ALL,d=X[a.type],b=c.indexOf(a);a=d.indexOf(a);-1!=b&&c.splice(b,1);-1!=a&&d.splice(a,1)};a.JQ=r;a.KQ=function(a){return X[a.type]&&-1<X[a.type].indexOf(a)}};b4w.module.__lights=function(a,n){function k(a){y.scale(a.color,a.Rg,a.kn)}n("__print");var b=n("__tsr"),e=n("__util"),y=n("__vec3"),g=new Float32Array(3);new Float32Array(3);a.QP=function(a,n){var t=a.data,f=n.$b={name:"",type:t.type,RF:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),kn:new Float32Array(3),wN:0,am:0,Ss:0,cn:.1,bn:30,bD:!1,qF:!1,IN:!1,rm:!0,ik:!0,Rg:1,distance:25,dY:"INVERSE_SQUARE"};f.name=n.name;f.rm=t.use_diffuse;f.ik=t.use_specular;var r=e.Cb(b.B(n.g.i),
e.uc,g);y.normalize(r,r);f.direction.set(r);f.color[0]=t.color[0];f.color[1]=t.color[1];f.color[2]=t.color[2];f.Rg=f.wN=t.energy;k(f);f.distance=t.distance;f.cn=t.clip_start;f.bn=t.clip_end;if("POINT"===f.type||"SPOT"===f.type)f.distance=t.distance;"SPOT"===f.type?(f.Ss=t.spot_blend,f.am=t.spot_size):"POINT"===f.type&&(f.am=Math.PI/2);f.bD=t.b4w_generate_shadows;f.IN=t.b4w_dynamic_intensity};a.$R=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];k(a)};a.c1=function(a,b){a.Ss=b};a.b1=function(a,
b){a.distance=b};a.d1=function(a,b){a.am=b};a.aS=function(a,b){a.Rg=b;k(a)};a.HT=function(a){var g=a.$b;if(g){e.Cb(b.B(a.g.i),e.uc,g.direction);y.normalize(g.direction,g.direction);if("SUN"==g.type){a=Math.acos(y.dot(g.RF,e.Eu));var k=Math.acos(y.dot(g.direction,e.Eu));g.qF=Math.floor(a/.025)!=Math.floor(k/.025)?!0:!1}y.copy(g.direction,g.RF)}}};b4w.module.__nla=function(a,n){function k(){return{type:"CLIP",pa:0,La:0,ph:!1,paused:!1,Me:"",Nm:"",Kb:0,Hh:0,Ti:0,EC:0,DC:0,gI:!1,scale:1,repeat:1,RA:0}}function b(a,e){if(a.animation_data){var f=a.animation_data.nla_tracks;if(f)for(var g=0;g<f.length;g++)e.push(f[g])}f=a.nodes;for(g=0;g<f.length;g++){var c=f[g];c.node_group&&(c=c.node_group.node_tree)&&b(c,e)}}function e(a,b){var e=Math.round(a)-b.pa;b.gk&&(e%=b.Zk,0>e&&(e+=b.Zk));return b.ub+e}function y(a,b){var e=(b-K)*J.Dc()+a.ub;e>a.pa?(e-=
a.pa,a.nd&&(e%=a.La-a.pa+1),e+=a.pa):e=a.pa;return e}function g(a,b){a=C.S(a,b.pa,b.La);var e=a==b.La?b.RA:b.Hh+(a-b.pa)/b.scale%(b.Ti-b.Hh);b.gI&&(e=b.Ti-e+b.Hh);return e}function B(a,b){for(var e=[],f=0;f<a.length;f++){var c=a[f].strips;if(c)for(var g=0;g<c.length;g++){var l=c[g],r=k();r.type=l.type;r.pa=l.frame_start;r.La=l.frame_end;r.Kb=b;r.Hh=l.action_frame_start;r.Ti=l.action_frame_end;r.gI=l.use_reverse;r.scale=l.scale;r.repeat=l.repeat;l.action&&(r.Me=l.action.name,r.Nm=l.action.uuid);e.push(r)}}return e}
function w(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function t(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var e=a[b],f=e.node_tree;if(e=e.use_nodes&&f)a:{if(f.animation_data&&(e=f.animation_data.nla_tracks)&&e.length){e=!0;break a}f=f.nodes;for(e=0;e<f.length;e++);e=!1}if(e)return!0}return!1}function f(a,b){var e=L.p();if(e.ga){var f=y(e.ga,b);e.ga.ub-=f-a;e.ga.Xk=!0}}
var r=n("__animation");n("__config");var l=n("__objects"),A=n("__obj_util"),x=n("__print"),L=n("__scenes"),M=n("__sfx"),F=n("__textures"),J=n("__time"),C=n("__util"),H=[],K=-1;a.Di=function(a,e){var f;f=null;for(var g=e.A.length-1;0<=g;g--){var c=e.A[g];if(c.Ta.b4w_use_nla&&(f=c,c.Ta.NA))break}if(f){f.AF=!0;var p=0;if((g=a.animation_data)&&g.nla_tracks.length){var l=g.nla_tracks;if(A.Cj(e)||A.la(e)||A.Pc(e)||A.fo(e)||A.wr(e)||A.mo(e)||A.$w(e))l=B(l,p),l.length&&(e.af=e.af.concat(l),p++)}w(a)&&(l=
a.data.animation_data.nla_tracks,l=B(l,p),l.length&&(e.af=e.af.concat(l),p++));if(A.Pc(e))for(c=a.data.materials,g=0;g<c.length;g++){var n=c[g];if(n.use_nodes&&n.node_tree&&(l=[],b(n.node_tree,l),l=B(l,p),l.length)){for(var n=p,u=l,t=r.FO(),q=[],x=0,I=0;I<u.length;I++){var m=u[I];""!=m.Nm?m=C.Lc("uuid",m.Nm,t):(m=m.Me,m=C.Lc("name",m,t)||C.Lc("name",m+"_B4W_BAKED",t));if(m){var m=m.fcurves,y=[],Q;for(Q in m)y.push(Q);q.push(y)}}for(I=0;I<q.length;I++){t=!1;for(m=0;m<I;m++)if(C.jL(q[I],q[m])){u[I].Kb=
u[m].Kb;t=!0;break}t||(u[I].Kb=p+x++)}p=n+x;e.af=e.af.concat(l)}}if(!A.$w(e)){for(g=0;g<a.particle_systems.length;g++)c=a.particle_systems[g],Q=c.settings,"EMITTER"==Q.type&&Q.b4w_allow_nla&&(Q=k(),Q.type="CLIP",Q.pa=f.Ta.frame_start,Q.La=f.Ta.frame_end+1,Q.Me=c.name,Q.Kb=p,Q.Hh=Q.pa,Q.Ti=Q.La,e.af.push(Q),p++);c=p+1;for(g=0;g<e.Fc.length;g++)l=e.Fc[g],l.EK&&(p=c,Q=k(),Q.type="CLIP",Q.pa=f.Ta.frame_start,Q.La=f.Ta.frame_end+1,Q.Me=l.name,Q.Kb=p,Q.Hh=Q.pa,Q.Ti=Q.La,e.af.push(Q))}}};a.PT=function(a,
b,e){a.ga||(a.ga={pa:a.frame_start,La:a.frame_end,ub:0,oo:-1,Co:a.frame_end,Do:a.frame_start,sm:null,nd:b,qb:[],fa:[],uG:a.name,ai:!1,Xk:!1,hy:!0},H.push(a.ga));b=a.ga;for(var f=l.aP(a,e),c=0;c<f.length;c++){var g=f[c];if(g.af.length){for(var r=0;r<g.A.length;r++){var n=g.A[r];n.Ta==a&&n.AF&&b.qb.push(g)}for(var r=g.af,n=b,u=g.name,A=0;A<r.length;A++){var q=r[A];n.pa>q.La||n.La<q.pa?(x.warn("NLA: Strip is out of scene range: "+(u+" ["+q.pa+":"+q.La+"]")),r.splice(A,1),A--):q.Me||"CLIP"!=q.type||(x.warn('NLA: no action in strip for object "'+
u+'".'),r.splice(A,1),A--)}g=g.af;r=b;for(n=0;n<g.length;n++){for(var u=g[n],A=r.pa,q=r.La+1,t=0;t<g.length;t++){var w=g[t];u.Kb==w.Kb&&(w.La<=u.pa&&(A=u.pa),w.pa>=u.La&&(q=Math.min(q,w.pa)))}u.EC=A;u.DC=q;u.RA=0===u.repeat%1?u.Ti:u.Hh+u.repeat%1*(u.Ti-u.Hh)}}}a=a.j.wm;for(c=0;c<a.length;c++)f=a[c].j,f.jt&&(f.Ba||f.Qc)&&f.Ah==e&&(g=k(),g.type="VIDEO",f.gk?(g.pa=0,g.La=b.La):(g.pa=C.S(f.pa,0,b.La),g.La=C.S(f.pa+f.Zk,0,b.La)),g.Me=a[c].name,b.fa.push(f))};a.start=function(){K=0};a.dP=function(){return K};
a.WY=function(a){return a.ga?a.ga.ub:null};a.Z0=function(a,b){return a.ga?(a.ga.ub=b,!0):!1};a.update=function(a,b){if(!(0>K)){0==K&&(K=a);for(var l=0;l<H.length;l++){var k=H[l];k.ai&&(k.ub-=J.Dc()*b);var c=y(k,a);if((!k.ai||k.Xk)&&c>=k.Co)if(k.nd){var c=k,p=a;c.sm&&c.sm();f(c.Do,p);c.hy=!0;c=y(c,p)}else{var p=k,n=c;p.ai=!0;p.ub-=n-p.Co;p.sm&&p.sm()}if(!k.ai||k.Xk){for(var p=k,n=c,A=0;A<p.qb.length;A++){for(var u=p.qb[A],t=u.af,q=0;q<t.length;q++){var x=t[q];"SOUND"==x.type&&n<p.oo-1E-6&&(x.ph=!1)}for(q=
0;q<t.length;q++)switch(x=t[q],x.type){case "CLIP":if(x.EC<=n&&n<x.DC&&!x.ph){var w=u,m=x;""!=m.Nm?r.cL(w,m.Nm,m.Kb):r.apply(w,m.Me,m.Kb);r.Qo(w,r.st,m.Kb);var B=g(m.pa,m);r.Tl(w,B,m.Kb);for(w=0;w<t.length;w++)t[w]!=x&&t[w].Kb==x.Kb&&(t[w].ph=!1);x.ph=!0}x.ph&&(w=u,m=g(n,x),1E-6<Math.abs(m-r.nD(w,x.Kb))&&r.Tl(w,m,x.Kb));break;case "SOUND":(n<p.oo-1E-6||p.oo<x.pa)&&x.pa<=n&&n<x.La&&!x.ph&&(w=u,B=x,m=(B.pa-n)/J.Dc(),B=(B.La-B.pa)/J.Dc(),M.play(w,m,B),x.ph=!0),p.oo<x.La&&x.La<=n&&x.ph&&(x.ph=!1)}}p=
a;n=k;A=c;for(u=0;u<n.fa.length;u++)if(t=n.fa[u],t.Ba||t.Qc){q=F.pI(t);x=t;w=C.S(e(A,x),x.ub,x.ub+F.qI(x)-1);x.Qc&&(w=F.rU(x,w),w==x.py&&w--);x=w;w=F.rI(t);B=m=!1;if(n.Xk||n.hy)B=!0;if(!n.ai){var Q;Q=e(A,t);Q=t.ub<=Q&&Q<=t.ub+F.qI(t);var R=F.sI(t);t.gk&&x==w&&(B=!0);R||q==x||(B=!0);Q&&!R?F.QF(t.name,t.Ah):Q&&R?m=!0:!Q&&R&&(t.Ba&&q<x?m=!0:F.Lx(t.name,t.Ah))}B?(F.UR(t.name,x,t.Ah),t.Qc&&(t.Sl=F.us(t,p))):m&&F.tI(t)&&(t.Ba?F.dI(t):(q=F.us(t,p),q!=t.Sl&&(t.ak=x,F.cI(t)),t.Sl=q))}k.oo=c}k.Xk=!1;k.hy=!1}}};
a.ha=function(){H.length=0;K=-1};a.qB=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||w(a)||t(a)?!0:!1};a.Tl=f;a.Vn=function(a){var b=L.p();return b.ga?y(b.ga,a):-1};a.oH=function(){var a=L.p();a.ga&&(a.ga.ai=!0);for(var a=a.ga.fa,b=0;b<a.length;b++){var e=a[b];F.Lx(e.name,e.Ah)}};a.ZQ=function(){var a=L.p();a.ga&&(a.ga.ai=!1,a.ga.sm=null)};a.XY=function(){var a=L.p();return a.ga?a.ga.pa:-1};a.vD=function(){var a=L.p();return a.ga?a.ga.La:-1};a.$h=function(){var a=L.p();return a.ga?
!a.ga.ai:!1};a.$W=function(){var a=L.p();return a.ga?a.b4w_use_nla:!1};a.ZW=function(){var a=L.p();return a.ga?0<a.b4w_logic_nodes.length:!1};a.q1=function(a,b){var e=L.p();if(e.ga)e.ga.Do=a,e.ga.Co=b;else return!1};a.By=function(a){var b=L.p();b.ga&&(b.ga.Co=a)};a.hS=function(a){var b=L.p();b.ga&&(b.ga.Do=a)};a.F0=function(){var a=L.p();if(a.ga)a=a.ga,a.Do=a.pa,a.Co=a.La;else return!1};a.T0=function(a){var b=L.p();if(b.ga)b.ga.nd=a;else return!1};a.gX=function(){var a=L.p();a.ga&&(a.ga.sm=null)};
a.JG=function(a){var b=L.p().ga;b&&(b.ub=-(a-K)*J.Dc()+b.Do,b.Xk=!0)};a.vD=function(){var a=L.p().ga;return a?a.La:null}};b4w.module.__scenes=function(a,n){function k(a){for(var c=0;c<a.length;c++){var d=a[c];if(!d.Le||!d.Le.length)return d}return null}function b(){Rb||Ha.l("No active scene available");return Rb}function e(a,c,d){if(!ta.Hq||!y(a,c,d))return null;d=a.b4w_shadow_settings;var b={};d.csm_resolution>ta.Rb?(b.csm_resolution=ta.Rb,ab.error("Shadow map texture has unsupported size. Changed to "+ta.Rb+".")):b.csm_resolution=d.csm_resolution;a=Ka.ar(c,ta.Rd&&a.b4w_enable_ssao);b.self_shadow_polygon_offset=d.self_shadow_polygon_offset;
b.self_shadow_normal_offset=d.self_shadow_normal_offset;b.enable_csm=d.b4w_enable_csm&&1==a.length;b.Bf=[];b.kH=[];b.FN=[];b.cn=[];b.bn=[];for(c=0;c<a.length;c++)b.Bf.push(a[c].$b.type),b.kH.push(a[c].$b.am),b.FN.push(a[c].$b.distance),b.cn.push(a[c].$b.cn),b.bn.push(a[c].$b.bn),"SPOT"!=b.Bf[c]&&"POINT"!=b.Bf[c]||!b.enable_csm||(ab.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),b.enable_csm=!1);b.enable_csm?(b.csm_num=d.csm_num,b.csm_first_cascade_border=d.csm_first_cascade_border,
b.first_cascade_blur_radius=d.first_cascade_blur_radius,b.csm_last_cascade_border=d.csm_last_cascade_border,b.last_cascade_blur_radius=d.last_cascade_blur_radius,b.fade_last_cascade=d.fade_last_cascade,b.blend_between_cascades=d.blend_between_cascades):(b.csm_num=1,b.csm_first_cascade_border=d.csm_first_cascade_border,b.first_cascade_blur_radius=d.first_cascade_blur_radius,b.csm_last_cascade_border=d.csm_last_cascade_border,b.last_cascade_blur_radius=d.last_cascade_blur_radius,b.fade_last_cascade=
!1,b.blend_between_cascades=!1);return b}function y(a,c,d){if(0!=c.length&&ta.Ul)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var b=!1,e=!1;a=ta.Rd&&a.b4w_enable_ssao;if(0==c.length&&!a)return!1;for(c=0;c<d.length;c++){var f=d[c];f.b4w_shadow_cast&&(b=!0);f.b4w_shadow_receive&&(e=!0);if((a||b)&&e)return!0}return!1}function g(a){for(var c=0;c<a.length;c++)if("SUN"==a[c].$b.type)return!0;return!1}function B(a){if(!ta.ti)return!1;a=E(a);for(var c=0;c<a.length;c++){var d=
a[c];if(d.b4w_water&&d.b4w_water_shore_smoothing)return!0}return!1}function w(a){for(var c=0;c<a.length;c++)for(var d=a[c].particle_systems,b=0;b<d.length;b++)if(Ka.GB(a[c],d[b].settings))return!0;return!1}function t(a){for(var c=E(a),d=[],b=0;b<c.length;b++){var e=c[b];if(e.b4w_water){for(var f={},h=0;h<a.length;h++)for(var g=a[h],m=g.data.materials,p=0;p<m.length;p++)m[p]==e&&(f.Ii=g.location[1]);f.od=e.b4w_water_fog_color.slice(0);f.od.push(e.b4w_water_fog_density);e.b4w_water_dynamic?(f.Cn=!0,
f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,f.dst_min_fac=e.b4w_water_dst_min_fac,
f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.Cn=!1,f.waves_height=0,f.waves_length=0);f.Ig=e.b4w_water_enable_caust;f.TL=e.b4w_water_caust_scale;f.SL=e.b4w_water_caust_brightness;f.UL=new Float32Array([.3,.7]);f.ui=null;e=e.texture_slots;for(h=0;h<e.length;h++)g=e[h].texture,!0===g.b4w_shore_dist_map&&"FILE"==g.image.source&&(f.ui=g.image,f.Jy=g.image.size[0],f.px=g.b4w_max_shore_dist,g=g.b4w_shore_boundings,f.Vl=[(g[0]+g[1])/2,(g[2]+g[3])/2],f.Wl=[g[0]-g[1],g[2]-g[3]]);d.push(f)}}if(0<d.length){f=
d[0];if(!f.Cn)for(b=0;b<d.length;b++)d[b].Cn&&(f=d[b]);return f}return null}function f(a){function c(a){if(a){a=a.nodes;for(var b=0;b<a.length;b++){var e=a[b];"GROUP"==e.type&&e.node_group&&c(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(d.gd=!0)}}}var d={gd:!1};a=E(a);for(var b=0;b<a.length;b++){var e=a[b];e.b4w_refractive&&(d.gd=!0);e.node_tree&&c(e.node_tree)}return d}function r(a,c,d){if(ta.Go)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;a=
[];for(var b=0,e=!1,f=0;f<c.length;f++){var h=c[f];h.g.Md&&"CUBE"==h.g.pg&&b++;if(h.Ho.length){for(var g=null,m=0;m<a.length;m++)if(a[m]==h){g=m;break}null==g&&a.push(h)}}for(f=0;f<d.length;f++){a:if(c=d[f],c.b4w_reflexible){c=c.data.materials;for(h=0;h<c.length;h++)if(g=c[h].game_settings.alpha_blend,"OPAQUE"!=g&&"CLIP"!=g){c=!0;break a}c=!1}else c=void 0;c&&(e=!0)}return{hG:a,xF:b,Mg:[],Mv:[],ng:[],gs:[],kE:e}}function l(a,c){var d=a.b4w_sky_settings,b={};b.pR=d.render_sky;b.procedural_skydome=
d.procedural_skydome&&c;b.use_as_environment_lighting=d.use_as_environment_lighting;b.Xl=d.color;b.rayleigh_brightness=d.rayleigh_brightness;b.mie_brightness=d.mie_brightness;b.spot_brightness=d.spot_brightness;b.scatter_strength=d.scatter_strength;b.rayleigh_strength=d.rayleigh_strength;b.mie_strength=d.mie_strength;b.rayleigh_collection_power=d.rayleigh_collection_power;b.mie_collection_power=d.mie_collection_power;b.mie_distribution=d.mie_distribution;b.rd=d.reflexible;b.fd=d.reflexible_only;!c&&
d.procedural_skydome&&ab.warn("There is no sun on the scene. Procedural sky won't be rendered");return b}function A(a){var c={};a=a.b4w_ssao_settings;c.radius_increase=a.radius_increase;c.pP=a.hemisphere;c.CL=a.blur_depth;c.pB=a.blur_discard_value;c.influence=a.influence;c.dist_factor=a.dist_factor;c.DR=a.samples;return c}function x(a){if(!(ta.gq&&a.b4w_enable_bloom&&a.j.vh))return null;var c={};a=a.b4w_bloom_settings;c.blur=a.blur;c.JN=a.edge_lum;c.key=a.key;return c}function L(a){var c={};a=a.b4w_motion_blur_settings;
c.mb_decay_threshold=a.motion_blur_decay_threshold;c.mb_factor=a.motion_blur_factor;return c}function M(a){var c={};a=a.b4w_color_correction_settings;c.brightness=a.brightness;c.contrast=a.contrast;c.exposure=a.exposure;c.saturation=a.saturation;return c}function F(a){var c={};a=a.b4w_god_rays_settings;c.Uw=a.intensity;c.ul=a.max_ray_length;c.hm=a.steps_per_pass;return c}function J(a){var c={};c.jh=a.b4w_outline_color;c.uo=a.b4w_outline_factor;return c}function C(a){var c={};a=a.b4w_glow_settings;
c.small_glow_mask_coeff=a.small_glow_mask_coeff;c.large_glow_mask_coeff=a.large_glow_mask_coeff;c.small_glow_mask_width=a.small_glow_mask_width;c.large_glow_mask_width=a.large_glow_mask_width;return c}function H(a,c){var d=a.light_settings,b={};b.Sg=d.environment_energy;b.qz=d.use_environment_light;b.ew=d.environment_color;b.ne=a.horizon_color.slice(0);b.Je=a.zenith_color.slice(0);b.kU=a.use_sky_paper;b.jU=a.use_sky_blend;b.lU=a.use_sky_real;b.eH=null;b.My=null;b.fw=null;if(b.qz&&"SKY_TEXTURE"==b.ew&&
(!c.procedural_skydome||!c.use_as_environment_lighting)){for(var d=null,e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_environment_lighting){d=a.texture_slots[e];break}d?b.fw=d:(ab.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),b.qz=!1)}for(e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_skydome){d=a.texture_slots[e];b.eH=d;b.My={zL:d.blend_factor,
rP:d.horizon_factor,CU:d.zenith_up_factor,BU:d.zenith_down_factor,color:d.color,Ya:d.default_value,invert:d.invert,iU:d.use_rgb_to_intensity,AL:d.blend_type,eU:d.use_map_blend,fU:d.use_map_horizon,hU:d.use_map_zenith_up,gU:d.use_map_zenith_down};break}return b}function K(a){var c=a.fog_settings,d={};d.aU=c.use_fog;d.Uw=c.intensity;d.depth=c.depth;d.start=c.start;d.height=c.height;d.bO=c.falloff;d.color=c.use_custom_color?c.color.slice(0):a.horizon_color.slice(0);a=d.color;d.od=new Float32Array([a[0],
a[1],a[2],1/d.depth]);d.Te=new Float32Array([d.Uw,d.depth,d.start,d.height]);return d}function d(a,c){if(!ta.Ic)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var d=!1,b=!1,e=0;e<c.length;e++){for(var f=c[e],h=f.data.materials,g=0;g<h.length;g++)h[g].b4w_terrain&&(d=!0);f=f.particle_systems;for(g=0;g<f.length;g++)h=f[g].settings,"HAIR"==h.type&&h.b4w_dynamic_grass&&(b=!0);if(d&&b)return!0}return!1}function h(a,c){if(Db.outlining_overview_mode)return!0;if(ta.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var d=0;d<c.length;d++)if(c[d].ya.g.oi)return!0;return!1}else return!1}function v(a,c){if(Db.outlining_overview_mode)return!0;if(ta.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var d=0;d<c.length;d++)if(c[d].ya.g.hc)return!0;return!1}else return!1}function P(a,c){if(ta.Yg)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var d=0;d<c.length;d++)for(var b=c[d].data.materials,
e=0;e<b.length;e++)if(wa.FB(b[e]))return!0;return!1}else return!1}function c(a,c){if(ta.gd)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return c.gd}else return!1}function p(a){for(var c=0;c<a.length;c++)for(var d=a[c].data.materials,b=0;b<d.length;b++){var e=d[b],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function N(a,c){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var d=
0;d<c.length;d++){var b=c[d].ya;if(b.anchor&&b.anchor.Ok)return!0}return!1}}function G(a,c,d){var b=ua.Ff(a,c);ua.wg(a,b,function(a,c,b){if(b.Ub){switch(b.from){case "COLOR":case "CUBEMAP":var e=c.k.Wb;break;case "DEPTH":e=c.k.he;break;case "SCREEN":e=null;break;case "MAIN_CUBE_REFLECT":return;default:Ha.l("Wrong slink")}switch(b.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:e||Ha.l("Connection of SCREEN is forbidden"),e.Ge&&Ha.l("Batch texture can't use renderbuffer"),qa.IB(d.rb,b.to)&&ga.Bk(d,e,b.to)}}});for(a=0;a<c.Fa.length;a++){var b=c.Fa[a],e=c.ug[a];switch(b.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:e.Ge&&Ha.l("Batch texture can't use renderbuffer"),qa.IB(d.rb,b.to)&&ga.Bk(d,e,b.to)}}}function u(a,c){return{ec:!0,cw:[!0,!0,!0,!0,!0,!0],lg:a,G:c}}function z(a,c,d,b,e,
f){function h(a,c){return a==c?0:a>c?1:-1}for(var g=c.g,m=Ka.aa(c,e).X,p=0;p<m.length;p++){var l=m[p];l.Pd||l.fd||"MAIN"!=l.type&&"NODES_GLOW"!=l.type&&"PARTICLES"!=l.type&&"LINE"!=l.type||!("OPAQUE"==l.sb&&"OPAQUE"==b||"BLEND"==l.sb&&"BLEND"==b||"XRAY"==l.sb&&"XRAY"==b||"NODES_GLOW"==l.type&&"GLOW"==b)||(f||(q(l,a,c,d,b,e),ga.Uc(l),D(l)),a.D.push(u(g,l)),G(d,a,l),I(l))}a.D.sort(function(a,c){return a.G&&c.G?-h(a.G.eb,c.G.eb)||-h(a.G.Ui,c.G.Ui)||h(a.G.Pj,c.G.Pj):0})}function q(a,c,d,b,e,f){var h=
d.g,g=f.j,l=Ka.aa(d,f),p="NO_SHADOWS";d=U(f,["SHADOW_CAST"]);if(d.length&&a.Qd){switch(e){case "OPAQUE":p="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":p="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":p="NO_SHADOWS";break;case "SHADOW":p="SHADOW_MASK_GENERATION";break;default:Ha.l("Wrong subscene type")}for(var v=0;v<d.length;v++)ga.eB(a,f.j.Rc)}d=a.Tb;qa.V(d,"SHADOW_USAGE",p);a.Ic&&(v=na.Nb(b,"GRASS_MAP"))&&m(a,v,h);if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.$n){e=c.Rr;
qa.V(d,"NUM_LIGHTS",e);qa.V(d,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1);qa.V(d,"REFLECTION_PASS",0);qa.V(d,"SSAO_ONLY",0);qa.V(d,"INVERT_FRONTFACING",0);(e=g.mc)&&c.Rf?qa.V(d,"WATER_EFFECTS",1):qa.V(d,"WATER_EFFECTS",0);if(e&&c.Ig&&h.Ig){qa.V(d,"CAUSTICS",1);if(v=g.Rc){h=v.Bf;for(v=p=0;v<h.length;v++)"SUN"==h[v]&&(p=v);qa.V(d,"SUN_NUM",p)}qa.V(d,"CAUST_SCALE",qa.H(c.vB));qa.V(d,"CAUST_SPEED",qa.H(c.wB,2));qa.V(d,"CAUST_BRIGHT",qa.H(c.uB))}else qa.V(d,"CAUSTICS",0);e&&(qa.V(d,"WAVES_HEIGHT",qa.H(e.waves_height)),
qa.V(d,"WAVES_LENGTH",qa.H(e.waves_length)),qa.V(d,"WATER_LEVEL",qa.H(e.Ii)));c=l.Mg;l=l.ng;if(-1!==a.Sc.indexOf("u_mirrormap"))qa.V(d,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Md&&c)c=c.k.Wb,ga.Bk(a,c,"u_cube_reflection"),qa.V(d,"REFLECTION_TYPE","REFL_CUBE");else if(a.Md&&l)for(v=0;v<l.length;v++)c=l[v].k.Wb,ga.Bk(a,c,"u_plane_reflection"),qa.V(d,"REFLECTION_TYPE","REFL_PLANE");else qa.V(d,"REFLECTION_TYPE","REFL_NONE");(l=na.Nb(b,"SKY"))?a.UF?(c=l.k.Wb,ga.Bk(a,c,"u_sky")):(a.fe=l.fe,qa.V(d,
"PROCEDURAL_FOG",1)):qa.V(d,"PROCEDURAL_FOG",0);c=g.Ez;c.qz&&(qa.V(d,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==c.ew?(c=c.fw?Ga.Cc(c.fw,!1):l.k.Wb,qa.V(d,"SKY_TEXTURE",1),ga.Bk(a,c,"u_sky_texture")):"SKY_COLOR"==c.ew&&qa.V(d,"SKY_COLOR",1));c=g.DI;c.aU&&(qa.V(d,"USE_FOG",1),qa.V(d,"FOG_TYPE",c.bO));a.Io&&a.eb?(ta.Hq&&qa.V(d,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.$n||"NODES_GLOW"==a.type?(qa.V(d,"REFRACTIVE",1),g.gd?qa.V(d,"USE_REFRACTION",1):qa.V(d,"USE_REFRACTION",0)):g.gd?qa.V(d,"REFRACTIVE",
1):qa.V(d,"REFRACTIVE",0),(g.aF.gd||g.gd)&&qa.V(d,"HAS_REFRACT_TEXTURE",1)):(qa.V(d,"REFRACTIVE",0),qa.V(d,"USE_REFRACTION",0),qa.V(d,"USE_REFRACTION_CORRECTION",0));a.mk&&(ta.ti&&a.yz&&na.Nb(b,"DEPTH_PACK")?qa.V(d,"SHORE_SMOOTHING",1):qa.V(d,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?qa.V(d,"DYNAMIC",1):qa.V(d,"DYNAMIC",0));"PARTICLES"==a.type&&(qa.V(d,"SIZE_RAMP_LENGTH",a.Qa.K1),qa.V(d,"COLOR_RAMP_LENGTH",a.Qa.RB));if(!a.dg)for(a=a.fa,b=0;b<a.length;b++)if(c=a[b],"SCENE"==c.source)for(g=
0;g<Ra.length;g++)for(d=Ra[g],l=Ra[g].Le,e=0;e<l.length;e++)l[e].j==c&&ua.m(wb,d,f,null)}}function D(a){var c=a.rb.attributes,d=a.oa.ed,b;for(b in c)d[b]||Ha.l('missing data for "'+b+'" attribute');if("MAIN"==a.type||"NODES_GLOW"==a.type)if(c=qa.fP(a.rb.xz),10<c&&("MAIN"==a.type&&ab.warn("Varying limit exceeded for main shader - "+c+', materials: "'+a.Cf.join(", ")+'"'),"MAIN"==a.type&&a.$n||"NODES_GLOW"==a.type))b=d=0,a.jk&&(d=Ha.Un(a.jk)),a.Gc&&(b=Ha.Un(a.Gc)),ab.warn("Varying limit exceeded for node shader - "+
c+", uv: "+d+", vc: "+b+', materials: "'+a.Cf.join(", ")+'"')}function I(a){8<a.fa.length&&ab.warn(a.type,"too many textures used - "+a.fa.length+' (max 8), materials "'+a.Cf.join(", ")+'"')}function m(a,c,d){a.Cd=c.Cd;var b=c.Cd[0],e=c.Cd[1],f=c.Cd[2];d=d.R;d=Math.max(d.max_x-d.min_x,d.max_z-d.min_z);f=0==f?d:Math.max(f,d);c.Cd[2]=f;c=c.k;ya.zs(c,f/2,-e,-b,f/2);ya.qi(c);b=a.Jw||0;b=0==b?d:Math.max(b,d);a.Jw=b}function V(a,c,d,b,e,f){for(var h=c.g,g=Ka.aa(c,e).X,m=0;m<g.length;m++){var l=g[m];if(("MAIN"==
l.type||"PARTICLES"==l.type||"LINE"==l.type)&&"REFLECT"==l.sb&&l.eb==b){if("MAIN_PLANE_REFLECT"==a.type||"MAIN_PLANE_REFLECT_BLEND"==a.type){var p;a:{var v=e.j.og.ng;for(p=0;p<v.length;p++)for(var k=0;k<v[p].length;k++)if(v[p][k]==a)break a;v=e.j.og.gs;for(p=0;p<v.length;p++)for(k=0;k<v[p].length;k++)if(v[p][k]==a)break a;p=null}if(p==h.se)continue}else if(p=Da(e,a),p==h.Qe)continue;f||(q(l,a,c,d,"REFLECT",e),p=l.Tb,qa.V(p,"WATER_EFFECTS",0),qa.V(p,"REFLECTION_PASS",1),qa.V(p,"TEXTURE_NORM",0),"MAIN_PLANE_REFLECT"==
a.type&&qa.V(p,"INVERT_FRONTFACING",1),ga.Uc(l),D(l));a.D.push(u(h,l))}}}function Q(a){la(a);var c=ea(a,"MAIN_OPAQUE"),d=!0,b=a.j.Rc;ua.ma(a.j.Pa,function(e,f){"SHADOW_CAST"===f.type&&(X(f,a,c.k,f.D,b,d),d=!1)})}function R(a){ua.ma(a.j.Pa,function(a,c){"OUTLINE"===c.type&&(c.dw=1)})}function X(a,c,d,b,e,f){if(0!=b.length){var h=a.k,g=Oa.Vh(d.i,Tb);Oa.ff(g,h.i);Oa.copy(d.jf,h.Gy);if("SUN"===e.Bf[a.Lf]||"HEMI"===e.Bf[a.Lf]){g=tb;O.bc(g);for(var m=0;m<b.length;m++){var p=b[m].lg;0==m?O.uq(p.I,g):O.Jn(g,
p.I)}b=O.Kn(g,Eb);Ha.Nl(b,h.nb,b);if(e.enable_csm){c=Ma.copy(d.rn[a.Kv],Tb);e=sa.invert(d.nb,nc);Ha.Nl(c,e,c);Ha.Nl(c,h.nb,c);a=d.Lv[a.Kv];if(f)for(oc=0,Mb=-Infinity,f=2;f<b.length;f+=3)oc=Math.min(oc,b[f]),Mb=Math.max(Mb,b[f]);f=tb;f.max_x=c[0]+a;f.max_y=c[1]+a;f.max_z=Mb;f.min_x=c[0]-a;f.min_y=c[1]-a;f.min_z=oc}else{d=f=tb;e=Mc;e.set(b);b=Xb/9;g=sa.identity(nc);sa.rotate(g,b,Ha.Mi,g);for(var p=m=-1,l=0;10>l;l++){var v=O.wL(e,sd),k=(v.max_x-v.min_x)*(v.max_y-v.min_y);if(-1==m||k<m)m=k,p=l,O.uq(v,
d);Ha.Nl(e,g,e)}d=p*b;0<d&&(b=sa.identity(nc),sa.rotate(b,d,Ha.Mi,b),sa.multiply(b,h.nb,h.nb),Oa.Wg(h.nb,h.jf));d=f.max_x-f.min_x;b=f.max_y-f.min_y;d&&b&&(e=Math.abs(d-b)/2,2<d/b?(f.max_y+=e,f.min_y-=e):2<b/d&&(f.max_x+=e,f.min_x-=e));f.max_x+=.005;f.max_y+=.005;f.max_z+=.005;f.min_x-=.005;f.min_y-=.005;f.min_z-=.005;ja(a,c.j.Pa)}ya.WR(h,f.min_x,f.max_x,f.min_y,f.max_y,-f.max_z,-f.min_z);ya.qi(h);Ha.Nq(h.Qf,h.$k)}else"SPOT"!==e.Bf[a.Lf]&&"POINT"!==e.Bf[a.Lf]||ya.qi(h,h.ib)}}function ja(a,c){for(var d=
a.k,b=na.ZO(c,a),e=0;e<b.length;e++){var f=b[e];if("MAIN_OPAQUE"==f.type||"SHADOW_RECEIVE"==f.type||"MAIN_BLEND"==f.type||"MAIN_XRAY"==f.type)if(ta.Hr)f.rz.set(d.jf,9*a.Lf);else{var h=Oa.q(d.jf),g=Oa.B(d.jf);fb.set(h[0],h[1],h[2],Oa.Oc(d.jf),Vc);f.mt.set(Vc,4*a.Lf);f.lt.set(g,4*a.Lf)}}}function W(a,c,d,b,e){for(var f=c.g,h=Ka.aa(c,b).X,g=0;g<h.length;g++){var m=h[g];"COLOR_ID"==m.type&&("COLOR_PICKING"==a.type&&"COLOR_ID"==m.sb||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==m.sb)&&(e||(q(m,a,c,d,
"COLOR_ID",b),ga.Od(m,"USE_OUTLINE",0),ga.Uc(m),D(m)),a.D.push(u(f,m)))}}function Z(a,c,d,b,e){b||(e.Ic&&(b=na.Nb(d,"GRASS_MAP"))&&m(e,b,c),ga.Uc(e),D(e));a.D.push(u(c,e));G(d,a,e);I(e)}function Y(a,c){ia(a,c);for(var d=0;d<a.zd.length;d++)a.zd[d].parent==a&&Y(a.zd[d],c)}function ia(a,c){a.g.xj=c;if(Ka.wr(a))for(var d=0;d<a.A.length;d++)for(var b=a.A[d],e=U(b.Ta,lb),f=0;f<e.length;f++)ka(a,b,e[f])}function ha(a,c){for(var d=U(c,lb),b=a.$b,e=a.g,f=Ka.aa(a,c),h=f.Fj,g=Oa.q(e.i),e=Oa.B(e.i),m=0;m<d.length;m++){var p=
d[m];p.Er.set(g,3*h);p.hx.set(b.direction,3*h);p.Dr.set(b.kn,3*h);switch(b.type){case "SUN":p.uH.set(e);p.tH=b.kn;"SKY"===p.type?(p.Nr=b.qF,Ma.copy(b.direction,p.Xy),da(c,p)):Ma.copy(b.direction,p.Xy);break;case "HEMI":case "POINT":case "SPOT":break;default:ab.error("Unknown light type: "+b.type+'".')}ka(a,f,p);for(var l=0;l<p.D.length;l++){var v=p.D[l].G;v.ql&&ga.ZR(v,a)}}d=ea(c,"MAIN_OPAQUE").k;f=f.Hy;b=c.j.Rc;for(m=0;m<f.length;m++)p=f[m],ya.Fy(p.k,g,e),X(p,c,d,p.D,b,!0),ja(p,c.j.Pa)}function ka(a,
c,d){var b=a.g;a=a.$b;c=c.Fj;var e=Gc;e[0]=a.rm&&!b.xj?1:0;e[1]=a.ik&&!b.xj?1:0;d.ix.set(e,2*c);d.ra=!0}function la(a){var c=Ba.Pb(a,"LAMP",Ba.vc),c=Ka.ar(c,ta.Rd&&a.b4w_enable_ssao);if(c.length)for(var d=0;d<c.length;d++)for(var b=c[d],e=b.g,f=Oa.Vh(e.i,Tb),e=Oa.Fw(e.i,Cc),h=0;h<b.A.length;h++){var g=b.A[h],m=g.Hy;if(g.Ta==a)for(g=0;g<m.length;g++)ya.Fy(m[g].k,f,e)}}function da(a,c){La.ks(c);Kb.Sk(c);if(c.Nr)for(var d=U(a,ib),b=0;b<d.length;b++)for(var e=d[b].D,f=0;f<e.length;f++){var h=e[f];h.ec&&
(h=h.G,ga.XL(h)&&Kb.vT(h))}}function E(a){for(var c=[],d=0;d<a.length;d++)for(var b=a[d].data,e=0;e<b.materials.length;e++){var f=b.materials[e];-1==c.indexOf(f)&&c.push(f)}return c}function oa(a,c,d){for(var b=a.j,e=Ka.aa(a.Gh,a).U,f=0;f<e.length;f++){var h=e[f];ya.qi(h,c/d);b.Rc&&ya.nz(h,b.Rc)}b.Rc&&(b.Or=!0,ea(a,"SHADOW_RECEIVE").ra=!0,ea(a,"MAIN_BLEND").ra=!0);var g=b.Pa;na.nT(g,function(b,e,f){if(b.$o){var h=b.bk*c,m=b.ck*d;if(e)for(e=0;e<f.Fa.length;e++)f.Fa[e]==b&&Ga.resize(b.Ja,h,m);else switch(Ga.ol(b.Ja)&&
Ga.resize(b.Ja,h,m),b=f.k,b.width=h,b.height=m,f.type){case "DOF":Ca(a,{dof_power:f.k.dof_power,dof_on:f.k.dof_on});break;case "GLOW_COMBINE":aa(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case "BLOOM":ba(a,{bloom_blur:f.bloom_blur});break;case "OUTLINE":f=na.tb(g,f,"POSTPROCESSING");h=na.tb(g,f,"POSTPROCESSING");m=na.tb(g,h,"POSTPROCESSING");b=na.tb(g,m,"POSTPROCESSING");na.we(f,1/c,1/d);na.we(h,1/c,1/d);na.we(m,1/c,1/d);na.we(b,1/c,1/d);
break;default:na.we(f,1/c,1/d)}}})}function U(a,c){for(var d=[],b=0;b<c.length;b++){var e=c[b];ua.ma(a.j.Pa,function(a,c){c.type==e&&d.push(c)})}return d}function ea(a,c){return na.Nb(a.j.Pa,c)}function Ca(a,c){var d=ea(a,"DOF");if(!d)return ab.error("DOF is not enabled on the scene. Check camera settings"),0;var b=a.j.Pa;"boolean"==typeof c.dof_on&&(d.k.dof_on=c.dof_on);"number"==typeof c.dof_distance&&(d.k.dof_distance=c.dof_distance);"number"==typeof c.dof_front&&(d.k.dof_front=c.dof_front);"number"==
typeof c.dof_rear&&(d.k.dof_rear=c.dof_rear);if("number"==typeof c.dof_power){d.k.dof_power=c.dof_power;var e=na.tb(b,d,"POSTPROCESSING"),b=na.tb(b,e,"POSTPROCESSING");na.jd(e,d.k.dof_power);na.we(e,1/d.k.width,1/d.k.height);na.jd(b,d.k.dof_power);na.we(b,1/d.k.width,1/d.k.height)}}function ba(a,c){var d=ea(a,"LUMINANCE_TRUNCED"),b=ea(a,"BLOOM");if(!d||!b)return ab.error("Bloom is not enabled on the scene"),0;"number"==typeof c.bloom_key&&(d.bloom_key=c.bloom_key,d.ra=!0);"number"==typeof c.bloom_edge_lum&&
(d.bloom_edge_lum=c.bloom_edge_lum,d.ra=!0);if("number"==typeof c.bloom_blur){var e=a.j.Pa,d=na.tb(e,b,"BLOOM_BLUR"),e=na.tb(e,d,"BLOOM_BLUR");b.bloom_blur=c.bloom_blur;na.jd(d,c.bloom_blur);na.we(d,1/b.k.width,1/b.k.height);na.jd(e,c.bloom_blur);na.we(e,1/b.k.width,1/b.k.height)}}function aa(a,c){var d=ea(a,"GLOW_COMBINE");if(!d)return ab.error("Glow is not enabled on the scene"),null;for(var b=a.j.Pa,e=na.XO(b,d),f=0;f<e.length;++f){var h=e[f];if("POSTPROCESSING"===h.type&&"GLOW_MASK_LARGE"===h.sb)var g=
h;if("POSTPROCESSING"===h.type&&"GLOW_MASK_SMALL"===h.sb)var m=h}e=na.tb(b,g,"POSTPROCESSING");b=na.tb(b,m,"POSTPROCESSING");"number"==typeof c.small_glow_mask_coeff&&(d.small_glow_mask_coeff=c.small_glow_mask_coeff,d.ra=!0);"number"==typeof c.large_glow_mask_coeff&&(d.large_glow_mask_coeff=c.large_glow_mask_coeff,d.ra=!0);"number"==typeof c.small_glow_mask_width&&(d.small_glow_mask_width=c.small_glow_mask_width,na.jd(m,c.small_glow_mask_width),na.we(m,1/d.k.width,1/d.k.height),m.ra=!0,na.jd(b,c.small_glow_mask_width),
na.we(b,1/d.k.width,1/d.k.height),b.ra=!0);"number"==typeof c.large_glow_mask_width&&(d.large_glow_mask_width=c.large_glow_mask_width,na.jd(g,c.large_glow_mask_width),na.we(g,1/d.k.width,1/d.k.height),g.ra=!0,na.jd(e,c.large_glow_mask_width),na.we(e,1/d.k.width,1/d.k.height),e.ra=!0)}function ca(a,c,d){var b=a.j,e=b.mc;if(!e.Cn)return e.Ii;var f=e.waves_height,h=e.waves_length,g=e.Ii,m=Ma.length(b.Bh);a=ea(a,"MAIN_OPAQUE").time;m&&(a*=m);var p=Gc;p[0]=20/h*(c-.25*a);p[1]=20/h*(d-.25*a);m=Ha.xB(p);
p[0]=17/h*(d+.1*a);p[1]=17/h*(c+.1*a);var p=Ha.xB(p),m=m+p-1,l=e.dst_noise_scale0,p=e.dst_noise_scale1,v=e.dst_noise_freq0,k=e.dst_noise_freq1,q=Gc;q[0]=l*(c+v*a);q[1]=l*(d+v*a);l=Ha.Ny(q);q[0]=p*(d-k*a);q[1]=p*(c-k*a);p=Ha.Ny(q);p*=f*l;if(e.ui)if(k=(c-e.Vl[0])/e.Wl[0],q=(e.Vl[1]+d)/e.Wl[1],k+=.5,q+=.5,1<k||0>k||1<q||0>q)e=p;else{var b=Ha.fD(b.Iy,e.Jy,k,q),q=e.dir_freq,r=e.dir_noise_scale,u=e.dir_noise_freq,l=e.dir_min_noise_fac,k=e.dst_min_fac,v=h/e.px/Math.PI;d=[r/h*(c+u*a),r/h*(d+u*a)];c=Math.sqrt(b);
e=f*Math.max(b,e.dir_min_shore_fac)*Math.sin(c/v+q*a)*Math.max(Ha.Ny(d),l);f=Math.max(c,k);e=e*(1-f)+p*f;m*=b}else e=p;return g+(e+.05*m)}function S(a,c){a.ho&&"POSTPROCESSING"==a.type&&c.ec!=a.ec&&(a.ec=c.ec);c.ec||"OUTLINE"!=a.type||(a.dw=0)}function Aa(a,c,d,b){var e=ua.Ra(a,c);ya.ws(e.k,d,b);e.Uu=!0;ua.Ai(a,c,function(c,e,f){f.Ub&&f.from==d&&na.nM(f)&&ra(a,c,f.to,b)});ua.wg(a,c,function(c,e,f){f.Ub&&f.from==d&&f.from==f.to&&Aa(a,c,d,b)})}function ra(a,c,d,b){a=ua.Ra(a,c).D;for(c=0;c<a.length;c++)ga.wR(a[c].G,
b,d)}function za(a){var c=ea(a,"GRASS_MAP");if(c){var d=c.k,b=a.Gh.g;a=Oa.q(b.i);var e=Tb;e[0]=0;e[1]=-c.Cd[2]/2;e[2]=0;c=Oa.B(b.i);Ma.transformQuat(e,c,e);e[0]+=a[0];e[1]=0;e[2]+=a[2];c=Cc;c[0]=0;c[1]=0;c[2]=0;c[3]=1;ya.Fy(d,e,c)}}function ma(a,c){ua.ma(a,function(d,b){if("MOTION_BLUR"==b.type){b.Fa[0]&&b.ug[0]||Ha.l("Wrong MOTION_BLUR subscene");var e=b.Fa[0],f=b.ug[0];b.ug[0]=b.k.Wb;ua.Ai(a,d,function(c,d,b){b.Ub&&ra(a,c,b.to,f)});Aa(a,d,e.from,f);ra(a,d,e.to,b.ug[0]);b.hF=Math.exp(-c/b.mb_factor)}})}
function T(a){return a.j.Bh}function Da(a,c){if(!a.j.og)return null;for(var d=a.j.og.Mg,b=0;b<d.length;b++)if(d[b]==c)return b;d=a.j.og.Mv;for(b=0;b<d.length;b++)if(d[b]==c)return b;return null}var ga=n("__batch"),O=n("__boundings"),ya=n("__camera"),fa=n("__config"),pa=n("__container"),Ea=n("__debug");n("__geometry");var ua=n("__graph"),Fa=n("__hud");n("__lights");var Ia=n("__input"),sa=n("__mat4"),wa=n("__nodemat"),Ba=n("__objects"),Ka=n("__obj_util"),Ja=n("__physics"),La=n("__prerender"),xa=n("__primitives"),
ab=n("__print"),Kb=n("__renderer"),na=n("__scenegraph"),Lb=n("__sfx"),qa=n("__shaders"),Ga=n("__textures"),Oa=n("__tsr"),Ha=n("__util"),Ma=n("__vec3"),fb=n("__vec4"),ta=fa.v,Db=fa.hc,nb=fa.Rl,fc="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND COLOR_PICKING COLOR_PICKING_XRAY SHADOW_RECEIVE OUTLINE_MASK DEBUG_VIEW".split(" ");a.$V=fc;var lb="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND LUMINANCE_TRUNCED SHADOW_RECEIVE SHADOW_CAST COLOR_PICKING COLOR_PICKING_XRAY OUTLINE_MASK".split(" "),
ib="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND".split(" "),Sb="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND COLOR_PICKING COLOR_PICKING_XRAY SHADOW_RECEIVE GOD_RAYS OUTLINE_MASK DEBUG_VIEW".split(" "),Yb="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND".split(" "),
uc=null,Rb=null,Ra=[],wb=null,Xb=Math.PI/2,Gc=new Float32Array(2),Tb=new Float32Array(3),Cc=new Float32Array(4),Vc=new Float32Array(4),nc=new Float32Array(16),Eb=new Float32Array(24),Mc=new Float32Array(24),tb=O.bc(),sd=O.bc(),oc=0,Mb=-Infinity;a.vX=function(){return{}};a.vs=function(a){Rb=a;Lb.IR(a)};a.dR=function(a,c){var d=a.j,b=na.ZM(d.Pa);if(a==c){oa(a,pa.VD(),pa.UD());for(var e=0;e<b.length;e++)a.j.Yj.push(b[e])}else for(e=a.Le[0],oa(a,e.j.ek,e.j.ek),e=0;e<b.length;e++)c.j.Yj.push(b[e]);b=U(a,
Sb);for(e=0;e<b.length;e++)b[e].Bh.set(d.Bh);for(e=0;e<d.Yj.length;e++)"SHADOW_CAST"==d.Yj[e].type&&Kb.Sk(d.Yj[e])};a.wj=function(){uc||(uc=k(Ra));return uc};a.Qq=k;a.p=b;a.za=function(){return Rb?!0:!1};a.bl=function(a){return a.Gh};a.Tn=function(){return Ra};a.FD=function(){if(1==Ra.length)return Ra;for(var a=0;a<Ra.length;a++){var c=Ra[a].j.Pa;ua.ma(c,function(c,d){for(var b=0;b<d.D.length;b++){for(var e=d.D[b].G.fa,f=null,h=0;h<e.length;h++)if("SCENE"==e[h].source&&e[h].Oy==Ra[a].name&&"COPY"!=
d.type){ab.error('Texture-scene loop detected. A scene is rendered to texture "'+e[h].name+'" yet this texture belongs to the same scene.');ua.Ff(wb,Ra[a]);f=d.D[b].G;break}f&&(f.fa=[],f.Sc=[],ga.uT(f,null),ga.Uc(f))}})}for(var d=[],a=0;a<Ra.length;a++)if(c=Ra[a],!c.Le.length){c=ua.Ff(wb,c);ua.RN(wb,c);c=ua.Us(wb,c,ua.pp);c=ua.iz(c);ua.ma(c,function(a,c){d.push(c)});break}return d};a.NK=function(a,b,m,k,q){a.Le=a.Le||[];a.ga=null;var u=a.j,n=Ka.aa(a.Gh,a),z=a.Gh.g;u.wm=[];var I=a.world;u.RP=m.length;
u.vh=g(m);u.Ps=l(I,u.vh);u.Ez=H(I,u.Ps);u.DI=K(I);if(I=!a.Le.length)a:{if("HMD"==ta.stereo){if(n.U[0].type!=ya.Vc){ab.warn("Head-mounted display stereo is disabled for the non-perspective camera");ta.stereo="NONE";I=!1;break a}if(!Ia.nv(Ia.td)){ab.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");ta.stereo="NONE";I=!1;break a}}I="HMD"==ta.stereo}u.ao=I;if(I=!a.Le.length)n.U[0].type!=ya.Vc&&"ANAGLYPH"==ta.stereo?(ab.warn("Anaglyph stereo is disabled for the non-perspective camera"),
ta.stereo="NONE",I=!1):I="ANAGLYPH"==ta.stereo;u.anaglyph_use=I;u.FK=!u.ao&&!u.anaglyph_use&&N(a,q);u.og=r(a,b,k);u.BL=x(a);u.yQ=L(a);u.VL=M(a);u.iP=F(a);u.MQ=J(a);u.Xh=C(a);u.Qk=ta.Qk&&(0<z.dof_distance||z.je);u.Jj=ta.Jj&&a.b4w_enable_motion_blur;u.Hk=ta.Hk&&a.b4w_enable_color_correction;u.antialiasing=ta.antialiasing&&1==ta.rc&&"NONE"!=a.b4w_antialiasing_quality;u.Rd=ta.Rd&&a.b4w_enable_ssao;u.hl=ta.hl&&a.b4w_enable_god_rays&&u.vh;u.zN=ta.Hq;u.dr=a.b4w_glow_settings.render_glow_over_blend;u.RS=
A(a);q=f(k);u.aF=q;u.gd=c(a,q);u.Rc=e(a,m,k);u.mc=t(k);u.Dh=p(k);u.GS=w(k);u.ti=B(k);u.Ic=d(a,k);u.xM=!u.ao&&!u.anaglyph_use&&h(a,k);u.outline=v(a,k);u.Yg=P(a,k);switch(a.b4w_reflection_quality){case "LOW":u.Ng=nb.mC;u.Vj=nb.NF;break;case "MEDIUM":u.Ng=nb.qN;u.Vj=nb.YQ;break;case "HIGH":u.Ng=nb.pN;u.Vj=nb.XQ;break;default:u.Ng=nb.mC,u.Vj=nb.NF}if(pa.HP())ab.log("%cENABLE HIDPI MODE","color: #00a"),u.OA="AA_QUALITY_LOW",u.Nd=1,ta.rc=1;else if(1<ta.rc)ab.log("%cENABLE MSAA RENDERING: "+ta.rc+"x","color: #00a"),
u.Nd=1;else{u.OA="AA_QUALITY_"+a.b4w_antialiasing_quality;switch(a.b4w_antialiasing_quality){case "LOW":u.antialiasing&&(u.Nd=1);break;case "MEDIUM":ta.quality==fa.Pi||ta.quality==fa.Oi?u.Nd=1:ta.quality==fa.rk&&(u.Nd=1.33);break;case "HIGH":ta.quality==fa.Pi?u.Nd=1:ta.quality==fa.Oi?u.Nd=1.33:ta.quality==fa.rk&&(u.Nd=2);break;case "NONE":ta.quality==fa.Pi||ta.quality==fa.Oi?u.Nd=1:ta.quality==fa.rk&&(u.Nd=2)}ta.quality==fa.Au&&(u.Nd=1)}m=a.Le.sort(function(a,c){return c.j.ek-a.j.ek});u.Pa=na.YM(u,
n,z,m);u.Yj=[];u.Or=!1;u.wx=!1;u.xx=!1;u.Bh=new Float32Array(3);Ra.push(a);wb||(wb=ua.create());ua.C(wb,a);for(u=0;u<b.length;u++)Ka.ly(b[u],!0,a);a=pa.le();pa.resize(a.clientWidth,a.clientHeight,!0)};a.OK=function(a,c,d){for(var b=0;b<c.length;b++)c[b].j&&c[b].j.ko&&(c[b].j.Ah=d,a.j.wm.push(c[b]))};a.Dw=function(a){return a.j.Pa};a.ZC=function(a){ua.ma(a,function(c,d){var b=null;switch(d.type){case "POSTPROCESSING":b=ga.Iv(d.hs);break;case "SSAO":b=ga.eN(d);break;case "SSAO_BLUR":b=ga.fN(d);break;
case "DEPTH_PACK":b=ga.KM();break;case "GOD_RAYS":na.tb(a,d,"RESOLVE")||na.tb(a,d,"DEBUG_VIEW")||na.tb(a,d,"MAIN_BLEND")||na.tb(a,d,"GOD_RAYS");b=ga.OM(d.IF,d.mk,d.hm);break;case "GOD_RAYS_COMBINE":na.tb(a,d,"RESOLVE")||na.tb(a,d,"DEBUG_VIEW")||na.tb(a,d,"MAIN_BLEND");na.tb(a,d,"GOD_RAYS");b=ga.PM();break;case "MOTION_BLUR":b=ga.TM();break;case "DOF":var b=ga.LM(),e=na.tb(a,d,"POSTPROCESSING"),f=na.tb(a,e,"POSTPROCESSING");na.jd(e,d.k.dof_power);na.jd(f,d.k.dof_power);break;case "OUTLINE":var b=ga.UM(),
e=na.tb(a,d,"POSTPROCESSING"),f=na.tb(a,e,"POSTPROCESSING"),h=na.tb(a,f,"POSTPROCESSING"),g=na.tb(a,h,"POSTPROCESSING");na.jd(f,d.bv);na.jd(e,d.bv);na.jd(g,d.iw*d.uo);na.jd(h,d.iw*d.uo);break;case "GLOW_COMBINE":b=ga.NM();break;case "COMPOSITING":b=ga.IM();break;case "ANTIALIASING":b=ga.DM(d);break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":b=ga.cN(d.type);break;case "STEREO":b=ga.gN(d.sb);break;case "SKY":b=ga.XM();break;
case "LUMINANCE":b=ga.QM();break;case "AVERAGE_LUMINANCE":b=ga.EM();break;case "LUMINANCE_TRUNCED":b=ga.RM();break;case "BLOOM_BLUR":b=ga.FM();break;case "BLOOM":b=na.tb(a,d,"BLOOM_BLUR");e=na.tb(a,b,"BLOOM_BLUR");na.jd(b,d.bloom_blur);na.jd(e,d.bloom_blur);b=ga.GM();break;case "VELOCITY":b=ga.kN();break;case "ANCHOR_VISIBILITY":b=ga.CM();break;case "PERFORMANCE":b=ga.VM()}b&&(e=u(Ka.Mk("NONE"),b),D(b),d.D.push(e),G(a,d,b),I(b))})};a.Ak=function(a,c,d){switch(c.type){case "MESH":case "LINE":case "WORLD":var b=
a.j.Pa,e=c.g;!na.Nb(b,"SHADOW_CAST")&&e.Qd&&(e.Qd=!1);e=U(a,fc);d&&c.hk&&Ja.Ak(c,a);for(var f=0;f<e.length;f++){var h=e[f],g=c,p=b,l=a,v=d;switch(h.type){case "MAIN_OPAQUE":z(h,g,p,"OPAQUE",l,v);break;case "MAIN_BLEND":z(h,g,p,"BLEND",l,v);break;case "MAIN_XRAY":z(h,g,p,"XRAY",l,v);break;case "MAIN_GLOW":z(h,g,p,"GLOW",l,v);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":V(h,g,p,!1,l,v);break;case "MAIN_PLANE_REFLECT_BLEND":case "MAIN_CUBE_REFLECT_BLEND":V(h,g,p,!0,l,v);break;case "SHADOW_RECEIVE":for(var k=
Ka.aa(g,l).X,r=0;r<k.length;r++){var n=k[r];"SHADOW"==n.type&&"RECEIVE"==n.sb&&(v||(q(n,h,g,p,"SHADOW",l),ga.Uc(n),D(n)),h.D.push(u(g.g,n)),G(p,h,n),I(n))}break;case "SHADOW_CAST":for(var k=!1,r=g.g,g=Ka.aa(g,l).X,n=na.Nb(p,"GRASS_MAP"),t=0;t<g.length;t++){var A=g[t];if("SHADOW"==A.type&&"CAST"==A.sb){k=!0;if(!v){var x=h.Rr;ga.Od(A,"NUM_LIGHTS",x);ga.Od(A,"NUM_LFACTORS",0==x%2?x/2:Math.floor(x/2)+1);qa.V(A.Tb,"SHADOW_USAGE","SHADOW_CASTING");A.Ic&&n&&m(A,n,r);ga.Od(A,"SHADOW_TEX_RES",qa.H(l.j.Rc.csm_resolution));
ga.Uc(A);D(A)}h.D.push(u(r,A))}}k&&(g=l.j.Rc,v=na.Nb(p,"MAIN_OPAQUE"),X(h,l,v.k,h.D,g,!0));break;case "COLOR_PICKING":W(h,g,p,l,v);break;case "COLOR_PICKING_XRAY":W(h,g,p,l,v);break;case "OUTLINE_MASK":k=g.g;r=Ka.aa(g,l).X;for(n=0;n<r.length;n++)t=r[n],"COLOR_ID"==t.type&&"OUTLINE"==t.sb&&(v||(q(t,h,g,p,"COLOR_ID",l),ga.Od(t,"USE_OUTLINE",1),ga.Uc(t),D(t)),h.D.push(u(k,t)));break;case "GRASS_MAP":p=g.g;g=Ka.aa(g,l).X;for(l=0;l<g.length;l++)k=g[l],"GRASS_MAP"==k.type&&(v||(ga.Uc(k),D(k)),h.D.push(u(p,
k)),k=h.k,A=p.I,r=h.Cd[0],n=h.Cd[1],t=h.Cd[2],0==r&&0==n?(r=A.min_y,n=A.max_y):(r=Math.min(r,A.min_y),n=Math.max(n,A.max_y)),A=1E-4*(n-r),r-=A,n+=A,h.Cd[0]=r,h.Cd[1]=n,ya.zs(k,t/2,-n,-r,t/2),ya.qi(k));break;case "DEBUG_VIEW":for(k=g.g,g=Ka.aa(g,l).X,l=0;l<g.length;l++)r=g[l],"DEBUG_VIEW"==r.type&&Z(h,k,p,v,r)}}break;case "LAMP":ha(c,a),Ba.JS(a)}Ka.ly(c,!0,a)};a.my=function(a){a.j.Or=!0};a.RT=function(a,c){ua.ma(c,function(c,d){"SHADOW_CAST"===d.type&&(Oa.ff(Oa.q(a.i),d.k.i),Oa.copy(a.jf,d.k.Gy))})};
a.G2=ja;a.MO=function(a,c){for(var d=a.j.Rc,b=new Float32Array(d.csm_num),e=0;e<d.csm_num;e++)b[e]=ya.nN(d,c,e);return b};a.kW=Z;a.zB=Y;a.$m=ia;a.Yw=function(a){return a.g.xj};a.oR=function(a){for(var c=0;c<a.A.length;c++)for(var d=U(a.A[c].Ta,fc),c=0;c<d.length;c++)for(var b=d[c].D,e=b.length-1;0<=e;e--){var f=b[e];f.lg==a.g&&(f.G&&ga.MB(f.G),b.splice(e,1))}};a.GT=function(a,c){for(var d=a.$b,b=Ka.aa(a,c).Fj,e=U(c,lb),f=0;f<e.length;f++){var h=e[f];h.Dr.set(d.kn,3*b);h.ra=!0}};a.ZH=ha;a.ha=function(){for(var a=
0;a<Ra.length;a++){var c=Ra[a];ua.ma(c.j.Pa,function(a,c){if("SINK"!=c.type){var d=c.k;Kb.qR(d.Ve,d.Wb,d.he,d.width,d.height);for(var d=c.D,b=0;b<d.length;b++){var e=d[b].G;e&&ga.MB(e)}}});c.j.Pa=[];c.j.Yj=[]}Rb=uc=null;Ra.length=0;wb=null};a.ZE=function(a,c,d){a=ya.XN(a,a.near,a.far,null,!0);var b=xa.wO(a);a=Ka.Mk("DYNAMIC");a.I=a.R={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Yc=a.Pe=O.yL();var e=a.Yc.mb;a.na=a.Ga=O.nn([e,0,0],[0,e,0],[0,0,e],a.Yc.O);d=ga.bN(b,d);c.D.push(u(a,
d))};a.yZ=function(a){return[a.frame_start,a.frame_end]};a.XG=function(a,c,d){pa.yS(a,c,d);Rb&&oa(Rb,a,c)};a.E1=oa;a.sH=U;a.qa=ea;a.qD=function(a){a=ea(a,"MAIN_OPAQUE");var c=a.ne,d=a.Je,b=[],e=[];b[0]=c[0];b[1]=c[1];b[2]=c[2];e[0]=d[0];e[1]=d[1];e[2]=d[2];return[a.Sg,b,e]};a.ty=function(a,c,d,b){a=U(a,lb);for(var e=0;e<a.length;e++){var f=a[e];f.ne.set(d);f.Je.set(b);f.Sg=c;f.ra=!0}};a.ND=function(a){if(a=ea(a,"SKY")){var c={};c.color=Array(3);Ma.copy(a.Xl,c.color);c.procedural_skydome=a.procedural_skydome;
c.use_as_environment_lighting=a.use_as_environment_lighting;c.rayleigh_brightness=a.rayleigh_brightness;c.mie_brightness=a.mie_brightness;c.spot_brightness=a.spot_brightness;c.scatter_strength=a.scatter_strength;c.rayleigh_strength=a.rayleigh_strength;c.mie_strength=a.mie_strength;c.rayleigh_collection_power=a.rayleigh_collection_power;c.mie_collection_power=a.mie_collection_power;c.mie_distribution=a.mie_distribution;return c}return null};a.OG=function(a,c){var d=ea(a,"SKY");d&&("number"==typeof c.procedural_skydome&&
(d.procedural_skydome=c.procedural_skydome),"number"==typeof c.use_as_environment_lighting&&(d.use_as_environment_lighting=c.use_as_environment_lighting),"object"==typeof c.color&&d.Xl.set(c.color),"number"==typeof c.rayleigh_brightness&&(d.rayleigh_brightness=c.rayleigh_brightness),"number"==typeof c.mie_brightness&&(d.mie_brightness=c.mie_brightness),"number"==typeof c.spot_brightness&&(d.spot_brightness=c.spot_brightness),"number"==typeof c.scatter_strength&&(d.scatter_strength=c.scatter_strength),
"number"==typeof c.rayleigh_strength&&(d.rayleigh_strength=c.rayleigh_strength),"number"==typeof c.mie_strength&&(d.mie_strength=c.mie_strength),"number"==typeof c.rayleigh_collection_power&&(d.rayleigh_collection_power=c.rayleigh_collection_power),"number"==typeof c.mie_collection_power&&(d.mie_collection_power=c.mie_collection_power),"number"==typeof c.mie_distribution&&(d.mie_distribution=c.mie_distribution),d.ra=!0,d.Nr=!0,da(a,d))};a.UY=function(a){return U(a,ib)[0].Te[0]};a.SY=function(a){return U(a,
ib)[0].Te[1]};a.VY=function(a){return U(a,ib)[0].Te[2]};a.TY=function(a){return U(a,ib)[0].Te[3]};a.RR=function(a,c){for(var d=U(a,ib),b=0;b<d.length;b++){var e=d[b];e.Te[0]=c;e.ra=!0}};a.PR=function(a,c){for(var d=U(a,ib),b=0;b<d.length;b++){var e=d[b];e.Te[1]=c;e.ra=!0}};a.SR=function(a,c){for(var d=U(a,ib),b=0;b<d.length;b++){var e=d[b];e.Te[2]=c;e.ra=!0}};a.QR=function(a,c){for(var d=U(a,ib),b=0;b<d.length;b++){var e=d[b];e.Te[3]=c;e.ra=!0}};a.uD=function(a,c){var d=c||[],b=U(a,ib)[0].od;d[0]=
b[0];d[1]=b[1];d[2]=b[2];d[3]=b[3];return d};a.xy=function(a,c){for(var d=U(a,ib),b=0;b<d.length;b++){var e=d[b];e.od.set(c);e.ra=!0}};a.PD=function(a){var c=ea(a,"SSAO");a=ea(a,"SSAO_BLUR");if(!c)return null;var d=c.D[0].G,b={};b.ssao_quality=ga.yw(d,"SSAO_QUALITY")[1];b.ssao_hemisphere=c.ssao_hemisphere;b.ssao_blur_depth=a.ssao_blur_depth;b.pB=a.ssao_blur_discard_value;b.radius_increase=c.dm;b.influence=c.cm;b.dist_factor=c.bm;b.ssao_only=c.ssao_only;b.ssao_white=ga.yw(d,"SSAO_WHITE")[1];return b};
a.QG=function(a,c){var d=ea(a,"SSAO"),b=ea(a,"SSAO_BLUR");if(!d)return ab.error("SSAO is not enabled on the scene"),0;if("string"==typeof c.ssao_quality){var e=d.D[0].G;ga.Od(e,"SSAO_QUALITY",c.ssao_quality);ga.Uc(e,!0)}"number"==typeof c.ssao_hemisphere&&(e=d.D[0].G,ga.Od(e,"SSAO_HEMISPHERE",c.ssao_hemisphere),ga.Uc(e,!0));"number"==typeof c.ssao_blur_depth&&(e=b.D[0].G,ga.Od(e,"SSAO_BLUR_DEPTH",c.ssao_blur_depth),ga.Uc(e,!0));"number"==typeof c.ssao_blur_discard_value&&(b.ssao_blur_discard_value=
c.ssao_blur_discard_value);"number"==typeof c.dm&&(d.dm=c.dm);"number"==typeof c.cm&&(d.cm=c.cm);"number"==typeof c.bm&&(d.bm=c.bm);if("number"==typeof c.ssao_only){d=ea(a,"MAIN_OPAQUE");d.ssao_only=c.ssao_only;for(var f=0;f<d.D.length;f++)e=d.D[f].G,ga.Od(e,"SSAO_ONLY",c.ssao_only),ga.Uc(e,!0)}"number"==typeof c.ssao_white&&(e=d.D[0].G,ga.Od(e,"SSAO_WHITE",c.ssao_white),ga.Uc(e,!0));d.ra=!0;b.ra=!0};a.oD=function(a){a=ea(a,"DOF");if(!a)return null;var c={};c.dof_distance=a.k.dof_distance;c.dof_front=
a.k.dof_front;c.dof_rear=a.k.dof_rear;c.dof_power=a.k.dof_power;c.je=a.k.je;return c};a.EG=Ca;a.xD=function(a){var c=U(a,["GOD_RAYS"]);a=ea(a,"GOD_RAYS_COMBINE");if(!c||!a)return null;var d={};d.god_rays_max_ray_length=c[0].ul;d.god_rays_intensity=a.god_rays_intensity;d.god_rays_steps=ga.yw(c[0].D[0].G,"STEPS_PER_PASS")[1];return d};a.GG=function(a,c){var d=U(a,["GOD_RAYS"]),b=ea(a,"GOD_RAYS_COMBINE");if(!d||!b)return ab.error("God Rays are not enabled on the scene"),0;"number"==typeof c.god_rays_intensity&&
(b.god_rays_intensity=c.god_rays_intensity);if("number"==typeof c.god_rays_max_ray_length)for(var e=c.god_rays_max_ray_length,f=0;f<d.length;f++)d[f].ul=e,d[f].ns=e/d[f].hm/(f+1),d[f].ra=!0;if("number"==typeof c.god_rays_steps)for(var h=qa.H(c.god_rays_steps,1),e=d[0].ul,f=0;f<d.length;f++){d[f].hm=h;d[f].ns=e/h/(f+1);d[f].ra=!0;var g=d[f].D[0].G;ga.Od(g,"STEPS_PER_PASS",h);ga.Uc(g,!0)}b.ra=!0};a.hD=function(a){var c=ea(a,"LUMINANCE_TRUNCED");a=ea(a,"BLOOM");if(!c||!a)return null;var d={};d.bloom_key=
c.bloom_key;d.bloom_edge_lum=c.bloom_edge_lum;d.bloom_blur=a.bloom_blur;return d};a.wG=ba;a.wD=function(a){a=ea(a,"GLOW_COMBINE");if(!a)return null;var c={};c.small_glow_mask_coeff=a.small_glow_mask_coeff;c.large_glow_mask_coeff=a.large_glow_mask_coeff;c.small_glow_mask_width=a.small_glow_mask_width;c.large_glow_mask_width=a.large_glow_mask_width;return c};a.FG=aa;a.$D=function(a){var c=T(a);a=Ma.length(c);if(0==a)return null;var c=Ha.Ld(Math.atan2(c[0],c[2])),d={};d.wind_dir=c;d.wind_strength=a;
return d};a.FR=function(a){a.j.wx=!0};a.XD=ca;a.WD=function(a,c){var d=a.j.mc,b=ea(a,"MAIN_OPAQUE");b&&d&&(c.waves_height=d.waves_height,c.waves_length=d.waves_length,b.Rf&&(c.water_fog_density=b.Rf[3],d=c.water_fog_color=[],d[0]=b.Rf[0],d[1]=b.Rf[1],d[2]=b.Rf[2]))};a.VG=function(a,c){var d=a.j.mc;if(!d)return ab.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof c.dst_noise_scale0&&(d.dst_noise_scale0=c.dst_noise_scale0);"number"==typeof c.dst_noise_scale1&&(d.dst_noise_scale1=
c.dst_noise_scale1);"number"==typeof c.dst_noise_freq0&&(d.dst_noise_freq0=c.dst_noise_freq0);"number"==typeof c.dst_noise_freq1&&(d.dst_noise_freq1=c.dst_noise_freq1);"number"==typeof c.dir_min_shore_fac&&(d.dir_min_shore_fac=c.dir_min_shore_fac);"number"==typeof c.dir_freq&&(d.dir_freq=c.dir_freq);"number"==typeof c.dir_noise_scale&&(d.dir_noise_scale=c.dir_noise_scale);"number"==typeof c.dir_noise_freq&&(d.dir_noise_freq=c.dir_noise_freq);"number"==typeof c.dir_min_noise_fac&&(d.dir_min_noise_fac=
c.dir_min_noise_fac);"number"==typeof c.dst_min_fac&&(d.dst_min_fac=c.dst_min_fac);"number"==typeof c.waves_hor_fac&&(d.waves_hor_fac=c.waves_hor_fac);"number"==typeof c.water_dynamic&&(d.Cn=c.water_dynamic);for(var b=U(a,Yb),e=0;e<b.length;e++){var f=b[e];"number"==typeof c.water_fog_density&&d.od&&(f.Rf[3]=c.water_fog_density);"object"==typeof c.water_fog_color&&d.od&&f.Rf.set(c.water_fog_color);"number"==typeof c.waves_height&&(f.zz=c.waves_height);"number"==typeof c.waves_length&&(f.Az=c.waves_length);
f.ra=!0}};a.MD=function(a,c,d){var b=a.j.mc;if(!b.ui)return 100;var e=b.px;a=b.Ii;var f=(c[0]-b.Vl[0])/b.Wl[0],h=(b.Vl[1]+c[2])/b.Wl[1],f=f+.5,h=h+.5;if(1<f||0>f||1<h||0>h)c=1;else return b=e*Ha.fD(Rb.j.Iy,b.Jy,f,h),c=(a-c[1])*d,c=Math.sqrt(b*b+c*c)};a.update=function(a,c){for(var d=b().Gh.g,e=0;e<Ra.length;e++){var f=Ra[e],h=f.j.Pa,g=f.j;if(g.mc)var m=Oa.q(d.i),p=m[1]-ca(f,m[0],m[2]);for(m=0;m<g.wm.length;m++){var l=g.wm[m].j,v=l.Ba,k=l.Qc;if(!(f.b4w_use_nla&&l.jt||!v&&!k)&&Ga.sI(l)){var q=Ga.pI(l),
r=Ga.rI(l);v&&ta.zf&&(r-=5);var u=Ga.sU(l);q>=u&&l.gk||q<r?(Ga.mG(l.name,l.Ah),k&&(l.Sl=Ga.us(l,a))):q>=u&&!l.gk?Ga.Lx(l.name,l.Ah):Ga.tI(l)&&(v?Ga.dI(l):(v=Ga.us(l,a),v!=l.Sl&&(Ga.cI(l),l.ak++),l.Sl=v))}}ua.ma(h,function(c,d){-1<Sb.indexOf(d.type)&&(d.time=a);g.mc&&(d.lv=p)})}for(e=0;e<Ra.length;e++)if(f=Ra[e],g=f.j,h=g.Pa,d=g.Yj,d.length)for(g.Or&&(Q(f),g.Or=!1),g.wx&&(za(f),g.wx=!1),g.xx&&(R(f),g.xx=!1),g.Jj&&ma(h,c),f=na.Nb(h,"OUTLINE_MASK"),m=0;m<d.length;m++)h=d[m],La.ks(h),f&&S(h,f),Kb.Sk(h);
ta.show_hud_debug_info&&Fa.DS(Ra,c)};a.xR=function(a){a.j.xx=!0};a.vw=function(a){var c=[];ua.ma(a.j.Pa,function(a,d){c.push(d)});return c};a.jD=function(){var a=ea(Rb,"MAIN_BLEND"),c=Rb;return a||c.j.mc?a.lv:null};a.bI=function(a){ua.ma(a.j.Pa,function(a,c){c.ra=!0})};a.LR=function(a,c){a.debug_view_mode=c;a.ec=c!=Ea.vp;a.eb=c==Ea.wp;a.ra=!0;for(var d=b(),e=0;e<Yb.length;e++){var f=ea(d,Yb[e]);f&&(f.bw=c==Ea.Bm)}};a.KR=function(a,c){a.debug_colors_seed=c;a.ra=!0};a.iS=function(a,c){a.rC=c;a.ra=!0};
a.tS=function(a,c){for(var d=0;d<a.D.length;d++)a.D[d].G.wireframe_edge_color=c,a.ra=!0};a.XH=function(a,c){var d=c.Vk,b=a.j.Bh;if(d&&"WIND"==d.type&&b){Ha.Cb(Oa.B(c.g.i),Ha.uc,b);Ma.normalize(b,b);Ma.scale(b,d.qH,b);for(var d=U(a,Sb),e=0;e<d.length;e++)d[e].Bh.set(b);return!0}return!1};a.SQ=function(a,c,d){var b=ea(a,"COLOR_PICKING");if(b)return c=pa.Xm(c,d,Gc,b.k),La.ks(b),Kb.Sk(b),(a=ea(a,"COLOR_PICKING_XRAY"))?(La.ks(a),Kb.Sk(a),b=a.k):b=b.k,c[1]=b.height-c[1],Kb.Xx(b.Ve,c[0],c[1]);ab.error("Object Selection is not available on the scene");
return null};a.KG=function(a){var c=b();if(c=ea(c,"OUTLINE"))c.jh.set(a),c.ra=!0};a.TZ=T;a.Yq=function(a){var c={title:"",description:""};a.b4w_tags&&(c.title=a.b4w_tags.title,c.description=a.b4w_tags.description);return c};a.WH=function(a,c){var d=Tb;Ma.negate(c,d);for(var b=0;6>b;b++){var e=a.gj[b],f=a.sn[b],h=a.k;sa.translate(Ha.OI[b],d,e);sa.multiply(h.Bb,e,h.Qf);Ha.Nq(h.Qf,f)}};a.$H=function(a,c,d){Ha.kT(c,d,Ha.uc,a.k.jc)};a.oL=function(a,c,d){var b=a.j.Rc,e=a.j.og;d=Ka.ar(d,ta.Rd&&a.b4w_enable_ssao);
if(e)for(var f=0;f<c.length;f++){var h=c[f],g=Ka.aa(h,a);if(null!=h.g.se){var m=e.ng,l=e.gs,h=h.g.se;l.length?g.ng=l[h]:m.length&&(g.ng=m[h])}else null!=h.g.Qe&&(m=e.Mg,l=e.Mv,h=h.g.Qe,l.length?g.Mg=l[h]:m.length&&(g.Mg=m[h]))}for(f=0;f<d.length;f++)if(g=Ka.aa(d[f],a),b)for(c=U(a,["SHADOW_CAST"]),e=0;e<c.length;e++)f==c[e].Lf&&g.Hy.push(c[e])};a.$E=function(a,c){return a.timeline_markers[c]};a.As=function(a){var c=b();if(c=ea(c,"STEREO"))a.distortion_coefs&&(c.jj[0]=a.distortion_coefs[0],c.jj[1]=
a.distortion_coefs[1],c.ra=!0),a.chromatic_aberration_coefs&&(c.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],c.ra=!0),a.base_line_factor&&(c.jj[2]=a.base_line_factor,c.ra=!0),a.inter_lens_factor&&(c.jj[3]=a.inter_lens_factor,c.ra=!0),a.enable_hmd_stereo&&(c.enable_hmd_stereo=a.enable_hmd_stereo,
c.ra=!0)};a.oF=function(c,d){for(var b=Ra,e=0;e<b.length;e++)na.DQ(a.Dw(b[e]),c,d)}};b4w.module.__hud=function(a,n){function k(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function b(a){e(' SCENE "'+a.name+'"');e(" Active        Subscene       Lamps      Size   RenderCalls  Time");if(a.j){var b=0,f=0,g=0;w.ma(a.j.Pa,function(a,l){if("SINK"!=l.type){var k=l.type,r=Math.round(l.k.width)+"x"+Math.round(l.k.height),n=l.D.length,t=l.un;if("MAIN_CUBE_REFLECT"==l.type||"MAIN_CUBE_REFLECT_BLEND"==l.type)n*=6;var d=l.ec,h=d?l.tf:0;l.cd||(l.tf=0);
e(d?" (\u2713)":" (\u2715)",k,l.Rr,r,t,"of",n,"  ",h.toFixed(3));l.un=0;d&&(b+=n,f+=t,g+=h)}});return[b,f,g]}e("No INFO")}function e(){for(var a=80+20*r[0],b=arguments[0],e=1;e<arguments.length;e++){for(var g="",k=0;k<t[e]-String(arguments[e]).length;k++)g+=" ";b+=g+arguments[e]}r[0]++;f.fillText(b,30,a)}function y(a,b,e){b*=a.Eb;e.x=a.x+b;e.y=a.y;e.Eb=a.Eb-2*b;e.vb=a.vb}function g(a){return a.x+a.Eb/2}function B(a){var b=f,e={x:0,y:0,Eb:0,vb:0},g=b.canvas.width,b=b.canvas.height;e.x=0;e.y=0;e.Eb=
g;e.vb=b;y(e,.01,e);g=.02*e.vb;e.x=e.x;e.y+=g;e.Eb=e.Eb;e.vb-=2*g;g=e.Eb/8;e.x+=g*a;e.y=e.y;e.Eb=g;e.vb=e.vb;y(e,.02,e);return e}var w=n("__graph");n("__print");var t=[5,24,7,10,4,3,6],f=null,r=[0,0];a.yf=function(a){a=a.getContext("2d");k(a);return f=a};a.$o=function(){f&&k(f)};a.reset=function(){var a=f;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),r[0]=0,r[1]=0)};a.DS=function(a,g){var k=f;if(k){k.textAlign="left";
k.fillStyle="rgba(0,255,0,255)";e(" FPS",(1/g).toFixed(2));r[0]++;for(var n=k=0,t=0,w=0;w<a.length;w++){var B=b(a[w]),k=k+B[0],n=n+B[1],t=t+B[2];r[0]++}e(" -----------------------------------------------");e("    ","TOTAL ACTIVE","","",n,"of",k,"  ",t.toFixed(3))}};a.print=function(){var a=f;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",e.apply(Math,arguments))};a.r0=function(a,b,e,k,r,n,t){var w=f;if(w){b=B(b);var y=b.vb/5;b.x=b.x;b.y+=4*y;b.Eb=b.Eb;b.vb=y;w.textAlign="center";w.fillStyle=
"#00FF00";f.fillText(a,g(b),b.y-10);w.strokeStyle="#00FF00";w.lineWidth=.5;w.beginPath();w.moveTo(b.x,b.y);w.lineTo(b.x+b.Eb,b.y);w.lineTo(b.x+b.Eb,b.y+b.vb);w.lineTo(b.x,b.y+b.vb);w.closePath();w.stroke();if(!n&&!t)for(n=1E6,t=-1E6,a=0;a<e.length;a++)n=Math.min(n,e[a]),t=Math.max(t,e[a]);w.textAlign="right";f.fillText(String(n),b.x-10,b.y+b.vb);f.fillText(String(t),b.x-10,b.y);w.textAlign="center";f.fillText(String(k),b.x,b.y+b.vb+15);f.fillText(String(r),b.x+b.Eb,b.y+b.vb+15);w.strokeStyle="#FF0000";
w.lineWidth=1.5;w.beginPath();k=b.Eb/(e.length-1);t=b.vb/(t-n);for(a=0;a<e.length;a++)r=b.x+k*a,y=b.y+b.vb-(e[a]-n)*t,0==a?w.moveTo(r,y):w.lineTo(r,y);w.stroke()}};a.HX=function(a,b,e,k,r,n,t){var w=f;if(w)for(w.textAlign="center",w.fillStyle="#00FF00",w.font="bold 12px Courier",e=B(e),f.fillText(b?"["+a+"]":a,g(e),e.y),0<=n&&f.fillText(n?"[M]":"[ ]",g(e)-15,e.y+30),0<=t&&f.fillText(t?"[S]":"[ ]",g(e)+15,e.y+30),a={x:0,y:0,Eb:0,vb:0},b=0;b<k.length;b++){n=k[b];var y="VOLUME"==n[0];if(y){t=e.y+350;
var K=e.Eb,d=a;d.x=e.x;d.y=t;d.Eb=K;d.vb=250}else{t=e.y+10+50*b;var K=e.Eb,d=e.vb,h=a;h.x=e.x;h.y=t;h.Eb=K;h.vb=d}t=w;var K=a,h=b==r,v=n[0],d=n[1],P=n[2],c=n[3],p=(c-P)/n[4],p=1>p?Math.floor(1/p-1E-5).toFixed(0).length:0;n=n[5]?Math.log(d/P)/Math.log(c/P):(d-P)/(c-P);t.textAlign="center";h?t.fillText("["+v+"]",g(K),K.y):t.fillText(v,g(K),K.y);t.strokeStyle="#00FF00";t.lineWidth=y?3:1;y?(t.textAlign="right",t.fillText(c.toFixed(p),g(K)-10,K.y+15),t.textAlign="right",t.fillText(P.toFixed(p),g(K)-10,
K.y+K.vb-15)):(t.textAlign="right",t.fillText(P.toFixed(p),K.x+28,K.y+15),t.textAlign="left",t.fillText(c.toFixed(p),K.x+K.Eb-28,K.y+15));t.beginPath();if(y){var N=K.y+15+(K.vb-30)*(1-n);t.moveTo(g(K),K.y+15);t.lineTo(g(K),K.y+K.vb-15);t.moveTo(g(K)-5,K.y+15);t.lineTo(g(K)+5,K.y+15);t.moveTo(g(K)-5,K.y+K.vb-15);t.lineTo(g(K)+5,K.y+K.vb-15);t.moveTo(g(K)-5,N);t.lineTo(g(K)+5,N)}else{var G=K.x+30+(K.Eb-60)*n;t.moveTo(K.x+30,K.y+15);t.lineTo(K.x+K.Eb-30,K.y+15);t.moveTo(K.x+30,K.y+15-5);t.lineTo(K.x+
30,K.y+15+5);t.moveTo(K.x+K.Eb-30,K.y+15-5);t.lineTo(K.x+K.Eb-30,K.y+15+5);t.moveTo(G,K.y+15-5);t.lineTo(G,K.y+15+5)}t.stroke();"EQ_Q"==v?(n=Math.log(1+1/(2*d*d)+Math.sqrt((2+1/(d*d))*(2+1/(d*d))/4-1))/Math.log(2),y?(t.textAlign="left",t.fillText(d.toFixed(p),g(K)+10,N),t.textAlign="left",t.fillText("("+n.toFixed(p+1)+")",g(K)+10,N+10)):(t.textAlign="right",t.fillText(d.toFixed(p),G,K.y+30),t.textAlign="left",t.fillText("("+n.toFixed(p+1)+")",G,K.y+30))):y?(t.textAlign="left",t.fillText(d.toFixed(p),
g(K)+10,N)):(t.textAlign="center",t.fillText(d.toFixed(p),G,K.y+30))}}};b4w.module.__input=function(a,n){function k(a){var c=q.Xv();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||c)&&(10!=a||c&&window.DeviceOrientationEvent)?!0:!1}function b(a,c){if(!k(a))return null;var d={type:a,If:!1,bf:[],Gf:[],eh:[],fh:[],gh:[],hh:[],no:[],KE:[],$g:[],zh:[],yh:[],xh:[],element:c,lh:!0,yb:[],Mr:new Float32Array(2),CQ:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),xm:null,yg:null,He:null,orientation:V.create(),position:R.create(),
Tg:new Float32Array(4),Ug:new Float32Array(4),Bj:0,Jh:0,ni:0,ym:0,Yh:0,Kh:0,rj:[],Th:[0,0,0,0,0,0,0,0,0,0,0,0],VC:[0,0,0,0,0,0,0,0,0,0,0,0],Tq:[]};d.Tg[0]=d.Tg[1]=d.Tg[2]=d.Tg[3]=45;d.Ug[0]=d.Ug[1]=d.Ug[2]=d.Ug[3]=45;30==a||40==a||50==a?(d.If=Boolean(c),50==a?document.addEventListener("touchstart",function(){}):40==a&&(d.lh=!1)):10==a?d.If=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ja.zf?g(d,W.webvr):(y(d),d.If=!0));return d}function e(c,d){10==c||20==c?d=window:d||(d=D.le());for(var e=
0;e<oa.length;e++)if(oa[e].type==c&&oa[e].element==d)return oa[e];e=b(c,d);60!=c&&70!=c&&80!=c&&90!=c||e.Tq.push(a.Rt,a.St,a.cu,a.ju,a.ku,a.lu,a.Bp,a.Cp,a.mu,a.nu,a.Tt,a.Ut,a.Vt,a.Wt,a.Xt,a.Yt,a.Zt,a.$t,a.au,a.bu,a.du,a.eu,a.fu,a.gu,a.hu,a.iu,a.xp,a.yp,a.zp,a.Ap,a.Lt,a.Mt,a.Nt,a.Ot,a.Pt,a.Qt,a.Jt,a.Kt);e&&oa.push(e);return e}function y(a){var c=W.nonwebvr;a.ym=c.ym;a.Yh=c.Yh;a.Kh=c.Kh;g(a,c);a.Bj=c.Bj;a.Jh=c.Jh;a.ni=c.ni;w(a)}function g(a,c){a.distortion_coefs[0]=c.distortion_coefs[0];a.distortion_coefs[1]=
c.distortion_coefs[1];a.chromatic_aberration_coefs[0]=c.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=c.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=c.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=c.chromatic_aberration_coefs[3]}function B(a,c){var d=c*c;return c*(1+a[0]*d+a[1]*d*d)}function w(a){var c=a.Jh-a.Kh,d=a.Yh-c,b=a.distortion_coefs,c=Q.Ld(Math.atan(B(b,c/a.ni))),e=Q.Ld(Math.atan(B(b,d/a.ni))),f=Q.Ld(Math.atan(B(b,d/a.ni))),d=Q.Ld(Math.atan(B(b,
d/a.ni)));e&&(a.Tg[0]=a.Ug[0]=Math.min(e,60));f&&(a.Tg[1]=a.Ug[3]=Math.min(f,60));c&&(a.Tg[2]=a.Ug[2]=Math.min(c,60));d&&(a.Tg[3]=a.Ug[1]=Math.min(d,60))}function t(a,c){var d=c.filter(function(a){return a instanceof HMDVRDevice}),b=null;d.length&&(b=d[0]);d=null;b&&(d=c.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==b.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.xm=b;a.yg=d}function f(a,c,d){switch(a.type){case 20:var b=a.He||a.xm;b?(c=b.getEyeParameters(c),
c=c.fieldOfView||c.currentFieldOfView,a=a.distortion_coefs,b=B(a,Math.tan(Q.jb(c.downDegrees))),Q.Ld(Math.atan(b)),b=B(a,Math.tan(Q.jb(c.upDegrees))),Q.Ld(Math.atan(b)),b=B(a,Math.tan(Q.jb(c.leftDegrees))),Q.Ld(Math.atan(b)),a=B(a,Math.tan(Q.jb(c.rightDegrees))),Q.Ld(Math.atan(a)),d[0]=c.upDegrees,d[1]=c.rightDegrees,d[2]=c.downDegrees,d[3]=c.leftDegrees):(c="left"==c?a.Tg:a.Ug,X.copy(c,d));break;default:m.error("fov is undefined for device: ",a.type)}return d}function r(a,c){switch(c){case 0:return navigator.getVRDisplays?
3:navigator.getVRDevices?ja.zf?1:0:2;case 23:var d=a.He||a.xm;if(d){var b=d.getEyeParameters("left"),d=d.getEyeParameters("right");return a.He?d.offset[0]-b.offset[0]:d.eyeTranslation.x-b.eyeTranslation.x}return a.Bj}}function l(a,c){if(a.He){var d=a.He,b=d.capabilities,d=d.getPose();b.hasOrientation&&d.orientation&&(a.orientation[0]=d.orientation[0],a.orientation[1]=d.orientation[1],a.orientation[2]=d.orientation[2],a.orientation[3]=d.orientation[3]);b.hasPosition&&d.position&&(a.position[0]=d.position[0],
a.position[1]=d.position[1],a.position[2]=d.position[2])}else 1<c-ha&&(ha=c,navigator.getVRDisplays?a.He||navigator.getVRDisplays().then(function(c){0<c.length&&(a.He=c[0],a.If=!0)},function(){m.fc("WebVR displays are not found.");a.If=!1}):navigator.getVRDevices?a.xm||ka||navigator.getVRDevices().then(function(c){t(a,c);c.length&&(a.If=!0);ka=!0},function(){m.fc("WebVR devices are not found.");a.If=!1;ka=!0}):ja.zf||m.fc("HMD isn't supported."))}function A(a,c){if(a){for(var d=0;d<a.buttons.length;d++)c.rj[d]=
a.buttons[d].pressed;if(a.axes&&12>=a.axes.length)for(d=0;d<a.axes.length;d++)c.Th[d]=a.axes[d]}}function x(a){for(var c=0;c<a.rj;c++)a.rj[c]=!1;for(c=0;c<a.Th.length;c++)a.VC[c]=a.Th[c],a.Th[c]=0}function L(a,c){var d=a.indexOf(c);0<=d&&(a[d]=null)}function M(a){return null===a}function F(a,b,e,f){switch(b){case 120:e&&L(a.bf,e);if(f||a.Gf.every(M)&&a.bf.every(M))a.bf.length=0,a.Gf.length=0,b=a.yb.indexOf(131),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("deviceorientation",C,!1));break;
case 130:e&&L(a.Gf,e);if(f||a.Gf.every(M)&&a.bf.every(M))a.bf.length=0,a.Gf.length=0,b=a.yb.indexOf(131),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("deviceorientation",C,!1));break;case 40:e&&L(a.eh,e);if(f||a.eh.every(M))a.eh.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("mousedown",d,!1));break;case 30:e&&L(a.fh,e);if(f||a.fh.every(M))a.fh.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("mousemove",K,!1));break;case 50:e&&
L(a.gh,e);if(f||a.gh.every(M)){a.gh.length=0;b=a.yb.indexOf(b);0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("mouseout",h,!1),a.element.removeEventListener("mouseup",v,!1));break}break;case 60:e&&L(a.hh,e);if(f||a.hh.every(M))a.hh.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("wheel",P,!1));break;case 80:e&&L(a.no,e);if(f||a.no.every(M))a.no.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("keydown",c,!1));break;case 70:e&&
L(a.$g,e);if(f||a.$g.every(M))a.$g.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("keyup",p,!1));break;case 90:e&&L(a.zh,e);if(f||a.zh.every(M))a.zh.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("touchstart",N,!1));break;case 100:e&&L(a.yh,e);if(f||a.yh.every(M))a.yh.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("touchmove",G,!1));break;case 110:if(e&&L(a.xh,e),f||a.xh.every(M))a.xh.length=0,b=
a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("touchend",u,!1))}}function J(a,c){Q.Hx(a,Q.Fu,c);var d="orientation"in window?Q.jb(window.orientation):"orientation"in window.screen?Q.jb(window.screen.orientation.angle):0,d=V.setAxisAngle(Q.lf,-d,Y);V.multiply(c,d,c);d=V.setAxisAngle(Q.Ke,-Math.PI/2,Y);V.multiply(d,c,c);d=V.setAxisAngle(Q.Ke,Math.PI/2,Y);V.multiply(c,d,c);return c}function C(a){var c=ia;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=Q.jb(a.alpha),
c[1]=Q.jb(a.beta),c[2]=Q.jb(a.gamma));a=e(10,a.currentTarget);for(var d=0;d<a.Gf.length;d++){var b=a.Gf[d];b&&(R.copy(c,da),b(da))}if(a.bf.length)for(c=J(c,Z),d=0;d<a.bf.length;d++)if(b=a.bf[d])V.copy(c,E),b(E);for(d=0;d<a.bf.length;d++)a.bf[d]||a.bf.splice(d,1);for(d=0;d<a.Gf.length;d++)a.Gf[d]||a.Gf.splice(d,1)}function H(a,c){switch(a.type){case 30:a.Mr[0]=c.clientX,a.Mr[1]=c.clientY,a.CQ=c.which}}function K(a){var c=e(30,a.currentTarget);H(c,a);for(var d=0;d<c.fh.length;d++){var b=c.fh[d];b&&
(la[0]=a.clientX,la[1]=a.clientY,b(la))}c.lh&&a.preventDefault();for(d=0;d<c.fh.length;d++)c.fh[d]||c.fh.splice(d,1)}function d(a){var c=e(30,a.currentTarget);H(c,a);for(var d=0;d<c.eh.length;d++){var b=c.eh[d];b&&b(a.which)}c.lh&&a.preventDefault();for(d=0;d<c.eh.length;d++)c.eh[d]||c.eh.splice(d,1)}function h(a){D.vE(a.relatedTarget)||v(a)}function v(a){var c=e(30,a.currentTarget);H(c,a);for(var d=0;d<c.gh.length;d++){var b=c.gh[d];b&&b(a.which)}c.lh&&a.preventDefault();for(d=0;d<c.gh.length;d++)c.gh[d]||
c.gh.splice(d,1)}function P(a){for(var c=e(30,a.currentTarget),d=0;d<c.hh.length;d++){var b=c.hh[d];b&&b(-a.deltaY)}c.lh&&a.preventDefault();for(d=0;d<c.hh.length;d++)c.hh[d]||c.hh.splice(d,1)}function c(a){for(var c=e(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.KE:c.no,b=0;b<d.length;b++){var f=d[b];f?f(a.keyCode):d.splice(b--,1)}c.lh&&a.preventDefault()}function p(a){for(var c=e(40,a.currentTarget),d=0;d<c.$g.length;d++){var b=c.$g[d];b&&b(a.keyCode)}c.lh&&a.preventDefault();for(d=0;d<
c.$g.length;d++)c.$g[d]||c.$g.splice(d,1)}function N(a){for(var c=e(50,a.currentTarget),d=0;d<c.zh.length;d++){var b=c.zh[d];b&&b(a.targetTouches)}for(d=0;d<c.zh.length;d++)c.zh[d]||c.zh.splice(d,1)}function G(a){for(var c=e(50,a.currentTarget),d=0;d<c.yh.length;d++){var b=c.yh[d];b&&b(a.targetTouches)}c.lh&&a.preventDefault();for(d=0;d<c.yh.length;d++)c.yh[d]||c.yh.splice(d,1)}function u(a){for(var c=e(50,a.currentTarget),d=0;d<c.xh.length;d++){var b=c.xh[d];b&&b(a.targetTouches)}for(d=0;d<c.xh.length;d++)c.xh[d]||
c.xh.splice(d,1)}function z(a){switch(a){case 0:a=60;break;case 1:a=70;break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}var q=n("__compat"),D=n("__container"),I=n("__config"),m=n("__print"),V=n("__quat"),Q=n("__util"),R=n("__vec3"),X=n("__vec4"),ja=I.v,W=I.qP;a.Tf=10;a.td=20;a.Nc=30;a.zm=40;a.nf=50;a.qp=60;a.At=70;a.Bt=80;a.Ct=90;a.Tz=0;a.Uz=1;a.Sz=2;a.vu=3;a.Gp=0;a.Ep=10;a.Fp=20;a.MI=21;a.NI=22;a.ru=23;a.qu=24;a.ou=25;a.tu=26;a.uu=27;a.su=28;a.pu=29;a.Eh=30;a.Ni=40;a.Em=50;a.Fm=60;
a.Dm=70;a.Cm=80;a.Wz=81;a.Qi=90;a.Im=100;a.Hm=110;a.Dp=120;a.qk=130;a.Rt=0;a.St=1;a.cu=2;a.ju=3;a.ku=4;a.lu=5;a.Bp=6;a.Cp=7;a.mu=8;a.nu=9;a.Tt=10;a.Ut=11;a.Vt=12;a.Wt=13;a.Xt=14;a.Yt=15;a.Zt=16;a.$t=17;a.au=18;a.bu=19;a.du=20;a.eu=21;a.fu=22;a.gu=23;a.hu=24;a.iu=25;a.xp=26;a.yp=27;a.zp=28;a.Ap=29;a.Lt=30;a.Mt=31;a.Nt=32;a.Ot=33;a.Pt=34;a.Qt=35;a.Jt=36;a.Kt=37;var Z=V.create(),Y=V.create(),ia=R.create(),ha=-Infinity,ka=!1,la=new Float32Array(2);R.create();var da=R.create(),E=V.create(),oa=[];a.nv=
k;a.da=e;a.az=function(a,c){a.lh=c};a.fy=function(a){switch(a.type){case 20:if(a.If)if(a.He)a.He.resetPose();else if(a.yg)for(var c=0;c<a.yg.length;c++)a.yg[c].resetSensor();break;default:m.error("reset_device() is undefined for device: ",a.type)}};a.Wh=function(a,c,d){switch(c){case 10:a:switch(a.type){case 20:R.copy(Q.Bu,d);if(a.He)d[0]=a.orientation[0],d[1]=a.orientation[1],d[2]=a.orientation[2],d[3]=a.orientation[3];else if(a.yg)for(c=0;c<a.yg.length;c++){var b=a.yg[c],b=b.getState&&b.getState()||
b.getImmediateState&&b.getImmediateState();b.orientation&&(d[0]=b.orientation.x,d[1]=b.orientation.y,d[2]=b.orientation.z,d[3]=b.orientation.w)}V.normalize(d,d);a=V.setAxisAngle(Q.Ke,Math.PI/2,Z);V.multiply(d,a,d);break a;default:m.error("orientation_quat is undefined for device: ",a.type)}return d;case 20:a:switch(a.type){case 20:R.copy(Q.Eu,d);if(a.He)d[0]=a.position[0],d[1]=a.position[1],d[2]=a.position[2];else if(a.yg)for(c=0;c<a.yg.length;c++)b=a.yg[c],b=b.getState&&b.getState()||b.getImmediateState&&
b.getImmediateState(),b.position&&(d[0]=b.position.x,d[1]=b.position.y,d[2]=b.position.z);break a;default:m.error("position is undefined for device: ",a.type)}return d;case 21:return f(a,"left",d);case 22:return f(a,"right",d);case 30:return d[0]=a.Mr[0],d[1]=a.Mr[1],d}};a.br=r;a.sy=function(a,c,d){switch(a.type){case 20:if(3===r(a,0))break;switch(c){case 24:a.distortion_coefs[0]=d[0];a.distortion_coefs[1]=d[1];break;case 23:a.Bj=d;w(a);break;case 25:a.Jh=d;w(a);break;case 26:a.ni=d;w(a);break;case 27:a.ym=
d;w(a);break;case 28:a.Yh=d;w(a);break;case 29:a.Kh=d,w(a)}break;case 60:case 70:case 80:case 90:a.Tq[c]=d}};a.VO=function(a,c){return c<a.rj.length?a.rj[a.Tq[c]]:!1};a.UO=function(a,c){return c-26<a.Th.length?a.Th[a.Tq[c]-26]:0};a.update=function(a){for(var c=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],d=0;d<oa.length;d++){var b=oa[d];switch(b.type){case 60:x(b);A(c[0],b);break;case 70:x(b);A(c[1],b);break;case 80:x(b);A(c[2],b);break;
case 90:x(b);A(c[3],b);break;case 20:l(b,a)}}};a.Xc=function(a,b,e){switch(b){case 120:a.bf.push(e);b=131;break;case 130:a.Gf.push(e);b=131;break;case 40:a.eh.push(e);break;case 30:a.fh.push(e);break;case 50:a.gh.push(e);break;case 60:a.hh.push(e);break;case 80:a.no.push(e);break;case 81:a.KE.push(e);b=80;break;case 70:a.$g.push(e);break;case 90:a.zh.push(e);break;case 100:a.yh.push(e);break;case 110:a.xh.push(e)}if(-1==a.yb.indexOf(b)&&(a.yb.push(b),a.If))switch(b){case 40:a.element.addEventListener("mousedown",
d,!1);break;case 30:a.element.addEventListener("mousemove",K,!1);break;case 50:a.element!=window&&a.element.addEventListener("mouseout",v,!1);a.element.addEventListener("mouseup",v,!1);break;case 60:a.element.addEventListener("wheel",P,!1);break;case 80:a.element.addEventListener("keydown",c,!1);break;case 70:a.element.addEventListener("keyup",p,!1);break;case 90:a.element.addEventListener("touchstart",N,!1);break;case 100:a.element.addEventListener("touchmove",G,!1);break;case 110:a.element.addEventListener("touchend",
u,!1);break;case 131:a.element.addEventListener("deviceorientation",C,!1)}};a.$c=function(a,c,d){F(a,c,d,!1)};a.kP=J;a.ha=function(){for(var a=0;a<oa.length;a++)for(var c=oa[a],d=0;d<c.yb.length;d++)F(c,c.yb[d],null,!0);oa.length=0};a.ED=function(a){a=e(z(a));for(var c=0;c<a.rj.length;c++)if(a.rj[c])return c;return-1};a.zD=function(a){a=e(z(a));for(var c=0;c<a.Th.length;c++)if(a.VC[c]-a.Th[c])return c+26;return-1};a.tD=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],c=0;c<a.length;c++)if(a[c])return c;return 0};a.YD=function(){var a=e(20);return a&&a.He}};b4w.module.__physics=function(a,n){function k(a,c){for(var d=a.zd,b=0;b<d.length;b++)d[b].Hf.cp&&c.push(d[b]),k(d[b],c)}function b(a,c,d){for(var b=a.Jb.D,e=0;e<b.length;e++)for(var f=b[e].r,h=0;h<f.yd.length;h++){var g=f.yd[h];"ANY"!=g.pb&&d!=g.pb||H(g,a,c)}}function e(a,c,d){if(q.sr(a))switch(c){case q.YI:var b=y(a);b.Jb.CI=!0;q.M(a,q.UJ,Date.now()-performance.now(),Z.Df,Z.hv?Y.RC:0);break;case q.ZI:I.mx("URANIUM:",d.slice(1));break;case q.UI:I.error(d);break;case q.VI:z.Pq.apply(this,d.slice(1));
break;case q.dJ:var e=g(d.J);if(e){a=d.trans;b=d.quat;c=d.ig;var f=d.Vf,e=e.r;e.Cq=d.time;R.qh(a,1,b,e.Ov);ja.copy(c,e.ig);ja.copy(f,e.Vf)}break;case q.aJ:(a=g(d.ov))&&R.qh(d.trans,1,d.quat,a.n.Bo[d.Sx]);break;case q.WI:if(b=g(d[1]))a=d[4],b=b.Se.hq[d[2]],Q.kc(b,d[3]),Q.rg(b,a),Q.o(b);break;case q.eJ:if(e=g(d[1]))e.n.speed=d[2];break;case q.QI:b=y(a);B(b,d.Zi,d.$i,d.result,null,null,0);break;case q.SI:b=y(a);B(b,d.Zi,d.$i,d.result,d.ej,d.coll_norm,d.coll_dist);break;case q.RI:if(e=g(d[1]))a=e.r,a.dj&&
a.dj(d[2]);break;case q.Vz:case q.bJ:b=y(a);if(a=b.Jb.ki[d.id])if(b=g(d.Ek),c==q.Vz)c=a.callback,c(a.id,d.hit_fract,b,d.hit_time);else{c=d.hit_fract;var f=d.hit_time,e=d.hit_pos,m=a.callback;e?m(a.id,c,b,f,e,d.hit_norm):m(a.id,c,b,f)}break;case q.cJ:h(id);break;case q.$I:a=ka.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(d[2]-d[1]).toFixed(3)+" ms, IN "+(performance.now()-d[2]).toFixed(3)+" ms, ALL "+(performance.now()-d[1]).toFixed(3)+" ms");break;case q.XI:ha=d[1];break;case q.TI:a=ka.indexOf(a);
console.log("Worker: #"+String(a));console.log(d[1]);break;default:I.error("Wrong message: "+c)}}function y(a){for(var c=0;c<ka.length;c++)if(ka[c]==a)return la[c]}function g(a){return da[a]||null}function B(a,c,d,b,e,f,h){a=a.Jb.D;for(var m=0;m<a.length;m++)for(var p=a[m].r,l=0;l<p.yd.length;l++){for(var v=p.yd[l],k=v.ii,q=!1,r=0;r<k.length;r++){var u=k[r];if(u[0]===c&&u[1]===d){v.vo[r]=b;q=!0;break}}q&&(k=w(v),e&&v.cv!=c&&(q=e,r=f,u=h,q[0]+=r[0]*u,q[1]+=r[1]*u,q[2]+=r[2]*u,r[0]*=-1,r[1]*=-1,r[2]*=
-1),v.callback(k,k?v.cv==c?g(d):g(c):null,e,f,h))}}function w(a){a=a.vo;for(var c=!1,d=0;d<a.length;d++)c=c||a[d];return c}function t(){U.body++;return U.body}function f(a){var c=oa.indexOf(a);return-1==c?(oa.push(a),oa.length-1):c}function r(a,c){return{J:a,type:c,jg:0,ur:!1,vi:!0,Ed:!1,Ze:!1,FP:!1,tq:null,pb:"",gn:0,pX:{},yd:[],dj:null,Cq:0,Ov:new Float32Array([0,0,0,1,0,0,0,1]),ig:new Float32Array(3),Vf:new Float32Array(3),jq:new Float32Array(3),Wm:new Float32Array(4)}}function l(a,c){switch(a){case "BOX":var d=
c.R;break;case "CYLINDER":d=c.Yu;break;case "CONE":d=c.Xu;break;case "SPHERE":d=c.Pe;break;case "CAPSULE":d=c.Wu}return d}function A(a){if(!a)return null;var c={};"number"===typeof a.min_x&&(c.min_x=a.min_x);"number"===typeof a.min_y&&(c.min_y=a.min_y);"number"===typeof a.min_z&&(c.min_z=a.min_z);"number"===typeof a.max_x&&(c.max_x=a.max_x);"number"===typeof a.max_y&&(c.max_y=a.max_y);"number"===typeof a.max_z&&(c.max_z=a.max_z);"object"===typeof a.O&&(c.center=a.O);"number"===typeof a.mb&&(c.radius=
a.mb);"number"===typeof a.height&&(c.height=a.height);return c}function x(a,c,d,b,e){var f=R.q(a.g.i),h=R.invert(c.g.i,ba),g=new Float32Array(3);R.Ec(f,h,g);switch(c.n.type){case 10:c=c.Vd;a=a.g.R;q.M(e,q.xJ,d,g,c.$S,c.iy,(a.max_y-a.min_y)/2,b);break;case 20:q.M(e,q.wJ,d,g,a.c2)}}function L(a){return a.r&&a.r.tq}function M(a,c,d,b,e,f,h,g,m,p){var l;U.zb++;l=U.zb.toString(16);var v=c.r.J;q.M(F(v),q.EJ,l,a,g,v,d,b,e.r.J,f,h,m,p);c.r.tq=l}function F(a){for(var c=0;c<la.length;c++)for(var d=la[c].Jb.D,
b=0;b<d.length;b++)if(d[b].r.J==a)return ka[c];return null}function J(a){var c=a.r;if(c=c?0===c.jg?!0:!0===c.ur?!0:!1===c.vi?!0:"RIGID_BODY"!==c.type&&"DYNAMIC"!==c.type?!0:!1:!1)var c=R.q(a.g.i),d=R.B(a.g.i),c=c[0]!=a.r.jq[0]||c[1]!=a.r.jq[1]||c[2]!=a.r.jq[2]||d[0]!=a.r.Wm[0]||d[1]!=a.r.Wm[1]||d[2]!=a.r.Wm[2]||d[3]!=a.r.Wm[3];if(c){var c=a.r,b=a.g,d=R.q(b.i),b=R.B(b.i);ja.copy(d,c.jq);m.copy(b,c.Wm);var e=q.AD(q.Ip);e.J=c.J;e.trans=d;"DYNAMIC"==c.type?m.identity(e.quat):e.quat=b;q.M(F(c.J),q.Ip)}a=
a.zd;for(c=0;c<a.length;c++)J(a[c])}function C(a,c,d,b,e){e=e||new Float32Array(3);a=R.B(a.g.i);e[0]=c;e[1]=d;e[2]=b;ja.transformQuat(e,a,e)}function H(a,c,d){var b=a.ii,e=a.vo,f=a.cv,h=[],g=a.pb;h||X.l("At least one destination required");for(var m=0;m<c.Jb.D.length;m++){var p=c.Jb.D[m];if("ANY"==g||p.r.pb==g)p=p.r.J,h&&-1==h.indexOf(p)&&h.push(p)}for(c=0;c<h.length;c++)g=h[c],f<g&&!K(b,f,g)?(b.push([f,g]),e.push(!1)):f>g&&!K(b,g,f)&&(b.push([g,f]),e.push(!1));q.M(d,q.vJ,f);q.M(d,q.DJ,b,a.Xf)}function K(a,
c,d){for(var b=0;b<a.length;b++)if(a[b][0]==c&&a[b][1]==d)return!0;return!1}function d(a){a.r&&a.r.dj&&(a=a.r,q.M(F(a.J),q.QJ,a.J),a.dj=null)}function h(a){var c=P(a),d=v(a).Jb;d.ki[a]&&(delete d.ki[a],d.Wx.splice(d.Wx.indexOf,1),q.M(c,q.ZJ,a))}function v(a){for(var c=0;c<la.length;c++){var d=la[c];if(d.Jb.ki[a])return d}return null}function P(a){for(var c=0;c<la.length;c++)if(la[c].Jb.ki[a])return ka[c];return null}function c(a,c,d){if(c.gm){a=a.r.J;var b=c.Uk*c.Nn,e=c.Um*c.Vm,f=-c.em*c.fm*2*Math.PI/
c.Xo;c.eo&&(f*=-1);switch(c.type){case 10:q.M(d,q.lK,a,b,e,f);break;case 20:q.M(d,q.kK,a,b,e,f)}}}function p(a){return a.Ed&&"CHASSIS"==a.Vd.Id}function N(a){return a.Ed&&"HULL"==a.Vd.Id}function G(a){return a.Ej&&"MAIN_BODY"==a.Wk.Id}var u=n("__config"),z=n("__debug"),q=n("__ipc"),D=n("__obj_util"),I=n("__print"),m=n("__quat"),V=n("__scenes"),Q=n("__transform"),R=n("__tsr"),X=n("__util"),ja=n("__vec3"),W=n("__version"),Z=u.r,Y=u.v,ia=u.Ne,ha=0,ka=[],la=[],da={},E=[],oa=["ANY"],U={body:0,zb:0,eG:0},
ea=new Float32Array(3);new Float32Array(4);var Ca=new Float32Array(4);new Float32Array(16);var ba=R.create(),aa=R.create();a.zP=function(a){a.Jb={CI:!1,D:[],ki:{},Wx:[]};var c=Z.ap;ia.prevent_caching&&(c+=W.timestamp());I.log("%cLOAD PHYSICS","color: #0a0",Z.fp?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+Z.Df);I.log("%cPHYSICS PATH","color: #0a0",c);var d=q.lN(c,!Z.fp);q.qL(d,e);ka.push(d);la.push(a);Z.ping&&setInterval(function(){q.M(d,q.WJ,performance.now())},1E3)};a.oM=function(a){return a.Jb?
a.Jb.CI:!0};a.ha=function(){for(var a=0;a<ka.length;a++)q.terminate(ka[a]);ka.length=0;la.length=0;da={};E.length=0;oa.length=0;for(var c in U)U[c]=0};a.Ak=function(a,d){a.g||X.l("No object render: "+a.name);var e;a:{for(var h=0;h<la.length;h++)if(la[h]==d){e=ka[h];break a}e=void 0}var g=[];a.Hf.cp&&k(a,g);var v=d.Jb.D;if(p(a)||N(a)||a.Ze||G(a)||a.hk){var u,n=a,z=e,w=n.g,B=n.Hf,P=B.ds,Y=t();if("CAMERA"==n.type)var Q=B.pz?B.qq:"BOX",y=l(Q,w),H=w.Pn,K=w.En,H=.5,K=0;else if("EMPTY"==n.type)Q="EMPTY",
y=null,K=H=0;else{var Q=B.pz?B.qq:"BOX",y=l(Q,w),V=R.Oc(w.i);if(1!=V){var C=y;switch(Q){case "BOX":C.min_x*=V;C.max_x*=V;C.min_y*=V;C.max_y*=V;C.min_z*=V;C.max_z*=V;break;case "CYLINDER":case "CONE":case "CAPSULE":C.height*=V;C.mb*=V;break;case "SPHERE":C.mb*=V}}H=w.Pn;K=w.En}var F=R.q(w.i),J=R.B(w.i),ha=B.ep,ia=B.hI,xa=B.jg,U=B.lI,W=B.kI,Z=B.Qv,ja=B.ky,ea=n.pb,oa=f(ea),Oa=B.hn,Ha=B.fn,Ma=B.jn,fb=w.Pe.mb,ta=A(y),Db=n.vq,nb;var fc=Q;if(g.length){var lb=[],ib={};ib.quat=new Float32Array([0,0,0,1]);
ib.trans=new Float32Array(3);ib.worker_bounding=ta;ib.bounding_type=fc;lb.push(ib);var Sb=R.invert(w.i,ba);m.invert(R.B(w.i),Ca);for(var Yb=0;Yb<g.length;Yb++){var uc={},Rb=g[Yb],Ra=Rb.Hf.qq,wb=new Float32Array(4),Xb=new Float32Array(3),Gc=R.B(Rb.g.i);R.Ec(R.q(Rb.g.i),Sb,Xb);m.multiply(Ca,Gc,wb);uc.trans=Xb;uc.quat=wb;uc.bounding_type=Ra;uc.worker_bounding=A(l(Ra,Rb.g));lb.push(uc)}nb=lb}else nb=[];q.M(z,q.AJ,Y,F,J,P,ha,ia,xa,U,W,Z,ja,oa,Oa,Ha,Ma,Q,ta,fb,H,K,nb,Db);da[Y]=n;E.push(n);var Tb=r(Y,"BOUNDING");
Tb.type=P;Tb.jg=xa;Tb.ur=ha;Tb.pb=ea;Tb.gn=oa;u=Tb;a.r=u;var Cc={G:null,r:u};v.push(Cc);b(d,e,u.pb)}else for(var Vc=D.aa(a,d).X,nc=0;nc<Vc.length;nc++){var Eb=Vc[nc],Mc;if(Mc="PHYSICS"==Eb.type){var tb;a:{for(var sd=d.Jb.D,oc=0;oc<sd.length;oc++){var Mb=sd[oc].G;if(Mb&&Mb.id==Eb.id){tb=!0;break a}}tb=!1}Mc=!tb}if(Mc)if(Eb.Ae.wa)if(Eb.mk&&d.j.mc){var ob=Eb,Sa=d,Na=e,Dc=Sa.j.mc;q.M(Na,q.JJ,Dc.Ii);if(ob.xU){var Ua={};Ua.dst_noise_scale0=ob.dst_noise_scale0;Ua.dst_noise_scale1=ob.dst_noise_scale1;Ua.dst_noise_freq0=
ob.dst_noise_freq0;Ua.dst_noise_freq1=ob.dst_noise_freq1;Ua.dir_min_shore_fac=ob.dir_min_shore_fac;Ua.dir_freq=ob.dir_freq;Ua.dir_noise_scale=ob.dir_noise_scale;Ua.dir_noise_freq=ob.dir_noise_freq;Ua.dir_min_noise_fac=ob.dir_min_noise_fac;Ua.dst_min_fac=ob.dst_min_fac;Ua.waves_hor_fac=ob.waves_hor_fac;var Hd=Dc.waves_height,vc=Dc.waves_length;Dc.ui?q.M(Na,q.pA,Ua,Dc.Wl[0],Dc.Wl[1],Dc.Vl[0],Dc.Vl[1],Dc.px,Hd,vc,Dc.Jy,Sa.j.Iy):q.M(Na,q.pA,Ua,0,0,0,0,0,Hd,vc,0,null)}}else{var Xa;if(Eb.ep){var Fb=a,pc=
Eb,gc=e,ed=t(),Nc=pc.Ae,jd=Nc.N[0].a_position,xb=Nc.ab||null,yc=pc.pb,zc=f(yc);q.M(gc,q.GJ,ed,jd,xb,R.q(Fb.g.i),zc,pc.hn,pc.fn,pc.jn);var Wc=r(ed,"STATIC_MESH");Wc.ur=!0;Wc.pb=yc;Wc.gn=zc;Xa=Wc}else{var hc=a,Hc=Eb,td=e,kd=t(),ld=Hc.Ae,fd=ld.N[0].a_position,ud=ld.ab||null,vd=R.q(hc.g.i),eb=Hc.Pn,md=Hc.En,yb=Hc.pb,Gb=f(yb);q.M(td,q.IJ,kd,fd,ud,vd,eb,md,Gb,Hc.hn,Hc.fn,Hc.jn);var qc=r(kd,"STATIC_MESH");qc.pb=yb;qc.gn=Gb;Xa=qc}u=Xa;a.r=u;Cc={G:Eb,r:u};v.push(Cc);b(d,e,u.pb)}else I.error("Object "+a.name+
" has collision material with no assigned vertices")}if(p(a)||N(a)){var Va=a,Ab=e,Hb=Va.r.J;p(Va)?(Va.n.type=10,q.M(Ab,q.BJ,Hb,Va.n.Yy,Va.n.$y,Va.n.Zy,Va.n.Dz,Va.n.qx)):N(Va)&&(Va.n.type=20,q.M(Ab,q.zJ,Hb,Va.n.oj,Va.n.nk,Va.n.ok));if(Va.n.Xj){var Bb=Va.n.Xj;switch(Va.n.type){case 10:x(Bb[1],Va,Hb,!0,Ab);x(Bb[0],Va,Hb,!0,Ab);x(Bb[3],Va,Hb,!1,Ab);x(Bb[2],Va,Hb,!1,Ab);break;case 20:for(var Ib=0;Ib<Bb.length;Ib++)x(Bb[Ib],Va,Hb,!1,Ab)}}c(a,a.n,e)}else if(a.Ze){var Jb=e,rc=a.g,Zb=a.r,sc=rc.R.max_y-rc.R.min_y,
pb=Zb.J,rb=a.CB,Pa=rb.wU,bb=rb.CR,lc=rb.SS,gb=rb.PP,wc=rb.yU,Cb=X.DN(a);q.M(Jb,q.CJ,pb,Cb,sc,Pa,bb,lc,gb,wc);Zb.Ze=!0}else if(G(a)){var hb=a,Ub=e,ic=hb.r.J;q.M(Ub,q.FJ,ic,hb.Se.oj,hb.Se.nk,hb.Se.ok);if(hb.Se.hq)for(var Ec=hb.Se.hq,jb=0;jb<Ec.length;jb++){var Wa=Ec[jb],$b=R.q(Wa.g.i),va=R.invert(hb.g.i,ba),Nb=new Float32Array(3);R.Ec($b,va,Nb);q.M(Ub,q.yJ,ic,Nb,Wa.DL)}hb.r.FP=!0}for(nc=0;nc<E.length;nc++)if(a=E[nc],a.r){var Ya=a;if(!L(Ya))for(var Ob=0;Ob<Ya.Nx.length;Ob++){var Qa=Ya.Nx[Ob],kb=Qa.target,
jc=Qa.TQ;if(kb.r){var ub=new Float32Array([Qa.UQ,Qa.VQ,Qa.WQ]),Ta,Za=new Float32Array([Qa.$d,Qa.ae,Qa.be]);Ta=X.Sh(Za,new Float32Array(4));var cb=R.identity(ba),cb=R.ff(ub,cb),cb=R.ri(Ta,cb),sb=R.multiply(Ya.g.i,cb,ba),ac=R.invert(kb.g.i,aa),Pb=R.multiply(ac,sb,ac),$a=Qa,db={};db.use_limit_x=$a.bU;db.use_limit_y=$a.cU;db.use_limit_z=$a.dU;db.use_angular_limit_x=$a.XT;db.use_angular_limit_y=$a.YT;db.use_angular_limit_z=$a.ZT;db.limit_max_x=$a.ZP;db.limit_min_x=$a.bQ;db.limit_max_y=$a.$P;db.limit_min_y=
$a.cQ;db.limit_max_z=$a.aQ;db.limit_min_z=$a.dQ;db.limit_angle_max_x=$a.TP;db.limit_angle_min_x=$a.WP;db.limit_angle_max_y=$a.UP;db.limit_angle_min_y=$a.XP;db.limit_angle_max_z=$a.VP;db.limit_angle_min_z=$a.YP;M(jc,Ya,ub,Ta,kb,R.q(Pb),R.B(Pb),db,null,null)}}}};a.eO=g;a.update=function(a,c){for(var d=0;d<ka.length;d++){var b=ka[d],e=a;b&&q.BE(b)&&q.M(b,q.mK,e,c);for(var f=0;f<E.length;f++){var h=E[f],g=h.r;if(g.vi&&g.Cq){var p=q.BE(b)?e-g.Cq:performance.now()/1E3-g.Cq,p=Math.min(p,10/Z.Df),p=p-1/Z.Df;
Y.FQ&&(p=0);var l=ba;R.AP(g.Ov,p,g.ig,g.Vf,ba);Q.rh(h,l);Q.o(h);J(h);if(h.n)for(var g=h,p=g.n.Xj,l=g.g.i,v=ba,k=0;k<p.length;k++){var r=p[k];R.multiply(l,g.n.Bo[k],v);Q.rh(r,v);Q.o(r)}h.n&&h.n.gm&&(v=h,p=v.n,g=p.gm)&&(k=v.n.mH,R.multiply(v.g.i,v.n.nH,g.g.i),l=ea,R.Tc(k,v.g.i,l),v=Ca,m.setAxisAngle(l,-p.em*p.fm*2*Math.PI,v),p=R.B(g.g.i),m.multiply(v,p,p),Q.o(g));h.n&&h.n.Ry&&(v=h,p=v.n,g=p.Ry)&&(k=v.n.iH,R.multiply(v.g.i,v.n.jH,g.g.i),l=ea,R.Tc(k,v.g.i,l),v=Ca,k=Math.abs(p.speed)*p.Vo,k>p.vl&&(k=p.vl),
m.setAxisAngle(l,-k,v),p=R.B(g.g.i),m.multiply(v,p,p),m.normalize(p,p),Q.o(g));h.n&&h.n.bz&&(l=h,g=l.n,h=g.bz)&&(v=l.n.wH,R.multiply(l.g.i,l.n.xH,h.g.i),p=ea,R.Tc(v,l.g.i,p),l=Ca,m.setAxisAngle(p,-Math.abs(g.Uk)*g.vn,l),g=R.B(h.g.i),m.multiply(l,g,g),m.normalize(g,g),Q.o(h))}}q.aR(b);b=la[d];(e=b.j.mc)&&0<e.waves_height&&(b=V.qa(b,"MAIN_OPAQUE"),e=ja.length(b.Bh),q.M(ka[d],q.jK,b.time*e))}};a.EO=function(){return la[0]};a.pause=function(){for(var a=0;a<ka.length;a++)q.M(ka[a],q.VJ)};a.nh=function(){for(var a=
0;a<ka.length;a++)q.M(ka[a],q.$J)};a.CC=function(a){(a=a.r)||X.l("No object physics");if(!a.vi){var c=a.J,d=F(c);a.vi=!0;q.M(d,q.TJ,c)}};a.aw=function(a){(a=a.r)||X.l("No object physics");if(a.vi){var c=a.J,d=F(c);a.vi=!1;q.M(d,q.SJ,c)}};a.rs=function(a){return Boolean(a.Jb)};a.ea=function(a){return Boolean(a.r)};a.lE=function(a){return(a=a.r)&&a.vi&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.jg&&0==a.ur?!0:!1};a.Ow=function(a){return(a=a.r)&&a.vi?!0:!1};a.HG=function(a,c){var d=a.r.J;q.M(F(d),
q.iK,d,c)};a.mP=L;a.ZA=M;a.NB=function(a){a=a.r;q.M(F(body_a),q.YJ,a.tq);a.tq=null};a.XF=function(c,d,b,e,f,h){d=R.qh(d,1,b,ba);f=R.qh(f,1,h,aa);R.invert(d,d);R.multiply(f,d,d);Q.Yn(e,f);R.multiply(f,d,d);Q.rh(c,d);Q.o(c);a.Es(c,R.q(c.g.i),R.B(c.g.i))};a.Es=function(a,c,d){var b=a.r;R.qh(R.q(a.g.i),1,R.B(a.g.i),b.Ov);a=q.AD(q.Ip);a.J=b.J;a.trans=c;a.quat=d;q.M(F(b.J),q.Ip)};a.u=J;a.cB=function(a,c,d,b){C(a,c,d,b,ea);a=a.r.J;c=Math.abs(0);d=Math.abs(0);b=Math.abs(0);var e=Math.abs(ea[0]),f=Math.abs(ea[1]),
h=Math.abs(ea[2]);ea[0]=e?ea[0]/e*Math.max(e,c):0;ea[1]=f?ea[1]/f*Math.max(f,d):0;ea[2]=h?ea[2]/h*Math.max(h,b):0;q.M(F(a),q.rA,a,ea[0],ea[1],ea[2])};a.dB=function(a,c,d,b){a=a.r.J;q.M(F(a),q.rA,a,c,d,b)};a.Ru=function(a,c,d,b,e){e?(ea[0]=c,ea[1]=d,ea[2]=b):C(a,c,d,b,ea);a=a.r.J;q.M(F(a),q.KJ,a,ea[0],ea[1],ea[2])};a.bB=function(a,c,d,b){C(a,c,d,b,ea);a=a.r.J;q.M(F(a),q.MJ,a,ea[0],ea[1],ea[2])};a.ry=function(a,c,d){a=a.r.J;q.M(F(a),q.cK,a,c,d)};a.xs=function(a,c){var d=a.r.J;q.M(F(d),q.dK,d,c)};a.CG=
function(a,c){var d=a.r.J;q.M(F(d),q.hK,d,c)};a.BG=function(a,c){var d=a.r.J;q.M(F(d),q.fK,d,c)};a.yG=function(a,c){var d=a.r.J;q.M(F(d),q.aK,d,c)};a.AB=function(a){a=a.r.J;q.M(F(a),q.OJ,a)};a.BB=function(a,c,d){a=a.r.J;q.M(F(a),q.PJ,a,c,d)};a.ys=function(a,c,d){a=a.r.J;q.M(F(a),q.eK,a,c,d)};a.zG=function(a,c){var d=a.r.J;q.M(F(d),q.bK,d,c)};a.AG=function(a,c){var d=a.r.J;q.M(F(d),q.gK,d,c)};a.Ou=function(a,c,d,b){var e=a.r,f=e.J;c=c||"ANY";for(var h=0;h<e.yd.length;h++)if(a=e.yd[h],a.pb==c&&a.callback==
d)return;a={cv:f,Xf:b||!1,pb:c,callback:d,ii:[],vo:[]};e.yd.push(a);c=F(f);H(a,y(c),c)};a.ay=function(a,c,d){a=a.r;for(var b=F(a.J),e=y(b),f=0;f<a.yd.length;f++){var h=a.yd[f];if(h.pb==c&&h.callback==d){if(w(h)){var g=ja.set(0,0,0,ea);h.callback(!1,null,g,g,0)}a.yd.splice(f,1);f--;for(var g=b,h=h.ii,m=e.Jb.D,p=0;p<m.length;p++)for(var l=m[p].r,v=0;v<l.yd.length;v++)for(var k=l.yd[v],r=0;r<k.ii.length;r++)for(var u=k.ii[r],n=0;n<h.length;n++){var t=h[n];u[0]==t[0]&&u[1]==t[1]&&(h.splice(n,1),n--)}h.length&&
q.M(g,q.qA,h)}}};a.Qu=function(a,c){a.r&&a.r.dj&&d(a);var b=a.r;q.M(F(b.J),q.LJ,b.J);b.dj=c};a.sv=d;a.Yp=function(a,c,d,b,e,h,g,m,p){var l;U.eG++;l=U.eG;b=b||"ANY";a={id:l,J:a?a.r.J:0,from:new Float32Array(c),to:new Float32Array(d),pb:b,gn:f(b),jB:h,HL:g,Xf:m,mr:p,callback:e};c=F(a.J)||ka[0];d=y(c).Jb;l=a.id;d.ki[l]=a;d.Wx.push(a);q.M(c,q.HJ,a.id,a.J,a.from,a.to,a.gn,a.jB,a.HL,a.Xf,a.mr);return l};a.by=h;a.yB=function(a,c,d){var b=P(a),e=v(a).Jb.ki[a];e&&!e.jB&&(e.from.set(c),e.to.set(d),q.M(b,q.NJ,
a,c,d))};a.CE=function(a){return v(a).Jb.ki[a]?!0:!1};a.um=function(a,d){var b=a.n;b.Uk=d;c(a,b,F(a.r.J))};a.tm=function(a,d){var b=a.n;b.em=d;c(a,b,F(a.r.J))};a.tz=function(a,d){var b=a.n;b.Um=d;c(a,b,F(a.r.J))};a.Fd=p;a.Gd=N;a.DP=function(a){if(!a.Ed)return!1;a=a.Vd.Id;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.CP=function(a){return a.Ed?"BOB"==a.Vd.Id?!0:!1:!1};a.GP=function(a){return a.Ej?"BOB"==a.Wk.Id?!0:!1:!1};a.EE=function(a){return a.Ed&&
"STEERING_WHEEL"==a.Vd.Id?!0:!1};a.DE=function(a){return a.Ed&&"SPEEDOMETER"==a.Vd.Id?!0:!1};a.FE=function(a){return a.Ed&&"TACHOMETER"==a.Vd.Id?!0:!1};a.TD=function(a){return a.n.speed};a.AU=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.Ze=function(a){return a.Ze};a.D_=G;a.SO=function(){return ha};a.uN=function(){for(var a=0;a<ka.length;a++)q.M(ka[a],q.RJ)};a.Jo=function(a){if("BOUNDING"==
a.r.type){var c=E.indexOf(a);-1==c&&I.error("Object "+a.name+" doesn't have bounding physics");delete da[b];E.splice(c,1)}for(var b=a.r.J,c=F(b),e=y(c),f=b,h=e.Jb.D,g=[],m=0;m<h.length;m++)for(var p=h[m].r,l=0;l<p.yd.length;l++)for(var v=p.yd[l],k=0;k<v.ii.length;k++){var r=v.ii[k],u=v.vo[k];if(r[0]==f||r[1]==f)v.ii.splice(k,1),v.vo.splice(k,1),k--,u&&!w(v)&&(u=ja.set(0,0,0,ea),v.callback(!1,null,u,u,0)),g.push(r)}g.length&&q.M(c,q.qA,g);a.r&&a.r.dj&&d(a);a=e.Jb.D;for(e=0;e<a.length;e++)a[e].r.J==
b&&(a.splice(e,1),e--);q.M(c,q.XJ,b)}};b4w.module.__ipc=function(a,n){function k(a,b,e){for(var f=0;f<A.length;f+=2)A[f+1]==a&&(l[f+Number(!b)]=e)}function b(a){for(var b=0;b<a.length;b++){var e=a[b],f=0,c;for(c in e){var g=e[c];switch(g.constructor){case Float32Array:f+=g.length;break;case Number:f+=1}}--f;e.len=f}}var e=!0;a.YI=0;var y=a.QI=1,g=a.SI=2;a.RI=3;a.UI=4;a.VI=5;a.WI=6;a.ZI=7;var B=a.aJ=8,w=a.Vz=9,t=a.bJ=10;a.cJ=11;var f=a.dJ=12;a.eJ=13;a.$I=14;a.XI=15;a.TI=16;a.UJ=100;a.vJ=101;a.wJ=102;a.xJ=103;a.yJ=104;a.AJ=105;a.zJ=106;
a.BJ=107;a.CJ=108;a.DJ=109;a.EJ=110;a.FJ=111;a.GJ=112;a.IJ=113;a.JJ=114;a.XJ=115;a.KJ=116;a.LJ=117;a.MJ=118;a.OJ=119;a.PJ=120;a.QJ=121;a.SJ=122;a.TJ=123;a.VJ=124;a.HJ=125;a.ZJ=126;a.NJ=127;a.qA=128;a.YJ=129;a.$J=130;a.aK=131;a.bK=132;a.cK=133;a.dK=134;a.eK=135;a.fK=136;a.gK=137;a.hK=138;a.iK=139;a.rA=140;var r=a.Ip=141;a.jK=142;a.pA=143;a.kK=144;a.lK=145;a.WJ=146;a.RJ=147;a.mK=148;var l=b4w.worker_listeners,A=b4w.worker_namespaces,x={pe:f,J:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
ig:new Float32Array(3),Vf:new Float32Array(3),len:0},L={pe:B,ov:0,Sx:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},M={pe:w,id:0,Ek:0,hit_fract:0,hit_time:0,len:0},F={pe:t,id:0,Ek:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},J={pe:y,Zi:0,$i:0,result:0,len:0},C={pe:g,Zi:0,$i:0,result:0,ej:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},H={pe:r,J:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},K=[x,L,M,F,J,C,H];
a.lN=function(a,b){var f={xr:a?!0:!1,Ji:null,Wf:[],Re:""};if(b)if(f.Ji={addEventListener:function(a,c){"message"!=a&&panic("Wrong web worker event");k(f.Re,f.xr,c)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");k(f.Re,f.xr,null)},postMessage:function(a){var c;a:{for(c=0;c<A.length;c+=2)if(A[c+1]==f.Re){c=l[c+Number(!!f.xr)];break a}c=null}c({data:a})},terminate:function(){for(var a=0;a<A.length;a+=2)if(A[a+1]==f.Re){l.splice(a,2);A.splice(a,2);break}}},f.xr){var g=
n("__util"),c=n("__container"),p=b4w.get_namespace(n),g=g.Zo(p+"_worker");A.push(p);A.push(g);l.push(null);l.push(null);f.Re=g;(c=c.gO(a))?e?c.addEventListener("load",function(){b4w.require("__bindings",f.Re)},!1):(b4w.ha("__bindings",f.Re),b4w.ha("__ipc",f.Re),b4w.require("__bindings",f.Re)):(c=document.createElement("script"),c.src=a,c.defer="defer",c.async="async",c.addEventListener("load",function(){e=!1;b4w.require("__bindings",f.Re)},!1),document.head.appendChild(c))}else f.Re=b4w.get_namespace(n);
else f.Ji=a?new Worker(a):self;return f};a.qL=function(a,e){function l(b){if(b.constructor==ArrayBuffer)b=new Float32Array(b);else if(b[0].constructor==ArrayBuffer){for(var c=0;c<b.length;c++)l(b[c]);return}c=b[0]|0;switch(c){case f:var p=x;p.J=b[1]|0;p.time=b[2];p.trans[0]=b[3];p.trans[1]=b[4];p.trans[2]=b[5];p.quat[0]=b[6];p.quat[1]=b[7];p.quat[2]=b[8];p.quat[3]=b[9];p.ig[0]=b[10];p.ig[1]=b[11];p.ig[2]=b[12];p.Vf[0]=b[13];p.Vf[1]=b[14];p.Vf[2]=b[15];break;case B:p=L;p.ov=b[1]|0;p.Sx=b[2]|0;p.trans[0]=
b[3];p.trans[1]=b[4];p.trans[2]=b[5];p.quat[0]=b[6];p.quat[1]=b[7];p.quat[2]=b[8];p.quat[3]=b[9];break;case w:p=M;p.id=b[1]|0;p.Ek=b[2]|0;p.hit_fract=b[3];p.hit_time=b[4];break;case t:p=F;p.id=b[1]|0;p.Ek=b[2]|0;p.hit_fract=b[3];p.hit_time=b[4];p.hit_pos[0]=b[5];p.hit_pos[1]=b[6];p.hit_pos[2]=b[7];p.hit_norm[0]=b[8];p.hit_norm[1]=b[9];p.hit_norm[2]=b[10];break;case y:p=J;p.Zi=b[1]|0;p.$i=b[2]|0;p.result=!!b[3];break;case g:p=C;p.Zi=b[1]|0;p.$i=b[2]|0;p.result=!!b[3];p.ej[0]=b[4];p.ej[1]=b[5];p.ej[2]=
b[6];p.coll_norm[0]=b[7];p.coll_norm[1]=b[8];p.coll_norm[2]=b[9];p.coll_dist=b[10];break;case r:p=H;p.J=b[1]|0;p.trans[0]=b[2];p.trans[1]=b[3];p.trans[2]=b[4];p.quat[0]=b[5];p.quat[1]=b[6];p.quat[2]=b[7];p.quat[3]=b[8];break;default:p=b}e(a,c,p)}b(K);a.Ji.addEventListener("message",function(a){l(a.data)},!1)};a.ha=function(){};a.M=function(a,b){if(a)switch(b){case f:var e=x,l=new Float32Array(e.len);l[0]=e.pe;l[1]=e.J;l[2]=e.time;l[3]=e.trans[0];l[4]=e.trans[1];l[5]=e.trans[2];l[6]=e.quat[0];l[7]=
e.quat[1];l[8]=e.quat[2];l[9]=e.quat[3];l[10]=e.ig[0];l[11]=e.ig[1];l[12]=e.ig[2];l[13]=e.Vf[0];l[14]=e.Vf[1];l[15]=e.Vf[2];a.Wf.push(l.buffer);break;case B:e=L;l=new Float32Array(e.len);l[0]=e.pe;l[1]=e.ov;l[2]=e.Sx;l[3]=e.trans[0];l[4]=e.trans[1];l[5]=e.trans[2];l[6]=e.quat[0];l[7]=e.quat[1];l[8]=e.quat[2];l[9]=e.quat[3];a.Wf.push(l.buffer);break;case w:e=M;l=new Float32Array(e.len);l[0]=e.pe;l[1]=e.id;l[2]=e.Ek;l[3]=e.hit_fract;l[4]=e.hit_time;a.Wf.push(l.buffer);break;case t:e=F;l=new Float32Array(e.len);
l[0]=e.pe;l[1]=e.id;l[2]=e.Ek;l[3]=e.hit_fract;l[4]=e.hit_time;l[5]=e.hit_pos[0];l[6]=e.hit_pos[1];l[7]=e.hit_pos[2];l[8]=e.hit_norm[0];l[9]=e.hit_norm[1];l[10]=e.hit_norm[2];a.Wf.push(l.buffer);break;case y:e=J;l=new Float32Array(e.len);l[0]=e.pe;l[1]=e.Zi;l[2]=e.$i;l[3]=e.result;a.Wf.push(l.buffer);break;case g:e=C;l=new Float32Array(e.len);l[0]=e.pe;l[1]=e.Zi;l[2]=e.$i;l[3]=e.result;l[4]=e.ej[0];l[5]=e.ej[1];l[6]=e.ej[2];l[7]=e.coll_norm[0];l[8]=e.coll_norm[1];l[9]=e.coll_norm[2];l[10]=e.coll_dist;
a.Wf.push(l.buffer);break;case r:e=H;l=new Float32Array(e.len);l[0]=e.pe;l[1]=e.J;l[2]=e.trans[0];l[3]=e.trans[1];l[4]=e.trans[2];l[5]=e.quat[0];l[6]=e.quat[1];l[7]=e.quat[2];l[8]=e.quat[3];a.Wf.push(l.buffer);break;default:l=[];for(e=1;e<arguments.length;e++)l.push(arguments[e]);a.Ji.postMessage(l)}};a.aR=function(a){a&&a.Wf.length&&(a.Ji.postMessage(a.Wf),a.Wf.length=0)};a.AD=function(a){switch(a){case f:return x;case B:return L;case w:return M;case t:return F;case y:return J;case g:return C;case r:return H;
default:return null}};a.terminate=function(a){a.Ji.terminate();a.Ji=null};a.sr=function(a){return!!a.Ji};a.BE=function(a){return!!a.Re}};b4w.module.__transform=function(a,n){function k(a,d){f.Ye(a)?L.ff(d,f.We(a)):L.ff(d,a.g.i)}function b(a,d){var b=a.g;if(f.Ye(a)){L.ri(d,b.i);var e=f.Xq(a),e=L.invert(e,h);L.multiply(e,b.i,f.We(a))}else L.ri(d,b.i)}function e(a,d){f.Ye(a)?L.ri(d,f.We(a)):L.ri(d,a.g.i)}function y(a,d){f.Ye(a)?L.copy(d,f.We(a)):L.copy(d,a.g.i)}function g(a,d){f.Ye(a)?L.copy(f.We(a),d):L.copy(a.g.i,d);return d}function B(a){var b=a.g,e=a.A,g=a.type;"CAMERA"==g&&t.oz(a);f.ET(a,P);"CAMERA"==g&&t.CT(a);var k=L.Vh(b.i,K),
v=L.Fw(b.i,d);b.R&&b.I&&(w.Gg(b.R,b.i,b.I),w.ev(b.Pe,b.i,b.Yc),w.Gk(b.Ga,b.i,b.na));for(var q=0;q<a.A.length;q++)for(var n=a.A[q].X,I=0;I<n.length;I++){var m=n[I];w.Gg(m.R,b.i,m.I);w.Gk(m.Ga,b.i,m.na)}switch(g){case "SPEAKER":x.LS(a,P);break;case "CAMERA":for(q=0;q<e.length;q++)t.DT(a,e[q]);break;case "MESH":L.hT(a.g.i,a.g.Fz);a.pF&&L.invert(a.g.Fz,a.g.EI);if(n=a.$p)L.invert(n.g.i,h),L.multiply(h,b.i,h),H.set(h[0],h[1],h[2],h[3],b.Tu),l.set(h[4],h[5],h[6],h[7],b.Su);b.nw=!0;break;case "LAMP":r.HT(a)}for(q=
0;q<e.length;q++)if(I=e[q],I.sr){n=I.Ta;m=n.j;switch(g){case "LAMP":A.ZH(a,n);break;case "CAMERA":A.FR(n);if(m.Rc){m.Rc.enable_csm&&A.my(n);var y=F.aa(a,n).U[0];A.RT(y,m.Pa)}A.p()==n&&x.fQ(n,k,v,P);break;case "MESH":b.R&&b.I&&(b.ye&&A.my(n),m=I.Mg,null!=b.Qe&&m&&A.WH(m,k));break;case "EMPTY":M.FT(a)}m=I.ng;y=a.Ho;if(y.length)for(I=0;I<m.length;I++){var Q=m[I].k;A.$H(m[I],k,v);F.aI(y,Q.jc);t.rS(Q,A.bl(n));J.Nq(Q.Qf,Q.$k)}}b=a.zd;for(q=0;q<b.length;q++)B(b[q]);a=a.zv;for(q=0;q<a.length;q++)b=a[q],n=
b[0],f.wT(n,b[1])}var w=n("__boundings"),t=n("__camera"),f=n("__constraints"),r=n("__lights"),l=n("__quat"),A=n("__scenes"),x=n("__sfx"),L=n("__tsr"),M=n("__objects"),F=n("__obj_util"),J=n("__util"),C=n("__vec3"),H=n("__vec4"),K=new Float32Array(3),d=new Float32Array(4);new Float32Array(9);var h=L.create(),v=L.create(),P=0;a.zA=0;a.tk=1;a.update=function(a){P=a};a.kc=function(a,d){var b=a.g;if(f.Ye(a)){L.ff(d,b.i);var e=f.Xq(a),e=L.invert(e,h);L.multiply(e,b.i,f.We(a))}else L.ff(d,b.i)};a.Fs=k;a.xf=
function(a,d){C.copy(L.q(a.g.i),d);return d};a.SD=function(a,d){f.Ye(a)?C.copy(L.q(f.We(a)),d):C.copy(L.q(a.g.i),d);return d};a.rg=b;a.Ds=e;a.fl=function(a,d){l.copy(L.B(a.g.i),d);return d};a.HD=function(a,d){f.Ye(a)?l.copy(L.B(f.We(a)),d):l.copy(L.B(a.g.i),d);return d};a.Cy=function(a,e){var f=J.Sh(e,d);b(a,f)};a.Dy=function(a,b){var f=J.Sh(b,d);e(a,f)};a.ve=function(a,d){var b=a.g;if(f.Ye(a)){var b=f.We(a),e=L.Oc(f.Xq(a));L.ve(d/e,b)}else L.ve(d,b.i)};a.Ey=function(a,d){var b=a.g;f.Ye(a)?L.ve(d,
f.We(a)):L.ve(d,b.i)};a.Oc=function(a){return L.Oc(a.g.i)};a.JD=function(a){return f.Ye(a)?L.Oc(f.We(a)):L.Oc(a.g.i)};a.rh=function(a,d){L.copy(d,a.g.i);if(f.Ye(a)){var b=f.Xq(a),b=L.invert(b,h);L.multiply(b,a.g.i,f.We(a))}};a.Gs=y;a.Yn=function(a,d){return L.copy(a.g.i,d)};a.Zn=g;a.$q=function(a){var d=a.g;a=d.Dk;var b=L.Oc(d.i),d=b*(a.max_x-a.min_x),e=b*(a.max_y-a.min_y);a=b*(a.max_z-a.min_z);return.5*Math.sqrt(d*d+e*e+a*a)};a.Zq=function(a,d,b){b||(b=new Float32Array(3));d?(a=a.g,C.copy(a.Yc.O,
b)):(a=a.g,d=a.Dk,b[0]=(d.max_x+d.min_x)/2,b[1]=(d.max_y+d.min_y)/2,b[2]=(d.max_z+d.min_z)/2,L.Ec(b,a.i,b));return b};a.Ef=function(a,d,b,e){var f=g(a,h),l=K;l[0]=d;l[1]=b;l[2]=e;L.Ec(l,f,l);k(a,l)};a.jy=function(a,d){var b=g(a,h),e=L.ri(d,L.identity(v));L.multiply(b,e,e);y(a,e)};a.o=B;a.distance=function(a,d){return C.dist(L.q(a.g.i),L.q(d.g.i))};a.Fl=function(a,d){return C.dist(L.q(a.g.i),d)};a.CD=function(a){return{max_x:a.g.I.max_x,min_x:a.g.I.min_x,max_y:a.g.I.max_y,min_y:a.g.I.min_y,max_z:a.g.I.max_z,
min_z:a.g.I.min_z}}};b4w.module.__sfx=function(a,n){function k(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var c=new a}catch(d){return F.error('Unable to initialize AudioContext: "'+d+'". The audio is disabled.'),null}if(c.createGain)return c;F.warn("deprecated WebAudio implementation");return null}F.warn("WebAudio is not supported");return null}function b(a,c,d){var b=a.P;if("NONE"!=b.behavior){var f=b.loop,h=b.pitch;if(b.src&&(f||0<=d)){b.Vu=Math.floor(5E4*Math.random());var l=G.currentTime+c,l=
Math.max(0,l);b.ze=l;b.state=20;e(a);"POSITIONAL"==b.behavior||"BACKGROUND_SOUND"==b.behavior?(c=G.createBufferSource(),c.buffer=b.src,c.playbackRate.value=h,H.Af(c.onended)&&(c.onended=function(){b.state=50}),f?(b.tc&&b.tc.disconnect(),c.loop=!0,c.start(l),b.duration=0):(f=c.buffer?c.buffer.duration:0,d>f?(f=l+d+b.ke,c.loop=!0,c.start(l),c.stop(f),b.duration=d):(c.loop=!1,c.start(l),b.duration=f)),c.connect(b.Jd),b.tc=c,g(b),B(b)):"BACKGROUND_MUSIC"==b.behavior&&(J.oq(b.Zu),J.oq(b.$u),d=function(){var c=
a.P,d=c.src;d&&(d.volume=1,d.loop=c.loop,c.tc=c.tc||G.createMediaElementSource(d),c.tc.connect(c.Jd),20==c.state&&(d.currentTime&&(d.currentTime=0),d.play()))},0==c?d():b.Zu=J.TG(d,1E3*c),b.duration=f?0:L(a));w(b,l)}}}function e(a){var c=a.P;if(!c.Jd){var d=C.q(a.g.i);a=C.B(a.g.i);if(h.Lr){var b=G.createBiquadFilter();b.type="peaking"}else b=null;var e=G.createGain();switch(c.behavior){case "POSITIONAL":var f=G.createPanner();"string"!=typeof f.panningModel?(f.panningModel=f.EQUALPOWER,f.distanceModel=
f.INVERSE_DISTANCE):(f.panningModel="equalpower",f.distanceModel="inverse");f.setPosition(d[0],d[1],d[2]);K.copy(d,c.ex);d=v;H.Cb(a,H.md,d);f.setOrientation(d[0],d[1],d[2]);K.copy(d,c.direction);f.refDistance=c.An;f.maxDistance=c.vf;f.rolloffFactor=c.Rm;f.coneInnerAngle=c.SB;f.coneOuterAngle=c.TB;f.coneOuterGain=c.UB;var g=G.createGain();g.gain.value=x(c);b?(f.connect(b),b.connect(g)):f.connect(g);g.connect(e);c.Jd=f;if(c.lk){var l=G.createGain();e.connect(l);l.connect(G?u.Va.Jd:null)}else l=null,
e.connect(G?u.Va.Jd:null);break;case "BACKGROUND_SOUND":f=null;g=G.createGain();g.gain.value=x(c);b?(c.Jd=b,b.connect(g)):c.Jd=g;g.connect(e);c.lk?(l=G.createGain(),e.connect(l),l.connect(G?u.Va.Jd:null)):(l=null,e.connect(G?u.Va.Jd:null));break;case "BACKGROUND_MUSIC":l=f=null,g=G.createGain(),g.gain.value=x(c),b?(c.Jd=b,b.connect(g)):c.Jd=g,g.connect(e),e.connect(G?u.Va.Jd:null)}c.wo=f;c.cg=b;c.al=g;c.mj=e;c.cG=l}}function y(a){var c=a.P,d=c.duration,c=c.wC+c.xC*Math.random();b(a,c,d)}function g(a){a.lk&&
a.cG.gain.cancelScheduledValues(a.ze);a.Ll&&a.tc.playbackRate.cancelScheduledValues(a.ze);a.jp=a.ze}function B(a){if(a.lk||a.Ll){var c=a.cG,d=a.tc,b=d.buffer?d.buffer.duration:0;if(b){var e=a.ze;q[0]=a.Vu;for(var f=0;5>f;){var h=a.pitch+a.Ll*H.ef(q);if(e>=a.jp){if(a.lk){var g=1-H.S(a.lk,0,1)*Math.random();c.gain.setValueAtTime(g,e)}a.Ll&&d.playbackRate.setValueAtTime(h,e);f++}e+=b/h}a.jp=e-.001}}}function w(a,c){if(a.nj||a.ke){var d=a.mj;d.gain.cancelScheduledValues(c);a.nj?(d.gain.setValueAtTime(0,
c),d.gain.linearRampToValueAtTime(1,c+a.nj)):d.gain.setValueAtTime(1,c);a.ke&&!a.loop&&(d.gain.setValueAtTime(1,c+a.duration),d.gain.linearRampToValueAtTime(0,c+a.duration+a.ke))}}function t(a){"SPEAKER"!=a.type&&H.l("Wrong object type");var c=a.P;if(50==c.state)c.state=30;else if(20==c.state||40==c.state){var d=c.mj,b=G.currentTime;c.ke&&(d.gain.setValueAtTime(d.gain.value,b),d.gain.linearRampToValueAtTime(0,b+c.ke));"BACKGROUND_MUSIC"==c.behavior?c.src&&(J.oq(c.Zu),J.oq(c.$u),c.$u=J.TG(function(){var c=
a.P.src;c&&(c.currentTime&&(c.currentTime=0),c.pause())},1E3*c.ke)):(d=c.tc,c.duration<d.buffer.duration?c.ke&&20==c.state?d.stop(b+c.ke):20==c.state&&(d.stop(0),d.disconnect()):d.disconnect(),c.ze=0,c.Kx=0,c.fv=0);c.state=30}}function f(a){a=a.P;if(20==a.state){var c=G.currentTime;a.Kx=c;if("BACKGROUND_MUSIC"==a.behavior){var d=a.src;d&&d.pause()}else{if(c>a.ze){q[0]=a.Vu;for(var b=a.tc.buffer.duration,e=a.ze;e<c;)d=a.pitch+a.Ll*H.ef(q),e+=b/d;d*=b/d-(e-c)}else d=0;a.fv=d;a.tc.stop(0);a.tc.disconnect();
g(a)}a.state=40}}function r(a){var c=a.P;if(40==c.state){var d=G.currentTime;c.ze+=d-c.Kx;"BACKGROUND_MUSIC"==c.behavior?c.src.play():(l(a),c.jp=d,a=c.tc,H.Af(a.onended)&&(a.onended=function(){c.state=50}),a.start(c.ze,c.fv),B(c));w(c,c.ze);c.state=20}}function l(a){a=a.P;var c=G.createBufferSource();c.loop=a.tc.loop;c.buffer=a.tc.buffer;c.playbackRate.value=a.tc.playbackRate.value;a.wo?c.connect(a.wo):c.connect(a.al);a.tc=c}function A(a){a=a.P;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=
a.state?!1:!0}function x(a){return a.muted?0:a.volume}function L(a){a=a.P;return(a=a.src)?a.duration:0}var M=n("__config"),F=n("__print"),J=n("__time"),C=n("__tsr"),H=n("__util"),K=n("__vec3"),d=M.v,h=M.P;a.Lz=10;a.tt=20;a.Kz=30;var v=new Float32Array(3),P=new Float32Array(3),c=new Float32Array(3),p=[],N=[],G=null,u=null,z=[],q=[1],D=null;a.aN=function(){return{Ei:-1,bg:"",behavior:"NONE",ij:!1,muted:!1,volume:1,pitch:1,Rm:1,An:1,vf:1E4,SB:360,TB:360,UB:1,nd:!1,loop:!1,wC:0,xC:0,lk:0,Ll:0,nj:0,ke:0,
ze:0,Kx:0,fv:0,duration:0,jp:0,Vu:1,src:null,state:10,ex:new Float32Array(3),direction:new Float32Array(3),Qy:new Float32Array(3),Zu:-1,$u:-1,lj:0}};a.yf=function(){var a=document.createElement("audio"),c=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(p.push("ogg"),p.push("ogv"),p.push("oga")),""!=a.canPlayType("audio/mpeg")&&p.push("mp3"),""!=a.canPlayType("audio/mp4")&&(p.push("mp4"),p.push("m4v"),p.push("m4a")),""!=a.canPlayType("audio/webm")&&p.push("webm"));
c.canPlayType&&(""!=c.canPlayType("video/ogg")&&(N.push("ogv"),N.push("ogg"),N.push("oga")),""!=c.canPlayType("video/mp4")&&(N.push("m4v"),N.push("mp4")),""!=c.canPlayType("video/webm")&&N.push("webm"),""!=c.canPlayType("video/mpeg")&&N.push("mp3"));(G=h.Bz?k():null)&&F.log("%cINIT WEBAUDIO: "+G.sampleRate+"Hz","color: #00a")};a.gB=function(a){var c={Gj:new Float32Array(3),VE:new Float32Array(3),sl:new Float32Array(3)};a.Va=c;if(G){var b=G.createGain(),e=G.createGain();c.al=b;c.mj=e;b.connect(e);
e.connect(G.destination);if(a.b4w_enable_dynamic_compressor){var e=G.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;e.threshold.value=f.threshold;e.knee.value=f.knee;e.ratio.value=f.ratio;e.attack.value=f.attack;e.release.value=f.release;e.connect(b);c.mn=e;c.Jd=e}else c.mn=null,c.Jd=b;b=G.listener;c.ij=d.$v;c.ij||(b.dopplerFactor=a.audio_doppler_factor,b.speedOfSound=a.audio_doppler_speed);c.muted=!1;c.volume=1;c.lj=0}};a.IR=function(a){u=a};a.AN=function(a){a||(a="ogg");return-1<
p.indexOf(a)?a:-1<p.indexOf("m4a")?"m4a":-1<p.indexOf("oga")?"oga":""};a.CN=function(a){a||(a="webm");return-1<N.indexOf(a)?a:-1<N.indexOf("m4v")?"m4v":-1<N.indexOf("webm")?"webm":""};a.Di=function(a,c){var b=a.data,e=c.P;e.Ei=a.data.sound.uuid;e.bg=a.data.sound.filepath;switch(b.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":e.behavior=G?b.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var f;G?(window.MediaElementAudioSourceNode?f=!0:(F.warn("MediaElementAudioSourceNode not found"),f=
!1),f=f&&!d.JB?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):f="NONE";e.behavior=f;break;default:H.l("Wrong speaker behavior")}b.sound||(e.behavior="NONE");e.ij=b.b4w_disable_doppler||d.$v;e.muted=b.muted;e.volume=b.volume;e.pitch=b.pitch;e.Rm=b.attenuation;e.An=b.distance_reference;e.vf=b.distance_max||1E4;e.SB=b.cone_angle_inner;e.TB=b.cone_angle_outer;e.UB=b.cone_volume_outer;e.nd=b.b4w_cyclic_play;e.loop=b.b4w_loop;e.wC=b.b4w_delay;e.xC=b.b4w_delay_random;e.lk=b.b4w_volume_random;e.Ll=b.b4w_pitch_random;
e.nj=b.b4w_fade_in;e.ke=b.b4w_fade_out;z.push(c)};a.hH=function(c){"SPEAKER"!=c.type&&H.l("Wrong object type");switch(c.P.behavior){case "POSITIONAL":return a.tt;case "BACKGROUND_SOUND":return a.tt;case "BACKGROUND_MUSIC":return a.Kz;case "NONE":return a.Lz;default:H.l("Wrong speaker behavior")}};a.TT=function(a,c){var d=a.P;switch(d.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":d.src=c;break;case "NONE":break;default:H.l("Wrong speaker behavior")}};a.PF=function(){var a=
G.createBufferSource();a.buffer=G.createBuffer(1,22050,22050);a.connect(G.destination);a.start(0)};a.vN=function(a,c,d){G?G.decodeAudioData(a,c,d):d()};a.KS=function(a){t(a);a.P=null;z.splice(z.indexOf(a),1)};a.ha=function(){for(var a=0;a<z.length;a++){var c=z[a].P;"BACKGROUND_MUSIC"==c.behavior?(c=c.src)&&c.pause():c.tc&&c.tc.disconnect()}u&&u.Va&&(a=u.Va,a.Gj[0]=0,a.Gj[1]=0,a.Gj[2]=0,a.sl[0]=0,a.sl[1]=0,a.sl[2]=0);u=null;z.splice(0);D=null};a.update=function(a){if(G&&0!=z.length){for(var c=0;c<
z.length;c++){var d=z[c],b=d.P,e=b.tc,f=G.currentTime;!b.loop&&20==b.state&&b.duration&&b.ze+b.duration<f&&("BACKGROUND_MUSIC"==b.behavior||e&&!H.Af(e.onended))&&(b.state=50);b.nd&&50==b.state&&y(d);20==b.state&&3>b.jp-f&&B(b)}D&&D.sh.length&&(-1==D.Ub||a>D.UA+D.BC[D.Ub])&&(c=D,-1<c.Ub&&t(c.sh[c.Ub]),-1==c.Ub&&c.random?d=Math.round(Math.random()*(c.sh.length-1)):c.random?(d=1+Math.round(Math.random()*(c.sh.length-2)),d=(c.Ub+d)%c.sh.length):d=(c.Ub+1)%c.sh.length,y(c.sh[d]),c.Ub=d,c.UA=a)}};a.play=
b;a.OF=y;a.stop=t;a.LP=function(a){return 20==a.P.state};a.M1=f;a.O1=r;a.$Q=function(a,c){var d=a.P;d.pitch=c;!A(a)||"POSITIONAL"!=d.behavior&&"BACKGROUND_SOUND"!=d.behavior||(d.tc.playbackRate.value=c,g(d),B(d))};a.uZ=function(a){return a.P.pitch};a.nd=function(a,c){a.P.nd=Boolean(c)};a.zE=function(a){return a.P.nd};a.fQ=function(a,d,b,e){if(G&&a.Va){var f=v;f[0]=0;f[1]=-1;f[2]=0;K.transformQuat(f,b,f);P[0]=0;P[1]=0;P[2]=-1;K.transformQuat(P,b,P);b=G.listener;b.setPosition(d[0],d[1],d[2]);b.setOrientation(f[0],
f[1],f[2],P[0],P[1],P[2]);K.copy(f,a.Va.VE);!a.Va.ij&&e&&(c[0]=(d[0]-a.Va.Gj[0])/e,c[1]=(d[1]-a.Va.Gj[1])/e,c[2]=(d[2]-a.Va.Gj[2])/e,H.Yl(c,a.Va.sl,e,.3,c),b.setVelocity(c[0],c[1],c[2]),K.copy(c,a.Va.sl));K.copy(d,a.Va.Gj)}};a.O_=function(a,c){if(G&&u.Va&&!u.Va.ij){var d=v;c?K.copy(c,d):K.copy(u.Va.VE,d);K.scale(d,a,d);G.listener.setVelocity(d[0],d[1],d[2]);K.copy(d,u.Va.sl)}};a.LS=function(a,c){var d=a.P;if(A(a)&&"POSITIONAL"==d.behavior){var b=C.q(a.g.i),e=C.B(a.g.i),f=d.wo;f.setPosition(b[0],b[1],
b[2]);var h=v;H.Cb(e,H.md,h);f.setOrientation(h[0],h[1],h[2]);e=d.ex;!d.ij&&c&&(P[0]=(b[0]-e[0])/c,P[1]=(b[1]-e[1])/c,P[2]=(b[2]-e[2])/c,H.Yl(P,d.Qy,c,.3,P),f.setVelocity(P[0],P[1],P[2]),K.copy(P,d.Qy));K.copy(b,e)}};a.N1=function(a,c,d){var b=a.P;if(A(a)&&"POSITIONAL"==b.behavior&&!b.ij){var e=v;d?K.copy(d,e):K.copy(b.direction,e);K.scale(e,c,e);b.wo.setVelocity(e[0],e[1],e[2]);K.copy(e,b.Qy);K.copy(C.q(a.g.i),b.ex)}};a.Hw=function(a){return a.P.behavior};a.SW=function(){for(var a=0;a<z.length;a++)if(A(z[a]))return!0;
return!1};a.e1=function(a){var c=u.Va;c&&(c.volume=a,G&&(c.al.gain.value=x(c)))};a.bZ=function(){var a=u.Va;return a?a.volume:0};a.sS=function(a,c){var d=a.P;d.volume=c;A(a)&&(d.al.gain.value=x(d))};a.RZ=function(a){return a.P.volume};a.Kj=function(a,c){a.P.muted=Boolean(c);A(a)&&(a.P.al.gain.value=x(a.P))};a.I_=function(a){return a.P.muted};a.Y_=function(a){var c=u.Va;c&&(c.muted=Boolean(a),G&&(c.al.gain.value=x(c)))};a.H_=function(){var a=u.Va;return a?a.muted:!1};a.cP=function(){return z};a.pause=
function(){for(var a=0;a<z.length;a++)f(z[a])};a.nh=function(){for(var a=0;a<z.length;a++)r(z[a])};a.R0=function(a,c){if(a.Va&&a.Va.mn){var d=a.Va.mn;d.threshold.value=c.threshold;d.knee.value=c.knee;d.ratio.value=c.ratio;d.attack.value=c.attack;d.release.value=c.release}};a.DY=function(a){if(!a.Va||!a.Va.mn)return null;a=a.Va.mn;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.IX=function(a,c,d){if(A(a)){a=a.P;var b=a.mj,e=
G.currentTime;b.gain.setValueAtTime(b.gain.value,e);b.gain.linearRampToValueAtTime(c,e+d);a.lj=d}};a.t2=function(a){if(A(a)){a=a.P;var c=a.mj,d=G.currentTime;c.gain.setValueAtTime(c.gain.value,d);c.gain.linearRampToValueAtTime(1,d+a.lj);a.lj=0}};a.JX=function(a,c){if(G){var d=u.Va,b=d.mj,e=G.currentTime;b.gain.setValueAtTime(b.gain.value,e);b.gain.linearRampToValueAtTime(a,e+c);d.lj=c}};a.u2=function(){if(G){var a=u.Va,c=a.mj,d=G.currentTime;c.gain.setValueAtTime(c.gain.value,d);c.gain.linearRampToValueAtTime(1,
d+a.lj);a.lj=0}};a.yW=function(a,c,d){D={Ub:-1,UA:0,random:d,sh:[],BC:[]};for(d=0;d<a.length;d++){var b=a[d],e=L(b);0==e?F.warn("Ignoring speaker with zero duration: "+b.name):(t(b),b.P.nd=!1,D.sh.push(b),D.BC.push(e+c))}};a.HY=L;a.lX=function(){if(D)for(var a=D.sh,c=0;c<a.length;c++)t(a[c]);D=null};a.xZ=function(a){return(a=a.P)&&"POSITIONAL"==a.behavior?{dist_ref:a.An,dist_max:a.vf,attenuation:a.Rm}:null};a.p1=function(a,c){var d=a.P;if(d&&"POSITIONAL"==d.behavior){d.An=c.dist_ref;d.vf=c.dist_max;
d.Rm=c.attenuation;var b=d.wo;b&&(b.refDistance=d.An,b.maxDistance=d.vf,b.rolloffFactor=d.Rm)}};a.X0=function(a,c){var d=a.P;d&&d.cg&&(d.cg.frequency.value=c.freq,d.cg.Q.value=c.Q,d.cg.gain.value=c.gain)};a.NY=function(a){return(a=a.P)&&a.cg?{freq:a.cg.frequency.value,Q:a.cg.Q.value,gain:a.cg.gain.value}:null};a.MY=function(a,c,d,b){a=a.P;if(!a||!a.cg)return null;a.cg.getFrequencyResponse(c,d,b)}};"object"==typeof module&&module.hw&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function n(){var a=k,b=a.getDate(),b=10>b?"0"+String(b):String(b),g=a.getMonth()+1,g=10>g?"0"+String(g):String(g),n=String(a.getFullYear()),w=a.getHours(),w=10>w?"0"+String(w):String(w),t=a.getMinutes(),t=10>t?"0"+String(t):String(t),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return b+"."+g+"."+n+" "+w+":"+t+":"+a}var k=new Date(2016,6,16,13,55,49),b=[16,6];a.version=function(){return b};a.uz=function(){for(var a="",k=0;k<b.length;k++)a=1==k?a+(10>b[k]?"0"+b[k]:
b[k]):a+b[k],k!=b.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.pC=function(){return k};a.Rv=n;a.timestamp=function(){var a=n(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.hw&&b4w.module.__version(exports);b4w.module.__prerender=function(a,n){function k(a,b){var e=a.lg,g=a.G;e.Ar=!1;if(e.xj)return!1;var l=b.k,k="SHADOW_CAST"==b.type?l.YE:w.Vh(l.i,x),r=e.Yc.O,d=e.ci,k=Math.sqrt((r[0]-k[0])*(r[0]-k[0])+(r[1]-k[1])*(r[1]-k[1])+(r[2]-k[2])*(r[2]-k[2]));if(!(k<e.po?0:d==f.Qz||k<d+e.tl*e.Yc.mb))return!1;e.Ar=!0;(d="OUTLINE_MASK"==b.type&&!Boolean(e.kh))||(e.kj?d=!1:(e=g.na,d=t.NN(e.O,l.$k,e.$d,e.ae,e.be)));return d?!1:"DEBUG_VIEW"==b.type?b.debug_view_mode==y.tp?a.G.hj:!a.G.hj:!0}function b(a){var b=a.Qa;
if(b&&b.EQ){a=a.oa;g.rQ(a);var e=a.sd,f=a.ed,l=f.a_normal;e.set(b.Qx,f.a_position.offset);e.set(b.Dx,l.offset);g.YH(a)}}var e=n("__config"),y=n("__debug"),g=n("__geometry"),B=n("__renderer"),w=n("__tsr"),t=n("__util"),f=n("__objects"),r=n("__vec3"),l=e.v,A="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND MAIN_GLOW SHADOW_CAST SHADOW_RECEIVE OUTLINE_MASK DEBUG_VIEW COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" "),x=new Float32Array(3);
a.ks=function(a){if(-1<A.indexOf(a.type)){for(var e=!1,f=a.D,n=0;n<f.length;n++){var t=f[n],y=t.G;if("MAIN_CUBE_REFLECT"==a.type||"MAIN_CUBE_REFLECT_BLEND"==a.type)for(var K=0;6>K;K++)a.k.$k=a.sn[K],t.cw[K]=k(t,a),t.cw[K]&&(e=!0,b(y));else t.ec=k(t,a),t.ec&&(e=!0,b(y));a.ra&&(y.rb.Pr=!0)}a.ra=!1;switch(a.type){case "DEBUG_VIEW":break;default:"MAIN_OPAQUE"===a.type||"SHADOW_RECEIVE"===a.type||"MAIN_GLOW"===a.type||"MAIN_PLANE_REFLECT"===a.type||"MAIN_CUBE_REFLECT"===a.type||e?a.ec=!0:(a.ec&&B.clear(a),
a.ec=!1)}}else if(a.ra){f=a.D;for(n=0;n<f.length;n++)a.ra&&(f[n].G.rb.Pr=!0);a.ra=!1}if("MAIN_BLEND"==a.type&&l.alpha_sort&&a.D)for(e=w.Vh(a.k.i,x),f=0;f<a.D.length;f++)if(t=a.D[f],t.ec){n=t.lg;if((t=t.G)&&t.Sf){t=t.oa;if(!t)continue;var y=t.or,K=r.dist(e,y.GI),d=l.alpha_sort_threshold*Math.min(y.xL,1);if(!(K>d||n.nw))continue;g.zT(t,n.i,e);r.copy(e,y.GI)}n.nw=!1}}};b4w.module.__primitives=function(a,n){function k(a,b,e,g){for(var k=[],n=[],t=[],B=[],y=2*e/(a-1),C=2*g/(b-1),H=0;H<a;H++)for(var K=-e+H*y,d=0;d<b;d++)if(n.push(K,0,-g+d*C),t.push(0,1,0),B.push(H/(a-1),d/(b-1)),H&&d){var h=H*b+d,v=h-1,P=(H-1)*b+d,c=P-1;k.push(h,v,P);k.push(v,c,P)}a=w.sf();a.a_position=new Float32Array(n);a.a_normal=new Float32Array(t);t=w.Bc("GRID_PLANE");t.N[0]=a;t.ba.a_texcoord=new Float32Array(B);t.ab=new Uint32Array(k);t.wa=n.length/3;return t}function b(a){var b=a.length;b%4&&
w.l("Wrong array");for(var e=[],g=[],k=0;k<b;k+=4){var n=a[k+1],t=a[k+2],B=a[k+3];y(a[k],g);y(n,g);y(t,g);y(B,g);e.push(k,k+1,k+2);e.push(k,k+2,k+3)}a=w.sf();a.a_position=new Float32Array(g);b=w.Bc("FROM_QUADS");b.N[0]=a;b.ab=new Uint32Array(e);b.wa=g.length/3;return b}function e(a,b){var e=3*b;return[a[e],a[e+1],a[e+2]]}function y(a,b){b.push(a[0],a[1],a[2])}var g=n("__config"),B=n("__geometry");n("__print");var w=n("__util"),t=g.v;a.zO=function(){var a=w.Bc("LINE"),b=w.sf();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.N[0]=b;a.ab=new Uint32Array(1);a.wa=1;return a};a.tY=function(a,b){var e=k(2,2,a,b);e.name="PLANE";return e};a.sY=k;a.CO=function(a,b,e){function g(a,c){return 1==a%2&&(0==c||c==F-1)||1==c%2&&(0==a||a==y-1)?!0:!1}var k=e/=Math.pow(2,a-1),n=e,y=b+1,F=b+1;b=[];e=[];for(var J=[],C=[],H=0,K=0,d=-1,h=[],v=0;v<a;v++){for(var P=2*k/(y-1),c=2*n/(F-1),p=[],N=[],G=0,u=0;u<y;u++){for(var z=-k+u*P,q=[],D=0;D<F;D++){var I=-n+D*c;if(z>-H&&z<H&&I>-K&&I<K)q.push(-1),G++;else{for(var m=
null,V=0;V<h.length;V+=3)if(z==h[V]&&I==h[V+1]){m=h[V+2];break}V=null!==m?m:d+1;g(u,D)?(q.push(-2),G++):(null==m&&(0==D||D==F-1||0==u||u==y-1?(m=v==a-1?P:2*P,p.push(z,I,V)):m=P,e.push(z,m,I),C.push(0,1,0),J.push(1,0,0),d++),q.push(V));if(u&&D)if(1==u)if(g(u-1,D)){if(1<D){var I=V-1,m=N[u-1][D+1],Q=m-1;b.push(V,I,Q)}else m=N[u-1][D+1],Q=m-1;b.push(V,Q,m)}else g(u,D)||(I=V-1,m=N[u-1][D],b.push(V,I,m));else if(u==y-1){if(!g(u,D))if(D==F-1)I=V-1,m=N[u-1][D-1],Q=N[u-2][D],b.push(V,I,m),b.push(V,m,Q);else{var I=
V-1,m=N[u-1][D],Q=m-1,R=m+1;b.push(V,I,Q);b.push(V,Q,m);b.push(V,m,R);2==D&&(R=N[u-2][D-2],b.push(I,R,Q))}}else 1==D?g(u,D-1)?(I=N[u-1][D],m=N[u-1][D-1],b.push(V,m,I)):(I=q[D-1],m=N[u-1][D],Q=N[u-2][D-1],b.push(V,I,m),b.push(I,Q,m)):D==F-1?g(u,D)||(I=q[D-1],m=N[u-1][D-1],Q=N[u-2][D],b.push(V,I,m),b.push(V,m,Q)):-1!=N[u-1][D]&&-1!=N[u-1][D-1]&&-1!=q[D-1]?(I=q[D-1],m=N[u-1][D],Q=N[u-1][D-1],b.push(V,I,m),b.push(I,Q,m),D==F-2&&g(u,D+1)&&(R=N[u-1][D+1],b.push(V,m,R))):D==F-2&&g(u,D+1)&&(m=N[u-1][D],R=
N[u-1][D+1],b.push(V,m,R))}}N.push(q)}h=p;H=k;K=n;k*=2;n*=2}if(2E4>H)for(a=-(2*H)/(y-1),e.push(-2E4,a,-2E4),e.push(-2E4,a,2E4),e.push(-H,a,-K),e.push(-H,a,K),e.push(2E4,a,-2E4),e.push(2E4,a,2E4),e.push(H,a,-K),e.push(H,a,K),V=d+1,b.push(V+3,V+2,V+1,V+2,V+0,V+1,V+6,V+4,V+2,V+4,V+0,V+2,V+5,V+7,V+1,V+7,V+3,V+1,V+5,V+4,V+7,V+7,V+4,V+6),u=0;8>u;u++)C.push(0,1,0),J.push(1,0,0);a=w.sf();a.a_position=new Float32Array(e);a.a_tangent=new Float32Array(J);a.a_normal=new Float32Array(C);k=w.Bc("multigrid_plane");
k.N[0]=a;k.ab=new Uint32Array(b);k.wa=e.length/3;t.AI&&(B.Vs(k,1,!0),a.a_polyindex=B.Oq(k));return k};a.rY=function(a){var b=a.length;b%3&&w.l("Wrong array");for(var e=[],g=[],k=0;k<b;k+=3){var n=a[k+1],t=a[k+2];y(a[k],g);y(n,g);y(t,g);e.push(k,k+1,k+2)}a=w.sf();a.a_position=new Float32Array(g);b=w.Bc("FROM_TRIANGLES");b.N[0]=a;b.ab=new Uint32Array(e);b.wa=g.length/3;return b};a.qY=b;a.wO=function(a){a=w.pU(a);var e=[];e.push(a[0],a[1],a[2],a[3]);e.push(a[0],a[3],a[5],a[4]);e.push(a[3],a[2],a[6],
a[5]);e.push(a[1],a[7],a[6],a[2]);e.push(a[0],a[4],a[7],a[1]);e.push(a[4],a[5],a[6],a[7]);a=b(e);a.name="FRUSTUM";return a};a.qc=function(){var a=w.Bc("FULLSCREEN_TRI"),b=w.sf();b.a_position=new Float32Array([0,0,1,0,0,1]);a.N[0]=b;a.ab=new Uint32Array([0,1,2]);a.wa=3;return a};a.xO=function(){var a=w.Bc("FULLSCREEN_QUAD"),b=w.sf();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.N[0]=b;a.ab=new Uint32Array([0,2,1,1,2,3]);a.wa=4;return a};a.sO=function(){var a=w.Bc("BILLBOARD"),b=w.sf();b.a_bb_vertex=
new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.N[0]=b;a.ab=new Uint32Array([0,2,1,0,3,2]);a.wa=4;return a};a.tO=function(){var a=w.Bc("CUBEMAP_BOARD"),b=w.sf();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.N[0]=b;a.ab=new Uint32Array([0,2,1,0,3,2]);a.wa=4;return a};a.sw=function(a,b){var g=w.Bc("UV_SPHERE"),k,n,t=[],M=[],F=[];for(n=0;8>=n;n++)for(k=0;16>=k;k++){var J=k/16,C=n/8;M.push(-a*Math.cos(2*J*Math.PI)*Math.sin(C*Math.PI)+b[0],a*Math.cos(C*Math.PI)+b[1],a*Math.sin(2*J*Math.PI)*
Math.sin(C*Math.PI)+b[2])}for(n=J=0;8>n;n++)for(k=0;16>k;k++){var C=e(M,17*n+k+1),H=e(M,17*n+k),K=e(M,17*(n+1)+k),d=e(M,17*(n+1)+k+1);Math.abs(C[1])==a+b[1]?(y(C,t),y(K,t),y(d,t),F.push(J,J+1,J+2),J+=3):Math.abs(K[1])==a+b[1]?(y(C,t),y(H,t),y(K,t),F.push(J,J+1,J+2),J+=3):(y(C,t),y(H,t),y(K,t),y(d,t),F.push(J,J+1,J+2),F.push(J,J+2,J+3),J+=4)}k={};k.a_position=t;M=B.NL(F,M,t);k.a_normal=B.LL(F,t,M);k.a_tangent=[];g.ba.a_influence=[];g.ba.a_color=[];g.ba.a_texcoord=[];g.N[0]=k;g.ab=F;g.wa=t.length/3;
return g};a.aD=function(a){var b=w.Bc("INDEX"),e=w.sf();e.a_index=new Float32Array(a);for(var g=0;g<a;g++)e.a_index[g]=g;b.N[0]=e;b.ab=new Uint16Array(0);b.wa=a;return b}};b4w.module.__scenegraph=function(a,n){function k(a){var c=a.je;a.je=null;var d=pa.ia(a);d.je=c;a.je=c;d.Ve=null;d.Wb=null;d.he=null;return d}function b(a,c){var d=[];O.Of(a,function(c,b,e){-1<d.indexOf(e)?O.vR(a,c,b,e,P(e)):d.push(e)});O.ma(a,function(a,b){for(var e=0;e<b.Fa.length;e++){var f=b.Fa[e];c||"MAIN_PLANE_REFLECT"!=b.type&&"MAIN_CUBE_REFLECT"!=b.type&&"MAIN_XRAY"!=b.type||(f.Ud=!0);-1<d.indexOf(f)?b.Fa[e]=P(f):d.push(f)}})}function e(a,c){O.ma(a,function(d,b){"ANTIALIASING"==b.type&&O.wg(a,
d,function(a,c){if("MOTION_BLUR"==c.type)for(var d=0;d<c.Fa.length;d++){var b=c.Fa[d];b.Na=fa.F;b.Ma=fa.F}});c||O.wg(a,d,function(a,c,d){"DEPTH"==d.from&&(d.Ud=!0)})});O.ma(a,function(c){var d={};y(a,c,d);for(var b in d){c=d[b];for(var e=c[0],f=0;f<c.length;f++)if(c[f].Na==fa.F){e=c[f];break}for(var h=c[0],f=0;f<c.length;f++)if(c[f].Ma==fa.F){h=c[f];break}for(var g=c[0],f=0;f<c.length;f++)if(!c[f].Ud){g=c[f];break}for(f=0;f<c.length;f++)c[f].Na=e.Na,c[f].Ma=h.Ma,c[f].Ud=g.Ud}})}function y(a,c,d){O.wg(a,
c,function(c,b,e){e.Ub&&e.from==e.to&&(d[e.from]=d[e.from]||[],-1==d[e.from].indexOf(e)&&d[e.from].push(e),y(a,c,d))});O.Ai(a,c,function(a,c,b){b.Ub&&(d[b.from]=d[b.from]||[],-1==d[b.from].indexOf(b)&&d[b.from].push(b))});c=O.Ra(a,c);if("MOTION_BLUR"==c.type)for(var b=0;b<c.Fa.length;b++){var e=c.Fa[b];d[e.from].push(e)}}function g(a){var c=["MOTION_BLUR","SMAA_RESOLVE","SMAA_NEIGHBORHOOD_BLENDING","MAIN_PLANE_REFLECT","MAIN_CUBE_REFLECT"],d=O.iz(a),b=[];O.ma(d,function(a,e){for(var h=0;h<e.Fa.length;h++){var g=
e.Fa[h];-1<c.indexOf(e.type)&&(g.ft=!0);var m=r(b,g,B(g));g.Ja=m;e.ug[h]=m}for(h=0;h<e.ug.length;h++)m=e.ug[h],f(b,m);O.Ai(d,a,function(f,h,g){-1<c.indexOf(e.type)&&(g.ft=!0);g.Ja||((f=w(d,a,g.from))&&g.Ub&&!g.Ja?t(b,f):f=r(b,g,B(g)),g.Ja=f)});O.wg(d,a,function(a,c,d){f(b,d.Ja)});O.Ai(d,a,function(a,c,d){d.Ja&&"NONE"==d.to&&f(b,d.Ja)})})}function B(a){a=pa.Oh(a);delete a.to;delete a.Ub;delete a.Ja;return JSON.stringify(a)}function w(a,c,d){var b=null;O.wg(a,c,function(a,c,e){if(e.Ub&&e.from==e.to&&
e.from==d&&e.Ja)return b=e.Ja,!0});O.Ai(a,c,function(a,c,e){if(e.Ub&&e.from==d&&e.Ja)return b=e.Ja,!0});return b}function t(a,c){for(var d=0;d<a.length;d++){var b=a[d];b.ez===c&&b.Fo++}}function f(a,c){for(var d=0;d<a.length;d++){var b=a[d];b.ez===c&&b.Fo&&b.Fo--}}function r(a,c,d){if(c.yo)return t(a,c.yo.Ja),c.yo.Ja;if(c.ft)return l(c);for(var b=null,e=0;e<a.length;e++){var f=a[e];if(f.id==d&&0===f.Fo){b=f;break}}if(b&&!ua.JC)return b.Fo++,b.ez;c=l(c);a.push({id:d,Fo:1,ez:c});return c}function l(a){var c=
a.bk*a.size,d=a.ck*a.size;switch(a.from){case "COLOR":if(a.Ud){var b=fa.qn("COLOR_RB",a.ei?fa.Pp:fa.Op);fa.resize(b,c,d)}else b=fa.qn("COLOR",fa.Ri),fa.resize(b,c,d),fa.vy(b,a.Na,a.Ma);return b;case "DEPTH":return a.Ud?(b=fa.qn("DEPTH_RB",a.ei?fa.Np:fa.Mp),fa.resize(b,c,d)):(b=fa.qn("DEPTH_TEX",fa.uk),fa.resize(b,c,d),fa.vy(b,a.Na,a.Ma)),b;case "CUBEMAP":return b=fa.JM(c);case "SCREEN":case "NONE":return null;default:pa.l("Wrong slink param: "+a.from)}}function A(a,c){var d=!1;O.Of(a,function(b,e,
f){if(f&&(b=O.Ra(a,b),e=O.Ra(a,e),c(f,!1,b,e)))return d=!0});d||O.ma(a,function(a,d){for(var b=0;b<d.Fa.length;b++)if(c(d.Fa[b],!0,d,null))return!0})}function x(a){O.ma(a,function(c,d){if("SINK"!=d.type){var b=d.k;O.Ai(a,c,function(a,c,d){d.Ub&&d.Ja&&(T.ws(b,d.from,d.Ja),d.from==d.to&&c.k&&T.ws(c.k,d.from,d.Ja))});for(var e=0;e<d.Fa.length;e++){var f=d.Fa[e];f.Ub&&f.from==f.to&&T.ws(b,f.from,d.ug[e])}!b.Wb&&!b.he||b.Ve||(b.Ve=ya.rR(b.Wb,b.he))}});O.ma(a,function(c,d){if("RESOLVE"==d.type||"COPY"==
d.type){var b=Aa(a,d);d.k.ow=b[0].k.Ve}})}function L(a){var c=null,d=0;O.ma(a,function(a,b){if(b.type==Ea.ZS){if(d==Ea.YS)return c=b,!0;d++}});return c}function M(a,c){var d=O.Ff(a,c),b=p("NONE"),e=O.C(a,b),f=O.Wn(a)[0];O.Of(a,function(c,d){d==f&&O.kR(a,c,f,c,e)});var h=F(c,a);O.Of(a,function(e,f,g){if(e==d){if(h){e=z();O.C(a,e);f=v("COLOR","RESOLVE",1,1,1,!0);f.ei=!0;f.Ud=!0;var m=v("DEPTH","RESOLVE",1,1,1,!0);m.ei=!0;m.Ud=!0;O.m(a,c,e,f);O.m(a,c,e,m);c=e}O.m(a,c,b,v(Ea.ES,"u_color",g.size,g.bk,
g.ck,g.$o));return!0}});O.Wc(a,e,f,v("SCREEN","NONE",.5,.5,.5,!0))}function F(a,c){var d=!1,b=O.Ff(c,a);O.mg(c,b)&&(d=O.eg(c,b,0),b=O.me(c,b,d,0),"COLOR"==b.from&&"COLOR"==b.to||"DEPTH"==b.from&&"DEPTH"==b.to?(b=O.Ra(c,d),d=F(b,c)):d="RESOLVE"==b.to);return d}function J(a,c,d,b){for(var e=d.U,f=c.ao,g=c.og.ng,m=c.og.gs,l=O.Us(a,O.YO(a,b),O.pp),p=[],k=[],q=[],l=O.clone(l,function(c){var b;if(-1<sa.indexOf(c.type))k.push(c),b=c;else{b=h(c);if("MAIN_PLANE_REFLECT"==b.type)for(var l=0;l<g.length;l++)if(g[l][0]==
c){g[l]=[c,b];b.k.jc=c.k.jc;d.U.push(b.k);break}if("MAIN_PLANE_REFLECT_BLEND"==c.type)for(l=0;l<g.length;l++){if(m[l][0]==c){m[l]=[c,b];b.k=g[l][1].k;break}}else-1<e.indexOf(c.k)&&(f?(T.Ir(c.k,T.wd),T.Ir(b.k,T.xd)):(T.Ir(c.k,T.cc),T.Ir(b.k,T.nc)),e.push(b.k));var v=O.Ff(a,c);O.wg(a,v,function(a,c,d){-1<sa.indexOf(c.type)&&p.push([c,b,d])});for(l=0;l<c.Fa.length;l++)b.Fa[l].yo=c.Fa[l];c=!0;for(l=0;l<O.nr(a,v);l++){var u=O.vj(a,v,l),u=O.Ra(a,u);-1==sa.indexOf(u.type)&&(c=!1)}c&&q.push(b)}return b},
function(a){var c=P(a,!0);c.yo=a;return c}),u=0;u<k.length;u++)O.Jf(l,O.Ff(l,k[u]));O.rv(l);c=oa(f);var u=O.C(a,c),r=E();O.C(a,r);var n=v("COLOR","COPY",1,1,1,!0);O.m(a,b,r,n);var t=v("COLOR","u_sampler_left",1,1,1,!0);t.ft=!0;t.Na=fa.F;t.Ma=fa.F;O.m(a,r,c,t);b.Zb||(b=E(),O.C(l,b),t=v("COLOR","COPY",1,1,1,!0),t.yo=n,n=O.Wn(l)[0],n=O.Ra(l,n),O.m(l,n,b,t));b=v("COLOR","u_sampler_right",1,1,1,!0);b.Na=fa.F;b.Ma=fa.F;O.YK(l,a,[O.Wn(l)[0],u,b]);for(u=0;u<p.length;u++)O.m(a,p[u][0],p[u][1],p[u][2]);l=v("SCREEN",
"NONE",0,0,0,!1);for(u=0;u<q.length;u++)O.m(a,r,q[u],l);f&&C(a,.5,1);return c}function C(a,c,d){var b=[];O.ma(a,function(c,d){if(-1==sa.indexOf(d.type)&&d.Fa.length&&ca(a,d,"STEREO"))for(var e=0;e<d.Fa.length;e++){var f=d.Fa[e];-1==b.indexOf(f)&&b.push(f)}});O.Of(a,function(c,d,e){c=O.Ra(a,c);d=O.Ra(a,d);-1==sa.indexOf(c.type)&&ca(a,d,"STEREO")&&-1==b.indexOf(e)&&b.push(e)});for(var e=0;e<b.length;e++)b[e].bk*=c,b[e].ck*=d}function H(a,c){a.Rr=c;a.hx=new Float32Array(3*c);a.Er=new Float32Array(3*
c);a.Dr=new Float32Array(3*c);a.ix=new Float32Array(0==c%2?2*c:2*c+2)}function K(a,c,b,e){var f=d("SHADOW_CAST");f.Kv=a;f.self_shadow_polygon_offset=b.self_shadow_polygon_offset;f.Lf=c;switch(b.Bf[c]){case "SPOT":case "POINT":f.k=T.pc(T.Vc);a=pa.Ld(b.kH[c]);T.zs(f.k,a,b.cn[c],b.bn[c]);break;default:f.k=T.pc(T.Si)}H(f,e);return f}function d(a){a={type:a,sb:"",eb:!1,IF:!1,Uu:!1,Nr:!1,un:0,tf:0,Nk:[],debug_view_mode:0,debug_colors_seed:0,rC:1,bw:!1,time:0,k:null,gj:null,sn:[],D:[],Fa:[],ug:[],Bh:new Float32Array(3),
Cd:new Float32Array(3),od:new Float32Array(4),Te:new Float32Array(4),fe:new Float32Array(16),cH:0,Sg:0,Rr:0,hx:null,Er:null,Dr:null,ix:null,ne:new Float32Array(3),Je:new Float32Array(3),dH:new Float32Array(4),tH:new Float32Array([0,0,0]),Xy:new Float32Array(3),uH:new Float32Array(4),bH:new Float32Array(3),uo:0,dw:0,ho:!1,jh:new Float32Array(3),mk:0,lv:0,Rf:null,zz:0,Az:0,Ii:0,Ig:!1,vB:0,wB:new Float32Array(2),uB:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,
spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Xl:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,dm:0,cm:0,bm:0,lH:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,ul:0,ns:0,hm:0,Kv:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,mt:null,lt:null,rz:null,Tj:null,Zb:!1,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,bv:0,
iw:0,mb_decay_threshold:0,mb_factor:0,hF:0,hs:"",MP:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,fz:new Float32Array(2),Ib:new Float32Array(2),jj:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,Lf:0,ec:!0,cd:!0,Xa:!0,Za:!0,Zc:!0,ra:!0,wh:1};a.Ib[0]=1;a.Ib[1]=1;a.jj[2]=.5;a.jj[3]=.5;return a}function h(a){var c=a.k;a.k=null;var d=pa.ia(a);a.k=c;d.k=k(c);return d}function v(a,c,d,b,e,f){return{from:a,
to:c,size:d,bk:b,ck:e,$o:f,Ub:!0,Ja:null,ei:!1,Ud:!1,Na:fa.of,Ma:fa.of,ft:!1}}function P(a,c){if(c){var d=a.Ja;a.Ja=null}a.Ja&&pa.l("Failed to clone slink with attached texture");var b=pa.Oh(a);c&&(a.Ja=d,b.Ja=d);return b}function c(){var a=d("GRASS_MAP");a.k=T.pc(T.Fh);return a}function p(a){var c=d("POSTPROCESSING");c.Xa=!1;c.Za=!1;c.Zc=!1;c.Zb=!0;c.k=T.pc(T.zc);c.hs=a;switch(a){case "NONE":c.Ib[0]=1;c.Ib[1]=1;break;case "GRAYSCALE":c.Ib[0]=1;c.Ib[1]=1;break;case "X_BLUR":c.Ib[0]=1;c.Ib[1]=0;break;
case "Y_BLUR":c.Ib[0]=0;c.Ib[1]=1;break;case "X_GLOW_BLUR":c.Ib[0]=1;c.Ib[1]=0;break;case "Y_GLOW_BLUR":c.Ib[0]=0;c.Ib[1]=1;break;case "X_EXTEND":c.Ib[0]=1;c.Ib[1]=0;break;case "Y_EXTEND":c.Ib[0]=0;c.Ib[1]=1;break;default:pa.l("Wrong postprocessing effect: "+a)}return c}function N(a){var c=d("BLOOM_BLUR");c.Xa=!1;c.Za=!1;c.Zc=!1;c.k=T.pc(T.zc);c.hs=a;c.Zb=!0;switch(a){case "X_BLUR":c.Ib[0]=1;c.Ib[1]=0;break;case "Y_BLUR":c.Ib[0]=0;c.Ib[1]=1;break;default:pa.l("Wrong postprocessing effect for bloom blur: "+
a)}return c}function G(a,c){var b=d("GLOW_COMBINE");b.Xa=!1;b.Za=!1;b.Zc=!1;b.small_glow_mask_coeff=c.Xh.small_glow_mask_coeff;b.large_glow_mask_coeff=c.Xh.large_glow_mask_coeff;b.small_glow_mask_width=c.Xh.small_glow_mask_width;b.large_glow_mask_width=c.Xh.large_glow_mask_width;b.k=a;b.Zb=!0;return b}function u(a,c,b,e,f,h,g,m,l){var p=d("MAIN_"+a);"OPAQUE"===a?(p.Xa=!0,p.Za=b,p.eb=!1):"BLEND"===a?(p.Xa=!1,p.Za=!1,p.eb=!0):"XRAY"===a?(p.Xa=!1,p.Za=!0,p.eb=!0):"PLANE_REFLECT"===a||"CUBE_REFLECT"===
a?(p.Xa=!0,p.Za=!0,p.eb=!1):"PLANE_REFLECT_BLEND"===a||"CUBE_REFLECT_BLEND"===a?(p.Xa=!1,p.Za=!1,p.eb=!0):"GLOW"===a?(p.Xa=!0,p.Za=!1,p.eb=!0):pa.l("wrong main subscene type");p.eb&&m&&(p.self_shadow_normal_offset=m.self_shadow_normal_offset);p.k=c;if(a=g.My)p.dH.set([a.zL,a.rP,a.CU,a.BU]),p.bH.set(a.color),p.cH=a.Ya;p.ne.set(g.ne);p.Je.set(g.Je);p.Sg=g.Sg;p.od=h.od;p.Te=h.Te;e&&(p.mc=e,e.od&&(p.Rf=new Float32Array(e.od)),p.zz=e.waves_height,p.Az=e.waves_length,p.Ii=e.Ii,e.Ig&&l&&(p.Ig=!0,p.vB=e.TL,
p.uB=e.SL,p.wB.set(e.UL)));H(p,f);return p}function z(){var a=d("RESOLVE");a.Zb=!0;a.k=T.pc(T.zc);return a}function q(a,c,b){var e=d("COLOR_PICKING");c&&(e.type+="_XRAY",e.Xa=!1,e.Za=!0);e.cd=!1;e.k=a;H(e,b);return e}function D(a){var c=d("DEBUG_VIEW");c.ec=!1;c.Xa=!1;c.Za=!1;c.k=a;return c}function I(a){var c=d("ANCHOR_VISIBILITY");c.Xa=!0;c.Za=!1;c.k=a;return c}function m(a,c){var b=d("SHADOW_RECEIVE");b.k=a;H(b,c);return b}function V(a){var c=d("DEPTH_PACK");c.Xa=!1;c.Za=!1;c.k=a;c.Zb=!0;return c}
function Q(a,c,b){var e=d("SSAO");e.Xa=!1;e.Za=!1;e.Zc=!1;e.k=a;e.od=c.od;e.Rf=new Float32Array(c.od);e.dm=b.radius_increase;e.ssao_hemisphere=b.pP;e.cm=b.influence;e.bm=b.dist_factor;e.lH=b.DR;e.Zb=!0;return e}function R(a,c){var b=d("SSAO_BLUR");b.Xa=!1;b.Za=!1;b.Zc=!1;b.k=a;b.ssao_blur_depth=c.CL;b.ssao_blur_discard_value=c.pB;b.Zb=!0;return b}function X(a){var c=d("ANTIALIASING");c.Xa=!1;c.Za=!1;c.Zc=!1;c.wh=1/a.Nd;c.rO=a.OA;c.k=T.pc(T.zc);c.Zb=!0;return c}function ja(a,c){var b=d(a);b.Xa="SMAA_BLENDING_WEIGHT_CALCULATION"==
a||"SMAA_EDGE_DETECTION"==a?!0:!1;b.Za=!1;b.Zc=!1;b.wh=1/c.Nd;b.k=T.pc(T.zc);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(b.NP=new Float32Array(4));b.Zb=!0;return b}function W(a,c,b,e){var f=d("COMPOSITING");f.Xa=!1;f.Za=!1;f.Zc=!1;f.k=T.pc(T.zc);f.brightness=a;f.contrast=c;f.exposure=b;f.saturation=e;f.Zb=!0;return f}function Z(a,c){var b=d("MOTION_BLUR");b.Xa=!1;b.Za=!1;b.Zc=!1;b.k=T.pc(T.zc);b.Uu=!0;b.mb_decay_threshold=a;b.mb_factor=c;b.Zb=!0;return b}function Y(a){var c=d("DOF");c.Xa=!1;c.Za=!1;c.Zc=
!1;c.k=a;c.wh=c.k.dof_power;c.Zb=!0;return c}function ia(a,c){var b=d("OUTLINE_MASK");b.Zc=!1;b.k=a;H(b,c);return b}function ha(a){var c=d("OUTLINE");Fa.outlining_overview_mode?c.jh.set(Fa.jh):c.jh.set(a.jh);c.uo=a.uo;c.iw=5;c.bv=3;c.Zc=!1;c.k=T.pc(T.zc);c.Zb=!0;return c}function ka(a,c,b,e,f,h,g){var m=d("GOD_RAYS");m.Xa=!1;m.Za=!1;m.Zc=!1;m.ne=new Float32Array([1,1,1]);m.Je=new Float32Array([1,1,1]);m.Sg=1;m.IF=e;m.mk=c;m.ns=f;m.ul=b;m.hm=g;m.k=a;H(m,h);return m}function la(a,c){var b=d("GOD_RAYS_COMBINE");
b.Xa=!1;b.Za=!1;b.Zc=!1;b.k=T.pc(T.zc);b.god_rays_intensity=a;H(b,c);b.Zb=!0;return b}function da(a,c){var b=d("SKY");b.cd=!1;b.Xa=!1;b.Za=!1;b.Zc=!1;var e=T.pc(T.zc);e.width=Ia.tn;e.height=Ia.tn;b.k=e;b.gj=pa.uO();H(b,a);b.ne=new Float32Array([1,1,1]);b.Je=new Float32Array([1,1,1]);b.Sg=1;b.Xl.set(c.Xl);b.procedural_skydome=c.procedural_skydome;b.use_as_environment_lighting=c.use_as_environment_lighting;b.rayleigh_brightness=c.rayleigh_brightness;b.mie_brightness=c.mie_brightness;b.spot_brightness=
c.spot_brightness;b.scatter_strength=c.scatter_strength;b.rayleigh_strength=c.rayleigh_strength;b.mie_strength=c.mie_strength;b.rayleigh_collection_power=c.rayleigh_collection_power;b.mie_collection_power=c.mie_collection_power;b.mie_distribution=c.mie_distribution;return b}function E(){var a=d("COPY");a.Xa=!1;a.Za=!1;a.k=T.pc(T.zc);a.Zb=!0;return a}function oa(a){var c=d("STEREO");c.Xa=!1;c.Za=!1;c.sb=a?"HMD":"ANAGLYPH";c.k=T.pc(T.zc);c.Zb=!0;return c}function U(){var a=d("LUMINANCE");a.Xa=!1;a.Za=
!1;a.k=T.pc(T.zc);a.Zb=!0;return a}function ea(){var a=d("AVERAGE_LUMINANCE");a.Xa=!1;a.Za=!1;a.k=T.pc(T.zc);a.Zb=!0;return a}function Ca(a,c,b,e){var f=d("LUMINANCE_TRUNCED");f.Xa=!1;f.Za=!1;f.bloom_key=a;f.bloom_edge_lum=c;f.k=e;H(f,b);f.Zb=!0;return f}function ba(a){var c=d("BLOOM");c.Xa=!1;c.Za=!1;c.k=T.pc(T.zc);c.bloom_blur=a;c.Zb=!0;return c}function aa(){var a=d("SINK");a.cd=!1;return a}function ca(a,c,b){if(c.type===b)return!0;c=ra(a,c);for(var d=0;d<c.length;d++)if(ca(a,c[d],b))return!0;
return!1}function S(a,c,b){if(c.type===b)return!0;c=Aa(a,c);for(var d=0;d<c.length;d++)if(S(a,c[d],b))return!0;return!1}function Aa(a,c){var b=O.Ff(a,c);b==O.wu&&pa.l("Subscene not in graph");for(var d=[],e=O.nr(a,b),f=0;f<e;f++){var h=O.vj(a,b,f);h!=b&&d.push(O.Ra(a,h))}return d}function ra(a,c){var b=O.Ff(a,c);b==O.wu&&pa.l("Subscene not in graph");for(var d=[],e=O.mg(a,b),f=0;f<e;f++){var h=O.eg(a,b,f);h!=b&&d.push(O.Ra(a,h))}return d}function za(a){var c=[],b=[];A(a,function(a){a.Ja&&-1==c.indexOf(a.Ja)&&
(c.push(a.Ja),b.push(a.Ja,c.length-1))});return b}function ma(a,c){var b;b=""+(a.from+"\\n");b+="NONE"!=a.to?a.to+"\\n":"";b+="(";if(a.$o){var d=a.bk,e=a.ck;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(e)!=e&&(e=e.toFixed(2));b+=(1==d?"":d)+"Sx"+((1==e?"":e)+"S")}else d=a.bk,e=a.ck,b+=a.size*d+"x"+a.size*e;if("SCREEN"!=a.from){b+=" ";if(a.Ud)b+="RR";else{var d=a.Na,e=a.Ma,f="";d==fa.F?f+="L":d==fa.of&&(f+="N");e==fa.F?f+="L":e==fa.of&&(f+="N");b+=f}for(d=0;d<c.length;d+=2)c[d]==a.Ja&&(b+=" "+c[d+
1])}return b+")\\n"}var T=n("__camera"),Da=n("__config"),ga=n("__debug"),O=n("__graph"),ya=n("__renderer");n("__scenes");var fa=n("__textures"),pa=n("__util"),Ea=Da.Fq,ua=Da.v,Fa=Da.hc,Ia=Da.Rl,sa=["GRASS_MAP","SHADOW_CAST","MAIN_CUBE_REFLECT","MAIN_CUBE_REFLECT_BLEND"];a.nM=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.nT=A;a.YM=function(a,d,f,h){function l(c){var b=k(Sa);d.U.push(b);
b=u(c,b,!1,S,F,wb,Ra,Xb,a.vh);O.C(r,b);"XRAY"==c?(O.m(r,n[0],b,v("COLOR","COLOR",1,1,1,!0)),b.Fa.push(v("DEPTH","DEPTH",1,1,1,!0))):(c=ya&&"RESOLVE"==n[0].type?yb:n[0],O.m(r,c,b,Mb),O.m(r,c,b,oc));xb&&(O.m(r,xb,b,yc),O.m(r,xb,b,zc));for(c=0;c<A.length;c++)O.m(r,A[c],b,w[c]);Zb&&O.m(r,Zb,b,sc);if(B.length){var e=B.length;for(c=0;c<e;c++)O.m(r,B[c],b,y[c])}if(H.length)for(c=0;c<H.length;c++)O.m(r,H[c],b,C[c]);Ib&&O.m(r,Ib,b,Jb);return b}var r=O.create(),n=[],t=[],A=[],w=[],B=[],y=[],H=[],C=[],F=a.RP,
S=a.mc,ca=a.ti,oa=a.GS,ma=a.Rd,za=a.hl,sa=a.og,ib=a.aF,Sb=a.BL,Yb=a.Jj,uc=a.Hk,Rb=a.antialiasing,Ra=a.Ez,wb=a.DI,Xb=a.Rc,Gc=a.yQ,Tb=a.VL,Cc=a.iP,Vc=a.MQ,nc=a.Qk,Eb=a.zN,Mc=a.gd,tb=Boolean(h.length),ya=1<ua.rc,oc=v("COLOR","COLOR",1,1,1,!0),Mb=v("DEPTH","DEPTH",1,1,1,!0);if(ya){P(Mb);var ob=P(Mb);oc.ei=!0;oc.Ud=!0;Mb.ei=!0;Mb.Ud=!0}var Sa=d.U[0];if(Xb){T.nz(Sa,Xb);for(var Na=0;Na<Xb.Bf.length;Na++)for(var Da=Xb.csm_num,Ua=0;Ua<Da;Ua++){var Fa=K(Ua,Na,Xb,F);O.C(r,Fa);A.push(Fa);var vc=Xb.csm_resolution,
Xa=Fa.k;d.$G.push(Xa);Xa.width=vc;Xa.height=vc;Fa.Xa=!1;w.push(v("DEPTH","u_shadow_map"+(0<Na?Na:Ua),vc,1,1,!1));(ga.cM()||ua.IC)&&Fa.Fa.push(v("COLOR","COLOR",vc,1,1,!1))}}if(sa&&sa.xF&&!tb)for(Ua=0;Ua<sa.xF;Ua++){Xa=T.pc(T.Vc);Xa.width=a.Ng;Xa.height=a.Ng;T.zs(Xa,90,.1,100);T.qi(Xa,Xa.ib);var Fb=u("CUBE_REFLECT",Xa,!1,S,F,wb,Ra,null,a.vh);Fb.gj=pa.yO();for(Na=0;6>Na;Na++)Fb.sn.push(T.MM());O.C(r,Fb);var pc=v("CUBEMAP","u_cube_reflection",a.Ng,1,1,!1);pc.Na=fa.F;pc.Ma=fa.F;C.push(pc);if(sa.kE){var gc=
u("CUBE_REFLECT_BLEND",Xa,!1,S,F,wb,Ra,null,a.vh);gc.gj=Fb.gj;gc.sn=Fb.sn;O.C(r,gc);var ed=v("DEPTH","DEPTH",a.Ng,1,1,!1),Nc=v("COLOR","COLOR",a.Ng,1,1,!1);O.m(r,Fb,gc,ed);O.m(r,Fb,gc,Nc);H.push(gc);sa.Mv.push(gc)}else{var jd=v("DEPTH","DEPTH",a.Ng,1,1,!1);Fb.Fa.push(jd);H.push(Fb)}sa.Mg.push(Fb)}if(sa&&0<sa.hG.length&&!tb)for(Na=0;Na<sa.hG.length;Na++)Xa=k(Sa),Xa.jc=new Float32Array(4),d.U.push(Xa),Fb=u("PLANE_REFLECT",Xa,!1,S,F,wb,Ra,null,a.vh),O.C(r,Fb),pc=v("COLOR","u_plane_reflection",a.Vj,1,
1,!0),pc.Na=fa.F,pc.Ma=fa.F,y.push(pc),sa.kE?(gc=u("PLANE_REFLECT_BLEND",Xa,!1,S,F,wb,Ra,null,a.vh),O.C(r,gc),ed=v("DEPTH","DEPTH",a.Vj,1,1,!0),Nc=v("COLOR","COLOR",a.Vj,1,1,!0),Nc.Na=fa.of,Nc.Ma=fa.of,O.m(r,Fb,gc,ed),O.m(r,Fb,gc,Nc),sa.gs.push([gc]),B.push(gc)):(jd=v("DEPTH","DEPTH",a.Vj,1,1,!0),Fb.Fa.push(jd),B.push(Fb)),sa.ng.push([Fb]);if(a.Ic){var xb=c();O.C(r,xb);vc=Ia.er;xb.k.width=vc;xb.k.height=vc;var yc=v("DEPTH","u_grass_map_depth",vc,1,1,!1);yc.Na=fa.F;yc.Ma=fa.F;var zc=v("COLOR","u_grass_map_color",
vc,1,1,!1);zc.Na=fa.F;zc.Ma=fa.F}else zc=yc=xb=null;if(Eb&&Xb){var Wc=k(Sa);d.U.push(Wc);var hc=m(Wc,F);O.C(r,hc);hc.self_shadow_normal_offset=Xb.self_shadow_normal_offset;for(Ua=0;Ua<A.length;Ua++)Fa=A[Ua],O.m(r,Fa,hc,w[Ua]);var Hc=v("COLOR","u_color",1,1,1,!0),td=v("DEPTH","u_depth",1,1,1,!0);if(ma){var kd=k(Sa);d.U.push(kd);var ld=a.RS,fd=Q(kd,wb,ld);O.C(r,fd);var ud=v("COLOR","u_ssao_mask",1,1,1,!0);O.m(r,hc,fd,Hc);O.m(r,hc,fd,td);var vd=k(Sa);d.U.push(vd);var eb=R(vd,ld);O.C(r,eb);var md=v("COLOR",
"u_shadow_mask",1,1,1,!0);O.m(r,fd,eb,ud);O.m(r,hc,eb,td)}ya?hc.Fa.push(v("DEPTH","DEPTH",1,1,1,!0)):hc.Fa.push(Mb);xb&&(O.m(r,xb,hc,yc),O.m(r,xb,hc,zc))}else hc=null;var yb=u("OPAQUE",Sa,!0,S,F,wb,Ra,null,a.vh);O.C(r,yb);if(ya){var Gb=z();O.C(r,Gb);t.push(Gb);var qc=v("COLOR","RESOLVE",1,1,1,!0);qc.ei=!0;qc.Ud=!0;var Va=v("DEPTH","RESOLVE",1,1,1,!0);Va.ei=!0;Va.Ud=!0;O.m(r,yb,Gb,qc);O.m(r,yb,Gb,Va)}else t.push(yb);hc&&(ud?O.m(r,eb,yb,md):Xb?O.m(r,hc,yb,v("COLOR","u_shadow_mask",1,1,1,!0)):pa.l("Internal error"));
xb&&(O.m(r,xb,yb,yc),O.m(r,xb,yb,zc));if(B.length)for(var Ab=B.length,Na=0;Na<Ab;Na++)O.m(r,B[Na],yb,y[Na]);if(H.length)for(Na=0;Na<H.length;Na++)O.m(r,H[Na],yb,C[Na]);n=t;t=[];if(!tb&&a.xM){Xa=k(Sa);d.U.push(Xa);var Hb=q(Xa,!1,F);O.C(r,Hb);if(a.Dh){Xa=k(Sa);d.U.push(Xa);var Bb=q(Xa,!0,F);O.C(r,Bb);O.m(r,Hb,Bb,v("COLOR","COLOR",1,1,1,!0));O.m(r,Hb,Bb,v("DEPTH","DEPTH",1,1,1,!0))}}else Hb=null;if(!ib.gd&&!Mc||tb)Ib=null;else{if(ya)Ib=Gb;else{var Ib=E();O.C(r,Ib);O.m(r,n[0],Ib,v("COLOR","COPY",1,1,
1,!0))}var Jb=v("COLOR","u_refractmap",1,1,1,!0)}if(Eb&&(Mc||ca||oa)){var rc=k(Sa);d.U.push(rc);var Zb=V(rc);O.C(r,Zb);O.m(r,ya?Gb:yb,Zb,v("DEPTH","u_depth",1,1,1,!0));var sc=v("COLOR","u_scene_depth",1,1,1,!0);sc.Na=fa.of;sc.Ma=fa.of}else Zb=null;if(a.dr){var pb=l("BLEND");t.push(pb);n=t;t=[]}if(a.Yg){var rb=k(Sa);d.U.push(rb);var Pa=u("GLOW",rb,!1,S,F,wb,Ra);O.C(r,Pa);Zb&&O.m(r,Zb,Pa,sc);Ib&&O.m(r,Ib,Pa,Jb);xb&&(O.m(r,xb,Pa,yc),O.m(r,xb,Pa,zc));if(B.length)for(Ab=B.length,Na=0;Na<Ab;Na++)O.m(r,
B[Na],Pa,y[Na]);if(H.length)for(Na=0;Na<H.length;Na++)O.m(r,H[Na],Pa,C[Na]);O.m(r,ya?Gb:yb,Pa,ya?ob:Mb);var bb=p("X_GLOW_BLUR");bb.sb="GLOW_MASK_SMALL";bb.wh=a.Xh.small_glow_mask_width;var lc=v("COLOR","u_color",1,1,1,!0);lc.Na=fa.F;lc.Ma=fa.F;O.C(r,bb);O.m(r,Pa,bb,lc);var gb=p("Y_GLOW_BLUR");gb.sb="GLOW_MASK_SMALL";gb.wh=a.Xh.small_glow_mask_width;var wc=v("COLOR","u_color",1,.5,.5,!0);wc.Na=fa.F;wc.Ma=fa.F;O.C(r,gb);O.m(r,bb,gb,wc);var Cb=p("X_GLOW_BLUR");Cb.sb="GLOW_MASK_LARGE";Cb.wh=a.Xh.large_glow_mask_width;
var hb=v("COLOR","u_color",1,.5,.5,!0);hb.Na=fa.F;hb.Ma=fa.F;O.C(r,Cb);O.m(r,gb,Cb,hb);var Ub=p("Y_GLOW_BLUR");Ub.sb="GLOW_MASK_LARGE";Ub.wh=a.Xh.large_glow_mask_width;var ic=v("COLOR","u_color",1,.25,.25,!0);ic.Na=fa.F;ic.Ma=fa.F;O.C(r,Ub);O.m(r,Cb,Ub,ic);var Ec=k(Sa);d.U.push(Ec);var jb=G(Ec,a);O.C(r,jb);var Wa=v("COLOR","u_src_color",1,1,1,!0);if(a.dr)if(ya){var $b=z();O.C(r,$b);O.m(r,pb,$b,qc);O.m(r,pb,$b,Va);O.m(r,$b,jb,Wa)}else O.m(r,pb,jb,Wa);else O.m(r,ya?Gb:yb,jb,Wa);O.m(r,a.dr?pb:yb,jb,
Mb);var va=v("COLOR","u_glow_mask_small",1,.5,.5,!0);va.Na=fa.F;va.Ma=fa.F;O.m(r,gb,jb,va);var Nb=v("COLOR","u_glow_mask_large",1,.25,.25,!0);Nb.Na=fa.F;Nb.Ma=fa.F;O.m(r,Ub,jb,Nb);n=[jb];t=[]}a.dr||(pb=l("BLEND"),t.push(pb),n=t,t=[]);if(ua.debug_view){Xa=k(Sa);d.U.push(Xa);var Ya=D(Xa);t.push(Ya);O.C(r,Ya);O.m(r,n[0],Ya,oc);O.m(r,n[0],Ya,Mb);xb&&(O.m(r,xb,Ya,yc),O.m(r,xb,Ya,zc));ga.MR(Ya);n=t;t=[]}if(ya){var Ob=z();O.C(r,Ob);t.push(Ob);O.m(r,n[0],Ob,qc);O.m(r,n[0],Ob,Va);n=t;t=[]}var Qa=n.slice(0);
if(!tb&&a.FK){Xa=k(Sa);d.U.push(Xa);var kb=I(Xa);O.C(r,kb);O.m(r,n[0],kb,ya?ob:Mb)}if(za&&Eb&&!tb){var jc=Cc.ul,ub=Cc.Uw,Ta=Cc.hm,Za=n[0],cb=S?!0:!1,sb=v("DEPTH","u_input",1,1,1,!0);sb.Na=fa.F;sb.Ma=fa.F;var ac=v("COLOR","u_input",1,.25,.25,!0);ac.Na=fa.F;ac.Ma=fa.F;var Pb=jc/Ta,$a=k(Sa);d.U.push($a);var db=ka($a,cb,jc,!0,Pb,F,Ta);O.C(r,db);O.m(r,Za,db,sb);var Pb=jc/Ta*.5,mb=k(Sa);d.U.push(mb);var qb=ka(mb,cb,jc,!1,Pb,F,Ta);O.C(r,qb);O.m(r,db,qb,ac);var Pb=jc/Ta*.25,zb=k(Sa);d.U.push(zb);var gd=ka(zb,
cb,jc,!1,Pb,F,Ta);O.C(r,gd);O.m(r,qb,gd,ac);var Vb=la(ub,F);t.push(Vb);O.C(r,Vb);O.m(r,Za,Vb,v("COLOR","u_main",1,1,1,!0));O.m(r,gd,Vb,v("COLOR","u_god_rays",1,1,1,!0));n=t;t=[]}if(Sb&&!tb){var Za=n[0],Ic=U();O.C(r,Ic);O.m(r,Za,Ic,v("COLOR","u_input",1,1,1,!0));var kc=ea();O.C(r,kc);kc.k.width=ua.Dn?2:1;kc.k.height=ua.Dn?2:1;var tc=v("COLOR","u_input",1,.25,.25,!0);tc.Na=fa.F;tc.Ma=fa.F;var bc=v("COLOR","u_luminance",1,.25,.25,!0);bc.Na=fa.F;bc.Ma=fa.F;O.m(r,Ic,kc,tc);var mc=Sb.key,Ac=Sb.JN,Jc=k(Sa);
d.U.push(Jc);var xc=Ca(mc,Ac,F,Jc);O.C(r,xc);O.m(r,Za,xc,v("COLOR","u_main",1,1,1,!0));O.m(r,Ic,xc,bc);O.m(r,kc,xc,v("COLOR","u_average_lum",1,1,1,!1));var cc=v("COLOR","u_color",1,.25,.25,!0);cc.Na=fa.F;cc.Ma=fa.F;bb=N("X_BLUR");O.C(r,bb);O.m(r,xc,bb,cc);gb=N("Y_BLUR");O.C(r,gb);O.m(r,bb,gb,cc);var Qb=ba(Sb.blur);O.C(r,Qb);var Oc=v("COLOR","u_bloom",1,.25,.25,!0);Oc.Na=fa.F;Oc.Ma=fa.F;O.m(r,gb,Qb,Oc);O.m(r,Za,Qb,v("COLOR","u_main",1,1,1,!0));t.push(Qb);n=t;t=[]}if(nc&&Eb&&!tb){var Za=n[0],dc=k(Sa);
d.U.push(dc);cc=v("COLOR","u_color",1,1,1,!0);cc.Na=fa.F;cc.Ma=fa.F;var ec=p("X_BLUR");O.C(r,ec);O.m(r,Za,ec,cc);var Wb=p("Y_BLUR");O.C(r,Wb);O.m(r,ec,Wb,cc);var nd=Qa[0],Bc=Y(dc);dc.dof_distance=f.dof_distance;dc.je=f.je;dc.dof_front=f.dof_front;dc.dof_rear=f.dof_rear;dc.dof_power=f.dof_power;dc.dof_on=!0;t.push(Bc);O.C(r,Bc);O.m(r,Za,Bc,v("COLOR","u_sharp",1,1,1,!0));O.m(r,Wb,Bc,v("COLOR","u_blurred",1,1,1,!0));O.m(r,nd,Bc,v("DEPTH","u_depth",1,1,1,!0));n=t;t=[]}if(a.Dh){var Xc=l("XRAY");t.push(Xc);
n=t;t=[]}if(Yb&&!tb){var wd=n[0],Pc=Z(Gc.mb_decay_threshold,Gc.mb_factor);t.push(Pc);O.C(r,Pc);O.m(r,wd,Pc,v("COLOR","u_mb_tex_curr",1,1,1,!0));Pc.Fa.push(v("COLOR","u_mb_tex_accum",1,1,1,!0));n=t;t=[]}if(!tb&&a.outline){var Za=n[0],od=k(Sa);d.U.push(od);var Yc=ia(od,F);O.C(r,Yc);var vb=p("X_EXTEND"),xd=v("COLOR","u_color",1,1,1,!0),Kc=v("COLOR","u_outline_mask",1,1,1,!0);vb.ho=!0;O.C(r,vb);O.m(r,Yc,vb,xd);var Zc=v("COLOR","u_color",1,.5,.5,!0);Zc.Na=fa.F;Zc.Ma=fa.F;var Qc=p("Y_EXTEND");Qc.ho=!0;
O.C(r,Qc);O.m(r,vb,Qc,Zc);ec=p("X_BLUR");ec.ho=!0;O.C(r,ec);O.m(r,Qc,ec,Zc);var $c=v("COLOR","u_color",1,.25,.25,!0);$c.Na=fa.F;$c.Ma=fa.F;var Fc=v("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Fc.Na=fa.F;Fc.Ma=fa.F;Wb=p("Y_BLUR");Wb.ho=!0;O.C(r,Wb);O.m(r,ec,Wb,$c);var Rc=ha(Vc);O.C(r,Rc);O.m(r,Za,Rc,v("COLOR","u_outline_src",1,1,1,!0));O.m(r,Yc,Rc,Kc);O.m(r,Wb,Rc,Fc);t.push(Rc);n=t;t=[]}b(r,Eb);if((a.anaglyph_use||a.ao)&&!tb){var yd=J(r,a,d,n[0]);t.push(yd);n=t;t=[]}if(uc&&!tb){var Za=n[0],ad=W(Tb.brightness,
Tb.contrast,Tb.exposure,Tb.saturation);O.C(r,ad);O.m(r,Za,ad,v("COLOR","u_color",1,1,1,!0));t.push(ad);n=t;t=[]}if(Rb){Za=n[0];if(ua.smaa){var Sc=v("COLOR","u_color",1,1,1,!0);Sc.Na=fa.F;Sc.Ma=fa.F;var bd=ja("SMAA_EDGE_DETECTION",a);O.C(r,bd);O.m(r,Za,bd,Sc);var Lc=ja("SMAA_BLENDING_WEIGHT_CALCULATION",a);O.C(r,Lc);O.m(r,bd,Lc,Sc);var hd=v("COLOR","u_search_tex",1,1,1,!1),cd=v("COLOR","u_area_tex",1,1,1,!1);hd.Na=fa.F;hd.Ma=fa.F;cd.Na=fa.F;cd.Ma=fa.F;Lc.Fa.push(hd);Lc.Fa.push(cd);var Tc=ja("SMAA_NEIGHBORHOOD_BLENDING",
a);O.C(r,Tc);O.m(r,Za,Tc,Sc);var dd=v("COLOR","u_blend",1,1,1,!0);dd.Na=fa.F;dd.Ma=fa.F;O.m(r,Lc,Tc,dd);t.push(Tc)}else{var pd=X(a);O.C(r,pd);var Ad=v("COLOR","u_color",1,1,1,!0);Ad.Na=fa.F;Ad.Ma=fa.F;O.m(r,Za,pd,Ad);t.push(pd)}n=t;t=[]}var Nd=O.Ff(r,n[0]);if("MOTION_BLUR"==n[0].type||"RESOLVE"==n[0].type)var Bd=!0;else Bd=!1,O.wg(r,Nd,function(a,c,b){if(b.from==b.to)return Bd=!0});if(Bd){var Cd=p("NONE");O.C(r,Cd);O.m(r,n[0],Cd,v("COLOR","u_color",1,1,1,!0));t.push(Cd);n=t;t=[]}t.push(n[0]);Hb&&
(Bb?t.push(Bb):t.push(Hb));kb&&t.push(kb);if(!tb&&a.Ps.procedural_skydome){var Id=da(F,a.Ps);O.C(r,Id);t.push(Id)}var Uc=aa();O.C(r,Uc);for(Ua=0;Ua<t.length;Ua++){var qd=t[Ua];switch(qd.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":O.m(r,qd,Uc,v("COLOR","NONE",1,1,1,!0));O.m(r,qd,Uc,v("DEPTH","NONE",1,1,1,!0));break;case "SKY":O.m(r,qd,Uc,v("CUBEMAP","u_sky",Ia.tn,1,1,!1));break;case "ANCHOR_VISIBILITY":O.m(r,qd,Uc,v("COLOR","NONE",1,1,1,!0));break;default:if(tb){var Jd=h[0].j,rd=v("COLOR",
"OFFSCREEN",1,1,1,!0);rd.Ja=Jd;O.m(r,t[Ua],Uc,rd);for(Na=1;Na<h.length;Na++){var Kd=h[Na].j,Dd=p("NONE");O.C(r,Dd);O.m(r,t[Ua],Dd,v("COLOR","SCALE",1,1,1,!0));var Ld=Kd.ek/Jd.ek,rd=v("COLOR","OFFSCREEN",1,Ld,Ld,!0);rd.Ja=Kd;O.m(r,Dd,Uc,rd)}}else O.m(r,t[Ua],Uc,v("SCREEN","NONE",1,1,1,!0))}}Gb&&!ra(r,Gb).length&&(O.Jf(r,O.Ff(r,Gb)),O.rv(r));b(r,Eb);e(r,Eb);if(Ea.enabled){var Md=L(r);Md&&M(r,Md)}g(r);x(r);Xb&&O.ma(r,function(a,c){if("SHADOW_RECEIVE"==c.type||"MAIN_BLEND"==c.type||"MAIN_XRAY"==c.type){for(var b=
0,d=Aa(r,c),e=0,f=0;f<d.length;f++){var h=d[f];"SHADOW_CAST"==h.type&&(e++,c.Tj=c.Tj||[],c.Tj[0<h.Lf?h.Lf:b]=h.k.Bb,b++)}c.mt&&c.lt||(ua.Hr?c.rz=new Float32Array(9*e):(c.mt=new Float32Array(4*e),c.lt=new Float32Array(4*e)))}});return r};a.DQ=C;a.v_=d;a.we=function(a,c,b){var d=a.wh;a.fz[0]=c*a.Ib[0]*d;a.fz[1]=b*a.Ib[1]*d};a.jd=function(a,c){a.wh=c};a.WM=function(){var a=O.create(),c=d("PERFORMANCE");subs.Zb=!0;var b=T.pc(T.zc);b.width=1024;b.height=1024;c.k=b;O.C(a,c);b=aa();O.C(a,b);O.m(a,c,b,v("COLOR",
"NONE",1024,1,1,!1));g(a);x(a);return a};a.fO=function(a){var c=null;O.ma(a,function(a,b){return b.k&&null===b.k.Ve?(c=b,!0):!1});return c};a.tb=function(a,c,b){a=Aa(a,c);for(c=0;c<a.length;c++)if(a[c].type===b)return a[c];return null};a.a_=ca;a.d_=S;a.XO=Aa;a.ZO=ra;a.Nb=function(a,c){var b=null;O.ma(a,function(a,d){return d.type==c?(b=d,!0):!1});return b};a.rN=function(a){var c="digraph scenegraph {\n",c=c+"    ",c=c+'size="11.7,16.5";\n',c=c+"    ",c=c+'ratio="fill";\n',c=c+"    ",c=c+'node [shape=box margin="0.25,0.055"];\n',
b=za(a);O.ma(a,function(a,d){var e=c+="    ",f="",f=d.type.replace(/_/g," ");"POSTPROCESSING"==d.type&&(f+=" ("+d.hs.replace(/_/g," ")+")");if(d.k){for(var f=f+"\\n",h=0;h<b.length;h+=2){var g=d.k.Wb;b[h]==g&&(f=fa.ll(g)?f+("CR"+b[h+1]+" "):f+("C"+b[h+1]+" "))}for(h=0;h<b.length;h+=2)g=d.k.he,b[h]==g&&(f=fa.ll(g)?f+("DR"+b[h+1]):f+("D"+b[h+1]))}d.Fa.length&&(f+="\\n-----\\n");for(h=0;h<d.Fa.length;h++)f+=ma(d.Fa[h],b);h="SINK"==d.type?"dotted":d.cd?"solid":"dashed";c=e+(String(a)+' [label="'+f+'" color="black" style="'+
(h+",bold")+'"];\n')});O.Of(a,function(a,d,e){c+="    ";c+=String(a)+" -> "+String(d)+' [label="'+ma(e,b)+'" style="'+(e.Ub?"solid":"dotted")+'"];\n'});return c+="}"};a.ZM=function(a){a=O.iT(a);for(var c=[],b=0;b<a.length;b++){var d=a[b];d.cd&&c.push(d)}return c}};b4w.module.__shaders=function(a,n){function k(a,d,e){var f=a.Qg;"string"==typeof e&&(a=b(a,e))&&(e=a[1]);for(a=0;a<f.length;a++)if(f[a][0]==d){f[a][1]=e;return}f.push([d,e])}function b(a,b){for(var d=a.Qg,e=0;e<d.length;e++)if(d[e][0]==b)return d[e];return!1}function e(a,b){var d=a+b;if(H[d])return H[d];if(K){var e=K[b];if(!e)return null;e=n("__gpp_parser").l0.parse(e)}else if(e=n("shader_texts")[b],!e)return null;return H[d]=e}function y(a,b,d){function f(b){b=b.b;for(var d=0;d<b.length;d++){var m=
b[d];switch(m.type){case "condition":a:for(var m=m.b,p=0;p<m.length;p++){var x=m[p];switch(x.type){case "if":case "elif":if(h(x.d)){f(x.group);break a}break;case "else":f(x.group);break a;case "ifdef":x.name in n&&f(x.group);break;case "ifndef":x.name in n||f(x.group)}}break;case "include":m=e(J.shaders_dir,J.BS+m.file);f(m);break;case "var":case "export":case "import":break;case "define":p=m.name;n[p]=m.a;m.Ea&&(t[p]=m.Ea);break;case "error":F.l("Shader error: #error "+m.a.join(" "));break;case "line":break;
case "pragma":r.push("#pragma "+m.name+" "+m.a.join(" "));break;case "undef":m=m.name;delete n[m];delete t[m];break;case "warning":M.warn("Shader warning: #warning "+m.a.join(" "));break;case "extension":m=g(m.a,n,t,!1);r.push("#extension "+m.join(" "));break;case "#":break;case "node":A[m.name]=m;break;case "nodes_global":m=v;for(p=0;p<m.length;p++){var x=m[p],K=A[x.id];if(K)for(var E=0,P=0;P<K.h.length;P++){var C=K.h[P];if("node_param"==C.type){var N;if("PARTICLE_INFO"==x.id&&C.c)if(1==n.PARTICLE_BATCH)switch(N=
!1,E){case 0:N=l(x.Mb,"PART_INFO_IND")||l(x.Mb,"PART_INFO_AGE")||l(x.Mb,"PART_INFO_LT")||l(x.Mb,"PART_INFO_SIZE");break;case 1:N=l(x.Mb,"PART_INFO_LOC");break;case 2:N=l(x.Mb,"PART_INFO_VEL");break;case 3:N=l(x.Mb,"PART_INFO_A_VEL");break;case 4:N=l(x.Mb,"PART_INFO_IND")}else N=!1;else N=!0;N&&(C=C.qualifier.join(" ")+" ","vert"==a?C+=x.Hi[E]:"frag"==a&&(C+=x.Ea[E],null!==x.Zr[E]&&(C+=" = "+x.Zr[E])),C+=";",r.push(C));E++}}}break;case "nodes_main":m=v;for(p=0;p<m.length;p++)if(x=m[p],K=A[x.id]){E=
{};P={};for(C=0;C<x.Mb.length;C++)P[x.Mb[C][0]]=[x.Mb[C][1]];H=y=B=0;C=x;N=K.h;for(var L=E,X=P,aa=0;aa<N.length;aa++){var ca=N[aa];switch(ca.type){case "node_in":var S=C.L[B];if(null!==C.Tw[B]){if(("MATERIAL_BEGIN"==C.id&&3===B||!X.MATERIAL_EXT&&("MATERIAL_BEGIN"==C.id&&4===B||"MATERIAL_END"==C.id&&3===B||"MATERIAL_END"==C.id&&4===B||"MATERIAL_END"==C.id&&5===B)||"TEXTURE_COLOR"==C.id||"TEXTURE_NORMAL"==C.id)&&ca.c){L[ca.name]=C.Tw[B];B++;continue}var Aa=ca.qualifier.join(" ")+" ",Aa=Aa+S,Aa=Aa+(" = "+
C.Tw[B]),Aa=Aa+";";r.push(Aa)}L[ca.name]=S;B++;break;case "node_out":S=C.Sa[y];if(!ca.c||-1<w.indexOf(S))Aa=ca.qualifier.join(" ")+" ",Aa+=S,Aa+=";",r.push(Aa),L[ca.name]=S;-1<w.indexOf(S)&&(X["USE_OUT_"+ca.name]=[1]);y++;break;case "node_param":"vert"==a?S=C.Hi[H]:"frag"==a&&(S=C.Ea[H]),L[ca.name]=S,H++}}r.push("{");k(x,K.f,E,P);r.push("}")}break;case "textline":m=g(m.a,n,t,!1);r.push(m.join(" "));break;default:F.l("Unknown element type: "+m.type)}}}function h(a,c){var b;b=g(a,n,t,!0,c);for(var d=
[],e=0;e<b.length;e++)if(b[e]instanceof Object)switch(b[e].type){case "conditional_expr":var f=d.pop(),m=d.pop();d.pop()?d.push(m):d.push(f);break;case "logical_or_expr":f=d.pop();for(m=0;m<b[e].e-1;m++)l=d.pop(),f=f||l;d.push(f);break;case "logical_and_expr":f=d.pop();for(m=0;m<b[e].e-1;m++)l=d.pop(),f=f&&l;d.push(f);break;case "logical_bitor_expr":f=d.pop();for(m=0;m<b[e].e-1;m++)f|=d.pop();d.push(f);break;case "logical_bitxor_expr":f=d.pop();for(m=0;m<b[e].e-1;m++)f^=d.pop();d.push(f);break;case "logical_bitand_expr":f=
d.pop();for(m=0;m<b[e].e-1;m++)f&=d.pop();d.push(f);break;case "equal_expr":f=d.pop();m=d.pop();d.push(m==f);break;case "non_equal_expr":f=d.pop();m=d.pop();d.push(m!=f);break;case "le_expr":f=d.pop();m=d.pop();d.push(m<=f);break;case "ge_expr":f=d.pop();m=d.pop();d.push(m>=f);break;case "l_expr":f=d.pop();m=d.pop();d.push(m<f);break;case "g_expr":f=d.pop();m=d.pop();d.push(m>f);break;case "left_shift_expr":m=d.pop();f=d.pop();d.push(m<<f);break;case "right_shift_expr":m=d.pop();f=d.pop();d.push(m>>
f);break;case "add_expr":m=d.pop();f=d.pop();d.push(m+f);break;case "sub_expr":m=d.pop();f=d.pop();d.push(m-f);break;case "mul_expr":m=d.pop();f=d.pop();d.push(m*f);break;case "div_expr":m=d.pop();f=d.pop();d.push(m/f);break;case "mod_expr":m=d.pop();f=d.pop();d.push(m%f);break;case "pre_inc_expr":case "post_inc_expr":l=d.pop();d.push(++l);break;case "pre_dec_expr":case "post_dec_expr":l=d.pop();d.push(--l);break;case "positive_expr":l=d.pop();d.push(+l);break;case "negative_expr":l=d.pop();d.push(-l);
break;case "one_compl_expr":l=d.pop();d.push(~l);break;case "logic_negative_expr":l=d.pop();d.push(!l);break;default:F.l("Unknown operation type: "+b[e].type)}else{var l=b[e];/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(l)?d.push(0):d.push(parseFloat(b[e]))}1==d.length?b=d[0]:(F.l("Incorrect expression: "+b.join(" ")),b=void 0);return b}function k(a,c,b,d){for(var e=0;e<c.length;e++){var f=c[e];switch(f.type){case "node_condition":a:for(var m=a,f=f.b,l=b,p=d,v=0;v<f.length;v++){var q=f[v];switch(q.type){case "node_if":case "node_elif":if(h(q.d,
p)){k(m,q.f,l,p);break a}break;case "node_else":k(m,q.f,l,p);break a;case "node_ifdef":(q.name in n||q.name in p)&&k(m,q.f,l,p);break;case "node_ifndef":q.name in n||q.name in p||k(m,q.f,l,p)}}break;case "textline":m=[];for(l=0;l<f.a.length;l++)p=f.a[l],p in b?m.push(b[p]):m.push(p);m=g(m,n,t,!0,d);r.push(m.join(" "))}}}var v=d.Mj;d=d.Qg||[];for(var r=[],n={},m=0;m<d.length;m++)n[d[m][0]]=[d[m][1]];for(m=0;m<v.length;m++)n["USE_NODE_"+v[m].id]=[1];var t={},A={},w=[];for(m in v)for(var x in v[m].L)w.push(v[m].L[x]);
f(b);var B=0,y=0,H=0;return r.join("\n")}function g(a,b,d,e,f){var h=[];B(a,b,d,e,h,f);return h}function B(a,b,d,e,f,h){for(var g=0;g<a.length;g++){var l=a[g];l in b||h&&l in h?(l=h&&h[l]||b[l],0==l.length&&e?f.push(0):B(l,b,d,e,f,h)):f.push(l)}}function w(a,b,d,e){e=a.createShader(e);a.shaderSource(e,d);a.compileShader(e);L.jM(e,b,d);return e}function t(a){v.deleteProgram(a.Pl);v.deleteShader(a.xz);v.deleteShader(a.UC);delete C[a.AS]}function f(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return r(a);
case 2:return"vec2("+r(a[0])+","+r(a[1])+")";case 3:return"vec3("+r(a[0])+","+r(a[1])+","+r(a[2])+")";case 4:return"vec4("+r(a[0])+","+r(a[1])+","+r(a[2])+","+r(a[3])+")";case 9:return"mat3("+r(a[0])+","+r(a[1])+","+r(a[2])+","+r(a[3])+","+r(a[4])+","+r(a[5])+","+r(a[6])+","+r(a[7])+","+r(a[8])+")";case 16:return"mat4("+r(a[0])+","+r(a[1])+","+r(a[2])+","+r(a[3])+","+r(a[4])+","+r(a[5])+","+r(a[6])+","+r(a[7])+","+r(a[8])+","+r(a[9])+","+r(a[10])+","+r(a[11])+","+r(a[12])+","+r(a[13])+","+r(a[14])+
","+r(a[15])+")";default:F.l("Wrong glsl value dimension")}}function r(a){return a%1?String(a):String(a)+".0"}function l(a,b){for(var d=0;d<a.length;d++)if(a[d][0]==b)return!0;return!1}var A=n("__assets"),x=n("__config"),L=n("__debug"),M=n("__print"),F=n("__util"),J=x.qd,C={},H={},K=null,d="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std_enums.glsl include/to_world.glslv include/wind_bending.glslv".split(" "),
h=[],v=null,P=!1;a.xe=function(a){v=a};a.V=k;a.OO=b;a.A_=function(a,b){for(var d=a.Qg,e=0;e<d.length;e++)if(d[e][0]==b&&1==d[e][1])return!0;return!1};a.NR=function(a){a.Qg=[];for(var b="ALPHA ALPHA_CLIP ANAGLYPH BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEBUG_VIEW_SPECIAL_SKYDOME DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT USE_FOG WEBGL2 WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS NUM_CAST_LAMPS SUN_NUM MAC_OS_SHADOW_HACK USE_COLOR_RAMP HALO_PARTICLES PARTICLE_BATCH HAS_REFRACT_TEXTURE".split(" "),
d=0;d<b.length;d++){var e=b[d],h;switch(e){case "ALPHA":case "ALPHA_CLIP":case "ANAGLYPH":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEBUG_VIEW_SPECIAL_SKYDOME":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "USE_FOG":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":case "NUM_CAST_LAMPS":case "SUN_NUM":case "MAC_OS_SHADOW_HACK":case "USE_COLOR_RAMP":case "HALO_PARTICLES":case "PARTICLE_BATCH":case "HAS_REFRACT_TEXTURE":h=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":h=1;break;case "WEBGL2":h=x.v.ld|0;break;case "EPSILON":h="highp"==x.v.precision?1E-6:1E-4;break;case "SHADOW_TEX_RES":h=f(2048);break;case "AA_METHOD":h="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":h="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":h="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":h=
"POST_EFFECT_NONE";break;case "SHADOW_USAGE":h="NO_SHADOWS";break;case "SSAO_QUALITY":h="SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":h="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":h="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":h=x.v.precision;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":h="u_va_frame_factor";break;default:M.error("Unknown directive ("+a.vm+", "+a.Yk+"): "+e)}k(a,e,h)}};a.QZ=function(a){return a.vm};a.RY=function(a){return a.Yk};a.t_=function(a,d){for(var e=d.Qg,f=0;f<
e.length;f++){var h=e[f][0],g=e[f][1];b(a,h)&&k(a,h,g)}};a.KO=function(a){var b=JSON.stringify(a),d=C[b];if(d)return d;var f=a.Yk,d=e(J.shaders_dir,a.vm),f=e(J.shaders_dir,f);if(!d||!f)return null;var h=y("vert",d,a),g=y("frag",f,a),d=v,l=w(d,b,h,d.VERTEX_SHADER),k=w(d,b,g,d.FRAGMENT_SHADER),f=d.createProgram();d.attachShader(f,l);d.attachShader(f,k);d.linkProgram(f);d.validateProgram(f);d.getProgramParameter(f,d.VALIDATE_STATUS)==d.WU&&M.error("shader program is not valid",b);L.kM(f,b,l,k,h,g);a=
{xz:l,UC:k,Pl:f,attributes:{},fk:{},zo:[],Mx:{},Pr:!0,Ax:!1,SH:[],Tb:F.Oh(a),AS:b,Nh:!0};g=d.getProgramParameter(f,d.ACTIVE_ATTRIBUTES);for(h=0;h<g;h++)l=d.getActiveAttrib(f,h).name,a.attributes[l]=d.getAttribLocation(f,l);g=d.getProgramParameter(f,d.ACTIVE_UNIFORMS);for(h=0;h<g;h++)l=d.getActiveUniform(f,h).name.split("[0]").join(""),a.fk[l]=d.getUniformLocation(f,l);return C[b]=d=a};a.gQ=function(){P=!1;if(b4w.module_check("shader_texts"))P=!0;else{for(var a=[],b=A.ut,e=0;e<d.length;e++){var f=
F.qo(J.shaders_dir+d[e]);a.push({id:d[e],type:b,url:f})}b=function(a,c){K||(K={});K[c]=a};a.length?A.cd(a,b,function(){P=!0}):M.error("Shaders have not been found.")}};a.lM=function(){return P};a.xX=function(){return h};a.mD=function(){return C};a.ha=function(){for(var a in C)t(C[a]);for(var b in H)delete H[b];for(var d in h)delete h[d]};a.vM=t;a.yX=function(a){var b=a.Qg;M.log("Shader: "+a.vm+" "+a.Yk+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)M.log("  "+b[a][0],b[a][1])};a.H=
f;a.IB=function(a,b){return b in a.fk?!0:!1};a.fP=function(a){return(v.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__assets=function(a,n){function k(){return L.uE()?n(L.qd.iq).data:null}function b(){var a={Rp:null,CK:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var d=b.length,e=new Int8Array(d),f=0;f<d;f++)e[f]=b.charCodeAt(f);return e.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,d){a.Rp=d;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=k();b&&a.Rp in b&&(a.status=200,b[a.Rp]&&(a.response=a.CK(b[a.Rp])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function e(c){for(var b=0,e=0;e<c.length;e++){var h=c[e];20===h.state&&b++;if(b>=d.wQ)break;if(10===h.state)switch(h.state=20,b++,h.type){case a.lp:y(h,"arraybuffer");break;case a.pk:y(h,"json");break;case a.ut:y(h,"text");break;case a.Mz:g(h);break;case a.mp:B(h);break;case a.Nz:w(h);break;case a.op:t(h);break;
case a.np:f(h);break;default:C.l("Wrong asset type: "+h.type)}}}function y(c,d){var e=k(),f=e&&c.url in e?new b:new XMLHttpRequest,e=null;if("GET"==c.qg)f.open("GET",c.url,!0);else if("POST"==c.qg)switch(f.open("POST",c.url,!0),c.Ol){case a.Jz:e="text/plain";break;case a.Iz:e="application/json"}if(c.hi)for(var h in c.hi)"Content-Type"==h?e=c.hi[h]:f.setRequestHeader(h,c.hi[h]);e&&f.setRequestHeader("Content-Type",e);"text"==d?(f.overrideMimeType("text/plain"),f.responseType="text"):"json"==d?(f.overrideMimeType("application/json"),
f.responseType="text"):f.responseType=d;f.onreadystatechange=function(){if(40!=c.state&&4==f.readyState){if(200==f.status||0==f.status){var a=f.response;if(a){if("json"==d&&"string"==typeof a)try{a=JSON.parse(a,c.OP)}catch(b){F.error(b+" (parsing JSON "+c.url+")");c.oc(null,c.id,c.type,c.url,c.Hb);return}c.oc(a,c.id,c.type,c.url,c.Hb)}else F.error("empty responce when trying to get "+c.url),c.oc(null,c.id,c.type,c.url,c.Hb)}else F.error(f.status+" when trying to get "+c.url),c.oc(null,c.id,c.type,
c.url,c.Hb);c.state=30}};f.addEventListener("progress",function(a){a.lengthComputable&&c.WF(a.loaded/a.total)},!1);f.send(c.Wj)}function g(a){"GET"!=a.qg&&C.l("Unsupported request type for audio buffer");var d=k(),e=d&&a.url in d?new b:new XMLHttpRequest;e.open("GET",a.url,!0);e.responseType="arraybuffer";e.onreadystatechange=function(){if(40!=a.state&&4==e.readyState)if(200==e.status||0==e.status){var b=e.response;b?J.vN(b,function(b){a.oc(b,a.id,a.type,a.url,a.Hb);a.state=30},function(){a.oc(null,
a.id,a.type,a.url,a.Hb);F.error("failed to decode "+a.url);a.state=30}):(a.oc(null,a.id,a.type,a.url,a.Hb),F.error("empty responce when trying to get "+a.url),a.state=30)}else a.oc(null,a.id,a.type,a.url,a.Hb),F.error(e.status+" when trying to get "+a.url),a.state=30};e.send(a.Wj)}function B(a){"GET"!=a.qg&&C.l("Unsupported request type for image element");var b=document.createElement("img");K.allow_cors&&(b.crossOrigin="Anonymous");b.onload=function(){40!=a.state&&(a.oc(b,a.id,a.type,a.url,a.Hb),
a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.oc(null,a.id,a.type,a.url,a.Hb),F.error("could not load image: "+a.url),a.state=30)},!1);var d=k();if(d&&a.url in d)if(d[a.url]){var e=l(a.url);b.src="data:"+e+";base64,"+d[a.url]}else M.jo()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),b.dispatchEvent(d);else b.src=a.url}function w(a){"GET"!=a.qg&&C.l("Unsupported request type for audio element");var b=document.createElement("audio");
K.allow_cors&&(b.crossOrigin="Anonymous");b.addEventListener("loadeddata",function(){40!=a.state&&(a.oc(b,a.id,a.type,a.url,a.Hb),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.oc(null,a.id,a.type,a.url,a.Hb),F.error("could not load sound: "+a.url),a.state=30)},!1);b.addEventListener("stalled",function(){40!=a.state&&(a.oc(null,a.id,a.type,a.url,a.Hb),F.error("could not load sound: "+a.url),a.state=30)},!1);var d=k();if(d&&a.url in d)if(d[a.url]){var e=A(a.url);b.src="data:"+
e+";base64,"+d[a.url];40!=a.state&&(a.oc(b,a.id,a.type,a.url,a.Hb),a.state=30)}else M.jo()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),b.dispatchEvent(d);else b.src=a.url,K.zf&&b.load();K.tx&&(b.autoplay=!0,b.pause());setTimeout(function(){b.IS=1},5E3)}function t(a){function b(){40!=a.state&&(a.oc(null,a.id,a.type,a.url),F.error("could not load video: "+a.url,a.Hb),a.state=30)}"GET"!=a.qg&&C.l("Unsupported request type for video element");
var d=document.createElement("video");d.muted=!0;if(K.allow_cors||K.zf)d.crossOrigin="Anonymous";d.addEventListener("loadeddata",function(){d.removeEventListener("error",b,!1);40!=a.state&&(a.oc(d,a.id,a.type,a.url,a.Hb),a.state=30)},!1);d.addEventListener("error",b,!1);var e=k();if(e&&a.url in e)if(e[a.url]){var f=x(a.url);d.src="data:"+f+";base64,"+e[a.url];40!=a.state&&d.addEventListener("loadeddata",function(){a.oc(d,a.id,a.type,a.url,a.Hb);a.state=30},!1)}else M.jo()?(e=document.createEvent("CustomEvent"),
e.initCustomEvent("error",!1,!1,null)):e=new CustomEvent("error"),d.dispatchEvent(e);else d.src=a.url,K.zf&&d.load();K.tx&&(d.autoplay=!0,d.pause());setTimeout(function(){d.IS=1},1E4)}function f(c){function d(a){c.oc(a,c.id,c.type,c.url,c.Hb);c.state=30}"GET"!=c.qg&&C.l("Unsupported request type for seq video element");var e=k(),f=e&&c.url in e?new b:new XMLHttpRequest;if(null==c.Ol&&null==c.Wj)f.open("GET",c.url,!0);else switch(f.open("POST",c.url,!0),c.Ol){case a.Jz:f.setRequestHeader("Content-type",
"text/plain");break;case a.Iz:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=c.state&&4==f.readyState)if(200==f.status||0==f.status){var a=f.response;a?r(a,d):(c.oc(null,c.id,c.type,c.url,c.Hb),F.error("empty responce when trying to get "+c.url),c.state=30)}else c.oc(null,c.id,c.type,c.url,c.Hb),F.error(f.status+" when trying to get "+c.url),c.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&c.WF(a.loaded/
a.total)},!1);f.send(c.Wj)}function r(a,b){for(var d=new Int32Array(a),e=new Int8Array(a),f=d[3],h={images:[],oB:[],Vg:d[4]},g=20,l=0;l<f;l++){var k=d[g/4],m=new Blob([e.subarray(g+4,g+4+k)],{type:"image/jpg"}),v=document.createElement("img");v.src=window.URL.createObjectURL(m);h.images.push(v);h.oB.push(m);g+=k+8-k%4}v.onload=function(){for(var a=0;a<h.images.length;a++)window.URL.revokeObjectURL(h.images[a].src);delete h.oB;b(h)}}function l(a){var b="image";switch(C.Cw(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function A(a){var b="audio";switch(C.Cw(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function x(a){var b="video";switch(C.Cw(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var L=n("__config"),M=n("__compat"),F=n("__print"),J=n("__sfx"),C=n("__util"),H=n("__version"),K=L.v,d=L.Ne;a.lp=10;a.pk=
20;a.ut=30;a.Mz=40;a.mp=50;a.Nz=60;a.op=70;a.np=80;a.Iz=a.pk;a.Jz=a.ut;var h=[],v=0,P={};a.Wo=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.EZ=function(a){if(P[a])return P[a];var b=d.prevent_caching?a+H.timestamp():a,e=new XMLHttpRequest;e.overrideMimeType("text/plain");e.open("GET",b,!1);e.send(null);if(200==e.status||0==e.status){b=e.responseText;if(b.length)return P[a]=b;C.l("Error XHR: responce is empty, GET "+a)}else C.l("Error XHR: "+
e.status+", GET "+a)};a.ha=function(){for(var a=0;a<h.length;a++)h[a].state=40;h=[];v=0;P={}};a.cd=function(a,b,f,g,l){for(var r=0;r<a.length;r++){var q=a[r],q={id:q.id,type:q.type,url:q.url,qg:q.qg?q.qg:"GET",Ol:q.Ol?q.Ol:null,hi:q.hi?q.hi:null,Wj:q.Wj?q.Wj:null,Hb:q.Hb?q.Hb:null,state:10,oc:b||function(){},JF:f||function(){},WF:g||function(){},OP:l||null,KF:v};if(d.prevent_caching){var n=k();n&&q.url in n||(q.url+=H.timestamp())}h.push(q)}e(h);v++};a.update=function(){e(h);for(var a=h,b=0,d=!0,
f=0;f<a.length;f++){var g=a[f];g.KF===a[b].KF?30!==g.state&&(d=!1):(d&&(a[f-1].JF(),d=f-b,a.splice(b,d),f-=d),b=f,d=30===a[f].state?!0:!1);f===a.length-1&&d&&(a[f].JF(),a.splice(b))}};a.gM=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a?!0:!1}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",b:[{type:"var",name:"ANCHOR_NUM",a:["0"]},{type:"include",file:"math.glslv"},{type:"textline",a:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; void main ( ) { gl_Position = u_view_proj_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",
name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",
a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"std_enums.glsl"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"color_util.glslf"},
{type:"include",file:"math.glslv"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],
group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_OUTLINE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_color_id",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",b:[{type:"if",d:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_OUTLINE"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",
"ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bC ; varying vec4 bD ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"varying vec4 bI ; varying vec4 bJ ; varying vec4 bK ; varying vec4 bL ; uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform sampler2D u_shadow_map0 ; uniform sampler2D u_shadow_map1 ; uniform sampler2D u_shadow_map2 ; uniform sampler2D u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",a:"void main ( ) { mat4 qT , qU , qV , qW , qX ; float qY , qZ ; vec4 q_ ; vec3 ra , rb , rc , rd ;".split(" ")},
{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:"ra = u_camera_eye_frag - bC ; ra = normalize ( ra ) ; qT = mat4 ( 0.0 ) ; qU = mat4 ( 0.0 ) ; qV = mat4 ( 0.0 ) ; qW = mat4 ( 0.0 ) ; qX = mat4 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"qT = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:"qU = O ( u_view_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"qV = O ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:"qW = O ( u_model_zup_tsr ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"qX = O ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"textline",a:"qS ( ra , qT , qU , qV , qW , qX , rb , rc , rd , q_ , qY ) ; qY = qY ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"qY = ( texture2D ( u_sampler , bM ) ) . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"qZ = u_alpha_factor * qY ; qZ += ( 1.0 - step ( 0.0 , qZ ) ) ; qY = mix ( qZ , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"qY = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( qY < 0.5 ) discard ; qY = 1.0 ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["USE_OUTLINE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["color_id.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},
{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3",
"a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},
{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",
d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],
group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",
d:["BILLBOARD","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform",
"PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bC ; varying vec4 bD ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",
b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec4 tB ; float tC , tD , tE ; vec3 tF , tG , tH , tI , tJ , tK ; mat4 tL , tM , tN ; tL = O ( u_view_tsr ) ; tF = a_position ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["tG","=","a_normal",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tH = vec3 ( a_tangent ) ; tI = a_tangent [ 3 ] * cross ( tG , tH ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"tH = vec3 ( 0.0 ) ; tI = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tG = vec3 ( 0.0 ) ; tH = vec3 ( 0.0 ) ; tI = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"tF = mix ( tF , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"tG = mix ( tG , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tJ = vec3 ( a_tangent ) ; tK = a_tangent_next [ 3 ] * cross ( a_normal_next , tJ ) ; tH = mix ( tH , tJ , u_va_frame_factor ) ; tI = mix ( tI , tK , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sH ( tF , tH , tI , tG ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["tI","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tI = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tM = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",
b:[{type:"textline",a:"tH = ( tM * vec4 ( tI , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tN = rA ( u_camera_eye , tH , tL , tM ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tN = ru ( u_camera_eye , tH , tL ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tN = tN * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , tH ) ;".split(" ")}]}}]},{type:"textline",a:"c tO = rH ( tF - tI , tI , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tN ) ; tO . b = tH ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c tO = rH ( tF , tI , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tM ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tv ( tO . a , tO . b , tG ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["tG","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tG = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tv ( tO . a , tO . b , tG ) ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"bM = rK ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bC = tO . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"bE = tO . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tC = ( dot ( cross ( tO . e , tO . c ) , tO . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( tO . c , tC ) ;".split(" ")}]}}]},{type:"textline",a:"bD = tL * vec4 ( tO . a , 1.0 ) ; tB = u_proj_matrix * bD ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:"tB . xy += u_subpixel_jitter * tB . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tC = tB . x ; tD = tB . y ; tE = tB . w ; bG . x = ( tC + tE ) / 2.0 ; bG . y = ( tD + tE ) / 2.0 ; bG . z = tE ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - bD . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["tA","(",")",";"]}]}}]},{type:"textline",a:"gl_Position = u_proj_matrix * tL * vec4 ( tO . a , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={type:"group",b:[{type:"define",name:"DV_NONE",a:["0"]},{type:"define",name:"DV_OPAQUE_WIREFRAME",a:["1"]},{type:"define",name:"DV_TRANSPARENT_WIREFRAME",a:["2"]},{type:"define",
name:"DV_FRONT_BACK_VIEW",a:["3"]},{type:"define",name:"DV_DEBUG_SPHERES",a:["4"]},{type:"define",name:"DV_CLUSTERS_VIEW",a:["5"]},{type:"define",name:"DV_BATCHES_VIEW",a:["6"]},{type:"define",name:"DV_RENDER_TIME",a:["7"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},
{type:"textline",a:"varying vec3 tB ; const float tC = 1.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"const vec3 tD = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"const vec3 tD = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"const vec3 tE = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 tF = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 tG = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 tH = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 tI = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"float tL ( ) { vec3 tJ ; float tK ; tK = 1.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["WIREFRAME_QUALITY",0,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tJ = sign ( tB - vec3 ( 0.02 * tC ) ) ; if ( tJ . x < 0.0 || tJ . y < 0.0 || tJ . z < 0.0 ) tK = 0.0 ;".split(" ")}]}},{type:"elif",d:["WIREFRAME_QUALITY",1,{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"extension",a:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",a:"tJ = fwidth ( tB ) ; tJ = smoothstep ( vec3 ( 0.0 ) , tJ * tC , tB ) ; tK = min ( min ( tJ . x , tJ . y ) , tJ . z ) ; tK = clamp ( tK , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["return","tK",";","}"]}]}}]},{type:"textline",a:"void main ( ) { float tM , tN , tO , tP ; vec3 tQ , tR ; tQ = vec3 ( 0.0 ) ; tM = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",b:[{type:"textline",
a:"tR = sign ( tB - vec3 ( 0.02 * tC ) ) ; if ( tR . x < 0.0 || tR . y < 0.0 || tR . z < 0.0 ) { tQ = tD ; tM = 1.0 ; } else discard ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { tN = tL ( ) ; tQ = vec3 ( mix ( u_wireframe_edge_color , tG , tN ) ) ; tM = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { tN = tL ( ) ; tQ = u_wireframe_edge_color ; tM = mix ( 1.0 , 0.0 , tN ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { tN = tL ( ) ; if ( gl_FrontFacing ) tQ = mix ( u_wireframe_edge_color , tE , tN ) ; else tQ = mix ( u_wireframe_edge_color , tF , tN ) ; tM = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { tN = u_cluster_id + u_debug_colors_seed + 2.0 ; tQ = vec3 ( fract ( tN * 19.73 ) , fract ( tN * 6.34 ) , fract ( tN * 1.56 ) ) ; tM = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { tN = u_batch_debug_id_color + u_debug_colors_seed ; tQ = vec3 ( fract ( tN * 19.73 ) , fract ( tN * 6.34 ) , fract ( tN * 1.56 ) ) ; tM = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { ; if ( u_debug_render_time_threshold > 0.0 ) tN = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else tN = 1.0 ; tO = clamp ( 2.0 * tN , 0.0 , 1.0 ) ; tP = clamp ( 2.0 * tN - 1.0 , 0.0 , 1.0 ) ; tN = tN ; tQ = mix ( tH , tI , vec3 ( tO , tP , tN ) ) ; tM = 1.0 ; }".split(" ")}]}}]},
{type:"textline",a:["bu","(","tQ",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"textline",a:"bx ( tQ , tM ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( tQ , tM ) ; }".split(" ")}]};a["debug_view.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],
group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",
";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{type:"textline",a:["varying","vec3","tB",";"]},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec3 uh , ui , uj , uk , ul ; mat4 um , un , uo ; if ( a_polyindex == 0.0 ) tB = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) tB = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) tB = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEBUG_VIEW_SPECIAL_SKYDOME"],group:{type:"group",b:[{type:"textline",a:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"um = O ( u_view_tsr ) ; un = O ( u_model_tsr ) ; uh = a_position ; ui = a_normal ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",b:[{type:"textline",a:"c up = rH ( uh , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , un ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"uh = mix ( uh , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uj = vec3 ( 0.0 ) ; uk = vec3 ( 0.0 ) ; sH ( uh , uj , uk , ui ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",
b:[{type:"textline",a:["uk","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uk = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"c up = ug ( uh , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , uk , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , um ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"uj = ( un * vec4 ( uk , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uo = rA ( u_camera_eye , uj , um , un ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uo = ru ( u_camera_eye , uj , um ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"ul = ( un * vec4 ( uk , 1.0 ) ) . xyz ; uo = uo * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ul ) ;".split(" ")}]}}]},{type:"textline",a:"c up = rH ( uh - uk , uk , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , uo ) ; up . b = uj ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c up = rH ( uh , uk , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , un ) ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"tv ( up . a , up . b , ui ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"gl_Position = u_proj_matrix * um * vec4 ( up . a , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["grass_map.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",
b:[{type:"textline",a:["varying","vec4","uh",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["varying","float","uh",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","uh",";"]}]}}]}]}}]},{type:"textline",a:["void","main","(",")","{"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",b:[{type:"textline",a:["gl_FragColor","=","uh",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( uh , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 , uh ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",
a:["}"]}]};a["grass_map.glslv"]={type:"group",b:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_grass_size",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","uh",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["varying","float","uh",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","uh",";"]}]}}]}]}}]},{type:"textline",a:"void main ( ) { vec4 ui ; vec3 uj ; mat4 uk , ul , um ; uk = O ( u_view_tsr ) ; ul = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"uj = ( ul * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; um = ru ( u_camera_eye , uj , uk ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"um = um * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"c un = rH ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , um ) ; un . b = uj ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c un = rH ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ul ) ;".split(" ")}]}}]},
{type:"textline",a:"ui = u_proj_matrix * uk * vec4 ( un . a , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:"uh = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uh","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",b:[{type:"textline",a:["uh","=","a_grass_color",";"]}]}}]}]}}]},{type:"textline",a:["gl_Position","=","ui",";","}"]}]};a["halo.glslf"]={type:"group",b:[{type:"var",name:"NUM_LINES",a:["0"]},{type:"var",name:"NUM_RINGS",a:["0"]},{type:"var",name:"NUM_STARS",a:["0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 ui ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying float uj ;".split(" ")},
{type:"include",file:"color_util.glslf"},{type:"include",file:"halo_color.glslf"},{type:"textline",a:"void main ( ) { float uV ; vec3 uW ; vec4 uX ; uX = uU ( ) ; uW = uX . rgb ; uV = uX . a ; bu ( uW ) ; bx ( uW , uV ) ; gl_FragColor = vec4 ( uW , uV ) ; }".split(" ")}]};a["halo.glslv"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; attribute float a_random_vals ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; varying vec2 bM ; varying float uj ;".split(" ")},
{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","ui",";"]}]}}]},
{type:"textline",a:"void main ( ) { vec4 uV , uW ; vec3 uX ; mat4 uY , uZ , u_ ; uY = O ( u_view_tsr ) ; uZ = O ( u_model_tsr ) ; uX = ( uZ * vec4 ( a_position , 1.0 ) ) . xyz ; bM = a_halo_bb_vertex * 2.0 ; uj = a_random_vals ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"uZ = qZ ( uX , uY ) ; u_ = uY ; u_ [ 3 ] [ 0 ] = 0.0 ; u_ [ 3 ] [ 1 ] = 0.0 ; u_ [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"uZ = qZ ( uX , uY ) ;".split(" ")}]}}]},{type:"textline",a:"uV = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; uV = uZ * uV ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"uW = u_proj_matrix * u_ * uV ; uW . z = 0.99999 * uW . w ;".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["ui","=","uV",
";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uW = u_proj_matrix * uY * uV ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","uW",";","}"]}]};a["line.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform vec4 u_diffuse_color ; void main ( ) { float uV ; vec3 uW ; uW = u_diffuse_color . xyz ; uV = u_diffuse_color . a ; bu ( uW ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],
group:{type:"group",b:[{type:"textline",a:"bx ( uW , uV ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( uW , uV ) ; }".split(" ")}]};a["line.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ;".split(" ")},
{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"void main ( ) { mat2 uV ; float uW ; vec2 uX , uY ; vec4 uZ ; mat4 u_ , va ; u_ = O ( u_view_tsr ) ; va = O ( u_model_tsr ) ; c vb = rH ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , va ) ; uZ = u_proj_matrix * u_ * vec4 ( vb . a , 1.0 ) ; uZ . xyz /= uZ . w ; uX = ( u_proj_matrix * u_ * vec4 ( vb . e , 0.0 ) ) . xy ; uW = M_PI / 2.0 ; uV = mat2 ( cos ( uW ) , sin ( uW ) , - sin ( uW ) , cos ( uW ) ) ; uX = uV * normalize ( uX ) ; uY = ( u_line_width / u_height ) * vec2 ( u_proj_matrix [ 0 ] [ 0 ] / u_proj_matrix [ 1 ] [ 1 ] , 1.0 ) ; gl_Position = vec4 ( uZ . xy + uX . xy * uY / 2.0 , uZ . z , 1.0 ) ; gl_Position *= uZ . w ; }".split(" ")}]};
a["main.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"PARALLAX_STEPS",a:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",
name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",
";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],
group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],
group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:4}],
group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D",
"u_nodes_texture",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",
{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"nodes.glslf"},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec2 vB ; mat4 vC , vD , vE , vF , vG ; vec4 vH ; vec3 vI , vJ , vK , vL , vM ; float vN , vO , vP ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",
e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vN = length ( bD ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"vO = bC . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["vI","=","u_sun_intensity",";"]}]}}]},{type:"textline",a:"vJ = normalize ( u_camera_eye_frag - bC ) ; vC = mat4 ( 0.0 ) ; vD = mat4 ( 0.0 ) ; vE = mat4 ( 0.0 ) ; vF = mat4 ( 0.0 ) ; vG = mat4 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vC = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:"vD = O ( u_view_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"vE = O ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],
group:{type:"group",b:[{type:"textline",a:"vF = O ( u_model_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"vG = O ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"textline",a:"qS ( vJ , vC , vD , vE , vF , vG , vK , vL , vM , vH , vP ) ; vK = vK ; vP = vP ; vM = vM ; vH = vH ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WETTABLE"],group:{type:"group",b:[{type:"textline",a:"vK = max ( vK - sqrt ( 0.01 * - min ( vO , 0.0 ) ) , 0.5 * vK ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"textline",a:"bp ( vK , vO , u_time , vH , vM , u_sun_direction , vI , u_sun_quaternion , bC , vN ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( vP < 0.5 ) discard ; vP = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["vP","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"vA ( vK , length ( bD ) , vJ , vO ) ;".split(" ")}]}},{type:"else",
group:{type:"group",b:[{type:"textline",a:"vA ( vK , length ( bD ) , vJ , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vB = texture2DProj ( u_shadow_mask , bG ) . rg ; vO = vB . g ; vK = vec3 ( vO ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","vK",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",
e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( vK , vP ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( vK , vP ) ; }".split(" ")}]};a["main.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"NUM_CAST_LAMPS",a:["0"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},
{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:7}],group:{type:"group",b:[{type:"textline",a:["attribute",
"vec3","a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER",
"vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:"uniform mat4 u_view_matrix ; uniform mat3 u_view_tsr ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr",";"]}]}}]},{type:"textline",a:["uniform","mat4","u_proj_matrix",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"BILLBOARD","DYNAMIC_GRASS",{type:"logical_or_expr",e:3}],
group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],
group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_normal_offset",";"]},{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},
{type:"textline",a:["uniform","mat4","u_p_light_matrix0",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",
e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:7}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE",
"SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",
a:["varying","vec3","vB",";"]},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","vC",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",
b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2},
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec4 vP , vQ ; float vR ; vec3 vS , vT , vU , vV , vW , vX , vY ; mat4 vZ , v_ , wa , wb ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["vZ","=","u_view_matrix",";"]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",
b:[{type:"textline",a:"v_ = O ( u_view_tsr ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vZ = O ( u_view_tsr ) ;".split(" ")}]}}]},{type:"textline",a:"wa = O ( u_model_tsr ) ; vS = a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"NODES",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:6}],group:{type:"group",
b:[{type:"textline",a:["vT","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vT = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vU = vec3 ( a_tangent ) ; vV = a_tangent [ 3 ] * cross ( vT , vU ) ;".split(" ")}]}},{type:"elif",
d:["NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vW = ( wa * vec4 ( a_position , 1.0 ) ) . xyz ; vX = normalize ( ( wa * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vW = vW - u_camera_eye ; vV = cross ( vW , vX ) ; vU = cross ( vX , vV ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vU = vec3 ( 0.0 ) ; vV = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"vS = mix ( vS , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"vT = mix ( vT , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],
group:{type:"group",b:[{type:"textline",a:"vX = vec3 ( a_tangent ) ; vW = a_tangent_next [ 3 ] * cross ( a_normal_next , vX ) ; vU = mix ( vU , vX , u_va_frame_factor ) ; vV = mix ( vV , vW , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sH ( vS , vU , vV , vT ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",
a:["vW","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vW = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"c wc = ug ( vS , vU , vV , vT , vW , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , vZ ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",
a:"vX = ( wa * vec4 ( vW , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"wb = rA ( u_camera_eye , vX , vZ , wa ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"wb = ru ( u_camera_eye , vX , vZ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"vY = ( wa * vec4 ( vW , 1.0 ) ) . xyz ; wb = wb * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vY ) ;".split(" ")}]}}]},{type:"textline",a:"c wc = rH ( vS - vW , vW , vU , vV , vT , wb ) ; wc . b = vX ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c wc = rH ( vS , vW , vU , vV , vT , wa ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"vR = ( dot ( cross ( wc . e , wc . c ) , wc . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( wc . c , vR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"tv ( wc . a , wc . b , vT ) ;".split(" ")}]}}]},{type:"textline",a:"bC = wc . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"bE = wc . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"vB = u_camera_eye - wc . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"bM = rK ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],
group:{type:"group",b:[{type:"textline",a:"vC = wc . f ;".split(" ")}]}},{type:"elif",d:["VERTEX_COLOR"],group:{type:"group",b:[{type:"textline",a:["vC","=","a_color",";"]}]}}]}]}}]},{type:"textline",a:"vP = vZ * vec4 ( wc . a , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:"vQ = v_ * vec4 ( wc . a , 1.0 ) ; bD = vQ ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["bD","=","vP",";"]}]}}]}]}}]},{type:"textline",a:"vQ = u_proj_matrix * vP ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",
a:"vQ . xy += u_subpixel_jitter * vQ . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"bG = L ( vQ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vO ( wc . a , wc . e ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - vP . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:["tA","(",")",";"]}]}}]},{type:"textline",a:["gl_Position","=","vQ",";","}"]}]};a["main_stack.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",
a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"PARALLAX_STEPS",a:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",
a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"},
{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",
a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],
group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_colormap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC","ALPHA_AS_SPEC",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK"],
group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_normal_factor",
";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",b:[{type:"textline",a:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",a:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","PARALLAX",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_parallax_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_refr_bump",";"]}]}}]},{type:"textline",a:"varying vec3 bC ; varying vec3 bE ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",
{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"textline",a:["varying","vec3","vB",";"]},{type:"condition",
b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","vC",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",
1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4",
"bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",
b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"lighting_nodes.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",
file:"fog.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec4 xU , xV , xW , xX ; mat4 xY ; mat3 xZ ; vec2 x_ , ya , yb , yc ; vec3 yd , ye , yf , yg , yh , yi , yj , yk , yl ; float ym , yn , yo , yp , yq ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"ym = length ( bD ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"yn = bC . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",
b:[{type:"textline",a:["yd","=","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["x_","=","bM",";"]}]}}]},{type:"textline",a:"ye = normalize ( bE ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!","gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"ye = ye ; else ye = - ye ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:"yf = cross ( ye , bF . xyz ) * bF . w ; xZ = mat3 ( bF . xyz , yf , ye ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFRACTIVE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xY = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"ya = normalize ( xY * vec4 ( bE , 0.0 ) ) . st ; ya = ya * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ym < PARALLAX_LOD_DIST ) { yo = clamp ( 0.5 * ( PARALLAX_LOD_DIST - ym ) , 0.0 , 1.0 ) ; yo = u_parallax_scale * yo ; yf = normalize ( vB * xZ ) ; yp = 1.0 / PARALLAX_STEPS ; yb = yf . xy * yo / ( PARALLAX_STEPS * yf . z ) ; yo = 1.0 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["yc","=","ya",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["yc","=","x_",";"]}]}}]},{type:"textline",a:"yq = texture2D ( u_normalmap0 , yc ) . a ; for ( float yr = 1.0 ; yr <= PARALLAX_STEPS ; yr ++ ) { if ( yq < yo ) { yo -= yp ; yc -= yb ; yq = texture2D ( u_normalmap0 , yc ) . a ; } } yb = yc + yb ; yp = texture2D ( u_normalmap0 , yb ) . a - ( yo + yp ) ; yo = yq - yo ; yp = yo / ( yo - yp ) ; yc = yp * yb + ( 1.0 - yp ) * yc ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"x_ += yc - ya ;".split(" ")}]}}]},{type:"textline",a:["ya","=","yc",";"]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"ya += yc - x_ ;".split(" ")}]}}]},{type:"textline",a:["x_","=","yc",";"]}]}}]},
{type:"textline",a:["}"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:[";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xU = texture2D ( u_normalmap0 , ya ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xU = texture2D ( u_normalmap0 , x_ ) ;".split(" ")}]}}]},{type:"textline",a:"yf = xU . rgb - 0.5 ; yf = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , yf , u_normal_factor ) ; yf = xZ * yf ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["yf","=","ye",";"]}]}}]},{type:"textline",a:"yf = normalize ( yf ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"ya = normalize ( xY * vec4 ( yf , 0.0 ) ) . st ; ya = ya * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:"ye = normalize ( vB ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"yg = vC ; br ( yg ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xU = vec4 ( yg , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["xU","=","u_diffuse_color",";"]}]}}]},{type:"textline",a:["yp","=","1.0",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"xV = texture2D ( u_colormap0 , ya ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xV = texture2D ( u_colormap0 , x_ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",b:[{type:"textline",a:"br ( xV . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",b:[{type:"textline",a:[";"]},
{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xW = texture2D ( u_colormap1 , ya ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xW = texture2D ( u_colormap1 , x_ ) ;".split(" ")}]}}]},{type:"textline",a:"br ( xW . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"xX = texture2D ( u_stencil0 , ya ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xX = texture2D ( u_stencil0 , x_ ) ;".split(" ")}]}}]},{type:"textline",a:"xV = mix ( xV , xW , xX . r ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xU . rgb = mix ( xU . rgb , xV . rgb , u_diffuse_color_factor ) ; yo = u_alpha_factor * xV . a ; yo += ( 1.0 - step ( 0.0 , yo ) ) ; xU . a = mix ( yo , 1.0 , u_diffuse_color . a ) ; yp = xV . a ;".split(" ")}]}},
{type:"elif",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xU . rgb *= mix ( vec3 ( 1.0 ) , xV . rgb , u_diffuse_color_factor ) ; xU . a = xV . a ; yp = xV . a ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS"],group:{type:"group",b:[{type:"textline",a:"yg = xU . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"yh = u_diffuse_intensity * xU . rgb ; yi = u_environment_energy * dS ( yf ) ; yi = u_ambient * yi ; xV = du ( yh ) ; yj = u_emit * xU . rgb ; yk = u_specular_color ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["ALPHA_AS_SPEC"],group:{type:"group",b:[{type:"textline",a:"yl = vec3 ( yp ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"yl = texture2D ( u_specmap0 , ya ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"yl = texture2D ( u_specmap0 , x_ ) . rgb ;".split(" ")}]}}]},
{type:"textline",a:"br ( yl . rgb ) ; yk = mix ( yk , yl , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",a:"yp = u_specular_params [ 0 ] ; x_ = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; yk = yp * yk ; xT ( yj , yi , yh , yk , bC , yf , ye , x_ , u_diffuse_params , xV , 0.0 , vec4 ( 0.0 ) , yg , yl ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},
{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"dP ( yg , ye , yf , u_reflect_factor , xY ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dP ( yg , ye , yf , u_reflect_factor , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",
b:[{type:"textline",a:"dP ( yg , ye , yf , 0.0 , xY ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dP ( yg , ye , yf , 0.0 , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["yg","+=","yl",";"]}]}}]},{type:"textline",a:"yp = xU . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WETTABLE"],group:{type:"group",b:[{type:"textline",a:"yg = max ( yg - sqrt ( 0.01 * - min ( yn , 0.0 ) ) , 0.5 * yg ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"textline",a:"bp ( yg , yn , u_time , xV , yf , u_sun_direction , yd , u_sun_quaternion , bC , ym ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( yp < 0.5 ) discard ; yp = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"yo = max ( max ( yl . r , yl . g ) , yl . b ) * u_specular_alpha ; yp = xU . a * ( 1.0 - yo ) + yo ;".split(" ")}]}}]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["yp","=","1.0",
";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"x_ = - ( xY * vec4 ( yf , 0.0 ) ) . xy ; yg = mix ( ef ( bG , x_ * u_refr_bump ) , yg , yp ) ; yp = 1.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"vA ( yg , ym , ye , yn ) ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:"vA ( yg , ym , ye , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:["bu","(","yg",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( yg , yp ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( yg , yp ) ; }".split(" ")}]};a["particle_system.glslf"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},
{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","NODES",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",a:["0"]},{type:"var",name:"SOFT_STRENGTH",a:["1.0"]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform",
"mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR",
"USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:7}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"textline",a:["varying","vec3","bE",";"]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"particles_nodes.glslf"},{type:"textline",a:"void main ( ) { mat4 Kv , Kw , Kx , Ky , Kz ; float KA , KB , KC ; vec4 KD ; vec3 KE , KF , KG , KH ; KE = normalize ( u_camera_eye_frag - bC ) ; Kv = mat4 ( 0.0 ) ; Kw = mat4 ( 0.0 ) ; Kx = mat4 ( 0.0 ) ; Ky = mat4 ( 0.0 ) ; Kz = mat4 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Kv = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:"Kw = O ( u_view_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"Kx = O ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:"Ky = O ( u_model_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"Kz = O ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"textline",a:"Ku ( KE , Kv , Kw , Kx , Ky , Kz , KF , KG , KH , KD , KA ) ; KF = KF ; KA = KA ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( KA < 0.5 ) discard ; KA = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["KA","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"vA ( KF , length ( bD ) , KE , 1.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"KB = - bD . z / u_view_max_depth ; KD = texture2DProj ( u_scene_depth , bG ) ; KC = Z ( KD ) ; KB = KC - KB ; KB = u_view_max_depth / SOFT_STRENGTH * KB ; KA = KA * min ( KB , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:["bu","(","KF",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( KF , KA ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( KF , KA ) ; }".split(" ")}]};a["particle_system.glslv"]={type:"group",b:[{type:"var",name:"BILLBOARD_ALIGN",a:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",a:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",a:["0"]},{type:"define",
name:"BILLBOARD_ALIGN_VIEW",a:["1"]},{type:"define",name:"BILLBOARD_ALIGN_XY",a:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",a:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",a:["4"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute vec3 a_p_data ; attribute vec4 a_p_vels ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["attribute","vec4","a_tangent",";"]}]}}]},{type:"textline",a:["attribute","vec2","a_p_bb_vertex",";"]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",a:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_view_matrix",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr",";"]}]}}]},{type:"textline",a:"uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",b:[{type:"if",d:["WORLD_SPACE",{type:"logic_negative_expr",e:1},"NODES","HALO_PARTICLES",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_COLOR_RAMP"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["varying","float","Kv",";"]}]}}]},
{type:"textline",a:["varying","vec3","vC",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:8}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec2","bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","vB",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","float","uj",";"]}]}}]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"particles.glslv"},
{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"particles_nodes.glslv"}]}}]},{type:"textline",a:"float Li ( vec2 Lg , vec2 Lh ) { return ( atan ( Lh . y , Lh . x ) - atan ( Lg . y , Lg . x ) ) ; } void main ( ) { vec3 Lj , Lk ; vec4 Ll , Lm , Ln ; float Lo , Lp , Lq ; mat4 Lr , Ls ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["Lr","=","u_view_matrix",";"]}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Lr = O ( u_view_tsr ) ;".split(" ")}]}}]},{type:"textline",a:"Kw Lt ; Lt = KY ( ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { Lo = Lt . e ; Ls = qZ ( Lt . b , Lr ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { Lo = Lt . e ; Ls = w ( ) ; Ls [ 3 ] = vec4 ( Lt . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { Lo = Lt . e ; Ls = A ( radians ( 90.0 ) ) ; Ls [ 3 ] = vec4 ( Lt . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { Lo = Li ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + Lt . e ; Ls = y ( radians ( - 90.0 ) ) ; Ls [ 3 ] = vec4 ( Lt . b , 1.0 ) ; } Ll = vec4 ( a_p_bb_vertex * 2.0 * Lt . a * u_p_size , 0.0 , 1.0 ) ; Lp = a_p_data [ 2 ] ; Lq = u_p_tilt * u_p_tilt_rand * ( 2.0 * Lp - 1.0 ) ; Lq = ( Lq + u_p_tilt ) * M_PI ; Ll = Ls * C ( Lq + Lo ) * Ll ; Lm = Lr * Ll ; Ln = u_proj_matrix * Lm ;".split(" ")},
{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["uj","=","Lp",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lj = vec3 ( a_tangent ) ; Lk = a_tangent [ 3 ] * cross ( a_normal , Lj ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Lj = vec3 ( 0.0 ) ; Lk = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"c Lu = rH ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Lj , Lk , vec3 ( 0.0 ) , Ls * C ( Lo ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lo = ( dot ( cross ( a_normal , Lu . c ) , Lu . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( Lu . c , Lo ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["bE","=","a_normal",";"]}]}}]},{type:"textline",a:"Lf ( Lt . b , Lt . f , Lt . g , Lt . h , Lt . a , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],
group:{type:"group",b:[{type:"textline",a:"bM = a_p_bb_vertex + 0.5 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"bM = a_p_bb_vertex * 2.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Kv = Lt . c ;".split(" ")}]}}]},{type:"textline",a:"vC = Lt . d ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"Lo = Ln . x ; Lp = Ln . y ; Lq = Ln . w ; bG . x = ( Lo + Lq ) / 2.0 ; bG . y = ( Lp + Lq ) / 2.0 ; bG . z = Lq ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["bD","=","Lm",";"]}]}}]},{type:"textline",a:"gl_Position = Ln ; bC = Ll . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vB = u_camera_eye - Ll . xyz ;".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["particle_system_stack.glslf"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},
{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","NODES",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",a:["0"]},{type:"var",name:"SOFT_STRENGTH",a:["1.0"]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",
{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"textline",a:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",
a:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{type:"textline",a:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:8}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",
b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["varying","float","Kv",";"]}]}}]},{type:"textline",a:["varying","vec3","vC",";"]}]}}]},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["varying","vec3","vB",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","float","uj",";"]},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","ui",";"]}]}}]}]}}]},
{type:"include",file:"lighting_nodes.glslf"},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"environment.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"include",file:"halo_color.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec2 Lg ; float Lh , Li , Lj ; vec4 Lk , Ll ; vec3 Lm , Ln , Lo , Lp , Lq , Lr , Ls , Lt ;".split(" ")},
{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lm = normalize ( vB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"Lk = uU ( ) ; Ln = Lk . rgb * vC ; Lh = 0.9 * length ( bM ) ; Lh = smoothstep ( u_p_alpha_start , u_p_alpha_end , Lh ) ; Lh = Lk . a * ( 1.0 - Lh ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["Lk","=","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"Ll = texture2D ( u_sampler , bM ) ; br ( Ll . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lk . rgb = mix ( Lk . rgb , Ll . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lk . rgb *= mix ( vec3 ( 1.0 ) , Ll . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",a:"Lk . a = Ll . a ;".split(" ")}]}}]},{type:"textline",a:"Lk . rgb *= vC ;".split(" ")},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Lo = u_diffuse_intensity * Lk . rgb ; Lp = u_emit * Lk . rgb ; Lq = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logic_negative_expr",e:1},"SKY_COLOR",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"Lr = u_environment_energy * dS ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lr = u_environment_energy * dS ( Lq ) ;".split(" ")}]}}]},{type:"textline",a:"Lr = u_ambient * Lr ; Li = u_specular_params [ 0 ] ; Lg = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; Ls = Li * u_specular_color ; xT ( Lp , Lr , Lo , Ls , bC , Lq , Lm , Lg , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , Ln , Lt ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Ln = Lk . rgb ;".split(" ")}]}}]},{type:"textline",a:"Lh = Lk . a * Kv ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( Lh < 0.5 ) discard ; Lh = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Lh","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"vA ( Ln , length ( bD ) , Lm , 1.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"Li = - bD . z / u_view_max_depth ; Lk = texture2DProj ( u_scene_depth , bG ) ; Lj = Z ( Lk ) ; Li = Lj - Li ; Li = u_view_max_depth / SOFT_STRENGTH * Li ; Lh = Lh * min ( Li , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","Ln",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( Ln , Lh ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( Ln , Lh ) ; }".split(" ")}]};a["procedural_skydome.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 Lg ; const float Lh = 0.99 ; const float Li = 1.8 ; const int Lj = 8 ; float Lp ( vec3 Lk , vec3 Ll ) { float Lm , Ln , Lo ; Lm = dot ( Ll , Ll ) ; Ln = 2.0 * dot ( Ll , Lk ) ; Lo = dot ( Lk , Lk ) - 1.0 ; Lm = Ln * Ln - 4.0 * Lm * Lo ; Lm = sqrt ( Lm ) ; Lm = ( - Ln - Lm ) / 2.0 ; Lm = Lo / Lm ; return Lm ; } float Lw ( float Lq , float Lr ) { float Ls , Lt , Lu , Lv ; Ls = 3.0 * ( 1.0 - Lr * Lr ) ; Lt = 2.0 * ( 2.0 + Lr * Lr ) ; Lu = 1.0 + Lq * Lq ; Lv = pow ( 1.0 + Lr * Lr - 2.0 * Lr * Lq , 1.5 ) ; Lv = max ( Lv , 0.00001 ) ; return ( Ls / Lt ) * ( Lu / Lv ) ; } float LC ( vec3 Lx , vec3 Ly , float Lz ) { vec3 LA ; float LB ; LB = dot ( Ly , - Lx ) ; if ( LB < 0.0 ) { return 1.0 ; } LA = Lx + LB * Ly ; if ( length ( LA ) < Lz ) { return 0.0 ; } else if ( length ( LA ) >= Lz ) { LA = normalize ( LA ) * Lz - Lx ; LB = acos ( dot ( normalize ( LA ) , Ly ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( LB * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 LG ( float LD , vec3 LE , float LF ) { return LE - LE * pow ( u_sky_color , vec3 ( LF / LD ) ) ; } void main ( ) { float LH , LI , LJ , LK , LL , LM , LN , LO , LP ; vec3 LQ , LR , LS , LT , LU , LV , LW ; LQ = normalize ( Lg ) ; LR = u_sun_direction ; LH = dot ( LQ , LR ) ; LI = Lw ( LH , - 0.01 ) * u_rayleigh_brightness * LR . y ; LJ = Lw ( LH - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - LR . y ) ; LH = smoothstep ( 0.0 , 100.0 , Lw ( LH , 0.9995 ) ) * u_spot_brightness ; LS = vec3 ( 0.0 , Lh , 0.0 ) ; LK = Lp ( LS , LQ ) ; LL = LK / float ( Lj ) ; LM = LC ( LS , LQ , Lh - 0.3 ) ; LT = vec3 ( 0.0 , 0.0 , 0.0 ) ; LU = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int LX = 0 ; LX < Lj ; LX ++ ) { LN = LL * float ( LX ) ; LV = LS + LQ * LN ; LO = LC ( LV , LR , Lh - 0.2 ) ; LP = Lp ( LV , LR ) ; LW = LG ( LP , vec3 ( Li ) , u_scatter_strength ) * LO ; LT += LG ( sqrt ( LN ) , u_sky_color * LW , u_rayleigh_strength ) ; LU += LG ( LN , LW , u_mie_strength ) ; } LT = LT * LM * pow ( LK , u_rayleigh_collection_power ) / float ( Lj ) ; LU = ( LU * LM * pow ( LK , u_mie_collection_power ) ) / float ( Lj ) ; LT = vec3 ( LH * LU + LJ * LU + LI * LT ) ; bu ( LT ) ; gl_FragColor = vec4 ( LT , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 Lg ; void main ( ) { vec4 Lh , Li ; Lh = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; Li = u_cube_view_matrix * Lh ; Lg = Li . xyz ; gl_Position = Lh ; }".split(" ")}]};a["shadow.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",
a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",
a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"condition",
b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1},"NODES","ALPHA",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]},
{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],
group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",
d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",b:[{type:"if",d:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",
e:1},"NODES","ALPHA",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["USE_REFRACTION"],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",a:"void main ( ) { mat4 Lh , Li , Lj , Lk , Ll ; float Lm , Ln ; vec4 Lo ; vec3 Lp , Lq , Lr , Ls ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:"Lp = u_camera_eye_frag - bC ; Lp = normalize ( Lp ) ; Lh = mat4 ( 0.0 ) ; Li = mat4 ( 0.0 ) ; Lj = mat4 ( 0.0 ) ; Lk = mat4 ( 0.0 ) ; Ll = mat4 ( 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lh = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:"Li = O ( u_view_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"Lj = O ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:"Lk = O ( u_model_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"Ll = O ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"textline",a:"qS ( Lp , Lh , Li , Lj , Lk , Ll , Lq , Lr , Ls , Lo , Lm ) ; Lm = Lm ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],
group:{type:"group",b:[{type:"textline",a:"Lm = ( texture2D ( u_colormap0 , bM ) ) . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Ln = u_alpha_factor * Lm ; Ln += ( 1.0 - step ( 0.0 , Ln ) ) ; Lm = mix ( Ln , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lm = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",
a:"if ( Lm < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","NO_SHADOWS",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = dr ( bD . z ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor . a *= clamp ( bF . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:["}"]}]};a["shadow.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"NUM_CAST_LAMPS",a:["0"]},{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",
a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND",
"DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1},
"TEXTURE_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",
a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1},"TEXTURE_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","float","u_normal_offset",";"]},{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{type:"textline",a:["uniform","mat4","u_p_light_matrix0",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1",
"NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}}]},{type:"include",file:"dynamic_grass.glslv"},
{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec2 Lh ; vec4 Li , Lj ; float Lk ; vec3 Ll , Lm , Ln , Lo , Lp , Lq ; mat4 Lr , Ls , Lt , Lu ; Lr = O ( u_view_tsr ) ; Ll = a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["Lm","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lm = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",
a:"Ln = vec3 ( a_tangent ) ; Lo = a_tangent [ 3 ] * cross ( Lm , Ln ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ln = vec3 ( 0.0 ) ; Lo = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"Ll = mix ( Ll , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"Lm = mix ( Lm , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"Lp = vec3 ( a_tangent ) ; Lq = a_tangent_next [ 3 ] * cross ( a_normal_next , Lp ) ; Ln = mix ( Ln , Lp , u_va_frame_factor ) ; Lo = mix ( Lo , Lq , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sH ( Ll , Ln , Lo , Lm ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["Lo","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lo = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",
a:"c Lv = ug ( Ll , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Lm , Lo , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , Lr ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ls = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"Ln = ( Ls * vec4 ( Lo , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["HAIR_BILLBOARD",{type:"logic_negative_expr",
e:1},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lt = O ( u_shadow_cast_billboard_view_tsr ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Lt","=","Lr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lu = rA ( u_camera_eye , Ln , Lt , Ls ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Lu = ru ( u_camera_eye , Ln , Lt ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lu = Lu * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , Ln ) ;".split(" ")}]}}]},{type:"textline",a:"c Lv = rH ( Ll - Lo , Lo , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Lm , Lu ) ; Lv . b = Ln ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"c Lv = rH ( Ll , Lo , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Lm , Ls ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["Lm","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lm = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tv ( Lv . a , Lv . b , Lm ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bC = Lv . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"bE = Lv . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",
a:"Lk = ( dot ( cross ( Lv . e , Lv . c ) , Lv . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( Lv . c , Lk ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"Li = Lr * vec4 ( Lv . a , 1.0 ) ; Lj = u_proj_matrix * Li ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:"Lj . xy += u_subpixel_jitter * Lj . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bG = L ( Lj ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - Li . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["tA","(",")",";"]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"bM = rK ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vO ( Lv . a , Lv . e ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["bD","=","Li",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lh = ( u_proj_matrix * Lr [ 3 ] ) . xy ; Lk = SHADOW_TEX_RES / 2.0 ; Lh = floor ( Lh * Lk + 0.5 ) / Lk - Lh ; Lj . xy += Lh ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","Lj",";","}"]}]};a["special_lens_flares.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},
{type:"textline",a:"uniform sampler2D u_sampler ; varying vec2 bM ; void main ( ) { vec4 Lh ; Lh = texture2D ( u_sampler , bM ) ; bu ( Lh . rgb ) ; bx ( Lh . rgb , Lh . a ) ; gl_FragColor = Lh ; }".split(" ")}]};a["special_lens_flares.glslv"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"define",name:"LIGHT_INDEX",a:["0"]},{type:"include",file:"math.glslv"},{type:"textline",a:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 bM ; void main ( ) { vec2 Lh ; float Li ; vec4 Lj ; vec3 Lk ; mat4 Ll ; Ll = O ( u_view_tsr ) ; bM = a_texcoord ; Lk = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; Lj = u_proj_matrix * Ll * vec4 ( Lk , 0.0 ) ; Lj . x /= Lj . w ; Lj . y /= Lj . w ; Lj += 99999.0 * step ( Lj . z , 0.0 ) ; Lj += 100.0 * ( step ( 1.0 , abs ( Lj . x ) ) + step ( 1.0 , abs ( Lj . y ) ) ) ; Lj . x = - a_lf_dist * Lj . x ; Lj . y = - a_lf_dist * Lj . y ; Li = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; Lh = vec2 ( a_lf_bb_vertex . x / Li , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float Lm = 1.9 ; Lh *= ( 1.0 + Lm * length ( Lj . xy ) ) ; } gl_Position = vec4 ( Lj . xy + Lh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"define",name:"INV_PI",a:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["WO_SKYTEX","PROCEDURAL_SKYDOME",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"blending.glslf"},{type:"textline",a:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 Nl ( vec3 Ng , vec3 Nh , float Ni , float Nj ) { float Nk ; Nk = Ni * Nj ;".split(" ")},{type:"condition",b:[{type:"if",d:["BLENDTYPE","MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lv ( Nh , Ng , Nk ) ;".split(" ")}]}},
{type:"elif",d:["BLENDTYPE","ADD",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lz ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SUBTRACT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LD ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LI ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SCREEN",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"return LN ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","OVERLAY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LS ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LW ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIVIDE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"return L_ ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DARKEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Md ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LIGHTEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mh ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","HUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mn ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",
d:["BLENDTYPE","SATURATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mt ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","VALUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mz ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","COLOR",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MF ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SOFT_LIGHT",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"return MK ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MO ( Nh , Ng , Nk ) ;".split(" ")}]}}]},{type:"textline",a:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Nt ( float Nm , float Nn , float No , float Np ) { float Nq ; vec3 Nr , Ns ; Nr = vec3 ( Nm ) , Ns = vec3 ( Nn ) ; Nq = No * Np ;".split(" ")},{type:"condition",b:[{type:"if",d:["BLENDTYPE","MIX",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lv ( Ns , Nr , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","ADD",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lz ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SUBTRACT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LD ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"return MU ( Nm , Nn , Nq , Np ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SCREEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return M_ ( Nm , Nn , Nq , Np ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","OVERLAY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Nf ( Nm , Nn , Nq , Np ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LW ( Nr , Ns , Nq ) . x ;".split(" ")}]}},
{type:"elif",d:["BLENDTYPE","DIVIDE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return L_ ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DARKEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Md ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LIGHTEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mh ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SOFT_LIGHT",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MK ( Ns , Nr , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MO ( Ns , Nr , Nq ) . x ;".split(" ")}]}}]},{type:"textline",a:["return","0.0",";","}"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"REFLECTION_PASS",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{type:"textline",a:["varying","vec3","Lg",";"]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",
e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:"void main ( ) { vec4 Nu ; float Nv , Nw , Nx ; vec3 Ny , Nz , NA , NB , NC ; Nz = normalize ( Lg ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME"],group:{type:"group",b:[{type:"textline",a:"Ny = textureCube ( u_sky , Nz ) . rgb ;".split(" ")}]}},{type:"elif",d:["WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"Ny = u_horizon_color ; bu ( Ny ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:[";"]},{type:"condition",b:[{type:"if",d:["WO_SKYPAPER"],group:{type:"group",b:[{type:"textline",a:"NA = vec3 ( bM , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NA = vec3 ( Lg . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:["Nv","=","0.0",";"]},{type:"condition",b:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["WO_SKYPAPER"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",b:[{type:"textline",a:"Nv = abs ( bM . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nv = ( bM . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nw = acos ( Nz . y ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",b:[{type:"textline",a:"Nv = abs ( Nw * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Nv = 1.0 - Nw * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",a:"NB = u_horizon_color ; NC = u_zenith_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYTEX"],group:{type:"group",b:[{type:"textline",a:"Nw = 1.0 ; Nu = textureCube ( u_sky , Nz ) ; br ( Nu . rgb ) ; Nw = Nu . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT"],group:{type:"group",b:[{type:"textline",a:"Nw = bB ( Nu ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["MTEX_NEGATIVE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Nu = vec4 ( vec3 ( 1.0 ) - Nu . rgb , Nu . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nw = 1.0 - Nw ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["MTEX_RGBTOINT"],group:{type:"group",b:[{type:"textline",a:"Nu = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nw = Nu . a ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_HORIZ"],group:{type:"group",b:[{type:"textline",a:"NB = Nl ( Nu . rgb , NB , Nw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["Nx","=","0.0",";"]},{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",b:[{type:"textline",a:"if ( dot ( NA , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP"],group:{type:"group",b:[{type:"textline",a:"Nx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:[";"]}]}}]},{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["WOMAP_ZENDOWN"],group:{type:"group",b:[{type:"textline",
a:"else Nx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP"],group:{type:"group",b:[{type:"textline",a:"Nx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",d:["WOMAP_ZENDOWN"],group:{type:"group",b:[{type:"textline",a:"Nx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",a:"if ( Nx != 0.0 ) NC = Nl ( Nu . rgb , NC , Nw , Nx ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_BLEND"],
group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Nw = dot ( Nu . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",a:"Nv = Nt ( u_sky_tex_dvar , Nv , Nw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",b:[{type:"textline",a:"Ny = mix ( NB , NC , Nv ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["Ny","=","NB",";"]}]}}]},{type:"textline",a:["bu","(","Ny",")",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"bu ( NB ) ; bu ( NC ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",b:[{type:"textline",a:"Ny = mix ( NB , NC , Nv ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Ny","=","NB",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"REFLECTION_PASS",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"br ( Ny ) ; Nv = WATER_LEVEL - u_camera_eye_frag . y ; NB = vec3 ( 0.0 ) ; NB = mix ( u_underwater_fog_color_density . rgb , NB , min ( - Nz . y , 1.0 ) ) ; NB *= min ( 1.0 - min ( 0.03 * Nv , 0.8 ) , 1.0 ) ; Nv = clamp ( sign ( 0.01 * Nv - Nz . y ) , 0.0 , 1.0 ) ; Ny = mix ( Ny , NB , Nv ) ; bu ( Ny ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( Ny , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 Lg ;".split(" ")},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:"void main ( ) { vec4 Ng , Nh ; Ng = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; Nh = u_sky_vp_inverse * Ng ; Lg = Nh . xyz ;".split(" ")},
{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bM = a_position . xy ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","Ng",";","}"]}]};a["special_water.glslf"]={type:"group",b:[{type:"var",name:"ABSORB",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"SSS_STRENGTH",a:["6.0"]},{type:"var",name:"SSS_WIDTH",
a:["0.0"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",a:["0.001"]},{type:"define",name:"REFR_BUMP",a:["0.0005"]},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],
group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",
";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},
{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2",
"u_normalmap2_scale",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:"const float Ng = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",a:"varying vec3 vB ; varying vec3 bC ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bF ; varying vec3 Nh ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","Ni",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","Nj",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","tB",";"]}]}}]},{type:"include",
file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",a:"vec3 Nv ( in vec2 Nk , in vec3 Nl , in vec3 Nm , in vec3 Nn , out float No ) { float Np , Nq , Nr ; vec2 Ns ; vec3 Nt , Nu ; No = 0.0 ; Nt = reflect ( - Nm , Nl ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Ns = Nk . xy + Nl . xz * REFL_BUMP / bH ; No = u_reflect_factor ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nu = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:"Nu = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",a:"} else { Nu = texture2D ( u_plane_reflection , Ns ) . rgb ; br ( Nu ) ; }".split(" ")}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"No = u_mirror_factor ; Nu = Nn * textureCube ( u_mirrormap , Nt ) . rgb ; br ( Nu ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"No = u_reflect_factor ; Nu = Nn * vec3 ( 0.3 , 0.5 , 1.0 ) ; br ( Nu ) ;".split(" ")}]}}]},
{type:"textline",a:"Nt = normalize ( Nt + Nm ) ; Np = 1.0 - dot ( Nm , Nt ) ; Nq = u_fresnel_params [ 3 ] ; Nr = u_fresnel_params [ 2 ] ; Nr = Nq + ( 1.0 - Nq ) * pow ( Np , Nr ) ; No = min ( No * Nr , 1.0 ) ; return Nu ; }".split(" ")},{type:"include",file:"lighting_nodes.glslf"},{type:"textline",a:"void main ( ) { vec4 Nw ; vec2 Nx , Ny , Nz ; float NA , NB , NC , ND , NE ; vec3 NF , NG , NH , NI , NJ , NK , NL , NM , NN ; mat3 NO ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",
0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NO = mat3 ( bF , Nh , bE ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NF = normalize ( bE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NF = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","FOAM",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NA = bC . y - WATER_LEVEL ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"Nx = vec2 ( Ni . x , - Ni . z ) + 0.5 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nx = vec2 ( bC . x , - bC . z ) + 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:["Nx","=","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NG = vec3 ( 0.0 ) ; NH = texture2D ( u_normalmap0 , Nx * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; NG += NH ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"NI = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NORM_FOAM0"],
group:{type:"group",b:[{type:"textline",a:["NI","+=","NH",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NH = texture2D ( u_normalmap0 , Nx * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; NG += NH ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM1"],group:{type:"group",b:[{type:"textline",
a:["NI","+=","NH",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NH = texture2D ( u_normalmap0 , Nx * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; NG += NH ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM2"],group:{type:"group",b:[{type:"textline",a:["NI","+=","NH",";"]}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NH = texture2D ( u_normalmap0 , Nx * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; NG += NH ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM3"],group:{type:"group",b:[{type:"textline",a:["NI","+=","NH",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"NI = NO * NI ; if ( ! f ( NI , vec3 ( 0.0 ) ) ) NI = normalize ( NI ) ; NI = mix ( NF , NI , 0.2 ) ; NI = normalize ( NI ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NF = mix ( NF , normalize ( NO * NG ) , 0.3 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"NF = mix ( NF , normalize ( NO * NG ) , 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:"NF = normalize ( NF ) ;".split(" ")}]}}]},{type:"textline",a:"NG = normalize ( vB ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Ny = bG . xy / bG . z ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"Nz = Ny + NF . xz * u_refr_bump / bH ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:"NB = u_diffuse_color . a ; Nw = texture2DProj ( u_scene_depth , bG ) ; NC = Z ( Nw ) ; ND = max ( NC - bH , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"NC = dY ( NC , Nz , Ny ) ; NC = max ( NC - bH , 0.0 ) ; NC = u_view_max_depth / ABSORB * NC ; NC = min ( NB * NC , 1.0 ) ; NB = min ( 15.0 * NB * u_view_max_depth * ND , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"NE = u_view_max_depth / ABSORB * ND ; if ( u_cam_water_depth > 0.0 ) NB = min ( NB * NE , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NB = u_diffuse_color . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["NC","=","NB",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"if ( u_cam_water_depth < 0.0 ) NC = 0.0 ; NH = texture2D ( u_refractmap , Nz ) . rgb ; br ( NH ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"NE = pow ( min ( Nj . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; NJ = mix ( u_shallow_water_col , u_diffuse_color . rgb , NE ) ; NE = pow ( min ( Nj . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; NJ = mix ( u_shore_water_col , NJ , NE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NJ = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:"ND = max ( 1.0 - u_view_max_depth * ND , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"ND = 1.0 - NB ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NA = max ( NA / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"NK = normalize ( vec3 ( Nj . r , 0.0 , Nj . g ) ) ; NK = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , NK , 0.8 ) ) ; NE = 1.25 * max ( dot ( NI , NK ) - 0.2 , 0.0 ) ; NE += max ( dot ( NI , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; ND += NE * ( 1.0 - Nj . b ) ; NA *= ( 1.0 - 0.95 * pow ( Nj . b , 0.1 ) ) ;".split(" ")}]}}]},
{type:"textline",a:"ND += NA ; ND = min ( u_foam_factor * ND , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"Nw = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + Nx * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",a:"NA = u_specular_params [ 0 ] ; Nx = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; NI = NA * u_specular_color ; NK = u_environment_energy * dS ( NF ) ; NK = u_ambient * NK ; NK = NK + u_sun_intensity ;".split(" ")},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NL = Nv ( Ny , NF , NG , NK , NA ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NL = Nv ( vec2 ( 0.0 ) , NF , NG , NK , NA ) ;".split(" ")}]}}]},{type:"textline",a:"NJ = u_diffuse_intensity * NJ ; xT ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , NJ , NI , bC , NF , NG , Nx , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , NM , NN ) ;".split(" ")},{type:"condition",b:[{type:"if",
d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NE = max ( dot ( u_sun_direction , - bE ) + SSS_WIDTH , 0.0 ) * max ( dot ( - NG , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; NE = clamp ( SSS_STRENGTH * NE , 0.0 , 1.0 ) ; NM = mix ( NM , u_shallow_water_col , NE ) ; NM = mix ( NM , u_shore_water_col , NE ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"NM = mix ( NH , NM , NC ) ;".split(" ")}]}}]},
{type:"textline",a:"NM = mix ( NM , NL , NA ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"NA = mix ( Nw . g , Nw . r , max ( 4.0 * ( ND - 0.75 ) , 0.0 ) ) ; NA = mix ( Nw . b , NA , max ( 2.0 * ND - 1.0 , 0.0 ) ) ; NA = mix ( 0.0 , NA , ND ) ; NM = mix ( NM , NK , NA ) ;".split(" ")}]}}]},{type:"textline",a:["NM","+=","NN",";"]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",
a:"ND = bH * u_view_max_depth ; NC = 1.0 ; if ( u_cam_water_depth > 1.0 ) NC = 2.0 ; vA ( NM , ND , NG , NC ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","NM",")",";"]},{type:"condition",b:[{type:"if",d:["REFRACTIVE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"NB = max ( NB , NN . r ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:["NB","+=","NA",";"]}]}}]}]}},{type:"elif",d:["SHORE_SMOOTHING",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:["NB","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"textline",a:"bx ( NM , NB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME",1,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"extension",a:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",a:"NN = fwidth ( tB ) ; NN = smoothstep ( vec3 ( 0.0 ) , NN * Ng , tB ) ; NA = min ( min ( NN . x , NN . y ) , NN . z ) ; NA = clamp ( NA , 0.0 , 1.0 ) ; NM = mix ( u_wireframe_edge_color , NM , NA ) ; NB = mix ( 1.0 , NB , NA ) ;".split(" ")}]}},
{type:"elif",d:["DEBUG_WIREFRAME",2,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NN = sign ( tB - vec3 ( 0.02 * Ng ) ) ; NA = 1.0 ; if ( NN . x < 0.0 || NN . y < 0.0 || NN . z < 0.0 ) NA = 0.0 ; NM = mix ( u_wireframe_edge_color , NM , NA ) ; NB = mix ( 1.0 , NB , NA ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( NM , NB ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",b:[{type:"var",name:"DIR_MIN_SHR_FAC",a:["0.0"]},{type:"var",name:"DIR_FREQ",a:["0.0"]},
{type:"var",name:"DIR_NOISE_SCALE",a:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",a:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",a:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",a:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",a:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",a:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",a:["0.0"]},{type:"var",name:"DST_MIN_FAC",a:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",a:["0.0"]},{type:"var",name:"PRECISION",a:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",a:["0.0"]},
{type:"var",name:"SHORE_MAP_SIZE_X",a:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",a:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",a:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"WAVES_LENGTH",a:["0.0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},
{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"DYNAMIC",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_normal ; attribute vec3 a_tangent ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["GENERATED_MESH",{type:"logic_negative_expr",e:1},"NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_polyindex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3",
"u_model_tsr",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],
group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",a:"varying vec3 vB ; varying vec3 bC ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bF ; varying vec3 Nh ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",
e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","Ni",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","Nj",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","tB",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",
a:"vec3 No ( in vec2 Ng ) { float Nk ; vec4 Nl ; vec2 Nm ; Nm = 0.5 + vec2 ( ( Ng . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( Ng . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; Nl = texture2D ( u_shore_dist_map , Nm ) ; const vec2 Nn = vec2 ( 1.0 / 255.0 , 1.0 ) ; Nk = dot ( Nl . ba , Nn ) ; Nm = normalize ( Nl . rg * 2.0 - 1.0 ) ; return vec3 ( Nm , Nk ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"define",name:"M_PI",a:["3.14159265359"]},
{type:"define",name:"SMALL_WAVES_FAC",a:["0.3"]},{type:"textline",a:"void NA ( inout vec3 Np , in float Nq , in vec3 Nr ) { vec2 Ns , Nt , Nu ; float Nv , Nw , Nx , Ny , Nz ; Nv = aU ( DST_NOISE_SCALE_0 * ( Np . xz + DST_NOISE_FREQ_0 * Nq ) ) * aU ( DST_NOISE_SCALE_1 * ( Np . zx - DST_NOISE_FREQ_1 * Nq ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Nw = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; Nx = Nr . b ; Ny = sqrt ( Nx ) ; Nw = max ( Nx , DIR_MIN_SHR_FAC ) * sin ( Ny / Nw + DIR_FREQ * Nq ) ; Nz = max ( aU ( DIR_NOISE_SCALE * ( Np . xz + DIR_NOISE_FREQ * Nq ) ) , DIR_MIN_NOISE_FAC ) ; Nw *= Nz ; Ny = WAVES_HEIGHT * mix ( Nw , Nv , max ( Ny , DST_MIN_FAC ) ) ; Ns = Nr . rg ; Nw = WAVES_HOR_FAC * Nw * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - Nx ) , 0.0 ) ; Ns = Nw * Ns ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Ny = WAVES_HEIGHT * Nv ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"Nt = 2.0 * ( Np . xz - 0.1 * Nq ) ; Nu = 1.3 * ( Np . zx + 0.03 * Nq ) ; Nv = ay ( 0.5 * ( Nt + Nu ) ) . x - 0.5 ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Np . xz += Ns ; Nv *= Nx ;".split(" ")}]}}]},{type:"textline",a:"Ny += SMALL_WAVES_FAC * Nv ;".split(" ")}]}}]},
{type:"textline",a:"Np . y += Ny ; }".split(" ")}]}}]},{type:"textline",a:"void main ( ) { vec4 NB , NC ; vec2 ND ; float NE , NF , NG ; vec3 NH , NI , NJ , NK , NL ; mat4 NM , NN ; NM = O ( u_view_tsr ) ; NN = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:"if ( a_polyindex == 0.0 ) tB = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) tB = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) tB = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"NH = a_position ; NE = abs ( NH . y ) ; ND = u_camera_eye . xz - mod ( u_camera_eye . xz , NE ) ; NH . y = WATER_LEVEL ; NH . xz += ND ; NH = NH ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["bM","=","a_texcoord",";"]}]}}]},{type:"textline",a:"c NO = rH ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , NN ) ; NH = NO . a ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Nj = No ( NH . xz ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NF = length ( u_wind ) ; NG = u_time ; NG *= NF ;".split(" ")},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"NE = NE ; NI = NH + vec3 ( NE , 0.0 , 0.0 ) ; NJ = NH + vec3 ( 0.0 , 0.0 , NE ) ;".split(" ")},{type:"condition",b:[{type:"if",
d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["Ni","=","NH",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NI = NH + vec3 ( 0.05 , 0.0 , 0.0 ) ; NJ = NH + vec3 ( 0.0 , 0.0 , 0.05 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"NK = No ( NI . xz ) ; NL = No ( NJ . xz ) ; NA ( NI , NG , NK ) ; NA ( NJ , NG , NL ) ; NA ( NH , NG , Nj ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"NA ( NI , NG , vec3 ( 0.0 ) ) ; NA ( NJ , NG , vec3 ( 0.0 ) ) ; NA ( NH , NG , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"if ( a_position . y < 0.0 ) { NH . y = WATER_LEVEL - 1.0 ; NI . y = NH . y ; NJ . y = NH . y ; }".split(" ")}]}}]},{type:"textline",a:"NI = normalize ( NI - NH ) ; NJ = normalize ( NJ - NH ) ; bE = normalize ( cross ( NJ , NI ) ) ; NG = dot ( bE , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; NG = clamp ( 0.8 - NG , 0.0 , 1.0 ) ; bE = mix ( bE , vec3 ( 0.0 , 1.0 , 0.0 ) , NG ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"NJ = a_tangent ; bE = a_normal ;".split(" ")}]}}]},{type:"textline",a:"bF = NJ ; Nh = cross ( bE , bF ) ;".split(" ")}]}}]},{type:"textline",a:"bC = NH ; vB = u_camera_eye - NH ; NB = NM * vec4 ( NH , 1.0 ) ; NC = u_proj_matrix * NB ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING",
"REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"NG = NC . x ; NE = NC . y ; NF = NC . w ; bG . x = ( NG + NF ) / 2.0 ; bG . y = ( NE + NF ) / 2.0 ; bG . z = NF ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",
a:"bH = - NB . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","NC",";","}"]}]};a["postprocessing/antialiasing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"define",name:"AA_METHOD_FXAA_LIGHT",a:["1"]},{type:"define",name:"AA_METHOD_FXAA_QUALITY",a:["2"]},{type:"define",name:"AA_QUALITY_LOW",
a:["0"]},{type:"define",name:"AA_QUALITY_MEDIUM",a:["1"]},{type:"define",name:"AA_QUALITY_HIGH",a:["2"]},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_REDUCE_MIN",a:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",a:["(","1.0","/","8.0",")"]},{type:"define",name:"FXAA_SPAN_MAX",a:["8.0"]},{type:"textline",a:"vec4 Nm ( float Ng , float Nk ) { vec2 Nl ; Nl = bM + vec2 ( Ng , Nk ) * u_texel_size ; return texture2D ( u_color , Nl ) ; } vec4 Nz ( ) { vec2 Nn ; float No , Np , Nq , Nr , Ns , Nt ; vec4 Nu , Nv , Nw , Nx , Ny ; Nu = Nm ( - 1.0 , - 1.0 ) ; Nv = Nm ( 1.0 , - 1.0 ) ; Nw = Nm ( - 1.0 , 1.0 ) ; Nx = Nm ( 1.0 , 1.0 ) ; Ny = Nm ( 0.0 , 0.0 ) ; No = bB ( Ny ) ; Np = bB ( Nu ) ; Nq = bB ( Nv ) ; Nr = bB ( Nw ) ; Ns = bB ( Nx ) ; Nt = min ( No , min ( min ( Np , Nq ) , min ( Nr , Ns ) ) ) ; No = max ( No , max ( max ( Np , Nq ) , max ( Nr , Ns ) ) ) ; Nn . x = - ( ( Np + Nq ) - ( Nr + Ns ) ) ; Nn . y = ( ( Np + Nr ) - ( Nq + Ns ) ) ; Ns = max ( ( Np + Nq + Nr + Ns ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; Ns = 1.0 / ( min ( abs ( Nn . x ) , abs ( Nn . y ) ) + Ns ) ; Nn = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , Nn * Ns ) ) * u_texel_size ; Nx = 0.5 * ( texture2D ( u_color , bM + Nn * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , bM + Nn * ( 2.0 / 3.0 - 0.5 ) ) ) ; Nw = Nx * 0.5 + 0.25 * ( texture2D ( u_color , bM + Nn * - 0.5 ) + texture2D ( u_color , bM + Nn * 0.5 ) ) ; Ns = bB ( Nw ) ; if ( ( Ns < Nt ) || ( Ns > No ) ) return Nx ; else return Nw ; }".split(" ")}]}},
{type:"elif",d:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_GREEN_AS_LUMA",a:["1"]},{type:"define",name:"FXAA_BLEND4WEB",a:["1"]},{type:"include",file:"fxaa.glslf"},{type:"condition",b:[{type:"if",d:["AA_QUALITY","AA_QUALITY_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["39"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["1.00"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",
a:["0.063"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0312"]}]}},{type:"elif",d:["AA_QUALITY","AA_QUALITY_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["20"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["0.65"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",a:["0.166"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0625"]}]}},{type:"elif",d:["AA_QUALITY","AA_QUALITY_LOW",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["12"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["0.50"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",a:["0.166"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0833"]}]}}]}]}}]},{type:"textline",a:"void main ( ) { vec2 Oq ;".split(" ")},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = Nz ( ) ;".split(" ")}]}},{type:"elif",d:["AA_METHOD",
"AA_METHOD_FXAA_QUALITY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Oq = u_texel_size ; gl_FragColor = Op ( bM , u_color , Oq , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 bM ; void main ( ) { vec4 Ng ; vec2 Nk , Nl ; Nk = vec2 ( 0.0 , 0.0 ) ; Nl = u_texel_size ; Ng = texture2D ( u_color , bM ) ; gl_FragColor = Ng * 0.0875447373698 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0858112354248 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0808139781061 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0731235112908 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0635705267419 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0530985673112 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0426125984122 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0328565115809 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * Ng , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 bM ; void main ( ) { vec4 Ng , Nk ; Ng = texture2D ( u_main , bM ) ; Nk = texture2D ( u_bloom , bM ) ; Ng = Ng ; Ng += Nk ; gl_FragColor = vec4 ( Ng . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},
{type:"define",name:"PI_4",a:["0.785398163"]},{type:"textline",a:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 bM ; void main ( ) { float Ng ; vec3 Nk ; vec4 Nl ; Nl = texture2D ( u_color , bM ) ; Nk = Nl . rgb ; if ( u_brightness < 0.0 ) Nk = Nk * ( 1.0 + u_brightness ) ; else Nk = Nk + ( ( 1.0 - Nk ) * u_brightness ) ; Nk = ( Nk - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; Nk *= u_exposure ; Ng = bB ( vec4 ( Nk , 0.0 ) ) ; Nk = mix ( vec3 ( Ng ) , Nk , u_saturation ) ; gl_FragColor = vec4 ( Nk , Nl . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",a:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 bM ; void main ( ) { gl_FragColor = V ( clamp ( Ow ( u_depth , bM , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",a:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 bM ; void main ( ) { float Ng , Nk ; vec4 Nl , Nm ; Nl = texture2D ( u_sharp , bM ) ; if ( u_dof_dist > 0.0 ) { Ng = Ow ( u_depth , bM , u_camera_range ) ; Ng *= u_view_max_depth ; if ( Ng < u_dof_dist ) Nk = ( u_dof_dist - Ng ) / u_dof_front ; else Nk = ( Ng - u_dof_dist ) / u_dof_rear ; Nk = clamp ( Nk , 0.0 , 1.0 ) ; Nm = texture2D ( u_blurred , bM ) ; gl_FragColor = mix ( Nl , Nm , Nk ) ; } else gl_FragColor = Nl ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 bM ; void main ( ) { float Ng ; vec4 Nk , Nl , Nm ; Nk = texture2D ( u_src_color , bM ) ; Nl = texture2D ( u_glow_mask_small , bM ) ; Nm = texture2D ( u_glow_mask_large , bM ) ; gl_FragColor = Nk ; if ( Nm . a != 0.0 ) { Ng = u_glow_mask_large_coeff * Nm . a ; Ng = clamp ( Ng , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , Nm . rgb / Nm . a , Ng ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , Ng ) ; } if ( Nl . a != 0.0 ) { Ng = u_glow_mask_small_coeff * Nl . a ; Ng = clamp ( Ng , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , Nl . rgb / Nl . a , Ng ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , Ng ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",a:["0.0"]},{type:"textline",a:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_camera_range",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"varying float Ox ; varying vec2 Oy ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying vec4 Oz ; void main ( ) { vec4 OA ; int OB ; float OC , OD , OE , OF ; vec2 OG , OH , OI ; OG = ( Oz . xy - bM ) ; OC = length ( OG ) ; OG = u_radial_blur_step * OG / OC ; OD = OC / u_radial_blur_step ; OG *= min ( OD , STEPS_PER_PASS ) / STEPS_PER_PASS ; OD = max ( OD , STEPS_PER_PASS ) ; OH = bM ; OE = 0.0 ; const int OJ = int ( STEPS_PER_PASS ) ; OB = int ( OD + 0.5 ) ; for ( int OK = 0 ; OK < OJ ; OK += 1 ) { if ( OK <= OB ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"textline",a:"OD = Ow ( u_input , OH , u_camera_range ) ; OE += max ( ( 1.0 - pow ( OC , 0.3 ) ) * step ( 0.9 , OD ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"OA = texture2D ( u_input , OH ) ; OE += Z ( OA ) ;".split(" ")}]}}]},{type:"textline",a:"} OH += OG ; }".split(" ")},{type:"condition",b:[{type:"if",d:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"OI = bM + Oy ; OF = ay ( vec2 ( 2.5 * ( OI . x ) , 2.5 * ( OI . y ) + 1.0 * u_time ) ) . x + 0.75 * ay ( vec2 ( 5.0 * ( OI . x ) - 0.66 * u_time , 5.0 * ( OI . y ) + 0.66 * u_time ) ) . x + 0.5 * aU ( vec2 ( 7.5 * ( OI . x ) + 0.33 * u_time , 7.5 * ( OI . y ) - 0.33 * u_time ) ) ; OF *= clamp ( 1.2 - sqrt ( 0.2 * OC ) , 0.0 , 1.0 ) * Ox ; OE = max ( OF , OE ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = V ( OE / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]=
{type:"group",b:[{type:"include",file:"math.glslv"},{type:"textline",a:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float Ox ; varying vec2 Oy ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying vec4 Oz ; void main ( ) { float Ng , Nk ; vec3 Nl ; bM = a_bb_vertex + 0.5 ; Nl = normalize ( u_sun_direction ) ; Oz = u_view_proj_matrix * vec4 ( Nl , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( u_cam_water_depth < 0.0 ) { Ox = 1.0 ; Nl = vec3 ( 0.0 , 1.0 , 0.0 ) ; Nl = i ( u_camera_quat , Nl ) ; Nl = normalize ( Nl ) ; Ng = dot ( Nl , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; Nk = atan ( Nl . x , Nl . z ) ; Oy = vec2 ( - Nk , acos ( Ng ) ) ; } else { Ox = 0.0 ; }".split(" ")}]}}]},{type:"textline",a:"Oz . xy = 0.5 * ( Oz . xy / Oz . w + 1.0 ) ; Oz += 99999.0 * step ( Oz . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/god_rays_combine.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 bM ; void main ( ) { float Ng ; vec3 Nk ; vec4 Nl ; Nl = texture2D ( u_main , bM ) ; Nk = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; br ( Nl . rgb ) ; Ng = Z ( texture2D ( u_god_rays , bM ) ) ; Nk = Nl . rgb + u_god_rays_intensity * vec3 ( Ng ) * Nk ; bu ( Nk ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SAFARI_CANVAS_ALPHA_HACK"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( Nk , max ( 0.01 , Nl . a ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( Nk , Nl . a ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/luminance.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_input ; varying vec2 bM ; void main ( ) { float Ng ; vec4 Nk ; Nk = texture2D ( u_input , bM ) ; Ng = dot ( Nk . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( Ng ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_input ; void main ( ) { float Ng , Nk , Nl , Nm ; Nk = 0.0 ; Nl = 0.025 ; Nm = 0.025 ; for ( int Nn = 0 ; Nn < 20 ; Nn += 1 ) { Nm = 0.025 ; for ( int No = 0 ; No < 20 ; No += 1 ) { Ng = max ( texture2D ( u_input , vec2 ( Nl , Nm ) ) . r , 0.01 ) ; Nk += log ( Ng ) ; Nm += 0.05 ; } Nl += 0.05 ; } Nk = exp ( Nk / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( Nk ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 bM ; varying float OA ; void main ( ) { vec4 OB ; float OC , OD ; OC = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; OD = texture2D ( u_luminance , bM ) . r ; OB = texture2D ( u_main , bM ) ; OC = OD / OC ; OD = u_bloom_edge_lum ; gl_FragColor = OB * max ( OC - OD , 0.0 ) * OA ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 bM ; varying float OA ; const vec3 Ng = vec3 ( 0.0 , 1.0 , 0.0 ) ; void Nr ( in vec4 Nk , in vec3 Nl , out vec3 Nm ) { float Nn , No , Np , Nq ; Nn = Nk . w * Nl . x + Nk . y * Nl . z - Nk . z * Nl . y ; No = Nk . w * Nl . y + Nk . z * Nl . x - Nk . x * Nl . z ; Np = Nk . w * Nl . z + Nk . x * Nl . y - Nk . y * Nl . x ; Nq = - Nk . x * Nl . x - Nk . y * Nl . y - Nk . z * Nl . z ; Nm . x = Nn * Nk . w - Nq * Nk . x - No * Nk . z + Np * Nk . y ; Nm . y = No * Nk . w - Nq * Nk . y - Np * Nk . x + Nn * Nk . z ; Nm . z = Np * Nk . w - Nq * Nk . z - Nn * Nk . y + No * Nk . x ; } void main ( ) { vec3 Ns ; bM = 2.0 * a_position ; Nr ( u_camera_quat , Ng , Ns ) ; OA = dot ( - Ns , u_sun_direction ) * u_bloom_key ; OA *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 bM ; float Ng = 0.0042 ; void main ( ) { vec4 Nk , Nl , Nm , Nn ; Nk = texture2D ( u_mb_tex_curr , bM ) ; Nl = texture2D ( u_mb_tex_accum , bM ) ; if ( length ( Nk - Nl ) > u_motion_blur_decay_threshold ) { Nm = ( 1.0 - u_motion_blur_exp ) * Nk + u_motion_blur_exp * Nl ; Nm = Nm - Nl ; Nn = Nk - Nl ; Nm = min ( max ( abs ( Nm ) , vec4 ( Ng ) ) , abs ( Nn ) ) * sign ( Nm ) ; gl_FragColor = Nl + Nm ; } else { gl_FragColor = Nk ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 bM ; void main ( ) { vec3 Ng ; float Nk ; vec4 Nl , Nm , Nn ; Nl = texture2D ( u_outline_src , bM ) ; gl_FragColor = Nl ; if ( u_draw_outline != 0.0 ) { Nm = texture2D ( u_outline_mask , bM ) ; Nn = texture2D ( u_outline_mask_blurred , bM ) ; Nk = Nn . a - Nm . a ; if ( Nk != 0.0 ) { Nk = smoothstep ( 0.0 , 1.0 , Nn . a ) ; if ( Nm . a == 0.0 ) { Ng = u_outline_color ; bu ( Ng ) ; Nm = vec4 ( clamp ( Ng , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( Nl , Nm , Nk ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_color ; varying vec2 bM ; void main ( ) { vec4 Ng ; Ng = vec4 ( 0.0 ) ; for ( int Nk = 0 ; Nk < 100 ; Nk ++ ) Ng += 0.001 * texture2D ( u_color , bM + vec2 ( 0.001 * vec2 ( Nk ) ) ) ; gl_FragColor = Ng ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",
a:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",a:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",a:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",a:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",a:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",a:["6"]},{type:"define",name:"FLIP_CUBEMAP_COORDS",a:["7"]},{type:"textline",a:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{type:"textline",a:"varying vec2 bM ; void main ( ) { float Ng , Nk , Nl , Nm ; vec2 Nn , No ; vec4 Np ;".split(" ")},{type:"condition",b:[{type:"if",d:["POST_EFFECT","POST_EFFECT_NONE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = texture2D ( u_color , bM ) ;".split(" ")}]}},{type:"elif",d:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"Np = texture2D ( u_color , bM ) ; gl_FragColor . rgb = vec3 ( ( Np . r + Np . g + Np . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_BLUR",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_BLUR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nn = vec2 ( 0.0 , 0.0 ) ; No = u_texel_size ; Np = texture2D ( u_color , bM ) ; gl_FragColor = Np * 0.2270270270 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * 0.1945945946 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * 0.1945945946 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * 0.1216216216 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * 0.1216216216 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * 0.0540540541 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * 0.0540540541 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * 0.0162162162 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * 0.0162162162 ;".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_GLOW_BLUR",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nn = vec2 ( 0.0 , 0.0 ) ; No = u_texel_size ; Np = texture2D ( u_color , bM ) ; gl_FragColor = Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.152507 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.141763 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.141763 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.113861 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.113861 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.079019 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.079019 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.047383 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.047383 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.024549 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.024549 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.01099 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.01099 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.00425 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.00425 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.00142 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_EXTEND",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_EXTEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"No = u_texel_size ; Np = texture2D ( u_color , bM ) ; gl_FragColor = Np ; if ( Np . a == 0.0 ) { Np = texture2D ( u_color , bM + No ) ; if ( Np . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , Np . a ) ; else { Np = texture2D ( u_color , bM - No ) ; if ( Np . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , Np . a ) ; } }".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Ng = u_delta [ 0 ] ; Nk = u_delta [ 1 ] ; Nl = 1.0 / 3.0 ; Nm = 0.5 ; No = vec2 ( Nl , Nm ) ; if ( u_tex_number == 0 ) { Nn = bM * No + vec2 ( 2.0 * Nl , 0.0 ) ; Nn [ 0 ] = min ( Nn [ 0 ] , 1.0 - Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 0.5 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( 5.0 * Nl - Nn [ 0 ] , Nn [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { Nn = bM * No ; Nn [ 0 ] = max ( Nn [ 0 ] , Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 0.5 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( Nl - Nn [ 0 ] , Nn [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { Nn = bM * No + vec2 ( Nl , Nm ) ; Nn [ 0 ] = max ( Nn [ 0 ] , Nl + Ng ) ; Nn [ 0 ] = min ( Nn [ 0 ] , 2.0 * Nl - Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 1.0 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( Nn [ 0 ] , 3.0 * Nm - Nn [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { Nn = bM * No + vec2 ( 0.0 , Nm ) ; Nn [ 0 ] = min ( Nn [ 0 ] , Nl - Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 1.0 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( Nn [ 0 ] , 3.0 * Nm - Nn [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { Nn = bM * No + vec2 ( Nl , 0.0 ) ; Nn [ 0 ] = max ( Nn [ 0 ] , Nl + Ng ) ; Nn [ 0 ] = min ( Nn [ 0 ] , 2.0 * Nl - Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 0.5 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( 1.0 - Nn [ 0 ] , Nn [ 1 ] ) ) ; } else { No = bM * No + vec2 ( 2.0 * Nl , Nm ) ; No [ 0 ] = min ( No [ 0 ] , 1.0 - Ng ) ; No [ 1 ] = max ( No [ 1 ] , 0.5 + Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( 5.0 * Nl - No [ 0 ] , No [ 1 ] ) ) ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec2 a_position ; varying vec2 bM ; void main ( ) { bM = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",a:["1"]},{type:"define",
name:"SMAA_EDGE_DETECTION",a:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",a:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",a:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",a:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",a:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",a:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",a:["4"]},{type:"textline",a:["uniform","sampler2D","u_color",";"]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",e:2},"SMAA_PREDICATION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",a:"uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","OB",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"varying vec4 OC ; varying vec4 OD ; varying vec4 OE ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","OF",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",a:["1"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",
a:["1"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
a:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",a:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",
group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["8"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",b:[{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",b:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",a:["2.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",b:[{type:"define",
name:"SMAA_PREDICATION",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",a:["0.01"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_SCALE",a:["2.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",a:["0.4"]}]}}]},
{type:"condition",b:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",b:[{type:"define",name:"SMAA_REPROJECTION",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",b:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",a:["30.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",a:["16"]},
{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",a:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",a:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",a:["(","1.0","/","7.0",")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",a:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",a:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",a:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec3 OL ( vec2 OG , sampler2D OH ) { float OI , OJ , OK ; OI = texture2D ( OH , OG ) . r ; OJ = texture2D ( OH , OC . xy ) . r ; OK = texture2D ( OH , OC . zw ) . r ; return vec3 ( OI , OJ , OK ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec2 OQ ( vec2 OM , sampler2D ON ) { vec2 OO ; vec3 OP ; OP = OL ( OM , ON ) ; OO = abs ( OP . xx - OP . yz ) ; OO = step ( SMAA_PREDICATION_THRESHOLD , OO ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * OO ) ; }".split(" ")}]}}]},
{type:"textline",a:"void OU ( bvec2 OR , inout vec2 OS , vec2 OT ) { if ( OR . x ) OS . x = OT . x ; if ( OR . y ) OS . y = OT . y ; } void OU ( bvec4 OV , inout vec4 OW , vec4 OX ) { OU ( OV . xy , OW . xy , OX . xy ) ; OU ( OV . zw , OW . zw , OX . zw ) ; } vec2 OZ ( vec2 OY ) { return sign ( OY ) * floor ( abs ( OY ) + .5 ) ; } vec4 OZ ( vec4 O_ ) { return sign ( O_ ) * floor ( abs ( O_ ) + .5 ) ; }".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"vec2 Pm ( vec2 Pa , sampler2D Pb".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","Pc"]}]}}]},{type:"textline",a:") { vec4 Pd ; float Pe , Pf , Pg , Ph , Pi ; vec3 Pj ; vec2 Pk , Pl ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",b:[{type:"textline",a:"Pk = OQ ( Pa , Pc ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"Pk = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{type:"textline",a:"Pj = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; Pe = dot ( texture2D ( Pb , Pa ) . rgb , Pj ) ; Pf = dot ( texture2D ( Pb , OC . xy ) . rgb , Pj ) ; Pg = dot ( texture2D ( Pb , OC . zw ) . rgb , Pj ) ; Pd . xy = abs ( Pe - vec2 ( Pf , Pg ) ) ; Pk = step ( Pk , Pd . xy ) ; if ( dot ( Pk , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; Ph = dot ( texture2D ( Pb , OD . xy ) . rgb , Pj ) ; Pi = dot ( texture2D ( Pb , OD . zw ) . rgb , Pj ) ; Pd . zw = abs ( Pe - vec2 ( Ph , Pi ) ) ; Pl = max ( Pd . xy , Pd . zw ) ; Pi = dot ( texture2D ( Pb , OE . xy ) . rgb , Pj ) ; Ph = dot ( texture2D ( Pb , OE . zw ) . rgb , Pj ) ; Pd . zw = abs ( vec2 ( Pf , Pg ) - vec2 ( Pi , Ph ) ) ; Pl = max ( Pl . xy , Pd . zw ) ; Ph = max ( Pl . x , Pl . y ) ; Pk . xy *= step ( Ph , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * Pd . xy ) ; return Pk ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"vec2 Po ( vec2 Pn ) { Pn . r = Pn . r * abs ( 5.0 * Pn . r - 5.0 * 0.75 ) ; return OZ ( Pn ) ; } vec4 Po ( vec4 Pp ) { Pp . rb = Pp . rb * abs ( 5.0 * Pp . rb - 5.0 * 0.75 ) ; return OZ ( Pp ) ; } vec2 Px ( sampler2D Pq , vec2 Pr , vec2 Ps , out vec2 Pt ) { vec3 Pu ; vec4 Pv ; Pv = vec4 ( Pr , - 1.0 , 1.0 ) ; Pu = vec3 ( u_texel_size , 1.0 ) ; for ( int Pw = 0 ; Pw < SMAA_MAX_SEARCH_STEPS_DIAG ; Pw ++ ) { if ( Pv . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Pv . w > 0.9 ) { Pv . xyz += Pu * vec3 ( Ps , 1.0 ) ; Pt = texture2D ( Pq , Pv . xy , 0.0 ) . rg ; Pv . w = dot ( Pt , vec2 ( 0.5 , 0.5 ) ) ; } } return Pv . zw ; } vec2 PF ( sampler2D Py , vec2 Pz , vec2 PA , out vec2 PB ) { vec3 PC ; vec4 PD ; PD = vec4 ( Pz , - 1.0 , 1.0 ) ; PD . x += 0.25 * u_texel_size . x ; PC = vec3 ( u_texel_size , 1.0 ) ; for ( int PE = 0 ; PE < SMAA_MAX_SEARCH_STEPS_DIAG ; PE ++ ) { if ( PD . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && PD . w > 0.9 ) { PD . xyz = PC * vec3 ( PA , 1.0 ) + PD . xyz ; PB = texture2D ( Py , PD . xy , 0.0 ) . rg ; PB = Po ( PB ) ; PD . w = dot ( PB , vec2 ( 0.5 , 0.5 ) ) ; } } return PD . zw ; } vec2 PL ( sampler2D PG , vec2 PH , vec2 PI , float PJ ) { vec2 PK ; PK = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * PI + PH ; PK = SMAA_AREATEX_PIXEL_SIZE * PK + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; PK . x += 0.5 ; PK . y += SMAA_AREATEX_SUBTEX_SIZE * PJ ; return texture2D ( PG , PK , 0.0 ) . rg ; } vec2 PX ( sampler2D PM , sampler2D PN , vec2 PO , vec2 PP , vec4 PQ ) { vec4 PR , PS , PT ; vec2 PU , PV , PW ; PU = vec2 ( 0.0 , 0.0 ) ; if ( PP . r > 0.0 ) { PR . xz = Px ( PM , PO , vec2 ( - 1.0 , 1.0 ) , PV ) ; PR . x += float ( PV . y > 0.9 ) ; } else PR . xz = vec2 ( 0.0 , 0.0 ) ; PR . yw = Px ( PM , PO , vec2 ( 1.0 , - 1.0 ) , PV ) ; if ( PR . x + PR . y > 2.0 ) { PS = vec4 ( - PR . x + 0.25 , PR . x , PR . y , - PR . y - 0.25 ) * u_texel_size . xyxy + PO . xyxy ; PT . xy = texture2D ( PM , PS . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; PT . zw = texture2D ( PM , PS . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; PT . yxwz = Po ( PT . xyzw ) ; PW = vec2 ( 2.0 , 2.0 ) * PT . xz + PT . yw ; OU ( bvec2 ( step ( 0.9 , PR . zw ) ) , PW , vec2 ( 0.0 , 0.0 ) ) ; PU += PL ( PN , PR . xy , PW , PQ . z ) ; } PR . xz = PF ( PM , PO , vec2 ( - 1 , - 1 ) , PV ) ; if ( texture2D ( PM , PO + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { PR . yw = PF ( PM , PO , vec2 ( 1 , 1 ) , PV ) ; PR . y += float ( PV . y > 0.9 ) ; } else PR . yw = vec2 ( 0.0 , 0.0 ) ; if ( PR . x + PR . y > 2.0 ) { PT = vec4 ( - PR . x , - PR . x , PR . y , PR . y ) * u_texel_size . xyxy + PO . xyxy ; PS . x = texture2D ( PM , PT . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; PS . y = texture2D ( PM , PT . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; PS . zw = texture2D ( PM , PT . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; PV = vec2 ( 2.0 , 2.0 ) * PS . xz + PS . yw ; OU ( bvec2 ( step ( 0.9 , PR . zw ) ) , PV , vec2 ( 0 , 0 ) ) ; PU += PL ( PN , PR . xy , PV , PQ . w ) . gr ; } return PU ; }".split(" ")}]}}]},
{type:"textline",a:"float Qc ( sampler2D PY , vec2 PZ , float P_ ) { vec2 Qa , Qb ; Qa = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; Qb = SMAA_SEARCHTEX_SIZE * vec2 ( P_ , 1.0 ) ; Qa += vec2 ( - 1.0 , 1.0 ) ; Qb += vec2 ( 0.5 , - 0.5 ) ; Qa *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; Qb *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( PY , Qa * PZ + Qb , 0.0 ) . r ; } float Qk ( sampler2D Qd , sampler2D Qe , vec2 Qf , float Qg ) { float Qh ; vec2 Qi ; Qi = vec2 ( 0.0 , 1.0 ) ; for ( int Qj = 0 ; Qj < SMAA_MAX_SEARCH_STEPS ; Qj ++ ) { if ( Qf . x > Qg && Qi . g > 0.8281 && Qi . r == 0.0 ) { Qi = texture2D ( Qd , Qf , 0.0 ) . rg ; Qf = - vec2 ( 2.0 , 0.0 ) * u_texel_size + Qf ; } } Qh = - ( 255.0 / 127.0 ) * Qc ( Qe , Qi , 0.0 ) + 3.25 ; return u_texel_size . x * Qh + Qf . x ; } float Qs ( sampler2D Ql , sampler2D Qm , vec2 Qn , float Qo ) { float Qp ; vec2 Qq ; Qq = vec2 ( 0.0 , 1.0 ) ; for ( int Qr = 0 ; Qr < SMAA_MAX_SEARCH_STEPS ; Qr ++ ) { if ( Qn . x < Qo && Qq . g > 0.8281 && Qq . r == 0.0 ) { Qq = texture2D ( Ql , Qn , 0.0 ) . rg ; Qn = vec2 ( 2.0 , 0.0 ) * u_texel_size + Qn ; } } Qp = - ( 255.0 / 127.0 ) * Qc ( Qm , Qq , 0.5 ) + 3.25 ; return - u_texel_size . x * Qp + Qn . x ; } float QA ( sampler2D Qt , sampler2D Qu , vec2 Qv , float Qw ) { float Qx ; vec2 Qy ; Qy = vec2 ( 1.0 , 0.0 ) ; for ( int Qz = 0 ; Qz < SMAA_MAX_SEARCH_STEPS ; Qz ++ ) { if ( Qv . y > Qw && Qy . r > 0.8281 && Qy . g == 0.0 ) { Qy = texture2D ( Qt , Qv , 0.0 ) . rg ; Qv = - vec2 ( 0.0 , 2.0 ) * u_texel_size + Qv ; } } Qx = - ( 255.0 / 127.0 ) * Qc ( Qu , Qy . gr , 0.0 ) + 3.25 ; return u_texel_size . y * Qx + Qv . y ; } float QI ( sampler2D QB , sampler2D QC , vec2 QD , float QE ) { float QF ; vec2 QG ; QG = vec2 ( 1.0 , 0.0 ) ; for ( int QH = 0 ; QH < SMAA_MAX_SEARCH_STEPS ; QH ++ ) { if ( QD . y < QE && QG . r > 0.8281 && QG . g == 0.0 ) { QG = texture2D ( QB , QD , 0.0 ) . rg ; QD = vec2 ( 0.0 , 2.0 ) * u_texel_size + QD ; } } QF = - ( 255.0 / 127.0 ) * Qc ( QC , QG . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * QF + QD . y ; } vec2 QP ( sampler2D QJ , vec2 QK , float QL , float QM , float QN ) { vec2 QO ; QO = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * OZ ( 4.0 * vec2 ( QL , QM ) ) + QK ; QO = SMAA_AREATEX_PIXEL_SIZE * QO + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; QO . y = SMAA_AREATEX_SUBTEX_SIZE * QN + QO . y ; return texture2D ( QJ , QO , 0.0 ) . rg ; } void QW ( sampler2D QQ , inout vec2 QR , vec4 QS , vec2 QT ) { vec2 QU , QV ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"QU = step ( QT . xy , QT . yx ) ; QV = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * QU ; QV /= QU . x + QU . y ; QU = vec2 ( 1.0 , 1.0 ) ; QU . x -= QV . x * texture2D ( QQ , QS . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; QU . x -= QV . y * texture2D ( QQ , QS . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; QU . y -= QV . x * texture2D ( QQ , QS . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; QU . y -= QV . y * texture2D ( QQ , QS . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; QR *= clamp ( QU , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:"} void Rc ( sampler2D QX , inout vec2 QY , vec4 QZ , vec2 Q_ ) { vec2 Ra , Rb ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Ra = step ( Q_ . xy , Q_ . yx ) ; Rb = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * Ra ; Rb /= Ra . x + Ra . y ; Ra = vec2 ( 1.0 , 1.0 ) ; Ra . x -= Rb . x * texture2D ( QX , QZ . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; Ra . x -= Rb . y * texture2D ( QX , QZ . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; Ra . y -= Rb . x * texture2D ( QX , QZ . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; Ra . y -= Rb . y * texture2D ( QX , QZ . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; QY *= clamp ( Ra , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 Rq ( vec2 Rd , vec2 Re , sampler2D Rf , sampler2D Rg , sampler2D Rh , vec4 Ri ) { float Rj , Rk ; vec3 Rl ; vec2 Rm , Rn , Ro ; vec4 Rp ; Rp = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; Rm = texture2D ( Rf , Rd ) . rg ; if ( Rm . g > 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"Rp . rg = PX ( Rf , Rg , Rd , Rm , Ri ) ; if ( Rp . r == - Rp . g ) {".split(" ")}]}}]},{type:"textline",a:"; Rl . x = Qk ( Rf , Rh , OC . xy , OE . x ) ; Rl . y = OD . y ; Rn . x = Rl . x ; Rj = texture2D ( Rf , Rl . xy , 0.0 ) . r ; Rl . z = Qs ( Rf , Rh , OC . zw , OE . y ) ; Rn . y = Rl . z ; Rn = abs ( OZ ( Rn / u_texel_size . xx - Re . xx ) ) ; Ro = sqrt ( Rn ) ; Rk = texture2D ( Rf , Rl . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; Rp . rg = QP ( Rg , Ro , Rj , Rk , Ri . y ) ; Rl . y = Rd . y ; QW ( Rf , Rp . rg , Rl . xyzy , Rn ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"} else Rm . r = 0.0 ;".split(" ")}]}}]},{type:"textline",a:"} if ( Rm . r > 0.0 ) { ; Rl . y = QA ( Rf , Rh , OD . xy , OE . z ) ; Rl . x = OC . x ; Rm . x = Rl . y ; Rk = texture2D ( Rf , Rl . xy , 0.0 ) . g ; Rl . z = QI ( Rf , Rh , OD . zw , OE . w ) ; Rm . y = Rl . z ; Rm = abs ( OZ ( Rm / u_texel_size . yy - Re . yy ) ) ; Rn = sqrt ( Rm ) ; Rj = texture2D ( Rf , Rl . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; Rp . ba = QP ( Rg , Rn , Rk , Rj , Ri . x ) ; Rl . x = Rd . x ; Rc ( Rf , Rp . ba , Rl . xyxz , Rm ) ; } return Rp ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 RC ( vec2 Rr , sampler2D Rs , sampler2D Rt".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","Ru"]}]}}]},{type:"textline",a:") { bool Rv ; vec2 Rw , Rx , Ry ; vec4 Rz , RA , RB ; Rz . x = texture2D ( Rt , OB . xy ) . a ; Rz . y = texture2D ( Rt , OB . zw ) . g ; Rz . wz = texture2D ( Rt , Rr ) . xz ; if ( dot ( Rz , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { RA = texture2D ( Rs , Rr , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"RB = texture2D ( Ru , bM ) ; Rw = 2.0 * ag ( RB ) - 1.0 ; RA . a = sqrt ( 2.0 * length ( Rw ) ) ;".split(" ")}]}}]},{type:"textline",a:"return RA ; } else { Rv = max ( Rz . x , Rz . z ) > max ( Rz . y , Rz . w ) ; RA = vec4 ( 0.0 , Rz . y , 0.0 , Rz . w ) ; Rw = Rz . yw ; OU ( bvec4 ( Rv , Rv , Rv , Rv ) , RA , vec4 ( Rz . x , 0.0 , Rz . z , 0.0 ) ) ; OU ( bvec2 ( Rv , Rv ) , Rw , Rz . xz ) ; Rw /= dot ( Rw , vec2 ( 1.0 , 1.0 ) ) ; RA = RA * vec4 ( u_texel_size , - u_texel_size ) + Rr . xyxy ; Rz = Rw . x * texture2D ( Rs , RA . xy , 0.0 ) ; Rz += Rw . y * texture2D ( Rs , RA . zw , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"RB = texture2D ( Ru , RA . xy ) ; Rx = 2.0 * ag ( RB ) - 1.0 ; Ry = Rw . x * Rx ; RB = texture2D ( Ru , RA . zw ) ; Rx = 2.0 * ag ( RB ) - 1.0 ; Ry += Rw . y * Rx ; Rz . a = sqrt ( 2.0 * length ( Ry ) ) ;".split(" ")}]}}]},{type:"textline",a:["return","Rz",";","}","}"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"vec4 RM ( vec2 RD , sampler2D RE , sampler2D RF".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","RG"]}]}}]},{type:"textline",a:") { float RH ; vec2 RI ; vec4 RJ , RK , RL ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"RJ = texture2D ( RG , bM ) ; RI = 2.0 * ag ( RJ ) - 1.0 ; RJ = texture2D ( RE , RD ) ; RK = texture2D ( RF , RD - RI ) ; RH = abs ( RJ . a * RJ . a - RK . a * RK . a ) / 2.0 ; RH = 0.5 * clamp ( 1.0 - sqrt ( RH ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; RL = mix ( RJ , RK , RH ) ; RL . a = 1.0 ; return RL ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"RJ = texture2D ( RE , RD ) ; RK = texture2D ( RF , RD ) ; return mix ( RJ , RK , 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:"void main ( ) { vec4 RN ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"RN = vec4 ( Pm ( bM , u_color".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",
b:[{type:"textline",a:[",","u_predication_tex"]}]}}]},{type:"textline",a:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"RN = Rq ( bM , OF , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"RN = RC ( bM , u_color , u_blend".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","u_velocity_tex"]}]}}]},{type:"textline",a:[")",";"]}]}},{type:"elif",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"RN = vec4 ( RM ( bM , u_color , u_color_prev".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","u_velocity_tex"]}]}}]},{type:"textline",a:[")",")",";"]}]}},{type:"else",
group:{type:"group",b:[{type:"textline",a:"RN = texture2D ( u_color , bM ) ;".split(" ")}]}}]},{type:"textline",a:["gl_FragColor","=","RN",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",b:[{type:"define",name:"SMAA_EDGE_DETECTION",a:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",a:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",a:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",a:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",a:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",
a:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",a:["4"]},{type:"textline",a:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","OB",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"varying vec4 OC ; varying vec4 OD ; varying vec4 OE ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","OF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["4"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["8"]}]}},{type:"elif",d:["AA_METHOD",
"AA_METHOD_SMAA_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["32"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void Nk ( vec2 Ng ) { OC = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + Ng . xyxy ; OD = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + Ng . xyxy ; OE = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + Ng . xyxy ; }".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void Nn ( vec2 Nl , out vec2 Nm ) { Nm = Nl / u_texel_size ; OC = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + Nl . xyxy ; OD = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + Nl . xyxy ; OE = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( OC . xz , OD . yw ) ; }".split(" ")}]}},
{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void Np ( vec2 No ) { OB = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + No . xyxy ; }".split(" ")}]}}]},{type:"textline",a:"void main ( ) { bM = 2.0 * a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["Nk","(","bM",")",";"]}]}},{type:"elif",d:["SMAA_PASS",
"SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nn ( bM , OF ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["Np","(","bM",")",";"]}]}}]},{type:"textline",a:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",
a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",a:["1"]},{type:"define",name:"SSAO_QUALITY_16",a:["2"]},{type:"define",name:"SSAO_QUALITY_24",a:["3"]},{type:"define",name:"SSAO_QUALITY_32",a:["4"]},{type:"textline",a:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 bM ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float Nk ( in vec2 Ng ) { return Ow ( u_depth , Ng , u_camera_range ) ; } void main ( ) { float Nl , Nm , Nn , No , Np , Nq ; vec3 Nr , Ns , Nt , Nu ; Nr = texture2D ( u_color , bM ) . rgb ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SSAO_WHITE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( Nr , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",a:"Ns = normalize ( 2.0 * texture2D ( u_ssao_special_tex , bM * 0.25 / u_texel_size ) . rgb - 1.0 ) ; Nl = Nk ( bM ) ; Nm = Nl * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_QUALITY","SSAO_QUALITY_8",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Nv = 8.0 ; const int Nw = 1 ;".split(" ")}]}},
{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_16",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Nv = 16.0 ; const int Nw = 2 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_24",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Nv = 24.0 ; const int Nw = 3 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_32",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Nv = 32.0 ; const int Nw = 4 ;".split(" ")}]}}]},
{type:"textline",a:"Nn = u_ssao_radius_increase * 0.001 ; const float Nx = 1.0 + 2.4 / Nv ; No = 0.0 ; for ( int Ny = 0 ; Ny < Nw ; Ny ++ ) for ( int Nz = - 1 ; Nz <= 1 ; Nz += 2 ) for ( int OG = - 1 ; OG <= 1 ; OG += 2 ) for ( int OH = - 1 ; OH <= 1 ; OH += 2 ) { Nt = reflect ( normalize ( vec3 ( Nz , OG , OH ) ) , Ns ) * ( Nn *= Nx ) ; Nu = vec3 ( bM , Nm ) ; Nu += vec3 ( Nt . xy , Nt . z * Nm * 2.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",
a:"Nu . z -= 1.4 * ( Nu . z - Nm ) * step ( Nm , Nu . z ) ;".split(" ")}]}}]},{type:"textline",a:"Np = Nk ( Nu . xy ) * ( u_camera_range . y - u_camera_range . x ) ; Nq = clamp ( ( Nm - Np ) / Np , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",a:"No += mix ( 1.0 , Nq , step ( Np , Nu . z ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"No += mix ( step ( Nu . z , Np ) , 0.5 , Nq ) ;".split(" ")}]}}]},
{type:"textline",a:"} No = No / Nv ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",a:"No = clamp ( No * No + 0.6 * No , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"No = clamp ( No * No + No , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"Nl = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * Nl ) ; No = mix ( 1.0 , No , Nl ) ; gl_FragColor = vec4 ( Nr , No ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]=
{type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",a:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float Nk ( in vec2 Ng ) { return Ow ( u_depth , Ng , u_camera_range ) ; }".split(" ")}]}}]},
{type:"textline",a:"void main ( ) { vec2 Nl , Nm ; float Nn , No , Np , Nq , Nr , Ns , Nt ; Nn = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"No = Nk ( bM ) ; Np = 0.0 ; Nq = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{type:"textline",a:"Nl = vec2 ( - 2.0 ) ; for ( int Nu = 0 ; Nu < 4 ; ++ Nu ) { for ( int Nv = 0 ; Nv < 4 ; ++ Nv ) { Nm = ( Nl + vec2 ( float ( Nu ) , float ( Nv ) ) ) * u_texel_size ; Nr = texture2D ( u_ssao_mask , bM + Nm ) . a ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"Ns = Nk ( bM + Nm ) ; Nt = 1.0 - clamp ( abs ( Ns - No ) * Nq , 0.0 , 1.0 ) ; Nn += Nr * Nt ; Np += Nt ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Nn","+=","Nr",";"]}]}}]},{type:"textline",a:["}","}"]},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , bM ) . rgb , Nn / Np ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , bM ) . rgb , Nn / 16.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/stereo.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["ANAGLYPH",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void Nt ( vec2 Ng , vec2 Nk , float Nl , sampler2D Nm ) { vec4 Nn ; float No ; vec2 Np , Nq , Nr , Ns ; Np = ( Ng - Nk ) * 2.0 ; Np /= Nl ; No = Np . x * Np . x + Np . y * Np . y ; Np = Np * ( 1.0 + u_distortion_params [ 0 ] * No + u_distortion_params [ 1 ] * No * No ) ; Np = Np * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { Nq = Np * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + No * u_chromatic_aberration_coefs [ 1 ] ) + Nk ; Nr = Np + Nk ; Ns = Np * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + No * u_chromatic_aberration_coefs [ 3 ] ) + Nk ; if ( clamp ( Ns , 0.0 , 1.0 ) != Ns ) { gl_FragColor = vec4 ( 0.0 ) ; } else { Nn = texture2D ( Nm , Nr ) ; gl_FragColor [ 0 ] = texture2D ( Nm , Nq ) . x ; gl_FragColor [ 1 ] = Nn . y ; gl_FragColor [ 2 ] = texture2D ( Nm , Ns ) . z ; gl_FragColor [ 3 ] = Nn . w ; } } else { Np = Np * Nl + Nk ; if ( clamp ( Np , 0.0 , 1.0 ) != Np ) { gl_FragColor = vec4 ( 0.0 ) ; } else { gl_FragColor = texture2D ( Nm , Np ) ; } } }".split(" ")}]}}]},
{type:"textline",a:"void main ( ) { float Nu ; vec2 Nv , Nw ; mat3 Nx , Ny ; vec3 Nz , OG ; vec4 OH , OI ;".split(" ")},{type:"condition",b:[{type:"if",d:["ANAGLYPH"],group:{type:"group",b:[{type:"textline",a:"OH = texture2D ( u_sampler_left , bM ) ; OI = texture2D ( u_sampler_right , bM ) ; Nz = vec3 ( OH [ 0 ] , OH [ 1 ] , OH [ 2 ] ) ; br ( Nz ) ; OG = vec3 ( OI [ 0 ] , OI [ 1 ] , OI [ 2 ] ) ; br ( OG ) ; Nx = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; Ny = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; OG = clamp ( Nx * Nz , 0.0 , 1.0 ) + clamp ( Ny * OG , 0.0 , 1.0 ) ; bu ( OG ) ; gl_FragColor = vec4 ( OG , OH [ 3 ] + OI [ 3 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"if ( u_enable_hmd_stereo != 0 ) { if ( bM [ 0 ] < 0.5 ) { Nv = vec2 ( 2.0 * bM [ 0 ] , bM [ 1 ] ) ; Nw = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; Nu = 2.0 * u_distortion_params [ 3 ] ; Nt ( Nv , Nw , Nu , u_sampler_left ) ; } else { Nw = vec2 ( 2.0 * ( bM [ 0 ] - 0.5 ) , bM [ 1 ] ) ; Nv = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; Nu = 2.0 * u_distortion_params [ 3 ] ; Nt ( Nw , Nv , Nu , u_sampler_right ) ; } } else { gl_FragColor = texture2D ( u_sampler_left , bM ) ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",a:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 bM ; void main ( ) { vec2 Ng ; vec4 Nk , Nl ; float Nm ; Nm = texture2D ( u_depth , bM ) . x ; Nk = vec4 ( bM * 2.0 - 1.0 , 2.0 * Nm - 1.0 , 1.0 ) ; Nl = u_view_proj_inverse * Nk ; Nl = Nl / Nl . w ; Nl = u_view_proj_prev * Nl ; Nl /= Nl . w ; Ng = ( Nk . xy - Nl . xy ) / 4.0 + 0.5 ; Ng = clamp ( Ng , 0.0 , 1.0 ) ; gl_FragColor = V ( Ng ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","float",";"]}]};a["include/math.glslv"]={type:"group",b:[{type:"var",name:"EPSILON",a:["0.0001"]},{type:"textline",a:"float a = 0.0 ; float b = 1.0 ; struct c { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool f ( vec3 d , vec3 e ) { return any ( lessThan ( abs ( d - e ) , vec3 ( EPSILON ) ) ) ; } vec3 i ( in vec4 g , in vec3 h ) { return h + 2.0 * cross ( g . xyz , cross ( g . xyz , h ) + g . w * h ) ; } vec4 k ( in vec4 j ) { return vec4 ( - j . xyz , j . w ) / dot ( j , j ) ; } vec3 p ( vec4 l , vec4 m , vec4 n ) { vec3 o ; o = n . xyz * l . w ; o = i ( m , o ) ; o += l . xyz * n . w ; return o ; } vec3 v ( vec4 q , vec4 r , vec4 s ) { vec4 t ; vec3 u ; u = s . xyz - q . xyz * s . w ; t = k ( r ) ; u = i ( t , u ) ; u /= q . w ; return u ; } mat4 w ( ) { return mat4 ( b , a , a , a , a , b , a , a , a , a , b , a , a , a , a , b ) ; } mat4 y ( float x ) { return mat4 ( b , a , a , a , a , cos ( x ) , sin ( x ) , a , a , - sin ( x ) , cos ( x ) , a , a , a , a , b ) ; } mat4 A ( float z ) { return mat4 ( cos ( z ) , a , - sin ( z ) , a , a , b , a , a , sin ( z ) , a , cos ( z ) , a , a , a , a , b ) ; } mat4 C ( float B ) { return mat4 ( cos ( B ) , sin ( B ) , a , a , - sin ( B ) , cos ( B ) , a , a , a , a , b , a , a , a , a , b ) ; } c E ( in c D ) { return c ( D . a , D . b , normalize ( D . c ) , normalize ( D . d ) , normalize ( D . e ) , D . f ) ; }".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"vec3 L ( vec4 F ) { vec3 G ; float H , I , J ; H = F . x ; I = F . y ; J = F . w ; G . x = ( H + J ) / 2.0 ; G . y = ( I + J ) / 2.0 ; G . z = J ; return G ; }".split(" ")}]}}]},{type:"textline",a:"mat4 O ( mat3 M ) { mat4 N ; N [ 0 ] [ 0 ] = ( b - ( M [ 1 ] [ 2 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) + M [ 2 ] [ 0 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 1 ] = ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) + M [ 2 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 2 ] = ( M [ 1 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) - M [ 2 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 3 ] = a ; N [ 1 ] [ 0 ] = ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) - M [ 2 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 1 ] = ( b - ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) + M [ 2 ] [ 0 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 2 ] = ( M [ 1 ] [ 2 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) + M [ 2 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 3 ] = a ; N [ 2 ] [ 0 ] = ( M [ 1 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) + M [ 2 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 1 ] = ( M [ 1 ] [ 2 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) - M [ 2 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 2 ] = ( b - ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) + M [ 1 ] [ 2 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 3 ] = a ; N [ 3 ] [ 0 ] = M [ 0 ] [ 0 ] ; N [ 3 ] [ 1 ] = M [ 0 ] [ 1 ] ; N [ 3 ] [ 2 ] = M [ 0 ] [ 2 ] ; N [ 3 ] [ 3 ] = 1.0 ; return N ; }".split(" ")}]};
a["include/std_enums.glsl"]={type:"group",b:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",a:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",a:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",a:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",a:["2"]},{type:"define",name:"SHADOW_SRC_NONE",a:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",a:["2"]},{type:"define",name:"SHADOW_SRC_MASK",a:["3"]},{type:"define",name:"SHADOW_DST_NONE",a:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",a:["2"]},
{type:"define",name:"SHADOW_DST_MASK",a:["3"]},{type:"define",name:"NO_SHADOWS",a:["1"]},{type:"define",name:"SHADOW_CASTING",a:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",a:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",a:["4"]},{type:"define",name:"SHADOW_MAPPING_BLEND",a:["5"]},{type:"define",name:"SPECULAR_PHONG",a:["1"]},{type:"define",name:"SPECULAR_COOKTORR",a:["2"]},{type:"define",name:"SPECULAR_WARDISO",a:["3"]},{type:"define",name:"SPECULAR_BLINN",a:["4"]},{type:"define",name:"SPECULAR_TOON",
a:["5"]},{type:"define",name:"DIFFUSE_LAMBERT",a:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",a:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",a:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",a:["4"]},{type:"define",name:"DIFFUSE_TOON",a:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",a:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",a:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",a:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",a:["3.0"]},{type:"define",name:"MIX",a:["0"]},{type:"define",
name:"ADD",a:["1"]},{type:"define",name:"SUBTRACT",a:["2"]},{type:"define",name:"MULTIPLY",a:["3"]},{type:"define",name:"SCREEN",a:["4"]},{type:"define",name:"OVERLAY",a:["5"]},{type:"define",name:"DIFFERENCE",a:["6"]},{type:"define",name:"DIVIDE",a:["7"]},{type:"define",name:"DARKEN",a:["8"]},{type:"define",name:"LIGHTEN",a:["9"]},{type:"define",name:"HUE",a:["10"]},{type:"define",name:"SATURATION",a:["11"]},{type:"define",name:"VALUE",a:["12"]},{type:"define",name:"COLOR",a:["13"]},{type:"define",
name:"SOFT_LIGHT",a:["14"]},{type:"define",name:"LINEAR_LIGHT",a:["15"]},{type:"define",name:"REFL_NONE",a:["0"]},{type:"define",name:"REFL_MIRRORMAP",a:["1"]},{type:"define",name:"REFL_PLANE",a:["2"]},{type:"define",name:"REFL_CUBE",a:["3"]},{type:"define",name:"INVERSE_QUADRATIC",a:["0"]},{type:"define",name:"LINEAR",a:["1"]},{type:"define",name:"QUADRATIC",a:["2"]},{type:"define",name:"HEMI",a:["1"]},{type:"define",name:"SPOT",a:["2"]},{type:"define",name:"POINT",a:["3"]},{type:"define",name:"SUN",
a:["4"]},{type:"define",name:"VT_WORLD_TO_WORLD",a:["0"]},{type:"define",name:"VT_WORLD_TO_OBJECT",a:["1"]},{type:"define",name:"VT_WORLD_TO_CAMERA",a:["2"]},{type:"define",name:"VT_OBJECT_TO_WORLD",a:["3"]},{type:"define",name:"VT_OBJECT_TO_OBJECT",a:["4"]},{type:"define",name:"VT_OBJECT_TO_CAMERA",a:["5"]},{type:"define",name:"VT_CAMERA_TO_WORLD",a:["6"]},{type:"define",name:"VT_CAMERA_TO_OBJECT",a:["7"]},{type:"define",name:"VT_CAMERA_TO_CAMERA",a:["8"]},{type:"define",name:"VT_POINT",a:["0"]},
{type:"define",name:"VT_VECTOR",a:["1"]},{type:"define",name:"VT_NORMAL",a:["2"]}]};a["include/pack.glslf"]={type:"group",b:[{type:"textline",a:"float P = 255.0 ; float Q = 0.0 ; float R = 1.0 ; vec4 V ( const in float S ) { vec4 T , U ; T = vec4 ( P * P * P , P * P , P , R ) ; U = vec4 ( Q , R / P , R / P , R / P ) ; T = fract ( S * T ) ; T -= T . xxyz * U ; return T ; } float Z ( const in vec4 W ) { vec4 X ; float Y ; X = vec4 ( R / ( P * P * P ) , R / ( P * P ) , R / P , R ) ; Y = dot ( W , X ) ; return Y ; } vec4 V ( const in vec2 _ ) { vec4 aa ; vec2 ab , ac ; ab = vec2 ( P , R ) ; ac = vec2 ( Q , R / P ) ; aa = fract ( _ . xxyy * ab . xyxy ) ; aa -= aa . xxzz * ac . xyxy ; if ( _ . r == R ) aa . rg = vec2 ( Q , R ) ; if ( _ . g == R ) aa . ba = vec2 ( Q , R ) ; return aa ; } vec2 ag ( const in vec4 ad ) { vec2 ae , af ; af = vec2 ( R / P , R ) ; ae . r = dot ( ad . rg , af ) ; ae . g = dot ( ad . ba , af ) ; return ae ; }".split(" ")}]};
a["include/procedural.glslf"]={type:"group",b:[{type:"textline",a:"float ah = 0.0 ; float ai = 1.0 ; vec4 ak ( vec4 aj ) { return aj - floor ( aj * ( ai / 289.0 ) ) * 289.0 ; } vec3 ak ( vec3 al ) { return al - floor ( al * ( ai / 289.0 ) ) * 289.0 ; } vec2 ak ( vec2 am ) { return am - floor ( am * ( ai / 289.0 ) ) * 289.0 ; } vec4 ao ( vec4 an ) { return an - floor ( an * ( ai / 7.0 ) ) * 7.0 ; } vec4 aq ( vec4 ap ) { return ak ( ( 34.0 * ap + 5.0 ) * ap ) ; }".split(" ")},{type:"define",name:"K",
a:["0.142857142857"]},{type:"define",name:"K2",a:["0.0714285714285"]},{type:"define",name:"JITTER",a:["0.7"]},{type:"textline",a:"vec2 ay ( vec2 ar ) { vec4 as , at , au , av ; vec2 aw , ax ; aw = ak ( floor ( ar ) ) ; ax = fract ( ar ) ; as = ax . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; at = ax . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; au = aq ( aw . x + vec4 ( ah , ai , ah , ai ) ) ; au = aq ( au + aw . y + vec4 ( ah , ah , ai , ai ) ) ; av = ao ( au ) * K + K2 ; au = ao ( floor ( au * K ) ) * K + K2 ; av = as + JITTER * av ; au = at + JITTER * au ; au = av * av + au * au ;".split(" ")},
{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"textline",a:"au . xy = min ( au . xy , au . zw ) ; au . x = min ( au . x , au . y ) ; return au . xx ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"au . xy = ( au . x < au . y ) ? au . xy : au . yx ; au . xz = ( au . x < au . z ) ? au . xz : au . zx ; au . xw = ( au . x < au . w ) ? au . xw : au . wx ; au . y = min ( au . y , au . z ) ; au . y = min ( au . y , au . w ) ; return sqrt ( au . xy ) ;".split(" ")}]}}]},
{type:"textline",a:"} vec3 aH ( vec2 az , float aA ) { vec4 aB , aC , aD , aE ; vec2 aF , aG ; aF = ak ( floor ( az ) ) ; aG = fract ( az ) ; aB = aG . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; aC = aG . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; aD = aq ( aF . x + vec4 ( ah , ai , ah , ai ) ) ; aD = aq ( aD + aF . y + vec4 ( ah , ah , ai , ai ) ) ; aE = ao ( aD ) * K + K2 ; aD = ao ( floor ( aD * K ) ) * K + K2 ; aE = aB + JITTER * aE ; aD = aC + JITTER * aD ; aC = aE * aE + aD * aD ; aE += aA ; aD += aA ; aB = aE * aE + aD * aD ; aE += aA ; aD += aA ; aD = aE * aE + aD * aD ; aC . xy = min ( aC . xy , aC . zw ) ; aC . x = min ( aC . x , aC . y ) ; aB . xy = min ( aB . xy , aB . zw ) ; aB . x = min ( aB . x , aB . y ) ; aD . xy = min ( aD . xy , aD . zw ) ; aD . x = min ( aD . x , aD . y ) ; return vec3 ( aC . x , aB . x , aD . x ) ; } vec3 aJ ( vec3 aI ) { return ak ( ( ( aI * 34.0 ) + ai ) * aI ) ; } float aU ( vec2 aK ) { vec3 aL , aM , aN , aO ; vec4 aP ; vec2 aQ , aR , aS ; const vec4 aT = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; aQ = floor ( aK + dot ( aK , aT . yy ) ) ; aR = aK - aQ + dot ( aQ , aT . xx ) ; aS = ( aR . x > aR . y ) ? vec2 ( ai , ah ) : vec2 ( ah , ai ) ; aP = aR . xyxy + aT . xxzz ; aP . xy -= aS ; aQ = ak ( aQ ) ; aL = aJ ( aJ ( aQ . y + vec3 ( ah , aS . y , ai ) ) + aQ . x + vec3 ( ah , aS . x , ai ) ) ; aM = max ( 0.5 - vec3 ( dot ( aR , aR ) , dot ( aP . xy , aP . xy ) , dot ( aP . zw , aP . zw ) ) , ah ) ; aM = aM * aM ; aM = aM * aM ; aL = 2.0 * fract ( aL * aT . www ) - ai ; aN = abs ( aL ) - 0.5 ; aO = floor ( aL + 0.5 ) ; aO = aL - aO ; aM *= 1.79284291400159 - 0.85373472095314 * ( aO * aO + aN * aN ) ; aL . x = aO . x * aR . x + aN . x * aR . y ; aL . yz = aO . yz * aP . xz + aN . yz * aP . yw ; return 130.0 * dot ( aM , aL ) ; } vec2 aY ( vec2 aV ) { float aW , aX ; aW = dot ( aV , vec2 ( 12.9898 , 78.233 ) ) ; aX = dot ( aV , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; aW = fract ( sin ( aW ) * 43758.5453 ) * 2.0 - ai ; aX = fract ( sin ( aX ) * 43758.5453 ) * 2.0 - ai ; return vec2 ( aW , aX ) ; }".split(" ")}]};
a["include/caustics.glslf"]={type:"group",b:[{type:"var",name:"CAUST_SPEED",a:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",a:["0.0"]},{type:"var",name:"CAUST_BRIGHT",a:["0.0"]},{type:"var",name:"SUN_NUM",a:["0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",a:["100.0"]},{type:"textline",a:"void bp ( inout vec3 aZ , float a_ , float ba , vec4 bb , vec3 bc , vec3 bd , vec3 be , vec4 bf , vec3 bg , float bh ) { float bi , bj , bk ; vec2 bl , bm ; vec3 bn ; vec4 bo ; if ( bh > CAUSTICS_VIEW_DISTANCE ) return ; bo = bf ; bn = bg + bc ; bn . xz = 10.0 * sin ( 0.1 * bn . xz ) ; bn = bn + 2.0 * cross ( - bo . xyz , cross ( - bo . xyz , bn ) + bo . w * bn ) ; bl = bn . xz ; bn = bd ; bi = max ( dot ( bc , bn ) , 0.0 ) ; bj = 0.025 ; bm = CAUST_SPEED * ba ; bl . s += 0.25 * sin ( dot ( bg + ba , vec3 ( 1.0 ) ) ) ; bl . t += 0.35 * ( - sin ( dot ( bg - ba , vec3 ( - 0.7 ) ) ) ) ; bl . st += 0.15 * cos ( 4.0 * a_ - bm . x ) + 1.5 * sin ( a_ - 0.3 * bm . y ) ; bk = CAUST_SCALE * ( 1.0 + max ( 0.1 * a_ , 0.0 ) ) ; bn = aH ( ( bl / bk ) , bj ) ; bn *= CAUST_BRIGHT ; bn *= bn ; bj = min ( 0.25 * a_ , - a_ ) + 1.0 ; bj = max ( bj , 0.0 ) ; bi = bb [ SUN_NUM ] * bi ; bk = max ( sign ( a_ ) , 0.0 ) ; bi = bi + max ( 0.5 * sign ( - bc . y ) * bk , 0.0 ) ; bi = min ( bi , 1.0 ) ; aZ += be * bn * bj * bi ; }".split(" ")}]};
a["include/color_util.glslf"]={type:"group",b:[{type:"define",name:"GAMMA",a:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",a:["1"]},{type:"textline",a:"void br ( inout vec3 bq ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",a:"bq = max ( vec3 ( 0.0 ) , bq ) ; bq = pow ( bq , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",a:"} void br ( inout float bs ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",
a:"bs = pow ( max ( 0.0 , bs ) , 2.2 ) ;".split(" ")}]}}]},{type:"textline",a:"} void bu ( inout vec3 bt ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",a:"bt = max ( vec3 ( 0.0 ) , bt ) ; bt = pow ( bt , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",a:"} void bx ( inout vec3 bv , in float bw ) {".split(" ")},{type:"condition",b:[{type:"if",d:["PREMULTIPLY_ALPHA"],group:{type:"group",b:[{type:"textline",a:"bv = bv * bw ;".split(" ")}]}}]},
{type:"textline",a:"} float bB ( vec4 by ) { float bz ; vec3 bA ; bA = vec3 ( 0.299 , 0.587 , 0.114 ) ; bz = dot ( by . rgb , bA ) ; return bz ; }".split(" ")}]};a["include/shadow.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",a:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",a:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float bN = 0.1 ; const float bO = 0.1 ; const float bP = - 0.01 ; const float bQ = 0.05 ; vec4 bR = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 bS = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 bT = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 bU = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 bV = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 bW = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 bX = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 bY = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool ca ( vec2 bZ , float b_ ) { return all ( lessThanEqual ( bZ , vec2 ( 1.0 + b_ ) ) ) && all ( greaterThanEqual ( bZ , vec2 ( 0.0 - b_ ) ) ) ; } float cj ( float cb , float cc , mat2 cd , vec3 ce , float cf , PRECISION sampler2D cg ) { vec2 ch , ci ; ci . x = cb ; ci . y = cc ; ci = cd * ci ; ch = ce . xy + ci * cf / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"if ( ! ca ( ch , bP ) ) return 1.0 ; else".split(" ")}]}}]},{type:"textline",a:"return step ( ce . z , texture2D ( cg , ch ) . r ) ; } float cs ( vec3 ck , PRECISION sampler2D cl , float cm ) { mat2 cn ; float co , cp , cq ; co = 0.0 ; ck . z = clamp ( ck . z , 0.0 , 1.0 ) ; cp = aY ( ck . xy ) . x * M_PI ; cq = cos ( cp ) ; cp = sin ( cp ) ; cn = mat2 ( cq , cp , - cp , cq ) ; for ( int cr = 0 ; cr < 4 ; cr ++ ) { co += cj ( bR [ cr ] , bV [ cr ] , cn , ck , cm , cl ) ; co += cj ( bS [ cr ] , bW [ cr ] , cn , ck , cm , cl ) ; co += cj ( bT [ cr ] , bX [ cr ] , cn , ck , cm , cl ) ; co += cj ( bU [ cr ] , bY [ cr ] , cn , ck , cm , cl ) ; } return clamp ( co / 16.0 , 0.0 , 1.0 ) ; } float cH ( vec3 ct , PRECISION sampler2D cu , vec3 cv , PRECISION sampler2D cw , float cx , float cy , float cz ) { mat2 cA ; float cB , cC , cD , cE ; ct . z = clamp ( ct . z , 0.0 , 1.0 ) ; cv . z = clamp ( cv . z , 0.0 , 1.0 ) ; cB = 0.0 ; cC = 0.0 ; cD = aY ( ct . xy ) . x * M_PI ; cE = cos ( cD ) ; cD = sin ( cD ) ; cA = mat2 ( cE , cD , - cD , cE ) ; for ( int cF = 0 ; cF < 4 ; cF ++ ) { cB += cj ( bR [ cF ] , bV [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bS [ cF ] , bW [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bT [ cF ] , bX [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bU [ cF ] , bY [ cF ] , cA , ct , cx , cu ) ; } for ( int cG = 0 ; cG < 4 ; cG ++ ) { cC += cj ( bR [ cG ] , bV [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bS [ cG ] , bW [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bT [ cG ] , bX [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bU [ cG ] , bY [ cG ] , cA , cv , cy , cw ) ; } cB = mix ( cB , cC , cz ) ; cB /= 16.0 ; return clamp ( cB , 0.0 , 1.0 ) ; } float cL ( vec2 cI ) { float cJ , cK ; cJ = min ( cI . x , cI . y ) ; cK = min ( 1.0 - cI . x , 1.0 - cI . y ) ; return min ( cJ , cK ) ; } float cO ( float cM , float cN ) { if ( cN >= 0.0 && cN <= bO ) cM = ( cM - 1.0 ) / bO * cN + 1.0 ; return cM ; } float cZ ( vec3 cP , vec3 cQ , PRECISION sampler2D cR , PRECISION sampler2D cS , float cT , float cU , float cV , float cW ) { float cX , cY ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",b:[{type:"textline",a:"cY = cL ( cP . xy ) ; if ( - cW > cV && cY >= 0.0 && cY <= bN && ca ( cQ . xy , 0.0 ) ) { cY = 1.0 - cY / bN ; cX = cH ( cP , cR , cQ , cS , cT , cU , cY ) ; } else".split(" ")}]}}]},{type:"textline",a:"cX = cs ( cP , cR , cT ) ; return cX ; } float dg ( vec3 c_ , PRECISION sampler2D da , float db , float dc , float dd ) { float de , df ; de = cs ( c_ , da , db ) ;".split(" ")},{type:"condition",
b:[{type:"if",d:["CSM_FADE_LAST_CASCADE"],group:{type:"group",b:[{type:"textline",a:"if ( - dd > dc ) { df = cL ( c_ . xy ) ; de = cO ( de , df ) ; }".split(" ")}]}}]},{type:"textline",a:"return de ; } vec4 dr ( float dh ) { vec3 di , dj , dk , dl ; float dm , dn , dp , dq ; dm = 1.0 ; di = bI . xyz / bI . w ; if ( bI . w < 0.0 ) di . z = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"dj = bJ . xyz / bJ . w ; if ( bJ . w < 0.0 ) dj . z = 0.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dk = bK . xyz / bK . w ; if ( bK . w < 0.0 ) dk . z = 0.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dl = bL . xyz / bL . w ; if ( bL . w < 0.0 ) dl . z = 0.0 ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",b:[{type:"textline",a:"if ( ca ( di . xy , 0.0 ) ) { dm = cZ ( di , dj , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , dh ) ; }".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"if ( ca ( di . xy , bQ ) ) { dm = dg ( di , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , dh ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["CSM_SECTION1"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dj . xy , 0.0 ) ) {".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",a:"dm = cZ ( dj , dk , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , dh ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dm = dg ( dj , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , dh ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dk . xy , 0.0 ) ) {".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"dm = cZ ( dk , dl , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , dh ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dm = dg ( dk , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , dh ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dl . xy , 0.0 ) ) dm = dg ( dl , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , dh ) ; }".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dn = cs ( dj , u_shadow_map1 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["dn","=","0.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dp = cs ( dk , u_shadow_map2 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["dp","=","0.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dq = cs ( dl , u_shadow_map3 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["dq","=","1.0",";"]}]}}]},{type:"textline",a:"return vec4 ( dm , dn , dp , dq ) ; }".split(" ")}]}}]},{type:"textline",a:"vec4 du ( inout vec3 ds ) { vec4 dt ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dt = texture2DProj ( u_shadow_mask , bG ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"l_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"ds *= dt . a ;".split(" ")}]}}]},{type:"textline",a:["return","dt",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dt = dr ( bD . z ) ; return dt ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};
a["include/mirror.glslf"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"define",name:"REFL_BUMP",a:["0.1"]},{type:"textline",a:"float dB ( in vec3 dv , vec3 dw , float dx , float dy ) { float dz ; vec3 dA ; dA = normalize ( dw + dv ) ; dz = 1.0 - dot ( dv , dA ) ; dz = dy + ( 1.0 - dy ) * pow ( dz , dx ) ; return dz ; } void dP ( inout vec3 dC , vec3 dD , vec3 dE , float dF , mat4 dG ) { vec2 dH , dI ; float dJ , dK , dL ; vec3 dM , dN , dO ; dM = reflect ( - dD , dE ) ; dJ = u_fresnel_params [ 2 ] ; dK = u_fresnel_params [ 3 ] ; dL = 1.0 ; if ( dJ != 0.0 ) dL = dB ( dD , dM , dJ , dK ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dN = textureCube ( u_cube_reflection , dM ) . xyz ;".split(" ")}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_PASS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"dO = u_refl_plane . xyz * dot ( dE , u_refl_plane . xyz ) ; dO = dE - dO ; dH = ( dG * vec4 ( dO , 0.0 ) ) . xy ; dI = bG . xy / bG . z ; dI += dH * REFL_BUMP ; dN = texture2D ( u_plane_reflection , dI ) . rgb ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"dN = vec3 ( 1.0 ) ; dF = 0.0 ;".split(" ")}]}}]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dN = textureCube ( u_mirrormap , dM ) . xyz ; dF = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",a:"br ( dN . rgb ) ; dC = mix ( dC , dN , dF * dL ) ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",b:[{type:"textline",a:"vec3 dS ( vec3 dQ ) { float dR ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SKY_TEXTURE"],group:{type:"group",b:[{type:"textline",a:"return textureCube ( u_sky_texture , dQ ) . rgb ;".split(" ")}]}},{type:"elif",d:["SKY_COLOR"],group:{type:"group",b:[{type:"textline",a:"dR = 0.5 * dQ . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , dR ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["include/refraction.glslf"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_REFRACTION_CORRECTION"],group:{type:"group",b:[{type:"textline",a:"float dY ( in float dT , inout vec2 dU , in vec2 dV ) { float dW ; vec4 dX ; dX = texture2D ( u_scene_depth , dU ) ; dW = Z ( dX ) ; if ( dW < bH ) { dU = dV ; return dT ; } else { return dW ; } return dT ; }".split(" ")}]}}]},
{type:"textline",a:"vec3 ef ( in vec3 dZ , in vec2 d_ ) { vec3 ea ; float eb ; vec4 ec ; vec2 ed , ee ; ed = dZ . xy / dZ . z ; ee = ed + d_ ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_REFRACTION_CORRECTION"],group:{type:"group",b:[{type:"textline",a:"ec = texture2DProj ( u_scene_depth , dZ ) ; eb = Z ( ec ) ; dY ( eb , ee , ed ) ;".split(" ")}]}}]},{type:"textline",a:"ea = texture2D ( u_refractmap , ee ) . rgb ; br ( ea ) ; return ea ; }".split(" ")}]}}]}]};a["include/nodes.glslf"]={type:"group",
b:[{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",
a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NODE_TEX_ROW",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","eg",";"]}]}}]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float eh = 0.5 ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:"vec3 el ( in vec3 ei , in float ej ) { vec3 ek ; ek = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",b:[{type:"textline",a:"ek = ef ( bG , ei . xy * ej ) ;".split(" ")}]}},
{type:"elif",d:["HAS_REFRACT_TEXTURE"],group:{type:"group",b:[{type:"textline",a:"ek = texture2D ( u_refractmap , bG . xy / bG . z ) . rgb ; br ( ek ) ;".split(" ")}]}}]},{type:"textline",a:["return","ek",";","}"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 eq ( vec3 em ) { float en , eo ; vec4 ep ; ep = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; ep = mix ( vec4 ( em . bg , ep . wz ) , vec4 ( em . gb , ep . xy ) , step ( em . b , em . g ) ) ; ep = mix ( vec4 ( ep . xyw , em . r ) , vec4 ( em . r , ep . yzx ) , step ( ep . x , em . r ) ) ; en = ep . x - min ( ep . w , ep . y ) ; eo = 1.0e-10 ; return vec3 ( abs ( ep . z + ( ep . w - ep . y ) / ( 6.0 * en + eo ) ) , en / ( ep . x + eo ) , ep . x ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 eu ( vec3 er ) { vec3 es ; vec4 et ; et = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; es = abs ( fract ( vec3 ( er . r , er . r , er . r ) + et . xyz ) * 6.0 - et . www ) ; return er . b * mix ( et . xxx , clamp ( es - et . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , er . g ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec3 ew ( vec2 ev ) { return vec3 ( ev * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec2 ey ( vec3 ex ) { return vec2 ( ex . xy * eh + vec2 ( eh , eh ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",h:[{type:"node_out",name:"fq",qualifier:["vec3"],c:!0},{type:"node_out",name:"fr",qualifier:["float"],c:!0},{type:"node_out",name:"fs",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fq"],f:[{type:"textline",a:"fq = normalize ( fh . xyz ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fr"],f:[{type:"textline",a:"fr = abs ( fh . z ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fs"],
f:[{type:"textline",a:"fs = length ( fh . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",h:[{type:"node_in",name:"ft",qualifier:["float"],c:!1},{type:"node_in",name:"fu",qualifier:["float"],c:!1},{type:"node_in",name:"fv",qualifier:["float"],c:!1},{type:"node_out",name:"fw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fw = vec3 ( ft , fu , fv ) ;".split(" ")}]},{type:"node",name:"COMBHSV",h:[{type:"node_in",name:"fx",qualifier:["float"],c:!1},{type:"node_in",name:"fy",qualifier:["float"],
c:!1},{type:"node_in",name:"fz",qualifier:["float"],c:!1},{type:"node_out",name:"fA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fA = eu ( vec3 ( fx , fy , fz ) ) ;".split(" ")}]},{type:"node",name:"EMPTY_UV",h:[{type:"node_out",name:"fB",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fB = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"EMPTY_VC",h:[{type:"node_out",name:"fC",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fC = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[{type:"node_out",name:"fD",qualifier:["vec3"],c:!1},{type:"node_param",name:"ez",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"fD = ew ( ez ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",h:[{type:"node_out",name:"fE",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fE = 2.0 * eg - vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_out",name:"fF",qualifier:["vec3"],c:!1},{type:"node_param",name:"eA",qualifier:["varying",
"vec3"],c:!1}],f:[{type:"textline",a:"fF = eA ; br ( fF ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_out",name:"fG",qualifier:["float"],c:!1},{type:"node_param",name:"eB",qualifier:["varying","float"],c:!1}],f:[{type:"textline",a:"fG = eB ; br ( fG ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_out",name:"fH",qualifier:["float"],c:!1},{type:"node_out",name:"fI",qualifier:["float"],c:!1},{type:"node_param",name:"eC",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",
a:"fH = eC [ 0 ] ; fI = eC [ 1 ] ; br ( fH ) ; br ( fI ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_out",name:"fJ",qualifier:["float"],c:!1},{type:"node_out",name:"fK",qualifier:["float"],c:!1},{type:"node_out",name:"fL",qualifier:["float"],c:!1},{type:"node_param",name:"eD",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:"fJ = eD [ 0 ] ; fK = eD [ 1 ] ; fL = eD [ 2 ] ; br ( fJ ) ; br ( fK ) ; br ( fL ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_NO",h:[{type:"node_out",
name:"fM",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fM = fk . xzy ; fM . y *= - 1.0 ;".split(" ")}]},{type:"node",name:"GEOMETRY_FB",h:[{type:"node_out",name:"fN",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["INVERT_FRONTFACING"],f:[{type:"textline",a:"fN = ( gl_FrontFacing ) ? ZERO_VALUE_NODES : UNITY_VALUE_NODES ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"fN = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]}]}]},{type:"node",
name:"GEOMETRY_VW",h:[{type:"node_out",name:"fO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fO = - ( eN * vec4 ( eM , 0.0 ) ) . xyz ;".split(" ")}]},{type:"node",name:"GEOMETRY_LO",h:[{type:"node_out",name:"fP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fP [ 0 ] = fh [ 0 ] ; fP [ 1 ] = fh [ 1 ] ; fP [ 2 ] = fh [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",h:[{type:"node_out",name:"fQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fQ = vec3 ( fl . r , - fl . b , fl . g ) ;".split(" ")}]},
{type:"node",name:"NEW_GEOMETRY",h:[{type:"node_out",name:"fR",qualifier:["vec3"],c:!1},{type:"node_out",name:"fS",qualifier:["vec3"],c:!1},{type:"node_out",name:"fT",qualifier:["vec3"],c:!1},{type:"node_out",name:"fU",qualifier:["vec3"],c:!1},{type:"node_out",name:"fV",qualifier:["vec3"],c:!1},{type:"node_out",name:"fW",qualifier:["vec3"],c:!1},{type:"node_out",name:"fX",qualifier:["float"],c:!1},{type:"node_out",name:"fY",qualifier:["float"],c:!1}],f:[{type:"textline",a:"fR = vec3 ( ZERO_VALUE_NODES ) ; fS = vec3 ( ZERO_VALUE_NODES ) ; fT = vec3 ( ZERO_VALUE_NODES ) ; fU = vec3 ( ZERO_VALUE_NODES ) ; fV = vec3 ( ZERO_VALUE_NODES ) ; fW = vec3 ( ZERO_VALUE_NODES ) ; fX = ZERO_VALUE_NODES ; fY = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"HUE_SAT",h:[{type:"node_in",name:"fZ",qualifier:["float"],c:!1},{type:"node_in",name:"f_",qualifier:["float"],c:!1},{type:"node_in",name:"ga",qualifier:["float"],c:!1},{type:"node_in",name:"gb",qualifier:["float"],c:!1},{type:"node_in",name:"gc",qualifier:["vec3"],c:!1},{type:"node_out",name:"gd",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fn = eq ( gc ) ; fn [ 0 ] += ( fZ - eh ) ; if ( fn [ 0 ] > UNITY_VALUE_NODES ) fn [ 0 ] -= UNITY_VALUE_NODES ; else if ( fn [ 0 ] < ZERO_VALUE_NODES ) fn [ 0 ] += UNITY_VALUE_NODES ; fn *= vec3 ( UNITY_VALUE_NODES , f_ , ga ) ; fn = mix ( vec3 ( UNITY_VALUE_NODES ) , mix ( vec3 ( ZERO_VALUE_NODES ) , fn , step ( vec3 ( ZERO_VALUE_NODES ) , fn ) ) , step ( fn , vec3 ( UNITY_VALUE_NODES ) ) ) ; gd = mix ( gc , eu ( fn ) , gb ) ;".split(" ")}]},
{type:"node",name:"INVERT",h:[{type:"node_in",name:"ge",qualifier:["float"],c:!1},{type:"node_in",name:"gf",qualifier:["vec3"],c:!1},{type:"node_out",name:"gg",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"gg = mix ( gf , vec3 ( UNITY_VALUE_NODES ) - gf , ge ) ;".split(" ")}]},{type:"node",name:"LAMP",h:[{type:"node_out",name:"gh",qualifier:["vec3"],c:!0},{type:"node_out",name:"gi",qualifier:["vec3"],c:!1},{type:"node_out",name:"gj",qualifier:["float"],c:!1},{type:"node_out",name:"gk",qualifier:["float"],
c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gh"],f:[{type:"textline",a:"gh = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",a:"fi = u_lamp_light_factors [ LAMP_INDEX ] ; fn = u_lamp_light_directions [ LAMP_INDEX ] ; fo = u_lamp_light_positions [ LAMP_INDEX ] ; fa = fi . z ; if ( fa != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",a:"gi = bC - fo ; gj = length ( gi ) ; gi = normalize ( gi ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_gk"],f:[{type:"textline",a:"gk = fa / ( fa + gj * gj ) ; fa = fi . x ; fb = fi . y ; if ( fa > - UNITY_VALUE_NODES ) { fc = dot ( - gi , fn ) ; fc *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fc - fa ) / fb ) ; gk *= fc ; }".split(" ")}]}]},{type:"textline",a:["}","else","{"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gi"],f:[{type:"textline",a:["gi","=","fn",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gj"],f:[{type:"textline",a:"gj = length ( fo - bC ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gk"],f:[{type:"textline",a:["gk","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",a:["}"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gi"],f:[{type:"textline",a:"gi . yz = vec2 ( - gi . z , gi . y ) ;".split(" ")}]}]}]},{type:"node",name:"NORMAL",h:[{type:"node_in",name:"gl",qualifier:["vec3"],c:!1},{type:"node_out",name:"gm",qualifier:["vec3"],c:!0},{type:"node_out",name:"gn",qualifier:["float"],c:!0},{type:"node_param",name:"eE",
qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gm"],f:[{type:"textline",a:["gm","=","eE",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gn"],f:[{type:"textline",a:"gn = - dot ( gl , eE ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",h:[{type:"node_in",name:"go",qualifier:["vec3"],c:!1},{type:"node_out",name:"gp",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"gp = - ( eO * vec4 ( go , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",
name:"BSDF_ANISOTROPIC",h:[{type:"node_in",name:"gq",qualifier:["vec3"],c:!1},{type:"node_in",name:"gr",qualifier:["float"],c:!1},{type:"node_in",name:"gs",qualifier:["float"],c:!1},{type:"node_in",name:"gt",qualifier:["float"],c:!1},{type:"node_in",name:"gu",qualifier:["vec3"],c:!1},{type:"node_in",name:"gv",qualifier:["vec3"],c:!1},{type:"node_out",name:"gw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gw","=","gq",";"]},{type:"textline",a:"gr ; gs ; gt ; gu ; gv ;".split(" ")}]},{type:"node",
name:"BSDF_DIFFUSE",h:[{type:"node_in",name:"gx",qualifier:["vec3"],c:!1},{type:"node_in",name:"gy",qualifier:["float"],c:!1},{type:"node_in",name:"gz",qualifier:["vec3"],c:!1},{type:"node_out",name:"gA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gA","=","gx",";"]},{type:"textline",a:["gy",";","gz",";"]}]},{type:"node",name:"BSDF_GLASS",h:[{type:"node_in",name:"gB",qualifier:["vec3"],c:!1},{type:"node_in",name:"gC",qualifier:["float"],c:!1},{type:"node_in",name:"gD",qualifier:["float"],c:!1},
{type:"node_in",name:"gE",qualifier:["vec3"],c:!1},{type:"node_out",name:"gF",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gF","=","gB",";"]},{type:"textline",a:"gC ; gD ; gE ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",h:[{type:"node_in",name:"gG",qualifier:["vec3"],c:!1},{type:"node_in",name:"gH",qualifier:["float"],c:!1},{type:"node_in",name:"gI",qualifier:["vec3"],c:!1},{type:"node_out",name:"gJ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gJ","=","gG",";"]},{type:"textline",a:["gH",
";","gI",";"]}]},{type:"node",name:"BSDF_HAIR",h:[{type:"node_in",name:"gK",qualifier:["vec3"],c:!1},{type:"node_in",name:"gL",qualifier:["float"],c:!1},{type:"node_in",name:"gM",qualifier:["float"],c:!1},{type:"node_in",name:"gN",qualifier:["float"],c:!1},{type:"node_out",name:"gO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gO","=","gK",";"]},{type:"textline",a:"gL ; gM ; gN ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",h:[{type:"node_in",name:"gP",qualifier:["vec3"],c:!1},{type:"node_out",
name:"gQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gQ","=","gP",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",h:[{type:"node_in",name:"gR",qualifier:["vec3"],c:!1},{type:"node_in",name:"gS",qualifier:["vec3"],c:!1},{type:"node_out",name:"gT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gT","=","gR",";"]},{type:"textline",a:["gS",";"]}]},{type:"node",name:"BSDF_REFRACTION",h:[{type:"node_in",name:"gU",qualifier:["vec3"],c:!1},{type:"node_in",name:"gV",qualifier:["float"],c:!1},{type:"node_in",
name:"gW",qualifier:["float"],c:!1},{type:"node_in",name:"gX",qualifier:["vec3"],c:!1},{type:"node_out",name:"gY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"gY [ 0 ] = gY [ 1 ] = gY [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"gU ; gV ; gW ; gX ;".split(" ")}]},{type:"node",name:"BSDF_TOON",h:[{type:"node_in",name:"gZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"g_",qualifier:["float"],c:!1},{type:"node_in",name:"ha",qualifier:["float"],c:!1},{type:"node_in",name:"hb",qualifier:["vec3"],
c:!1},{type:"node_out",name:"hc",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hc","=","gZ",";"]},{type:"textline",a:"g_ ; ha ; hb ;".split(" ")}]},{type:"node",name:"BSDF_VELVET",h:[{type:"node_in",name:"hd",qualifier:["vec3"],c:!1},{type:"node_in",name:"he",qualifier:["float"],c:!1},{type:"node_in",name:"hf",qualifier:["vec3"],c:!1},{type:"node_out",name:"hg",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hg","=","hd",";"]},{type:"textline",a:["he",";","hf",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",
h:[{type:"node_in",name:"hh",qualifier:["vec3"],c:!1},{type:"node_in",name:"hi",qualifier:["float"],c:!1},{type:"node_in",name:"hj",qualifier:["vec3"],c:!1},{type:"node_in",name:"hk",qualifier:["float"],c:!1},{type:"node_in",name:"hl",qualifier:["float"],c:!1},{type:"node_in",name:"hm",qualifier:["vec3"],c:!1},{type:"node_out",name:"hn",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hn [ 0 ] = hn [ 1 ] = hn [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"hh ; hj ; hk ; hl ; hm ; hi ;".split(" ")}]},
{type:"node",name:"EMISSION",h:[{type:"node_in",name:"ho",qualifier:["vec3"],c:!1},{type:"node_in",name:"hp",qualifier:["float"],c:!1},{type:"node_out",name:"hq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hq","=","ho",";"]},{type:"textline",a:["hp",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",h:[{type:"node_in",name:"hr",qualifier:["vec3"],c:!1},{type:"node_out",name:"hs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hs [ 0 ] = hs [ 1 ] = hs [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",
a:["hr",";"]}]},{type:"node",name:"HOLDOUT",h:[{type:"node_out",name:"ht",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ht [ 0 ] = ht [ 1 ] = ht [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",h:[{type:"node_in",name:"hu",qualifier:["vec3"],c:!1},{type:"node_in",name:"hv",qualifier:["float"],c:!1},{type:"node_out",name:"hw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hw [ 0 ] = hw [ 1 ] = hw [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hu",";",
"hv",";"]}]},{type:"node",name:"VOLUME_SCATTER",h:[{type:"node_in",name:"hx",qualifier:["vec3"],c:!1},{type:"node_in",name:"hy",qualifier:["float"],c:!1},{type:"node_in",name:"hz",qualifier:["float"],c:!1},{type:"node_out",name:"hA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hA [ 0 ] = hA [ 1 ] = hA [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"hx ; hy ; hz ;".split(" ")}]},{type:"node",name:"BUMP",h:[{type:"node_in",name:"hB",qualifier:["float"],c:!1},{type:"node_in",name:"hC",
qualifier:["float"],c:!1},{type:"node_in",name:"hD",qualifier:["float"],c:!1},{type:"node_in",name:"hE",qualifier:["vec3"],c:!1},{type:"node_out",name:"hF",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hF","=","hE",";"]},{type:"textline",a:"hB ; hC ; hD ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",h:[{type:"node_in",name:"hG",qualifier:["float"],c:!1},{type:"node_in",name:"hH",qualifier:["vec3"],c:!1},{type:"node_out",name:"hI",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hI","=","hH",
";"]},{type:"textline",a:["hG",";"]}]},{type:"node",name:"VECT_TRANSFORM",h:[{type:"node_in",name:"hJ",qualifier:["vec3"],c:!1},{type:"node_out",name:"hK",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{type:"equal_expr",e:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{type:"equal_expr",e:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],f:[{type:"textline",a:["hK","=","hJ",";"]}]},{type:"node_else",
f:[{type:"node_condition",b:[{type:"node_if",d:["VECTOR_TYPE","VT_POINT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"fi = vec4 ( hJ , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"fi = vec4 ( hJ , ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eO * fi ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{type:"equal_expr",
e:2}],f:[{type:"textline",a:"hK = ( eR * fi ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eQ * fi ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eO * eQ * fi ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eP * fi ) . xyz ;".split(" ")}]},
{type:"node_elif",d:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eR * eP * fi ) . xyz ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["VECTOR_TYPE","VT_NORMAL",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = normalize ( hK ) ;".split(" ")}]}]}]}]}]},{type:"node",name:"BLACKBODY",h:[{type:"node_in",name:"hL",qualifier:["float"],c:!1},{type:"node_out",name:"hM",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hM [ 0 ] = hM [ 1 ] = hM [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["hL",";"]}]},{type:"node",name:"WAVELENGTH",h:[{type:"node_in",name:"hN",qualifier:["float"],c:!1},{type:"node_out",name:"hO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hO [ 0 ] = hO [ 1 ] = hO [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hN",";"]}]},{type:"node",name:"SEPXYZ",h:[{type:"node_in",name:"hP",qualifier:["vec3"],c:!1},{type:"node_out",name:"hQ",qualifier:["float"],c:!1},{type:"node_out",name:"hR",qualifier:["float"],c:!1},{type:"node_out",name:"hS",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"hQ = hP [ 0 ] ; hR = hP [ 1 ] ; hS = hP [ 2 ] ;".split(" ")}]},{type:"node",name:"COMBXYZ",h:[{type:"node_in",name:"hT",qualifier:["float"],c:!1},{type:"node_in",name:"hU",qualifier:["float"],c:!1},{type:"node_in",name:"hV",qualifier:["float"],c:!1},{type:"node_out",name:"hW",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hW [ 0 ] = hT ; hW [ 1 ] = hU ; hW [ 2 ] = hV ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",h:[{type:"node_in",name:"hX",
qualifier:["vec3"],c:!1},{type:"node_in",name:"hY",qualifier:["float"],c:!1},{type:"node_in",name:"hZ",qualifier:["float"],c:!1},{type:"node_out",name:"h_",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fc = hY - hZ * eh ; h_ = max ( ( UNITY_VALUE_NODES + hZ ) * hX + fc , vec3 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",h:[{type:"node_in",name:"ia",qualifier:["float"],c:!1},{type:"node_in",name:"ib",qualifier:["float"],c:!1},{type:"node_out",name:"ic",qualifier:["float"],
c:!1},{type:"node_out",name:"id",qualifier:["float"],c:!1},{type:"node_out",name:"ie",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ic = id = ie = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["ia",";","ib",";"]}]},{type:"node",name:"TEX_IMAGE",h:[{type:"node_in",name:"ig",qualifier:["vec3"],c:!1},{type:"node_out",name:"ih",qualifier:["vec3"],c:!1},{type:"node_out",name:"ii",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ih [ 0 ] = ih [ 1 ] = ih [ 2 ] = ZERO_VALUE_NODES ; ii = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:["ig",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",h:[{type:"node_in",name:"ij",qualifier:["vec3"],c:!1},{type:"node_out",name:"ik",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ik [ 0 ] = ik [ 1 ] = ik [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["ij",";"]}]},{type:"node",name:"TEX_SKY",h:[{type:"node_in",name:"il",qualifier:["vec3"],c:!1},{type:"node_out",name:"im",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"im [ 0 ] = im [ 1 ] = im [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["il",";"]}]},{type:"node",name:"TEX_NOISE",h:[{type:"node_in",name:"io",qualifier:["vec3"],c:!1},{type:"node_in",name:"ip",qualifier:["float"],c:!1},{type:"node_in",name:"iq",qualifier:["float"],c:!1},{type:"node_in",name:"ir",qualifier:["float"],c:!1},{type:"node_out",name:"is",qualifier:["vec3"],c:!1},{type:"node_out",name:"it",qualifier:["float"],c:!1}],f:[{type:"textline",a:"is [ 0 ] = is [ 1 ] = is [ 2 ] = ZERO_VALUE_NODES ; it = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
a:"io ; ip ; iq ; ir ;".split(" ")}]},{type:"node",name:"TEX_WAVE",h:[{type:"node_in",name:"iu",qualifier:["vec3"],c:!1},{type:"node_in",name:"iv",qualifier:["float"],c:!1},{type:"node_in",name:"iw",qualifier:["float"],c:!1},{type:"node_in",name:"ix",qualifier:["float"],c:!1},{type:"node_in",name:"iy",qualifier:["float"],c:!1},{type:"node_out",name:"iz",qualifier:["vec3"],c:!1},{type:"node_out",name:"iA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iz [ 0 ] = iz [ 1 ] = iz [ 2 ] = ZERO_VALUE_NODES ; iA = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"iu ; iv ; iw ; ix ; iy ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",h:[{type:"node_in",name:"iB",qualifier:["vec3"],c:!1},{type:"node_in",name:"iC",qualifier:["float"],c:!1},{type:"node_out",name:"iD",qualifier:["vec3"],c:!1},{type:"node_out",name:"iE",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iD [ 0 ] = iD [ 1 ] = iD [ 2 ] = ZERO_VALUE_NODES ; iE = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["iB",";","iC",";"]}]},{type:"node",name:"TEX_MUSGRAVE",h:[{type:"node_in",
name:"iF",qualifier:["vec3"],c:!1},{type:"node_in",name:"iG",qualifier:["float"],c:!1},{type:"node_in",name:"iH",qualifier:["float"],c:!1},{type:"node_in",name:"iI",qualifier:["float"],c:!1},{type:"node_in",name:"iJ",qualifier:["float"],c:!1},{type:"node_in",name:"iK",qualifier:["float"],c:!1},{type:"node_in",name:"iL",qualifier:["float"],c:!1},{type:"node_out",name:"iM",qualifier:["vec3"],c:!1},{type:"node_out",name:"iN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iM [ 0 ] = iM [ 1 ] = iM [ 2 ] = ZERO_VALUE_NODES ; iN = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"iF ; iG ; iH ; iI ; iJ ; iK ; iL ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",h:[{type:"node_in",name:"iO",qualifier:["vec3"],c:!1},{type:"node_out",name:"iP",qualifier:["vec3"],c:!1},{type:"node_out",name:"iQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iP [ 0 ] = iP [ 1 ] = iP [ 2 ] = ZERO_VALUE_NODES ; iQ = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["iO",";"]}]},{type:"node",name:"TEX_MAGIC",h:[{type:"node_in",name:"iR",qualifier:["vec3"],c:!1},{type:"node_in",
name:"iS",qualifier:["float"],c:!1},{type:"node_in",name:"iT",qualifier:["float"],c:!1},{type:"node_out",name:"iU",qualifier:["vec3"],c:!1},{type:"node_out",name:"iV",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iU [ 0 ] = iU [ 1 ] = iU [ 2 ] = ZERO_VALUE_NODES ; iV = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"iR ; iS ; iT ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",h:[{type:"node_in",name:"iW",qualifier:["vec3"],c:!1},{type:"node_in",name:"iX",qualifier:["vec3"],c:!1},{type:"node_in",
name:"iY",qualifier:["vec3"],c:!1},{type:"node_in",name:"iZ",qualifier:["float"],c:!1},{type:"node_out",name:"i_",qualifier:["vec3"],c:!1},{type:"node_out",name:"ja",qualifier:["float"],c:!1}],f:[{type:"textline",a:"i_ [ 0 ] = i_ [ 1 ] = i_ [ 2 ] = ZERO_VALUE_NODES ; ja = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"iW ; iX ; iY ; iZ ;".split(" ")}]},{type:"node",name:"TEX_BRICK",h:[{type:"node_in",name:"jb",qualifier:["vec3"],c:!1},{type:"node_in",name:"jc",qualifier:["vec3"],c:!1},{type:"node_in",
name:"jd",qualifier:["vec3"],c:!1},{type:"node_in",name:"je",qualifier:["vec3"],c:!1},{type:"node_in",name:"jf",qualifier:["float"],c:!1},{type:"node_in",name:"jg",qualifier:["float"],c:!1},{type:"node_in",name:"jh",qualifier:["float"],c:!1},{type:"node_in",name:"ji",qualifier:["float"],c:!1},{type:"node_in",name:"jj",qualifier:["float"],c:!1},{type:"node_out",name:"jk",qualifier:["vec3"],c:!1},{type:"node_out",name:"jl",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jk [ 0 ] = jk [ 1 ] = jk [ 2 ] = ZERO_VALUE_NODES ; jl = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"jb ; jc ; jd ; je ; jf ; jg ; jh ; ji ; jj ;".split(" ")}]},{type:"node",name:"ADD_SHADER",h:[{type:"node_in",name:"jm",qualifier:["vec3"],c:!1},{type:"node_in",name:"jn",qualifier:["vec3"],c:!1},{type:"node_out",name:"jo",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jo = clamp ( jm + jn , vec3 ( ZERO_VALUE_NODES ) , vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",h:[{type:"node_in",name:"jp",qualifier:["float"],c:!1},{type:"node_in",name:"jq",
qualifier:["vec3"],c:!1},{type:"node_in",name:"jr",qualifier:["vec3"],c:!1},{type:"node_out",name:"js",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fc = clamp ( jp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; js = fc * jq + ( UNITY_VALUE_NODES - fc ) * jr ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[{type:"node_out",name:"jt",qualifier:["vec3"],c:!1},{type:"node_out",name:"ju",qualifier:["vec3"],c:!1},{type:"node_param",name:"eF",qualifier:["varying","vec2"],c:!1}],f:[{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_jt"],f:[{type:"textline",a:"jt = ew ( eF ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_ju"],f:[{type:"textline",a:"ju = vec3 ( eF , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_out",name:"jv",qualifier:["vec3"],c:!1},{type:"node_param",name:"eG",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"jv = vec3 ( eG , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",h:[{type:"node_out",
name:"jw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["jw","=","fm",";"]}]},{type:"node",name:"TEX_COORD_GE",h:[{type:"node_out",name:"jx",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["jx","=","eg",";"]}]},{type:"node",name:"TEX_COORD_OB",h:[{type:"node_out",name:"jy",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jy [ 0 ] = jy [ 1 ] = jy [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",h:[{type:"node_out",name:"jz",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"jz [ 0 ] = fh [ 0 ] ; jz [ 1 ] = fh [ 1 ] ; jz [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_WI",h:[{type:"node_out",name:"jA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jA [ 0 ] = jA [ 1 ] = jA [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",h:[{type:"node_out",name:"jB",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jB [ 0 ] = jB [ 1 ] = jB [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",h:[{type:"node_out",name:"jC",
qualifier:["vec3"],c:!1},{type:"node_param",name:"eH",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"jC = vec3 ( eH , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",h:[{type:"node_out",name:"jD",qualifier:["float"],c:!1},{type:"node_out",name:"jE",qualifier:["float"],c:!1},{type:"node_out",name:"jF",qualifier:["float"],c:!1},{type:"node_out",name:"jG",qualifier:["vec3"],c:!1},{type:"node_out",name:"jH",qualifier:["float"],c:!1},{type:"node_out",name:"jI",qualifier:["vec3"],
c:!1},{type:"node_out",name:"jJ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jD = ZERO_VALUE_NODES ; jE = ZERO_VALUE_NODES ; jF = ZERO_VALUE_NODES ; jG = vec3 ( ZERO_VALUE_NODES ) ; jH = ZERO_VALUE_NODES ; jI = jG ; jJ = jG ;".split(" ")}]},{type:"node",name:"HAIR_INFO",h:[{type:"node_out",name:"jK",qualifier:["float"],c:!1},{type:"node_out",name:"jL",qualifier:["float"],c:!1},{type:"node_out",name:"jM",qualifier:["float"],c:!1},{type:"node_out",name:"jN",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"jK = ZERO_VALUE_NODES ; jL = ZERO_VALUE_NODES ; jM = ZERO_VALUE_NODES ; jN = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"OBJECT_INFO",h:[{type:"node_out",name:"jO",qualifier:["vec3"],c:!1},{type:"node_out",name:"jP",qualifier:["float"],c:!1},{type:"node_out",name:"jQ",qualifier:["float"],c:!1},{type:"node_out",name:"jR",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jP = ZERO_VALUE_NODES ; jQ = ZERO_VALUE_NODES ; jR = ZERO_VALUE_NODES ; jO = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"WIREFRAME",h:[{type:"node_in",name:"jS",qualifier:["float"],c:!1},{type:"node_out",name:"jT",qualifier:["float"],c:!1}],f:[{type:"textline",a:["jT","=","jS",";"]}]},{type:"node",name:"TANGENT",h:[{type:"node_out",name:"jU",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jU = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",h:[{type:"node_in",name:"jV",qualifier:["float"],c:!1},{type:"node_in",name:"jW",qualifier:["vec3"],c:!1},{type:"node_out",name:"jX",
qualifier:["float"],c:!1},{type:"node_out",name:"jY",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jX = jY = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["jW",";","jV",";"]}]},{type:"node",name:"LIGHT_PATH",h:[{type:"node_out",name:"jZ",qualifier:["float"],c:!1},{type:"node_out",name:"j_",qualifier:["float"],c:!1},{type:"node_out",name:"ka",qualifier:["float"],c:!1},{type:"node_out",name:"kb",qualifier:["float"],c:!1},{type:"node_out",name:"kc",qualifier:["float"],c:!1},{type:"node_out",
name:"kd",qualifier:["float"],c:!1},{type:"node_out",name:"ke",qualifier:["float"],c:!1},{type:"node_out",name:"kf",qualifier:["float"],c:!1},{type:"node_out",name:"kg",qualifier:["float"],c:!1},{type:"node_out",name:"kh",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jZ = j_ = ka = ZERO_VALUE_NODES ; kb = kc = kd = ZERO_VALUE_NODES ; ke = ke = kg = kh = ZERO_VALUE_NODES ; kf = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",h:[{type:"node_out",name:"ki",qualifier:["vec3"],c:!1},
{type:"node_out",name:"kj",qualifier:["vec3"],c:!1},{type:"node_out",name:"kk",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ki = kj = vec3 ( ZERO_VALUE_NODES ) ; kk = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"SCRIPT",h:[],f:[]},{type:"node",name:"CURVE_VEC",h:[{type:"node_in",name:"kl",qualifier:["float"],c:!1},{type:"node_in",name:"km",qualifier:["vec3"],c:!1},{type:"node_out",name:"kn",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["kn","=","km",";"]},{type:"node_condition",b:[{type:"node_if",
d:["READ_R"],f:[{type:"textline",a:"kn . r = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * km . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"kn . g = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * km . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"kn . b = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * km . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},
{type:"textline",a:"kn = mix ( km , kn , kl ) ;".split(" ")}]},{type:"node",name:"CURVE_RGB",h:[{type:"node_in",name:"ko",qualifier:["float"],c:!1},{type:"node_in",name:"kp",qualifier:["vec3"],c:!1},{type:"node_out",name:"kq",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["READ_A"],f:[{type:"textline",a:"fc = texture2D ( u_nodes_texture , vec2 ( kp . r , NODE_TEX_ROW ) ) . a ; fb = texture2D ( u_nodes_texture , vec2 ( kp . g , NODE_TEX_ROW ) ) . a ; fa = texture2D ( u_nodes_texture , vec2 ( kp . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:"fc = kp . r ; fb = kp . g ; fa = kp . b ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"kq . r = texture2D ( u_nodes_texture , vec2 ( fc , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"kq . r = fc ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"kq . g = texture2D ( u_nodes_texture , vec2 ( fb , NODE_TEX_ROW ) ) . g ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:"kq . g = fb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"kq . b = texture2D ( u_nodes_texture , vec2 ( fa , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"kq . b = fa ;".split(" ")}]}]},{type:"textline",a:"kq = mix ( kp , kq , ko ) ;".split(" ")}]},{type:"node",name:"VALTORGB",h:[{type:"node_in",name:"kr",qualifier:["float"],c:!1},{type:"node_out",name:"ks",qualifier:["vec3"],
c:!1},{type:"node_out",name:"kt",qualifier:["float"],c:!1}],f:[{type:"textline",a:"fi = texture2D ( u_nodes_texture , vec2 ( kr , NODE_TEX_ROW ) ) ; ks = fi . rgb ; kt = fi . a ;".split(" ")}]},{type:"node",name:"MAPPING",h:[{type:"node_in",name:"ku",qualifier:["vec3"],c:!1},{type:"node_out",name:"kv",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["kv","=","ku",";"]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",f:[{type:"textline",a:"kv = ( MAPPING_TRS_MATRIX * vec4 ( kv , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_SCALE",f:[{type:"textline",a:"kv = kv * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",f:[{type:"textline",a:"kv = kv + MAPPING_TRANSLATION ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",f:[{type:"textline",a:"kv = max ( kv , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",f:[{type:"textline",
a:"kv = min ( kv , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MAPPING_IS_NORMAL"],f:[{type:"textline",a:"kv = normalize ( kv ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",h:[{type:"node_in",name:"kw",qualifier:["float"],c:!1},{type:"node_in",name:"kx",qualifier:["float"],c:!1},{type:"node_out",name:"ky",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ky = kw + kx ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",
a:"ky = clamp ( ky , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",h:[{type:"node_in",name:"kz",qualifier:["float"],c:!1},{type:"node_in",name:"kA",qualifier:["float"],c:!1},{type:"node_out",name:"kB",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kB = kz - kA ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kB = clamp ( kB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",
name:"MATH_MULTIPLY",h:[{type:"node_in",name:"kC",qualifier:["float"],c:!1},{type:"node_in",name:"kD",qualifier:["float"],c:!1},{type:"node_out",name:"kE",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kE = kC * kD ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kE = clamp ( kE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",h:[{type:"node_in",name:"kF",qualifier:["float"],c:!1},{type:"node_in",name:"kG",
qualifier:["float"],c:!1},{type:"node_out",name:"kH",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kH = ( kG != ZERO_VALUE_NODES ) ? kF / kG : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kH = clamp ( kH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SINE",h:[{type:"node_in",name:"kI",qualifier:["float"],c:!1},{type:"node_in",name:"kJ",qualifier:["float"],c:!1},{type:"node_out",name:"kK",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"kK = sin ( kI ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kK = clamp ( kK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kJ",";"]}]},{type:"node",name:"MATH_COSINE",h:[{type:"node_in",name:"kL",qualifier:["float"],c:!1},{type:"node_in",name:"kM",qualifier:["float"],c:!1},{type:"node_out",name:"kN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kN = cos ( kL ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kN = clamp ( kN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kM",";"]}]},{type:"node",name:"MATH_TANGENT",h:[{type:"node_in",name:"kO",qualifier:["float"],c:!1},{type:"node_in",name:"kP",qualifier:["float"],c:!1},{type:"node_out",name:"kQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kQ = tan ( kO ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],
f:[{type:"textline",a:"kQ = clamp ( kQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kP",";"]}]},{type:"node",name:"MATH_ARCSINE",h:[{type:"node_in",name:"kR",qualifier:["float"],c:!1},{type:"node_in",name:"kS",qualifier:["float"],c:!1},{type:"node_out",name:"kT",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kT = ( kR <= UNITY_VALUE_NODES && kR >= - UNITY_VALUE_NODES ) ? asin ( kR ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kT = clamp ( kT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kS",";"]}]},{type:"node",name:"MATH_ARCCOSINE",h:[{type:"node_in",name:"kU",qualifier:["float"],c:!1},{type:"node_in",name:"kV",qualifier:["float"],c:!1},{type:"node_out",name:"kW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kW = ( kU <= UNITY_VALUE_NODES && kU >= - UNITY_VALUE_NODES ) ? acos ( kU ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kW = clamp ( kW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kV",";"]}]},{type:"node",name:"MATH_ARCTANGENT",h:[{type:"node_in",name:"kX",qualifier:["float"],c:!1},{type:"node_in",name:"kY",qualifier:["float"],c:!1},{type:"node_out",name:"kZ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kZ = atan ( kX ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",
a:"kZ = clamp ( kZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kY",";"]}]},{type:"node",name:"MATH_POWER",h:[{type:"node_in",name:"k_",qualifier:["float"],c:!1},{type:"node_in",name:"la",qualifier:["float"],c:!1},{type:"node_out",name:"lb",qualifier:["float"],c:!1}],f:[{type:"textline",a:"if ( k_ < ZERO_VALUE_NODES && la != floor ( la ) ) lb = ZERO_VALUE_NODES ; else if ( la == ZERO_VALUE_NODES )".split(" ")},{type:"textline",a:"lb = UNITY_VALUE_NODES ; else if ( k_ < ZERO_VALUE_NODES ) lb = mix ( UNITY_VALUE_NODES , - UNITY_VALUE_NODES , sign ( mod ( - la , 2.0 ) ) ) * pow ( - k_ , la ) ; else if ( k_ == ZERO_VALUE_NODES ) lb = ZERO_VALUE_NODES ; else lb = pow ( k_ , la ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lb = clamp ( lb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",h:[{type:"node_in",name:"lc",qualifier:["float"],c:!1},{type:"node_in",name:"ld",qualifier:["float"],c:!1},{type:"node_out",name:"le",qualifier:["float"],c:!1}],f:[{type:"textline",a:"le = ( lc > ZERO_VALUE_NODES && ld > ZERO_VALUE_NODES ) ? log2 ( lc ) / log2 ( ld ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"le = clamp ( le , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",h:[{type:"node_in",name:"lf",qualifier:["float"],c:!1},{type:"node_in",name:"lg",qualifier:["float"],c:!1},{type:"node_out",name:"lh",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lh = min ( lf , lg ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lh = clamp ( lh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",h:[{type:"node_in",name:"li",qualifier:["float"],c:!1},{type:"node_in",name:"lj",qualifier:["float"],c:!1},{type:"node_out",name:"lk",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lk = max ( li , lj ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lk = clamp ( lk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",h:[{type:"node_in",name:"ll",qualifier:["float"],c:!1},
{type:"node_in",name:"lm",qualifier:["float"],c:!1},{type:"node_out",name:"ln",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ln = floor ( ll + eh ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"ln = clamp ( ln , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["lm",";"]}]},{type:"node",name:"MATH_LESS_THAN",h:[{type:"node_in",name:"lo",qualifier:["float"],c:!1},{type:"node_in",name:"lp",qualifier:["float"],c:!1},
{type:"node_out",name:"lq",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lq = ( lo < lp ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lq = clamp ( lq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",h:[{type:"node_in",name:"lr",qualifier:["float"],c:!1},{type:"node_in",name:"ls",qualifier:["float"],c:!1},{type:"node_out",name:"lt",qualifier:["float"],
c:!1}],f:[{type:"textline",a:"lt = ( lr > ls ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lt = clamp ( lt , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",h:[{type:"node_in",name:"lu",qualifier:["float"],c:!1},{type:"node_in",name:"lv",qualifier:["float"],c:!1},{type:"node_out",name:"lw",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lw = abs ( lv ) > 0.000001 ? mod ( lu , lv ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lw = clamp ( lw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",h:[{type:"node_in",name:"lx",qualifier:["float"],c:!1},{type:"node_in",name:"ly",qualifier:["float"],c:!1},{type:"node_out",name:"lz",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lz = abs ( lx ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lz = clamp ( lz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["ly",";"]}]},{type:"node",name:"MIX_RGB_MIX",h:[{type:"node_in",name:"lA",qualifier:["float"],c:!1},{type:"node_in",name:"lB",qualifier:["vec3"],c:!1},{type:"node_in",name:"lC",qualifier:["vec3"],c:!1},{type:"node_out",name:"lD",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lD = mix ( lB , lC , fa ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lD = clamp ( lD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",h:[{type:"node_in",name:"lE",qualifier:["float"],c:!1},{type:"node_in",name:"lF",qualifier:["vec3"],c:!1},{type:"node_in",name:"lG",qualifier:["vec3"],c:!1},{type:"node_out",name:"lH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lH = mix ( lF , lF + lG , fa ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lH = clamp ( lH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",h:[{type:"node_in",name:"lI",qualifier:["float"],c:!1},{type:"node_in",name:"lJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"lK",qualifier:["vec3"],c:!1},{type:"node_out",name:"lL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lL = mix ( lJ , lJ * lK , fa ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lL = clamp ( lL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",h:[{type:"node_in",name:"lM",qualifier:["float"],c:!1},{type:"node_in",name:"lN",qualifier:["vec3"],c:!1},{type:"node_in",name:"lO",qualifier:["vec3"],c:!1},{type:"node_out",name:"lP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lP = mix ( lN , lN - lO , fa ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lP = clamp ( lP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",h:[{type:"node_in",name:"lQ",qualifier:["float"],c:!1},{type:"node_in",name:"lR",qualifier:["vec3"],c:!1},{type:"node_in",name:"lS",qualifier:["vec3"],c:!1},{type:"node_out",name:"lT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; lT = vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( fb ) + fa * ( vec3 ( UNITY_VALUE_NODES ) - lS ) ) * ( vec3 ( UNITY_VALUE_NODES ) - lR ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lT = clamp ( lT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",h:[{type:"node_in",name:"lU",qualifier:["float"],c:!1},{type:"node_in",name:"lV",qualifier:["vec3"],c:!1},{type:"node_in",name:"lW",qualifier:["vec3"],c:!1},{type:"node_out",name:"lX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; lW += step ( lW , vec3 ( ZERO_VALUE_NODES ) ) ; lX = fb * lV + fa * lV / lW ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lX = clamp ( lX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",h:[{type:"node_in",name:"lY",qualifier:["float"],c:!1},{type:"node_in",name:"lZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"l_",qualifier:["vec3"],c:!1},{type:"node_out",name:"ma",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; ma = mix ( lZ , abs ( lZ - l_ ) , fa ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"ma = clamp ( ma , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",h:[{type:"node_in",name:"mb",qualifier:["float"],c:!1},{type:"node_in",name:"mc",qualifier:["vec3"],c:!1},{type:"node_in",name:"md",qualifier:["vec3"],c:!1},{type:"node_out",name:"me",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; me = min ( mc . rgb , md . rgb * fa ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"me = clamp ( me , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",h:[{type:"node_in",name:"mf",qualifier:["float"],c:!1},{type:"node_in",name:"mg",qualifier:["vec3"],c:!1},{type:"node_in",name:"mh",qualifier:["vec3"],c:!1},{type:"node_out",name:"mi",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mi = max ( mg . rgb , mh . rgb * fa ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mi = clamp ( mi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",h:[{type:"node_in",name:"mj",qualifier:["float"],c:!1},{type:"node_in",name:"mk",qualifier:["vec3"],c:!1},{type:"node_in",name:"ml",qualifier:["vec3"],c:!1},{type:"node_out",name:"mm",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fo = vec3 ( UNITY_VALUE_NODES - fa ) ; mm = mix ( mk * ( fo + 2.0 * fa * ml ) , vec3 ( UNITY_VALUE_NODES ) - ( fo + 2.0 * fa * ( vec3 ( UNITY_VALUE_NODES ) - ml ) ) * ( vec3 ( UNITY_VALUE_NODES ) - mk ) , step ( eh , mk ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mm = clamp ( mm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",h:[{type:"node_in",name:"mn",qualifier:["float"],c:!1},{type:"node_in",name:"mo",qualifier:["vec3"],c:!1},{type:"node_in",name:"mp",qualifier:["vec3"],c:!1},{type:"node_out",name:"mq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fo = vec3 ( UNITY_VALUE_NODES ) - fa * mp ; fn = clamp ( mo / fo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mq = mix ( mix ( fn , vec3 ( UNITY_VALUE_NODES ) , step ( fo , vec3 ( ZERO_VALUE_NODES ) ) ) , mo , step ( mo , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mq = clamp ( mq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",h:[{type:"node_in",name:"mr",qualifier:["float"],c:!1},{type:"node_in",name:"ms",qualifier:["vec3"],c:!1},{type:"node_in",name:"mt",qualifier:["vec3"],c:!1},{type:"node_out",name:"mu",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fo = vec3 ( UNITY_VALUE_NODES - fa ) ; fo = fo + fa * mt ; fn = clamp ( vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( UNITY_VALUE_NODES ) - ms ) / fo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mu = mix ( fn , vec3 ( ZERO_VALUE_NODES ) , step ( fo , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mu = clamp ( mu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",h:[{type:"node_in",name:"mv",qualifier:["float"],c:!1},{type:"node_in",name:"mw",qualifier:["vec3"],c:!1},{type:"node_in",name:"mx",qualifier:["vec3"],c:!1},{type:"node_out",name:"my",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; my = mw ; fn = eq ( mx ) ; if ( fn . y != ZERO_VALUE_NODES ) { fo = eq ( my ) ; fo . x = fn . x ; fp = eu ( fo ) ; my = mix ( my , fp , fa ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"my = clamp ( my , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",h:[{type:"node_in",name:"mz",qualifier:["float"],c:!1},{type:"node_in",name:"mA",qualifier:["vec3"],c:!1},{type:"node_in",name:"mB",qualifier:["vec3"],c:!1},{type:"node_out",name:"mC",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; mC = mA ; fp = eq ( mC ) ; if ( fp . y != ZERO_VALUE_NODES ) { fo = eq ( mB ) ; fp . y = fb * fp . y + fa * fo . y ; mC = eu ( fp ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mC = clamp ( mC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",h:[{type:"node_in",name:"mD",qualifier:["float"],c:!1},{type:"node_in",name:"mE",qualifier:["vec3"],c:!1},{type:"node_in",name:"mF",qualifier:["vec3"],c:!1},{type:"node_out",name:"mG",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; fp = eq ( mE ) ; fo = eq ( mF ) ; fp . z = fb * fp . z + fa * fo . z ; mG = eu ( fp ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mG = clamp ( mG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",h:[{type:"node_in",name:"mH",qualifier:["float"],c:!1},{type:"node_in",name:"mI",qualifier:["vec3"],c:!1},{type:"node_in",name:"mJ",qualifier:["vec3"],c:!1},{type:"node_out",name:"mK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mK = mI ; fo = eq ( mJ ) ; if ( fo . y != ZERO_VALUE_NODES ) { fp = eq ( mK ) ; fp . x = fo . x ; fp . y = fo . y ; fn = eu ( fp ) ; mK = mix ( mK , fn , fa ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mK = clamp ( mK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",h:[{type:"node_in",name:"mL",qualifier:["float"],c:!1},{type:"node_in",name:"mM",qualifier:["vec3"],c:!1},{type:"node_in",name:"mN",qualifier:["vec3"],c:!1},{type:"node_out",name:"mO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; fn = mN + mM - mN * mM ; mO = mM * ( vec3 ( fb ) + vec3 ( fa ) * ( ( vec3 ( UNITY_VALUE_NODES ) - mM ) * mN + fn ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mO = clamp ( mO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",h:[{type:"node_in",name:"mP",qualifier:["float"],c:!1},{type:"node_in",name:"mQ",qualifier:["vec3"],c:!1},{type:"node_in",name:"mR",qualifier:["vec3"],c:!1},{type:"node_out",name:"mS",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mS = mQ + fa * ( 2.0 * mR - vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mS = clamp ( mS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",h:[{type:"node_in",name:"mT",qualifier:["vec3"],c:!1},{type:"node_in",name:"mU",qualifier:["float"],c:!1}],f:[{type:"textline",a:"eS = mT ; eW = mU ;".split(" ")}]},{type:"node",name:"MATERIAL_BEGIN",h:[{type:"node_in",name:"mV",qualifier:["vec3"],c:!1},{type:"node_in",name:"mW",qualifier:["vec3"],c:!1},{type:"node_in",
name:"mX",qualifier:["float"],c:!1},{type:"node_in",name:"mY",qualifier:["vec3"],c:!0},{type:"node_in",name:"mZ",qualifier:["float"],c:!0},{type:"node_out",name:"m_",qualifier:["vec3"],c:!1},{type:"node_out",name:"na",qualifier:["vec3"],c:!1},{type:"node_out",name:"nb",qualifier:["vec3"],c:!1},{type:"node_out",name:"nc",qualifier:["vec3"],c:!1},{type:"node_out",name:"nd",qualifier:["vec3"],c:!1},{type:"node_out",name:"ne",qualifier:["vec2"],c:!1},{type:"node_out",name:"nf",qualifier:["vec2"],c:!1},
{type:"node_out",name:"ng",qualifier:["vec4"],c:!1},{type:"node_param",name:"eI",qualifier:["const","vec2"],c:!1},{type:"node_param",name:"eJ",qualifier:["const","vec3"],c:!1}],f:[{type:"textline",a:"nb = clamp ( mV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"nc = eJ [ 0 ] * clamp ( mW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_NORMAL"],f:[{type:"textline",a:"nd = normalize ( mY ) ;".split(" ")},
{type:"textline",a:"nd . yz = vec2 ( nd . z , - nd . y ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:["nd","=","fm",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["SHADELESS_MAT",{type:"logic_negative_expr",e:1}],f:[{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"textline",a:"m_ = mZ * nb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"m_ = eZ * nb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",
a:["nb","*=","mX",";"]}]}]},{type:"textline",a:"na = e_ * u_environment_energy * dS ( nd ) ; ng = du ( nb ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],f:[{type:"textline",a:"ne = vec2 ( eI [ 0 ] , eI [ 1 ] ) ;".split(" ")},{type:"textline",a:"nf = vec2 ( eJ [ 1 ] , eJ [ 2 ] ) ;".split(" ")}]}]},{type:"textline",a:["eV","=","ng",";"]}]},{type:"node_else",f:[{type:"textline",a:"m_ = vec3 ( ZERO_VALUE_NODES ) ; na = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATERIAL_END",h:[{type:"node_in",name:"nh",qualifier:["vec4"],c:!1},{type:"node_in",name:"ni",qualifier:["vec3"],c:!1},{type:"node_in",name:"nj",qualifier:["vec3"],c:!1},{type:"node_in",name:"nk",qualifier:["float"],c:!0},{type:"node_in",name:"nl",qualifier:["float"],c:!0},{type:"node_in",name:"nm",qualifier:["float"],c:!0},{type:"node_out",name:"nn",qualifier:["vec3"],c:!0},{type:"node_out",name:"no",qualifier:["float"],c:!0},{type:"node_out",name:"np",qualifier:["vec3"],c:!0},
{type:"node_out",name:"nq",qualifier:["vec3"],c:!0},{type:"node_out",name:"nr",qualifier:["vec3"],c:!0},{type:"node_param",name:"eK",qualifier:["float"],c:!1},{type:"node_param",name:"eL",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nn"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",a:"nn = nh . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"nn = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{type:"non_equal_expr",e:2},{type:"logical_and_expr",e:2}],f:[{type:"node_condition",b:[{type:"node_if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],f:[{type:"textline",a:"dP ( nn , eM , nj , nk , eN ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"dP ( nn , eM , nj , nk , mat4 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",
a:["nn","+=","ni",";"]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_np"],f:[{type:"textline",a:["np","=","nj",";"]},{type:"textline",a:"np . yz = vec2 ( - np . z , np . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nq"],f:[{type:"textline",a:"nq = nh . rgb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nr"],f:[{type:"textline",a:["nr","=","ni",";"]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_no"],f:[{type:"textline",a:"no = clamp ( nm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"fa = max ( max ( ni . r , ni . g ) , ni . b ) * nl ; no = clamp ( nm * ( UNITY_VALUE_NODES - fa ) + fa , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},{type:"node_else",f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_no"],f:[{type:"textline",a:"no = clamp ( eK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"fa = max ( max ( ni . r , ni . g ) , ni . b ) * eL ; no = eK * ( UNITY_VALUE_NODES - fa ) + fa ;".split(" ")}]}]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["eT","=","ni",";"]}]},{type:"node_else",f:[{type:"textline",a:"eT = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["eU","=","nj",";"]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",
name:"ns",qualifier:["vec3"],c:!1},{type:"node_in",name:"nt",qualifier:["vec3"],c:!1},{type:"node_in",name:"nu",qualifier:["vec3"],c:!1},{type:"node_out",name:"nv",qualifier:["vec4"],c:!1},{type:"node_out",name:"nw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"nv = vec4 ( ns + nu * nt , ZERO_VALUE_NODES ) ; nw = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"nx",qualifier:["vec4"],c:!1},{type:"node_out",name:"ny",qualifier:["vec3"],c:!1},
{type:"node_out",name:"nz",qualifier:["vec2"],c:!1},{type:"node_out",name:"nA",qualifier:["vec3"],c:!1},{type:"node_out",name:"nB",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nz = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",a:["nB","=","eh",";"]}]},{type:"node_else",f:[{type:"textline",a:["nB","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"nA = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",e:2}],f:[{type:"textline",a:"nA *= nx [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"fn = u_light_positions [ LAMP_IND ] ; ny = fn - fl ;".split(" ")},{type:"textline",a:"fa = length ( ny ) ; nA *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + fa * fa ) ; ny = normalize ( ny ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"fn = u_light_directions [ LAMP_IND ] ; fa = dot ( ny , fn ) ; fa *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fa - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; nA *= fa ;".split(" ")}]}]}]},{type:"node_else",f:[{type:"textline",a:"ny = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"nC",qualifier:["vec3"],c:!1},{type:"node_in",
name:"nD",qualifier:["vec2"],c:!1},{type:"node_in",name:"nE",qualifier:["vec3"],c:!1},{type:"node_in",name:"nF",qualifier:["float"],c:!1},{type:"node_in",name:"nG",qualifier:["vec2"],c:!1},{type:"node_out",name:"nH",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nH = ZERO_VALUE_NODES ; if ( nD . r != ZERO_VALUE_NODES ) { fa = ( UNITY_VALUE_NODES - nF ) * dot ( nE , nC ) + nF ; if ( nG [ 0 ] == ZERO_VALUE_NODES ) { nH = UNITY_VALUE_NODES ; } else { fa = UNITY_VALUE_NODES + abs ( fa ) ; fa = nG [ 1 ] + ( UNITY_VALUE_NODES - nG [ 1 ] ) * pow ( fa , nG [ 0 ] ) ; nH = clamp ( fa , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } nH = max ( nH , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"nI",qualifier:["vec3"],c:!1},{type:"node_in",name:"nJ",qualifier:["vec2"],c:!1},{type:"node_in",name:"nK",qualifier:["vec3"],c:!1},{type:"node_in",name:"nL",qualifier:["float"],c:!1},{type:"node_out",name:"nM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nM = ZERO_VALUE_NODES ; if ( nJ . r != ZERO_VALUE_NODES ) { fa = ( UNITY_VALUE_NODES - nL ) * dot ( nK , nI ) + nL ; nM = max ( fa , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"nN",qualifier:["vec3"],c:!1},{type:"node_in",name:"nO",qualifier:["vec2"],c:!1},{type:"node_in",name:"nP",qualifier:["vec3"],c:!1},{type:"node_in",name:"nQ",qualifier:["float"],c:!1},{type:"node_in",name:"nR",qualifier:["vec2"],c:!1},{type:"node_out",name:"nS",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nS = ZERO_VALUE_NODES ; if ( nO . r != ZERO_VALUE_NODES ) { fa = ( UNITY_VALUE_NODES - nQ ) * dot ( nP , nN ) + nQ ; if ( nR [ 0 ] > ZERO_VALUE_NODES ) { fb = max ( dot ( nP , eM ) , ZERO_VALUE_NODES ) ; fc = nR [ 0 ] * nR [ 0 ] ; fd = UNITY_VALUE_NODES - eh * ( fc / ( fc + 0.33 ) ) ; fn = nN - fa * nP ; fp = eM - fb * nP ;".split(" ")},
{type:"textline",a:"if ( length ( fn ) == ZERO_VALUE_NODES || length ( fp ) == ZERO_VALUE_NODES || abs ( fa ) > UNITY_VALUE_NODES || abs ( fb ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"nS = fa * fd ; else { fe = acos ( fa ) ; fb = acos ( fb ) ; fn = normalize ( fn ) ; fp = normalize ( fp ) ; ff = max ( fe , fb ) ; fg = min ( fe , fb ) ; fg *= 0.95 ; fb = max ( dot ( fn , fp ) , ZERO_VALUE_NODES ) ; fc = 0.45 * ( fc / ( fc + 0.09 ) ) ; nS = fa * ( fd + ( fc * fb * sin ( ff ) * tan ( fg ) ) ) ; } } else nS = fa ; nS = max ( nS , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"nT",qualifier:["vec3"],c:!1},{type:"node_in",name:"nU",qualifier:["vec2"],c:!1},{type:"node_in",name:"nV",qualifier:["vec3"],c:!1},{type:"node_in",name:"nW",qualifier:["float"],c:!1},{type:"node_in",name:"nX",qualifier:["vec2"],c:!1},{type:"node_out",name:"nY",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nY = ZERO_VALUE_NODES ; if ( nU . r != ZERO_VALUE_NODES ) { fa = ( UNITY_VALUE_NODES - nW ) * dot ( nV , nT ) + nW ; fg = max ( dot ( nV , eM ) , ZERO_VALUE_NODES ) ; if ( nX [ 0 ] <= UNITY_VALUE_NODES ) nY = fa * pow ( max ( fg * fa , 0.1 ) , nX [ 0 ] - UNITY_VALUE_NODES ) ; else nY = fa * pow ( 1.0001 - fg , nX [ 0 ] - UNITY_VALUE_NODES ) ; nY = max ( nY , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"nZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"n_",qualifier:["vec2"],c:!1},{type:"node_in",name:"oa",qualifier:["vec3"],c:!1},{type:"node_in",name:"ob",qualifier:["float"],c:!1},{type:"node_in",name:"oc",qualifier:["vec2"],c:!1},{type:"node_out",name:"od",qualifier:["float"],c:!1}],f:[{type:"textline",a:"od = ZERO_VALUE_NODES ; if ( n_ . r != ZERO_VALUE_NODES ) { fg = ( UNITY_VALUE_NODES - ob ) * dot ( oa , nZ ) + ob ; fg = acos ( fg ) ; if ( fg < oc [ 0 ] ) od = UNITY_VALUE_NODES ; else if ( fg > ( oc [ 0 ] + oc [ 1 ] ) || oc [ 1 ] == ZERO_VALUE_NODES ) od = ZERO_VALUE_NODES ; else od = UNITY_VALUE_NODES - ( ( fg - oc [ 0 ] ) / oc [ 1 ] ) ; od = max ( od , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"oe",qualifier:["vec3"],c:!1},{type:"node_in",name:"of",qualifier:["vec2"],c:!1},{type:"node_in",name:"og",qualifier:["vec3"],c:!1},{type:"node_in",name:"oh",qualifier:["float"],c:!1},{type:"node_in",name:"oi",qualifier:["vec2"],c:!1},{type:"node_out",name:"oj",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oj = ZERO_VALUE_NODES ; if ( of . g == UNITY_VALUE_NODES ) { fp = normalize ( oe + eM ) ; oj = ( UNITY_VALUE_NODES - oh ) * max ( dot ( og , fp ) , ZERO_VALUE_NODES ) + oh ; oj = pow ( oj , oi [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"ok",qualifier:["vec3"],c:!1},{type:"node_in",name:"ol",qualifier:["vec2"],c:!1},{type:"node_in",name:"om",qualifier:["vec3"],c:!1},{type:"node_in",name:"on",qualifier:["vec2"],c:!1},{type:"node_out",name:"oo",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oo = ZERO_VALUE_NODES ; if ( ol . g == UNITY_VALUE_NODES ) { fp = normalize ( ok + eM ) ; fg = max ( dot ( om , fp ) , 0.001 ) ;".split(" ")},{type:"textline",a:"fa = max ( dot ( om , eM ) , 0.01 ) ; ff = max ( dot ( om , ok ) , 0.01 ) ; fg = tan ( acos ( fg ) ) ; fb = max ( on [ 0 ] , 0.001 ) ; oo = ff * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * fb * fb ) ) * ( exp ( - ( fg * fg ) / ( fb * fb ) ) / ( sqrt ( fa * ff ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"op",qualifier:["vec3"],c:!1},{type:"node_in",name:"oq",qualifier:["vec2"],c:!1},{type:"node_in",name:"or",qualifier:["vec3"],c:!1},{type:"node_in",name:"os",qualifier:["vec2"],c:!1},{type:"node_out",name:"ot",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ot = ZERO_VALUE_NODES ; if ( oq . g == UNITY_VALUE_NODES ) { fp = normalize ( op + eM ) ; ff = acos ( dot ( fp , or ) ) ; if ( ff < os [ 0 ] ) ot = UNITY_VALUE_NODES ; else if ( ff >= os [ 0 ] + os [ 1 ] || os [ 1 ] == ZERO_VALUE_NODES ) ot = ZERO_VALUE_NODES ; else ot = UNITY_VALUE_NODES - ( ff - os [ 0 ] ) / os [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"ou",qualifier:["vec3"],c:!1},{type:"node_in",name:"ov",qualifier:["vec2"],c:!1},{type:"node_in",name:"ow",qualifier:["vec3"],c:!1},{type:"node_in",name:"ox",qualifier:["float"],c:!1},{type:"node_in",name:"oy",qualifier:["vec2"],c:!1},{type:"node_out",name:"oz",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oz = ZERO_VALUE_NODES ; if ( ov . g == UNITY_VALUE_NODES ) { if ( oy [ 0 ] < UNITY_VALUE_NODES || oy [ 1 ] == ZERO_VALUE_NODES ) oz = ZERO_VALUE_NODES ; else { if ( oy [ 1 ] < 100.0 ) oy [ 1 ] = sqrt ( UNITY_VALUE_NODES / oy [ 1 ] ) ; else oy [ 1 ] = 10.0 / oy [ 1 ] ; fp = normalize ( eM + ou ) ; ff = ( UNITY_VALUE_NODES - ox ) * max ( dot ( ow , fp ) , ZERO_VALUE_NODES ) + ox ; if ( ff < ZERO_VALUE_NODES ) oz = ZERO_VALUE_NODES ; else { fa = max ( dot ( ow , eM ) , 0.01 ) ; fb = dot ( ow , ou ) ; if ( fb <= 0.01 ) oz = ZERO_VALUE_NODES ; else { fg = max ( dot ( eM , fp ) , 0.01 ) ; fc = UNITY_VALUE_NODES ; fa = ( 2.0 * ff * fa ) / fg ; fb = ( 2.0 * ff * fb ) / fg ; fb = min ( min ( fc , fa ) , fb ) ; fa = sqrt ( pow ( oy [ 0 ] , 2.0 ) + pow ( fg , 2.0 ) - UNITY_VALUE_NODES ) ; fg = pow ( fa - fg , 2.0 ) / pow ( fa + fg , 2.0 ) * ( UNITY_VALUE_NODES + pow ( fg * ( fa + fg ) - UNITY_VALUE_NODES , 2.0 ) / pow ( fg * ( fa - fg ) + UNITY_VALUE_NODES , 2.0 ) ) ; ff = acos ( ff ) ; oz = max ( fg * fb * exp ( - pow ( ff , 2.0 ) / ( 2.0 * pow ( oy [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"oA",qualifier:["vec4"],c:!1},{type:"node_in",name:"oB",qualifier:["vec3"],c:!1},{type:"node_in",name:"oC",qualifier:["float"],c:!1},{type:"node_in",name:"oD",qualifier:["float"],c:!1},{type:"node_in",name:"oE",qualifier:["vec3"],c:!1},{type:"node_in",name:"oF",qualifier:["vec3"],c:!1},{type:"node_in",name:"oG",qualifier:["vec4"],c:!1},{type:"node_in",name:"oH",qualifier:["vec3"],c:!1},{type:"node_in",name:"oI",qualifier:["vec3"],c:!1},{type:"node_in",
name:"oJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"oK",qualifier:["float"],c:!1},{type:"node_out",name:"oL",qualifier:["vec4"],c:!1},{type:"node_out",name:"oM",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_NODE_B4W_TRANSLUCENCY"],f:[{type:"textline",a:"if ( dot ( oE , oF ) * dot ( eM , oF ) < ZERO_VALUE_NODES ) { ff = oG . x ; fb = oG . y ; fg = oG . z ; fa = oG . w ;".split(" ")},{type:"textline",a:"fc = clamp ( abs ( dot ( oE , oF ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fd = clamp ( dot ( eM , - oE ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = pow ( fd , fb ) ;".split(" ")},
{type:"textline",a:"oL = oA + oK * vec4 ( oJ * fc * pow ( oH , vec3 ( ff ) ) , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"oL += fg * mix ( vec4 ( oH , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , fa ) * oK * vec4 ( oJ * fc * vec3 ( fb ) , UNITY_VALUE_NODES ) ; oM = oB ; } else {".split(" ")},{type:"textline",a:"oM = oB + oJ * oI * oD ; oL = oA + vec4 ( oJ * oH * oC , oD ) ; }".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"oM = oB + oJ * oI * oD ; oL = oA + vec4 ( oJ * oH * oC , oD ) ;".split(" ")}]}]}]},
{type:"node",name:"RGB",h:[{type:"node_out",name:"oN",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"oN = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",h:[{type:"node_in",name:"oO",qualifier:["vec3"],c:!1},{type:"node_out",name:"oP",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oP = dot ( oO , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",h:[{type:"node_in",name:"oQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"oR",qualifier:["float"],c:!0},
{type:"node_out",name:"oS",qualifier:["float"],c:!0},{type:"node_out",name:"oT",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oR"],f:[{type:"textline",a:"oR = oQ . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oS"],f:[{type:"textline",a:"oS = oQ . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oT"],f:[{type:"textline",a:"oT = oQ . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",h:[{type:"node_in",name:"oU",
qualifier:["vec3"],c:!1},{type:"node_out",name:"oV",qualifier:["float"],c:!0},{type:"node_out",name:"oW",qualifier:["float"],c:!0},{type:"node_out",name:"oX",qualifier:["float"],c:!0}],f:[{type:"textline",a:"fp = eq ( oU ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oV"],f:[{type:"textline",a:"oV = fp . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oW"],f:[{type:"textline",a:"oW = fp . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_oX"],f:[{type:"textline",a:"oX = fp . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",h:[{type:"node_in",name:"oY",qualifier:["float"],c:!1},{type:"node_in",name:"oZ",qualifier:["float"],c:!1},{type:"node_in",name:"o_",qualifier:["float"],c:!1},{type:"node_out",name:"pa",qualifier:["float"],c:!1}],f:[{type:"textline",a:"pa = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( oY - o_ ) * oZ ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",h:[{type:"node_in",name:"pb",qualifier:["vec3"],
c:!1},{type:"node_in",name:"pc",qualifier:["float"],c:!1},{type:"node_out",name:"pd",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"pd = pb ; if ( pd . x > ZERO_VALUE_NODES ) pd . x = pow ( pb . x , pc ) ; if ( pd . y > ZERO_VALUE_NODES ) pd . y = pow ( pb . y , pc ) ; if ( pd . z > ZERO_VALUE_NODES ) pd . z = pow ( pb . z , pc ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",h:[{type:"node_in",name:"pe",qualifier:["vec3"],c:!1},{type:"node_out",name:"pf",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"pf = max ( vec3 ( ZERO_VALUE_NODES ) , pe ) ; pf = pow ( pf , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",h:[{type:"node_in",name:"pg",qualifier:["vec3"],c:!1},{type:"node_out",name:"ph",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ph = max ( vec3 ( ZERO_VALUE_NODES ) , pg ) ; ph = pow ( ph , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",h:[{type:"node_out",name:"pi",qualifier:["vec3"],c:!1},{type:"node_out",name:"pj",qualifier:["vec3"],
c:!1},{type:"node_out",name:"pk",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pi"],f:[{type:"textline",a:"pi [ 2 ] = pi [ 1 ] = pi [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pj"],f:[{type:"textline",a:"pj [ 2 ] = pj [ 1 ] = pj [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pk"],f:[{type:"textline",a:["pk","=","ZERO_VALUE_NODES",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",
h:[{type:"node_in",name:"pl",qualifier:["vec3"],c:!1},{type:"node_out",name:"pm",qualifier:["vec3"],c:!0},{type:"node_out",name:"pn",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"],c:!1}],f:[{type:"textline",a:"fp = vec3 ( pl . x , pl . z , - pl . y ) ; fi = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , fp ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pm"],f:[{type:"textline",a:"pm = fi . xyz ; br ( pm ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pn"],f:[{type:"textline",a:"pn = fi . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",h:[{type:"node_in",name:"po",qualifier:["vec3"],c:!0},{type:"node_in",name:"pp",qualifier:["vec3"],c:!0},{type:"node_in",name:"pq",qualifier:["vec3"],c:!0},{type:"node_in",name:"pr",qualifier:["vec3"],c:!0},{type:"node_out",name:"ps",qualifier:["vec3"],c:!0},{type:"node_out",name:"pt",qualifier:["float"],c:!0},{type:"node_out",name:"pu",qualifier:["vec3"],
c:!0},{type:"node_out",name:"pv",qualifier:["float"],c:!0},{type:"node_out",name:"pw",qualifier:["vec3"],c:!0},{type:"node_out",name:"px",qualifier:["float"],c:!0},{type:"node_out",name:"py",qualifier:["vec3"],c:!0},{type:"node_out",name:"pz",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( po ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_ps"],f:[{type:"textline",a:"ps = fi . xyz ; br ( ps ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pt"],f:[{type:"textline",a:"pt = fi . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pp ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pu"],f:[{type:"textline",a:"pu = fi . xyz ; br ( pu ) ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_pv"],f:[{type:"textline",a:"pv = fi . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pq ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pw"],f:[{type:"textline",a:"pw = fi . xyz ; br ( pw ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_px"],f:[{type:"textline",a:"px = fi . w ;".split(" ")}]}]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pr ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_py"],f:[{type:"textline",a:"py = fi . xyz ; br ( py ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pz"],f:[{type:"textline",a:"pz = fi . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",h:[{type:"node_in",name:"pA",qualifier:["vec3"],c:!0},{type:"node_in",name:"pB",qualifier:["vec3"],
c:!0},{type:"node_in",name:"pC",qualifier:["vec3"],c:!0},{type:"node_in",name:"pD",qualifier:["vec3"],c:!0},{type:"node_out",name:"pE",qualifier:["vec3"],c:!0},{type:"node_out",name:"pF",qualifier:["float"],c:!0},{type:"node_out",name:"pG",qualifier:["vec3"],c:!0},{type:"node_out",name:"pH",qualifier:["float"],c:!0},{type:"node_out",name:"pI",qualifier:["vec3"],c:!0},{type:"node_out",name:"pJ",qualifier:["float"],c:!0},{type:"node_out",name:"pK",qualifier:["vec3"],c:!0},{type:"node_out",name:"pL",
qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pA ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pE"],f:[{type:"textline",a:"pE = normalize ( fj * ( fi . xyz - eh ) ) ;".split(" ")},{type:"textline",a:"pE . yz = vec2 ( - pE . z , pE . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pF"],f:[{type:"textline",
a:"pF = fi . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pB ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pG"],f:[{type:"textline",a:"pG = normalize ( fj * ( fi . xyz - eh ) ) ;".split(" ")},{type:"textline",a:"pG . yz = vec2 ( - pG . z , pG . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pH"],f:[{type:"textline",a:"pH = fi . w ;".split(" ")}]}]}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pC ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pI"],f:[{type:"textline",a:"pI = normalize ( fj * ( fi . xyz - eh ) ) ;".split(" ")},{type:"textline",a:"pI . yz = vec2 ( - pI . z , pI . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pJ"],f:[{type:"textline",a:"pJ = fi . w ;".split(" ")}]}]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pD ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pK"],f:[{type:"textline",a:"pK = normalize ( fj * ( fi . xyz - eh ) ) ;".split(" ")},{type:"textline",a:"pK . yz = vec2 ( - pK . z , pK . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pL"],f:[{type:"textline",a:"pL = fi . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",h:[{type:"node_out",
name:"pM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"pM = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",h:[{type:"node_in",name:"pN",qualifier:["vec3"],c:!1},{type:"node_in",name:"pO",qualifier:["vec3"],c:!1},{type:"node_out",name:"pP",qualifier:["vec3"],c:!1},{type:"node_out",name:"pQ",qualifier:["float"],c:!0}],f:[{type:"textline",a:"pP = pN + pO ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pQ"],f:[{type:"textline",a:"pQ = ( abs ( pP [ 0 ] ) + abs ( pP [ 1 ] ) + abs ( pP [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_SUBTRACT",h:[{type:"node_in",name:"pR",qualifier:["vec3"],c:!1},{type:"node_in",name:"pS",qualifier:["vec3"],c:!1},{type:"node_out",name:"pT",qualifier:["vec3"],c:!1},{type:"node_out",name:"pU",qualifier:["float"],c:!0}],f:[{type:"textline",a:"pT = pR - pS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pU"],f:[{type:"textline",a:"pU = ( abs ( pT [ 0 ] ) + abs ( pT [ 1 ] ) + abs ( pT [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",
h:[{type:"node_in",name:"pV",qualifier:["vec3"],c:!1},{type:"node_in",name:"pW",qualifier:["vec3"],c:!1},{type:"node_out",name:"pX",qualifier:["vec3"],c:!1},{type:"node_out",name:"pY",qualifier:["float"],c:!0}],f:[{type:"textline",a:"pX = pV + pW ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pY"],f:[{type:"textline",a:"pY = length ( pX ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pX"],f:[{type:"textline",a:"pX = normalize ( pX ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",h:[{type:"node_in",name:"pZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"p_",qualifier:["vec3"],c:!1},{type:"node_out",name:"qa",qualifier:["vec3"],c:!1},{type:"node_out",name:"qb",qualifier:["float"],c:!0}],f:[{type:"textline",a:"qa = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qb"],f:[{type:"textline",a:"qb = dot ( pZ , p_ ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",h:[{type:"node_in",
name:"qc",qualifier:["vec3"],c:!1},{type:"node_in",name:"qd",qualifier:["vec3"],c:!1},{type:"node_out",name:"qe",qualifier:["vec3"],c:!1},{type:"node_out",name:"qf",qualifier:["float"],c:!0}],f:[{type:"textline",a:"qe = cross ( qc , qd ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qf"],f:[{type:"textline",a:"qf = length ( qe ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",h:[{type:"node_in",name:"qg",qualifier:["vec3"],c:!1},{type:"node_in",name:"qh",qualifier:["vec3"],
c:!1},{type:"node_out",name:"qi",qualifier:["vec3"],c:!1},{type:"node_out",name:"qj",qualifier:["float"],c:!0}],f:[{type:"textline",a:"qi = normalize ( qg ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qj"],f:[{type:"textline",a:"qj = length ( qg ) ;".split(" ")}]}]},{type:"textline",a:["qh",";"]}]},{type:"node",name:"B4W_REFLECT",h:[{type:"node_in",name:"qk",qualifier:["vec3"],c:!1},{type:"node_in",name:"ql",qualifier:["vec3"],c:!1},{type:"node_out",name:"qm",qualifier:["vec3"],
c:!1}],f:[{type:"textline",a:"qm = reflect ( ( eP * vec4 ( qk , 0.0 ) ) . xyz , ql ) ;".split(" ")}]},{type:"node",name:"B4W_REFLECT_WORLD",h:[{type:"node_in",name:"qn",qualifier:["vec3"],c:!1},{type:"node_out",name:"qo",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fp = vec3 ( - eM . x , eM . z , - eM . y ) ; qo = reflect ( fp , qn ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",h:[{type:"node_in",name:"qp",qualifier:["vec3"],c:!1},{type:"node_in",name:"qq",qualifier:["float"],c:!1},{type:"node_in",
name:"qr",qualifier:["const","float"],c:!1},{type:"node_in",name:"qs",qualifier:["const","float"],c:!1},{type:"node_out",name:"qt",qualifier:["vec3"],c:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"fb = length ( fh ) ; if ( fb < qs ) { eX = ey ( qp ) ; fb = clamp ( eh * ( qs - fb ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = qq * fb ;".split(" ")},{type:"textline",a:"fp = normalize ( eM * fj ) ;".split(" ")},{type:"textline",
a:"fc = UNITY_VALUE_NODES / qr ;".split(" ")},{type:"textline",a:"eY = fp . xy * fb / ( qr * fp . z ) ; fb = UNITY_VALUE_NODES ; fa = texture2D ( node_B4W_PARALLAX_var_texture , eX ) . a ;".split(" ")},{type:"textline",a:"for ( float qu = 1.0 ; qu <= qr ; qu ++ ) { if ( fa < fb ) { fb -= fc ; eX -= eY ; fa = texture2D ( node_B4W_PARALLAX_var_texture , eX ) . a ; } }".split(" ")},{type:"textline",a:"eY = eX + eY ; fc = texture2D ( node_B4W_PARALLAX_var_texture , eY ) . a - ( fb + fc ) ; fb = fa - fb ; fc = fb / ( fb - fc ) ;".split(" ")},
{type:"textline",a:"eX = fc * eY + ( UNITY_VALUE_NODES - fc ) * eX ; qt = ew ( eX ) ; } else qt = qp ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",h:[{type:"node_in",name:"qv",qualifier:["vec3"],c:!1},{type:"node_out",name:"qw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qw = clamp ( qv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",h:[{type:"node_in",name:"qx",qualifier:["vec3"],c:!1},{type:"node_in",name:"qy",qualifier:["float"],c:!1},{type:"node_out",
name:"qz",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qz = el ( qx , qy ) ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",h:[{type:"node_in",name:"qA",qualifier:["float"],c:!1},{type:"node_in",name:"qB",qualifier:["float"],c:!1},{type:"node_in",name:"qC",qualifier:["float"],c:!1},{type:"node_in",name:"qD",qualifier:["float"],c:!1},{type:"node_in",name:"qE",qualifier:["float"],c:!1},{type:"node_out",name:"qF",qualifier:["float"],c:!0},{type:"node_out",name:"qG",qualifier:["vec4"],c:!0}],
f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qF"],f:[{type:"textline",a:["qF","=","qA",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qG"],f:[{type:"textline",a:"qG = vec4 ( qB , qC , qD , qE ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",h:[{type:"node_out",name:"qH",qualifier:["float"],c:!1}],f:[{type:"textline",a:["qH","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",h:[{type:"node_in",name:"qI",qualifier:["float"],c:!1},{type:"node_in",name:"qJ",qualifier:["float"],
c:!1},{type:"node_in",name:"qK",qualifier:["float"],c:!1},{type:"node_out",name:"qL",qualifier:["float"],c:!1}],f:[{type:"textline",a:"qL = smoothstep ( qJ , qK , qI ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",h:[{type:"node_in",name:"qM",qualifier:["vec3"],c:!1},{type:"node_in",name:"qN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"eS = qM ; eW = qN ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",h:[{type:"node_in",name:"qO",qualifier:["vec3"],c:!1},{type:"node_out",name:"qP",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"qP = ( qO . r + qO . g + qO . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",h:[{type:"node_in",name:"qQ",qualifier:["float"],c:!1},{type:"node_out",name:"qR",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qR [ 0 ] = qQ ; qR [ 1 ] = qQ ; qR [ 2 ] = qQ ;".split(" ")}]},{type:"nodes_global"},{type:"textline",a:"void qS ( in vec3 eM , in mat4 eN , in mat4 eO , in mat4 eP , in mat4 eQ , in mat4 eR , out vec3 eS , out vec3 eT , out vec3 eU , out vec4 eV , out float eW ) { vec2 eX , eY ; float eZ , e_ , fa , fb , fc , fd , fe , ff , fg ; vec4 fh , fi ; mat3 fj ; vec3 fk , fl , fm , fn , fo , fp ; eS = vec3 ( ZERO_VALUE_NODES ) ; eT = vec3 ( ZERO_VALUE_NODES ) ; eU = vec3 ( ZERO_VALUE_NODES ) ; eV = vec4 ( ZERO_VALUE_NODES ) ; eW = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"fk = normalize ( bE ) ; fl = fk ;".split(" ")},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!",
"gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"fl = fl ; else fl = - fl ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"textline",a:["fm","=","fl",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["fm","=","fk",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_NO"],group:{type:"group",b:[{type:"textline",a:["fk","=",
"fl",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"fn = cross ( fl , bF . xyz ) * bF . w ; fj = mat3 ( bF . xyz , fn , fl ) ; fj = fj ;".split(" ")}]}}]},{type:"textline",a:"fl = bC ; fh = bD ; eZ = u_emit ; e_ = u_ambient ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/to_world.glslv"]={type:"group",b:[{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"define",name:"MAX_BILLBOARD_ANGLE",a:["(","M_PI",
"/","4.0",")"]},{type:"textline",a:"const vec3 qT = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",e:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"mat4 qZ ( vec3 qU , mat4 qV ) { vec3 qW , qX , qY ; qW = vec3 ( qV [ 0 ] [ 0 ] , qV [ 1 ] [ 0 ] , qV [ 2 ] [ 0 ] ) ; qX = vec3 ( qV [ 0 ] [ 1 ] , qV [ 1 ] [ 1 ] , qV [ 2 ] [ 1 ] ) ; qY = vec3 ( qV [ 0 ] [ 2 ] , qV [ 1 ] [ 2 ] , qV [ 2 ] [ 2 ] ) ; qX = cross ( qY , qW ) ; return mat4 ( vec4 ( qW , 0.0 ) , vec4 ( qX , 0.0 ) , vec4 ( qY , 0.0 ) , vec4 ( qU , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"mat4 re ( vec3 q_ , vec3 ra ) { vec3 rb , rc , rd ; rb = q_ - ra ; rb . y = 0.0 ; rb = normalize ( rb ) ; rc = normalize ( cross ( qT , rb ) ) ; rd = normalize ( cross ( rb , rc ) ) ; return mat4 ( vec4 ( rc , 0.0 ) , vec4 ( rd , 0.0 ) , vec4 ( rb , 0.0 ) , vec4 ( ra , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"mat4 rm ( in vec3 rf , float rg , float rh , float ri , vec3 rj ) { float rk , rl ; rk = fract ( length ( rj ) / 0.17 ) ; rl = ri + rk / 10.0 ; rk = rk ; if ( ri != 0.0 ) rk /= ri ; rf *= 1.0 + 0.5 * sin ( rg ) ; rk = length ( rf ) * rh * sin ( 2.0 * 3.14 * rg * rl + rk ) ; return C ( rk ) ; }".split(" ")}]}}]},
{type:"textline",a:"mat4 ru ( in vec3 rn , in vec3 ro , in mat4 rp ) { vec3 rq ; float rr , rs ; mat4 rt ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",e:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"rt = qZ ( ro , rp ) ;".split(" ")}]}},{type:"elif",d:["BILLBOARD_RANDOM"],group:{type:"group",b:[{type:"textline",
a:"rr = fract ( ( ro . x * 1.43 + ro . y * 0.123 + ro . z * 6.1 ) ) ; rr = 2.0 * M_PI * rr ; rq = normalize ( vec3 ( rp [ 0 ] [ 2 ] , 0.0 , rp [ 2 ] [ 2 ] ) ) ; rs = acos ( rq [ 2 ] ) ; if ( rq [ 0 ] < 0.0 ) rs = 2.0 * M_PI - rs ; rs = rs - rr ; if ( rs < 0.0 ) rs = 2.0 * M_PI + rs ; rr = rr ; if ( rs <= MAX_BILLBOARD_ANGLE ) rr += rs ; else if ( rs <= M_PI - MAX_BILLBOARD_ANGLE ) rr += MAX_BILLBOARD_ANGLE * ( 2.0 * rs - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( rs <= M_PI + MAX_BILLBOARD_ANGLE ) rr += rs - M_PI ; else if ( rs <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) rr += MAX_BILLBOARD_ANGLE * ( 2.0 * rs - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else rr += rs - 2.0 * M_PI ; rt = A ( rr ) ; rt [ 3 ] = vec4 ( ro , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"rt = re ( rn , ro ) ;".split(" ")}]}}]},{type:"textline",a:["return","rt",";","}"]},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"mat4 rA ( in vec3 rv , in vec3 rw , in mat4 rx , mat4 ry ) { mat4 rz ; rz = ru ( rv , rw , rx ) ; ry [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; rz = rz * ry ; return rz ; }".split(" ")}]}}]},
{type:"textline",a:"c rH ( in vec3 rB , in vec3 rC , in vec3 rD , in vec3 rE , in vec3 rF , in mat4 rG ) { rB = ( rG * vec4 ( rB , 1.0 ) ) . xyz ; rC = ( rG * vec4 ( rC , 1.0 ) ) . xyz ; rD = ( rG * vec4 ( rD , 0.0 ) ) . xyz ; rE = ( rG * vec4 ( rE , 0.0 ) ) . xyz ; rF = ( rG * vec4 ( rF , 0.0 ) ) . xyz ; return E ( c ( rB , rC , rD , rE , rF , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};a["include/scale_texcoord.glslv"]={type:"group",b:[{type:"textline",a:"vec2 rK ( vec2 rI , vec3 rJ ) { return ( rI + 0.5 ) * rJ . xy - 0.5 ; }".split(" ")}]};
a["include/skin.glslv"]={type:"group",b:[{type:"define",name:"SKIN_SLERP",a:["0"]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],group:{type:"group",b:[{type:"textline",a:"vec4 rR ( in vec4 rL , in vec4 rM , in float rN ) { float rO , rP , rQ ; rO = rL [ 0 ] * rM [ 0 ] + rL [ 1 ] * rM [ 1 ] + rL [ 2 ] * rM [ 2 ] + rL [ 3 ] * rM [ 3 ] ; if ( rO < 0.0 ) { rM *= - 1.0 ; rO = - rO ; } if ( abs ( rO ) >= 1.0 ) return rL ; rP = acos ( rO ) ; rO = sqrt ( 1.0 - rO * rO ) ; if ( abs ( rO ) < 0.001 ) return vec4 ( rL * 0.5 + rM * 0.5 ) ; rQ = sin ( ( 1.0 - rN ) * rP ) / rO ; rO = sin ( rN * rP ) / rO ; return rL * rQ + rM * rO ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"vec3 sc ( in vec3 rS , in vec4 rT , in vec4 rU , in vec4 rV , in vec4 rW , in float rX ) { vec4 rY , rZ ; vec3 r_ , sa , sb ; r_ = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( rS , 1.0 ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],group:{type:"group",b:[{type:"textline",a:"rY = rR ( rT , rU , rX ) ; rZ = mix ( rV , rW , rX ) ; sa = i ( rY , r_ ) ; sa = sa * rZ . w + rZ . xyz ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"sb = i ( rT , r_ ) ; r_ = i ( rU , r_ ) ; sb = sb * rV . w + rV . xyz ; r_ = r_ * rW . w + rW . xyz ; sa = mix ( sb , r_ , rX ) ;".split(" ")}]}}]},{type:"textline",a:"return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sa , 1.0 ) ) ; } vec3 sl ( in vec3 sd , in vec4 se , in vec4 sf , in float sg ) { vec4 sh ; vec3 si , sj , sk ; si = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sd , 0.0 ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],
group:{type:"group",b:[{type:"textline",a:"sh = rR ( se , sf , sg ) ; sj = i ( sh , si ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"sk = i ( se , si ) ; si = i ( sf , si ) ; sj = mix ( sk , si , sg ) ;".split(" ")}]}}]},{type:"textline",a:"return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sj , 0.0 ) ) ; }".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vec3 sc ( in vec3 sm , in vec4 sn , in vec4 so ) { vec3 sp ; sp = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sm , 1.0 ) ) ; sp = i ( sn , sp ) ; sp = sp * so . w + so . xyz ; return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sp , 1.0 ) ) ; } vec3 sl ( in vec3 sq , in vec4 sr ) { vec3 ss ; ss = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sq , 0.0 ) ) ; ss = i ( sr , ss ) ; return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( ss , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",a:"void sH ( inout vec3 st , inout vec3 su , inout vec3 sv , inout vec3 sw ) { int sx , sy ; vec4 sz ; vec3 sA , sB , sC , sD ; float sE , sF ;".split(" ")},{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:["sE","=","u_frame_factor",";"]}]}}]},{type:"textline",a:"if ( a_influence . y > 0.0 ) { sA = vec3 ( 0.0 , 0.0 , 0.0 ) ; sB = vec3 ( 0.0 , 0.0 , 0.0 ) ; sC = vec3 ( 0.0 , 0.0 , 0.0 ) ; sD = vec3 ( 0.0 , 0.0 , 0.0 ) ; sz = a_influence ; for ( int sG = 0 ; sG < 4 ; sG ++ ) { sx = int ( sz [ sG ] ) ; sF = fract ( sz [ sG ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"sA += sF * sc ( st , u_quatsb [ sx ] , u_quatsa [ sx ] , u_transb [ sx ] , u_transa [ sx ] , sE ) ; sB += sF * sl ( su , u_quatsb [ sx ] , u_quatsa [ sx ] , sE ) ; sC += sF * sl ( sv , u_quatsb [ sx ] , u_quatsa [ sx ] , sE ) ; sD += sF * sl ( sw , u_quatsb [ sx ] , u_quatsa [ sx ] , sE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"sA += sF * sc ( st , u_quatsb [ sx ] , u_transb [ sx ] ) ; sD += sF * sl ( sw , u_quatsb [ sx ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"sB += sF * sl ( su , u_quatsb [ sx ] ) ; sC += sF * sl ( sv , u_quatsb [ sx ] ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"} st = sA ; sw = sD ;".split(" ")},{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"su = sB ; sv = sC ;".split(" ")}]}}]},{type:"textline",a:"} if ( ! ( a_influence . y > 0.0 ) ) { sy = int ( a_influence [ 0 ] - 1.0 ) ; if ( sy > - 1 ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"st = sc ( st , u_quatsb [ sy ] , u_quatsa [ sy ] , u_transb [ sy ] , u_transa [ sy ] , sE ) ; su = sl ( su , u_quatsb [ sy ] , u_quatsa [ sy ] , sE ) ; sv = sl ( sv , u_quatsb [ sy ] , u_quatsa [ sy ] , sE ) ; sw = sl ( sw , u_quatsb [ sy ] , u_quatsa [ sy ] , sE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"st = sc ( st , u_quatsb [ sy ] , u_transb [ sy ] ) ; sw = sl ( sw , u_quatsb [ sy ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"su = sl ( su , u_quatsb [ sy ] ) ; sv = sl ( sv , u_quatsb [ sy ] ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"void sS ( inout vec3 sI , in vec3 sJ , in float sK , in float sL , in float sM , in vec3 sN , in float sO ) { vec3 sP ; float sQ , sR ; sQ = length ( sJ ) ; sR = sL * ( 1.0 + 0.1 * fract ( sQ ) ) ; sQ = sK * sO * ( 1.0 + sin ( 2.0 * 3.14 * sM * sR + sQ ) ) ; sR = ( sI . y - sJ . y ) * abs ( sQ ) ; sR += 1.0 ; sR *= sR ; sR = sR * sR - sR ; sP = sI ; sP . xz += sN . xz * sR * sign ( sQ ) ; sP = sP - sJ ; if ( all ( equal ( sP , vec3 ( 0.0 ) ) ) ) sI = sJ ; else { sQ = length ( sI - sJ ) ; sI = sJ + normalize ( sP ) * sQ ; } }".split(" ")},
{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"vec4 sU ( vec4 sT ) { return sT * sT * ( 3.0 - 2.0 * sT ) ; } vec4 sW ( vec4 sV ) { return abs ( fract ( sV + 0.5 ) * 2.0 - 1.0 ) ; } vec4 sY ( vec4 sX ) { return sU ( sW ( sX ) ) ; } void to ( inout vec3 sZ , in float s_ , in vec3 ta , in vec3 tb , in vec3 tc , in float td , in float te , in float tf , in vec3 tg ) { vec3 th ; vec4 ti ; vec2 tj , tk ; float tl , tm , tn ; tl = dot ( tc , vec3 ( 1.0 ) ) ; tm = tl + tg . g ; tn = dot ( sZ , vec3 ( tg . g ) ) ; tj = ( s_ + vec2 ( tn , tm ) ) ; ti = ( ( fract ( ( tj . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( tb ) * td ; ti = sY ( ti ) ; tk = ti . xz + ti . yw ; tk . y = 0.5 - tk . y ; th = tk . xyx * tg . rbr * vec3 ( te * ta . x , tf , te * ta . z ) ; sZ += th ; }".split(" ")}]}}]},
{type:"textline",a:"void tv ( inout vec3 tp , inout vec3 tq , in vec3 tr ) { vec3 ts , tt , tu ; ts = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:"tt = tq ; tu = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tt = tp ; tu = tq ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"to ( tt , u_time , tr , ts , tu , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",a:"sS ( tt , tu , au_wind_bending_amp , au_wind_bending_freq , u_time , ts , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"sS ( tt , tu , au_wind_bending_amp , au_wind_bending_freq , u_time , ts , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:"tp += tt - tq ; tq = tt ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tp = tt ; tq = tu ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/nodes.glslv"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2},"PARTICLE_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"attribute vec3 a_orco_tex_coord ; varying vec3 eg ;".split(" ")}]}}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eG",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eG","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",h:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eF",
qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eF","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",name:"UVMAP",h:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eH",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eH","=","node_UVMAP_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_UV",h:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"ez",qualifier:["varying",
"vec2"],c:!1}],f:[{type:"textline",a:["ez","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_param",name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"],c:!1},{type:"node_param",name:"tw",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:["tw","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"],c:!1},{type:"node_param",
name:"tx",qualifier:["varying","float"],c:!1}],f:[{type:"textline",a:["tx","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"ty",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["ty","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",
qualifier:["attribute","vec3"],c:!1},{type:"node_param",name:"tz",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:["tz","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{type:"nodes_global"},{type:"textline",a:["void","tA","(",")","{"]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["eg","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/dynamic_grass.glslv"]=
{type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"vec2 tG ( vec3 tC , float tD , vec2 tE ) { vec2 tF ; tF = vec2 ( ( tC . x - tE . x ) / tD , - ( tC . z - tE . y ) / tD ) ; return fract ( tF ) ; } vec2 tK ( vec2 tH , float tI , vec2 tJ ) { return vec2 ( tH . x * tI , - tH . y * tI ) + tJ ; } c tL ( ) { return c ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } c ug ( vec3 tM , vec3 tN , vec3 tO , vec3 tP , vec3 tQ , PRECISION sampler2D tR , sampler2D tS , vec3 tT , float tU , vec3 tV , vec4 tW , mat4 tX ) { mat4 tY ; vec4 tZ ; vec2 t_ , ua , ub ; float uc , ud ; vec3 ue ; ue = i ( tW , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; uc = - ue . x ; ud = - ue . z ; t_ = vec2 ( tV . x + tU * ( - 1.0 - uc ) / 2.0 , tV . z + tU * ( 1.0 - ud ) / 2.0 ) ; ua = tG ( tQ , tU , t_ ) ; ud = tU / 2.0 ; ub = abs ( tK ( ua - vec2 ( 0.5 ) , tU , vec2 ( 0.0 ) ) ) ; ud = ud * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( ub ) > ud ) return tL ( ) ; ud = tU / tT . z ; ub = ( ua - vec2 ( 0.5 ) ) * ud + vec2 ( 0.5 ) ; ue = ue * ( tU / tT . z - 1.0 ) / 2.0 ; ub . x += ue . x ; ub . y -= ue . z ; tZ = texture2D ( tS , ub ) ; ud = tZ . r ; if ( ud < u_scale_threshold ) return tL ( ) ; uc = tT . y - tT . x ; uc = tT . y - texture2D ( tR , ub ) . r * uc ; ub = tM . xz - tQ . xz ; tQ . xz = tK ( ua , tU , t_ ) ; tQ . y = uc ; tM . xz = tQ . xz + ub ; tM . y *= ud ; tM . y += uc ; ue = tZ . gba ;".split(" ")},
{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"tM -= tQ ; tY = ru ( tV , tQ , tX ) ; c uf = rH ( tM , tQ , tN , tO , tP , tY ) ; uf . b = tQ ; uf . f = ue ; return E ( uf ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return E ( c ( tM , tQ , tN , tO , tP , ue ) ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/halo_color.glslf"]={type:"group",b:[{type:"var",name:"NUM_LINES",a:["0"]},{type:"var",name:"NUM_RINGS",
a:["0"]},{type:"var",name:"NUM_STARS",a:["0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"condition",b:[{type:"if",d:["NUM_RINGS","NUM_LINES",{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const int uk = NUM_RINGS ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"const int uk = NUM_LINES ;".split(" ")}]}}]},{type:"textline",a:"float um ( float ul ) { return ul - floor ( ul * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_RINGS"],
group:{type:"group",b:[{type:"textline",a:"void uv ( inout float un , in float uo [ uk ] , in float up ) { float uq , ur , us , ut ; for ( int uu = 0 ; uu < NUM_RINGS ; uu ++ ) { uq = 40.0 * uo [ uu ] ; ur = 300.0 * ( um ( uq ) - 0.005 ) ; us = uq ; ut = abs ( us * ( u_halo_size * ur - up ) ) ; un += 1.0 - min ( ut , 1.0 ) ; } }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"void uE ( inout float uw , in float ux [ uk ] , in float uy ) { float uz , uA , uB , uC ; for ( int uD = 0 ; uD < NUM_LINES ; uD ++ ) { uz = ux [ uD ] ; uA = uz ; uB = 1000.0 * ( um ( uz ) - 0.005 ) ; uC = 20.0 * abs ( uA * bM . x + uB * bM . y ) ; uw += 1.0 - min ( uC , 1.0 ) ; } uw *= uy ; }".split(" ")}]}}]},
{type:"textline",a:"void uL ( inout float uF , in vec2 uG ) { float uH , uI , uJ , uK ; uI = atan ( uG . y , uG . x ) ; uI *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; uJ = cos ( uI ) ; uK = sin ( uI ) ; uI = ( uJ * uG . x + uK * uG . y ) * ( uJ * uG . y - uK * uG . x ) ; uH = abs ( uI ) ; if ( uH < 1.0 ) { uH = ( 0.01 * u_halo_size ) / ( uH ) ; uF *= sqrt ( min ( uH , 1.0 ) ) ; } } vec4 uU ( ) { vec4 uM ; vec3 uN ; float uO , uP , uQ , uR ; uO = ( bM . x * bM . x + bM . y * bM . y ) ; uP = sqrt ( uO ) ; uO = max ( 1.0 - uO , 0.0 ) ; uO = pow ( uO , u_halo_hardness ) ; uQ = u_diffuse_color . a ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NUM_RINGS","NUM_LINES",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"float uS [ uk ] ; for ( int uT = 0 ; uT < uk ; uT ++ ) { uS [ uT ] = fract ( uj / float ( uT + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_RINGS"],group:{type:"group",b:[{type:"textline",a:"uR = 0.0 ; uv ( uR , uS , uP ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"uP = 0.0 ; uE ( uP , uS , uO ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_STARS"],group:{type:"group",b:[{type:"textline",a:"uL ( uO , bM ) ;".split(" ")}]}}]},{type:"textline",a:"uO *= uQ ; uN = u_diffuse_color . rgb ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_RINGS"],group:{type:"group",b:[{type:"textline",a:"uR *= uO ; uN += u_halo_rings_color * uR ; uO += uR ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"uP *= uQ ; uN += u_halo_lines_color * uP ; uO += uP ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"uO *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uP = u_halo_stars_blend * ( ui . y - u_halo_stars_height ) ; uO *= clamp ( uP , 0.0 , 1.0 ) ; uO *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"uM = vec4 ( uN , uO ) ; return uM ; }".split(" ")}]};a["include/fog.glslf"]={type:"group",b:[{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:"void va ( inout vec3 uV , in float uW , in float uX , in vec4 uY ) { float uZ , u_ ; uZ = clamp ( ( uW - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOG_TYPE","QUADRATIC",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uZ","*=","uZ",";"]}]}},{type:"elif",d:["FOG_TYPE","LINEAR",{type:"equal_expr",e:2}],group:{type:"group",b:[]}},{type:"elif",d:["FOG_TYPE","INVERSE_QUADRATIC",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uZ = sqrt ( uZ ) ;".split(" ")}]}}]},{type:"textline",a:"if ( u_fog_params . w > 0.0 ) { if ( uX > u_fog_params . w ) uZ = 0.0 ; else { u_ = ( u_fog_params . w - max ( uX , 0.0 ) ) / u_fog_params . w ; uZ *= u_ * u_ ; } } uY . a = 1.0 - ( 1.0 - uZ ) * ( 1.0 - u_fog_params . x ) ; uV = mix ( uV , uY . rgb , uY . a ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:"vec3 vg ( in mat4 vb , in vec3 vc ) { vec3 vd , ve , vf ; vd = mix ( vb [ 0 ] . rgb , vb [ 1 ] . rgb , max ( sign ( vc . x ) , 0.0 ) ) ; ve = mix ( vb [ 2 ] . rgb , vb [ 3 ] . rgb , max ( sign ( vc . z ) , 0.0 ) ) ; vf = vec3 ( vb [ 0 ] . a , vb [ 1 ] . a , vb [ 2 ] . a ) ; ve = mix ( vd , ve , abs ( vc . z ) ) ; ve = mix ( ve , vf , abs ( vc . y ) ) ; br ( ve ) ; return ve ; }".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"void vi ( inout float vh ) { vh -= 0.5 ; vh = 4.0 * ( vh * vh * vh ) + 0.5 ; }".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"void vt ( inout vec3 vj , in float vk , in vec3 vl , in float vm , in vec4 vn , in float vo ) { vec3 vp , vq ; float vr , vs ; vr = max ( vl . y , 0.0 ) ; vs = max ( vk - max ( vm / vr , 0.0 ) , 0.0 ) ; vs = vn . w * vs ; vp = vec3 ( 0.0 , 0.02 , 0.05 ) ; vq = vn . rgb ; vs = min ( vs , 1.0 ) ; vi ( vs ) ; vs *= clamp ( 2.0 - vo , 0.0 , 1.0 ) ; vp = mix ( vq , vp , min ( vr , 1.0 ) ) ; vm = clamp ( - vm * 0.03 , 0.0 , 0.8 ) ; vp *= 1.0 - vm ; vj = mix ( vj , vp , vs ) ; }".split(" ")}]}}]}]}}]},
{type:"textline",a:"void vA ( inout vec3 vu , float vv , vec3 vw , float vx ) { vec4 vy ; vec3 vz ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:"vz = vg ( u_cube_fog , vw ) ; vy = vec4 ( vz , u_fog_color_density . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["vy","=","u_fog_color_density",";"]}]}}]},{type:"textline",a:"va ( vu , vv , bC . y , vy ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"vt ( vu , vv , vw , u_cam_water_depth , u_underwater_fog_color_density , vx ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[]}}]},{type:"textline",a:["}"]}]};a["include/shadow.glslv"]={type:"group",b:[{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",
e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 vJ ( mat4 vD , vec4 vE , mat4 vF ) { vec4 vG ; float vH ; vec2 vI ; vI = ( vD * vF [ 3 ] ) . xy ; vH = SHADOW_TEX_RES / 2.0 ; vI = floor ( vI * vH + 0.5 ) / vH - vI ; vG = vD * vE ; vG . xy += vI ; vG . xyz = 0.5 * ( vG . xyz + vG . w ) ; return vG ; } void vO ( vec3 vK , vec3 vL ) { vec4 vM ; mat4 vN ;".split(" ")},{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vN = O ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vM = vN * vec4 ( vK + u_normal_offset * vL , 1.0 ) ; bI = vJ ( u_p_light_matrix0 , vM , vN ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vN = O ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vM = vN * vec4 ( vK + u_normal_offset * vL , 1.0 ) ; bJ = vJ ( u_p_light_matrix1 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vN = O ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vM = vN * vec4 ( vK + u_normal_offset * vL , 1.0 ) ; bK = vJ ( u_p_light_matrix2 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vN = O ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vM = vN * vec4 ( vK + u_normal_offset * vL , 1.0 ) ; bL = vJ ( u_p_light_matrix3 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",b:[{type:"textline",a:"bJ = vJ ( u_p_light_matrix1 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",
a:"bK = vJ ( u_p_light_matrix2 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"bL = vJ ( u_p_light_matrix3 , vM , vN ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/lighting_nodes.glslf"]={type:"group",b:[{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",
a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float vP = 0.5 ;".split(" ")},{type:"node",name:"LIGHTING_BEGIN",h:[{type:"node_out",name:"wm",qualifier:["vec3"],c:!1},{type:"node_out",name:"wn",qualifier:["vec3"],c:!1},{type:"node_out",name:"wo",qualifier:["vec3"],c:!1},{type:"node_out",name:"wp",qualifier:["vec3"],
c:!0},{type:"node_out",name:"wq",qualifier:["vec3"],c:!0},{type:"node_out",name:"wr",qualifier:["vec2"],c:!0},{type:"node_out",name:"ws",qualifier:["vec2"],c:!0},{type:"node_out",name:"wt",qualifier:["vec4"],c:!0},{type:"node_out",name:"wu",qualifier:["float"],c:!0},{type:"node_out",name:"wv",qualifier:["vec4"],c:!0}],f:[{type:"textline",a:"wm = vQ ; wn = vR ; wo = vS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wp"],f:[{type:"textline",a:["wp","=","vT",";"]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_wq"],f:[{type:"textline",a:["wq","=","vV",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_ws"],f:[{type:"textline",a:["ws","=","vX",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wr"],f:[{type:"textline",a:["wr","=","vY",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wt"],f:[{type:"textline",a:["wt","=","vZ",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wu"],f:[{type:"textline",a:["wu","=","v_",";"]}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wv"],f:[{type:"textline",a:["wv","=","wa",";"]}]}]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"ww",qualifier:["vec3"],c:!1},{type:"node_in",name:"wx",qualifier:["vec3"],c:!1},{type:"node_in",name:"wy",qualifier:["vec3"],c:!1},{type:"node_out",name:"wz",qualifier:["vec4"],c:!1},{type:"node_out",name:"wA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"wz = vec4 ( ww + wy * wx , ZERO_VALUE_NODES ) ; wA = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"wB",qualifier:["vec4"],c:!1},{type:"node_out",name:"wC",qualifier:["vec3"],c:!1},{type:"node_out",name:"wD",qualifier:["vec2"],c:!1},{type:"node_out",name:"wE",qualifier:["vec3"],c:!1},{type:"node_out",name:"wF",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wD = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",
a:["wF","=","vP",";"]}]},{type:"node_else",f:[{type:"textline",a:["wF","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"wE = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",e:2}],f:[{type:"textline",a:"wE *= wB [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",
e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"wk = u_light_positions [ LAMP_IND ] ; wC = wk - vU ;".split(" ")},{type:"textline",a:"wd = length ( wC ) ; wE *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + wd * wd ) ; wC = normalize ( wC ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"wk = u_light_directions [ LAMP_IND ] ; wd = dot ( wC , wk ) ; wd *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( wd - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; wE *= wd ;".split(" ")}]}]}]},
{type:"node_else",f:[{type:"textline",a:"wC = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"wG",qualifier:["vec3"],c:!1},{type:"node_in",name:"wH",qualifier:["vec2"],c:!1},{type:"node_in",name:"wI",qualifier:["vec3"],c:!1},{type:"node_in",name:"wJ",qualifier:["float"],c:!1},{type:"node_in",name:"wK",qualifier:["vec2"],c:!1},{type:"node_out",name:"wL",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wL = ZERO_VALUE_NODES ; if ( wH . r != ZERO_VALUE_NODES ) { wd = ( UNITY_VALUE_NODES - wJ ) * dot ( wI , wG ) + wJ ; if ( wK [ 0 ] == ZERO_VALUE_NODES ) { wL = UNITY_VALUE_NODES ; } else { wd = UNITY_VALUE_NODES + abs ( wd ) ; wd = wK [ 1 ] + ( UNITY_VALUE_NODES - wK [ 1 ] ) * pow ( wd , wK [ 0 ] ) ; wL = clamp ( wd , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } wL = max ( wL , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"wM",qualifier:["vec3"],c:!1},{type:"node_in",name:"wN",qualifier:["vec2"],c:!1},{type:"node_in",name:"wO",qualifier:["vec3"],c:!1},{type:"node_in",name:"wP",qualifier:["float"],c:!1},{type:"node_out",name:"wQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wQ = ZERO_VALUE_NODES ; if ( wN . r != ZERO_VALUE_NODES ) { wd = ( UNITY_VALUE_NODES - wP ) * dot ( wO , wM ) + wP ; wQ = max ( wd , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"wR",qualifier:["vec3"],c:!1},{type:"node_in",name:"wS",qualifier:["vec2"],c:!1},{type:"node_in",name:"wT",qualifier:["vec3"],c:!1},{type:"node_in",name:"wU",qualifier:["float"],c:!1},{type:"node_in",name:"wV",qualifier:["vec2"],c:!1},{type:"node_out",name:"wW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wW = ZERO_VALUE_NODES ; if ( wS . r != ZERO_VALUE_NODES ) { wd = ( UNITY_VALUE_NODES - wU ) * dot ( wT , wR ) + wU ; if ( wV [ 0 ] > ZERO_VALUE_NODES ) { we = max ( dot ( wT , vW ) , ZERO_VALUE_NODES ) ; wf = wV [ 0 ] * wV [ 0 ] ; wg = UNITY_VALUE_NODES - vP * ( wf / ( wf + 0.33 ) ) ; wk = wR - wd * wT ; wl = vW - we * wT ;".split(" ")},
{type:"textline",a:"if ( length ( wk ) == ZERO_VALUE_NODES || length ( wl ) == ZERO_VALUE_NODES || abs ( wd ) > UNITY_VALUE_NODES || abs ( we ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"wW = wd * wg ; else { wh = acos ( wd ) ; we = acos ( we ) ; wk = normalize ( wk ) ; wl = normalize ( wl ) ; wi = max ( wh , we ) ; wj = min ( wh , we ) ; wj *= 0.95 ; we = max ( dot ( wk , wl ) , ZERO_VALUE_NODES ) ; wf = 0.45 * ( wf / ( wf + 0.09 ) ) ; wW = wd * ( wg + ( wf * we * sin ( wi ) * tan ( wj ) ) ) ; } } else wW = wd ; wW = max ( wW , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"wX",qualifier:["vec3"],c:!1},{type:"node_in",name:"wY",qualifier:["vec2"],c:!1},{type:"node_in",name:"wZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"w_",qualifier:["float"],c:!1},{type:"node_in",name:"xa",qualifier:["vec2"],c:!1},{type:"node_out",name:"xb",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xb = ZERO_VALUE_NODES ; if ( wY . r != ZERO_VALUE_NODES ) { wd = ( UNITY_VALUE_NODES - w_ ) * dot ( wZ , wX ) + w_ ; wj = max ( dot ( wZ , vW ) , ZERO_VALUE_NODES ) ; if ( xa [ 0 ] <= UNITY_VALUE_NODES ) xb = wd * pow ( max ( wj * wd , 0.1 ) , xa [ 0 ] - UNITY_VALUE_NODES ) ; else xb = wd * pow ( 1.0001 - wj , xa [ 0 ] - UNITY_VALUE_NODES ) ; xb = max ( xb , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"xc",qualifier:["vec3"],c:!1},{type:"node_in",name:"xd",qualifier:["vec2"],c:!1},{type:"node_in",name:"xe",qualifier:["vec3"],c:!1},{type:"node_in",name:"xf",qualifier:["float"],c:!1},{type:"node_in",name:"xg",qualifier:["vec2"],c:!1},{type:"node_out",name:"xh",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xh = ZERO_VALUE_NODES ; if ( xd . r != ZERO_VALUE_NODES ) { wj = ( UNITY_VALUE_NODES - xf ) * dot ( xe , xc ) + xf ; wj = acos ( wj ) ; if ( wj < xg [ 0 ] ) xh = UNITY_VALUE_NODES ; else if ( wj > ( xg [ 0 ] + xg [ 1 ] ) || xg [ 1 ] == ZERO_VALUE_NODES ) xh = ZERO_VALUE_NODES ; else xh = UNITY_VALUE_NODES - ( ( wj - xg [ 0 ] ) / xg [ 1 ] ) ; xh = max ( xh , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"xi",qualifier:["vec3"],c:!1},{type:"node_in",name:"xj",qualifier:["vec2"],c:!1},{type:"node_in",name:"xk",qualifier:["vec3"],c:!1},{type:"node_in",name:"xl",qualifier:["float"],c:!1},{type:"node_in",name:"xm",qualifier:["vec2"],c:!1},{type:"node_out",name:"xn",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xn = ZERO_VALUE_NODES ; if ( xj . g != ZERO_VALUE_NODES ) { wl = normalize ( xi + vW ) ; xn = ( UNITY_VALUE_NODES - xl ) * max ( dot ( xk , wl ) , ZERO_VALUE_NODES ) + xl ; xn = pow ( xn , xm [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"xo",qualifier:["vec3"],c:!1},{type:"node_in",name:"xp",qualifier:["vec2"],c:!1},{type:"node_in",name:"xq",qualifier:["vec3"],c:!1},{type:"node_in",name:"xr",qualifier:["vec2"],c:!1},{type:"node_out",name:"xs",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xs = ZERO_VALUE_NODES ; if ( xp . g != ZERO_VALUE_NODES ) { wl = normalize ( xo + vW ) ; wj = max ( dot ( xq , wl ) , 0.001 ) ;".split(" ")},{type:"textline",a:"wd = max ( dot ( xq , vW ) , 0.01 ) ; wi = max ( dot ( xq , xo ) , 0.01 ) ; wj = tan ( acos ( wj ) ) ; we = max ( xr [ 0 ] , 0.001 ) ; xs = wi * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * we * we ) ) * ( exp ( - ( wj * wj ) / ( we * we ) ) / ( sqrt ( wd * wi ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"xt",qualifier:["vec3"],c:!1},{type:"node_in",name:"xu",qualifier:["vec2"],c:!1},{type:"node_in",name:"xv",qualifier:["vec3"],c:!1},{type:"node_in",name:"xw",qualifier:["vec2"],c:!1},{type:"node_out",name:"xx",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xx = ZERO_VALUE_NODES ; if ( xu . g != ZERO_VALUE_NODES ) { wl = normalize ( xt + vW ) ; wi = acos ( dot ( wl , xv ) ) ; if ( wi < xw [ 0 ] ) xx = UNITY_VALUE_NODES ; else if ( wi >= xw [ 0 ] + xw [ 1 ] || xw [ 1 ] == ZERO_VALUE_NODES ) xx = ZERO_VALUE_NODES ; else xx = UNITY_VALUE_NODES - ( wi - xw [ 0 ] ) / xw [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"xy",qualifier:["vec3"],c:!1},{type:"node_in",name:"xz",qualifier:["vec2"],c:!1},{type:"node_in",name:"xA",qualifier:["vec3"],c:!1},{type:"node_in",name:"xB",qualifier:["float"],c:!1},{type:"node_in",name:"xC",qualifier:["vec2"],c:!1},{type:"node_out",name:"xD",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xD = ZERO_VALUE_NODES ; if ( xz . g != ZERO_VALUE_NODES ) { if ( xC [ 0 ] < 1.0 || xC [ 1 ] == ZERO_VALUE_NODES ) xD = ZERO_VALUE_NODES ; else { if ( xC [ 1 ] < 100.0 ) xC [ 1 ] = sqrt ( 1.0 / xC [ 1 ] ) ; else xC [ 1 ] = 10.0 / xC [ 1 ] ; wl = normalize ( vW + xy ) ; wi = ( UNITY_VALUE_NODES - xB ) * max ( dot ( xA , wl ) , ZERO_VALUE_NODES ) + xB ; if ( wi < ZERO_VALUE_NODES ) xD = ZERO_VALUE_NODES ; else { wd = max ( dot ( xA , vW ) , 0.01 ) ; we = dot ( xA , xy ) ; if ( we <= 0.01 ) xD = ZERO_VALUE_NODES ; else { wj = max ( dot ( vW , wl ) , 0.01 ) ; wf = UNITY_VALUE_NODES ; wd = ( 2.0 * wi * wd ) / wj ; we = ( 2.0 * wi * we ) / wj ; we = min ( min ( wf , wd ) , we ) ; wd = sqrt ( pow ( xC [ 0 ] , 2.0 ) + pow ( wj , 2.0 ) - UNITY_VALUE_NODES ) ; wj = pow ( wd - wj , 2.0 ) / pow ( wd + wj , 2.0 ) * ( UNITY_VALUE_NODES + pow ( wj * ( wd + wj ) - UNITY_VALUE_NODES , 2.0 ) / pow ( wj * ( wd - wj ) + UNITY_VALUE_NODES , 2.0 ) ) ; wi = acos ( wi ) ; xD = max ( wj * we * exp ( - pow ( wi , 2.0 ) / ( 2.0 * pow ( xC [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"xE",qualifier:["vec4"],c:!1},{type:"node_in",name:"xF",qualifier:["vec3"],c:!1},{type:"node_in",name:"xG",qualifier:["float"],c:!1},{type:"node_in",name:"xH",qualifier:["float"],c:!1},{type:"node_in",name:"xI",qualifier:["vec3"],c:!1},{type:"node_in",name:"xJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"xK",qualifier:["vec4"],c:!1},{type:"node_in",name:"xL",qualifier:["vec3"],c:!1},{type:"node_in",name:"xM",qualifier:["vec3"],c:!1},{type:"node_in",
name:"xN",qualifier:["vec3"],c:!1},{type:"node_in",name:"xO",qualifier:["float"],c:!1},{type:"node_out",name:"xP",qualifier:["vec4"],c:!1},{type:"node_out",name:"xQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"xQ = xF + xN * xM * xH ; xP = xE + vec4 ( xN * xL * xG , xH ) ;".split(" ")}]},{type:"node",name:"LIGHTING_END",h:[{type:"node_in",name:"xR",qualifier:["vec4"],c:!1},{type:"node_in",name:"xS",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"wb = xR . rgb ; wc = xS ;".split(" ")}]},{type:"nodes_global"},
{type:"textline",a:"void xT ( vec3 vQ , vec3 vR , vec3 vS , vec3 vT , vec3 vU , vec3 vV , vec3 vW , vec2 vX , vec2 vY , vec4 vZ , float v_ , vec4 wa , out vec3 wb , out vec3 wc ) { float wd , we , wf , wg , wh , wi , wj ; vec3 wk , wl ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/particles_nodes.glslf"]={type:"group",b:[{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",
a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",
a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NODE_TEX_ROW",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float xU = 0.5 ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR",
"USE_NODE_SEPHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 xZ ( vec3 xV ) { float xW , xX ; vec4 xY ; xY = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; xY = mix ( vec4 ( xV . bg , xY . wz ) , vec4 ( xV . gb , xY . xy ) , step ( xV . b , xV . g ) ) ; xY = mix ( vec4 ( xY . xyw , xV . r ) , vec4 ( xV . r , xY . yzx ) , step ( xY . x , xV . r ) ) ; xW = xY . x - min ( xY . w , xY . y ) ; xX = 1.0e-10 ; return vec3 ( abs ( xY . z + ( xY . w - xY . y ) / ( 6.0 * xW + xX ) ) , xW / ( xY . x + xX ) , xY . x ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 yc ( vec3 x_ ) { vec3 ya ; vec4 yb ; yb = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; ya = abs ( fract ( vec3 ( x_ . r , x_ . r , x_ . r ) + yb . xyz ) * 6.0 - yb . www ) ; return x_ . b * mix ( yb . xxx , clamp ( ya - yb . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , x_ . g ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec3 ye ( vec2 yd ) { return vec3 ( yd * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec2 yg ( vec3 yf ) { return vec2 ( yf . xy * xU + vec2 ( xU , xU ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",h:[{type:"node_out",name:"yV",qualifier:["vec3"],c:!0},{type:"node_out",name:"yW",qualifier:["float"],c:!0},{type:"node_out",name:"yX",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yV"],f:[{type:"textline",a:"yV = normalize ( yM . xyz ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yW"],f:[{type:"textline",a:"yW = abs ( yM . z ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yX"],
f:[{type:"textline",a:"yX = length ( yM . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",h:[{type:"node_in",name:"yY",qualifier:["float"],c:!1},{type:"node_in",name:"yZ",qualifier:["float"],c:!1},{type:"node_in",name:"y_",qualifier:["float"],c:!1},{type:"node_out",name:"za",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"za = vec3 ( yY , yZ , y_ ) ;".split(" ")}]},{type:"node",name:"COMBHSV",h:[{type:"node_in",name:"zb",qualifier:["float"],c:!1},{type:"node_in",name:"zc",qualifier:["float"],
c:!1},{type:"node_in",name:"zd",qualifier:["float"],c:!1},{type:"node_out",name:"ze",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ze = yc ( vec3 ( zb , zc , zd ) ) ;".split(" ")}]},{type:"node",name:"EMPTY_UV",h:[{type:"node_out",name:"zf",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zf = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"EMPTY_VC",h:[{type:"node_out",name:"zg",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zg = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[{type:"node_out",name:"zh",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zh = ye ( bM ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",h:[{type:"node_out",name:"zi",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zi = 2.0 * vec3 ( bM , ZERO_VALUE_NODES ) - vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_out",name:"zj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zj = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_out",name:"zk",qualifier:["float"],c:!1}],f:[{type:"textline",a:["zk","=","UNITY_VALUE_NODES",";"]}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_out",name:"zl",qualifier:["float"],c:!1},{type:"node_out",name:"zm",qualifier:["float"],c:!1}],f:[{type:"textline",a:"zl = UNITY_VALUE_NODES ; zm = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_out",name:"zn",qualifier:["float"],c:!1},{type:"node_out",name:"zo",qualifier:["float"],
c:!1},{type:"node_out",name:"zp",qualifier:["float"],c:!1}],f:[{type:"textline",a:"zn = UNITY_VALUE_NODES ; zo = UNITY_VALUE_NODES ; zp = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_NO",h:[{type:"node_out",name:"zq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zq = yP . xzy ; zq . y *= - 1.0 ;".split(" ")}]},{type:"node",name:"GEOMETRY_FB",h:[{type:"node_out",name:"zr",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["INVERT_FRONTFACING"],f:[{type:"textline",
a:"zr = ( gl_FrontFacing ) ? ZERO_VALUE_NODES : UNITY_VALUE_NODES ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"zr = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]}]}]},{type:"node",name:"GEOMETRY_VW",h:[{type:"node_out",name:"zs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zs = - ( yr * vec4 ( yq , 0.0 ) ) . xyz ;".split(" ")}]},{type:"node",name:"GEOMETRY_LO",h:[{type:"node_out",name:"zt",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zt [ 0 ] = yM [ 0 ] ; zt [ 1 ] = yM [ 1 ] ; zt [ 2 ] = yM [ 2 ] ;".split(" ")}]},
{type:"node",name:"GEOMETRY_GL",h:[{type:"node_out",name:"zu",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zu = vec3 ( yQ . r , - yQ . b , yQ . g ) ;".split(" ")}]},{type:"node",name:"NEW_GEOMETRY",h:[{type:"node_out",name:"zv",qualifier:["vec3"],c:!1},{type:"node_out",name:"zw",qualifier:["vec3"],c:!1},{type:"node_out",name:"zx",qualifier:["vec3"],c:!1},{type:"node_out",name:"zy",qualifier:["vec3"],c:!1},{type:"node_out",name:"zz",qualifier:["vec3"],c:!1},{type:"node_out",name:"zA",qualifier:["vec3"],
c:!1},{type:"node_out",name:"zB",qualifier:["float"],c:!1},{type:"node_out",name:"zC",qualifier:["float"],c:!1}],f:[{type:"textline",a:"zv = vec3 ( ZERO_VALUE_NODES ) ; zw = vec3 ( ZERO_VALUE_NODES ) ; zx = vec3 ( ZERO_VALUE_NODES ) ; zy = vec3 ( ZERO_VALUE_NODES ) ; zz = vec3 ( ZERO_VALUE_NODES ) ; zA = vec3 ( ZERO_VALUE_NODES ) ; zB = ZERO_VALUE_NODES ; zC = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"HUE_SAT",h:[{type:"node_in",name:"zD",qualifier:["float"],c:!1},{type:"node_in",name:"zE",
qualifier:["float"],c:!1},{type:"node_in",name:"zF",qualifier:["float"],c:!1},{type:"node_in",name:"zG",qualifier:["float"],c:!1},{type:"node_in",name:"zH",qualifier:["vec3"],c:!1},{type:"node_out",name:"zI",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yS = xZ ( zH ) ; yS [ 0 ] += ( zD - xU ) ; if ( yS [ 0 ] > UNITY_VALUE_NODES ) yS [ 0 ] -= UNITY_VALUE_NODES ; else if ( yS [ 0 ] < ZERO_VALUE_NODES ) yS [ 0 ] += UNITY_VALUE_NODES ; yS *= vec3 ( UNITY_VALUE_NODES , zE , zF ) ; yS = mix ( vec3 ( UNITY_VALUE_NODES ) , mix ( vec3 ( ZERO_VALUE_NODES ) , yS , step ( vec3 ( ZERO_VALUE_NODES ) , yS ) ) , step ( yS , vec3 ( UNITY_VALUE_NODES ) ) ) ; zI = mix ( zH , yc ( yS ) , zG ) ;".split(" ")}]},
{type:"node",name:"INVERT",h:[{type:"node_in",name:"zJ",qualifier:["float"],c:!1},{type:"node_in",name:"zK",qualifier:["vec3"],c:!1},{type:"node_out",name:"zL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zL = mix ( zK , vec3 ( UNITY_VALUE_NODES ) - zK , zJ ) ;".split(" ")}]},{type:"node",name:"LAMP",h:[{type:"node_out",name:"zM",qualifier:["vec3"],c:!0},{type:"node_out",name:"zN",qualifier:["vec3"],c:!1},{type:"node_out",name:"zO",qualifier:["float"],c:!1},{type:"node_out",name:"zP",qualifier:["float"],
c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zM"],f:[{type:"textline",a:"zM = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",a:"yN = u_lamp_light_factors [ LAMP_INDEX ] ; yS = u_lamp_light_directions [ LAMP_INDEX ] ; yT = u_lamp_light_positions [ LAMP_INDEX ] ; yF = yN . z ; if ( yF != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",a:"zN = bC - yT ; zO = length ( zN ) ; zN = normalize ( zN ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_zP"],f:[{type:"textline",a:"zP = yF / ( yF + zO * zO ) ; yF = yN . x ; yG = yN . y ; if ( yF > - UNITY_VALUE_NODES ) { yH = dot ( - zN , yS ) ; yH *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( yH - yF ) / yG ) ; zP *= yH ; }".split(" ")}]}]},{type:"textline",a:["}","else","{"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zN"],f:[{type:"textline",a:["zN","=","yS",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zO"],f:[{type:"textline",a:"zO = length ( yT - bC ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zP"],f:[{type:"textline",a:["zP","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",a:["}"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zN"],f:[{type:"textline",a:"zN . yz = vec2 ( - zN . z , zN . y ) ;".split(" ")}]}]}]},{type:"node",name:"NORMAL",h:[{type:"node_in",name:"zQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"zR",qualifier:["vec3"],c:!0},{type:"node_out",name:"zS",qualifier:["float"],c:!0},{type:"node_param",name:"yh",
qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zR"],f:[{type:"textline",a:["zR","=","yh",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zS"],f:[{type:"textline",a:"zS = - dot ( zQ , yh ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",h:[{type:"node_in",name:"zT",qualifier:["vec3"],c:!1},{type:"node_out",name:"zU",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zU = - ( ys * vec4 ( zT , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",
name:"BSDF_ANISOTROPIC",h:[{type:"node_in",name:"zV",qualifier:["vec3"],c:!1},{type:"node_in",name:"zW",qualifier:["float"],c:!1},{type:"node_in",name:"zX",qualifier:["float"],c:!1},{type:"node_in",name:"zY",qualifier:["float"],c:!1},{type:"node_in",name:"zZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"z_",qualifier:["vec3"],c:!1},{type:"node_out",name:"Aa",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Aa","=","zV",";"]},{type:"textline",a:"zW ; zX ; zY ; zZ ; z_ ;".split(" ")}]},{type:"node",
name:"BSDF_DIFFUSE",h:[{type:"node_in",name:"Ab",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ac",qualifier:["float"],c:!1},{type:"node_in",name:"Ad",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ae",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Ae","=","Ab",";"]},{type:"textline",a:["Ac",";","Ad",";"]}]},{type:"node",name:"BSDF_GLASS",h:[{type:"node_in",name:"Af",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ag",qualifier:["float"],c:!1},{type:"node_in",name:"Ah",qualifier:["float"],c:!1},
{type:"node_in",name:"Ai",qualifier:["vec3"],c:!1},{type:"node_out",name:"Aj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Aj","=","Af",";"]},{type:"textline",a:"Ag ; Ah ; Ai ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",h:[{type:"node_in",name:"Ak",qualifier:["vec3"],c:!1},{type:"node_in",name:"Al",qualifier:["float"],c:!1},{type:"node_in",name:"Am",qualifier:["vec3"],c:!1},{type:"node_out",name:"An",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["An","=","Ak",";"]},{type:"textline",a:["Al",
";","Am",";"]}]},{type:"node",name:"BSDF_HAIR",h:[{type:"node_in",name:"Ao",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ap",qualifier:["float"],c:!1},{type:"node_in",name:"Aq",qualifier:["float"],c:!1},{type:"node_in",name:"Ar",qualifier:["float"],c:!1},{type:"node_out",name:"As",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["As","=","Ao",";"]},{type:"textline",a:"Ap ; Aq ; Ar ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",h:[{type:"node_in",name:"At",qualifier:["vec3"],c:!1},{type:"node_out",
name:"Au",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Au","=","At",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",h:[{type:"node_in",name:"Av",qualifier:["vec3"],c:!1},{type:"node_in",name:"Aw",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ax",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Ax","=","Av",";"]},{type:"textline",a:["Aw",";"]}]},{type:"node",name:"BSDF_REFRACTION",h:[{type:"node_in",name:"Ay",qualifier:["vec3"],c:!1},{type:"node_in",name:"Az",qualifier:["float"],c:!1},{type:"node_in",
name:"AA",qualifier:["float"],c:!1},{type:"node_in",name:"AB",qualifier:["vec3"],c:!1},{type:"node_out",name:"AC",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AC [ 0 ] = AC [ 1 ] = AC [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"Ay ; Az ; AA ; AB ;".split(" ")}]},{type:"node",name:"BSDF_TOON",h:[{type:"node_in",name:"AD",qualifier:["vec3"],c:!1},{type:"node_in",name:"AE",qualifier:["float"],c:!1},{type:"node_in",name:"AF",qualifier:["float"],c:!1},{type:"node_in",name:"AG",qualifier:["vec3"],
c:!1},{type:"node_out",name:"AH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AH","=","AD",";"]},{type:"textline",a:"AE ; AF ; AG ;".split(" ")}]},{type:"node",name:"BSDF_VELVET",h:[{type:"node_in",name:"AI",qualifier:["vec3"],c:!1},{type:"node_in",name:"AJ",qualifier:["float"],c:!1},{type:"node_in",name:"AK",qualifier:["vec3"],c:!1},{type:"node_out",name:"AL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AL","=","AI",";"]},{type:"textline",a:["AJ",";","AK",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",
h:[{type:"node_in",name:"AM",qualifier:["vec3"],c:!1},{type:"node_in",name:"AN",qualifier:["float"],c:!1},{type:"node_in",name:"AO",qualifier:["vec3"],c:!1},{type:"node_in",name:"AP",qualifier:["float"],c:!1},{type:"node_in",name:"AQ",qualifier:["float"],c:!1},{type:"node_in",name:"AR",qualifier:["vec3"],c:!1},{type:"node_out",name:"AS",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AS [ 0 ] = AS [ 1 ] = AS [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"AM ; AO ; AP ; AQ ; AR ; AN ;".split(" ")}]},
{type:"node",name:"EMISSION",h:[{type:"node_in",name:"AT",qualifier:["vec3"],c:!1},{type:"node_in",name:"AU",qualifier:["float"],c:!1},{type:"node_out",name:"AV",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AV","=","AT",";"]},{type:"textline",a:["AU",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",h:[{type:"node_in",name:"AW",qualifier:["vec3"],c:!1},{type:"node_out",name:"AX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AX [ 0 ] = AX [ 1 ] = AX [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",
a:["AW",";"]}]},{type:"node",name:"HOLDOUT",h:[{type:"node_out",name:"AY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AY [ 0 ] = AY [ 1 ] = AY [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",h:[{type:"node_in",name:"AZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"A_",qualifier:["float"],c:!1},{type:"node_out",name:"Ba",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Ba [ 0 ] = Ba [ 1 ] = Ba [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["AZ",";",
"A_",";"]}]},{type:"node",name:"VOLUME_SCATTER",h:[{type:"node_in",name:"Bb",qualifier:["vec3"],c:!1},{type:"node_in",name:"Bc",qualifier:["float"],c:!1},{type:"node_in",name:"Bd",qualifier:["float"],c:!1},{type:"node_out",name:"Be",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Be [ 0 ] = Be [ 1 ] = Be [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"Bb ; Bc ; Bd ;".split(" ")}]},{type:"node",name:"BUMP",h:[{type:"node_in",name:"Bf",qualifier:["float"],c:!1},{type:"node_in",name:"Bg",
qualifier:["float"],c:!1},{type:"node_in",name:"Bh",qualifier:["float"],c:!1},{type:"node_in",name:"Bi",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Bj","=","Bi",";"]},{type:"textline",a:"Bf ; Bg ; Bh ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",h:[{type:"node_in",name:"Bk",qualifier:["float"],c:!1},{type:"node_in",name:"Bl",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bm",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Bm","=","Bl",
";"]},{type:"textline",a:["Bk",";"]}]},{type:"node",name:"VECT_TRANSFORM",h:[{type:"node_in",name:"Bn",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bo",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{type:"equal_expr",e:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{type:"equal_expr",e:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],f:[{type:"textline",a:["Bo","=","Bn",";"]}]},{type:"node_else",
f:[{type:"node_condition",b:[{type:"node_if",d:["VECTOR_TYPE","VT_POINT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"yN = vec4 ( Bn , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"yN = vec4 ( Bn , ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( ys * yN ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{type:"equal_expr",
e:2}],f:[{type:"textline",a:"Bo = ( yv * yN ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( yu * yN ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( ys * yu * yN ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( yt * yN ) . xyz ;".split(" ")}]},
{type:"node_elif",d:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( yv * yt * yN ) . xyz ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["VECTOR_TYPE","VT_NORMAL",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = normalize ( Bo ) ;".split(" ")}]}]}]}]}]},{type:"node",name:"BLACKBODY",h:[{type:"node_in",name:"Bp",qualifier:["float"],c:!1},{type:"node_out",name:"Bq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Bq [ 0 ] = Bq [ 1 ] = Bq [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["Bp",";"]}]},{type:"node",name:"WAVELENGTH",h:[{type:"node_in",name:"Br",qualifier:["float"],c:!1},{type:"node_out",name:"Bs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Bs [ 0 ] = Bs [ 1 ] = Bs [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["Br",";"]}]},{type:"node",name:"SEPXYZ",h:[{type:"node_in",name:"Bt",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bu",qualifier:["float"],c:!1},{type:"node_out",name:"Bv",qualifier:["float"],c:!1},{type:"node_out",name:"Bw",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"Bu = Bt [ 0 ] ; Bv = Bt [ 1 ] ; Bw = Bt [ 2 ] ;".split(" ")}]},{type:"node",name:"COMBXYZ",h:[{type:"node_in",name:"Bx",qualifier:["float"],c:!1},{type:"node_in",name:"By",qualifier:["float"],c:!1},{type:"node_in",name:"Bz",qualifier:["float"],c:!1},{type:"node_out",name:"BA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"BA [ 0 ] = Bx ; BA [ 1 ] = By ; BA [ 2 ] = Bz ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",h:[{type:"node_in",name:"BB",
qualifier:["vec3"],c:!1},{type:"node_in",name:"BC",qualifier:["float"],c:!1},{type:"node_in",name:"BD",qualifier:["float"],c:!1},{type:"node_out",name:"BE",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yH = BC - BD * xU ; BE = max ( ( UNITY_VALUE_NODES + BD ) * BB + yH , vec3 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",h:[{type:"node_in",name:"BF",qualifier:["float"],c:!1},{type:"node_in",name:"BG",qualifier:["float"],c:!1},{type:"node_out",name:"BH",qualifier:["float"],
c:!1},{type:"node_out",name:"BI",qualifier:["float"],c:!1},{type:"node_out",name:"BJ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BH = BI = BJ = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["BF",";","BG",";"]}]},{type:"node",name:"TEX_IMAGE",h:[{type:"node_in",name:"BK",qualifier:["vec3"],c:!1},{type:"node_out",name:"BL",qualifier:["vec3"],c:!1},{type:"node_out",name:"BM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BL [ 0 ] = BL [ 1 ] = BL [ 2 ] = ZERO_VALUE_NODES ; BM = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:["BK",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",h:[{type:"node_in",name:"BN",qualifier:["vec3"],c:!1},{type:"node_out",name:"BO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"BO [ 0 ] = BO [ 1 ] = BO [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["BN",";"]}]},{type:"node",name:"TEX_SKY",h:[{type:"node_in",name:"BP",qualifier:["vec3"],c:!1},{type:"node_out",name:"BQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"BQ [ 0 ] = BQ [ 1 ] = BQ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["BP",";"]}]},{type:"node",name:"TEX_NOISE",h:[{type:"node_in",name:"BR",qualifier:["vec3"],c:!1},{type:"node_in",name:"BS",qualifier:["float"],c:!1},{type:"node_in",name:"BT",qualifier:["float"],c:!1},{type:"node_in",name:"BU",qualifier:["float"],c:!1},{type:"node_out",name:"BV",qualifier:["vec3"],c:!1},{type:"node_out",name:"BW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BV [ 0 ] = BV [ 1 ] = BV [ 2 ] = ZERO_VALUE_NODES ; BW = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
a:"BR ; BS ; BT ; BU ;".split(" ")}]},{type:"node",name:"TEX_WAVE",h:[{type:"node_in",name:"BX",qualifier:["vec3"],c:!1},{type:"node_in",name:"BY",qualifier:["float"],c:!1},{type:"node_in",name:"BZ",qualifier:["float"],c:!1},{type:"node_in",name:"B_",qualifier:["float"],c:!1},{type:"node_in",name:"Ca",qualifier:["float"],c:!1},{type:"node_out",name:"Cb",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cc",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cb [ 0 ] = Cb [ 1 ] = Cb [ 2 ] = ZERO_VALUE_NODES ; Cc = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"BX ; BY ; BZ ; B_ ; Ca ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",h:[{type:"node_in",name:"Cd",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ce",qualifier:["float"],c:!1},{type:"node_out",name:"Cf",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cg",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cf [ 0 ] = Cf [ 1 ] = Cf [ 2 ] = ZERO_VALUE_NODES ; Cg = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["Cd",";","Ce",";"]}]},{type:"node",name:"TEX_MUSGRAVE",h:[{type:"node_in",
name:"Ch",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ci",qualifier:["float"],c:!1},{type:"node_in",name:"Cj",qualifier:["float"],c:!1},{type:"node_in",name:"Ck",qualifier:["float"],c:!1},{type:"node_in",name:"Cl",qualifier:["float"],c:!1},{type:"node_in",name:"Cm",qualifier:["float"],c:!1},{type:"node_in",name:"Cn",qualifier:["float"],c:!1},{type:"node_out",name:"Co",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cp",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Co [ 0 ] = Co [ 1 ] = Co [ 2 ] = ZERO_VALUE_NODES ; Cp = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"Ch ; Ci ; Cj ; Ck ; Cl ; Cm ; Cn ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",h:[{type:"node_in",name:"Cq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cr",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cs",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cr [ 0 ] = Cr [ 1 ] = Cr [ 2 ] = ZERO_VALUE_NODES ; Cs = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["Cq",";"]}]},{type:"node",name:"TEX_MAGIC",h:[{type:"node_in",name:"Ct",qualifier:["vec3"],c:!1},{type:"node_in",
name:"Cu",qualifier:["float"],c:!1},{type:"node_in",name:"Cv",qualifier:["float"],c:!1},{type:"node_out",name:"Cw",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cx",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cw [ 0 ] = Cw [ 1 ] = Cw [ 2 ] = ZERO_VALUE_NODES ; Cx = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"Ct ; Cu ; Cv ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",h:[{type:"node_in",name:"Cy",qualifier:["vec3"],c:!1},{type:"node_in",name:"Cz",qualifier:["vec3"],c:!1},{type:"node_in",
name:"CA",qualifier:["vec3"],c:!1},{type:"node_in",name:"CB",qualifier:["float"],c:!1},{type:"node_out",name:"CC",qualifier:["vec3"],c:!1},{type:"node_out",name:"CD",qualifier:["float"],c:!1}],f:[{type:"textline",a:"CC [ 0 ] = CC [ 1 ] = CC [ 2 ] = ZERO_VALUE_NODES ; CD = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"Cy ; Cz ; CA ; CB ;".split(" ")}]},{type:"node",name:"TEX_BRICK",h:[{type:"node_in",name:"CE",qualifier:["vec3"],c:!1},{type:"node_in",name:"CF",qualifier:["vec3"],c:!1},{type:"node_in",
name:"CG",qualifier:["vec3"],c:!1},{type:"node_in",name:"CH",qualifier:["vec3"],c:!1},{type:"node_in",name:"CI",qualifier:["float"],c:!1},{type:"node_in",name:"CJ",qualifier:["float"],c:!1},{type:"node_in",name:"CK",qualifier:["float"],c:!1},{type:"node_in",name:"CL",qualifier:["float"],c:!1},{type:"node_in",name:"CM",qualifier:["float"],c:!1},{type:"node_out",name:"CN",qualifier:["vec3"],c:!1},{type:"node_out",name:"CO",qualifier:["float"],c:!1}],f:[{type:"textline",a:"CN [ 0 ] = CN [ 1 ] = CN [ 2 ] = ZERO_VALUE_NODES ; CO = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"CE ; CF ; CG ; CH ; CI ; CJ ; CK ; CL ; CM ;".split(" ")}]},{type:"node",name:"ADD_SHADER",h:[{type:"node_in",name:"CP",qualifier:["vec3"],c:!1},{type:"node_in",name:"CQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"CR",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CR = clamp ( CP + CQ , vec3 ( ZERO_VALUE_NODES ) , vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",h:[{type:"node_in",name:"CS",qualifier:["float"],c:!1},{type:"node_in",name:"CT",
qualifier:["vec3"],c:!1},{type:"node_in",name:"CU",qualifier:["vec3"],c:!1},{type:"node_out",name:"CV",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yH = clamp ( CS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; CV = yH * CT + ( UNITY_VALUE_NODES - yH ) * CU ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[{type:"node_out",name:"CW",qualifier:["vec3"],c:!1},{type:"node_out",name:"CX",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CW"],f:[{type:"textline",a:"CW = ye ( bM ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CX"],f:[{type:"textline",a:"CX = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_out",name:"CY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CY = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",h:[{type:"node_out",name:"CZ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["CZ","=","yR",";"]}]},{type:"node",name:"TEX_COORD_GE",h:[{type:"node_out",name:"C_",
qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"C_ = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_OB",h:[{type:"node_out",name:"Da",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Da [ 0 ] = Da [ 1 ] = Da [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",h:[{type:"node_out",name:"Db",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Db [ 0 ] = yM [ 0 ] ; Db [ 1 ] = yM [ 1 ] ; Db [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_WI",
h:[{type:"node_out",name:"Dc",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dc [ 0 ] = Dc [ 1 ] = Dc [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",h:[{type:"node_out",name:"Dd",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dd [ 0 ] = Dd [ 1 ] = Dd [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",h:[{type:"node_out",name:"De",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"De = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",
h:[{type:"node_out",name:"Df",qualifier:["float"],c:!1},{type:"node_out",name:"Dg",qualifier:["float"],c:!1},{type:"node_out",name:"Dh",qualifier:["float"],c:!1},{type:"node_out",name:"Di",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dj",qualifier:["float"],c:!1},{type:"node_out",name:"Dk",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dl",qualifier:["vec3"],c:!1},{type:"node_param",name:"yi",qualifier:["varying","vec4"],c:!0},{type:"node_param",name:"yj",qualifier:["varying","vec3"],c:!0},{type:"node_param",
name:"yk",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"yl",qualifier:["varying","vec3"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["PARTICLE_BATCH"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Df"],f:[{type:"textline",a:"Df = yi [ 0 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dg"],f:[{type:"textline",a:"Dg = yi [ 1 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dh"],f:[{type:"textline",a:"Dh = yi [ 2 ] ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Di"],f:[{type:"textline",a:"Di = vec3 ( yj . r , - yj . b , yj . g ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dj"],f:[{type:"textline",a:"Dj = yi [ 3 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dk"],f:[{type:"textline",a:"Dk = vec3 ( yk . r , - yk . b , yk . g ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dl"],f:[{type:"textline",a:"Dl = vec3 ( yl . r , - yl . b , yl . g ) ;".split(" ")}]}]}]},
{type:"node_else",f:[{type:"textline",a:"Df = ZERO_VALUE_NODES ; Dg = ZERO_VALUE_NODES ; Dh = ZERO_VALUE_NODES ; Di = vec3 ( ZERO_VALUE_NODES ) ; Dj = ZERO_VALUE_NODES ; Dk = Di ; Dl = Di ;".split(" ")}]}]}]},{type:"node",name:"HAIR_INFO",h:[{type:"node_out",name:"Dm",qualifier:["float"],c:!1},{type:"node_out",name:"Dn",qualifier:["float"],c:!1},{type:"node_out",name:"Do",qualifier:["float"],c:!1},{type:"node_out",name:"Dp",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dm = ZERO_VALUE_NODES ; Dn = ZERO_VALUE_NODES ; Do = ZERO_VALUE_NODES ; Dp = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",h:[{type:"node_out",name:"Dq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dr",qualifier:["float"],c:!1},{type:"node_out",name:"Ds",qualifier:["float"],c:!1},{type:"node_out",name:"Dt",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Dr = ZERO_VALUE_NODES ; Ds = ZERO_VALUE_NODES ; Dt = ZERO_VALUE_NODES ; Dq = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",h:[{type:"node_in",name:"Du",qualifier:["float"],c:!1},{type:"node_out",name:"Dv",
qualifier:["float"],c:!1}],f:[{type:"textline",a:["Dv","=","Du",";"]}]},{type:"node",name:"TANGENT",h:[{type:"node_out",name:"Dw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dw = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",h:[{type:"node_in",name:"Dx",qualifier:["float"],c:!1},{type:"node_in",name:"Dy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dz",qualifier:["float"],c:!1},{type:"node_out",name:"DA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Dz = DA = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["Dy",";","Dx",";"]}]},{type:"node",name:"LIGHT_PATH",h:[{type:"node_out",name:"DB",qualifier:["float"],c:!1},{type:"node_out",name:"DC",qualifier:["float"],c:!1},{type:"node_out",name:"DD",qualifier:["float"],c:!1},{type:"node_out",name:"DE",qualifier:["float"],c:!1},{type:"node_out",name:"DF",qualifier:["float"],c:!1},{type:"node_out",name:"DG",qualifier:["float"],c:!1},{type:"node_out",name:"DH",qualifier:["float"],c:!1},{type:"node_out",name:"DI",qualifier:["float"],c:!1},{type:"node_out",
name:"DJ",qualifier:["float"],c:!1},{type:"node_out",name:"DK",qualifier:["float"],c:!1}],f:[{type:"textline",a:"DB = DC = DD = ZERO_VALUE_NODES ; DE = DF = DG = ZERO_VALUE_NODES ; DH = DH = DJ = DK = ZERO_VALUE_NODES ; DI = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",h:[{type:"node_out",name:"DL",qualifier:["vec3"],c:!1},{type:"node_out",name:"DM",qualifier:["vec3"],c:!1},{type:"node_out",name:"DN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"DL = DM = vec3 ( ZERO_VALUE_NODES ) ; DN = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",h:[],f:[]},{type:"node",name:"CURVE_VEC",h:[{type:"node_in",name:"DO",qualifier:["float"],c:!1},{type:"node_in",name:"DP",qualifier:["vec3"],c:!1},{type:"node_out",name:"DQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["DQ","=","DP",";"]},{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"DQ . r = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * DP . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["READ_G"],f:[{type:"textline",a:"DQ . g = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * DP . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"DQ . b = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * DP . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"textline",a:"DQ = mix ( DP , DQ , DO ) ;".split(" ")}]},{type:"node",name:"CURVE_RGB",h:[{type:"node_in",name:"DR",qualifier:["float"],
c:!1},{type:"node_in",name:"DS",qualifier:["vec3"],c:!1},{type:"node_out",name:"DT",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["READ_A"],f:[{type:"textline",a:"yH = texture2D ( u_nodes_texture , vec2 ( DS . r , NODE_TEX_ROW ) ) . a ; yG = texture2D ( u_nodes_texture , vec2 ( DS . g , NODE_TEX_ROW ) ) . a ; yF = texture2D ( u_nodes_texture , vec2 ( DS . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"yH = DS . r ; yG = DS . g ; yF = DS . b ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"DT . r = texture2D ( u_nodes_texture , vec2 ( yH , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DT . r = yH ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"DT . g = texture2D ( u_nodes_texture , vec2 ( yG , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DT . g = yG ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"DT . b = texture2D ( u_nodes_texture , vec2 ( yF , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DT . b = yF ;".split(" ")}]}]},{type:"textline",a:"DT = mix ( DS , DT , DR ) ;".split(" ")}]},{type:"node",name:"VALTORGB",h:[{type:"node_in",name:"DU",qualifier:["float"],c:!1},{type:"node_out",name:"DV",qualifier:["vec3"],c:!1},{type:"node_out",name:"DW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yN = texture2D ( u_nodes_texture , vec2 ( DU , NODE_TEX_ROW ) ) ; DV = yN . rgb ; DW = yN . a ;".split(" ")}]},
{type:"node",name:"MAPPING",h:[{type:"node_in",name:"DX",qualifier:["vec3"],c:!1},{type:"node_out",name:"DY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["DY","=","DX",";"]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",f:[{type:"textline",a:"DY = ( MAPPING_TRS_MATRIX * vec4 ( DY , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_SCALE",f:[{type:"textline",a:"DY = DY * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",f:[{type:"textline",a:"DY = DY + MAPPING_TRANSLATION ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",f:[{type:"textline",a:"DY = max ( DY , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",f:[{type:"textline",a:"DY = min ( DY , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MAPPING_IS_NORMAL"],f:[{type:"textline",a:"DY = normalize ( DY ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_ADD",h:[{type:"node_in",name:"DZ",qualifier:["float"],c:!1},{type:"node_in",name:"D_",qualifier:["float"],c:!1},{type:"node_out",name:"Ea",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ea = DZ + D_ ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ea = clamp ( Ea , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",h:[{type:"node_in",name:"Eb",qualifier:["float"],c:!1},{type:"node_in",
name:"Ec",qualifier:["float"],c:!1},{type:"node_out",name:"Ed",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ed = Eb - Ec ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ed = clamp ( Ed , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",h:[{type:"node_in",name:"Ee",qualifier:["float"],c:!1},{type:"node_in",name:"Ef",qualifier:["float"],c:!1},{type:"node_out",name:"Eg",qualifier:["float"],c:!1}],f:[{type:"textline",
a:"Eg = Ee * Ef ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Eg = clamp ( Eg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",h:[{type:"node_in",name:"Eh",qualifier:["float"],c:!1},{type:"node_in",name:"Ei",qualifier:["float"],c:!1},{type:"node_out",name:"Ej",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ej = ( Ei != ZERO_VALUE_NODES ) ? Eh / Ei : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ej = clamp ( Ej , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SINE",h:[{type:"node_in",name:"Ek",qualifier:["float"],c:!1},{type:"node_in",name:"El",qualifier:["float"],c:!1},{type:"node_out",name:"Em",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Em = sin ( Ek ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Em = clamp ( Em , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["El",";"]}]},{type:"node",name:"MATH_COSINE",h:[{type:"node_in",name:"En",qualifier:["float"],c:!1},{type:"node_in",name:"Eo",qualifier:["float"],c:!1},{type:"node_out",name:"Ep",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ep = cos ( En ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ep = clamp ( Ep , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Eo",";"]}]},{type:"node",name:"MATH_TANGENT",
h:[{type:"node_in",name:"Eq",qualifier:["float"],c:!1},{type:"node_in",name:"Er",qualifier:["float"],c:!1},{type:"node_out",name:"Es",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Es = tan ( Eq ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Es = clamp ( Es , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Er",";"]}]},{type:"node",name:"MATH_ARCSINE",h:[{type:"node_in",name:"Et",qualifier:["float"],c:!1},{type:"node_in",
name:"Eu",qualifier:["float"],c:!1},{type:"node_out",name:"Ev",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ev = ( Et <= UNITY_VALUE_NODES && Et >= - UNITY_VALUE_NODES ) ? asin ( Et ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ev = clamp ( Ev , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Eu",";"]}]},{type:"node",name:"MATH_ARCCOSINE",h:[{type:"node_in",name:"Ew",qualifier:["float"],
c:!1},{type:"node_in",name:"Ex",qualifier:["float"],c:!1},{type:"node_out",name:"Ey",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ey = ( Ew <= UNITY_VALUE_NODES && Ew >= - UNITY_VALUE_NODES ) ? acos ( Ew ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ey = clamp ( Ey , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Ex",";"]}]},{type:"node",name:"MATH_ARCTANGENT",h:[{type:"node_in",name:"Ez",
qualifier:["float"],c:!1},{type:"node_in",name:"EA",qualifier:["float"],c:!1},{type:"node_out",name:"EB",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EB = atan ( Ez ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EB = clamp ( EB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["EA",";"]}]},{type:"node",name:"MATH_POWER",h:[{type:"node_in",name:"EC",qualifier:["float"],c:!1},{type:"node_in",name:"ED",qualifier:["float"],
c:!1},{type:"node_out",name:"EE",qualifier:["float"],c:!1}],f:[{type:"textline",a:"if ( EC < ZERO_VALUE_NODES && ED != floor ( ED ) ) EE = ZERO_VALUE_NODES ; else if ( ED == ZERO_VALUE_NODES )".split(" ")},{type:"textline",a:"EE = UNITY_VALUE_NODES ; else if ( EC < ZERO_VALUE_NODES ) EE = mix ( UNITY_VALUE_NODES , - UNITY_VALUE_NODES , sign ( mod ( - ED , 2.0 ) ) ) * pow ( - EC , ED ) ; else if ( EC == ZERO_VALUE_NODES ) EE = ZERO_VALUE_NODES ; else EE = pow ( EC , ED ) ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EE = clamp ( EE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",h:[{type:"node_in",name:"EF",qualifier:["float"],c:!1},{type:"node_in",name:"EG",qualifier:["float"],c:!1},{type:"node_out",name:"EH",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EH = ( EF > ZERO_VALUE_NODES && EG > ZERO_VALUE_NODES ) ? log2 ( EF ) / log2 ( EG ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EH = clamp ( EH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",h:[{type:"node_in",name:"EI",qualifier:["float"],c:!1},{type:"node_in",name:"EJ",qualifier:["float"],c:!1},{type:"node_out",name:"EK",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EK = min ( EI , EJ ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EK = clamp ( EK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",h:[{type:"node_in",name:"EL",qualifier:["float"],c:!1},{type:"node_in",name:"EM",qualifier:["float"],c:!1},{type:"node_out",name:"EN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EN = max ( EL , EM ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EN = clamp ( EN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",h:[{type:"node_in",name:"EO",qualifier:["float"],c:!1},
{type:"node_in",name:"EP",qualifier:["float"],c:!1},{type:"node_out",name:"EQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EQ = floor ( EO + xU ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EQ = clamp ( EQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["EP",";"]}]},{type:"node",name:"MATH_LESS_THAN",h:[{type:"node_in",name:"ER",qualifier:["float"],c:!1},{type:"node_in",name:"ES",qualifier:["float"],c:!1},
{type:"node_out",name:"ET",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ET = ( ER < ES ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"ET = clamp ( ET , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",h:[{type:"node_in",name:"EU",qualifier:["float"],c:!1},{type:"node_in",name:"EV",qualifier:["float"],c:!1},{type:"node_out",name:"EW",qualifier:["float"],
c:!1}],f:[{type:"textline",a:"EW = ( EU > EV ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EW = clamp ( EW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",h:[{type:"node_in",name:"EX",qualifier:["float"],c:!1},{type:"node_in",name:"EY",qualifier:["float"],c:!1},{type:"node_out",name:"EZ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EZ = abs ( EY ) > 0.000001 ? mod ( EX , EY ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EZ = clamp ( EZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",h:[{type:"node_in",name:"E_",qualifier:["float"],c:!1},{type:"node_in",name:"Fa",qualifier:["float"],c:!1},{type:"node_out",name:"Fb",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Fb = abs ( E_ ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Fb = clamp ( Fb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["Fa",";"]}]},{type:"node",name:"MIX_RGB_MIX",h:[{type:"node_in",name:"Fc",qualifier:["float"],c:!1},{type:"node_in",name:"Fd",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fe",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ff",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Ff = mix ( Fd , Fe , yF ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ff = clamp ( Ff , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",h:[{type:"node_in",name:"Fg",qualifier:["float"],c:!1},{type:"node_in",name:"Fh",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fi",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fj = mix ( Fh , Fh + Fi , yF ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fj = clamp ( Fj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",h:[{type:"node_in",name:"Fk",qualifier:["float"],c:!1},{type:"node_in",name:"Fl",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fm",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fn",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fn = mix ( Fl , Fl * Fm , yF ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fn = clamp ( Fn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",h:[{type:"node_in",name:"Fo",qualifier:["float"],c:!1},{type:"node_in",name:"Fp",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fr",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fr = mix ( Fp , Fp - Fq , yF ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fr = clamp ( Fr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",h:[{type:"node_in",name:"Fs",qualifier:["float"],c:!1},{type:"node_in",name:"Ft",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fu",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fv",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fs , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; Fv = vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( yG ) + yF * ( vec3 ( UNITY_VALUE_NODES ) - Fu ) ) * ( vec3 ( UNITY_VALUE_NODES ) - Ft ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fv = clamp ( Fv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",h:[{type:"node_in",name:"Fw",qualifier:["float"],c:!1},{type:"node_in",name:"Fx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fz",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; Fy += step ( Fy , vec3 ( ZERO_VALUE_NODES ) ) ; Fz = yG * Fx + yF * Fx / Fy ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fz = clamp ( Fz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",h:[{type:"node_in",name:"FA",qualifier:["float"],c:!1},{type:"node_in",name:"FB",qualifier:["vec3"],c:!1},{type:"node_in",name:"FC",qualifier:["vec3"],c:!1},{type:"node_out",name:"FD",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FD = mix ( FB , abs ( FB - FC ) , yF ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FD = clamp ( FD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",h:[{type:"node_in",name:"FE",qualifier:["float"],c:!1},{type:"node_in",name:"FF",qualifier:["vec3"],c:!1},{type:"node_in",name:"FG",qualifier:["vec3"],c:!1},{type:"node_out",name:"FH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FH = min ( FF . rgb , FG . rgb * yF ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FH = clamp ( FH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",h:[{type:"node_in",name:"FI",qualifier:["float"],c:!1},{type:"node_in",name:"FJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"FK",qualifier:["vec3"],c:!1},{type:"node_out",name:"FL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FL = max ( FJ . rgb , FK . rgb * yF ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FL = clamp ( FL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",h:[{type:"node_in",name:"FM",qualifier:["float"],c:!1},{type:"node_in",name:"FN",qualifier:["vec3"],c:!1},{type:"node_in",name:"FO",qualifier:["vec3"],c:!1},{type:"node_out",name:"FP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yT = vec3 ( UNITY_VALUE_NODES - yF ) ; FP = mix ( FN * ( yT + 2.0 * yF * FO ) , vec3 ( UNITY_VALUE_NODES ) - ( yT + 2.0 * yF * ( vec3 ( UNITY_VALUE_NODES ) - FO ) ) * ( vec3 ( UNITY_VALUE_NODES ) - FN ) , step ( xU , FN ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FP = clamp ( FP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",h:[{type:"node_in",name:"FQ",qualifier:["float"],c:!1},{type:"node_in",name:"FR",qualifier:["vec3"],c:!1},{type:"node_in",name:"FS",qualifier:["vec3"],c:!1},{type:"node_out",name:"FT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yT = vec3 ( UNITY_VALUE_NODES ) - yF * FS ; yS = clamp ( FR / yT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FT = mix ( mix ( yS , vec3 ( UNITY_VALUE_NODES ) , step ( yT , vec3 ( ZERO_VALUE_NODES ) ) ) , FR , step ( FR , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FT = clamp ( FT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",h:[{type:"node_in",name:"FU",qualifier:["float"],c:!1},{type:"node_in",name:"FV",qualifier:["vec3"],c:!1},{type:"node_in",name:"FW",qualifier:["vec3"],c:!1},{type:"node_out",name:"FX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yT = vec3 ( UNITY_VALUE_NODES - yF ) ; yT = yT + yF * FW ; yS = clamp ( vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( UNITY_VALUE_NODES ) - FV ) / yT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FX = mix ( yS , vec3 ( ZERO_VALUE_NODES ) , step ( yT , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FX = clamp ( FX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",h:[{type:"node_in",name:"FY",qualifier:["float"],c:!1},{type:"node_in",name:"FZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"F_",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ga",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Ga = FZ ; yS = xZ ( F_ ) ; if ( yS . y != ZERO_VALUE_NODES ) { yT = xZ ( Ga ) ; yT . x = yS . x ; yU = yc ( yT ) ; Ga = mix ( Ga , yU , yF ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ga = clamp ( Ga , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",h:[{type:"node_in",name:"Gb",qualifier:["float"],c:!1},{type:"node_in",name:"Gc",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gd",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ge",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; Ge = Gc ; yU = xZ ( Ge ) ; if ( yU . y != ZERO_VALUE_NODES ) { yT = xZ ( Gd ) ; yU . y = yG * yU . y + yF * yT . y ; Ge = yc ( yU ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ge = clamp ( Ge , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",h:[{type:"node_in",name:"Gf",qualifier:["float"],c:!1},{type:"node_in",name:"Gg",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gh",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gi",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; yU = xZ ( Gg ) ; yT = xZ ( Gh ) ; yU . z = yG * yU . z + yF * yT . z ; Gi = yc ( yU ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Gi = clamp ( Gi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",h:[{type:"node_in",name:"Gj",qualifier:["float"],c:!1},{type:"node_in",name:"Gk",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gl",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gm",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Gm = Gk ; yT = xZ ( Gl ) ; if ( yT . y != ZERO_VALUE_NODES ) { yU = xZ ( Gm ) ; yU . x = yT . x ; yU . y = yT . y ; yS = yc ( yU ) ; Gm = mix ( Gm , yS , yF ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Gm = clamp ( Gm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",h:[{type:"node_in",name:"Gn",qualifier:["float"],c:!1},{type:"node_in",name:"Go",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gp",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; yS = Gp + Go - Gp * Go ; Gq = Go * ( vec3 ( yG ) + vec3 ( yF ) * ( ( vec3 ( UNITY_VALUE_NODES ) - Go ) * Gp + yS ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Gq = clamp ( Gq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",h:[{type:"node_in",name:"Gr",qualifier:["float"],c:!1},{type:"node_in",name:"Gs",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gt",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gu",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Gu = Gs + yF * ( 2.0 * Gt - vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Gu = clamp ( Gu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",h:[{type:"node_in",name:"Gv",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gw",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yw = Gv ; yA = Gw ;".split(" ")}]},{type:"node",name:"MATERIAL_BEGIN",h:[{type:"node_in",name:"Gx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gy",qualifier:["vec3"],c:!1},{type:"node_in",
name:"Gz",qualifier:["float"],c:!1},{type:"node_in",name:"GA",qualifier:["vec3"],c:!0},{type:"node_in",name:"GB",qualifier:["float"],c:!0},{type:"node_out",name:"GC",qualifier:["vec3"],c:!1},{type:"node_out",name:"GD",qualifier:["vec3"],c:!1},{type:"node_out",name:"GE",qualifier:["vec3"],c:!1},{type:"node_out",name:"GF",qualifier:["vec3"],c:!1},{type:"node_out",name:"GG",qualifier:["vec3"],c:!1},{type:"node_out",name:"GH",qualifier:["vec2"],c:!1},{type:"node_out",name:"GI",qualifier:["vec2"],c:!1},
{type:"node_out",name:"GJ",qualifier:["vec4"],c:!1},{type:"node_param",name:"ym",qualifier:["const","vec2"],c:!0},{type:"node_param",name:"yn",qualifier:["const","vec3"],c:!1}],f:[{type:"textline",a:"GE = clamp ( Gx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"GF = yn [ 0 ] * clamp ( Gy , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_NORMAL"],f:[{type:"textline",a:"GG = normalize ( GA ) ;".split(" ")},
{type:"textline",a:"GG . yz = vec2 ( GG . z , - GG . y ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:["GG","=","yR",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["SHADELESS_MAT",{type:"logic_negative_expr",e:1}],f:[{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"textline",a:"GC = GB * GE ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"GC = yD * GE ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",
a:["GE","*=","Gz",";"]}]}]},{type:"textline",a:"GD = yE * u_environment_energy * dS ( GG ) ; GJ = vec4 ( 1.0 ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],f:[{type:"textline",a:"GH = vec2 ( ym [ 0 ] , ym [ 1 ] ) ;".split(" ")},{type:"textline",a:"GI = vec2 ( yn [ 1 ] , yn [ 2 ] ) ;".split(" ")}]}]},{type:"textline",a:["yz","=","GJ",";"]}]},{type:"node_else",f:[{type:"textline",a:"GC = vec3 ( ZERO_VALUE_NODES ) ; GD = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATERIAL_END",h:[{type:"node_in",name:"GK",qualifier:["vec4"],c:!1},{type:"node_in",name:"GL",qualifier:["vec3"],c:!1},{type:"node_in",name:"GM",qualifier:["vec3"],c:!1},{type:"node_in",name:"GN",qualifier:["float"],c:!0},{type:"node_in",name:"GO",qualifier:["float"],c:!0},{type:"node_in",name:"GP",qualifier:["float"],c:!0},{type:"node_out",name:"GQ",qualifier:["vec3"],c:!0},{type:"node_out",name:"GR",qualifier:["float"],c:!0},{type:"node_out",name:"GS",qualifier:["vec3"],c:!0},
{type:"node_out",name:"GT",qualifier:["vec3"],c:!0},{type:"node_out",name:"GU",qualifier:["vec3"],c:!0},{type:"node_param",name:"yo",qualifier:["float"],c:!1},{type:"node_param",name:"yp",qualifier:["float"],c:!1}],f:[{type:"textline",a:["GN",";"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GQ"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",a:"GQ = GK . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"GQ = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["GQ","+=","GL",";"]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GS"],f:[{type:"textline",a:["GS","=","GM",";"]},{type:"textline",a:"GS . yz = vec2 ( - GS . z , GS . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GT"],f:[{type:"textline",a:"GT = GK . rgb ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_GU"],f:[{type:"textline",a:["GU","=","GL",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GR"],f:[{type:"textline",a:"GR = clamp ( GP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"yF = max ( max ( GL . r , GL . g ) , GL . b ) * GO ; GR = clamp ( GP * ( UNITY_VALUE_NODES - yF ) + yF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},{type:"node_else",
f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GR"],f:[{type:"textline",a:"GR = clamp ( yo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"yF = max ( max ( GL . r , GL . g ) , GL . b ) * yp ; GR = yo * ( UNITY_VALUE_NODES - yF ) + yF ;".split(" ")}]}]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["yx","=","GL",";"]}]},{type:"node_else",
f:[{type:"textline",a:"yx = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["yy","=","GM",";"]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"GV",qualifier:["vec3"],c:!1},{type:"node_in",name:"GW",qualifier:["vec3"],c:!1},{type:"node_in",name:"GX",qualifier:["vec3"],c:!1},{type:"node_out",name:"GY",qualifier:["vec4"],c:!1},{type:"node_out",name:"GZ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"GY = vec4 ( GV + GX * GW , ZERO_VALUE_NODES ) ; GZ = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"G_",qualifier:["vec4"],c:!1},{type:"node_out",name:"Ha",qualifier:["vec3"],c:!1},{type:"node_out",name:"Hb",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hc",qualifier:["vec3"],c:!1},{type:"node_out",name:"Hd",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hb = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",
a:["Hd","=","xU",";"]}]},{type:"node_else",f:[{type:"textline",a:["Hd","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"Hc = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",e:2}],f:[{type:"textline",a:"Hc *= G_ [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",
e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"yS = u_light_positions [ LAMP_IND ] ; Ha = yS - yQ ;".split(" ")},{type:"textline",a:"yF = length ( Ha ) ; Hc *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + yF * yF ) ; Ha = normalize ( Ha ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"yS = u_light_directions [ LAMP_IND ] ; yF = dot ( Ha , yS ) ; yF *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( yF - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; Hc *= yF ;".split(" ")}]}]}]},
{type:"node_else",f:[{type:"textline",a:"Ha = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"He",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hf",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hg",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hh",qualifier:["float"],c:!1},{type:"node_in",name:"Hi",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hj",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hj = ZERO_VALUE_NODES ; if ( Hf . r != ZERO_VALUE_NODES ) { yF = ( UNITY_VALUE_NODES - Hh ) * dot ( Hg , He ) + Hh ; if ( Hi [ 0 ] == ZERO_VALUE_NODES ) { Hj = UNITY_VALUE_NODES ; } else { yF = UNITY_VALUE_NODES + abs ( yF ) ; yF = Hi [ 1 ] + ( UNITY_VALUE_NODES - Hi [ 1 ] ) * pow ( yF , Hi [ 0 ] ) ; Hj = clamp ( yF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } Hj = max ( Hj , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"Hk",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hl",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hm",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hn",qualifier:["float"],c:!1},{type:"node_out",name:"Ho",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ho = ZERO_VALUE_NODES ; if ( Hl . r != ZERO_VALUE_NODES ) { yF = ( UNITY_VALUE_NODES - Hn ) * dot ( Hm , Hk ) + Hn ; Ho = max ( yF , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"Hp",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hq",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hr",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hs",qualifier:["float"],c:!1},{type:"node_in",name:"Ht",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hu",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hu = ZERO_VALUE_NODES ; if ( Hq . r != ZERO_VALUE_NODES ) { yF = ( UNITY_VALUE_NODES - Hs ) * dot ( Hr , Hp ) + Hs ; if ( Ht [ 0 ] > ZERO_VALUE_NODES ) { yG = max ( dot ( Hr , yq ) , ZERO_VALUE_NODES ) ; yH = Ht [ 0 ] * Ht [ 0 ] ; yI = UNITY_VALUE_NODES - xU * ( yH / ( yH + 0.33 ) ) ; yS = Hp - yF * Hr ; yU = yq - yG * Hr ;".split(" ")},
{type:"textline",a:"if ( length ( yS ) == ZERO_VALUE_NODES || length ( yU ) == ZERO_VALUE_NODES || abs ( yF ) > UNITY_VALUE_NODES || abs ( yG ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"Hu = yF * yI ; else { yJ = acos ( yF ) ; yG = acos ( yG ) ; yS = normalize ( yS ) ; yU = normalize ( yU ) ; yK = max ( yJ , yG ) ; yL = min ( yJ , yG ) ; yL *= 0.95 ; yG = max ( dot ( yS , yU ) , ZERO_VALUE_NODES ) ; yH = 0.45 * ( yH / ( yH + 0.09 ) ) ; Hu = yF * ( yI + ( yH * yG * sin ( yK ) * tan ( yL ) ) ) ; } } else Hu = yF ; Hu = max ( Hu , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"Hv",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hw",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hy",qualifier:["float"],c:!1},{type:"node_in",name:"Hz",qualifier:["vec2"],c:!1},{type:"node_out",name:"HA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HA = ZERO_VALUE_NODES ; if ( Hw . r != ZERO_VALUE_NODES ) { yF = ( UNITY_VALUE_NODES - Hy ) * dot ( Hx , Hv ) + Hy ; yL = max ( dot ( Hx , yq ) , ZERO_VALUE_NODES ) ; if ( Hz [ 0 ] <= UNITY_VALUE_NODES ) HA = yF * pow ( max ( yL * yF , 0.1 ) , Hz [ 0 ] - UNITY_VALUE_NODES ) ; else HA = yF * pow ( 1.0001 - yL , Hz [ 0 ] - UNITY_VALUE_NODES ) ; HA = max ( HA , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"HB",qualifier:["vec3"],c:!1},{type:"node_in",name:"HC",qualifier:["vec2"],c:!1},{type:"node_in",name:"HD",qualifier:["vec3"],c:!1},{type:"node_in",name:"HE",qualifier:["float"],c:!1},{type:"node_in",name:"HF",qualifier:["vec2"],c:!1},{type:"node_out",name:"HG",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HG = ZERO_VALUE_NODES ; if ( HC . r != ZERO_VALUE_NODES ) { yL = ( UNITY_VALUE_NODES - HE ) * dot ( HD , HB ) + HE ; yL = acos ( yL ) ; if ( yL < HF [ 0 ] ) HG = UNITY_VALUE_NODES ; else if ( yL > ( HF [ 0 ] + HF [ 1 ] ) || HF [ 1 ] == ZERO_VALUE_NODES ) HG = ZERO_VALUE_NODES ; else HG = UNITY_VALUE_NODES - ( ( yL - HF [ 0 ] ) / HF [ 1 ] ) ; HG = max ( HG , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"HH",qualifier:["vec3"],c:!1},{type:"node_in",name:"HI",qualifier:["vec2"],c:!1},{type:"node_in",name:"HJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"HK",qualifier:["float"],c:!1},{type:"node_in",name:"HL",qualifier:["vec2"],c:!1},{type:"node_out",name:"HM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HM = ZERO_VALUE_NODES ; if ( HI . g == UNITY_VALUE_NODES ) { yU = normalize ( HH + yq ) ; HM = ( UNITY_VALUE_NODES - HK ) * max ( dot ( HJ , yU ) , ZERO_VALUE_NODES ) + HK ; HM = pow ( HM , HL [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"HN",qualifier:["vec3"],c:!1},{type:"node_in",name:"HO",qualifier:["vec2"],c:!1},{type:"node_in",name:"HP",qualifier:["vec3"],c:!1},{type:"node_in",name:"HQ",qualifier:["vec2"],c:!1},{type:"node_out",name:"HR",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HR = ZERO_VALUE_NODES ; if ( HO . g == UNITY_VALUE_NODES ) { yU = normalize ( HN + yq ) ; yL = max ( dot ( HP , yU ) , 0.001 ) ;".split(" ")},{type:"textline",a:"yF = max ( dot ( HP , yq ) , 0.01 ) ; yK = max ( dot ( HP , HN ) , 0.01 ) ; yL = tan ( acos ( yL ) ) ; yG = max ( HQ [ 0 ] , 0.001 ) ; HR = yK * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * yG * yG ) ) * ( exp ( - ( yL * yL ) / ( yG * yG ) ) / ( sqrt ( yF * yK ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"HS",qualifier:["vec3"],c:!1},{type:"node_in",name:"HT",qualifier:["vec2"],c:!1},{type:"node_in",name:"HU",qualifier:["vec3"],c:!1},{type:"node_in",name:"HV",qualifier:["vec2"],c:!1},{type:"node_out",name:"HW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HW = ZERO_VALUE_NODES ; if ( HT . g == UNITY_VALUE_NODES ) { yU = normalize ( HS + yq ) ; yK = acos ( dot ( yU , HU ) ) ; if ( yK < HV [ 0 ] ) HW = UNITY_VALUE_NODES ; else if ( yK >= HV [ 0 ] + HV [ 1 ] || HV [ 1 ] == ZERO_VALUE_NODES ) HW = ZERO_VALUE_NODES ; else HW = UNITY_VALUE_NODES - ( yK - HV [ 0 ] ) / HV [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"HX",qualifier:["vec3"],c:!1},{type:"node_in",name:"HY",qualifier:["vec2"],c:!1},{type:"node_in",name:"HZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"H_",qualifier:["float"],c:!1},{type:"node_in",name:"Ia",qualifier:["vec2"],c:!1},{type:"node_out",name:"Ib",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ib = ZERO_VALUE_NODES ; if ( HY . g == UNITY_VALUE_NODES ) { if ( Ia [ 0 ] < UNITY_VALUE_NODES || Ia [ 1 ] == ZERO_VALUE_NODES ) Ib = ZERO_VALUE_NODES ; else { if ( Ia [ 1 ] < 100.0 ) Ia [ 1 ] = sqrt ( UNITY_VALUE_NODES / Ia [ 1 ] ) ; else Ia [ 1 ] = 10.0 / Ia [ 1 ] ; yU = normalize ( yq + HX ) ; yK = ( UNITY_VALUE_NODES - H_ ) * max ( dot ( HZ , yU ) , ZERO_VALUE_NODES ) + H_ ; if ( yK < ZERO_VALUE_NODES ) Ib = ZERO_VALUE_NODES ; else { yF = max ( dot ( HZ , yq ) , 0.01 ) ; yG = dot ( HZ , HX ) ; if ( yG <= 0.01 ) Ib = ZERO_VALUE_NODES ; else { yL = max ( dot ( yq , yU ) , 0.01 ) ; yH = UNITY_VALUE_NODES ; yF = ( 2.0 * yK * yF ) / yL ; yG = ( 2.0 * yK * yG ) / yL ; yG = min ( min ( yH , yF ) , yG ) ; yF = sqrt ( pow ( Ia [ 0 ] , 2.0 ) + pow ( yL , 2.0 ) - UNITY_VALUE_NODES ) ; yL = pow ( yF - yL , 2.0 ) / pow ( yF + yL , 2.0 ) * ( UNITY_VALUE_NODES + pow ( yL * ( yF + yL ) - UNITY_VALUE_NODES , 2.0 ) / pow ( yL * ( yF - yL ) + UNITY_VALUE_NODES , 2.0 ) ) ; yK = acos ( yK ) ; Ib = max ( yL * yG * exp ( - pow ( yK , 2.0 ) / ( 2.0 * pow ( Ia [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"Ic",qualifier:["vec4"],c:!1},{type:"node_in",name:"Id",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ie",qualifier:["float"],c:!1},{type:"node_in",name:"If",qualifier:["float"],c:!1},{type:"node_in",name:"Ig",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ih",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ii",qualifier:["vec4"],c:!1},{type:"node_in",name:"Ij",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ik",qualifier:["vec3"],c:!1},{type:"node_in",
name:"Il",qualifier:["vec3"],c:!1},{type:"node_in",name:"Im",qualifier:["float"],c:!1},{type:"node_out",name:"In",qualifier:["vec4"],c:!1},{type:"node_out",name:"Io",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_NODE_B4W_TRANSLUCENCY"],f:[{type:"textline",a:"if ( dot ( Ig , Ih ) * dot ( yq , Ih ) < ZERO_VALUE_NODES ) { yK = Ii . x ; yG = Ii . y ; yL = Ii . z ; yF = Ii . w ;".split(" ")},{type:"textline",a:"yH = clamp ( abs ( dot ( Ig , Ih ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yI = clamp ( dot ( yq , - Ig ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = pow ( yI , yG ) ;".split(" ")},
{type:"textline",a:"In = Ic + Im * vec4 ( Il * yH * pow ( Ij , vec3 ( yK ) ) , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"In += yL * mix ( vec4 ( Ij , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , yF ) * Im * vec4 ( Il * yH * vec3 ( yG ) , UNITY_VALUE_NODES ) ; Io = Id ; } else {".split(" ")},{type:"textline",a:"Io = Id + Il * Ik * If ; In = Ic + vec4 ( Il * Ij * Ie , If ) ; }".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"Io = Id + Il * Ik * If ; In = Ic + vec4 ( Il * Ij * Ie , If ) ;".split(" ")}]}]}]},
{type:"node",name:"RGB",h:[{type:"node_out",name:"Ip",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Ip = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",h:[{type:"node_in",name:"Iq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ir",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ir = dot ( Iq , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",h:[{type:"node_in",name:"Is",qualifier:["vec3"],c:!1},{type:"node_out",name:"It",qualifier:["float"],c:!0},
{type:"node_out",name:"Iu",qualifier:["float"],c:!0},{type:"node_out",name:"Iv",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_It"],f:[{type:"textline",a:"It = Is . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Iu"],f:[{type:"textline",a:"Iu = Is . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Iv"],f:[{type:"textline",a:"Iv = Is . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",h:[{type:"node_in",name:"Iw",
qualifier:["vec3"],c:!1},{type:"node_out",name:"Ix",qualifier:["float"],c:!0},{type:"node_out",name:"Iy",qualifier:["float"],c:!0},{type:"node_out",name:"Iz",qualifier:["float"],c:!0}],f:[{type:"textline",a:"yU = xZ ( Iw ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ix"],f:[{type:"textline",a:"Ix = yU . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Iy"],f:[{type:"textline",a:"Iy = yU . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_Iz"],f:[{type:"textline",a:"Iz = yU . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",h:[{type:"node_in",name:"IA",qualifier:["float"],c:!1},{type:"node_in",name:"IB",qualifier:["float"],c:!1},{type:"node_in",name:"IC",qualifier:["float"],c:!1},{type:"node_out",name:"ID",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ID = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( IA - IC ) * IB ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",h:[{type:"node_in",name:"IE",qualifier:["vec3"],
c:!1},{type:"node_in",name:"IF",qualifier:["float"],c:!1},{type:"node_out",name:"IG",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"IG = IE ; if ( IG . x > ZERO_VALUE_NODES ) IG . x = pow ( IE . x , IF ) ; if ( IG . y > ZERO_VALUE_NODES ) IG . y = pow ( IE . y , IF ) ; if ( IG . z > ZERO_VALUE_NODES ) IG . z = pow ( IE . z , IF ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",h:[{type:"node_in",name:"IH",qualifier:["vec3"],c:!1},{type:"node_out",name:"II",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"II = max ( vec3 ( ZERO_VALUE_NODES ) , IH ) ; II = pow ( II , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",h:[{type:"node_in",name:"IJ",qualifier:["vec3"],c:!1},{type:"node_out",name:"IK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"IK = max ( vec3 ( ZERO_VALUE_NODES ) , IJ ) ; IK = pow ( IK , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",h:[{type:"node_out",name:"IL",qualifier:["vec3"],c:!1},{type:"node_out",name:"IM",qualifier:["vec3"],
c:!1},{type:"node_out",name:"IN",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IL"],f:[{type:"textline",a:"IL [ 2 ] = IL [ 1 ] = IL [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IM"],f:[{type:"textline",a:"IM [ 2 ] = IM [ 1 ] = IM [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IN"],f:[{type:"textline",a:["IN","=","ZERO_VALUE_NODES",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",
h:[{type:"node_in",name:"IO",qualifier:["vec3"],c:!1},{type:"node_out",name:"IP",qualifier:["vec3"],c:!0},{type:"node_out",name:"IQ",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"],c:!1}],f:[{type:"textline",a:"yU = vec3 ( IO . x , IO . z , - IO . y ) ; yN = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , yU ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IP"],f:[{type:"textline",a:"IP = yN . xyz ; br ( IP ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IQ"],f:[{type:"textline",a:"IQ = yN . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",h:[{type:"node_in",name:"IR",qualifier:["vec3"],c:!0},{type:"node_in",name:"IS",qualifier:["vec3"],c:!0},{type:"node_in",name:"IT",qualifier:["vec3"],c:!0},{type:"node_in",name:"IU",qualifier:["vec3"],c:!0},{type:"node_out",name:"IV",qualifier:["vec3"],c:!0},{type:"node_out",name:"IW",qualifier:["float"],c:!0},{type:"node_out",name:"IX",qualifier:["vec3"],
c:!0},{type:"node_out",name:"IY",qualifier:["float"],c:!0},{type:"node_out",name:"IZ",qualifier:["vec3"],c:!0},{type:"node_out",name:"I_",qualifier:["float"],c:!0},{type:"node_out",name:"Ja",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jb",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_COLOR_var_texture , yg ( IR ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_IV"],f:[{type:"textline",a:"IV = yN . xyz ; br ( IV ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IW"],f:[{type:"textline",a:"IW = yN . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_COLOR_var_texture , yg ( IS ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IX"],f:[{type:"textline",a:"IX = yN . xyz ; br ( IX ) ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_IY"],f:[{type:"textline",a:"IY = yN . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_COLOR_var_texture , yg ( IT ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IZ"],f:[{type:"textline",a:"IZ = yN . xyz ; br ( IZ ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_I_"],f:[{type:"textline",a:"I_ = yN . w ;".split(" ")}]}]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_COLOR_var_texture , yg ( IU ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ja"],f:[{type:"textline",a:"Ja = yN . xyz ; br ( Ja ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jb"],f:[{type:"textline",a:"Jb = yN . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",h:[{type:"node_in",name:"Jc",qualifier:["vec3"],c:!0},{type:"node_in",name:"Jd",qualifier:["vec3"],
c:!0},{type:"node_in",name:"Je",qualifier:["vec3"],c:!0},{type:"node_in",name:"Jf",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jg",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jh",qualifier:["float"],c:!0},{type:"node_out",name:"Ji",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jj",qualifier:["float"],c:!0},{type:"node_out",name:"Jk",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jl",qualifier:["float"],c:!0},{type:"node_out",name:"Jm",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jn",
qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_NORMAL_var_texture , yg ( Jc ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jg"],f:[{type:"textline",a:"Jg = normalize ( yO * ( yN . xyz - xU ) ) ;".split(" ")},{type:"textline",a:"Jg . yz = vec2 ( - Jg . z , Jg . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jh"],f:[{type:"textline",
a:"Jh = yN . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_NORMAL_var_texture , yg ( Jd ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ji"],f:[{type:"textline",a:"Ji = normalize ( yO * ( yN . xyz - xU ) ) ;".split(" ")},{type:"textline",a:"Ji . yz = vec2 ( - Ji . z , Ji . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jj"],f:[{type:"textline",a:"Jj = yN . w ;".split(" ")}]}]}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_NORMAL_var_texture , yg ( Je ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jk"],f:[{type:"textline",a:"Jk = normalize ( yO * ( yN . xyz - xU ) ) ;".split(" ")},{type:"textline",a:"Jk . yz = vec2 ( - Jk . z , Jk . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jl"],f:[{type:"textline",a:"Jl = yN . w ;".split(" ")}]}]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_NORMAL_var_texture , yg ( Jf ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jm"],f:[{type:"textline",a:"Jm = normalize ( yO * ( yN . xyz - xU ) ) ;".split(" ")},{type:"textline",a:"Jm . yz = vec2 ( - Jm . z , Jm . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jn"],f:[{type:"textline",a:"Jn = yN . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",h:[{type:"node_out",
name:"Jo",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Jo = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",h:[{type:"node_in",name:"Jp",qualifier:["vec3"],c:!1},{type:"node_in",name:"Jq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jr",qualifier:["vec3"],c:!1},{type:"node_out",name:"Js",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jr = Jp + Jq ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Js"],f:[{type:"textline",a:"Js = ( abs ( Jr [ 0 ] ) + abs ( Jr [ 1 ] ) + abs ( Jr [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_SUBTRACT",h:[{type:"node_in",name:"Jt",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ju",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jv",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jw",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jv = Jt - Ju ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jw"],f:[{type:"textline",a:"Jw = ( abs ( Jv [ 0 ] ) + abs ( Jv [ 1 ] ) + abs ( Jv [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",
h:[{type:"node_in",name:"Jx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Jy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jz",qualifier:["vec3"],c:!1},{type:"node_out",name:"JA",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jz = Jx + Jy ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JA"],f:[{type:"textline",a:"JA = length ( Jz ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jz"],f:[{type:"textline",a:"Jz = normalize ( Jz ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",h:[{type:"node_in",name:"JB",qualifier:["vec3"],c:!1},{type:"node_in",name:"JC",qualifier:["vec3"],c:!1},{type:"node_out",name:"JD",qualifier:["vec3"],c:!1},{type:"node_out",name:"JE",qualifier:["float"],c:!0}],f:[{type:"textline",a:"JD = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JE"],f:[{type:"textline",a:"JE = dot ( JB , JC ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",h:[{type:"node_in",
name:"JF",qualifier:["vec3"],c:!1},{type:"node_in",name:"JG",qualifier:["vec3"],c:!1},{type:"node_out",name:"JH",qualifier:["vec3"],c:!1},{type:"node_out",name:"JI",qualifier:["float"],c:!0}],f:[{type:"textline",a:"JH = cross ( JF , JG ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JI"],f:[{type:"textline",a:"JI = length ( JH ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",h:[{type:"node_in",name:"JJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"JK",qualifier:["vec3"],
c:!1},{type:"node_out",name:"JL",qualifier:["vec3"],c:!1},{type:"node_out",name:"JM",qualifier:["float"],c:!0}],f:[{type:"textline",a:"JL = normalize ( JJ ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JM"],f:[{type:"textline",a:"JM = length ( JJ ) ;".split(" ")}]}]},{type:"textline",a:["JK",";"]}]},{type:"node",name:"B4W_REFLECT",h:[{type:"node_in",name:"JN",qualifier:["vec3"],c:!1},{type:"node_in",name:"JO",qualifier:["vec3"],c:!1},{type:"node_out",name:"JP",qualifier:["vec3"],
c:!1}],f:[{type:"textline",a:"JP = reflect ( ( yt * vec4 ( JN , 0.0 ) ) . xyz , JO ) ;".split(" ")}]},{type:"node",name:"B4W_REFLECT_WORLD",h:[{type:"node_in",name:"JQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"JR",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yU = vec3 ( - yq . x , yq . z , - yq . y ) ; JR = reflect ( yU , JQ ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",h:[{type:"node_in",name:"JS",qualifier:["vec3"],c:!1},{type:"node_in",name:"JT",qualifier:["float"],c:!1},{type:"node_in",
name:"JU",qualifier:["const","float"],c:!1},{type:"node_in",name:"JV",qualifier:["const","float"],c:!1},{type:"node_out",name:"JW",qualifier:["vec3"],c:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yG = length ( yM ) ; if ( yG < JV ) { yB = yg ( JS ) ; yG = clamp ( xU * ( JV - yG ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = JT * yG ;".split(" ")},{type:"textline",a:"yU = normalize ( yq * yO ) ;".split(" ")},{type:"textline",
a:"yH = UNITY_VALUE_NODES / JU ;".split(" ")},{type:"textline",a:"yC = yU . xy * yG / ( JU * yU . z ) ; yG = UNITY_VALUE_NODES ; yF = texture2D ( node_B4W_PARALLAX_var_texture , yB ) . a ;".split(" ")},{type:"textline",a:"for ( float JX = 1.0 ; JX <= JU ; JX ++ ) { if ( yF < yG ) { yG -= yH ; yB -= yC ; yF = texture2D ( node_B4W_PARALLAX_var_texture , yB ) . a ; } }".split(" ")},{type:"textline",a:"yC = yB + yC ; yH = texture2D ( node_B4W_PARALLAX_var_texture , yC ) . a - ( yG + yH ) ; yG = yF - yG ; yH = yG / ( yG - yH ) ;".split(" ")},
{type:"textline",a:"yB = yH * yC + ( UNITY_VALUE_NODES - yH ) * yB ; JW = ye ( yB ) ; } else JW = JS ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",h:[{type:"node_in",name:"JY",qualifier:["vec3"],c:!1},{type:"node_out",name:"JZ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"JZ = clamp ( JY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",h:[{type:"node_in",name:"J_",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ka",qualifier:["float"],c:!1},{type:"node_out",
name:"Kb",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Kb","=","J_",";"]}]},{type:"node",name:"B4W_TRANSLUCENCY",h:[{type:"node_in",name:"Kc",qualifier:["float"],c:!1},{type:"node_in",name:"Kd",qualifier:["float"],c:!1},{type:"node_in",name:"Ke",qualifier:["float"],c:!1},{type:"node_in",name:"Kf",qualifier:["float"],c:!1},{type:"node_in",name:"Kg",qualifier:["float"],c:!1},{type:"node_out",name:"Kh",qualifier:["float"],c:!0},{type:"node_out",name:"Ki",qualifier:["vec4"],c:!0}],f:[{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_Kh"],f:[{type:"textline",a:["Kh","=","Kc",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ki"],f:[{type:"textline",a:"Ki = vec4 ( Kd , Ke , Kf , Kg ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",h:[{type:"node_out",name:"Kj",qualifier:["float"],c:!1}],f:[{type:"textline",a:["Kj","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",h:[{type:"node_in",name:"Kk",qualifier:["float"],c:!1},{type:"node_in",name:"Kl",qualifier:["float"],c:!1},{type:"node_in",
name:"Km",qualifier:["float"],c:!1},{type:"node_out",name:"Kn",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Kn = smoothstep ( Kl , Km , Kk ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",h:[{type:"node_in",name:"Ko",qualifier:["vec3"],c:!1},{type:"node_in",name:"Kp",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yw = Ko ; yA = Kp ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",h:[{type:"node_in",name:"Kq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Kr",qualifier:["float"],c:!1}],
f:[{type:"textline",a:"Kr = ( Kq . r + Kq . g + Kq . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",h:[{type:"node_in",name:"Ks",qualifier:["float"],c:!1},{type:"node_out",name:"Kt",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Kt [ 0 ] = Ks ; Kt [ 1 ] = Ks ; Kt [ 2 ] = Ks ;".split(" ")}]},{type:"nodes_global"},{type:"textline",a:"void Ku ( in vec3 yq , in mat4 yr , in mat4 ys , in mat4 yt , in mat4 yu , in mat4 yv , out vec3 yw , out vec3 yx , out vec3 yy , out vec4 yz , out float yA ) { vec2 yB , yC ; float yD , yE , yF , yG , yH , yI , yJ , yK , yL ; vec4 yM , yN ; mat3 yO ; vec3 yP , yQ , yR , yS , yT , yU ; yw = vec3 ( ZERO_VALUE_NODES ) ; yx = vec3 ( ZERO_VALUE_NODES ) ; yy = vec3 ( ZERO_VALUE_NODES ) ; yz = vec4 ( ZERO_VALUE_NODES ) ; yA = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"yP = normalize ( bE ) ; yQ = yP ;".split(" ")},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!",
"gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"yQ = yQ ; else yQ = - yQ ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"textline",a:["yR","=","yQ",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["yR","=","yP",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_NO"],group:{type:"group",b:[{type:"textline",a:["yP","=",
"yQ",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"yS = cross ( yQ , bF . xyz ) * bF . w ; yO = mat3 ( bF . xyz , yS , yQ ) ; yO = yO ;".split(" ")}]}}]},{type:"textline",a:"yQ = bC ; yM = bD ; yD = u_emit ; yE = u_ambient ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/particles.glslv"]={type:"group",b:[{type:"var",name:"EPSILON",a:["0.0001"]},{type:"textline",a:"struct Kw { float a ; vec3 b ; float c ; vec3 d ; float e ; vec3 f ; vec3 g ; float h ; } ;".split(" ")},
{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void KC ( inout vec3 Kx , float Ky , vec4 Kz , vec4 KA ) { float KB ; KB = KA . x - Kz . x ; KB = ( Ky - Kz . x ) / KB ; Kx = mix ( Kx , KA . yzw , clamp ( KB , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec3 KI ( float KD , float KE , vec4 KF [ COLOR_RAMP_LENGTH ] ) { vec3 KG ; float KH ; KH = KD / KE ; KG = KF [ 0 ] . yzw ;".split(" ")},
{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KC ( KG , KH , KF [ 0 ] , KF [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KC ( KG , KH , KF [ 1 ] , KF [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KC ( KG , KH , KF [ 2 ] , KF [ 3 ] ) ;".split(" ")}]}}]},
{type:"textline",a:["return","KG",";","}"]}]}}]},{type:"textline",a:"float KQ ( float KJ , float KK , float KL , float KM ) { float KN , KO , KP ; KN = max ( 0.01 , min ( KK , KL ) ) ; KO = max ( 0.01 , min ( KK , KM ) ) ; KP = KK - KO ; KO = clamp ( KJ / KN , 0.0 , 1.0 ) - step ( KP , KJ ) * ( KJ - KP ) / KO ; return KO ; } Kw KY ( ) { mat4 KR ; vec3 KS , KT ; float KU , KV , KW ; Kw KX ; KV = a_p_data [ 0 ] ; KW = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { KU = mod ( u_p_time , u_p_length ) - KW ; if ( KU < 0.0 ) KU += u_p_length ; } if ( u_p_cyclic != 1 ) { KU = u_p_time - KW ; } if ( KU < 0.0 || KU >= KV ) { KX . a = 0.0001 ; KX . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( KU < 0.0 || KU >= KV ) ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["WORLD_SPACE"],group:{type:"group",b:[{type:"textline",a:"KS = a_position ; KT = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KR = O ( u_model_tsr ) ; KS = ( KR * vec4 ( a_position , 1.0 ) ) . xyz ; KT = ( KR * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",a:"KT = u_p_nfactor * KT ; KT += a_p_vels . xyz ; KT . y -= u_p_gravity * KU / 2.0 ; KV = max ( u_p_mass , EPSILON ) ; KT += ( u_p_wind_fac * u_wind / KV ) * KU / 2.0 ; KX . h = KU ; KX . f = KT ; KX . g = a_normal * a_p_vels . w ; KX . b = KS + KT * KU ; KX . e = a_p_vels . w * KU ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_COLOR_RAMP"],group:{type:"group",b:[{type:"textline",a:"KX . a = texture2D ( u_color_ramp_tex , vec2 ( KU / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KX . a = 1.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KX . d = KI ( KU , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:"KX . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"KX . c = KQ ( KU , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return KX ; }".split(" ")}]};a["include/particles_nodes.glslv"]={type:"group",b:[{type:"node",name:"TEX_COORD_UV",h:[],f:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[],f:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]},{type:"node",name:"UVMAP",h:[],f:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[],f:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",h:[{type:"node_param",name:"yi",qualifier:["varying","vec4"],c:!0},{type:"node_param",name:"yj",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"yk",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"yl",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"node_PARTICLE_INFO_var_a_p_indices",qualifier:["attribute","float"],c:!0}],f:[{type:"node_condition",
b:[{type:"node_if",d:["PART_INFO_SIZE"],f:[{type:"textline",a:"yi [ 3 ] = Lc ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_AGE"],f:[{type:"textline",a:"yi [ 1 ] = Lb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_LT"],f:[{type:"textline",a:"yi [ 2 ] = Le ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_LOC"],f:[{type:"textline",a:["yj","=","KZ",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_IND"],
f:[{type:"textline",a:"yi [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_VEL"],f:[{type:"textline",a:["yk","=","K_",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_A_VEL"],f:[{type:"textline",a:["yl","=","La",";"]}]}]}]},{type:"nodes_global"},{type:"textline",a:"void Lf ( in vec3 KZ , in vec3 K_ , in vec3 La , in float Lb , in float Lc , in vec2 Ld , in float Le ) {".split(" ")},{type:"condition",b:[{type:"if",
d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]}}]},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/blending.glslf"]={type:"group",b:[{type:"textline",a:"float Lh = 0.0 ; float Li = 1.0 ; vec3 Ln ( vec3 Lj ) { float Lk , Ll ; vec4 Lm ; Lm = vec4 ( Lh , - Li / 3.0 , 2.0 / 3.0 , - Li ) ; Lm = mix ( vec4 ( Lj . bg , Lm . wz ) , vec4 ( Lj . gb , Lm . xy ) , step ( Lj . b , Lj . g ) ) ; Lm = mix ( vec4 ( Lm . xyw , Lj . r ) , vec4 ( Lj . r , Lm . yzx ) , step ( Lm . x , Lj . r ) ) ; Lk = Lm . x - min ( Lm . w , Lm . y ) ; Ll = 1.0e-10 ; return vec3 ( abs ( Lm . z + ( Lm . w - Lm . y ) / ( 6.0 * Lk + Ll ) ) , Lk / ( Lm . x + Ll ) , Lm . x ) ; } vec3 Lr ( vec3 Lo ) { vec3 Lp ; vec4 Lq ; Lq = vec4 ( Li , 2.0 / 3.0 , Li / 3.0 , 3.0 ) ; Lp = abs ( fract ( vec3 ( Lo . r , Lo . r , Lo . r ) + Lq . xyz ) * 6.0 - Lq . www ) ; return Lo . b * mix ( Lq . xxx , clamp ( Lp - Lq . xxx , Lh , Li ) , Lo . g ) ; } vec3 Lv ( vec3 Ls , vec3 Lt , float Lu ) { return mix ( Ls , Lt , Lu ) ; } vec3 Lz ( vec3 Lw , vec3 Lx , float Ly ) { return Ly * Lw + Lx ; } vec3 LD ( vec3 LA , vec3 LB , float LC ) { return LB - LC * LA ; } vec3 LI ( vec3 LE , vec3 LF , float LG ) { float LH ; LH = Li - LG ; return ( vec3 ( LH ) + LG * LE ) * LF ; } vec3 LN ( vec3 LJ , vec3 LK , float LL ) { vec3 LM ; LM = vec3 ( Li - LL ) ; return vec3 ( Li ) - ( LM + LL * ( vec3 ( Li ) - LJ ) ) * ( vec3 ( Li ) - LK ) ; } vec3 LS ( vec3 LO , vec3 LP , float LQ ) { vec3 LR ; LR = vec3 ( Li - LQ ) ; return mix ( LP * ( LR + 2.0 * LQ * LO ) , vec3 ( Li ) - ( LR + 2.0 * LQ * ( vec3 ( Li ) - LO ) ) * ( vec3 ( Li ) - LP ) , step ( 0.5 , LP ) ) ; } vec3 LW ( vec3 LT , vec3 LU , float LV ) { return mix ( LU , abs ( LT - LU ) , LV ) ; } vec3 L_ ( vec3 LX , vec3 LY , float LZ ) { return mix ( LY , LY / ( LX + step ( LX , vec3 ( Lh ) ) ) , LZ ) ; } vec3 Md ( vec3 Ma , vec3 Mb , float Mc ) { return mix ( Mb , min ( Ma , Mb ) , Mc ) ; } vec3 Mh ( vec3 Me , vec3 Mf , float Mg ) { return max ( Mg * Me , Mf ) ; } vec3 Mn ( vec3 Mi , vec3 Mj , float Mk ) { vec3 Ml , Mm ; Ml = Ln ( Mj ) ; if ( Ml . y != Lh ) { Mm = Ln ( Mi ) ; Mm = Lr ( vec3 ( Ml . x , Mm . yz ) ) ; return mix ( Mi , Mm , Mk ) ; } return Mi ; } vec3 Mt ( vec3 Mo , vec3 Mp , float Mq ) { vec3 Mr , Ms ; Mr = Ln ( Mo ) ; if ( Mr . y != Lh ) { Ms = Ln ( Mp ) ; return Lr ( vec3 ( Mr . x , mix ( Mr . y , Ms . y , Mq ) , Mr . z ) ) ; } return Mo ; } vec3 Mz ( vec3 Mu , vec3 Mv , float Mw ) { vec3 Mx , My ; Mx = Ln ( Mu ) ; My = Ln ( Mv ) ; return Lr ( vec3 ( Mx . xy , mix ( Mx . z , My . z , Mw ) ) ) ; } vec3 MF ( vec3 MA , vec3 MB , float MC ) { vec3 MD , ME ; MD = Ln ( MB ) ; if ( MD . y != Lh ) { ME = Ln ( MA ) ; ME = Lr ( vec3 ( MD . xy , ME . z ) ) ; return mix ( MA , ME , MC ) ; } return MA ; } vec3 MK ( vec3 MG , vec3 MH , float MI ) { vec3 MJ ; MJ = vec3 ( Li ) - ( vec3 ( Li ) - MH ) * ( vec3 ( Li ) - MG ) ; return mix ( MG , ( ( vec3 ( Li ) - MG ) * MH * MG ) + MG * MJ , MI ) ; } vec3 MO ( vec3 ML , vec3 MM , float MN ) { return ML + MN * ( 2.0 * MM - Li ) ; } float MU ( float MP , float MQ , float MR , float MS ) { float MT ; MT = Li - MS ; return ( MT + MR * MP ) * MQ ; } float M_ ( float MV , float MW , float MX , float MY ) { float MZ ; MZ = Li - MY ; return Li - ( MZ + MX * ( Li - MV ) ) * ( Li - MW ) ; } float Nf ( float Na , float Nb , float Nc , float Nd ) { float Ne ; Ne = Li - Nd ; return mix ( Nb * ( Ne + 2.0 * Nc * Na ) , Li - ( Ne + 2.0 * Nc * ( Li - Na ) ) * ( Li - Nb ) , step ( 0.5 , Nb ) ) ; }".split(" ")}]};
a["include/fxaa.glslf"]={type:"group",b:[{type:"condition",b:[{type:"ifndef",name:"FXAA_PS3",group:{type:"group",b:[{type:"define",name:"FXAA_PS3",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_360",group:{type:"group",b:[{type:"define",name:"FXAA_360",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_360_OPT",group:{type:"group",b:[{type:"define",name:"FXAA_360_OPT",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_PC",group:{type:"group",b:[{type:"define",name:"FXAA_PC",
a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_PC_CONSOLE",group:{type:"group",b:[{type:"define",name:"FXAA_PC_CONSOLE",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GLSL_120",group:{type:"group",b:[{type:"define",name:"FXAA_GLSL_120",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GLSL_130",group:{type:"group",b:[{type:"define",name:"FXAA_GLSL_130",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_3",group:{type:"group",b:[{type:"define",
name:"FXAA_HLSL_3",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_4",group:{type:"group",b:[{type:"define",name:"FXAA_HLSL_4",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_5",group:{type:"group",b:[{type:"define",name:"FXAA_HLSL_5",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GREEN_AS_LUMA",group:{type:"group",b:[{type:"define",name:"FXAA_GREEN_AS_LUMA",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_EARLY_EXIT",group:{type:"group",
b:[{type:"define",name:"FXAA_EARLY_EXIT",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_DISCARD",group:{type:"group",b:[{type:"define",name:"FXAA_DISCARD",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_FAST_PIXEL_OFFSET",group:{type:"group",b:[{type:"condition",b:[{type:"ifdef",name:"GL_EXT_gpu_shader4",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_NV_gpu_shader5",group:{type:"group",b:[{type:"define",
name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_ARB_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_FAST_PIXEL_OFFSET",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["0"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GATHER4_ALPHA",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["FXAA_HLSL_5",1,{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_ARB_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_NV_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GATHER4_ALPHA",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["0"]}]}}]}]}}]},{type:"condition",
b:[{type:"ifndef",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:[0],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["4.0"]}]}}]},{type:"condition",b:[{type:"if",d:[0],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["2.0"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",
name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",a:["0.125"]}]}},{type:"else",group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",a:["0.25"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_QUALITY_PRESET",group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["12"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
10,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["3"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P1",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",11,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["4"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},
{type:"define",name:"FXAA_QUALITY_P2",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",12,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["5"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["12.0"]}]}}]},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",13,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["6"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
14,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["7"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
15,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["8"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["12.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",20,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["3"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P1",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",21,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["4"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",
name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",22,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["5"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",
name:"FXAA_QUALITY_P4",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",23,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["6"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["8.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",24,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["7"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["8.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",25,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["8"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P7",
a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",26,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["9"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",
a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",27,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["10"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",
a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",28,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["11"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",
a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
29,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["12"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",
name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P11",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",39,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["12"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["1.0"]},{type:"define",
name:"FXAA_QUALITY_P3",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P11",a:["8.0"]}]}}]},{type:"var",name:"FXAA_QUALITY_P12",a:["0.0"]},{type:"textline",a:"float NB ( float NA ) { return clamp ( NA , 0.0 , 1.0 ) ; }".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_BLEND4WEB",1,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 NE ( sampler2D NC , vec2 ND ) { return texture2D ( NC , ND ) ; } vec4 NJ ( sampler2D NF , vec2 NG , vec2 NH , vec2 NI ) { return texture2D ( NF , NG + ( NH * NI ) ) ; }".split(" ")}]}}]},{type:"textline",a:"vec4 Op ( vec2 NK , sampler2D NL , vec2 NM , float NN , float NO , float NP ) { bool NQ , NR , NS , NT , NU ; float NV , NW , NX , NY , NZ , N_ , Oa , Ob , Oc , Od , Oe , Of , Og , Oh , Oi ; vec4 Oj ; vec2 Ok , Ol , Om , On , Oo ; Ok . x = NK . x ; Ok . y = NK . y ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_GATHER4_ALPHA",1,{type:"equal_expr",e:2}],group:{type:"group",b:[]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Oj = NE ( NL , Ok ) ; NV = bB ( Oj ) ; NW = bB ( NJ ( NL , Ok , vec2 ( 0 , 1 ) , NM . xy ) ) ; NX = bB ( NJ ( NL , Ok , vec2 ( 1 , 0 ) , NM . xy ) ) ; NY = bB ( NJ ( NL , Ok , vec2 ( 0 , - 1 ) , NM . xy ) ) ; NZ = bB ( NJ ( NL , Ok , vec2 ( - 1 , 0 ) , NM . xy ) ) ;".split(" ")}]}}]},{type:"textline",a:"N_ = max ( NW , NV ) ; Oa = min ( NW , NV ) ; N_ = max ( NX , N_ ) ; Oa = min ( NX , Oa ) ; Ob = max ( NY , NZ ) ; Oc = min ( NY , NZ ) ; N_ = max ( Ob , N_ ) ; Oa = min ( Oc , Oa ) ; Oc = N_ * NO ; Oa = N_ - Oa ; Oc = max ( NP , Oc ) ; NQ = Oa < Oc ; if ( NQ ) return Oj ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_GATHER4_ALPHA",0,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Oc = bB ( NJ ( NL , Ok , vec2 ( - 1 , - 1 ) , NM . xy ) ) ; N_ = bB ( NJ ( NL , Ok , vec2 ( 1 , 1 ) , NM . xy ) ) ; Ob = bB ( NJ ( NL , Ok , vec2 ( 1 , - 1 ) , NM . xy ) ) ; Od = bB ( NJ ( NL , Ok , vec2 ( - 1 , 1 ) , NM . xy ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[]}}]},{type:"textline",a:"Oe = NY + NW ; Of = NZ + NX ; Oa = 1.0 / Oa ; Og = Oe + Of ; Oe = ( - 2.0 * NV ) + Oe ; Of = ( - 2.0 * NV ) + Of ; Oh = Ob + N_ ; Ob = Oc + Ob ; Oi = ( - 2.0 * NX ) + Oh ; Ob = ( - 2.0 * NY ) + Ob ; Oc = Oc + Od ; N_ = Od + N_ ; Oi = ( abs ( Oe ) * 2.0 ) + abs ( Oi ) ; Ob = ( abs ( Of ) * 2.0 ) + abs ( Ob ) ; Of = ( - 2.0 * NZ ) + Oc ; N_ = ( - 2.0 * NW ) + N_ ; Oi = abs ( Of ) + Oi ; Ob = abs ( N_ ) + Ob ; Oh = Oc + Oh ; Oc = NM . x ; NQ = Oi >= Ob ; Oh = Og * 2.0 + Oh ; if ( ! NQ ) NY = NZ ; if ( ! NQ ) NW = NX ; if ( NQ ) Oc = NM . y ; Oh = ( Oh * ( 1.0 / 12.0 ) ) - NV ; NX = NY - NV ; NZ = NW - NV ; NY = NY + NV ; NW = NW + NV ; NR = abs ( NX ) >= abs ( NZ ) ; NZ = max ( abs ( NX ) , abs ( NZ ) ) ; if ( NR ) Oc = - Oc ; Oa = NB ( abs ( Oh ) * Oa ) ; Ol . x = Ok . x ; Ol . y = Ok . y ; Om . x = ( ! NQ ) ? 0.0 : NM . x ; Om . y = ( NQ ) ? 0.0 : NM . y ; if ( ! NQ ) Ol . x += Oc * 0.5 ; if ( NQ ) Ol . y += Oc * 0.5 ; On . x = Ol . x - Om . x * FXAA_QUALITY_P0 ; On . y = Ol . y - Om . y * FXAA_QUALITY_P0 ; Oo . x = Ol . x + Om . x * FXAA_QUALITY_P0 ; Oo . y = Ol . y + Om . y * FXAA_QUALITY_P0 ; Oh = ( ( - 2.0 ) * Oa ) + 3.0 ; NX = bB ( NE ( NL , On ) ) ; Oa = Oa * Oa ; Og = bB ( NE ( NL , Oo ) ) ; if ( ! NR ) NY = NW ; NZ = NZ * 1.0 / 4.0 ; NW = NV - NY * 0.5 ; Oa = Oh * Oa ; NR = NW < 0.0 ; NX -= NY * 0.5 ; Og -= NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P1 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P1 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P1 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P1 ; if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P2 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P2 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P2 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P2 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P3 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P3 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P3 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P3 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",4,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P4 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P4 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P4 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P4 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",5,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P5 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P5 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P5 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P5 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",6,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P6 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P6 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P6 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P6 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",7,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P7 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P7 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P7 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P7 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",8,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P8 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P8 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P8 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P8 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",9,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P9 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P9 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P9 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P9 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",10,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P10 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P10 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P10 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P10 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",11,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P11 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P11 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P11 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P11 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",12,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P12 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P12 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P12 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:"} NZ = Ok . x - On . x ; NY = Oo . x - Ok . x ; if ( ! NQ ) NZ = Ok . y - On . y ; if ( ! NQ ) NY = Oo . y - Ok . y ; NT = ( NX < 0.0 ) != NR ; NX = ( NY + NZ ) ; NR = ( Og < 0.0 ) != NR ; NX = 1.0 / NX ; NS = NZ < NY ; NY = min ( NZ , NY ) ; NR = NS ? NT : NR ; Oa = Oa * Oa ; NX = ( NY * ( - NX ) ) + 0.5 ; Oa = Oa * NN ; NX = NR ? NX : 0.0 ; Oa = max ( NX , Oa ) ; if ( ! NQ ) Ok . x += Oa * Oc ; if ( NQ ) Ok . y += Oa * Oc ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_DISCARD",1,{type:"equal_expr",e:2},"FXAA_BLEND4WEB",1,{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return NE ( NL , Ok ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec4 ( NE ( NL , Ok ) . xyz , NV ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["include/depth_fetch.glslf"]={type:"group",b:[{type:"textline",a:"float Ow ( in sampler2D Oq , in vec2 Or , in vec2 Os ) { float Ot , Ou , Ov ; Ot = texture2D ( Oq , Or ) . r ; Ou = Os . x ; Ov = Os . y ; Ou = 2.0 * Ou / ( Ou + Ov - ( 2.0 * Ot - 1.0 ) * ( Ov - Ou ) ) ; return Ou ; }".split(" ")}]}};b4w.module.__data=function(a,n){function k(a,c){na[c.id]=null;Lb[c.id]=null}function b(a,c,b){var d;a instanceof ArrayBuffer&&(a=ea.ZD(a));d=a.width;a=a.height;O.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),c);-1==c.indexOf(qa)&&b&&O.warn("image",c,"is not from app root.")}function e(a,c,b,d,e,f){(d=c.bg)||Ba.l("Nothing requested");da.cd([{id:d,type:da.pk,url:d}],function(d,f,h,g){if(d){O.log("%cLOAD METADATA","color: #616",g);f=Ba.pH(d.b4w_format_version);
switch(Ba.mI(f,Ja.Ij)){case -1:f[0]<Ja.Ij[0]?Ba.l("JSON version is too old relative to B4W engine: "+Ba.Gi(f)+", required: "+Ba.Gi(Ja.Ij)+". Reexport scene with the latest B4W addon to fix it."):O.warn("JSON version is a bit old relative to B4W engine: "+ +Ba.Gi(f)+", required: "+Ba.Gi(Ja.Ij)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>Ja.Ij[0]?Ba.l("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
O.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Ja.lx=f;for(var m in d)a[m]=d[m];c.gb&&(Ga=pa.Qq(a.scenes));(d=a.binaries[0].binfile)?c.mB=d:(ca.Os(c,"load_binaries"),ca.Os(c,"prepare_bindata"));Ja.zf||ca.Os(c,"mobile_media_start");Ja.antialiasing&&Ja.smaa||ca.Os(c,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)m=a.b4w_export_errors[d],(c.gb&&"PRIMARY"==m.type||"ALL"==m.type)&&
O.VN(m.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)m=a.b4w_export_warnings[d],(c.gb&&"PRIMARY"==m.type||"ALL"==m.type)&&O.WN(m.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");e(c,b)}else ca.PA(c)},null,function(a){f(c,b,a)})}function y(a,c,b,d,e,f){(d=Y(c.bg)+c.mB)||Ba.l("Binary data is missing");da.cd([{id:d,type:da.lp,url:d}],function(d,
f,h,g){d?(O.log("%cLOAD BINARY","color: #616",g),a.bin_data=d,d=w(d),f=Ba.pH(a.b4w_format_version),d[0]!=f[0]&&Ba.l("BIN version does not match to JSON version: "+Ba.Gi(d)+", required: "+Ba.Gi(Ja.Ij)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&O.warn("BIN version does not match to JSON version: "+ +Ba.Gi(d)+", required: "+Ba.Gi(Ja.Ij)+". Some compatibility issues can occur. Reexport scene to fix it."),e(c,b)):ca.PA(c)},null,function(a){f(c,b,a)})}function g(a,c,b,d,e){ua.lM()&&
e(c,b)}function B(a,c,b,d,e){d=a.bin_data;var f=a.binaries[0],h=a.objects,g=a.meshes;a=a.actions;for(var m=Ba.eM(),l=w(d),l=5<=l[0]&&4<l[1]?12:0,k=["indices"],p=["normal","tangent"],v=["color","group"],r=["position","texcoord","texcoord2"],q=0;q<g.length;q++)for(var n=g[q].submeshes,u=0;u<n.length;u++)for(var A in n[u]){var x=n[u][A][1];if(-1!=k.indexOf(A)){var z=4*n[u][A][0]+f["int"]+l,B=n[u],y=A,Y=d;if(m)var D=new Uint32Array(Y,z,x);else for(var D=new Uint32Array(x),Y=new DataView(Y),K=0;K<x;K++)D[K]=
Y.getUint32(z+4*K,!0);B[y]=D}else if(-1!=r.indexOf(A))z=4*n[u][A][0]+f["float"]+l,n[u][A]=t(d,z,x,m);else if(-1!=p.indexOf(A)){z=2*n[u][A][0]+f["short"]+l;B=n[u];y=A;Y=d;D=new Float32Array(x);Y=new DataView(Y);for(K=0;K<x;K++)D[K]=Y.getInt16(z+2*K,!0)/32767;B[y]=D}else if(-1!=v.indexOf(A)){z=2*n[u][A][0]+f.ushort+l;B=n[u];y=A;Y=d;D=new Float32Array(x);Y=new DataView(Y);for(K=0;K<x;K++)D[K]=Y.getUint16(z+2*K,!0)/65535;B[y]=D}}for(A=0;A<h.length;A++)for(g=h[A].particle_systems,k=0;k<g.length;k++)p=
g[k],p.transforms=t(d,4*p.transforms[0]+f["float"]+l,p.transforms[1],m);for(h=0;h<a.length;h++){A=a[h];g=A.fcurves;k=A.frame_range;v=k[0];r=k[1];q=la.IO(v,r);k=null;0>q&&(q=0);var u=n=!1,H;for(H in g)n|=-1<H.indexOf("rotation_euler"),u|=-1<H.indexOf("rotation_quaternion");p=[];for(H in g)if(n&&u&&-1<H.indexOf("rotation_euler"))delete g[H];else{var x=g[H],C;for(C in x)z=x[C],B=t(d,f["float"]+4*z.bin_data_pos[0]+l,z.bin_data_pos[1],m),y=new Float32Array(q),null===k&&(k=new Int8Array(q)),la.hL(z,B,y,
k,v,r),z.Yd=y;-1<H.indexOf("rotation_euler")&&(la.cO(g[H]),p.push(H))}for(v=0;v<p.length;v++)r=p[v],q=r.replace("euler","quaternion"),g[q]=g[r],delete g[r];A.yK=k}e(c,b)}function w(a){var c=new Uint8Array(a,0,4),b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];for(var d=0;d<c.length;d++)if("B4WB"[d]!=String.fromCharCode(c[d])){b=5;a=4;break}return[b,a]}function t(a,c,b,d){if(d)d=new Float32Array(a,c,b);else{d=new Float32Array(b);a=new DataView(a);for(var e=0;e<b;e++)d[e]=a.getFloat32(c+
4*e,!0)}return d}function f(a,c,b,d,e){var f=a.cameras,h=a.groups,g=a.materials,m=a.meshes,l=a.node_groups,k=a.objects,p=a.particles,v=a.scenes,q=a.speakers,n=a.lamps,t=a.textures,u=a.worlds;l||(O.warn('"node_groups" datablock undefined. reexport main scene.'),l=a.node_groups=[]);for(var w="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),x={},B=0;B<w.length;B++)for(var Y=a[w[B]],y=0;y<Y.length;y++){var D=
Y[y];x[D.uuid]=D}for(var C=0;C<v.length;C++){for(var P=v[C],Q=P.objects,G=0;G<Q.length;G++)K(Q,G,x);P.camera&&K(P,"camera",x);P.world&&K(P,"world",x)}for(C=0;C<h.length;C++)for(var E=h[C].objects,G=0;G<E.length;G++)K(E,G,x);for(C=0;C<k.length;C++){var R=k[C];R.dupli_group&&K(R,"dupli_group",x);R.parent&&K(R,"parent",x);R.dg_parent&&K(R,"dg_parent",x);if(R.animation_data){var F=R.animation_data;F.action&&K(F,"action",x);if(F.nla_tracks)for(G=0;G<F.nla_tracks.length;G++)for(var L=F.nla_tracks[G],I=
0;I<L.strips.length;I++)L.strips[I].action&&K(L.strips[I],"action",x)}switch(R.type){case "MESH":R.data||Ba.l("mesh not found for object "+R.name);K(R,"data",x);for(var M=!1,V=R.modifiers,G=0;G<V.length;G++){var N=V[G];"ARMATURE"==N.type?(M&&O.warn('Object "'+R.name+'" has more than one armature modifiers. Only the first one will be used.'),M=!0,K(N,"object",x)):"CURVE"==N.type&&K(N,"object",x)}var J=R.particle_systems;if(J)for(G=0;G<J.length;G++)K(J[G],"settings",x);break;case "ARMATURE":K(R,"data",
x);for(var ia=R.pose.bones,ha=R.data.bones,G=0;G<ia.length;G++){var W=ia[G];W.bone=ha[W.bone];var S=W.constraints;if(S)for(I=0;I<S.length;I++){var X=S[I];X.target&&K(X,"target",x)}for(var Z=W.parent_recursive,I=0;I<Z.length;I++)Z[I]=ia[Z[I]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":K(R,"data",x)}if(S=R.constraints)for(G=0;G<S.length;G++)X=S[G],X.target&&K(X,"target",x);var da=R.lod_levels;if(da)for(G=0;G<da.length;G++){var U=da[G];U.object&&K(U,"object",x)}}for(C=0;C<m.length;C++)for(var ka=
m[C].materials,G=0;G<ka.length;G++)K(ka,G,x);for(C=0;C<g.length;C++){for(var ja=g[C],aa=ja.texture_slots,G=0;G<aa.length;G++)K(aa[G],"texture",x);var ba=ja.node_tree;ba&&H(ba,x)}for(C=0;C<l.length;C++)(ba=l[C].node_tree)&&H(ba,x);for(C=0;C<t.length;C++){var ca=t[C],ea=ca.type;"IMAGE"!=ea&&"ENVIRONMENT_MAP"!=ea||K(ca,"image",x)}for(C=0;C<f.length;C++){var fa=f[C];fa.dof_object&&K(fa,"dof_object",x)}for(C=0;C<q.length;C++){var oa=q[C];oa.sound&&K(oa,"sound",x);if(oa.animation_data&&(F=oa.animation_data,
F.action&&K(F,"action",x),F.nla_tracks))for(G=0;G<F.nla_tracks.length;G++)for(L=F.nla_tracks[G],I=0;I<L.strips.length;I++)L.strips[I].action&&K(L.strips[I],"action",x)}for(C=0;C<p.length;C++){for(var Ca=p[C],aa=Ca.texture_slots,G=0;G<aa.length;G++)K(aa[G],"texture",x);Ca.dupli_group&&K(Ca,"dupli_group",x);Ca.dupli_object&&K(Ca,"dupli_object",x)}for(C=0;C<n.length;C++){var ma=n[C];if(ma.animation_data&&(F=ma.animation_data,F.action&&K(F,"action",x),F.nla_tracks))for(G=0;G<F.nla_tracks.length;G++)for(L=
F.nla_tracks[G],I=0;I<L.strips.length;I++)L.strips[I].action&&K(L.strips[I],"action",x)}for(C=0;C<u.length;C++){var na=u[C];if(aa=na.texture_slots)for(G=0;G<aa.length;G++)K(aa[G],"texture",x);if(na.animation_data&&(F=na.animation_data,F.action&&K(F,"action",x),F.nla_tracks))for(G=0;G<F.nla_tracks.length;G++)for(L=F.nla_tracks[G],I=0;I<L.strips.length;I++)L.strips[I].action&&K(L.strips[I],"action",x)}ya.$L(a);for(var ra=a.textures,Aa=c.gb?a.scenes[0].b4w_anisotropic_filtering:Ga.b4w_anisotropic_filtering,
qa=0;qa<ra.length;qa++)c.gb||"SCENE"!=ra[qa].b4w_source_type||(ra[qa].b4w_source_id=""),Fa.hN(ra[qa],Aa,a.scenes,c.id);for(var sa={},ua=a.objects,ta=0;ta<ua.length;ta++){var za=ua[ta];if("MESH"===za.type&&!za.particle_systems.length)for(var wa=za.data,Da=wa.name,Ha=wa.submeshes,Ka=wa.materials,Ja=0;Ja<Ha.length;Ja++)0!==Ha[Ja].base_length||sa[Da]||(Ka[Ja]&&O.warn('material "'+Ka[Ja].name+'" is not assigned to any face (object "'+za.name+'").'),sa[Da]=!0)}for(var Ma=a.meshes,La=0;La<Ma.length;La++){var Oa=
Ma[La];Oa.materials.length||Oa.uv_textures.length&&O.warn('mesh "'+Oa.name+'" has a UV map but has no exported material.')}a.materials.push(ya.SM());for(var ab=a.meshes,jb=Ba.Lc("name","DEFAULT",a.materials),Wa=0;Wa<ab.length;Wa++){var fb=ab[Wa];0==fb.materials.length&&fb.materials.push(jb)}for(var va=a.actions,lb=c.id,Ya=0;Ya<va.length;Ya++){var Ob=va[Ya];Ob.zK=lb;la.HK(Ob)}for(var Qa=a.scenes,kb=0;kb<Qa.length;kb++){for(var Db=Qa[kb],ub=[],Ta=[],Za=Qa[kb].objects,cb=0;cb<Za.length;cb++){var sb=
Za[cb];z(Za,sb,null,ub,Ta);var ac=sb.dupli_group;if(ac)for(var Pb=ac.objects,$a=0;$a<Pb.length;$a++)z(Pb,Pb[$a],sb,ub,Ta)}for(cb=0;cb<Ta.length;cb++)for(var db=Ta[cb],mb=[Db],qb=0;qb<mb.length;qb++){for(var zb=mb[qb].objects,Kb=0;Kb<zb.length;Kb++){var Vb=zb[Kb].dupli_group;if(Vb){var fc=Vb.objects,kc=fc.indexOf(db);-1<kc&&fc.splice(kc,1)}}var kc=zb.indexOf(db);-1<kc&&zb.splice(kc,1)}for(cb=0;cb<ub.length;cb++)Ba.bL(ub[cb][0],ub[cb][1])}!c.gb&&1<a.scenes.length&&(a.scenes=[pa.Qq(a.scenes)],O.warn("loading data contains multiple scenes.",
"Only the first one will be loaded."));var tc=c.gb?Ga:pa.Qq(a.scenes);Ia.VR(Ga.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Ga),1),a.scenes.unshift(Ga));for(var bc=0;bc<a.scenes.length;bc++){var mc=a.scenes[bc];mc.j={};mc.NA=mc==tc;mc.AK=c.gb;xa.enabled&&mc.b4w_enable_physics&&(c.gb||!ga.rs(Ga)&&mc==pa.Qq(a))&&ga.zP(mc);c.gb?mc.b4w_enable_audio&&Ea.gB(mc):mc.b4w_enable_audio&&!Ga.Va&&Ea.gB(Ga)}for(var Ac=0;Ac<a.scenes.length;Ac++){for(var Jc=a.scenes[Ac],xc=r(Jc),cc=0;cc<xc.length;cc++){var Qb=
xc[cc];T.aM(Qb,Jc,a)&&(Qb.Ac||(Qb.Ac=[]),Qb.Ac.push(c.gb?Jc:Ga))}for(var Oc=xc,dc=0;dc<Oc.length;dc++){var ec=Oc[dc];if(ec.Ac&&"WORLD"!=ec.type)for(var Wb=ec.particle_systems,nd=0;nd<Wb.length;nd++){var Bc=Wb[nd].settings;if("HAIR"==Bc.type)if("OBJECT"==Bc.render_type){var Xc=Bc.dupli_object;Xc.Ac||(Xc.Ac=ec.Ac.slice())}else if("GROUP"==Bc.render_type)for(var wd=Bc.dupli_group,Pc=0;Pc<wd.objects.length;Pc++)Xc=wd.objects[Pc],Xc.Ac||(Xc.Ac=ec.Ac.slice())}}}for(var od=a.scenes,Yc=[],vb=0;vb<od.length;vb++)A(od[vb].objects,
0,c.gb,Yc);Lb[c.id]=[];for(vb=0;vb<Yc.length;vb++)for(var xd=Yc[vb],Kc=0;Kc<xd.length;Kc++)for(var Zc=xd[Kc],Qc=0;Qc<Zc.length;Qc++)Lb[c.id].push(Zc[Qc]);for(var $c=a.particles,vb=0;vb<$c.length;vb++){var Fc=$c[vb].dupli_object;Fc&&(Fc.MA=!0,Lb[c.id].push(Fc));var Rc=$c[vb].dupli_group;if(Rc)for(var yd=Rc.objects,Kc=0;Kc<yd.length;Kc++)Fc=yd[Kc],Fc.MA=!0,Lb[c.id].push(Fc)}for(var ad=Lb[c.id],vb=ad.length-1;0<=vb;vb--)ad[vb].Ac||ad.splice(vb,1);for(var Sc=Lb[c.id],Ac=0;Ac<Sc.length;Ac++)if(Qb=Sc[Ac],
!c.gb&&Qb.parent&&-1<nb.indexOf(Qb.parent.type)&&(Qb.parent=""),"MESH"==Qb.type){var bd=ya.eL(Qb);bd&&(a.meshes.push(bd),Qb.data=bd)}for(var Lc=0;Lc<a.scenes.length;Lc++){var hd=a.scenes[Lc],cd=hd.world;cd.Ac||(cd.Ac=[]);cd.Ac.push(c.gb?hd:Ga)}for(var Tc=0;Tc<a.scenes.length;Tc++){var dd=a.scenes[Tc];if(dd.b4w_use_logic_editor){var pd=r(dd);ya.nL(pd,dd)}}e(c,b)}function r(a){var c=[];l(a.objects,"ALL",c);return c}function l(a,c,b){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=c&&c!=e.type||b.push(e);
(e=e.dupli_group)&&l(e.objects,c,b)}}function A(a,c,b,d){d[c]=d[c]||[];for(var e=d[c],f=0;f<a.length;f++){var h=a[f],g=ha(h);e[g]=e[g]||[];(b||-1==nb.indexOf(h.type))&&-1==e[g].indexOf(h)&&e[g].push(h);(h=h.dupli_group)&&A(h.objects,c+1,b,d)}}function x(a,c,b){var d=[];a=Lb[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==b||"ALL"==b)for(var h=0;h<f.Ac.length;h++)c==f.Ac[h]&&d.push(f)}return d}function L(a,c,b,d,e){var f=Lb[c.id],h=a.worlds;d=c.id;for(var g=0;g<f.length;g++){for(var m=f[g],l=
Da.pn(m.name,m.type,m.origin_name),k=0;k<m.Ac.length;k++)Da.Pm(l,m.Ac[k]);m.ya=l;T.Di(m,l);l.g.Ad=d;l.io=m.MA||!1}for(d=0;d<h.length;d++){g=h[d];m="%meta_world%"+g.name;m=Da.pn(m,"WORLD",m);for(l=0;l<g.Ac.length;l++)Da.Pm(m,g.Ac[l]);g.ya=m;T.VT(g,m)}d=T.uj(c.id);for(g=0;g<f.length;g++)m=f[g],l=m.ya,Aa.Di(m,l);for(g=0;g<h.length;g++)m=h[g],Aa.Di(m,m.ya);if(c.gb)for(h=c.id,g=0;g<a.scenes.length;g++)for(var m=a.scenes[g],l=0,k=T.Pb(m,"LAMP",h),p=0;p<k.length;p++)Da.aa(k[p],m).Fj=l++;for(g=0;g<f.length;g++)m=
f[g],l=m.ya,l.io||(T.KT(m,l),sa.o(l));for(a=0;a<f.length;a++)if(h=f[a],g=h.ya,Da.Pc(g)&&(m=h.lod_levels.length))for(l=g,k=0;k<m;k++)if(p=h.lod_levels[k].object){p=p.ya;p.g.tl=g.g.tl;l.g.ci=h.lod_levels[k].distance;p.g.po=h.lod_levels[k].distance;if(h.lod_levels[k+1])p.g.ci=h.lod_levels[k+1].distance;else{p.g.Cr=!0;p.g.ci=T.Qz;break}l.g.Cr=!1;l=p}else{l.g.Cr=!0;l.g.ci=h.lod_levels[k].distance;break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(h=a.$p)){var h=h.g,g=a.g.Fk,m=[],v;for(v in g)l=g[v],
m.push(4*l.Uv,4*l.Lh);h.fF.push(m);h.Ns.push(a.g)}f=v=-1;a=la.yD();for(h=0;h<d.length;h++)g=d[h],m=g.g,Da.Pc(g)&&m.ml&&(g=m.dh,g>v&&(v=g),a>=g&&g>f&&(f=g));for(h=0;h<d.length;h++)g=d[h],m=g.g,Da.Pc(g)&&m.ml&&(m.On=!0,v<a?m.dh=v:m.dh<=a?m.dh=f:(O.warn('too many bones for "'+g.name+'" / '+m.dh+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),m.dh=v,m.On=!1),m.On=m.On&&!ab.TC);for(v=0;v<d.length;v++)if(f=d[v],f.Ed)if(a=f.Vd,"CHASSIS"==a.Id){f.n=
{};f.n.Nn=a.Nn;f.n.Vm=a.Vm;f.n.Yy=a.Yy;f.n.$y=a.$y;f.n.Zy=a.Zy;f.n.Dz=a.Dz;f.n.iy=a.iy;f.n.qx=a.qx;f.n.Uk=0;f.n.Um=1;f.n.em=0;f.n.speed=0;f.n.Xj=[];f.n.Bo=[];f.n.gm=null;g=(h=Da.Xg(f))?Da.Aw(h,d):d;for(h=0;h<g.length;h++)m=g[h],m.Ed&&(l=m.Vd,ga.DP(m)&&a.name==l.name?(l=ga.AU(m.Vd.Id),f.n.Xj[l]=m,f.n.Bo[l]=new Float32Array(8)):ga.EE(m)&&a.name==l.name?(f.n.gm=m,f.n.fm=l.fm,f.n.Xo=l.Xo,f.n.eo=l.eo,l=wa.invert(f.g.i,wa.create()),m=wa.multiply(l,m.g.i,l),f.n.nH=m,l=new Float32Array([1,0,0]),wa.Tc(l,m,
l),f.n.mH=l):ga.DE(m)&&a.name==l.name?(f.n.Ry=m,f.n.Vo=l.Vo,f.n.vl=l.vl,l=wa.invert(f.g.i,wa.create()),m=wa.multiply(l,m.g.i,l),f.n.jH=m,l=new Float32Array([1,0,0]),wa.Tc(l,m,l),f.n.iH=l):ga.FE(m)&&a.name==l.name&&(f.n.bz=m,f.n.vn=l.vn,l=wa.invert(f.g.i,wa.create()),m=wa.multiply(l,m.g.i,l),f.n.xH=m,l=new Float32Array([1,0,0]),wa.Tc(l,m,l),f.n.wH=l));4!=f.n.Xj.length&&Ba.l("Not enough wheels for chassis "+f.name)}else if("HULL"==a.Id)for(f.n={},f.n.Xj=[],f.n.Bo=[],f.n.Nn=a.Nn,f.n.Vm=a.Vm,f.n.oj=a.oj,
f.n.nk=a.nk,f.n.ok=a.ok,f.n.Uk=0,f.n.Um=1,f.n.em=0,f.n.speed=0,f.n.gm=null,g=(h=Da.Xg(f))?Da.Aw(h,d):d,h=0;h<g.length;h++)m=g[h],m.Ed&&(l=m.Vd,ga.CP(m)&&a.name==l.name?(f.n.Xj.push(m),f.n.Bo.push(new Float32Array(8))):ga.EE(m)&&a.name==l.name?(f.n.gm=m,f.n.fm=l.fm,f.n.Xo=l.Xo,f.n.eo=l.eo,l=wa.invert(f.g.i,wa.create()),m=wa.multiply(l,m.g.i,l),f.n.nH=m,l=new Float32Array([1,0,0]),wa.Tc(l,m,l),f.n.mH=l):ga.DE(m)&&a.name==l.name?(f.n.Ry=m,f.n.Vo=l.Vo,f.n.vl=l.vl,l=wa.invert(f.g.i,wa.create()),m=wa.multiply(l,
m.g.i,l),f.n.jH=m,l=new Float32Array([1,0,0]),wa.Tc(l,m,l),f.n.iH=l):ga.FE(m)&&a.name==l.name&&(f.n.bz=m,f.n.vn=l.vn,l=wa.invert(f.g.i,wa.create()),m=wa.multiply(l,m.g.i,l),f.n.xH=m,l=new Float32Array([1,0,0]),wa.Tc(l,m,l),f.n.wH=l));for(v=0;v<d.length;v++)if(f=d[v],f.Ej&&(a=f.Wk,"MAIN_BODY"==a.Id))for(f.Se={},f.Se.oj=a.oj,f.Se.nk=a.nk,f.Se.ok=a.ok,f.Se.hq=[],h=(h=Da.Xg(f))?Da.Aw(h,d):d,g=0;g<h.length;g++)m=h[g],m.Ej&&(l=m.Wk,ga.GP(m)&&a.name==l.name&&(f.Se.hq.push(m),m.DL=m.Wk.vH));e(c,b)}function M(a,
c,d,b,e){for(b=0;b<a.scenes.length;b++){var f=a.scenes[b];f.Gh=f.camera.ya}for(b=0;b<a.scenes.length;b++){var f=c.gb?a.scenes[b]:Ga,h=c.gb?T.Pb(f,"LAMP",c.id):T.Pb(f,"LAMP",0),g=T.Pb(f,"ALL",c.id),m=x(c.id,f,"MESH"),l=x(c.id,f,"EMPTY");x(c.id,f,"WORLD");c.gb&&pa.NK(f,g,h,m,l);for(var g=!1,k=0;k<l.length;k++)for(var p=l[k].ya,v=p.A,r=0;r<v.length;r++){var q=v[r].Ta,n=pa.XH(q,p);f.name==q.name&&(g=g||n)}c.gb&&f.j.mc&&!g&&O.warn('Scene "'+f.name+'" has water but has no wind.');l=[];pa.vs(f);E.BO(f,m,
h,l);k=x(c.id,f,"LINE");E.AO(f,k);p=pa.Dw(f);if(c.gb){k=f.j.Ps;if(k.pR||k.procedural_skydome)g=f.world.ya,E.SK(f,k,g),E.Fv(g,p,f);pa.ZC(p)}for(k=0;k<m.length;k++)E.Fv(m[k].ya,p,f);for(k=0;k<l.length;k++)E.Fv(l[k],p,f),T.JQ(l[k]);g=T.Pb(f,"ALL",c.id);pa.oL(f,g,h);for(k=0;k<g.length;k++)p=g[k],p.g.Pf&&T.yT(p),Da.hM(p)&&(p.pF=!0)}pa.OK(Ga,a.textures,c.id);c.gb&&Ga.j.wm.length&&(c.Pw=!0);b=a.materials;if(La.Sv&&Ja.fI)for(a=0;a<b.length;a++){m=b[a];k=m.texture_slots;for(f=0;f<k.length;f++)if(l=k[f],p=
l.texture,"IMAGE"==p.type||"ENVIRONMENT_MAP"==p.type)h=p.image,h.Xd||(-1<h.filepath.indexOf(".dds")?h.Xd=!0:(h.Xd=!p.b4w_disable_compression&&!l.use_map_normal&&"ENVIRONMENT_MAP"!=p.type&&!p.b4w_shore_dist_map&&"MOVIE"!=h.source,h.Xd&&(h.filepath+=".dds")));if(f=m.node_tree)for(m=f.nodes,f=0;f<m.length;f++)h=m[f],"TEXTURE"==h.type&&(k=h.texture)&&(h=k.image)&&!h.Xd&&(h.Xd=k.j.Tp&&!k.b4w_disable_compression&&"MOVIE"!=h.source&&"ENVIRONMENT_MAP"!=k.type,h.Xd&&(h.filepath+=".dds"))}else for(a=a.images,
b=0;b<a.length;b++)f=a[b],f.Xd=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds"));e(c,d)}function F(a,c,b,d,e){d=a.groups;for(var f=a.objects,h={},g={},m={},l={},k=0;k<d.length;k++){var p=d[k];h[p.uuid]=p;m[p.uuid]=p}for(k=0;k<f.length;k++)p=f[k],g[p.uuid]=p,l[p.uuid]=p;a=a.scenes;for(k=0;k<a.length;k++)J(a[k].objects,null,l,m,null);for(var v in m)v in h||d.push(m[v]);for(v in l)v in g||f.push(l[v]);e(c,b)}function J(a,c,b,d,e){for(var f=[],h=0;h<a.length;h++){var g=a[h],m=b[g.uuid];if(g=m.proxy){c&&
-1==f.indexOf(g.uuid)&&f.push(g.uuid);for(var l=b[g.uuid],k=l.constraints,g=0;g<k.length;g++){var p=Ba.Oh(k[g]);p.name+="_CLONE";m.constraints.push(p)}"b4w_proxy_inherit_anim"in m&&!m.b4w_proxy_inherit_anim||(m.animation_data&&(l.animation_data=Ba.Oh(m.animation_data)),l.b4w_use_default_animation=m.b4w_use_default_animation,l.b4w_auto_skel_anim=m.b4w_auto_skel_anim,l.b4w_anim_behavior=m.b4w_anim_behavior,l.b4w_cyclic_animation=m.b4w_cyclic_animation)}}for(h=0;h<f.length;h++)m=Ba.WO(a,f[h]),-1<m&&
a.splice(m,1);f={};if(c)for(h=0;h<a.length;h++)g=a[h],m=b[g.uuid],k=Ba.Oh(m),l="origin_name"in m?m.origin_name:m.name,k.name=Da.YC(c.name,l),k.origin_name=l,k.dg_parent={uuid:c.uuid},C(k),b[k.uuid]=k,f[g.uuid]=k.uuid,g.uuid=k.uuid,e&&e[m.uuid]&&(k.b4w_cluster_data=e[m.uuid]);for(h=0;h<a.length;h++)g=a[h],m=b[g.uuid],m.dupli_group&&(g=m.dupli_group,e=d[g.uuid],k=Ba.Oh(e),k.name=Ba.Zo(e.name+"_CLONE"),k.uuid=S.oE("Group"+k.name),d[k.uuid]=k,g.uuid=k.uuid,J(k.objects,m,b,d,m.b4w_cluster_data));if(c)for(h=
0;h<a.length;h++){g=a[h];m=b[g.uuid];m.parent&&m.parent.uuid in f?m.parent.uuid=f[m.parent.uuid]:m.parent&&(O.warn("Object's \""+m.name+'" parent is not in dupli group. Disabling parenting.'),m.parent=null);k=m.constraints;for(g=0;g<k.length;g++)c=k[g],c.target&&c.target.uuid in f&&(c.target.uuid=f[c.target.uuid]);if(c=m.pose)for(d=c.bones,g=0;g<d.length;g++)if(e=d[g].constraints)for(k=0;k<e.length;k++)c=e[k],c.target&&c.target.uuid in f&&(c.target.uuid=f[c.target.uuid]);c=m.modifiers;for(g=0;g<c.length;g++)d=
c[g],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((m=m.lod_levels)&&m.length)for(g=0;g<m.length;g++)c=m[g],c.object&&c.object.uuid in f&&(c.object.uuid=f[c.object.uuid])}for(var v in f)Oa[v]=f[v]}function C(a){a.uuid=S.oE("Object"+a.name)}function H(a,c){for(var b=a.nodes,e=0;e<b.length;e++){var f=b[e];"TEXTURE"==f.type&&f.texture&&K(f,"texture",c);"LAMP"==f.type&&f.lamp&&(f.lamp.uuid in Oa&&(f.lamp.uuid=Oa[f.lamp.uuid]),c[f.lamp.uuid]||(f.lamp=null));"GROUP"==f.type&&f.node_group&&
K(f,"node_group",c)}f=a.links;for(e=0;e<f.length;e++){var g=f[e];d(g,"from_node",b);d(g,"to_node",b);h(g,"from_socket",g.from_node.outputs);h(g,"to_socket",g.to_node.inputs)}if(b=a.animation_data)if(b.action&&K(b,"action",c),b.nla_tracks)for(e=0;e<b.nla_tracks.length;e++)for(f=b.nla_tracks[e],g=0;g<f.strips.length;g++)f.strips[g].action&&K(f.strips[g],"action",c)}function K(a,c,b){(b=b[a[c].uuid])||O.error("Dangling link found:",c,a);a[c]=b}function d(a,c,b){b=Ba.Lc("name",a[c].name,b);a[c]=b}function h(a,
c,b){b=Ba.Lc("identifier",a[c].identifier,b);a[c]=b}function v(a,d,e,f,h,g){f=Y(d.bg);for(var m=a.images,l={},k=[],p=0;p<m.length;p++){var v=m[p],r=v.uuid;if("FILE"===v.source||"MOVIE"===v.source){var q=c(v,a.textures);if(!q.length)O.warn("image ",v.name," has no users.");else if(!q[0].b4w_shore_dist_map){q=Ba.qo(f+v.filepath);if("FILE"===v.source){var n=v.Xd?da.lp:da.mp,t=da.Wo(q),u=t[1].toLowerCase();if(!da.gM(u)){O.error("image ",v.name," has unsupported format.");continue}La.rx&&Ja.it&&("dds"==
t[1]?(q=da.Wo(t[0]),q=q[0]+".min50."+q[1]+".dds"):q=t[0]+".min50."+t[1])}else if("MOVIE"===v.source)if(Ja.Po)t=da.Wo(q),q=t[0]+".altconv.seq",n=da.np;else{var t=da.Wo(q),u=t[1].toLowerCase(),A=Ea.CN(u);if(""==A){O.error("failed to load video file (unsupported format)",q);continue}q=A!=u?t[0]+".altconv."+A:t[0]+"."+t[1];n=da.op}k.push({id:r,type:n,url:q});l[r]=v}}}if(k.length){var x=0;da.cd(k,function(f,h,m,p){if(f){if(m==da.op||m==da.np){if(m==da.op)var v=f.videoWidth,q=f.videoHeight;else v=f.images[0].width,
q=f.images[0].height;O.log("%cLOAD VIDEO "+v+"x"+q,"color: #"+(2048<v||2048<q?"a00":1024<v||1024<q?"aa0":"0a0"),p);-1==p.indexOf(qa)&&O.warn("video",p,"is not from app root.")}else b(f,p,!0);h=l[h];p=c(h,a.textures);for(v=0;v<p.length;v++){var q=p[v],r=q.image.filepath;m==da.np?(q.j.oy=f.Vg,Fa.ht(q.j,f.images,h.Xd,r,d.id)):Fa.ht(q.j,f,h.Xd,r,d.id)}}f=++x/k.length;g(d,e,f)},function(){O.log("%cLOADED ALL IMAGES","color: #0a0");h(d,e)})}else h(d,e)}function P(a,c,b,d,e){a=pa.FD();for(d=0;d<a.length;d++){var f=
a[d];if(f.b4w_use_nla){var h=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(h=!1);Aa.PT(f,h,c.id)}}e(c,b)}function c(a,c){for(var b=[],d=0;d<c.length;d++){var e=c[d];e.image===a&&b.push(e)}return b}function p(a,c,b,d,e,f){a=Y(c.bg);var h=[],g={};d=T.uj(c.id);for(var m=0;m<d.length;m++){var l=d[m];if(Da.mo(l)&&Ea.hH(l)!=Ea.Lz){var k=l.P.Ei;"BACKGROUND_MUSIC"==Ea.Hw(l)?(k=Ba.rw(),c.Nw=!0):"NONE"!=Ea.Hw(l)&&Ja.Sw&&(c.Rw=!0);if(!(k in g)){g[k]=[];var p=Ba.qo(a+l.P.bg);switch(Ea.hH(l)){case Ea.tt:var v=da.Mz;
break;case Ea.Kz:v=da.Nz}var q=da.Wo(p),r=q[1].toLowerCase(),n=Ea.AN(r);""!=n?(p=n!=r?q[0]+".altconv."+n:q[0]+"."+q[1],h.push({id:k,type:v,url:p})):O.error("failed to load audio file (unsupported format)",p)}g[k].push(l)}}if(h.length){var t=0;da.cd(h,function(a,d,e,m){if(a)for(O.log("%cLOAD SOUND","color: #0aa",m),-1==m.indexOf(qa)&&O.warn("sound",m,"is not from app root."),d=g[d],e=0;e<d.length;e++)Ea.TT(d[e],a);a=++t/h.length;f(c,b,a)},function(){O.log("%cLOADED ALL SOUNDS","color: #0aa");e(c,b)})}else e(c,
b)}function N(a,c,b){a=T.Pb(a,"SPEAKER",c);for(c=0;c<a.length;c++){var d=a[c];Da.mo(d)&&(Ea.zE(d)||b)&&Ea.OF(d)}}function G(a,c){for(var b=a.j.wm,d=0;d<b.length;d++){var e=b[d].j;a.b4w_use_nla&&b[d].b4w_nla_video||!b[d].use_auto_refresh||c!=e.Ah||(Fa.mG(e.name,c),Fa.QF(e.name,c))}}function u(a,c,b,d,e){Aa.start();O.log("%cSTART NLA","color: #0a0");e(c,b)}function z(a,c,b,d,e){if(c.lod_levels&&c.lod_levels.length)for(var f=c.lod_levels.length,h=0;h<f;h++){var g=c.lod_levels[h],m=g.object;if(m){var l=
Ba.dn(m);l.name=c.name+"_LOD_"+String(h+1);l.b4w_cluster_data=c.b4w_cluster_data;C(l);l.lod_levels=[];b&&(l.dg_parent=b);d.push([a,l]);e.push(m);g.object=l}}}function q(a,c,b,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!ga.oM(a.scenes[f])){d=!1;break}d&&(e(c,b),O.log("%cPHYSICS READY","color: #0a0"))}function D(a,c,b,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(c.gb)var h=ga.rs(f);else h=ga.rs(Ga)||ga.rs(f),f=Ga;if(xa.enabled&&h)for(h=0;h<fc.length;h++)for(var g=T.Pb(f,fc[h],c.id),
m=0;m<g.length;m++){var l=g[m];l.g.Ad==c.id&&(ga.Ak(l,f),c.WE&&ga.ea(l)&&ga.aw(l))}}e(c,b)}function I(a,d,e,f,h){var g={};f=[];for(var m=a.scenes,l=0;l<a.scenes.length;l++){var k=m[l];if(k.j.mc&&(k=k.j.mc.ui)&&"FILE"===k.source){var p=k.uuid,v=Ba.qo(Y(d.bg)+k.filepath);f.push({id:p,type:k.Xd?da.lp:da.mp,url:v});g[p]=k}}f.length?da.cd(f,function(e,f,h,l){if(e){b(e,l,!0);f=g[f];l=c(f,a.textures);for(h=0;h<l.length;h++){var k=l[h];Fa.ht(k.j,e,f.Xd,k.image.filepath,d.id)}for(h=0;h<m.length;h++)if(l=m[h],
l.j.mc&&(k=l.j.mc.ui,k===f)){var p=e,v=document.createElement("canvas"),k=f.size[0],q=f.size[1];v.width=k;v.height=q;v=v.getContext("2d");v.drawImage(p,0,0);p=v.getImageData(0,0,k,q).data;v=new Float32Array(4);v[0]=1/16581375;v[1]=1/65025;v[2]=1/255;v[3]=1;for(var k=k*q,q=new Float32Array(k),r=0;r<k;r++)q[r]=v[1]*p[4*r+2]+v[2]*p[4*r+3];l.j.Iy=q}}else for(f=g[f],h=0;h<m.length;h++)l=m[h],k=l.j.mc.ui,k===f&&(l.j.mc.ui=null,O.warn("image",k.filepath," was not found. Disabling water shore effects."))},
function(){h(d,e)}):h(d,e)}function m(a,c,d,e,f){e=a.scenes[0];a=[];for(var h=["SMAA_EDGE_DETECTION","SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING","SMAA_RESOLVE"],g=0;g<h.length;g++){var m=pa.qa(e,h[g]);m&&a.push(m)}if(a.length){e=[];g=da.mp;e.push({id:"SEARCH_TEXTURE",type:g,bg:oa.qd.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:g,url:oa.qd.smaa_area_texture_path});for(g=0;g<a.length;g++)if(h=a[g],"SMAA_BLENDING_WEIGHT_CALCULATION"==h.type){a=h.Fa;for(g=0;g<a.length;g++)if(h=
a[g],"u_search_tex"==h.to)var l=h.Ja;else if("u_area_tex"==h.to)var k=h.Ja;break}e.length?da.cd(e,function(a,d,e,f){a&&(b(a,f,!1),d="SEARCH_TEXTURE"==d?l:k,d.source="IMAGE",d.IW=!0,Fa.ht(d,a,-1!=f.indexOf(".dds")?1:0,f,c.id),Fa.vy(d,Fa.F,Fa.F))},function(){f(c,d)}):f(c,d)}else f(c,d)}function V(a,c,d,b){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];c.gb||(e=Ga);for(var f=T.Pb(e,"LAMP",c.id),h=0;h<f.length;h++){var g=f[h];g.g.Ad==c.id&&b.Iu.push({Ta:e,Ca:g})}f=T.Pb(e,"ALL",c.id);for(h=0;h<f.length;h++)g=
f[h],"LAMP"!=g.type&&g.g.Ad==c.id&&(c.WE&&Da.Pc(g)&&pa.$m(g,!0),b.Iu.push({Ta:e,Ca:g}))}}function Q(a,c,d,b,e,f){var h=b.Iu;e=b.yF;if(h.length){a=h[e].Ca;var g=h[e].Ta;e=Da.aa(a,g);pa.Ak(g,a,!1);!a.anchor||g.j.ao||g.j.anaglyph_use||ka.append(a);b=++b.yF/h.length;h=e.Mg;if(null!=a.g.Qe&&h){var m=Ka.copy(a.g.Yc.O,Ha);pa.WH(h,m)}h=a.Ho;if(h.length&&g.j.og)for(g=wa.q(a.g.i),a=wa.B(a.g.i),e=e.ng,m=0;m<e.length;m++)pa.$H(e[m],g,a),Da.aI(h,e[m].k.jc)}else b=1;f(c,d,b)}function R(a,c,d,b,e){if(c.gb){b=pa.wj();
var f=pa.FD();for(a=0;a<f.length;a++){var h=f[a];pa.dR(h,b);h.b4w_use_logic_editor&&ra.xP(h,c.id)}pa.vs(b)}else pa.bI(Ga);b=T.uj(c.id);T.LT(b);for(f=0;f<b.length;f++)for(h=b[f],a=0;a<h.A.length;a++)for(var g=h.A[a].X,m=0;m<g.length;m++)null==g[m].rb&&g.splice(m--,1);e(c,d)}function X(a,c,d,b,e){if(c.gb)for(b=0;b<a.scenes.length;b++)G(a.scenes[b],c.id),N(a.scenes[b],c.id);else G(Ga,c.id),N(Ga,c.id);e(c,d)}function ja(a,c,b,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;Ja.media_auto_activation&&
(c.Pw||c.Nw||c.Rw)?Ma||W(a,e,c,b):e(c,b)}function W(a,c,d,b){function e(){if(!g){g=!0;d.Pw&&(Fa.play(),Fa.pause(),Fa.reset());if(d.Nw){if(d.gb)for(var f=0;f<a.scenes.length;f++)N(a.scenes[f],d.id,!0);else N(Ga,d.id,!0);Ea.pause()}d.Rw&&Ea.PF();Z();c(d,b)}}var f=lb.parentElement;ta=f.style.zIndex;f.style.zIndex="999";Ma=document.createElement("div");Ma.style.position="relative";Ma.style.height="88px";Ma.style.width="88px";var h=Math.round(lb.offsetWidth/2-44);Ma.style.top=Math.round(lb.offsetHeight/
2-44).toString()+"px";Ma.style.left=h.toString()+"px";Ma.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Ma.style.backgroundSize="88px";fb=document.createElement("div");fb.style.position="relative";fb.style.height=lb.offsetHeight.toString()+"px";fb.style.width=lb.offsetWidth.toString()+"px";fb.style.background="rgba(0, 0, 0, 0.5)";fb.style.zIndex="999";f.appendChild(fb);fb.appendChild(Ma);Ma.addEventListener("touchstart",e,!1);Ma.addEventListener("click",e,!1);var g=!1}function Z(){if(Ma){var a=lb.parentElement;a.style.zIndex=ta;fb.removeChild(Ma);a.removeChild(fb);Ma=fb=null;ta=0}}function Y(a){(a=
a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ia(a){la.Xb(a)&&la.remove(a);za.nR(a);T.nq(a);U.lq(a)&&U.Ko(a);ga.ea(a)&&ga.Jo(a);pa.oR(a);Da.mo(a)&&Ea.KS(a);ka.BP(a)&&ka.remove(a)}function ha(a){var c=la.iD(a);return(a=c&&c.parent==a?null:a.parent||c)?1+ha(a):0}var ka=n("__anchors"),la=n("__animation"),da=n("__assets"),E=n("__batch"),oa=n("__config"),U=n("__controls"),ea=n("__dds"),Ca=n("__debug"),ba=n("__extensions"),aa=n("__input"),ca=n("__loader"),S=n("__md5"),Aa=n("__nla"),ra=
n("__logic_nodes"),za=n("__particles"),ma=n("__nodemat"),T=n("__objects"),Da=n("__obj_util"),ga=n("__physics"),O=n("__print"),ya=n("__reformer"),fa=n("__renderer"),pa=n("__scenes"),Ea=n("__sfx"),ua=n("__shaders"),Fa=n("__textures"),Ia=n("__time"),sa=n("__transform"),wa=n("__tsr"),Ba=n("__util"),Ka=n("__vec3"),Ja=oa.v,La=oa.Ne,xa=oa.r,ab=oa.Xi,Kb=oa.P,na=null,Lb=null,qa="",Ga=null,Oa={},Ha=new Float32Array(3),Ma=null,fb=null,ta=0,Db=!1,nb=["LAMP","CAMERA"],fc=["MESH","CAMERA","EMPTY"],lb=null;a.hg=
function(a){return ca.hg(a)};a.update=function(){ca.QT(na)};a.uS=function(a){lb=a};a.IT=function(a,c){if(Ma){fb.style.height=c.toString()+"px";fb.style.width=a.toString()+"px";var d=Math.round(a/2-44);Ma.style.top=Math.round(c/2-44).toString()+"px";Ma.style.left=d.toString()+"px"}};a.load=function(a,c,d,b,h){var l={load_main:{Ab:ca.Li,Lb:!1,L:[],Qb:!1,Sb:500,ic:!1,Vb:e},duplicate_objects:{Ab:ca.ud,Lb:!1,L:["load_main"],Qb:!1,Sb:50,ic:!1,Vb:F},load_binaries:{Ab:ca.Li,Lb:!1,L:["load_main"],Qb:!1,Sb:500,
ic:!1,Vb:y},wait_for_shaders:{Ab:ca.ud,Lb:!1,L:[],Qb:!1,Sb:50,ic:!0,Mh:g},prepare_bindata:{Ab:ca.ud,Lb:!1,L:["duplicate_objects","load_binaries"],Qb:!1,Sb:100,ic:!1,Vb:B},prepare_bpy_data:{Ab:ca.ud,Lb:!1,L:["duplicate_objects","prepare_bindata"],Qb:!1,Sb:100,ic:!1,Vb:f},process_objects:{Ab:ca.ud,Lb:!1,L:["prepare_bpy_data"],Qb:!1,Sb:150,ic:!1,Vb:L},process_scenes:{Ab:ca.ud,Lb:!1,L:["process_objects","wait_for_shaders"],Qb:!1,Sb:300,ic:!1,Vb:M},load_smaa_textures:{Ab:ca.Li,Lb:!1,L:["process_scenes"],
Qb:!1,Sb:30,ic:!0,Vb:m},load_shoremap:{Ab:ca.Li,Lb:!1,L:["process_scenes"],Qb:!1,Sb:30,ic:!0,Vb:I},load_textures:{Ab:ca.Li,Lb:!0,L:["process_scenes"],Qb:!0,Sb:500,ic:!1,Vb:v},update_scenes_nla:{Ab:ca.ud,Lb:!1,L:["process_scenes","load_textures"],Qb:!1,Sb:50,ic:!1,Vb:P},wait_physics_workers:{Ab:ca.ud,Lb:!1,L:["load_shoremap"],Qb:!1,Sb:20,ic:!1,Mh:q},add_physics_objects:{Ab:ca.ud,Lb:!1,L:["wait_physics_workers"],Qb:!1,Sb:50,ic:!1,Vb:D},add_objects:{Ab:ca.ud,Lb:!1,L:["add_physics_objects"],Qb:!1,Sb:600,
ic:!1,Vb:V,Mh:Q,Ym:R,Zm:{Iu:[],yF:0}},load_speakers:{Ab:ca.Li,Lb:!0,L:["add_objects"],Qb:!0,Sb:100,ic:!1,Vb:p},mobile_media_start:{Ab:ca.ud,Lb:!1,L:["load_textures","update_scenes_nla","load_speakers"],Qb:!0,Sb:5,ic:!1,Vb:ja,Mh:ja},synchronize_media:{Ab:ca.ud,Lb:!0,L:["mobile_media_start"],Qb:!0,Sb:50,ic:!1,Vb:X},start_nla:{Ab:ca.ud,Lb:!0,L:["mobile_media_start"],Qb:!1,Sb:5,ic:!0,Vb:u}},r=ca.KD();r||(r=ca.$M(),na={},Lb={},Oa={});na[r.vg.length]={};return ca.iN(l,a,c,d,k,b||Kb.hB,Ja.do_not_load_resources,
h)};a.gt=function(a){var c=ca.KD();if(!c||!c.vg.length||a&&!ca.gT(c.vg[a]))O.error("Unable to unload data!");else{if(0==a)O.log("%cUNLOAD ALL","color: #00a"),ka.ha(),la.ha(),Ea.ha(),Aa.ha(),E.ha(),pa.ha(),ca.ha(),U.ha(),ga.ha(),T.ha(),Ba.ha(),fa.ha(),ma.ha(),ua.ha(),ba.ha(),da.ha(),Fa.ha(),ra.ha(),za.ha(),aa.ha(),Ca.ha(),Lb=null,Oa={},na=Ga=null,Db=!1;else{O.log("%cUNLOAD DATA "+a,"color: #00a");la.lR(a);for(var c=T.uj(T.vc),d=0;d<c.length;d++){var b=c[d];Da.Ew(b)!=a&&T.Sr(b,!1,!1,!1,!1)}c=T.uj(a);
for(d=c.length-1;0<=d;d--)b=c[d],ia(b),T.Jo(b);c=T.uj(T.vc);for(d=0;d<c.length;d++)T.Sr(c[d],!0,!0,!0,!0)}Z()}};a.cR=ia;a.DG=function(a){qa=a};a.TA=function(){Db||Ja.media_auto_activation||(Fa.play(),Fa.pause(),Fa.reset(),N(Ga,T.vc,!0),Ea.pause(),Ja.Sw&&Ea.PF(),Db=!0)}};b4w.module.__controls=function(a,n){function k(a,c){c||(c=A.le());return{type:a,value:0,ka:null,element:c,Da:!1,key:0,pb:"",Xf:!1,wv:null,vv:function(){},uv:null,PB:function(){},wi:null,from:new Float32Array(3),to:new Float32Array(3),tE:!1,mr:!1,Eo:0,fG:function(){},axis:"",Ce:0,om:new Float32Array(3),ms:new Float32Array(4),threshold:0,ZF:new Float32Array(4),cq:0,bq:0,qG:0,dq:0,re:0,repeat:!1,iB:!1,sj:0,callback:function(){}}}function b(a){a||(a=A.le());for(var c=0;c<G.length;c++){var b=G[c];if(a==
b.element)return b}b={element:a,pl:!0,kl:!1,zr:!0,ux:0,vx:0,xl:0,yl:0,Mf:new Float32Array(2),Sd:new Float32Array(2),Nf:new Float32Array(2),De:new Float32Array(2),Zs:0,jz:0,NH:0,bd:new Uint8Array(256),qt:0,ny:null,Zw:!1,cE:J.create(),ir:0,hr:0,gr:0,Lw:0,Kw:0,fr:Infinity,K_:null,mh:{},DF:function(a){b.Zw||(x.kP(a,b.cE),b.Zw=!0)},CF:function(a){a=d.copy(a,q);b.gr=a[0];b.hr=a[1];b.ir=a[2];Infinity==b.fr&&(b.fr=a[0],b.Kw=a[1],b.Lw=a[2])},mF:function(a){b.qt+=a*h.BQ},iF:function(a){var c=x.da(x.Nc,b.element),
c=x.Wh(c,x.Eh,u);b.ux=c[0];b.vx=c[1];b.xl=c[0];b.yl=c[1];b.kl=!0;b.which=a},kF:function(){var a=x.da(x.Nc,b.element),a=x.Wh(a,x.Eh,u),a=A.pq(a[0],a[1],u);b.ny=L.es(a[0],a[1])},LH:function(a){1==a.length&&(a=A.pq(a[0].clientX,a[0].clientY,u),b.ny=L.es(a[0],a[1]))},lF:function(){b.kl=!1},jF:function(a){if(!v.lr||b.kl)b.xl=a[0],b.yl=a[1]},JE:function(a){2!=b.bd[a]&&(b.bd[a]=1,b.pl=!1)},LE:function(){for(var a=0;a<b.bd.length;a++)0!=b.bd[a]&&(b.bd[a]=3,b.pl=!1)},ME:function(a){1==b.bd[a]?b.bd[a]=0:(b.pl&=
0,b.bd[a]=3)},MH:function(a){b.zr=!1;if(1==a.length)b.Mf[0]=a[0].clientX,b.Mf[1]=-1,b.Nf[0]=a[0].clientY,b.Nf[1]=-1;else if(1<a.length){b.Zs=b.jz=f(a);b.Mf[0]=a[0].clientX;b.Mf[1]=a[1].clientX;b.Nf[0]=a[0].clientY;b.Nf[1]=a[1].clientY;var c=a[0];a=a[1];b.NH=Math.atan2(c.clientY-a.clientY,c.clientX-a.clientX)}b.Sd.set(b.Mf);b.De.set(b.Nf)},KH:function(a){1===a.length?(b.Sd[0]=a[0].clientX,b.Sd[1]=-1,b.De[0]=a[0].clientY,b.De[1]=-1):1<a.length&&(b.Sd[0]=a[0].clientX,b.Sd[1]=a[1].clientX,b.De[0]=a[0].clientY,
b.De[1]=a[1].clientY,b.Zs=f(a))},JH:function(a){0==a.length&&(b.zr=!0)}};G.push(b);return b}function e(a,c){if(c in a.mh&&0<a.mh[c])a.mh[c]+=1;else switch(a.mh[c]=1,c){case "orientation_quat":var b=x.da(x.Tf);b&&x.Xc(b,x.qk,a.DF);break;case "orientation_angles":(b=x.da(x.Tf))&&x.Xc(b,x.qk,a.CF);break;case "mouse_wheel":(b=x.da(x.Nc,a.element))&&x.Xc(b,x.Fm,a.mF);break;case "mouse_down_which":(b=x.da(x.Nc,a.element))&&x.Xc(b,x.Ni,a.iF);break;case "mouse_select":(b=x.da(x.Nc,a.element))&&x.Xc(b,x.Ni,
a.kF);break;case "touch_select":(b=x.da(x.nf,a.element))&&x.Xc(b,x.Qi,a.LH);break;case "mouse_up_which":(b=x.da(x.Nc,a.element))&&x.Xc(b,x.Em,a.lF);break;case "mouse_location":(b=x.da(x.Nc,a.element))&&x.Xc(b,x.Eh,a.jF);break;case "keyboard_downed_keys":if(b=x.da(x.zm,a.element))x.Xc(b,x.Cm,a.JE),x.Xc(b,x.Wz,a.LE),x.Xc(b,x.Dm,a.ME);break;case "touch_start":(b=x.da(x.nf,a.element))&&x.Xc(b,x.Qi,a.MH);break;case "touch_move":(b=x.da(x.nf,a.element))&&x.Xc(b,x.Im,a.KH);break;case "touch_end":(b=x.da(x.nf,
a.element))&&x.Xc(b,x.Hm,a.JH)}}function y(a,c){if(!(!c in a.mh)&&0<a.mh[c]&&(--a.mh[c],!a.mh[c]))switch(c){case "orientation_quat":var b=x.da(x.Tf);b&&x.$c(b,x.Dp,a.DF);break;case "orientation_angles":(b=x.da(x.Tf))&&x.$c(b,x.qk,a.CF);break;case "mouse_wheel":(b=x.da(x.Nc,a.element))&&x.$c(b,x.Fm,a.mF);break;case "mouse_down_which":(b=x.da(x.Nc,a.element))&&x.$c(b,x.Ni,a.iF);break;case "mouse_select":(b=x.da(x.Nc,a.element))&&x.$c(b,x.Ni,a.kF);break;case "touch_select":(b=x.da(x.nf,a.element))&&
x.$c(b,x.Qi,a.LH);break;case "mouse_up_which":(b=x.da(x.Nc,a.element))&&x.$c(b,x.Em,a.lF);break;case "mouse_location":(b=x.da(x.Nc,a.element))&&x.$c(b,x.Eh,a.jF);break;case "keyboard_downed_keys":if(b=x.da(x.zm,a.element))x.$c(b,x.Cm,a.JE),x.$c(b,x.Wz,a.LE),x.$c(b,x.Dm,a.ME);break;case "touch_start":(b=x.da(x.nf,a.element))&&x.$c(b,x.Qi,a.MH);break;case "touch_move":(b=x.da(x.nf,a.element))&&x.$c(b,x.Im,a.KH);break;case "touch_end":(b=x.da(x.nf,a.element))&&x.$c(b,x.Hm,a.JH)}}function g(a,c){a.value=
Number(c)}function B(a){for(var c=a.pi,b=a.HR,d=0;d<c.length;d++)b[d]=c[d].value;return a.nQ(b)}function w(a,b){a=a||c;var d=a.Kf;if(d){var e=a.$j;if(b){var f=d[b];if(f){for(var h=f.pi,g=0;g<h.length;g++){var l=h[g],k;k=p.indexOf(l);k=-1<k?N[k]:[];1==k.length?(t(l),l=p.indexOf(l),-1<l?(p.splice(l,1),N.splice(l,1)):K.l("Sensors cache is corrupted")):1<k.length&&k.splice(k.indexOf(f),1)}delete d[b];g=e.indexOf(f);-1<g?e.splice(g,1):K.l("Incorrect manifolds array");Object.getOwnPropertyNames(d).length||
(d=P.indexOf(a),-1<d?P.splice(d,1):M.error("Wrong object"))}}else{e=[];for(b in d)e.push(b);for(g=0;g<e.length;g++)w(a,e[g])}D=!0}}function t(a){switch(a.type){case 90:F.ay(a.wv,a.pb,a.vv);a.Da=!0;break;case 100:F.sv(a.uv);a.Da=!0;break;case 110:F.by(a.Eo);a.Da=!0;break;case 140:a.Da=!0;break;case 20:var c=b(a.element);y(c,"keyboard_downed_keys");a.Da=!0;break;case 30:c=b(a.element);y(c,"mouse_wheel");a.Da=!0;break;case 40:c=b(a.element);y(c,"mouse_down_which");y(c,"mouse_up_which");y(c,"mouse_location");
a.Da=!0;break;case 50:c=b(a.element);y(c,"mouse_down_which");y(c,"mouse_up_which");a.Da=!0;break;case 60:c=b(a.element);y(c,"touch_start");y(c,"touch_move");y(c,"touch_end");a.Da=!0;break;case 70:c=b(a.element);y(c,"touch_start");y(c,"touch_move");a.Da=!0;break;case 75:c=b(a.element);y(c,"touch_start");y(c,"touch_move");a.Da=!0;break;case 80:c=b(a.element);y(c,"touch_start");y(c,"touch_end");a.Da=!0;break;case 170:c=b(a.element);y(c,"mouse_select");y(c,"touch_select");y(c,"touch_start");y(c,"touch_end");
y(c,"mouse_down_which");y(c,"mouse_up_which");a.Da=!0;break;case 180:case 190:c=b(a.element);y(c,"orientation_angles");a.Da=!0;break;case 200:c=b(a.element);y(c,"orientation_quat");a.Da=!0;break;case 210:case 220:a.Da=!0}}function f(a){var c=a[0],b=a[1];a=c.clientX-b.clientX;c=c.clientY-b.clientY;return Math.sqrt(a*a+c*c)}function r(a){return 0==a?x.da(x.qp):1==a?x.da(x.At):2==a?x.da(x.Bt):x.da(x.Ct)}var l=n("__config"),A=n("__container"),x=n("__input"),L=n("__objects"),M=n("__print"),F=n("__physics"),
J=n("__quat"),C=n("__time"),H=n("__tsr"),K=n("__util"),d=n("__vec3");n("__vec4");var h=l.controls,v=l.v,P=[],c={},p=[],N=[],G=[],u=new Float32Array(2),z=new Float32Array(2),q=d.create();J.create();var D=!1,I=0;a.Bg=10;a.Ua=20;a.xt=30;a.mf=40;a.Ag=50;a.wt=60;a.Lp=0;a.Kp=1;a.Jp=2;a.zu=3;a.update=function(e,f){for(var h=0;h<p.length;h++){var l=p[h],k=e,q=f;if(q)switch(l.type){case 120:var n=l.wi,t=H.q(n.g.i),n=H.B(n.g.i),A=d.dist(l.om,t),w=l.ZF;J.invert(l.ms,w);J.multiply(n,w,w);J.normalize(w,w);w=Math.abs(2*
Math.acos(w[3]));A/=q;l.cq=K.lc(A,l.cq,q,.3);l.ka[0]=A;A=w/q;l.bq=K.lc(A,l.bq,q,.3);l.ka[1]=A;l.cq>=l.threshold||l.bq>=l.qG?g(l,1):g(l,0);d.copy(t,l.om);J.copy(n,l.ms);l.Ce=k;break;case 130:n=l.wi;t=H.q(n.g.i);n=Math.abs(t[1]-l.om[1])/q;l.dq=K.lc(n,l.dq,q,.3);l.ka=n;l.dq>=l.threshold?g(l,1):g(l,0);d.copy(t,l.om);l.Ce=k;break;case 140:!l.Da&&0<=l.re&&k-l.Ce>=l.re&&(g(l,1),l.repeat?l.Ce=k:l.re=-l.re);break;case 150:l.Ce||(l.Ce=k);g(l,k-l.Ce);l.Ce=k;break;case 160:g(l,k);break;case 180:q=b(l.element);
l.ka[0]=q.ir-q.Lw;l.ka[1]=q.hr-q.Kw;l.ka[2]=q.gr-q.fr;break;case 190:q=b(l.element);l.ka[0]=q.ir;l.ka[1]=q.hr;l.ka[2]=q.gr;break;case 200:q=b(l.element);J.copy(q.cE,l.ka);break;case 210:k=x.da(x.td);x.Wh(k,x.Ep,l.ka);break;case 220:k=x.da(x.td);x.Wh(k,x.Fp,l.ka);break;case 240:k=r(l.sj);l.value=x.VO(k,l.key);break;case 250:k=r(l.sj);l.value=x.UO(k,l.key);break;case 230:g(l,l.callback());break;case 30:q=b(l.element);g(l,q.qt);break;case 40:q=b(l.element);if(!v.lr||q.kl)switch(k=q.xl-q.ux,t=q.yl-q.vx,
l.axis){case "X":g(l,k);l.ka=q.xl;break;case "Y":g(l,t);l.ka=q.yl;break;case "XY":n=Math.sqrt(k*k+t*t),g(l,n),l.ka[0]=q.xl,l.ka[1]=q.yl}break;case 50:q=b(l.element);g(l,q.kl);l.ka=q.which;break;case 170:q=b(l.element);l.iB&&!q.kl&&q.zr||q.ny!=l.wi?g(l,0):g(l,1);break;case 20:q=b(l.element);l.ka=q.bd[l.key];1==l.ka||q.bd[0]&&16==l.key?g(l,1):l.ka&&3!=l.ka||g(l,0);break;case 60:q=b(l.element);-1==q.Sd[1]&&-1==q.De[1]?(k=q.Sd[0]-q.Mf[0],t=q.De[0]-q.Nf[0],n=Math.sqrt(k*k+t*t),-1!=q.Mf[1]&&-1!=q.Nf[1]&&
(A=q.Sd[0]-q.Mf[1],q=q.De[0]-q.Nf[1],w=Math.sqrt(A*A+q*q),w<n&&(k=A,t=q,n=w)),l.ka=a.Lp):(t=u,t[0]=(q.Sd[0]+q.Sd[1])/2,t[1]=(q.De[0]+q.De[1])/2,n=z,n[0]=(q.Mf[0]+q.Mf[1])/2,n[1]=(q.Nf[0]+q.Nf[1])/2,k=t[0]-n[0],t=t[1]-n[1],n=Math.sqrt(k*k+t*t),l.ka=a.Jp);switch(l.axis){case "X":g(l,k);break;case "Y":g(l,t);break;case "XY":g(l,n)}break;case 70:q=b(l.element);k=q.Zs-q.jz;l.ka=a.Kp;g(l,k);break;case 75:q=b(l.element);-1!=q.Sd[1]&&(k=Math.atan2(q.De[0]-q.De[1],q.Sd[0]-q.Sd[1]),l.ka=a.zu,g(l,k-q.NH));break;
case 80:q=b(l.element),q.zr?g(l,0):g(l,1)}}for(h=0;h<P.length;h++)for(q=P[h],l=q.$j,k=0;k<l.length;k++)if(t=l[k],t.VH!=I){t.VH=I;w=t;n=0;switch(w.type){case a.Bg:n=(A=B(w))?1:0;break;case a.Ua:n=w.ah;(A=B(w))?(n=1,w.ah=1):1==n?(n=-1,w.ah=-1):n=0;break;case a.xt:n=w.ah;(A=B(w))&&-1==n?(n=1,w.ah=1):A||1!=n?n=0:(n=-1,w.ah=-1);break;case a.mf:n=w.ah;(A=B(w))&&-1==n?(n=1,w.ah=1):A||1!=n?n=0:(n=0,w.ah=-1);break;case a.Ag:A=B(w);w.OE!=A?(n=1,w.OE=A):n=0;break;case a.wt:for(var A=w.pi,w=w.SP,y=0;y<A.length;y++){var C=
A[y].value;n||C==w[y]||(n=1);w[y]=C}break;default:K.l("Wrong sensor manifold type: "+w.type)}if(n&&(A=q==c?null:q,D=!1,t.callback(A,t.id,n,t.QL),D)){h=-1;break}}for(h=0;h<P.length;h++)for(q=P[h],l=q.$j,k=0;k<l.length;k++)for(t=l[k],q=t.pi,t=0;t<q.length;t++)switch(n=q[t],n.type){case 30:g(n,0);break;case 40:g(n,0);break;case 60:g(n,0);break;case 70:g(n,0);break;case 75:g(n,0);break;case 80:g(n,0);break;case 140:g(n,0)}for(h=0;h<G.length;h++){l=G[h];if(!l.pl){for(k=0;k<l.bd.length;k++)1==l.bd[k]?l.bd[k]=
2:3==l.bd[k]&&(l.bd[k]=0);l.pl=!0}l.qt=0;l.ux=l.xl;l.vx=l.yl;l.bd[0]=!1;l.Mf.set(l.Sd);l.Nf.set(l.De);l.jz=l.Zs;l.Lw=l.ir;l.Kw=l.hr;l.fr=l.gr;l.Zw=!1}I++};a.Ev=function(a){var c=k(10);g(c,a);return c};a.dc=function(a){var c=k(20,document);c.key=a;c.Da=!0;return c};a.zq=function(a,c){var b=k(240,document);c=c||x.tD();b.sj=c;b.key=a;b.Da=!0;return b};a.Jk=function(a,c){var b=k(250,document);c=void 0==c?x.tD():c;b.sj=c;b.key=a;b.Da=!0;return b};a.Dv=function(a,c,b){if(!a||!F.ea(a))return M.error("Wrong collision object"),
null;var d=k(90);d.wv=a;d.pb=c;d.Xf=b;d.ka={coll_obj:null,coll_pos:b?new Float32Array(3):null,coll_norm:b?new Float32Array(3):null,coll_dist:0};d.vv=function(a,c,b,e,f){g(d,a);a=d.ka;a.coll_obj=c;d.Xf&&(a.coll_pos.set(b),a.coll_norm.set(e),a.coll_dist=f)};d.Da=!0;return d};a.ZB=function(a){if(!a||!a.r)return M.error("Wrong collision impulse object"),null;var c=k(100);c.uv=a;c.PB=function(a){g(c,a)};c.Da=!0;return c};a.fC=function(a,c,b,d,e,f,h){var l=k(110);l.wi=a;l.from=c;l.to=b;l.pb=d;l.tE=e;l.Xf=
f;l.mr=h;l.ka={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Eo:0};l.fG=function(a,c,b,d,e,f){l.tE?g(l,-1==c?0:1):g(l,c);l.ka.hit_fract=c;l.ka.obj_hit=b;l.ka.hit_time=d;l.Xf&&(l.ka.hit_pos.set(e),l.ka.hit_norm.set(f))};l.Da=!0;return l};a.on=function(a){a=k(50,a);a.Da=!0;return a};a.Hv=function(a){a=k(30,a);a.Da=!0;return a};a.Lk=function(a,c){var b=k(40,c);b.axis=a||"XY";b.ka="XY"==b.axis?new Float32Array(2):0;b.Da=!0;return b};a.Bq=function(a,c){var b=
k(60,c);b.axis=a||"XY";b.ka=0;b.Da=!0;return b};a.Jv=function(a){a=k(70,a);a.ka=0;a.Da=!0;return a};a.jC=function(a){a=k(75,a);a.ka=0;a.Da=!0;return a};a.iC=function(a){a=k(80,a);a.ka=0;a.Da=!0;return a};a.eC=function(a,c,b){if(!a)return M.error("Wrong collision object"),null;var d=k(120);d.wi=a;var e=H.q(a.g.i);a=H.B(a.g.i);d.ZF=new Float32Array(4);d.om=new Float32Array(e);d.ms=new Float32Array(a);d.cq=0;d.bq=0;d.threshold=c||.1;d.qG=b||.1;d.Ce=0;d.ka=new Float32Array([0,0]);return d};a.kC=function(a,
c){if(!a)return M.error("Wrong collision object"),null;var b=k(130);b.wi=a;var d=H.B(a.g.i);b.om=new Float32Array(H.q(a.g.i));b.ms=new Float32Array(d);b.dq=0;b.threshold=c||1;b.Ce=0;b.ka=0;return b};a.hC=function(a,c){var b=k(140);b.re=a;b.repeat=c;b.Da=!0;return b};a.lG=function(a,b,d,e){a=a||c;a=a.Kf;if(!a||!a[b])return M.error("reset_timer_sensor(): wrong object"),null;b=a[b].pi[d];if(!b)return M.error("reset_timer_sensor(): sensor not found"),null;b.Ce=C.Xn();b.re=e};a.yq=function(){var a=k(150);
a.Ce=0;return a};a.aC=function(){var a=k(180,window);a.ka=new Float32Array(3);x.da(x.Tf)?g(a,1):g(a,0);a.Da=!0;return a};a.$B=function(){var a=k(190,window);a.ka=new Float32Array(3);x.da(x.Tf)?g(a,1):g(a,0);a.Da=!0;return a};a.bC=function(){var a=k(200,window);a.ka=J.create();x.da(x.Tf)?g(a,1):g(a,0);a.Da=!0;return a};a.dC=function(){var a=k(210,window);a.ka=J.create();x.da(x.td)?g(a,1):g(a,0);a.Da=!0;return a};a.cC=function(){var a=k(220,window);a.ka=d.create();x.da(x.td)?g(a,1):g(a,0);a.Da=!0;return a};
a.gC=function(){return k(160)};a.Aq=function(a,c){var b=k(170);b.wi=a;b.iB=c;b.Da=!0;return b};a.Cv=function(a,c){var b=k(230);b.callback=a;g(b,c);return b};a.GR=g;a.Xe=function(a,b,d){a=a||c;a=a.Kf;if(!a||!a[b])return M.error("get_sensor_value(): wrong object"),null;b=a[b].pi[d];return b?b.value:(M.error("get_sensor_value(): sensor not found"),null)};a.fg=function(a,b,d){a=a||c;a=a.Kf;if(!a||!a[b])return M.error("get_sensor_payload(): wrong object"),null;b=a[b].pi[d];return b?b.ka:(M.error("get_sensor_payload(): sensor not found"),
null)};a.ha=function(){P=[];c={};for(var a=0;a<p.length;a++)t(p[a]);p.length=0;N.length=0};a.lq=function(a,b){a=a||c;if(!a.Kf)return!1;if(b&&a.Kf[b])return!0;if(!b)for(var d in a.Kf)return!0;return!1};a.ja=function(a,d,f,h,g,l,k){a=a||c;a.$j=a.$j||[];a.Kf=a.Kf||{};var v=a.Kf,q=a.$j;v[d]&&w(a,d);f={id:d,type:f,pi:h.slice(0),nQ:g,HR:Array(h.length),callback:l,QL:k,ah:-1,OE:0,SP:Array(h.length),VH:-1};v[d]=f;q.push(f);-1==P.indexOf(a)&&P.push(a);h=f.pi;for(a=0;a<h.length;a++){v=d=h[a];if(v.Da){switch(v.type){case 90:F.Ou(v.wv,
v.pb,v.vv,v.Xf);break;case 100:F.Qu(v.uv,v.PB);break;case 110:v.Eo=F.Yp(v.wi,v.from,v.to,v.pb,v.fG,!1,!1,v.Xf,v.mr);v.ka.Eo=v.Eo;break;case 140:v.Ce=C.Xn();0>v.re&&(v.re=-v.re);break;case 20:q=b(v.element);e(q,"keyboard_downed_keys");break;case 30:q=b(v.element);e(q,"mouse_wheel");break;case 40:q=b(v.element);e(q,"mouse_down_which");e(q,"mouse_up_which");e(q,"mouse_location");break;case 50:q=b(v.element);e(q,"mouse_down_which");e(q,"mouse_up_which");break;case 60:q=b(v.element);e(q,"touch_start");
e(q,"touch_move");e(q,"touch_end");break;case 70:q=b(v.element);e(q,"touch_start");e(q,"touch_move");break;case 75:q=b(v.element);e(q,"touch_start");e(q,"touch_move");break;case 80:q=b(v.element);e(q,"touch_start");e(q,"touch_end");break;case 170:q=b(v.element);e(q,"mouse_select");e(q,"touch_select");e(q,"touch_start");e(q,"touch_end");e(q,"mouse_down_which");e(q,"mouse_up_which");break;case 180:case 190:q=b(v.element);e(q,"orientation_angles");break;case 200:q=b(v.element);e(q,"orientation_quat");
break;case 240:0==v.sj?x.da(x.qp):1==v.sj?x.da(x.At):2==v.sj?x.da(x.Bt):x.da(x.Ct)}v.Da=!1}v=p.indexOf(d);-1==v?(p.push(d),N.push([f])):N[v].push(f)}D=!0};a.uC=function(a){for(var c=0;c<a.length;c++)if(!a[c])return a[c];return a[a.length-1]};a.vC=function(a){for(var c=0;c<a.length;c++)if(a[c])return a[c];return a[a.length-1]};a.Ko=w;a.reset=function(){for(var a=0;a<P.length;a++){var c=P[a],b=c.Kf,c=c.$j,d;for(d in b)delete b[d];c.length=0}for(a=0;a<p.length;a++)t(p[a]);P.length=0;p.length=0;N.length=
0};a.debug=function(){M.log(String(P.length)+" objects with manifolds",P);M.log(String(p.length)+" sensors",p);for(var a=[],c=[],b=0;b<p.length;b++){var d=p[b];90==d.type&&a.push(d);110==d.type&&c.push(d)}M.log(String(a.length)+" collision sensors",a);M.log(String(c.length)+" ray sensors",c)}};b4w.module.__loader=function(a,n){function k(e,f,d,h){var g=C,k=M.create(),c;for(c in f){var p=b(f[c]);(h&&p.Qb||!e&&p.ic)&&l(p);M.C(k,p)}for(c in f)for(p=f[c],p.name=c,e=0;e<p.L.length;e++)M.m(k,f[p.L[e]],p,null);f=b({name:"out",Ab:a.LI,Vb:function(a,c,b,d,e){c.gb&&(g.Ty=!0);L(c)||(c.status=2);c.XE(c.id,!0);e(c,b);F.log("%cTHREAD "+c.id+": LOADED CALLBACK","color: #f0f;")},Sb:5});if(d)d=M.Wn(k);else{c=M.clone(k);do{d=M.Wn(c);p=[];for(e=0;e<d.length;e++){h=d[e];var r=M.Ra(c,h);r.Lb&&p.push(h)}for(e=
0;e<p.length;e++)M.Jf(c,p[e]);p.length&&M.rv(c)}while(p.length)}M.C(k,f);for(e=0;e<d.length;e++)h=d[e],r=M.Ra(k,h),f.L.push(r.name),M.m(k,r,f,null);return k}function b(a){a.Lb=a.Lb||!1;a.Ab||0===a.Ab||(a.Ab=a.ud);a.L=a.L||[];a.Dj=a.Dj||!1;a.Ly=a.Ly||!1;a.Sb=a.Sb||0;a.Qb=a.Qb||!1;a.ic=a.ic||!1;a.status=0;a.T_=0;a.kx=0;a.Zm=a.Zm||null;return a}function e(a,b){for(var d=[],e=[],f=0;f<b.length;f++){var g=b[f];M.Ra(a.tg,g).Dj&&(M.Ai(a.tg,g,function(c){var e=!0;M.wg(a.tg,c,function(a,c){if(!c.Dj)return e=
!1,1});e&&-1==d.indexOf(c)&&-1==b.indexOf(c)&&d.push(c)}),e.push(f))}for(f=e.length-1;0<=f;f--)b.splice(e[f],1);return d}function y(a){function b(c,d){var e=M.Ra(a.tg,c),f=M.Ra(a.tg,d),h=f.Ab-e.Ab;0==h&&(h=e.Lb-f.Lb);return h}var d=[],f=a.th,g=!1;do{var l=e(a,f);d.push.apply(d,f);0<l.length&&(g=!0);f=l}while(0<l.length);g&&d.sort(b);a.th=d;return a.th.length}function g(a,b,d){if(b.Ly)return b.Dj=!0,w(a,b),!1;if(!b.Vb&&!b.Mh&&!b.Ym)return w(a,b),!1;if(0==b.status&&(b.status++,b.Vb))return b.Vb(d,a,
b,b.Zm,w,t),!0;if(1==b.status){if(b.Mh)return b.Mh(d,a,b,b.Zm,w,t),!0;b.status++}return 2==b.status&&(b.status++,b.Ym)?(b.Ym(d,a,b,b.Zm,w,t),!0):!1}function B(a){if(0==a.Ts)return 100;var b=0;M.ma(a.tg,function(d,e){a.do_not_load_resources&&e.Qb||(b+=e.kx*e.Sb)});return J.trunc(100*b/a.Ts)}function w(a,b){b.Dj=!0;b.status=3;f(a,b,1)}function t(a,b,d){1>d?f(a,b,d):b.status++}function f(a,b,d){var e=C;if(b.Vb||b.Mh||b.Ym)if(b.kx=d,b=B(a),a.oC!=b||1==d)a.Sy(b,performance.now()-a.FH),a.oC=b,e.nx=!0}function r(a,
b){var d=null;M.ma(a.tg,function(a,e){if(e.name==b)return d=e,1});return d}function l(a){a.Ly=!0;a.kx=1}function A(a){a.Sy=null;a.xv=null;a.tg=null;a.th=null}function x(){return 0==C.Sp}function L(a){return a&&(3==a.status||4==a.status)}var M=n("__graph"),F=n("__print"),J=n("__util");a.ud=0;a.Li=1;a.LI=2;var C=null;a.KD=function(){return C};a.$M=function(){var a={vg:[],Pv:0,Sp:0,Ty:!1,nx:!1};return C=a};a.iN=function(a,b,d,e,f,g,c,l){var r=C,n=r.vg.length,t={id:n,gb:0==n,status:0,bg:b,mB:"",XE:d||
function(){},WE:l||!1,O2:g,FH:0,oC:0,Ts:0,gy:!1,Sy:e||function(){},xv:f||function(){},tg:null,th:null,Pw:!1,Nw:!1,Rw:!1};a=k(t.gb,a,g,c);t.tg=a;b=[];d=M.bP(a);for(e=0;e<d.length;e++)b.push(d[e]);t.th=b;M.ma(a,function(a,c){!(c.Vb||c.Mh||c.Ym)||t.do_not_load_resources&&c.Qb||(t.Ts+=c.Sb)});r.vg.push(t);r.Sp++;return t.id};a.QT=function(b){var e=C;if(e&&!x())if(e.nx)e.nx=!1;else{var d=performance.now();do{var f=e.vg[e.Pv],l=b[f.id];if(!L(f))if(0==f.status&&(f.status=1,f.FH=performance.now(),f.Sy(0,
0)),y(f)){var k=f,c=k.th.length;do{var p=M.Ra(k.tg,k.th[0]),r=g(k,p,l);p.Ab==a.Li&&(k.gy=!0);p=k.th.shift();k.th.push(p);c--}while(!r&&0!=c)}else k=e,c=f,c.xv(l,c),c.status=3,k.Sp--,A(c);e.Ty&&(e.Pv=(e.Pv+1)%e.vg.length);if(f.gy){f.gy=!1;break}}while(16>performance.now()-d)}};a.PA=function(a){var b=C;a.xv(null,a);a.status=3;b.Sp--;A(a);a.status=4;a.gb&&(b.Ty=!0);a.XE(a.id,!1)};a.U1=t;a.Os=function(a,b){var d=r(a,b);null!==d&&l(d)};a.Dj=x;a.gT=L;a.hg=function(a){var b=C;if(!b)return!1;a|=0;return b.vg[a]&&
(3==b.vg[a].status||2==b.vg[a].status)};a.jP=function(){F.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.ha=function(){C=null}};b4w.module.__md5=function(a){function n(a,g){var n=a[0],f=a[1],r=a[2],l=a[3],n=b(n,f,r,l,g[0],7,-680876936),l=b(l,n,f,r,g[1],12,-389564586),r=b(r,l,n,f,g[2],17,606105819),f=b(f,r,l,n,g[3],22,-1044525330),n=b(n,f,r,l,g[4],7,-176418897),l=b(l,n,f,r,g[5],12,1200080426),r=b(r,l,n,f,g[6],17,-1473231341),f=b(f,r,l,n,g[7],22,-45705983),n=b(n,f,r,l,g[8],7,1770035416),l=b(l,n,f,r,g[9],12,-1958414417),r=b(r,l,n,f,g[10],17,-42063),f=b(f,r,l,n,g[11],22,-1990404162),n=b(n,f,r,l,g[12],7,1804603682),l=b(l,n,f,r,
g[13],12,-40341101),r=b(r,l,n,f,g[14],17,-1502002290),f=b(f,r,l,n,g[15],22,1236535329),n=e(n,f,r,l,g[1],5,-165796510),l=e(l,n,f,r,g[6],9,-1069501632),r=e(r,l,n,f,g[11],14,643717713),f=e(f,r,l,n,g[0],20,-373897302),n=e(n,f,r,l,g[5],5,-701558691),l=e(l,n,f,r,g[10],9,38016083),r=e(r,l,n,f,g[15],14,-660478335),f=e(f,r,l,n,g[4],20,-405537848),n=e(n,f,r,l,g[9],5,568446438),l=e(l,n,f,r,g[14],9,-1019803690),r=e(r,l,n,f,g[3],14,-187363961),f=e(f,r,l,n,g[8],20,1163531501),n=e(n,f,r,l,g[13],5,-1444681467),l=
e(l,n,f,r,g[2],9,-51403784),r=e(r,l,n,f,g[7],14,1735328473),f=e(f,r,l,n,g[12],20,-1926607734),n=k(f^r^l,n,f,g[5],4,-378558),l=k(n^f^r,l,n,g[8],11,-2022574463),r=k(l^n^f,r,l,g[11],16,1839030562),f=k(r^l^n,f,r,g[14],23,-35309556),n=k(f^r^l,n,f,g[1],4,-1530992060),l=k(n^f^r,l,n,g[4],11,1272893353),r=k(l^n^f,r,l,g[7],16,-155497632),f=k(r^l^n,f,r,g[10],23,-1094730640),n=k(f^r^l,n,f,g[13],4,681279174),l=k(n^f^r,l,n,g[0],11,-358537222),r=k(l^n^f,r,l,g[3],16,-722521979),f=k(r^l^n,f,r,g[6],23,76029189),n=
k(f^r^l,n,f,g[9],4,-640364487),l=k(n^f^r,l,n,g[12],11,-421815835),r=k(l^n^f,r,l,g[15],16,530742520),f=k(r^l^n,f,r,g[2],23,-995338651),n=y(n,f,r,l,g[0],6,-198630844),l=y(l,n,f,r,g[7],10,1126891415),r=y(r,l,n,f,g[14],15,-1416354905),f=y(f,r,l,n,g[5],21,-57434055),n=y(n,f,r,l,g[12],6,1700485571),l=y(l,n,f,r,g[3],10,-1894986606),r=y(r,l,n,f,g[10],15,-1051523),f=y(f,r,l,n,g[1],21,-2054922799),n=y(n,f,r,l,g[8],6,1873313359),l=y(l,n,f,r,g[15],10,-30611744),r=y(r,l,n,f,g[6],15,-1560198380),f=y(f,r,l,n,g[13],
21,1309151649),n=y(n,f,r,l,g[4],6,-145523070),l=y(l,n,f,r,g[11],10,-1120210379),r=y(r,l,n,f,g[2],15,718787259),f=y(f,r,l,n,g[9],21,-343485551);a[0]=n+a[0]&4294967295;a[1]=f+a[1]&4294967295;a[2]=r+a[2]&4294967295;a[3]=l+a[3]&4294967295}function k(a,b,e,f,g,l){b=(b+a&4294967295)+(f+l&4294967295)&4294967295;return(b<<g|b>>>32-g)+e&4294967295}function b(a,b,e,f,g,l,n){return k(b&e|~b&f,a,b,g,l,n)}function e(a,b,e,f,g,l,n){return k(b&f|e&~f,a,b,g,l,n)}function y(a,b,e,f,g,l,n){return k(e^(b|~f),a,b,g,
l,n)}var g="0123456789abcdef".split("");a.oE=function(a){var b=a,e=b.length;a=[1732584193,-271733879,-1732584194,271733878];var f;for(f=64;f<=b.length;f+=64){for(var k=b.substring(f-64,f),l=[],A=void 0,A=0;64>A;A+=4)l[A>>2]=k.charCodeAt(A)+(k.charCodeAt(A+1)<<8)+(k.charCodeAt(A+2)<<16)+(k.charCodeAt(A+3)<<24);n(a,l)}b=b.substring(f-64);k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(f=0;f<b.length;f++)k[f>>2]|=b.charCodeAt(f)<<(f%4<<3);k[f>>2]|=128<<(f%4<<3);if(55<f)for(n(a,k),f=0;16>f;f++)k[f]=0;k[14]=8*
e;n(a,k);for(b=0;b<a.length;b++){e=a[b];f="";for(k=0;4>k;k++)f+=g[e>>8*k+4&15]+g[e>>8*k&15];a[b]=f}return a.join("")}};b4w.module.__logic_nodes=function(a,n){function k(){return function(a,c,b,d){b=d[0];var e=d[1];d=d[2];if(-2==b.state){for(var f=0;f<b.ts;f++)if(J.Xe(a,c,f))for(var h=0;h<b.ss.length;h++)if(b.ss[h]==f){e.Lj==b.BH?(M.$h(e.ga)&&(b.state=-1),d.Be.oe||(b.state=1,b.So=b.Gr[h])):(b.state=1,b.So=b.Gr[h]);return}b.state=0}}}function b(){return function(a,c,b,d){b=d[0];var e=d[1];d=d[2];for(var f=0;f<b.ts;f++)if(J.Xe(a,c,f)&&f==b.vG){if(M.$h(e.ga)&&e.Lj==b.BH)b.state=-1;else if(!d.Be.oe||b.T.no_wait)b.state=
1;return}b.state=0}}function e(a,c){return{name:a.name,type:a.type,label:a.label,xa:a.slot_idx_order,So:a.slot_idx_jump,pa:a.frame_range[0],La:a.frame_range[1],lO:a.frame_range_mask?a.frame_range_mask[0]:!0,jO:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,ts:-1,vG:-1,NQ:a.param_name,LQ:a.operation,Kj:a.mute,Bn:a.object,Ca:null,xb:null,Fb:null,qb:{},Me:a.anim_name,Kb:H.yc,PQ:a.parse_json_vars,OQ:a.parse_json_paths,Mc:a.objects_paths,Cx:a.nodes_paths,Ob:a.floats,T:a.bools,Y:a.variables,uh:a.strings,
ox:a.materials_names,ZG:a.shader_nd_type,ee:a.common_usage_names,QN:a.encode_json_vars,PN:a.encode_json_paths,BH:c,VF:Z[a.type]?Z[a.type]:w,ls:!1,Ys:0,ss:null,eQ:a.links,Gr:[]}}function y(a,c,b){return a[0]?c[a[1]]:b[a[1]]}function g(a,c,b,d){a[0]?c[a[1]]=d:b[a[1]]=d}function B(a,c,b){switch(c.state){case 2:b.Z=a.xa}}function w(a,c,b){switch(c.state){case 1:L.error("Unknown node type: "+a.type);break;case 2:b.Z=a.xa}}function t(a){return A.gc(A.Hc,a.Bn||[],0)}function f(a,c){var b=a.b4w_logic_nodes,
d=c.dd;c.state=1;for(var f=0;f<b.length;f++){var h={K:[],Be:{Ta:a,Z:0,oe:!1,gz:f,s:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};d.push(h);for(var g=d[d.length-1],l=b[f],m=0;m<l.length;m++){var k=e(l[m],g);g.K.push(k)}for(l=0;l<g.K.length;l++)k=g.K[l],k.VF(k,c,h.Be,0,0)}var b=a.timeline_markers,p;for(p in b)c.To.push(b[p]);c.To.sort(function(a,c){return a-c});c.state=2;I.push(c)}function r(a,c){switch(c){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}function l(a){switch(typeof a){case "string":return r(a,
1);case "number":return r(a,0);default:return r(a,1)}}var A=n("__objects"),x=n("__scenes"),L=n("__print"),M=n("__nla"),F=n("__config"),J=n("__controls"),C=n("__util"),H=n("__animation"),K=n("__assets"),d=n("__batch"),h=n("__geometry"),v=n("__time"),P=n("__camera"),c=n("__vec3"),p=n("__physics"),N=n("__transform"),G=n("__sfx"),u=n("__mat3"),z=n("__mat4"),q=n("__tsr"),D=n("__quat"),I=[],m={},V=new Float32Array(4);new Float32Array(4);var Q=new Float32Array(3),R=new Float32Array(3),X=new Float32Array(2),
ja=new Float32Array(9),W=new Float32Array(16);a.rJ=0;a.sJ=1;a.fA=0;a.hA=1;a.gA=2;a.iA=3;a.jA=4;a.eA=5;a.pJ=0;a.qJ=1;var Z={ENTRYPOINT:function(a,c,b){switch(c.state){case 2:b.Z=a.xa}},HIDE:function(a,c,b){switch(c.state){case 1:a.Ca=t(a);break;case 2:x.$m(a.Ca,!0),b.Z=a.xa}},SHOW:function(a,c,b){switch(c.state){case 1:a.Ca=t(a);break;case 2:x.$m(a.Ca,!1),b.Z=a.xa}},PAGEPARAM:function(a,c,b){switch(c.state){case 2:var d=a.Y.vd;c=c.s;var e=b.s,f;a:{f=a.NQ;var h=a.Ob.ptp,l=a.T.hsh,m=F.get("url_params");
if(m&&f in m)f=Number(m[f]);else{if(l=l?location.hash:location.search)for(l=l.slice(1).split("&"),m=0;m<l.length;m++){var k=l[m].split("=");if(1<k.length&&k[0]==f){f=r(k[1],h);break a}}f=0}}g(d,c,e,f);b.Z=a.xa}},SWITCH_SELECT:function(a,c,b){switch(c.state){case 1:a:{b=c.dd[b.gz];var d=A.LD();a.ss=[];a.Gr=[];for(var e in a.Mc){var f=A.gc(A.Hc,a.Mc[e],0),h=d.indexOf(f);if(-1==h){L.error("logic script error: non-selectable object:",a.Mc[e][a.Mc[e].length-1]);break a}a.ss.push(h);a.Gr.push(a.eQ[e])}a.state=
-1;a.ts=d.length;e=[];for(h=0;h<d.length;h++)e.push(J.Aq(d[h],!0));J.ja(f,"LOGIC_NODES_SWITCH_SELECT_"+a.label,J.mf,e,J.vC,k(),[a,c,b])}break;case 2:if(-1==a.state){c=c.dd[b.gz].K;for(f=0;f<c.length;f++)d=c[f],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}-1<a.state&&(b.Z=a.state?a.So:a.xa,a.state=-1)}},SELECT:function(a,c,d){switch(c.state){case 1:d=c.dd[d.gz];var e=t(a),f=A.LD(),h=f.indexOf(e);if(-1==h)L.error("logic script error: non-selectable object:",a.Bn[a.Bn.length-1]);else{a.state=-1;
a.ts=f.length;a.vG=h;for(var h=[],g=0;g<f.length;g++)h.push(J.Aq(f[g],!0));J.ja(e,"LOGIC_NODES_SELECT_"+a.label,J.mf,h,J.vC,b(),[a,c,d])}break;case 2:if(-1<a.state){d.Z=a.state?a.So:a.xa;a.state=-1;break}a.T.not_wait&&(d.Z=a.xa)}},PLAY:function(a,c,b,d){switch(c.state){case 1:M.oH();a.state=-1;a.T.not_wait||(a.T.not_wait=!1);break;case 2:switch(a.state){case -1:if(M.$h(c.ga))if(c.Nv==c.Lj&&b.oe)break;else{var e=c.Lj;if(e){e.Be.Z=e.K[e.Be.Z].xa;e.K[e.Be.Z].state=-1;for(var e=c.Lj.K,f=0;f<e.length;f++){var h=
e[f];"PLAY"==h.type&&(h.state=-1)}}}b.oe=!a.T.not_wait;c.Lj=c.Nv;a.state=0;a.lO&&(M.hS(a.pa),M.JG(d));if(a.jO)M.By(a.La);else{d=M.Vn(d);var e=-1,g;for(g in c.To)if(d<c.To[g]){e=g;break}0<=e?M.By(c.To[e]):M.By(M.vD())}M.ZQ();a.T.not_wait&&(b.Z=a.xa,a.state=-1,b.oe=!1);break;case 0:M.$h()||(b.Z=a.xa,a.state=-1,b.oe=!1);break;case 1:b.Z=a.xa;a.state=-1;c.Lj=null;b.oe=!1;break;default:C.l("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,c,b){switch(c.state){case 2:window.location.href=a.T.url?
r(y(a.Y.url,c.s,b.s),1):a.uh.url,c.state=3}},MATH:function(a,c,b){switch(c.state){case 2:var d=-1==a.Y.v1[1]?a.Ob.inp1:r(y(a.Y.v1,c.s,b.s),0),e=-1==a.Y.v2[1]?a.Ob.inp2:r(y(a.Y.v2,c.s,b.s),0),f=0;switch(a.LQ){case "ADD":f=d+e;break;case "MUL":f=d*e;break;case "SUB":f=d-e;break;case "DIV":0==e&&C.l("Division by zero in Logic script");f=d/e;break;case "RAND":f=Math.random()*(e-d)+d}g(a.Y.vd,c.s,b.s,f);b.Z=a.xa}},CONDJUMP:function(a,c,b){switch(c.state){case 2:var d=a.T.str?1:0,e=a.T.str?a.uh:a.Ob,f=
-1==a.Y.v1[1]?e.inp1:r(y(a.Y.v1,c.s,b.s),d);c=-1==a.Y.v2[1]?e.inp2:r(y(a.Y.v2,c.s,b.s),d);d=!1;switch(a.ee.condition){case 5:f==c&&(d=!0);break;case 4:f!=c&&(d=!0);break;case 3:f<c&&(d=!0);break;case 2:f>c&&(d=!0);break;case 1:f<=c&&(d=!0);break;case 0:f>=c&&(d=!0)}b.Z=d?a.So:a.xa}},REGSTORE:function(a,c,b){switch(c.state){case 2:g([a.T.gl||a.Y.vd[0],a.Y.vd[1]],c.s,b.s,(1==a.ee.variable_type?a.uh:a.Ob).inp1),b.Z=a.xa}},PLAY_ANIM:function(a,c,b){switch(c.state){case 1:a.Ca=a.T.env?A.cr(a.Bn[0],0):
t(a);break;case 2:switch(0!=a.state||H.$h(a.Ca,a.Kb)||(a.state=1),a.state){case -1:for(var d in c.dd){var e=c.dd[d].Be.Z;-1!=e&&(e=c.dd[d].K[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.Ca==a.Ca&&(e.state=1))}c=a.ee.param_anim_behavior;if(""==a.Me)H.Zp(a.Ca),H.Qo(a.Ca,c,a.Kb);else{a:{for(e=d=0;8>e;e++){var f=a.Ca.W[e];if(f&&f.Eg&&f.Eg==a.Me)if(0==d)d=1;else{d=!1;break a}}d=1==d?!0:!1}d||(a.Kb=H.FS(a.Ca,a.Me),H.apply(a.Ca,a.Me,a.Kb),H.Qo(a.Ca,c,a.Kb))}a.T.not_wait||(b.oe=!0);H.play(a.Ca,null,a.Kb);
a.state=0;a.T.not_wait&&(b.Z=a.xa,a.state=-1);break;case 0:break;case 1:a.T.not_wait||(b.oe=!1);b.Z=a.xa;a.state=-1;break;default:C.l("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:B,SEND_REQ:function(a,c,b){function d(a,e,f,h,l){a=JSON.stringify(a);g(l[0].Y.dst,c.s,b.s,a);l[0].state=1}switch(c.state){case 2:switch(a.state){case -1:a.state=0;var e=a.T.url?r(y(a.Y.url,c.s,b.s),1):a.uh.url,f={};a.T.ct&&(f["Content-Type"]=a.uh.ct);"GET"==a.ee.request_type?K.cd([{id:e,type:K.pk,url:e,hi:f,Hb:[a,
b.s]}],d,null,null,null):"POST"==a.ee.request_type&&K.cd([{id:e,type:K.pk,url:e,hi:f,qg:"POST",Ol:K.pk,Wj:r(y(a.Y.dst1,c.s,b.s),1),Hb:[a,b.s]}],d,null,null,null);break;case 1:a.state=-1,b.Z=a.xa}}},INHERIT_MAT:function(a,c,b){switch(c.state){case 1:for(c=0;2>c;c++)a.qb["id"+c]=A.gc(A.Hc,a.Mc["id"+c],0);break;case 2:d.wP(a.qb.id0,a.ox.id0,a.qb.id1,a.ox.id1),b.Z=a.xa}},SET_SHADER_NODE_PARAM:function(a,c,b){switch(c.state){case 1:a.Mc.id0&&(a.qb.id0=A.gc(A.Hc,a.Mc.id0,0),a.Cx.id0.unshift(a.ox.id0));
break;case 2:"ShaderNodeRGB"==a.ZG&&d.dS(a.qb.id0,a.Cx.id0,a.T.id0?r(y(a.Y.id0,c.s,b.s),0):a.Ob.id0,a.T.id1?r(y(a.Y.id1,c.s,b.s),0):a.Ob.id1,a.T.id2?r(y(a.Y.id2,c.s,b.s),0):a.Ob.id2),"ShaderNodeValue"==a.ZG&&d.eS(a.qb.id0,a.Cx.id0,a.T.id0?r(y(a.Y.id0,c.s,b.s),0):a.Ob.id0),b.Z=a.xa}},DELAY:function(a,c,b,d,e){switch(c.state){case 2:-1==a.state?(a.state=0,a.Ys=0,b.oe=!0):0==a.state&&(a.Ys+=e,(a.T.dl?r(y(a.Y.dl,c.s,b.s),0):a.Ob.dl)<a.Ys&&(a.state=-1,b.Z=a.xa,b.oe=!1))}},APPLY_SHAPE_KEY:function(a,c,
b){switch(c.state){case 1:c=a.qb.id0=A.gc(A.Hc,a.Mc.id0,0);b=a.ee.sk;h.mM(c)?h.oP(c,b)||(L.error("Wrong key name:",b),a.Kj=!0):(L.error("No shape keys in object:",c.name),a.Kj=!0);break;case 2:h.gL(a.qb.id0,a.ee.sk,a.T.skv?r(y(a.Y.skv,c.s,b.s),0):a.Ob.skv),b.Z=a.xa}},OUTLINE:function(a,c,b){switch(c.state){case 1:var d=a.qb.id0=A.gc(A.Hc,a.Mc.id0,0);d&&d.g&&d.g.hc||(L.error("Can't evaluate 'Outline' logic node: wrong object"),a.Kj=!0);break;case 2:d=a.qb.id0;switch(a.ee.outline_operation){case "PLAY":c=
d.g.Hl;A.Ck(d,c.Il,c.Jl,c.Kl);break;case "STOP":A.nq(d);break;case "INTENSITY":d.g.kh=a.T["in"]?r(y(a.Y["in"],c.s,b.s),0):a.Ob["in"]}b.Z=a.xa}},MOVE_CAMERA:function(a,b,d){function e(a,b,d,f){switch(P.Uh(a)){case P.bb:P.Ro(a,b,d);break;case P.wc:case P.Uf:N.rh(a,f);break;case P.xc:c.sub(d,b,Q),c.normalize(Q,Q),P.Bs(a,d),d=b=0,R[0]=Q[0],R[1]=0,R[2]=Q[2],b=c.dot(R,Q),d=Math.acos(b/(c.length(R)*c.length(Q))),b=Q[2]?Math.atan(Q[0]/Q[2]):0<Q[0]?0:Math.PI,0<Q[2]&&0<Q[0]?X[1]=-(Math.PI+X[1]):0<Q[2]&&0>Q[0]?
X[1]=-(Math.PI+X[1]):0>Q[2]&&0>Q[0]?(X[0]+=Math.PI,b=-(Math.PI-b)):0>Q[2]&&0<Q[0]&&(X[0]+=Math.PI,b-=Math.PI),P.No(a,b+Math.PI,-d,!0,!0)}N.o(a);p.u(a)}function f(a,c,b,d){z.lookAt(c,b,C.uc,W);z.invert(W,W);z.rotateX(W,Math.PI/2,W);u.fromMat4(W,ja);D.fromMat3(ja,V);D.normalize(V,V);q.qh(c,q.Oc(a.g.i),V,d)}switch(b.state){case 1:a.qb.ca=A.gc(A.Hc,a.Mc.id0,0);a.qb.tr=A.gc(A.Hc,a.Mc.id1,0);a.qb.ta=A.gc(A.Hc,a.Mc.id2,0);a.state=-1;a.Fb={PH:new Float32Array(3),OH:new Float32Array(3),Ww:new Float32Array(3),
dz:new Float32Array(3),zH:new Float32Array(3),Vw:new Float32Array(3),Ci:new Float32Array(8),xg:new Float32Array(8),co:new Float32Array(8)};break;case 2:var h=a.qb.ca,g=q.q(a.qb.tr.g.i),l=q.q(a.qb.ta.g.i);switch(a.state){case -1:b=a.T.dur?r(y(a.Y.dur,b.s,d.s),0):a.Ob.dur;if(0==b){f(h,g,l,a.Fb.xg);e(h,g,l,a.Fb.xg);d.Z=a.xa;break}c.copy(q.q(h.g.i),a.Fb.PH);var m=P.Uh(h);m==P.xc?c.copy(h.g.wb,a.Fb.dz):m==P.Uf||m==P.wc?(q.copy(h.g.i,a.Fb.Ci),f(h,g,l,a.Fb.xg)):c.copy(h.g.pivot,a.Fb.dz);c.copy(g,a.Fb.OH);
c.copy(l,a.Fb.zH);a.state=0;var k=v.yk(0,1,1E3*b,function(b){x.za()&&(m==P.Uf||m==P.wc?q.Xw(a.Fb.Ci,a.Fb.xg,C.dk(b),a.Fb.co):(a.Fb.Vw=c.lerp(a.Fb.dz,a.Fb.zH,C.dk(b),a.Fb.Vw),a.Fb.Ww=c.lerp(a.Fb.PH,a.Fb.OH,C.dk(b),a.Fb.Ww)),e(h,a.Fb.Ww,a.Fb.Vw,a.Fb.co),1==b&&(a.state=1))});break;case 1:v.mq(k),a.state=-1,d.Z=a.xa}}},SET_CAMERA_MOVE_STYLE:function(a,c,b){switch(c.state){case 2:c=x.bl(b.Ta),N.o(c),p.u(c),b.Z=a.xa}},MOVE_TO:function(a,c,b){function d(a,c){N.rh(a,c);N.o(a);p.u(a)}switch(c.state){case 1:a.qb.ob=
A.gc(A.Hc,a.Mc.id0,0);a.qb.de=A.gc(A.Hc,a.Mc.id1,0);a.state=-1;a.xb={zC:new Float32Array(8),Wv:new Float32Array(8),sE:new Float32Array(8)};break;case 2:var e=a.qb.ob;q.copy(a.qb.ob.g.i,a.xb.zC);q.copy(a.qb.de.g.i,a.xb.Wv);switch(a.state){case -1:c=a.T.dur?r(y(a.Y.dur,c.s,b.s),0):a.Ob.dur;if(0==c){d(e,a.xb.Wv);b.Z=a.xa;break}a.state=0;var f=v.yk(0,1,1E3*c,function(c){x.za()&&(a.xb.w_=q.Xw(a.xb.zC,a.xb.Wv,C.dk(c),a.xb.sE),d(e,a.xb.sE),1==c&&(a.state=1))});break;case 1:v.mq(f),a.state=-1,b.Z=a.xa}}},
TRANSFORM_OBJECT:function(a,c,b){function d(a,c,b){0==b?N.rh(a,c):N.Gs(a,c);N.o(a);p.u(a)}switch(c.state){case 1:a.qb.ob=A.gc(A.Hc,a.Mc.id0,0);a.state=-1;a.xb={Qs:0,Ci:new Float32Array(8),xg:new Float32Array(8),co:new Float32Array(8)};break;case 2:var e=a.qb.ob;switch(a.state){case -1:R[0]=a.T.trx?r(y(a.Y.trx,c.s,b.s),0):a.Ob.trx;R[1]=a.T["try"]?r(y(a.Y["try"],c.s,b.s),0):a.Ob["try"];R[2]=a.T.trz?r(y(a.Y.trz,c.s,b.s),0):a.Ob.trz;Q[0]=a.T.rox?r(y(a.Y.rox,c.s,b.s),0):a.Ob.rox;Q[1]=a.T.roy?r(y(a.Y.roy,
c.s,b.s),0):a.Ob.roy;Q[2]=a.T.roz?r(y(a.Y.roz,c.s,b.s),0):a.Ob.roz;var f=a.T.sc?y(a.Y.sc,c.s,b.s):a.Ob.sc;if(a.T["try"]||a.T.trz)X[1]=-R[1],R[1]=R[2],R[2]=X[1];if(a.T.roy||a.T.roz)X[1]=-Q[1],Q[1]=Q[2],Q[2]=X[1];C.Sh(Q,V);q.qh(R,f,V,a.xb.xg);a.xb.Qs=a.ee.space_type;switch(a.xb.Qs){case 0:N.Yn(e,a.xb.Ci);break;case 1:N.Zn(e,a.xb.Ci);break;case 2:N.Zn(e,a.xb.Ci),q.multiply(a.xb.Ci,a.xb.xg,a.xb.xg)}c=a.T.dur?r(y(a.Y.dur,c.s,b.s),0):a.Ob.dur;if(0==c){d(e,a.xb.xg,a.xb.Qs);b.Z=a.xa;break}a.state=0;f=v.yk(0,
1,1E3*c,function(c){x.za()&&(q.Xw(a.xb.Ci,a.xb.xg,C.dk(c),a.xb.co),d(e,a.xb.co,a.xb.Qs),1==c&&(a.state=1))});break;case 1:v.mq(f),a.state=-1,b.Z=a.xa}}},SPEAKER_PLAY:function(a,c,b){switch(c.state){case 1:a.Ca=A.gc(A.Hc,a.Mc.id0,0);void 0==a.T.not_wait&&(a.T.not_wait=!0);break;case 2:switch(G.LP(a.Ca)||0!=a.state||(a.state=1),a.state){case -1:for(var d in c.dd){var e=c.dd[d].Be.Z;-1!=e&&(e=c.dd[d].K[e],"SPEAKER_PLAY"==e.type&&e!=a&&0==e.state&&e.Ca==a.Ca&&(e.state=1))}a.T.not_wait||(b.oe=!0);G.OF(a.Ca);
a.state=0;break;case 0:a.T.not_wait&&(b.Z=a.xa,a.state=-1);break;case 1:a.T.not_wait||(b.oe=!1);b.Z=a.xa;a.state=-1;break;default:C.l("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,c,b){switch(c.state){case 1:a.Ca=A.gc(A.Hc,a.Mc.id0,0);break;case 2:G.stop(a.Ca),b.Z=a.xa}},STOP_ANIM:function(a,c,b){switch(c.state){case 1:a.Ca=a.T.env?A.cr(a.Bn[0],0):t(a);break;case 2:H.stop(a.Ca,H.Gm),a.T.rst&&H.wy(a.Ca,H.Gm),b.Z=a.xa}},STOP_TIMELINE:function(a,c,b,d){switch(c.state){case 2:a.T.rst&&
M.JG(d),M.oH(),b.Z=a.xa}},CONSOLE_PRINT:function(a,c,b){switch(c.state){case 2:var d={},e;for(e in a.Y)d[a.Y[e][1]]=y(a.Y[e],c.s,b.s);L.log(a.ee.msg,JSON.stringify(d));b.Z=a.xa}},STRING:function(a,c,b){switch(c.state){case 2:var d=a.T.id0?r(y(a.Y.id0,c.s,b.s),1):a.uh.id0,e=a.T.id1?r(y(a.Y.id1,c.s,b.s),1):a.uh.id1,f=0;switch(a.Ob.sop){case 0:f=d+e;break;case 1:f=d.indexOf(e);break;case 2:f=d.replace(e,a.T.id2?r(y(a.Y.id2,c.s,b.s),1):a.uh.id2);break;case 3:f=d.substring(0,d.indexOf(e));g(a.Y.dst1,c.s,
b.s,d.substring(d.indexOf(e)+1,d.length));""==y(vars.dst,c.s,b.s)&&(f=y(vars.dst1,c.s,b.s),g(vars.dst1,c.s,b.s,""));break;case 4:switch(a.ee.condition){case 5:f=d==e?1:0;break;case 4:f=d!=e?1:0;break;case 3:f=d<e?1:0;break;case 2:f=d>e?1:0;break;case 1:f=d<=e?1:0;break;case 0:f=d>=e?1:0}}g(a.Y.dst,c.s,b.s,f);b.Z=a.xa}},GET_TIMELINE:function(a,c,b,d){switch(c.state){case 2:d=a.T.nla?r(M.Vn(d),0):r(v.Vn(d),0),g(a.Y.vd,c.s,b.s,d),b.Z=a.xa}},JSON:function(a,c,b){function d(a,c,b,e){for(var f=0;f<c.length;f++){for(var h=
c[f].split("."),g=a,m=b[f],k=0;k<h.length&&(g=g[h[k]],void 0!==g&&null!==g);k++);g=l(g);e[m]=g}}function e(a,c,b,d){d||(d={});for(var f=0;f<c.length;f++){var h=c[f].split("."),g=d,m=b[f];if(!(!m in a)){for(var k=0;k<h.length-1;k++)void 0===g[h[k]]&&(g[h[k]]=isNaN(h[k+1])?{}:[]),g=g[h[k]];g[h[h.length-1]]=l(a[m])}}}switch(c.state){case 2:switch(a.ee.json_operation){case "PARSE":try{var f=JSON.parse(r(y(a.Y.jsn,c.s,b.s),1));d(f,a.OQ,a.PQ,b.s)}catch(h){L.error("logic script error: non valid JSON string")}break;
case "ENCODE":f={},e(b.s,a.PN,a.QN,f),f=r(JSON.stringify(f),1),g(a.Y.jsn,c.s,b.s,f)}b.Z=a.xa}},JS_CALLBACK:function(a,c,b){switch(c.state){case 2:for(var d=a.T.cb?r(y(a.Y.cb,c.s,b.s),1):a.uh.cb,e=[],f=0,h="id"+f,k=a.ee.js_cb_params;h in k;)h=0==k[h]?A.gc(A.Hc,a.Mc[h],0):y(a.Y[h],c.s,b.s),e.push(h),f++,h="id"+f;k=[];f=0;for(h="out"+f;h in a.Y;)h=y(a.Y[h],c.s,b.s),k.push(h),f++,h="out"+f;if(d in m)for(m[d](e,k),d=0;d<k.length;d++)h="out"+d,h in a.Y&&g(a.Y[h],c.s,b.s,l(k[d]));else L.error("logic script error: no custom callback with id "+
d);b.Z=a.xa}},EMPTY:B};a.xP=function(a,c){var b={Ad:c,uG:a.name,state:0,Lj:null,Ta:a,Nv:null,dd:[],To:[],s:{}};a.fW=b;f(a,b)};a.update=function(a,c){var b=M.dP();if(!(0>=b))for(var d=0;d<I.length;d++)for(var e=d,f=a,h=c,g=b,l=I[e],m=0;m<I[e].dd.length;m++){l.Nv=I[e].dd[m];var k=I[e].dd[m],p=l,v=f,q=h,r=g,n=k.K;if(n.length){for(var u=0;u<n.length;u++)n[u].ls=!1;for(u=0;u<n.length;u++){if(0<=k.Be.Z)var t=n[k.Be.Z];else break;if(t.ls)break;if(t.Kj)if("ENTRYPOINT"==t.type)break;else k.Be.Z=t.xa,t.ls=
!0;else t.VF(t,p,k.Be,v,q,r),t.ls=!0}}}};a.jW=function(a,c){m[a]=c};a.y0=function(a){delete m[a]};a.K0=function(a,c){for(var b=0;b<I.length;b++)if(I[b].uG==a){for(var b=I[b],d=0;d<b.dd.length;d++){var e=b.dd[d].K[0];if(e.name==c){e.T.js&&(e.Kj=!1);b.dd[d].Be.Z=0;break}}break}};a.ha=function(){I.length=0;m={}}};b4w.module.__reformer=function(a,n){function k(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},e("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},e("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},e("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",e("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,e("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,e("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,e("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,e("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,e("node material",a,"diffuse_intensity"));"specular_shader"in a||(a.specular_shader="COOKTORR",e("node material",a,"specular_shader"));"specular_ior"in a||(a.specular_ior=4,e("node material",a,"specular_ior"));"specular_hardness"in
a||(a.specular_hardness=50,e("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,e("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,e("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,e("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,e("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",e("node material",
a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,e("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,e("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,e("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,e("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name=
"B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",e("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",e("node "+a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",e("node "+a.type,a,"vector_type"))}}function b(a){if(a=a.nla_tracks)for(var b=0;b<a.length;b++)for(var d=a[b],f=0;f<d.strips.length;f++){var g=d.strips[f];"action"in g||(g.action=null,e("strip",g,"action"));"action_frame_start"in g||(g.action_frame_start=
0,e("strip",g,"action_frame_start"));"action_frame_end"in g||(g.action_frame_end=g.frame_end-g.frame_start,e("strip",g,"action_frame_end"));"repeat"in g||(g.repeat=1,e("strip",g,"repeat"));"use_reverse"in g||(g.use_reverse=!1,e("strip",g,"use_reverse"));"scale"in g||(g.scale=1,e("strip",g,"scale"))}}function e(a,b,d){d=d+">>"+a;d in C||(C[d]={Uy:[],kG:"undefined",type:a});C[d].Uy.push(b.name)}function y(a,b,d){d=d+">>"+a;d in C||(C[d]={Uy:[],kG:"deprecated",type:a});C[d].Uy.push(b.name)}function g(a){r.warn(a)}
function B(a,b){b||(b=a.name+"_COPY");var d=a.materials,e=a.submeshes;a.materials=null;a.submeshes=null;var f=A.Oh(a);a.materials=d;a.submeshes=e;f.name=b;f.materials=a.materials.slice(0);f.submeshes=[];for(d=0;d<e.length;d++){var g=A.dn(e[d]);f.submeshes.push(g)}return f}var w=n("__boundings"),t=n("__curve"),f=n("__mat4"),r=n("__print"),l=n("__quat"),A=n("__util"),x=n("__vec3"),L=n("__vec4"),M=n("__logic_nodes"),F=n("__animation"),J=[5,4],C={};a.HB=function(a){return-1!=A.mI(a,J)};a.$L=function(a){C=
{};var f=a.worlds;if(0==f.length){r.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var d={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};
f.push(d)}for(var f=a.worlds,h=0;h<f.length;h++){d=f[h];"use_sky_blend"in d||(e("world",d,"use_sky_blend"),d.use_sky_blend=!1);"use_sky_paper"in d||(e("world",d,"use_sky_paper"),d.use_sky_paper=!1);"use_sky_real"in d||(e("world",d,"use_sky_real"),d.use_sky_real=!1);"b4w_sky_settings"in d&&"rayleigh_brightness"in d.b4w_sky_settings||(e("world",d,"rayleigh_brightness"),d.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,
spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in d||(e("world",d,"fog_settings"),d.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in d&&(d.fog_settings.use_custom_color=!0,d.fog_settings.color=d.b4w_fog_color),"b4w_fog_density"in d&&0<d.b4w_fog_density&&(d.fog_settings.depth=1/d.b4w_fog_density));
"render_sky"in d.b4w_sky_settings||(e("world",d,"render_sky"),d.b4w_sky_settings.render_sky=!1);for(var l=d.texture_slots,n=0;n<l.length;n++){var c=l[n];"blend_type"in c||(c.blend_type="MIX",e("world_texture_slot",c,"blend_type"));"use_map_blend"in c||(c.use_map_blend=!1,e("world_texture_slot",c,"use_map_blend"));"use_map_horizon"in c||(c.use_map_horizon=!0,e("world_texture_slot",c,"use_map_horizon"));"use_map_zenith_up"in c||(c.use_map_zenith_up=!1,e("world_texture_slot",c,"use_map_zenith_up"));
"use_rgb_to_intensity"in c||(c.use_rgb_to_intensity=!1,e("world_texture_slot",c,"use_rgb_to_intensity"));"invert"in c||(c.invert=!1,e("world_texture_slot",c,"invert"));"color"in c||(c.color=[1,0,1],e("world_texture_slot",c,"color"));"blend_factor"in c||(c.blend_factor=0,e("world_texture_slot",c,"blend_factor"));"horizon_factor"in c||(c.horizon_factor=1,e("world_texture_slot",c,"horizon_factor"));"zenith_up_factor"in c||(c.zenith_up_factor=0,e("world_texture_slot",c,"zenith_up_factor"));"zenith_down_factor"in
c||(c.zenith_down_factor=0,e("world_texture_slot",c,"zenith_down_factor"));"default_value"in c||(c.default_value=1,e("world_texture_slot",c,"default_value"))}"b4w_use_default_animation"in d||(e("world",d,"b4w_use_default_animation"),d.b4w_use_default_animation=!1);"b4w_anim_behavior"in d||(e("world",d,"b4w_anim_behavior"),d.b4w_anim_behavior="CYCLIC")}n=a.scenes;for(h=0;h<n.length;h++)l=n[h],c=l.world,"timeline_markers"in l||(l.timeline_markers=null,e("scene",l,"timeline_markers")),"b4w_reflection_quality"in
l||(l.b4w_reflection_quality="MEDIUM",e("scene",l,"b4w_reflection_quality")),"b4w_use_nla"in l||(l.b4w_use_nla=!1,e("scene",l,"b4w_use_nla")),"fps"in l||(l.fps=24,e("scene",l,"fps")),"b4w_nla_cyclic"in l||(l.b4w_nla_cyclic=!1,e("scene",l,"b4w_nla_cyclic")),"b4w_logic_nodes"in l||(l.b4w_logic_nodes=[],e("scene",l,"b4w_logic_nodes")),"b4w_detect_collisions"in l&&(y("scene",l,"b4w_detect_collisions"),delete l.b4w_detect_collisions),"audio_doppler_speed"in l||(l.audio_doppler_speed=343.3),"audio_doppler_factor"in
l||(l.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in l||(l.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},e("scene",l,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in l||(l.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in l||(l.b4w_enable_bloom=!1,e("scene",l,"b4w_enable_bloom")),"b4w_enable_motion_blur"in l||(l.b4w_enable_motion_blur=!1,e("scene",l,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in l||(l.b4w_enable_color_correction=
!1,e("scene",l,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in l||(l.b4w_antialiasing_quality="MEDIUM",e("scene",l,"b4w_antialiasing_quality")),"b4w_tags"in l||(l.b4w_tags={title:"",description:""},e("scene",l,"b4w_tags")),"b4w_enable_object_selection"in l||(l.b4w_enable_object_selection="AUTO",e("scene",l,"b4w_enable_object_selection")),"b4w_enable_outlining"in l||(l.b4w_enable_outlining="AUTO",e("scene",l,"b4w_enable_outlining")),"b4w_enable_glow_materials"in l||(l.b4w_enable_glow_materials=
"AUTO",e("scene",l,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in l||(l.b4w_enable_anchors_visibility="AUTO",e("scene",l,"b4w_enable_anchors_visibility")),"b4w_outline_color"in l||(l.b4w_outline_color=[1,1,1],e("scene",l,"b4w_outline_color")),"b4w_outline_factor"in l||(l.b4w_outline_factor="b4w_glow_factor"in l?l.b4w_glow_factor:1,e("scene",l,"b4w_outline_factor")),"b4w_shadow_settings"in l||(e("scene",l,"b4w_shadow_settings"),f=c.b4w_shadow_settings,l.b4w_shadow_settings=f?f:{csm_resolution:2048,
self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),f=l.b4w_shadow_settings,"csm_resolution"in f||(e("scene",l,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"self_shadow_polygon_offset"in f||(e("scene",l,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in f||
(e("scene",l,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(e("scene",l,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(e("scene",l,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(e("scene",l,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(e("scene",l,"b4w_shadow_settings.first_cascade_blur_radius"),f.first_cascade_blur_radius=
3),"csm_last_cascade_border"in f||(e("scene",l,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(e("scene",l,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(e("scene",l,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(e("scene",l,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),"b4w_ssao_settings"in l||(e("scene",
l,"b4w_ssao_settings"),f=c.b4w_ssao_settings,l.b4w_ssao_settings=f?f:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),f=l.b4w_ssao_settings,"dist_factor"in f||(e("scene",l,"b4w_ssao_settings.dist_factor"),f.dist_factor=0),"samples"in f||(e("scene",l,"b4w_ssao_settings.samples"),f.samples=16),"hemisphere"in f||(e("scene",l,"b4w_ssao_settings.hemisphere"),f.hemisphere=!1),"blur_depth"in f||(e("scene",l,"b4w_ssao_settings.blur_depth"),f.blur_depth=!1),"blur_discard_value"in
f||(e("scene",l,"b4w_ssao_settings.blur_discard_value"),f.blur_discard_value=1),"b4w_bloom_settings"in l||(e("scene",l,"b4w_bloom_settings"),f=c.b4w_bloom_settings,l.b4w_bloom_settings=f?f:{key:.2,blur:4,edge_lum:1}),"key"in l.b4w_bloom_settings||(e("scene",l,"b4w_bloom_settings.key"),l.b4w_bloom_settings.key=.2),"blur"in l.b4w_bloom_settings||(e("scene",l,"b4w_bloom_settings.blur"),l.b4w_bloom_settings.blur=4),"edge_lum"in l.b4w_bloom_settings||(e("scene",l,"b4w_bloom_settings.edge_lum"),l.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in l||(e("scene",l,"b4w_motion_blur_settings"),f=c.b4w_motion_blur_settings,l.b4w_motion_blur_settings=f?f:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in l.b4w_motion_blur_settings||(e("scene",l,"b4w_motion_blur_settings.motion_blur_factor"),l.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in l.b4w_motion_blur_settings||(e("scene",l,"b4w_motion_blur_settings.motion_blur_decay_threshold"),l.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in l||(e("scene",l,"b4w_color_correction_settings"),f=c.b4w_color_correction_settings,l.b4w_color_correction_settings=f?f:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in l||(e("scene",l,"b4w_god_rays_settings"),f=c.b4w_god_rays_settings,l.b4w_god_rays_settings=f?f:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in l.b4w_god_rays_settings||(e("scene",l,"b4w_god_rays_settings.steps_per_pass"),l.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in l||(e("scene",l,"b4w_glow_settings"),l.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},f=l.b4w_glow_settings,"b4w_render_glow_over_blend"in c&&(f.render_glow_over_blend=c.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in c&&(f.small_glow_mask_coeff=c.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in c&&(f.large_glow_mask_coeff=c.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
c&&(f.small_glow_mask_width=c.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in c&&(f.large_glow_mask_width=c.b4w_large_glow_mask_width)),c=l.b4w_render_shadows,"AUTO"!=c&&"OFF"!=c&&"ON"!=c&&(l.b4w_render_shadows=c?"ON":"OFF"),c=l.b4w_render_reflections,"OFF"!=c&&"ON"!=c&&(l.b4w_render_reflections=c?"ON":"OFF"),c=l.b4w_render_refractions,"AUTO"!=c&&"OFF"!=c&&"ON"!=c&&(l.b4w_render_refractions=c?"ON":"OFF"),"b4w_render_dynamic_grass"in l||(e("scene",l,"b4w_render_dynamic_grass"),l.b4w_render_dynamic_grass=
"AUTO"),l.b4w_nla_script&&y("scene",l,"b4w_nla_script");l=a.meshes;for(h=0;h<l.length;h++){c=l[h];c.b4w_bounding_box||(e("mesh",c,"b4w_bounding_box"),c.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});c.b4w_bounding_box_source||(e("mesh",c,"b4w_bounding_box_source"),c.b4w_bounding_box_source=c.b4w_bounding_box);c.uv_textures||(e("mesh",c,"uv_textures"),c.uv_textures=[]);c.b4w_bounding_sphere_center||(c.b4w_bounding_sphere_center=[0,0,0]);c.b4w_bounding_cylinder_center||(c.b4w_bounding_cylinder_center=
[0,0,0]);c.b4w_bounding_ellipsoid_center||(c.b4w_bounding_ellipsoid_center=[0,0,0]);c.b4w_bounding_ellipsoid_axes||(n=c.b4w_bounding_box,c.b4w_bounding_ellipsoid_axes=[(n.max_x-n.min_x)/2,(n.max_y-n.min_y)/2,(n.max_z-n.min_z)/2]);"b4w_shape_keys"in c||(c.b4w_shape_keys=[],e("mesh",c,"b4w_shape_keys"));n=!0;for(f=0;f<c.submeshes.length;f++)d=c.submeshes[f],"boundings"in d||(n=!1,d.boundings={bounding_ellipsoid_axes:c.b4w_bounding_ellipsoid_axes,bounding_ellipsoid_center:c.b4w_bounding_ellipsoid_center,
bounding_box:{max_x:c.b4w_bounding_box.max_x,max_y:c.b4w_bounding_box.max_y,max_z:c.b4w_bounding_box.max_z,min_x:c.b4w_bounding_box.min_x,min_y:c.b4w_bounding_box.min_y,min_z:c.b4w_bounding_box.min_z}});n||e("mesh",c,"submesh_bd");for(var n=c,f=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],d=null,p=0;p<f.length;p++)n[f[p]]&&(d?(n[f[p]]=!1,r.warn('WARNING property "'+f[p]+'" of object "'+n.name+'" has been set to "false". Foreground property "'+
d+'" already exists.')):d=f[p]);for(n=0;n<c.b4w_vertex_anim.length;n++)f=c.b4w_vertex_anim[n],"allow_nla"in f||(e('mesh["b4w_vertex_anim"]',c,"allow_nla"),f.allow_nla=!0)}n=a.cameras;for(h=0;h<n.length;h++)l=n[h],l.type||(l.type="PERSP",e("camera",l,"type")),"b4w_eye_target_dist"in l&&(delete l.b4w_eye_target_dist,y("camera",l,"b4w_eye_target_dist")),"b4w_hover_zero_level"in l||(l.b4w_hover_zero_level=0,e("camera",l,"b4w_hover_zero_level")),"b4w_trans_velocity"in l||(l.b4w_trans_velocity=1,e("camera",
l,"b4w_trans_velocity")),"b4w_rot_velocity"in l||(l.b4w_rot_velocity=1,e("camera",l,"b4w_rot_velocity")),"b4w_zoom_velocity"in l||(l.b4w_zoom_velocity=.1,e("camera",l,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in l||(l.b4w_use_target_distance_limits=l.b4w_use_distance_limits||!1,e("camera",l,"b4w_use_target_distance_limits")),"b4w_use_zooming"in l||(l.b4w_use_zooming=l.b4w_use_distance_limits||!1,e("camera",l,"b4w_use_zooming")),"b4w_distance_min"in l||(l.b4w_distance_min=1,e("camera",
l,"b4w_distance_min")),"b4w_distance_max"in l||(l.b4w_distance_max=100,e("camera",l,"b4w_distance_max")),"b4w_horizontal_translation_min"in l||(l.b4w_horizontal_translation_min=-100,e("camera",l,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in l||(l.b4w_horizontal_translation_max=100,e("camera",l,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in l||(l.b4w_vertical_translation_min=-100,e("camera",l,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in
l||(l.b4w_vertical_translation_max=100,e("camera",l,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in l||(l.b4w_use_horizontal_clamping=!1,e("camera",l,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in l||(l.b4w_rotation_left_limit=-Math.PI,e("camera",l,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in l||(l.b4w_rotation_right_limit=Math.PI,e("camera",l,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in l||(l.b4w_horizontal_clamping_type="LOCAL",e("camera",
l,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in l||(l.b4w_use_vertical_clamping=!1,e("camera",l,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in l||(l.b4w_rotation_down_limit=-Math.PI/2,e("camera",l,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in l||(l.b4w_rotation_up_limit=Math.PI/2,e("camera",l,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in l||(l.b4w_vertical_clamping_type="LOCAL",e("camera",l,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in l||(l.b4w_hover_angle_min=
Math.PI/6,e("camera",l,"b4w_hover_angle_min")),"b4w_hover_angle_max"in l||(l.b4w_hover_angle_max=Math.PI/6,e("camera",l,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in l||(l.b4w_enable_hover_hor_rotation=!0,e("camera",l,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in l||(l.b4w_use_panning=!0,e("camera",l,"b4w_use_panning")),"b4w_use_pivot_limits"in l||(l.b4w_use_pivot_limits=!1,l.b4w_pivot_z_min=0,l.b4w_pivot_z_max=10,e("camera",l,"b4w_use_pivot_limits"));n=a.lamps;for(h=0;h<n.length;h++)l=
n[h],"b4w_generate_shadows"in l||(l.b4w_generate_shadows=!1,e("lamp",l,"b4w_generate_shadows")),"b4w_dynamic_intensity"in l||(l.b4w_dynamic_intensity=!1,e("lamp",l,"b4w_dynamic_intensity")),"use_diffuse"in l||(l.use_diffuse=!0,e("lamp",l,"use_diffuse")),"use_specular"in l||(l.use_specular=!0,e("lamp",l,"use_specular")),"clip_start"in l||(l.clip_start=.1,e("lamp",l,"clip_start")),"clip_end"in l||(l.clip_end=30,e("lamp",l,"clip_end"));n=a.speakers;for(h=0;h<n.length;h++)l=n[h],"b4w_behavior"in l||(l.b4w_behavior=
l.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in l||(l.b4w_disable_doppler=!1),"b4w_delay"in l||(l.b4w_delay=0),"b4w_delay_random"in l||(l.b4w_delay_random=0),"b4w_volume_random"in l||(l.b4w_volume_random=0),"b4w_pitch_random"in l||(l.b4w_pitch_random=0),"b4w_fade_in"in l||(l.b4w_fade_in=0),"b4w_fade_out"in l||(l.b4w_fade_out=0),"b4w_loop"in l||(l.b4w_loop=!1),"b4w_loop_count"in l||(l.b4w_loop_count=0),"b4w_loop_count_random"in l||(l.b4w_loop_count_random=0),"b4w_playlist_id"in
l||(l.b4w_playlist_id=""),l.animation_data&&b(l.animation_data);n=a.textures;for(h=0;h<n.length;h++)l=n[h],"b4w_anisotropic_filtering"in l||(l.b4w_anisotropic_filtering="OFF",e("texture",l,"b4w_anisotropic_filtering")),"b4w_water_foam"in l||(l.b4w_water_foam=!1,e("texture",l,"b4w_water_foam")),"b4w_foam_uv_freq"in l||(l.b4w_foam_uv_freq=[1,1],e("texture",l,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in l||(l.b4w_foam_uv_magnitude=[1,1],e("texture",l,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in
l||(l.b4w_parallax_steps=5,e("material",l,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in l||(l.b4w_parallax_lod_dist=10,e("material",l,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in l||(l.b4w_shore_dist_map=!1,e("texture",l,"b4w_shore_dist_map")),"b4w_shore_boundings"in l||(l.b4w_shore_boundings=new Float32Array(4),l.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],e("texture",l,"b4w_shore_boundings")),"b4w_max_shore_dist"in l||(l.b4w_max_shore_dist=100,e("texture",l,"b4w_max_shore_dist")),"b4w_disable_compression"in
l||(l.b4w_disable_compression=!1,e("texture",l,"b4w_disable_compression")),"b4w_source_type"in l||(l.b4w_source_type="",e("texture",l,"b4w_source_type")),"b4w_source_id"in l||(l.b4w_source_id="",e("texture",l,"b4w_source_id")),"b4w_source_size"in l||(l.b4w_source_size=1024,e("texture",l,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in l||(l.b4w_enable_canvas_mipmapping=!0,e("texture",l,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in l||(l.b4w_nla_video=!1,e("texture",l,"b4w_nla_video"));f=
a.materials;for(h=0;h<f.length;h++){d=f[h];"ALPHA_ANTIALIASING"==d.game_settings.alpha_blend&&(d.game_settings.alpha_blend="CLIP");"b4w_node_mat_type"in d&&y("material",d,"b4w_node_mat_type");"b4w_skydome"in d&&y("material",d,"b4w_skydome");"b4w_procedural_skydome"in d&&y("material",d,"b4w_procedural_skydome");"b4w_lens_flares"in d||(d.b4w_lens_flares=!1,e("material",d,"b4w_lens_flares"));"LENS_FLARES"===d.name&&(d.b4w_lens_flares||r.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),
d.b4w_lens_flares=!0);d.b4w_water&&("b4w_water_shore_smoothing"in d||(d.b4w_water_shore_smoothing=!1,e("material",d,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in d||(d.b4w_water_dynamic=!1,e("material",d,"b4w_water_dynamic")),"b4w_waves_height"in d||(d.b4w_waves_height=1,e("material",d,"b4w_waves_height")),"b4w_waves_length"in d||(d.b4w_waves_length=1,e("material",d,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in d||(d.b4w_water_dst_noise_scale0=.05,e("material",d,"b4w_water_dst_noise_scale0")),
"b4w_water_dst_noise_scale1"in d||(d.b4w_water_dst_noise_scale1=.03,e("material",d,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in d||(d.b4w_water_dst_noise_freq0=1.3,e("material",d,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in d||(d.b4w_water_dst_noise_freq1=1,e("material",d,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in d||(d.b4w_water_dir_min_shore_fac=.4,e("material",d,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in d||(d.b4w_water_dir_freq=.5,
e("material",d,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in d||(d.b4w_water_dir_noise_scale=.05,e("material",d,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in d||(d.b4w_water_dir_noise_freq=.07,e("material",d,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in d||(d.b4w_water_dir_min_noise_fac=.5,e("material",d,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in d||(d.b4w_water_dst_min_fac=.2,e("material",d,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in d||
(d.b4w_water_waves_hor_fac=5,e("material",d,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in d||(d.b4w_water_absorb_factor=6,e("material",d,"b4w_water_absorb_factor")),"b4w_water_fog_color"in d||(d.b4w_water_fog_color=new Float32Array(3),d.b4w_water_fog_color=[.5,.7,.7],e("material",d,"b4w_water_fog_color")),"b4w_foam_factor"in d||(d.b4w_foam_factor=5,e("material",d,"b4w_foam_factor")),"b4w_generated_mesh"in d||(d.b4w_generated_mesh=!1,e("material",d,"b4w_generated_mesh")),"b4w_water_num_cascads"in
d||(d.b4w_water_num_cascads=5,e("material",d,"b4w_water_num_cascads")),"b4w_water_subdivs"in d||(d.b4w_water_subdivs=64,e("material",d,"b4w_water_subdivs")),"b4w_water_detailed_dist"in d||(d.b4w_water_detailed_dist=1E3,e("material",d,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in d||(d.b4w_water_enable_caust=!1,e("material",d,"b4w_water_enable_caust")),"b4w_water_caust_scale"in d||(d.b4w_water_caust_scale=.25,e("material",d,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in d||(d.b4w_water_caust_brightness=
.5,e("material",d,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in d||(d.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in d||(d.b4w_dynamic_grass_color="");"diffuse_intensity"in d||(d.diffuse_intensity=1,e("material",d,"diffuse_intensity"));"b4w_use_ghost"in d||(d.b4w_use_ghost=!1);"b4w_collision_margin"in d||(d.b4w_collision_margin=.04,e("material",d,"b4w_collision_margin"));"b4w_collision_group"in d||(d.b4w_collision_group=128,e("material",d,"b4w_collision_group"));"b4w_collision_mask"in
d||(d.b4w_collision_mask=127,e("material",d,"b4w_collision_mask"));"b4w_do_not_render"in d||(d.b4w_do_not_render=!1,e("material",d,"b4w_do_not_render"));"HALO"!=d.type||"b4w_halo_sky_stars"in d||(d.b4w_halo_sky_stars=!1,e("material",d,"b4w_halo_sky_stars"));"HALO"!=d.type||"b4w_halo_stars_blend_height"in d||(d.b4w_halo_stars_blend_height=10,e("material",d,"b4w_halo_stars_blend_height"));"HALO"!=d.type||"b4w_halo_stars_min_height"in d||(d.b4w_halo_stars_min_height=0,e("material",d,"b4w_halo_stars_min_height"));
"specular_shader"in d||(d.specular_shader="COOKTORR",e("material",d,"specular_shader"));"diffuse_shader"in d||(d.diffuse_shader="LAMBERT",e("material",d,"diffuse_shader"));"roughness"in d||(d.roughness=.5,e("material",d,"roughness"));"diffuse_fresnel"in d||(d.diffuse_fresnel=.1,e("material",d,"diffuse_fresnel"));"diffuse_fresnel_factor"in d||(d.diffuse_fresnel_factor=.5,e("material",d,"diffuse_fresnel_factor"));"specular_slope"in d||(d.specular_slope=.2,e("material",d,"specular_slope"));"specular_toon_size"in
d||(d.specular_toon_size=.5,e("material",d,"specular_toon_size"));"specular_toon_smooth"in d||(d.specular_toon_smooth=.1,e("material",d,"specular_toon_smooth"));"specular_alpha"in d||(d.specular_alpha=1,e("material",d,"specular_alpha"));"b4w_wettable"in d||(d.b4w_wettable=!1,e("material",d,"b4w_wettable"));"b4w_refractive"in d||(d.b4w_refractive=!1,e("material",d,"b4w_refractive"));"b4w_refr_bump"in d||(d.b4w_refr_bump=0,e("material",d,"b4w_refr_bump"));"b4w_shallow_water_col"in d||(d.b4w_shallow_water_col=
[0,.8,.3],e("material",d,"b4w_shallow_water_col"));"b4w_shore_water_col"in d||(d.b4w_shore_water_col=[0,.9,.2],e("material",d,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in d||(d.b4w_shallow_water_col_fac=1,e("material",d,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in d||(d.b4w_shore_water_col_fac=.5,e("material",d,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in d||(d.b4w_water_sss_strength=5.9,e("material",d,"b4w_water_sss_strength"));"b4w_water_sss_width"in d||(d.b4w_water_sss_width=
.45,e("material",d,"b4w_water_sss_width"));"b4w_render_above_all"in d||(d.b4w_render_above_all=!1,e("material",d,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in d||(d.b4w_water_norm_uv_velocity=.05,e("material",d,"b4w_water_norm_uv_velocity"));"specular_ior"in d||(d.specular_ior=1,e("material",d,"specular_ior"));"darkness"in d||(d.darkness=0,e("material",d,"darkness"));"diffuse_toon_size"in d||(d.diffuse_toon_size=0,e("material",d,"diffuse_toon_size"));"diffuse_toon_smooth"in d||(d.diffuse_toon_smooth=
0,e("material",d,"diffuse_toon_smooth"));l=d.texture_slots;for(n=0;n<l.length;n++)c=l[n],"blend_type"in c||(c.blend_type="MIX",e("texture_slot",c,"blend_type"));if(d.node_tree){l=d.node_tree.nodes;for(n=0;n<l.length;n++)k(l[n]);d.node_tree.animation_data&&b(d.node_tree.animation_data)}}c=a.node_groups;for(h=0;h<c.length;h++)for(l=c[h].node_tree.nodes,n=0;n<l.length;n++)k(l[n]);l=a.objects;for(h=0;h<l.length;h++){c=l[h];switch(c.type){case "MESH":"b4w_dynamic_geometry"in c||(c.b4w_dynamic_geometry=
!1);"b4w_reflexible"in c||(c.b4w_reflexible=!1);"b4w_reflexible_only"in c||(c.b4w_reflexible_only=!1);"b4w_reflective"in c||(c.b4w_reflective=!1);"b4w_reflection_type"in c||(c.b4w_reflection_type="PLANE",e("object",c,"b4w_reflection_type"));"b4w_wind_bending"in c||(c.b4w_wind_bending=!1,e("object",c,"b4w_wind_bending"));"b4w_wind_bending_angle"in c||(c.b4w_wind_bending_angle=10,c.b4w_wind_bending_freq=.25,e("object",c,"wind bending params"));"b4w_detail_bending_amp"in c||(c.b4w_detail_bending_amp=
.1,c.b4w_branch_bending_amp=.3,e("object",c,"detail bending params"));"b4w_detail_bending_freq"in c||(c.b4w_detail_bending_freq=1,e("object",c,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in c||(c.b4w_main_bend_stiffness_col="",e("object",c,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in c||(c.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},e("object",c,"b4w_detail_bend_colors"));"b4w_caustics"in c||(c.b4w_caustics=!1);"vertex_groups"in
c&&c.vertex_groups.length&&c.data&&0==c.data.vertex_groups.length&&(c.data.vertex_groups=c.vertex_groups,delete c.vertex_groups,e("object",c,"vertex_groups"));"b4w_vertex_anim"in c&&c.b4w_vertex_anim.length&&c.data&&0==c.data.b4w_vertex_anim.length&&(c.data.b4w_vertex_anim=c.b4w_vertex_anim,delete c.b4w_vertex_anim,e("object",c,"b4w_vertex_anim"));"b4w_do_not_render"in c||(c.b4w_do_not_render=!1);"use_ghost"in c.game||(c.game.use_ghost=!1);"use_sleep"in c.game||(c.game.use_sleep=!1);"velocity_min"in
c.game||(c.game.velocity_min=0);"velocity_max"in c.game||(c.game.velocity_max=0);"collision_group"in c.game||(c.game.collision_group=1);"collision_mask"in c.game||(c.game.collision_mask=255);n=c;f=n.game;d=f.collision_bounds_type;f.use_collision_bounds&&"BOX"!=d&&"CYLINDER"!=d&&"CONE"!=d&&"SPHERE"!=d&&"CAPSULE"!=d&&"EMPTY"!=d&&(r.error("Wrong collision bounds type "+d+". Disable physics for object "+n.name),n.b4w_collision=!1,n.b4w_floating=!1,n.b4w_vehicle=!1,n.b4w_character=!1);"b4w_vehicle_settings"in
c?c.b4w_vehicle_settings&&("steering_ratio"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.steering_ratio=10),"steering_max"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.steering_max=1),"inverse_control"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.inverse_control=!1),"force_max"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.force_max=1500),"brake_max"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.brake_max=100),"speed_ratio"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.speed_ratio=
.027),"max_speed_angle"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in
c.b4w_vehicle_settings||(c.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.floating_factor=3),"floating_factor"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.water_lin_damp=
.9),"water_rot_damp"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.water_rot_damp=.9)):(c.b4w_vehicle_settings=null,e("object",c,"b4w_vehicle_settings"));"b4w_floating_settings"in c?c.b4w_floating_settings&&("floating_factor"in c.b4w_floating_settings||(c.b4w_floating_settings.floating_factor=3),"water_lin_damp"in c.b4w_floating_settings||(c.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in c.b4w_floating_settings||(c.b4w_floating_settings.water_rot_damp=.8)):(c.b4w_floating_settings=
null,e("object",c,"b4w_floating_settings"));"b4w_character_settings"in c?c.b4w_character_settings&&("walk_speed"in c.b4w_character_settings||(c.b4w_character_settings.walk_speed=4),"run_speed"in c.b4w_character_settings||(c.b4w_character_settings.run_speed=8),"step_height"in c.b4w_character_settings||(c.b4w_character_settings.step_height=.25),"jump_strength"in c.b4w_character_settings||(c.b4w_character_settings.jump_strength=5),"waterline"in c.b4w_character_settings||(c.b4w_character_settings.waterline=
0)):(c.b4w_character_settings=null,e("object",c,"b4w_character_settings"));"b4w_selectable"in c||(c.b4w_selectable=!1,e("object",c,"b4w_selectable"));"b4w_outlining"in c||(c.b4w_outlining=!1,e("object",c,"b4w_outlining"));"b4w_outline_on_select"in c||(c.b4w_outline_on_select=!1,e("object",c,"b4w_outline_on_select"));"b4w_billboard"in c||(c.b4w_billboard=!1,e("object",c,"b4w_billboard"));"b4w_billboard_geometry"in c||(c.b4w_billboard_geometry="SPHERICAL",e("object",c,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in
c||(c.b4w_pres_glob_orientation=!1,e("object",c,"b4w_pres_glob_orientation"));"b4w_outline_settings"in c||("b4w_glow_settings"in c?c.b4w_outline_settings=c.b4w_glow_settings:(c.b4w_outline_settings={},c.b4w_outline_settings.outline_duration=1,c.b4w_outline_settings.outline_period=1,c.b4w_outline_settings.outline_relapses=0),e("object",c,"b4w_outline_settings"));"b4w_lod_transition"in c||(c.b4w_lod_transition=.01,e("object",c,"b4w_lod_transition"));"lod_levels"in c||(c.lod_levels=[],e("object",c,"lod_levels"));
"b4w_animation_mixing"in c||(c.b4w_animation_mixing=!1,e("object",c,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in c||(c.b4w_anchor=null,e("object",c,"b4w_anchor")),!c.b4w_anchor||"max_width"in c.b4w_anchor||(c.b4w_anchor.max_width=250)}"collision_margin"in c.game||(c.game.collision_margin=.04,e("object",c,"collision_margin"));"b4w_anim_behavior"in c||(c.b4w_anim_behavior=c.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",e("object",c,"b4w_anim_behavior"));if(!("rotation_quaternion"in c)){n=
[0,0,0,1];A.Sh(c.rotation_euler,n);var f=n,d=n[0],p=n[1],t=n[2];f[0]=n[3];f[1]=d;f[2]=p;f[3]=t;c.rotation_quaternion=n;e("object",c,"rotation_quaternion")}"webgl_do_not_batch"in c&&(c.b4w_do_not_batch=c.webgl_do_not_batch)&&y("object",c,"webgl_do_not_batch");"b4w_shadow_cast_only"in c||(c.b4w_shadow_cast_only=!1,e("object",c,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in c||(c.b4w_correct_bounding_offset="AUTO",e("object",c,"b4w_correct_bounding_offset"));f=c.particle_systems;for(n=0;n<
f.length;n++)d=f[n],p=d.settings,"use_rotation_dupli"in p||(p.use_rotation_dupli=!1,e("particle_settings",p,"use_rotation_dupli")),"use_whole_group"in p||(p.use_whole_group=!1,e("particle_settings",p,"use_whole_group")),d.transforms||(d.transforms=new Float32Array,e("particle_system",d,"transforms")),"b4w_billboard_align"in p||(p.b4w_billboard_align="VIEW",e("particle_settings",p,"b4w_billboard_align")),"b4w_dynamic_grass"in p||(p.b4w_dynamic_grass=!1,e("object",p,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in
p||(p.b4w_dynamic_grass_scale_threshold=.01,e("object",p,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in p||(p.b4w_initial_rand_rotation=!1,e("particle_settings",p,"b4w_initial_rand_rotation")),"b4w_rotation_type"in p||(p.b4w_rotation_type="Z",e("particle_settings",p,"b4w_rotation_type")),"b4w_rand_rotation_strength"in p||(p.b4w_rand_rotation_strength=1,e("particle_settings",p,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in p||(p.b4w_hair_billboard=!1,e("particle_settings",
p,"b4w_hair_billboard")),"b4w_hair_billboard_type"in p||(p.b4w_hair_billboard_type="BASIC",e("particle_settings",p,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in p||(p.b4w_hair_billboard_jitter_amp=0,e("particle_settings",p,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in p||(p.b4w_hair_billboard_jitter_freq=0,e("particle_settings",p,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in p||(p.b4w_hair_billboard_geometry="SPHERICAL",e("particle_settings",
p,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in p||(p.b4w_wind_bend_inheritance="PARENT",e("particle_settings",p,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in p||(p.b4w_shadow_inheritance="PARENT",e("particle_settings",p,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in p||(p.b4w_reflection_inheritance="PARENT",e("particle_settings",p,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in p||(p.b4w_vcol_from_name="",e("particle_settings",p,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in p||(p.b4w_vcol_to_name="",e("particle_settings",p,"b4w_vcol_to_name")),"b4w_coordinate_system"in p||(p.b4w_coordinate_system="LOCAL",e("particle_settings",p,"b4w_coordinate_system")),"b4w_allow_nla"in p||(p.b4w_allow_nla=!0,e("particle_settings",p,"b4w_allow_nla")),"b4w_enable_soft_particles"in p||(p.b4w_enable_soft_particles=!1,e("particle_settings",p,"b4w_enable_soft_particles")),"b4w_particles_softness"in p||(p.b4w_particles_softness=1,e("particle_settings",p,"b4w_particles_softness")),
"billboard_tilt"in p||(p.billboard_tilt=0,e("particle_settings",p,"billboard_tilt")),"billboard_tilt_random"in p||(p.billboard_tilt_random=0,e("particle_settings",p,"billboard_tilt_random")),"use_rotations"in p||(p.use_rotations=!1,e("particle_settings",p,"use_rotations"));"constraints"in c||(c.constraints=[],e("object",c,"constraints"));f=c.modifiers;for(n=0;n<f.length;n++){a:{d=f[n];switch(d.type){case "ARRAY":if(!("fit_type"in d)){r.error("WARNING Incomplete modifier "+String(d.type)+' for "'+
c.name+'", reexport "'+a.b4w_filepath_blend+'" scene');d=!1;break a}}d=!0}d||(f.splice(n,1),n--)}"animation_data"in c||(c.animation_data={action:null,nla_tracks:[]},e("object",c,"animation_data"));c.animation_data&&("action"in c.animation_data||(c.animation_data.action=null,g("no action in animation data "+c.name)),"nla_tracks"in c.animation_data||(c.animation_data.nla_tracks=[],g("no NLA in animation data "+c.name)),b(c.animation_data));"b4w_collision_id"in c||(c.b4w_collision_id="",e("object",c,
"b4w_collision_id"));"b4w_viewport_alignment"in c||(c.b4w_viewport_alignment=null,e("object",c,"b4w_viewport_alignment"));"pinverse_tsr"in c||(c.pinverse_tsr=null,e("object",c,"pinverse_tsr"));"b4w_cluster_data"in c||(c.b4w_cluster_data={cluster_id:-1},e("object",c,"b4w_cluster_data"));(0>c.scale[0]||0>c.scale[1]||0>c.scale[2])&&g('negative scale for object "'+c.name+'", can lead to some errors');n=c.scale;0==n[0]&&0==n[1]&&0==n[2]?n=!0:(f=Math.abs((n[1]-n[2])/n[1]),n=.005>Math.abs((n[0]-n[1])/n[0])&&
.005>f);n||g("non-uniform scale for object "+c.name)}for(var x in C)h=C[x],n=x.match(/.*?(?=>>|$)/i)[0],r.warn('Property "'+String(n)+'" is '+h.kG+' for "'+h.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.WL=function(a,b){"num_channels"in a||(a.num_channels=1,g('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.eL=function(a){var b;a:{b=a.modifiers;for(var d=0;d<b.length;d++){var e=b[d].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=!1}if(!b)return null;
b=B(a.data,a.data.name+"_MOD");a=a.modifiers;for(d=0;d<a.length;d++){var g=a[d];switch(g.type){case "ARRAY":for(var e=b,k=g,c=0,p=0,n=0,r=new Float32Array(16),g=[],u=1;u<k.count;u++){k.use_constant_offset&&(c+=k.constant_offset_displace[0],p+=k.constant_offset_displace[1],n+=k.constant_offset_displace[2]);if(k.use_relative_offset)var z=e.b4w_bounding_box,c=c+(z.max_x-z.min_x)*k.relative_offset_displace[0],p=p+(z.max_y-z.min_y)*k.relative_offset_displace[1],n=n+(z.max_z-z.min_z)*k.relative_offset_displace[2];
A.jT(c,p,n,r);for(var q=z=B(e),y=r,C=0;C<q.submeshes.length;C++){var m=q.submeshes[C];A.Nl(m.position,y,m.position,0);A.qU(m.normal,y,m.normal);A.aT(m.tangent,y,m.tangent)}g.push(z)}for(u=0;u<g.length;u++)for(k=e,c=g[u],p=0;p<k.submeshes.length;p++){n=k.submeshes[p];r=c.submeshes[p];z=n.base_length;q=n.indices.length;n.base_length+=r.base_length;for(var F in n)if("base_length"!=F&&"boundings"!=F)if("indices"==F)for(n[F]=A.oT(n[F],r[F]),y=q;y<n.indices.length;y++)n.indices[y]+=z;else"vertex_colors"!=
F&&(n[F]=A.hO(n[F],r[F]))}break;case "CURVE":for(var e=b,u=t.dN(g.object),k=new Float32Array(16),p=u.Zh?4:3,c=new Float32Array(p),p=new Float32Array(p),n=new Float32Array(3),r=new Float32Array(4),z=new Float32Array(4),q=new Float32Array(3),y=new Float32Array(3),C=new Float32Array(3),m=new Float32Array(4),M=new Float32Array(4),J=0;J<e.submeshes.length;J++){var X=e.submeshes[J],ja=X.position,W=X.normal,X=X.tangent,Z;a:{Z=g.deform_axis;switch(Z){case "POS_X":case "NEG_X":Z=0;break a;case "POS_Y":case "NEG_Y":Z=
1;break a;case "POS_Z":case "NEG_Z":Z=2;break a;default:A.l("Wrong deform axis value "+Z)}Z=void 0}q[0]=0;q[1]=0;q[2]=0;q[Z]=1;for(var Y=t.OS(u),ia=0;ia<ja.length/3;ia++){C[0]=ja[3*ia];C[1]=ja[3*ia+1];C[2]=ja[3*ia+2];var ha=C[Z],ka=t.NS(u,ha);t.PS(u,ka,c);n[0]=c[0];n[1]=c[1];n[2]=c[2];t.MS(u,ka,p);y[0]=p[0];y[1]=0;y[2]=p[2];x.normalize(y,y);l.rotationTo(q,y,r);0>ha?(c[0]=y[0],c[1]=y[1],c[2]=y[2],x.scale(c,ha,c),x.add(n,c,n)):ha>Y&&(c[0]=y[0],c[1]=y[1],c[2]=y[2],x.scale(c,ha-Y,c),x.add(n,c,n));f.fromRotationTranslation(r,
n,k);u.Zh&&(l.setAxisAngle(q,c[3],z),x.transformQuat(C,z,C));C[Z]=0;x.transformMat4(C,k,C);ja[3*ia]=C[0];ja[3*ia+1]=C[1];ja[3*ia+2]=C[2];W.length&&(m[0]=W[3*ia],m[1]=W[3*ia+1],m[2]=W[3*ia+2],m[3]=0,L.transformMat4(m,k,m),W[3*ia]=m[0],W[3*ia+1]=m[1],W[3*ia+2]=m[2]);X.length&&(M[0]=X[3*ia],M[1]=X[3*ia+1],M[2]=X[3*ia+2],M[3]=0,L.transformMat4(M,k,M),X[3*ia]=M[0],X[3*ia+1]=M[1],X[3*ia+2]=M[2])}}}w.jR(b)}return b};a.SM=function(){return{name:"DEFAULT",uuid:A.rw(),use_nodes:!1,diffuse_shader:"LAMBERT",
diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,
b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,
b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.nL=function(a,b){function d(c,b){for(var d in c){var e=c[d],f=e[0];if(1<e.length)for(var h=1;h<e.length;h++)f+="*"+e[h];for(h=0;h<a.length;h++)if(e=a[h],e.name==f)for(var g in b)e[g]=b[g]}}for(var e=b.b4w_logic_nodes,f=0;f<e.length;f++)for(var l=e[f],c=0;c<l.length;c++){var k=l[c],n={register1:"variable1",register2:"variable2",registerd:"variabled"},r;for(r in n)r in k&&(k[n[r]]=k[r]);for(var t in k.variables)"boolean"!=typeof k.variables[t][0]&&
(k.variables[t]=[!1,k.variables[t]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(k.type)&&("variable1"in k&&(k.variables.v1=[!1,k.variable1]),"variable2"in k&&(k.variables.v2=[!1,k.variable2]),"variabled"in k&&(k.variables.vd=[!1,k.variabled]));switch(k.type){case "SELECT":for(var A=0;A<a.length;A++)n=a[A],n.name==k.object&&(n.b4w_selectable=!0);k.bools||(k.bools={});k.bools.not_wait||(k.bools.not_wait=!1);g('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":d(k.objects_paths,
{b4w_selectable:!0});if(k.links instanceof Array){g('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var n={},q=0;for(A in k.objects_paths)n[A]=k.links[q],q++;k.links=n}break;case "SELECT_PLAY":g('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');k.mute=!0;break;case "SELECT_PLAY_ANIM":g('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":d(k.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":d(k.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":d(k.objects_paths,{b4w_do_not_batch:!0});break;case "OUTLINE":d(k.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":k.condition&&(k.common_usage_names.condition=k.condition);if("cnd"in k.floats)k.common_usage_names.condition=k.floats.cnd;else switch(k.common_usage_names.condition){case "GEQUAL":k.common_usage_names.condition=M.fA;break;case "LEQUAL":k.common_usage_names.condition=
M.hA;break;case "GREATER":k.common_usage_names.condition=M.gA;break;case "LESS":k.common_usage_names.condition=M.iA;break;case "NOTEQUAL":k.common_usage_names.condition=M.jA;break;case "EQUAL":k.common_usage_names.condition=M.eA}void 0!=k.number1&&(k.input1=k.number1);void 0!=k.number2&&(k.input2=k.number2);k.bools||(k.bools={});void 0===k.bools.str&&(k.bools.str=!1,k.floats.inp1=k.input1,k.floats.inp2=k.input2);break;case "SEND_REQ":k.bools||(k.bools={});k.strings||(k.strings={});void 0===k.bools.ct&&
(k.bools.ct=!1);void 0!=k.url&&(k.bools.url=!1,k.strings.url=k.url);break;case "MATH":void 0!=k.number1&&(k.input1=k.number1);void 0!=k.number2&&(k.input2=k.number2);void 0!=k.input1&&(k.floats.inp1=k.input1);void 0!=k.input2&&(k.floats.inp2=k.input2);break;case "REGSTORE":k.floats||(k.floats={});k.strings||(k.strings={});void 0!=k.number1&&(k.input1=k.number1);if(void 0!=k.input1)switch(typeof k.input1){case "number":k.floats.inp1=k.input1;k.common_usage_names.variable_type="NUMBER";break;default:k.strings.inp1=
k.input1,k.common_usage_names.variable_type="STRING"}switch(k.common_usage_names.variable_type){case "NUMBER":k.common_usage_names.variable_type=M.rJ;break;case "STRING":k.common_usage_names.variable_type=M.sJ}break;case "PAGEPARAM":k.bools||(k.bools={});void 0===k.bools.hsh&&(k.bools.hsh=!1);k.floats||(k.floats={});void 0===k.floats.ptp&&(k.floats.ptp=0);break;case "PLAY_ANIM":d(k.objects_paths,{b4w_do_not_batch:!0});k.bools||(k.bools={});void 0===k.bools.env&&(k.bools.env=!1);(n=k.common_usage_names.param_anim_behavior)||
(n="FINISH_STOP");k.common_usage_names.param_anim_behavior=F.Ku(n);break;case "STOP_ANIM":k.bools||(k.bools={});void 0===k.bools.env&&(k.bools.env=!1);break;case "STRING":if("cnd"in k.floats)k.common_usage_names.condition=k.floats.cnd;else switch(k.common_usage_names.condition){case "GEQUAL":k.common_usage_names.condition=M.fA;break;case "LEQUAL":k.common_usage_names.condition=M.hA;break;case "GREATER":k.common_usage_names.condition=M.gA;break;case "LESS":k.common_usage_names.condition=M.iA;break;
case "NOTEQUAL":k.common_usage_names.condition=M.jA;break;case "EQUAL":k.common_usage_names.condition=M.eA}break;case "REDIRECT":void 0!=k.url&&(k.bools.url=!1,k.strings.url=k.url);break;case "ENTRYPOINT":k.bools||(k.bools={});void 0===k.bools.js&&(k.bools.js=!1);k.bools.js&&(k.mute=!0);break;case "JS_CALLBACK":for(r in k=k.common_usage_names.js_cb_params,k)switch(k[r]){case "OBJECT":k[r]=M.pJ;break;case "VARIABLE":k[r]=M.qJ}}}}};b4w.module.__curve=function(a,n){function k(a,b,e,g,k){var n=g.length;k||(k=new Float32Array(n));for(var w=n+a,B=new Float32Array(w),y=1;y<=w-1;y++)B[y-1]=b>=e[y-1]&&b<e[y+1-1]?1:0;for(var J=2;J<=a;J++)for(y=1;y<=w-J;y++)B[y-1]=(0!=B[y-1]?(b-e[y-1])*B[y-1]/(e[y+J-1-1]-e[y-1]):0)+(0!=B[y+1-1]?(e[y+J-1]-b)*B[y+1-1]/(e[y+J-1]-e[y+1-1]):0);b==e[w-1]&&(B[n-1]=1);a=0;for(y=1;y<=n;y++)a+=B[y-1]*g[y-1];for(y=1;y<=n;y++)k[y-1]=0!=a?B[y-1]*g[y-1]/a:0;return k}function b(a){a=a.Br;return a[a.length-1]}function e(a){a=
a.nC;return a[a.length-1]}function y(a,b,e,l,k,n,w,B){var F=a+(b-a)/2,J=g(F,l,k,n,w)-e;B=B?B:.01;return Math.abs(J)<B?F:0<J?y(a,F,e,l,k,n,w,B):y(F,b,e,l,k,n,w,B)}function g(a,b,e,g,k){var n=1-a;return b*n*n*n+3*e*n*n*a+3*g*n*a*a+k*a*a*a}n("__print");var B=n("__util"),w=n("__vec3");a.dN=function(a){var b={},e=a.data;a=e.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var g=a.order_u;b.gi=g;a=a.points;var n=a.length/5,x=[],w=n+g,n=n+2;x[0]=0;for(var y=2;y<=w;y++)x[y-1]=y>g&&y<n?x[y-
2]+1:x[y-2];b.Br=x;"2D"==e.dimensions?b.Zh=!1:"3D"==e.dimensions?b.Zh=!0:B.l("Wrong curve dimensions");g=[];x=[];for(e=0;e<a.length;e+=5)g.push(a[e]),g.push(a[e+1]),g.push(a[e+2]),b.Zh&&g.push(a[e+3]),x.push(a[e+4]);b.Bv=g;b.Cz=x;a=[];for(var e=b.Bv,g=b.Zh?4:3,x=b.Cz,w=b.Br,n=b.gi,y=e.length/g,F=y+n,J=0,C=w[F-1]/999,H=0;1E3>H;H++){5E-6>w[F-1]-J&&(J=w[F-1]);for(var K=k(n,J,w,x),d=0;d<g;d++)for(var h=a[g*H+d]=0;h<y;h++)a[g*H+d]+=K[h]*e[g*h+d];J+=C}g=b.Zh?4:3;x=new Float32Array(1E3);x[0]=0;for(e=1;1E3>
e;e+=1)w=a[(e-1)*g],n=a[(e-1)*g+1],y=a[(e-1)*g+2],F=a[e*g],J=a[e*g+1],C=a[e*g+2],x[e]=x[e-1]+Math.sqrt((F-w)*(F-w)+(J-n)*(J-n)+(C-y)*(C-y));b.nC=x;return b};a.PS=function(a,e,g){g||(g=[]);var l=e,n=Math.max(l,0);e=n=Math.min(l,b(a));var l=a.Bv,n=a.Zh?4:3,x=a.Cz,w=a.Br,y=a.gi;a=l.length/n;var B=a+y;5E-6>w[B-1]-e&&(e=w[B-1]);B=new Float32Array(a);k(y,e,w,x,B);for(e=0;e<n;e++)for(x=g[e]=0;x<a;x++)g[e]+=B[x]*l[n*x+e]};a.MS=function(a,b,e){e||(e=[]);var g=a.Bv,k=a.Zh?4:3,n=a.Cz,w=a.Br,y=a.gi;a=g.length/
k;var B=a+y;5E-6>w[B-1]-b&&(b=w[B-1]);var B=new Float32Array(a),J=b;b=B;var C=n.length;b||(b=new Float32Array(C));var H=new Float32Array(C),K=new Float32Array(C),d=H,h=K;d||(d=new Float32Array(C));h||(h=new Float32Array(C));for(var v=C+y,P=new Float32Array(v),c=new Float32Array(v),p=1;p<=v-1;p++)P[p-1]=J>=w[p-1]&&J<w[p+1-1]?1:0;J==w[v-1]&&(P[C-1]=1);for(var N=2;N<=y;N++)for(p=1;p<=v-N;p++){var G=0!=P[p-1]?P[p-1]/(w[p+N-1-1]-w[p-1]):0,u=0!=P[p+1-1]?-P[p+1-1]/(w[p+N-1]-w[p+1-1]):0,z=0!=c[p-1]?(J-w[p-
1])*c[p-1]/(w[p+N-1-1]-w[p-1]):0,q=0!=c[p+1-1]?(w[p+N-1]-J)*c[p+1-1]/(w[p+N-1]-w[p+1-1]):0;P[p-1]=(0!=P[p-1]?(J-w[p-1])*P[p-1]/(w[p+N-1-1]-w[p-1]):0)+(0!=P[p+1-1]?(w[p+N-1]-J)*P[p+1-1]/(w[p+N-1]-w[p+1-1]):0);c[p-1]=G+u+z+q}for(p=1;p<=C;p++)d[p-1]=P[p-1],h[p-1]=c[p-1];w=0;for(y=1;y<=C;y++)w+=H[y-1]*n[y-1];J=0;for(y=1;y<=C;y++)J+=K[y-1]*n[y-1];for(y=1;y<=C;y++)b[y-1]=0!=w?K[y-1]*n[y-1]/w+H[y-1]*n[y-1]*J/(w*w):0;for(n=0;n<k;n++)for(w=e[n]=0;w<a;w++)e[n]+=B[w]*g[k*w+n]};a.Q1=b;a.OS=e;a.NS=function(a,
f){if(0>=f)return 0;var g=b(a);if(f>=e(a))return g;var l=a.nC,k=B.fq(l,f,0,l.length-1);return g*(k+(f-l[k])/(l[k+1]-l[k]))/1E3};a.Fr=function(a,b,e,g,k){return e+(k-g)*(a-e)/(b-g)};a.UE=function(a,b,e){var g=b[0];b=b[1];e=(e[1]-b)/(e[0]-g);return e*a+(b-e*g)};a.kB=function(a,b,e,l,k,n){return g(y(0,1,a,b[0],e[0],l[0],k[0],n),b[1],e[1],l[1],k[1])};a.jv=function(a,b,e,g,k){var n=new Float32Array(3),y=new Float32Array(3),B=new Float32Array(3),F=new Float32Array(3),J=new Float32Array(3),C=new Float32Array(3);
w.copy(a[1],y);null==b?(w.copy(e[1],B),n[0]=2*y[0]-B[0],n[1]=2*y[1]-B[1]):w.copy(b[1],n);null==e?(w.copy(b[1],n),B[0]=2*y[0]-n[0],B[1]=2*y[1]-n[1]):w.copy(e[1],B);w.subtract(y,n,F);w.subtract(B,y,J);b=w.length(F);e=w.length(J);0==b&&(b=1);0==e&&(e=1);if("AUTO"==g||"AUTO"==k)C[0]=J[0]/e+F[0]/b,C[1]=J[1]/e+F[1]/b,n=2.5614*w.length(C),0!=n&&("AUTO"==g&&w.scaleAndAdd(y,C,-(b/n),a[0]),"AUTO"==k&&w.scaleAndAdd(y,C,e/n,a[2]));"VECTOR"==g&&w.scaleAndAdd(y,F,-1/3,a[0]);"VECTOR"==k&&w.scaleAndAdd(y,J,1/3,a[2])};
a.BM=function(a,b,e,g){var k=[],n=[],w,y,B;k[0]=a[0]-b[0];k[1]=a[1]-b[1];n[0]=g[0]-e[0];n[1]=g[1]-e[1];B=g[0]-a[0];w=Math.abs(k[0]);y=Math.abs(n[0]);0!=w+y&&w+y>B&&(w=B/(w+y),b[0]=a[0]-w*k[0],b[1]=a[1]-w*k[1],e[0]=g[0]-w*n[0],e[1]=g[1]-w*n[1])}};b4w.module.camera=function(a,n){function k(a,e){f.kb("camera.set_pivot","camera.target_set_trans_pivot");b.sa(a)?(L.copy(e,a.g.pivot),l.o(a),t.u(a)):f.error("set_pivot(): Wrong object or camera move style")}var b=n("__camera");n("__config");var e=n("__constraints"),y=n("__container"),g=n("__mat4"),B=n("__math"),w=n("__obj_util"),t=n("__physics"),f=n("__print"),r=n("__scenes"),l=n("__transform"),A=n("__tsr"),x=n("__util"),L=n("__vec3"),M=n("__vec4"),F=new Float32Array(2),J=new Float32Array(3),C=new Float32Array(3);
new Float32Array(4);new Float32Array(9);var H={},K={};a.Uf=b.Uf;a.bb=b.bb;a.wc=b.wc;a.xc=b.xc;a.Z1=function(a,e){if(w.la(a)){b.rt(a);a.g.lb=b.Uf;if(e){var g=e.pos||A.q(a.g.i);e.look_at?b.Cs(a,g,e.look_at):l.kc(a,g)}l.o(a);t.u(a);b.bo(a)}else f.error("static_setup(): Wrong camera object")};a.X1=function(a,e,g){b.nl(a)?(e=e||A.q(a.g.i),g?b.Cs(a,e,g):l.kc(a,e),l.o(a),t.u(a)):f.error("static_set_look_at(): Wrong camera object or camera move style")};a.Y1=function(a,e){b.nl(a)?(l.rg(a,e),l.o(a),t.u(a)):
f.error("static_set_rotation(): Wrong camera object or camera move style")};a.W1=function(a,e){if(!b.nl(a))return f.error("static_get_rotation(): Wrong camera object or camera move style"),null;e=e||new Float32Array(4);return l.fl(a,e)};a.bY=function(a,e){w.la(a)?e&&e.horiz_rot_lim&&("number"!=typeof e.horiz_rot_lim.left||"number"!=typeof e.horiz_rot_lim.right)?f.error("eye_setup(): Wrong horizontal limits object."):e&&e.vert_rot_lim&&("number"!=typeof e.vert_rot_lim.down||"number"!=typeof e.vert_rot_lim.up)?
f.error("eye_setup(): Wrong vertical limits object."):(b.rt(a),a.g.lb=b.wc,e&&b.vS(a,e.pos||A.q(a.g.i),e.look_at,e.horiz_rot_lim,e.vert_rot_lim),l.o(a),t.u(a),b.bo(a)):f.error("eye_setup(): Wrong camera object")};a.aY=function(a,h,g){b.Gb(a)?(h=h||A.q(a.g.i),g?b.cS(a,h,g):l.kc(a,h),e.Qh(a,a.g.hf,!0),l.o(a),t.u(a)):f.error("eye_set_look_at(): Wrong camera object or camera move style")};a.Ln=function(a,e,g){var k,c;b.Gb(a)?(b.Mo(a,e,g,k||!1,c||!1),l.o(a),t.u(a)):f.error("eye_rotate(): Wrong camera object or camera move style")};
a.aO=function(a,e){b.Gb(a)?!e||"number"==typeof e.down&&"number"==typeof e.up?(b.UG(a,e),l.o(a),t.u(a)):f.error("eye_set_vertical_limits(): Incorrect limits object."):f.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.$X=function(a,e,g){if(!b.Gb(a))return f.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.va?(e=e||{},g?(e.down=a.va.Rk,e.up=a.va.qm):(e.down=a.va.down,e.up=a.va.up),e.camera_space=g||!1,e):null};a.$N=function(a,
e){b.Gb(a)?!e||"number"==typeof e.left&&"number"==typeof e.right?(b.IG(a,e),l.o(a),t.u(a)):f.error("eye_set_horizontal_limits(): Incorrect limits object."):f.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.ZX=function(a,e,g){if(!b.Gb(a))return f.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.$a?(e=e||{},g?(e.left=a.$a.rl,e.right=a.$a.Ql):(e.left=a.$a.left,e.right=a.$a.right),e.camera_space=g||!1,e):null};a.k2=function(a,
e){if(w.la(a))if(!e.horiz_rot_lim||"number"==typeof e.horiz_rot_lim.left&&"number"==typeof e.horiz_rot_lim.right)if(!e.vert_rot_lim||"number"==typeof e.vert_rot_lim.down&&"number"==typeof e.vert_rot_lim.up){if(e.dist_lim){if("number"!=typeof e.dist_lim.min||"number"!=typeof e.dist_lim.max||e.dist_lim.min>e.dist_lim.max){f.error("target_setup(): Wrong distance limits object");return}e.dist_lim.min=Math.max(e.dist_lim.min,0);e.dist_lim.max=Math.max(e.dist_lim.max,0)}e.Ao&&("number"!=typeof e.Ao.min_y||
"number"!=typeof e.Ao.max_y||e.Ao.min_y>e.Ao.max_y)?f.error("target_setup(): Wrong pivot limits object"):(b.rt(a),a.g.lb=b.bb,b.xS(a,e.pos||A.q(a.g.i),e.pivot,e.horiz_rot_lim,e.vert_rot_lim,e.dist_lim,e.Ao,e.use_panning||!1),l.o(a),t.u(a),b.bo(a))}else f.error("target_setup(): Wrong vertical limits object");else f.error("target_setup(): Wrong horizontal limits object");else f.error("target_setup(): Wrong camera object")};a.Yo=function(a,e,g){var k,c;b.sa(a)?(b.qs(a,e,g,k||!1,c||!1),l.o(a),t.u(a)):
f.error("target_rotate(): Wrong camera object or camera move style")};a.j2=function(a,e,g){b.sa(a)?(e=e||A.q(a.g.i),g=g||a.g.pivot,b.Ro(a,e,g),l.o(a),t.u(a)):f.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.i2=function(a,e){b.sa(a)?(b.kS(a,e),l.o(a),t.u(a)):f.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.dT=function(a,e){if(b.sa(a)){var g=l.Fl(a,a.g.pivot),k=Math.max(0,e);l.Ef(a,0,k-g,0);l.o(a);t.u(a)}else f.error("target_set_distance(): Wrong camera object or camera move style")};
a.cz=function(a){return b.sa(a)?l.Fl(a,a.g.pivot):(f.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.m2=function(a,e){if(b.sa(a)){var g=l.Zq(e,!1,J),k=l.$q(e),c=r.p(),c=w.aa(a,c).U[0],c=b.cD(c)/2,k=k/Math.sin(c),c=l.Fl(a,g);b.Ro(a,A.q(a.g.i),g);l.o(a);l.Ef(a,0,k-c,0);l.o(a);t.u(a)}else f.error("target_zoom_object(): Wrong camera object or camera move style")};a.bT=function(a,e){if(!b.sa(a))return f.error("target_get_pivot(): Wrong camera object or camera move style"),
null;e=e||new Float32Array(3);L.copy(a.g.pivot,e);return e};a.AH=function(a,e){if(b.sa(a)){if(e){if("number"!=typeof e.min||"number"!=typeof e.max||e.min>e.max){f.error("target_set_distance_limits(): Wrong limits object");return}e.min=Math.max(e.min,0);e.max=Math.max(e.max,0)}b.OR(a,e);l.o(a);t.u(a)}else f.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.d2=function(a,e){if(!b.sa(a))return f.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var g=a.g;return g.fb?(e=e||{},e.min=g.fb.min,e.max=g.fb.max,e):null};a.fT=function(a,e){b.sa(a)?!e||"number"==typeof e.down&&"number"==typeof e.up?(b.UG(a,e),l.o(a),t.u(a)):f.error("target_set_vertical_limits(): Wrong limits object"):f.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.g2=function(a,e,g){if(!b.sa(a))return f.error("target_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.va?(e=e||{},g?(e.down=a.va.Rk,e.up=a.va.qm):
(e.down=a.va.down,e.up=a.va.up),e.camera_space=g||!1,e):null};a.eT=function(a,e){b.sa(a)?!e||"number"==typeof e.left&&"number"==typeof e.right?(b.IG(a,e),l.o(a),t.u(a)):f.error("target_set_horizontal_limits(): Wrong limits object"):f.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.e2=function(a,e,g){if(!b.sa(a))return f.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.$a?(e=e||{},g?(e.left=a.$a.rl,e.right=a.$a.Ql):
(e.left=a.$a.left,e.right=a.$a.right),e.camera_space=g||!1,e):null};a.h2=function(a,e){b.sa(a)?e&&("number"!=typeof e.min_y||"number"!=typeof e.max_y||e.min_y>e.max_y)?f.error("target_set_pivot_limits(): Wrong limits object"):(b.gS(a,e),l.o(a),t.u(a)):f.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.f2=function(a,e){if(!b.sa(a))return f.error("target_get_pivot_limits(): Wrong camera object or camera move style"),null;var g=a.g;return g.cf?(e=e||{},e.min_y=g.cf.min_y,
e.max_y=g.cf.max_y,e):null};a.cT=function(a,e,g){if(b.sa(a)){var k=a.g;k.use_panning&&(J[0]=e,J[1]=0,J[2]=g,A.Tc(J,k.i,J),L.add(k.pivot,J,k.pivot),e=A.q(k.i),L.add(e,J,e),l.o(a),t.u(a))}else f.error("target_pan_pivot(): wrong object")};a.l2=function(a,e){if(!b.sa(a))return f.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.g.use_panning=e};a.p_=function(d,e){a.vP(d,{pos:e.pos,pivot:e.pivot});var f="undefined"==typeof e.dist_interval?0:Math.max(e.dist_interval,0),g=
"undefined"==typeof e.angle_interval?0:Math.max(e.angle_interval,0),c="undefined"==typeof e.t?.5:x.S(e.t,0,1),k=a.pE(d,H);k.min=Math.max(k.min-c*f,0);k.max+=(1-c)*f;f=a.qE(d,K);f.down=x.S(f.down+c*g,-Math.PI/2,0);f.up=x.S(f.up-(1-c)*g,-Math.PI/2,0);b.jr(d,k);b.kr(d,f);l.o(d);t.u(d);b.bo(d)};a.vP=function(a,e){if(w.la(a)){if(e.dist_lim){if("number"!=typeof e.dist_lim.min||"number"!=typeof e.dist_lim.max||e.dist_lim.min>e.dist_lim.max){f.error("hover_setup(): Wrong distance limits object");return}e.dist_lim.min=
Math.max(e.dist_lim.min,0);e.dist_lim.max=Math.max(e.dist_lim.max,0)}e.hover_angle_lim&&("number"!=typeof e.hover_angle_lim.down||"number"!=typeof e.hover_angle_lim.up||e.hover_angle_lim.down<e.hover_angle_lim.up)?f.error("hover_setup(): Wrong hover angle limits object"):e.horiz_trans_lim&&("number"!=typeof e.horiz_trans_lim.min||"number"!=typeof e.horiz_trans_lim.max||e.horiz_trans_lim.min>e.horiz_trans_lim.max)?f.error("hover_setup(): Wrong horizontal translation limits object"):e.vert_trans_lim&&
("number"!=typeof e.vert_trans_lim.min||"number"!=typeof e.vert_trans_lim.max||e.vert_trans_lim.min>e.vert_trans_lim.max)?f.error("hover_setup(): Wrong vertical translation limits object"):(b.rt(a),a.g.lb=b.xc,b.wS(a,e.pos||A.q(a.g.i),e.pivot,e.dist_lim,e.hover_angle_lim,e.horiz_trans_lim,e.vert_trans_lim,e.enable_horiz_rot||!1),l.o(a),t.u(a),b.bo(a))}else f.error("hover_setup(): Wrong camera object")};a.rE=function(a,e,g){var k,c;b.Ia(a)?(b.No(a,e,g,k||!1,c||!1),l.o(a),t.u(a)):f.error("hover_rotate(): Wrong camera object or camera move style")};
a.o_=function(a,e){b.Ia(a)?(b.Bs(a,e),l.o(a),t.u(a)):f.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.m_=function(a,e){if(!b.Ia(a))return f.error("hover_get_pivot(): Wrong camera object or camera move style"),null;e=e||new Float32Array(3);L.copy(a.g.wb,e);return e};a.sP=function(a){return b.Ia(a)?l.Fl(a,a.g.wb):(f.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.kr=function(a,e){b.Ia(a)?"number"!=typeof e.down||"number"!=typeof e.up||
e.down<e.up?f.error("hover_set_vertical_limits(): Wrong limits object"):(b.kr(a,e),l.o(a),t.u(a)):f.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.qE=function(a,e){if(!b.Ia(a))return f.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var g=a.g;e=e||{};e.down=g.va.down;e.up=g.va.up;return e};a.jr=function(a,e){b.Ia(a)?"number"!=typeof e.min||"number"!=typeof e.max||e.min>e.max?f.error("hover_set_distance_limits(): Wrong limits object"):
(e.min=Math.max(e.min,0),e.max=Math.max(e.max,0),b.jr(a,e),l.o(a),t.u(a)):f.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.pE=function(a,e){if(!b.Ia(a))return f.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var g=a.g;e=e||{};e.min=g.fb.min;e.max=g.fb.max;return e};a.uP=function(a,e){b.Ia(a)?e&&("number"!=typeof e.min||"number"!=typeof e.max||e.min>e.max)?f.error("hover_set_vert_trans_limits(): Wrong limits object"):(b.qS(a,e),
l.o(a),t.u(a)):f.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.n_=function(a,e){if(!b.Ia(a))return f.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var g=a.g;return g.Kc?(e=e||{},e.min=g.Kc.min,e.max=g.Kc.max,e):null};a.tP=function(a,e){b.Ia(a)?e&&("number"!=typeof e.min||"number"!=typeof e.max||e.min>e.max)?f.error("hover_set_horiz_trans_limits(): Wrong limits object"):(b.YR(a,e),l.o(a),t.u(a)):f.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};
a.l_=function(a,e){if(!b.Ia(a))return f.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var g=a.g;return g.Jc?(e=e||{},e.min=g.Jc.min,e.max=g.Jc.max,e):null};a.q_=function(a,e){if(!b.Ia(a))return f.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.g.Hn=e};a.nl=b.nl;a.sa=b.sa;a.Gb=b.Gb;a.Ia=b.Ia;a.zy=function(a,e){if(!w.la(a))return f.error("set_move_style(): Wrong camera object"),!1;if(e!=b.Uf&&e!=b.wc&&e!=b.bb&&e!=b.xc)return f.error("set_move_style(): Wrong move style"),
!1;b.zy(a,e);l.o(a);t.u(a);return!0};a.Uh=function(a){return w.la(a)?b.Uh(a):(f.error("get_move_style(): Wrong camera object"),null)};a.kc=function(a,e){if(w.la(a)){var g=a.g;if(b.sa(a)){var k=A.q(g.i),k=L.subtract(e,k,J);L.add(k,g.pivot,g.pivot)}else b.Ia(a)&&(k=A.q(g.i),k=L.subtract(e,k,J),L.add(k,g.wb,g.wb));l.kc(a,e);l.o(a);t.u(a)}else f.error("set_translation(): Wrong camera object")};a.xf=function(a,b){if(!w.la(a))return f.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);
return l.xf(a,b)};a.G0=function(a,e,g,k,c){w.la(a)?(k=k||!1,c=c||!1,b.sa(a)?b.qs(a,e,g,k,c):b.Gb(a)?b.Mo(a,e,g,k,c):b.Ia(a)?b.No(a,e,g,k,c):b.nl(a)?f.warn("rotate_camera(): not supported for STATIC cameras"):f.error("rotate_camera(): Wrong camera move style"),l.o(a),t.u(a)):f.error("rotate_camera(): Wrong camera object")};a.oS=function(a,b){if(w.la(a)){var e=a.g;"number"==typeof b.trans&&(e.hp=x.S(b.trans,0,Infinity));"number"==typeof b.rot&&(e.gp=x.S(b.rot,0,Infinity));"number"==typeof b.zoom&&(e.ip=
x.S(b.zoom,0,.99))}else f.error("set_velocities(): Wrong camera object")};a.gg=function(a,b){if(!w.la(a))return f.error("get_velocities(): Wrong camera object"),null;var e=a.g;b=b||{};b.trans=e.hp;b.rot=e.gp;b.zoom=e.ip;return b};a.G_=function(a){return w.la(a)?0<=x.Cb(A.B(a.g.i),x.md,J)[1]:(f.error("is_look_up(): Wrong camera object"),!1)};a.cl=function(a,e){if(!w.la(a))return f.error("get_camera_angles(): Wrong camera object"),null;e=e||new Float32Array(2);b.cl(a,e);return e};a.Vq=function(a,e){if(!w.la(a))return f.error("get_camera_angles_char(): Wrong camera object"),
null;e=e||new Float32Array(2);b.Vq(a,e);return e};a.RG=function(a,e){if(w.la(a))for(var g=r.p(),g=w.aa(a,g).U,l=0;l<g.length;l++){var c=g[l];c.type!=b.cc&&c.type!=b.nc&&c.type!=b.wd&&c.type!=b.xd||b.jS(c,e,c.gf)}else f.error("set_stereo_distance(): Wrong camera object")};a.RD=function(a){if(!w.la(a))return f.error("get_stereo_distance(): Wrong camera object"),0;var e=r.p();a=w.aa(a,e).U;for(e=0;e<a.length;e++){var g=a[e];if(g.type==b.cc||g.type==b.nc)return g.im}return 0};a.uy=function(a,e){if(w.la(a)){var g=
r.p(),g=w.aa(a,g).U;b.uy(g,e)}else f.error("set_eye_distance(): Wrong camera object")};a.LY=function(a){if(!w.la(a))return f.error("get_eye_distance(): Wrong camera object"),0;var e=r.p();a=w.aa(a,e).U;for(e=0;e<a.length;e++){var g=a[e];if(g.type==b.cc||g.type==b.nc||g.type==b.wd||g.type==b.xd)return g.gf}return 0};a.C1=function(a,b){w.la(a)?(L.copy(b,a.g.hf),l.o(a),t.u(a)):f.error("set_vertical_axis(): Wrong camera object")};a.NZ=function(a,b){if(w.la(a))return b||(b=L.create()),L.copy(a.g.hf,b),
b;f.error("get_vertical_axis(): Wrong camera object")};a.r2=function(a,e,l,k){if(w.la(a)){var c=r.p();a=w.aa(a,c).U;for(c=0;c<a.length;c++){var n=a[c];n.jc||b.qi(n,n.ib);var t=J;t[0]=-e;t[1]=-l;t[2]=0;g.translate(n.Bb,t,n.Bb);g.rotateZ(n.Bb,k,n.Bb);b.tB(n);b.iv(n)}}else f.error("translate_view(): Wrong camera object")};a.PZ=function(a,b){if(!w.la(a))return f.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);x.Cb(A.B(a.g.i),x.md,b);return b};a.RO=function(a){if(!w.la(a))return f.error("get_fov(): Wrong camera object"),
0;var b=r.p();a=w.aa(a,b).U;return x.jb(a[0].Bd)};a.Y0=function(a,e){if(w.la(a))for(var g=r.p(),g=w.aa(a,g).U,l=0;l<g.length;l++){var c=g[l];c.Bd=x.Ld(e);c.jc||b.qi(c,c.ib);b.tB(c);b.iv(c)}else f.error("set_fov(): Wrong camera object")};a.yy=function(a,e,g){var l;if(!(l=w.la(a)))a:{if(w.la(a)){l=r.p();l=w.aa(a,l).U;for(var c=0;c<l.length;c++){var k=l[c];if(k.type==b.wd||k.type==b.xd){l=!0;break a}}}else f.error("is_hmd_camera(): Wrong camera object");l=!1}l?e&&g&&b.yy(a,e,g):f.error("set_hmd_fov(): Wrong camera object")};
a.Qh=function(a,b,g){w.la(a)?(b=b||a.g.hf,e.Qh(a,b,g||!1),l.o(a),t.u(a)):f.error("correct_up(): Wrong camera object")};a.n1=function(a,e){if(w.la(a)&&b.yr(a)){var g=a.g;if(b.sa(a)){var l=A.q(g.i),l=L.dist(l,g.pivot);g.jl=e/2*g.il/l}else b.Ia(a)?(l=A.q(g.i),l=L.distance(l,g.wb),g.jl=e/2*g.il/l):(g=r.p(),w.aa(a,g).U[0].top=e/2);b.MT(a)}else f.error("set_ortho_scale(): Wrong camera object")};a.pZ=function(a){if(!w.la(a)||!b.yr(a))return f.error("get_ortho_scale(): Wrong camera object"),0;var e=r.p();
return 2*w.aa(a,e).U[0].top};a.yr=function(a){return w.la(a)?b.yr(a):(f.error("is_ortho_camera(): Wrong camera object"),!1)};a.NW=function(a,e,g,k){if(!w.la(a))return f.error("calc_ray(): Wrong camera object"),null;var c=r.p(),n=w.aa(a,c).U[0];k&&3==k.length?f.fc('dest parameter in the function "calc_ray" should be type of parametric line.'):k=k||new Float32Array(6);switch(n.type){case b.Vc:case b.Cg:case b.cc:case b.nc:var t=Math.tan(n.Bd*Math.PI/360),G=t*n.ib,c=J;e=y.Xm(e,g,F,n);c[0]=(2*e[0]/n.width-
1)*G;c[1]=-1;c[2]=(2*e[1]/n.height-1)*t;A.Tc(c,a.g.i,c);L.normalize(c,c);3==k.length?L.copy(c,k):(a=l.xf(a,C),B.MG(k,a),B.Ay(k,c));return k;case b.Wd:return c=J,e=y.Xm(e,g,F,n),c[0]=(2*e[0]/n.width-1)*n.top*n.ib,c[1]=0,c[2]=(2*e[1]/n.height-1)*n.top,A.Ec(c,a.g.i,c),L.copy(c,k),L.transformQuat(x.md,A.B(a.g.i),c),B.Ay(k,c),k;default:return f.error("calc_ray(): Non-compatible camera"),k}};a.Rx=function(a,e,g){if(!w.la(a))return f.error("project_point(): Wrong camera object"),null;g=g||new Float32Array(2);
return b.Rx(a,e,g)};a.WZ=function(a){return(b.sa(a)||b.Ia(a))&&null!==a.g.fb};a.f_=function(a){return(b.Gb(a)||b.sa(a)||b.Ia(a))&&null!==a.g.va};a.e_=function(a){f.kb("has_vertical_limits","has_vertical_rot_limits");return b.sa(a)||b.Gb(a)?null!==a.g.va:(f.error("has_vertical_limits(): Wrong camera object"),!1)};a.ZZ=function(a){return(b.sa(a)||b.Gb(a))&&null!==a.g.$a};a.YZ=function(a){f.kb("has_horizontal_limits","has_horizontal_rot_limits");return b.sa(a)||b.Gb(a)?null!==a.g.$a:(f.error("has_horizontal_limits(): Wrong camera object"),
!1)};a.g_=function(a){return b.Ia(a)&&null!==a.g.Kc};a.$Z=function(a){return b.Ia(a)&&null!==a.g.Jc};a.W_=function(a,e,g){f.kb("move_pivot","target_pan_pivot");if(b.sa(a)){var k=a.g;if(k.use_panning){var c=A.q(k.i),n=L.subtract(c,k.pivot,C);J[0]=e;J[1]=0;J[2]=g;L.scale(J,L.len(n),J);A.Tc(J,k.i,J);L.add(k.pivot,J,k.pivot);L.add(c,J,c);l.o(a);t.u(a)}}else f.error("move_pivot(): wrong object")};a.B1=function(a,b){f.kb("set_velocity_params","set_velocities");if(w.la(a)){var e=a.g;e.hp=x.S(b[0],0,Infinity);
e.gp=x.S(b[1],0,Infinity);e.ip=x.S(b[2],0,.99)}else f.error("set_velocity_params(): Wrong camera object")};a.MZ=function(a,b){f.kb("get_velocity_params","get_velocities");if(!w.la(a))return f.error("get_velocity_params(): Wrong camera object"),null;b=b||new Float32Array(3);var e=a.g;b[0]=e.hp;b[1]=e.gp;b[2]=e.ip;return b};a.jX=function(a){f.fc('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');
w.la(a)?b.sa(a)||b.Gb(a)?a.g.$a=null:b.Ia(a)&&(a.g.Jc=null):f.error("clear_horizontal_limits(): Wrong camera object")};a.nX=function(a){f.fc('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');w.la(a)?b.sa(a)||b.Gb(a)?a.g.va=null:b.Ia(a)&&(a.g.Kc=null):f.error("clear_vertical_limits(): Wrong camera object")};a.kX=function(){f.fc("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};
a.Cs=function(a,g,k,n){f.ag("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);n=n||a.g.hf;b.Cs(a,g,k);e.Qh(a,n,!0);l.o(a);t.u(a)};a.Mo=function(a,e,g,k,c){f.ag("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);b.Gb(a)?(b.Mo(a,e,g,k,c),l.o(a),t.u(a)):f.error("rotate_eye_camera(): wrong object")};a.qs=function(a,e,g,k,c){f.ag("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);b.sa(a)?(b.qs(a,e,g,k,c),l.o(a),t.u(a)):f.error("rotate_target_camera(): wrong object")};
a.Ro=function(a,e,g){f.kb("camera.set_trans_pivot","camera.target_set_trans_pivot");b.sa(a)?(b.Ro(a,e,g),l.o(a),t.u(a)):f.error("set_trans_pivot(): Wrong object or camera move style")};a.P2=function(a,e){f.kb("camera.zoom_object","camera.target_zoom_object");if(b.sa(a)){l.Zq(e,!1,J);k(a,J);l.o(a);var g=l.$q(e),n=r.p(),n=w.aa(a,n).U[0],n=b.cD(n)/2,g=g/Math.sin(n),n=l.Fl(a,J);l.Ef(a,0,g-n,0);l.o(a);t.u(a)}else f.error("zoom_object(): wrong object")};a.o1=k;a.No=function(a,e,g,k,c){f.kb("camera.rotate_hover_camera",
"camera.hover_rotate");b.Ia(a)?(b.No(a,e,g,k,c),l.o(a),t.u(a)):f.error("rotate_hover_camera(): wrong object")};a.aZ=function(a,e){f.kb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!b.Ia(a))return f.error("get_hover_cam_pivot(): wrong object"),null;e||(e=new Float32Array(3));L.copy(a.g.wb,e);return e};a.rD=function(a,e){f.kb("camera.get_eye","camera.get_translation");return w.la(a)?b.rD(a,e):(f.error("get_eye(): Wrong object"),null)};a.tZ=function(a,e){f.kb("camera.get_pivot","camera.target_get_pivot");
if(!b.sa(a))return f.error("get_pivot(): Wrong object or camera move style"),null;e||(e=new Float32Array(3));L.copy(a.g.pivot,e);return e};a.k_=function(a,e){f.kb("camera.hover_cam_set_translation","camera.set_translation");if(b.Ia(a)){var g=a.g,k=L.subtract(e,A.q(g.i),J);L.add(k,g.wb,g.wb);l.kc(a,e);l.o(a);t.u(a)}else f.error("hover_cam_set_translation(): wrong object")};a.Bs=function(a,e){f.kb("camera.set_hover_pivot","camera.hover_set_pivot_translation");b.Ia(a)?(b.Bs(a,e),l.o(a),t.u(a)):f.error("set_hover_pivot(): Wrong object or camera move style")};
a.$Y=function(a,e){f.kb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!b.Ia(a))return f.error("get_hover_angle_limits(): wrong object"),null;e=e||new Float32Array(2);e[0]=a.g.va.down;e[1]=a.g.va.up;return e};a.xY=function(a,e){f.ag("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!b.Ia(a)&&!b.sa(a))return f.error("get_cam_dist_limits(): wrong object"),null;if(a.g.fb)e=e||new Float32Array(2),e[0]=a.g.fb.max,e[1]=a.g.fb.min;
else return null;return e};a.zW=function(d,e,g,k){f.ag("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);if(b.sa(d)){var c=H;c.down=e;c.up=g;c.camera_space=k==l.tk;a.fT(d,c)}else b.Gb(d)?(c=H,c.down=e,c.up=g,c.camera_space=k==l.tk,a.aO(d,c)):b.Ia(d)?(c=H,c.min=e,c.max=g,a.uP(d,c)):f.error("apply_vertical_limits(): wrong object")};a.wW=function(b,e,g){f.kb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");
H.down=e;H.up=g;a.kr(b,H)};a.tW=function(d,e,g){f.ag("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(b.sa(d)){var l=H;l.min=e;l.max=g;a.AH(d,l)}else b.Ia(d)?(l=H,l.min=e,l.max=g,a.jr(d,l)):f.error("apply_distance_limits(): wrong object")};a.hX=function(b){f.kb("camera.clear_distance_limits","camera.target_set_distance_limits");a.AH(b,null)};a.OZ=function(a,e){f.ag("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits",
"camera.hover_get_vert_trans_limits"]);if(!b.sa(a)&&!b.Gb(a)&&!b.Ia(a))return f.error("get_vertical_limits(): wrong object"),null;var g=a.g;e=e||new Float32Array(2);if(b.Gb(a)||b.sa(a)){if(g.va)return e[0]=g.va.down,e[1]=g.va.up,e}else if(b.Ia(a)&&g.Kc)return e[0]=g.Kc.min,e[1]=g.Kc.max,e;return null};a.vW=function(d,e,g,k){f.ag("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(b.sa(d)){var c=H;c.left=
e;c.right=g;c.camera_space=k==l.tk;a.eT(d,c)}else b.Gb(d)?(c=H,c.left=e,c.right=g,c.camera_space=k==l.tk,a.$N(d,c)):b.Ia(d)?(c=H,c.min=e,c.max=g,a.tP(d,c)):f.error("apply_horizontal_limits(): wrong object")};a.ZY=function(a,e){f.ag("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!b.sa(a)&&!b.Gb(a)&&!b.Ia(a))return f.error("get_horizontal_limits(): wrong object"),null;var g=a.g;e=e||new Float32Array(2);
if(b.Gb(a)||b.sa(a)){if(g.$a)return e[0]=g.$a.left,e[1]=g.$a.right,e}else if(b.Ia(a)&&g.Jc)return e[0]=g.Jc.min,e[1]=g.Jc.max,e;return null};a.YY=function(a,b){if(!w.la(a))return f.error("get_frustum_planes(): Wrong camera object"),null;var e=r.p(),e=w.aa(a,e).U[0].$k;M.copy(e.left,b.left);M.copy(e.right,b.right);M.copy(e.top,b.top);M.copy(e.bottom,b.bottom);M.copy(e.near,b.near);M.copy(e.far,b.far);return b}};b4w.module.config=function(a,n){var k=n("__config");a.Pi=k.Pi;a.Oi=k.Oi;a.rk=k.rk;a.Au=k.Au;a.set=k.set;a.get=k.get;a.reset=k.reset;a.Iw=k.Iw};b4w.module.constraints=function(a,n){var k=n("__camera"),b=n("__constraints"),e=n("__obj_util"),y=n("__physics"),g=n("__print"),B=n("__transform");a.qW=function(a,e,f,g,l){l=l||1;e instanceof Array&&2==e.length?b.TK(a,e[0],e[1],f,g,l):b.YA(a,e,f,g,l);B.o(a);y.u(a)};a.oW=function(a,e,f,g){b.RK(a,e,f,g);B.o(a);y.u(a)};a.pW=function(a,e,f,n,l,A,x,L){k.Gb(a)?(l=l||-Math.PI/2,A=A||Math.PI/2,x=x||Math.PI/2,L=L||-Math.PI/2,b.QK(a,e,f,n,l,A,x,L),B.o(a),y.u(a)):g.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.nW=function(a,e,f,n){if(k.Gb(a)){if(!n||0>n)n=.25;b.PK(a,e,f,n);B.o(a);y.u(a)}else g.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.VK=function(a,e){b.WK(a,e);B.o(a);y.u(a)};a.iW=function(a,e,f){b.KK(a,e,f);B.o(a);y.u(a)};a.rW=function(a,e,f,g){b.XK(a,e,f,g);B.o(a);y.u(a)};a.sW=function(a,e){3==e.length?b.aL(a,e):b.$K(a,e);B.o(a);y.u(a)};a.lW=function(a,e,f,g){3==e.length?b.MK(a,e,f,g):b.LK(a,e,f,g);B.o(a);y.u(a)};a.Pu=function(a,e,f){b.Pu(a,e,f);
B.o(a);y.u(a)};a.remove=function(a){a.zb&&b.remove(a)};a.DD=function(a){g.kb("constraints.get_parent","objects.get_parent");return e.DD(a)}};b4w.module.container=function(a,n){var k=n("__container"),b=n("__print");a.Wq=k.Wq;a.lD=k.lD;a.le=k.le;a.rr=function(a,n){2!=arguments.length?b.error("insert_to_container(): two arguments required"):a&&n&&k.rr(a,n)};a.xG=k.xG;a.UH=k.UH;a.pq=k.pq;a.mw=k.mw;a.resize=function(a,n,g){a&&n||b.warn("Wrong canvas container dimensions: "+a+"x"+n+". Zero dimensions aren't allowed. Resized to: "+k.zt+"x"+k.yt+".");k.resize(a,n,g)};a.mi=k.mi};b4w.module.controls=function(a,n){var k=n("__controls"),b=n("__print");a.Bg=k.Bg;a.Ua=k.Ua;a.xt=k.xt;a.mf=k.mf;a.Ag=k.Ag;a.wt=k.wt;a.jV=8;a.UV=9;a.rV=13;a.RV=16;a.nV=17;a.hV=18;a.NV=19;a.lV=20;a.tV=27;a.TV=32;a.$z=37;a.cA=38;a.aA=39;a.Zz=40;a.ZU=49;a.$U=50;a.aV=51;a.bV=52;a.cV=53;a.dV=54;a.eV=55;a.fV=56;a.gV=57;a.Xz=65;a.iV=66;a.fJ=67;a.Yz=68;a.qV=69;a.gJ=70;a.vV=71;a.xV=72;a.yV=73;a.zV=74;a.hJ=75;a.iJ=76;a.AV=77;a.BV=78;a.MV=79;a.kJ=80;a.PV=81;a.lJ=82;a.bA=83;a.nJ=84;a.VV=85;a.WV=86;a.dA=87;a.XV=
88;a.YV=89;a.ZV=90;a.CV=96;a.DV=97;a.EV=98;a.FV=99;a.GV=100;a.HV=101;a.IV=102;a.JV=103;a.KV=104;a.LV=105;a.pV=110;a.QV=186;a.sV=187;a.mV=188;a.oV=189;a.OV=190;a.uV=191;a.wV=192;a.jJ=219;a.kV=220;a.mJ=221;a.SV=222;a.Lp=k.Lp;a.Kp=k.Kp;a.Jp=k.Jp;a.zu=k.zu;a.zq=k.zq;a.Jk=k.Jk;a.Ev=k.Ev;a.dc=k.dc;a.Dv=function(a,b,g){return k.Dv(a,b||"ANY",g||!1)};a.ZB=k.ZB;a.fC=function(a,b,g,n,w,t,f){return k.fC(a,b,g,n||"ANY",w||!1,t||!1,f||!1)};a.on=k.on;a.Hv=k.Hv;a.Lk=k.Lk;a.Bq=k.Bq;a.Jv=k.Jv;a.jC=k.jC;a.iC=k.iC;
a.eC=k.eC;a.kC=k.kC;a.$B=k.$B;a.bC=k.bC;a.aC=k.aC;a.dC=k.dC;a.cC=k.cC;a.hC=function(a,b){return k.hC(a,b||!1)};a.lG=k.lG;a.yq=k.yq;a.gC=k.gC;a.Aq=function(a,b){return k.Aq(a,b||!1)};a.Cv=function(a,b){return k.Cv(a,b||0)};a.S0=function(a,b){k.GR(a,b)};a.FY=function(a){return a.value};a.Xe=k.Xe;a.fg=k.fg;a.ja=function(a,b,g,n,w,t,f){w=w||k.uC;k.ja(a,b,g,n,w,t,void 0===f?null:f)};a.Kk=function(a,b,g,n,w){var t;n=k.dc(n);k.ja(a,b,g,[n],k.uC,w,void 0===t?null:t)};a.eX=function(a){return k.lq(a,null)};
a.lq=k.lq;a.Ko=k.Ko;a.reset=k.reset;a.u0=function(){b.fc("controls.register_keyboard_events() deprecated")};a.v0=function(){b.fc("controls.register_mouse_events() deprecated")};a.x0=function(){b.fc("controls.register_wheel_events() deprecated")};a.w0=function(){b.fc("controls.register_touch_events() deprecated")};a.t0=function(){b.fc("controls.register_device_orientation() deprecated")};a.y2=function(){b.fc("controls.unregister_keyboard_events() deprecated")};a.z2=function(){b.fc("controls.unregister_mouse_events() deprecated")};
a.B2=function(){b.fc("controls.unregister_wheel_events() deprecated")};a.A2=function(){b.fc("controls.unregister_touch_events() deprecated")};a.x2=function(){b.fc("controls.unregister_device_orientation() deprecated")}};b4w.module.data=function(a,n){var k=n("__data"),b=n("__loader");n("__print");a.load=k.load;a.gt=function(a){k.gt(a|0)};a.DG=k.DG;a.hg=k.hg;a.E_=b.Dj;a.P_=k.load;a.ha=a.gt;a.TA=k.TA};b4w.module.debug=function(a,n){function k(a){var c={};if(!a)return c;a=a.split("\n");for(var b=0;b<a.length;b++){var d=a[b];if(-1!=d.search(new RegExp(/^[A-Z.]+ /))){var e=d.split(" ")[0];e in c||(c[e]=0);c[e]++}}b=a=0;for(e in c)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":b+=c[e];break;default:a+=c[e]}c.ALU_OPS=a;c.TEX_OPS=b;return c}function b(a,c){var b=new XMLHttpRequest;b.open("POST",a,!1);b.send(c);
if(200==b.status)return b.responseText;throw"Error POST XHR: "+b.status;}function e(a){a.sort(function(a,c){return c.pw.ALU_OPS-a.pw.ALU_OPS});for(var c=0;c<a.length;c++){var b=a[c],d=b.pw,e=b.vU,f=y(b.mN),f=f?"\t\t("+f.join(", ")+")":"\t\t(NA)";M.groupCollapsed("FRAG --\x3e","ALU",d.ALU_OPS,"TEX",d.TEX_OPS,"\t\tVERT --\x3e","ALU",e.ALU_OPS,"TEX",e.TEX_OPS,f);M.groupCollapsed("directives");for(var f=b.Tb.Qg,g=0;g<f.length;g++){var h=f[g];M.log(h[0],h[1])}M.groupEnd();M.groupCollapsed("vert src");
M.log(b.uU);M.groupEnd();M.groupCollapsed("vert stats");for(var l in e)"ALU_OPS"!=l&&"TEX_OPS"!=l&&M.log(l,e[l]);M.groupEnd();M.groupCollapsed("frag src");M.log(b.qO);M.groupEnd();M.groupCollapsed("frag stats");for(l in d)"ALU_OPS"!=l&&"TEX_OPS"!=l&&M.log(l,d[l]);M.groupEnd();M.groupEnd()}}function y(a){for(var c=J.Tn(),b=0;b<c.length;b++)for(var d=c[b],e=A.Pb(d,"MESH",A.vc),f=0;f<e.length;f++){var g=x.aa(e[f],d);if(g&&g.X.length)for(var g=g.X,h=0;h<g.length;h++){var l=g[h];if(l.rb==a&&l.Cf.length)return l.Cf}}return null}
function g(a,b){function d(){P.push(d);c=b;return a.apply(a,arguments)}return d}function B(a,c,b){if(typeof c!=typeof a)throw"Wrong expected data type.";if(a.length!=c.length)throw"Wrong expected vector length.";b=b?b:1E-6;for(var d=0;d<a.length;d++)if(c[d]>a[d]+b||c[d]<a[d]-b)throw"Wrong result.";}n("__config");var w=n("__controls"),t=n("__container"),f=n("__debug"),r=n("__extensions"),l=n("__loader"),A=n("__objects"),x=n("__obj_util"),L=n("__physics"),M=n("__print"),F=n("__renderer"),J=n("__scenes"),
C=n("__scenegraph"),H=n("__sfx"),K=n("__shaders"),d=n("__textures"),h=n("__util"),v=n("__vec3"),P=[],c="",p=!0,N=new Float32Array(2);a.vp=f.vp;a.Gt=f.Gt;a.wp=f.wp;a.Ft=f.Ft;a.tp=f.tp;a.Et=f.Et;a.Dt=f.Dt;a.Bm=f.Bm;a.p0=function(){L.uN()};a.o0=function(a){M.log("O",L.eO(a));for(var c=L.EO().Jb.D,b=0;b<c.length;b++){var d=c[b];d.r.J==a&&M.log("B",d)}};a.M2=function(){for(var a=J.p(),c=A.Pb(a,"MESH",A.vc),a=[J.qa(a,"MAIN_OPAQUE"),J.qa(a,"MAIN_BLEND"),J.qa(a,"MAIN_GLOW")],b=0;b<a.length;b++){var d=a[b],
e=d.D;if(e.length){M.group(d.type,"DYNAMIC");for(var f=0;f<c.length;f++){var g=c[f],h=g.g;if("DYNAMIC"==h.type)for(var l=0;l<e.length;l++){var k=e[l];if(k.ec&&k.lg==h){M.mx(g.name,g);break}}}M.groupEnd();M.groupCollapsed(d.type,"STATIC");for(f=0;f<c.length;f++)if(g=c[f],h=g.g,"DYNAMIC"!=h.type)for(l=0;l<e.length;l++)if(k=e[l],k.ec&&k.lg==h){M.mx(g.name,g);break}M.groupEnd()}}};a.g0=function(a){for(var c=J.p(),b=A.Pb(c,"MESH",A.vc),d=0;d<b.length;d++){var e=b[d];if(e.name==a){M.log("Object",e);for(var f=
J.vw(c),g=0;g<f.length;g++){for(var h=f[g],l=h.D,k=[],n=0;n<l.length;n++)l[n].lg==e.g&&k.push(l[n]);M.log("Subscene "+h.type,k)}}}};a.h0=function(){var a=J.p();console.log("Armatures: "+A.Pb(a,"ARMATURE",A.vc).length);console.log("Cameras: "+A.Pb(a,"CAMERA",A.vc).length);console.log("Curves: "+A.Pb(a,"CURVE",A.vc).length);console.log("Empties: "+A.Pb(a,"EMPTY",A.vc).length);console.log("Lamps: "+A.Pb(a,"LAMP",A.vc).length);console.log("Meshes: "+A.Pb(a,"MESH",A.vc).length);console.log("Speakers: "+
A.Pb(a,"SPEAKER",A.vc).length)};a.Fx=function(){for(var a=0,c=J.p(),c=[J.qa(c,"MAIN_OPAQUE"),J.qa(c,"MAIN_BLEND"),J.qa(c,"MAIN_GLOW")],b=0;b<c.length;b++){var d=c[b];if(d)for(var d=d.D,e=0;e<d.length;e++){var f=d[e].G;f&&(a+=f.Fx)}}return a};a.ro=function(){for(var a=0,c=J.p(),c=[J.qa(c,"MAIN_OPAQUE"),J.qa(c,"MAIN_BLEND"),J.qa(c,"MAIN_GLOW")],b=0;b<c.length;b++){var d=c[b];if(d)for(var d=d.D,e=0;e<d.length;e++){var f=d[e].G;f&&(a+=f.ro)}}return a};a.a0=function(){for(var a=J.p(),c=[J.qa(a,"MAIN_OPAQUE"),
J.qa(a,"MAIN_BLEND"),J.qa(a,"MAIN_GLOW")],b=0,d=0;d<c.length;d++){var e=c[d];e&&(b+=e.D.length)}a=J.sH(a,["MAIN_PLANE_REFLECT","MAIN_PLANE_REFLECT_BLEND","MAIN_CUBE_REFLECT","MAIN_CUBE_REFLECT_BLEND"]);for(d=0;d<a.length;d++)e=a[d],b="MAIN_PLANE_REFLECT"==e.type||"MAIN_PLANE_REFLECT_BLEND"==e.type?b+e.D.length:b+6*e.D.length;return b};a.d0=function(){return h.Un(K.mD())};a.uY=function(){for(var a=J.p(),c=J.vw(a),a={},b=0;b<c.length;b++){var d=c[b];if("SINK"!=d.type&&"DEBUG_VIEW"!=d.type)for(var e=
d.D,f=0;f<e.length;f++){var g=e[f].G,h=e[f].lg;g&&("COLOR_PICKING"!=d.type&&"OUTLINE_MASK"!=d.type||h.Vr||h.Ur)&&(a[g.id]=g)}}var e=d=b=c=0,l;for(l in a)g=a[l],g=g.oa,g.Dq&&(d++,e+=g.Dq/1048576),c++,b+=g.tC/1048576;return{vbo_number:c,vbo_memory:b,ibo_number:d,ibo_memory:e}};a.e0=function(){for(var a=[],c=0,b=J.p(),b=[J.qa(b,"MAIN_OPAQUE"),J.qa(b,"MAIN_BLEND"),J.qa(b,"MAIN_GLOW")],d=0;d<b.length;d++){var e=b[d];if(e)for(var e=e.D,f=0;f<e.length;f++){var g=e[f].G;if(g)for(var g=g.fa,h=0;h<g.length;h++){var l=
g[h];if("IMAGE"===l.source||"ENVIRONMENT_MAP"===l.source){var k=l.hb;-1===a.indexOf(k)&&(a.push(k),l=l.width*l.height*4/1048576/l.yv,l*=1.3333,c+=l)}}}}return{number:a.length,memory:c}};a.c0=function(){for(var a=[],c=0,b=J.p(),b=J.vw(b),e=0;e<b.length;e++){var f=b[e];if("SINK"!=f.type){var g=f.k,h=[g.Wb,g.he];h.push.apply(h,f.ug);for(f=0;f<h.length;f++){var l=h[f];d.ol(l)&&-1==a.indexOf(l)&&(a.push(l),c+=g.width*g.height*d.eP(l))}}}return{number:a.length,memory:c/1024/1024}};a.pQ=function(){var a=
J.p();(a=J.qa(a,"MAIN_OPAQUE"))&&J.ZE(a.k,a,[1,1,0])};a.sQ=function(){var a=J.p(),c=J.qa(a,"MAIN_OPAQUE"),a=J.sH(a,["SHADOW_CAST"]);if(c)for(var b=0;b<a.length;b++){var d=a[b],e;switch(b){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}J.ZE(d.k,c,e)}};a.M0=function(){for(var a=J.Tn(),c=0;c<a.length;c++)M.log("\n"+C.rN(J.Dw(a[c])))};a.N0=function(){};a.S_=function(){M.log("\n"+l.jP())};a.qX=w.debug;a.f0=function(a,c){return v.dist(m_tsr.q(a.g.i),m_tsr.q(c.g.i))};
a.nF=f.nF;a.Pq=f.Pq;a.TF=f.TF;a.Ox=f.Ox;a.eY=function(a,c){function b(){f.Pq("FBRES",a());setTimeout(b,c)}c||(c=16);b()};a.DW=function(){var a=new Float32Array(3),c=new Float32Array([0,0,0,1]),b=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),l=new Float32Array([0,0,-1]);if(!h.Ph(a,h.AA))throw"Wrong VEC3_IDENT";if(!h.Ph(c,h.Bu))throw"Wrong QUAT4_IDENT";if(!h.Ph(b,h.Ke))throw"Wrong AXIS_X";if(!h.Ph(d,h.uc))throw"Wrong AXIS_Y";
if(!h.Ph(e,h.lf))throw"Wrong AXIS_Z";if(!h.Ph(f,h.vt))throw"Wrong AXIS_MX";if(!h.Ph(g,h.md))throw"Wrong AXIS_MY";if(!h.Ph(l,h.Mi))throw"Wrong AXIS_MZ";};a.Z_=function(){for(var a=H.cP(),c=0;c<a.length;c++){var b=a[c];"BACKGROUND_MUSIC"==H.Hw(b)&&H.Kj(b,!0)}};a.DB=function(a){f.DB(a)};a.V0=function(a){var c=J.p();if(c=J.qa(c,"DEBUG_VIEW")){if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case f.vp:case f.Gt:case f.wp:case f.Ft:case f.tp:case f.Et:case f.Dt:case f.Bm:J.LR(c,a.debug_view_mode);
break;default:M.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&J.KR(c,a.debug_colors_seed);"number"==typeof a.uR&&J.iS(c,a.uR);"object"==typeof a.wireframe_edge_color&&J.tS(c,a.wireframe_edge_color)}else M.error("Debugging is not available on the scene.")};a.KY=function(){return M.PO()};a.SZ=function(){return M.gP()};a.OB=function(){return M.OB()};a.gW=function(a){var c=K.mD(),d=0,f;for(f in c)a&&-1===f.indexOf(a)||d++;var d="of "+d+" analyzing...",g={};for(f in c)if(!a||
-1!==f.indexOf(a)){var h=c[f],l;var n=h.xz;l=h.UC;var p=r.zw();if(p){n=p.getTranslatedShaderSource(n);l=p.getTranslatedShaderSource(l);n=n.replace("#version","#version 400 //");l=l.replace("#version","#version 400 //");var p=b("/nvidia_vert",n),t=k(p),v=b("/nvidia_frag",l),A=k(v);l={uU:n,N2:p,vU:t,qO:l,iY:v,pw:A}}else M.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),l=void 0;p=h.Tb;n=p.vm+" + "+p.Yk;l.mN=h;l.Tb=p;h=g[n]=g[n]||[];h.push(l);M.log(d)}for(n in g)M.group("%c"+
n,"color: #800"),h=g[n],e(h),M.groupEnd()};a.HC=f.HC;a.n2=function(a){if(r.Bw()){var c=C.WM();J.ZC(c);for(var b=C.Nb(c,"PERFORMANCE"),c=0;10>c;c++)F.Sk(b);window.setTimeout(function(){f.fR(b);a(b.tf)},100)}else a(-1)};a.V1=function(a){P=[];p=!0;a=n(a);for(var c in a)"function"===typeof a[c]&&(a[c]=g(a[c],c))};a.XW=function(){return p};a.test=function(a,c){try{return c(),!0}catch(b){return p=!1,console.error(a+" test was failed. ",b),!1}};a.q0=function(a){var c=t.VD(),b=t.UD(),d=c/2,e=b/2;t.resize(c,
b,!1);c=J.p().j.Pa;(b=C.fO(c))||h.l("Couldn't find onscreen subscene");c=b.k;d=t.Xm(d,e,N,b.k);d[1]=c.height-d[1];d=F.Xx(c.Ve,d[0],d[1]);B(a,d)};a.SX=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+c;};a.TX=B;a.RX=function(a,c,b){if("number"!=typeof c)throw"Wrong expected data type.";b=b?b:1E-6;if(c>a+b||c<a-b)throw"Wrong result.";};a.QX=function(a,c){if(a!==c)throw"Wrong result.";};a.stat=function(a){a=n(a);for(var c in a)-1==P.indexOf(a[c])&&console.warn(c+
" function wasn't called.")};a.i0=function(a){if(!Boolean(a))throw"Wrong result. Function: "+c;}};b4w.module.input=function(a,n){function k(a){var b=e.da(e.td);if(!b||!b.If)return!1;if(x)return!0;var g=e.Wh(b,e.MI,l),k=e.Wh(b,e.NI,A);y.yy(a,g,k);if(g=e.br(b,M))k=f.p(),a=w.aa(a,k).U,y.uy(a,g);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};e.br(e.Gp)!==e.vu&&(a.distortion_coefs=[b.distortion_coefs[0],b.distortion_coefs[1]],a.chromatic_aberration_coefs=[b.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]],
b.xm||(b.Jh&&b.Yh&&b.Kh?a.base_line_factor=(b.Jh-b.Kh)/b.Yh:b.Kh||(a.base_line_factor=b.Jh/b.Yh)),b.Bj&&b.ym&&!b.xm&&(a.inter_lens_factor=b.Bj/b.ym),L.enabled||(g=1+b.distortion_coefs[0]+b.distortion_coefs[1],f.oF(g,g)));f.As(a);B.mi(!0);e.fy(b);return x=!0}function b(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],e=0;e<a.length;e++)a[e]&&b.push(e);return b}var e=n("__input"),y=n("__camera"),g=n("__config"),B=n("__container"),
w=n("__obj_util"),t=n("__print"),f=n("__scenes"),r=n("__vec4"),l=r.create(),A=r.create(),x=!1,L=g.Fq;a.Vt=e.Vt;a.Wt=e.Wt;a.Yt=e.Yt;a.Xt=e.Xt;a.ju=e.ju;a.Rt=e.Rt;a.St=e.St;a.cu=e.cu;a.lu=e.lu;a.Cp=e.Cp;a.ku=e.ku;a.Bp=e.Bp;a.mu=e.mu;a.nu=e.nu;a.Tt=e.Tt;a.Ut=e.Ut;a.Zt=e.Zt;a.$t=e.$t;a.au=e.au;a.bu=e.bu;a.du=e.du;a.eu=e.eu;a.fu=e.fu;a.gu=e.gu;a.hu=e.hu;a.iu=e.iu;a.xp=e.xp;a.yp=e.yp;a.zp=e.zp;a.Ap=e.Ap;a.Lt=e.Lt;a.Mt=e.Mt;a.Nt=e.Nt;a.Ot=e.Ot;a.Pt=e.Pt;a.Qt=e.Qt;a.Jt=e.Jt;a.Kt=e.Kt;a.Ep=e.Ep;a.Fp=e.Fp;
a.Gp=e.Gp;a.Tz=e.Tz;a.Uz=e.Uz;a.Sz=e.Sz;a.vu=e.vu;var M=e.ru;a.ru=M;a.qu=e.qu;a.ou=e.ou;a.tu=e.tu;a.uu=e.uu;a.su=e.su;a.pu=e.pu;a.Eh=e.Eh;a.Ni=e.Ni;a.Em=e.Em;a.Fm=e.Fm;a.Dm=e.Dm;a.Cm=e.Cm;a.Qi=e.Qi;a.Im=e.Im;a.Hm=e.Hm;a.Dp=e.Dp;a.qk=e.qk;var F={};F[e.td]=[e.Ep,e.Fp];F[e.Nc]=[e.Eh];var J={};J[e.td]=[e.Gp];var C={};C[e.Nc]=[e.Eh,e.Ni,e.Em,e.Fm];C[e.zm]=[e.Dm,e.Cm];C[e.nf]=[e.Qi,e.Im,e.Hm];C[e.Tf]=[e.Dp,e.qk];var H={};H[e.td]=[e.qu,e.ru,e.ou,e.tu,e.uu,e.su,e.pu];a.Tf=e.Tf;a.td=e.td;a.Nc=e.Nc;a.zm=e.zm;
a.nf=e.nf;a.nv=e.nv;a.da=e.da;a.az=function(a,b){a&&e.az(a,b)};a.s0=function(){t.fc("input.register_device() deprecated")};a.fy=function(a){a&&a.type==e.td?e.fy(a):t.error("reset_device is undefined for device.")};a.Wh=function(a,b,f){if(a&&a.type in F&&0<=F[a.type].indexOf(b))return e.Wh(a,b,f);t.error("device hasn't param: ",b)};a.br=function(a,b){if(a&&a.type in J&&0<=J[a.type].indexOf(b))return e.br(a,b);t.error("device hasn't param: ",b)};a.Xc=function(a,b,f){if(a&&a.type in C&&0<=C[a.type].indexOf(b))return e.Xc(a,
b,f);t.error("device hasn't param: ",b)};a.$c=function(a,b,f){if(a&&a.type in C&&0<=C[a.type].indexOf(b))return e.$c(a,b,f);t.error("device hasn't param: ",b)};a.sy=function(a,b,f){if(a&&a.type in H&&0<=H[a.type].indexOf(b))return e.sy(a,b,f);t.error("device hasn't config: ",b)};a.D0=function(){if(f.za()){var a=f.bl(f.p());if(a&&(k(a),a=e.da(e.td))&&(a=a.He))if(a.capabilities.canPresent){var b=B.Wq();a.requestPresent([{source:b}]).then(function(){},function(){t.error("HMD fullscreen request failed.")})}else t.error("HMD fullscreen request failed.")}};
a.PX=k;a.FX=function(){var a=e.da(e.td);if(!(x||a&&a.If))return!1;f.As({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);f.oF(a,a);B.mi();return!0};a.$0=function(a,d,f){b();switch(a){case 0:a=e.qp;break;case 1:a=e.At;break;case 2:a=e.Bt;break;case 3:a=e.Ct;break;default:a=e.qp}a=e.da(a);e.sy(a,d,f)};a.ED=e.ED;a.zD=e.zD;a.dM=b};b4w.module.main=function(a,n){function k(){}function b(){}function e(){}function y(){window.performance||(u.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(u.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});V.SG(0)}function g(a,c){for(var b=null,d=c?U:oa,e=0;e<d.length;e++){var f=d[e];try{b=a.getContext(f,W)}catch(g){}if(b)break}b&&F.BN(b);return b}function B(a,c,e){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();u.error("WebGL context lost");t()},!1);d.xe(e);var f=d.GD();f&&u.log("%cRENDERER INFO:","color: #00a",e.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(f.UNMASKED_RENDERER_WEBGL));z.xe(e);h.xe(e);m.xe(e);I.xe(e);K.xe(e);J.xe(e);H.uS(a);J.yf(a,c);q.XG(a.width,a.height,1);D.yf();b=l();r()}function w(){k=function(){}}function t(){f()||(ka=performance.now()/1E3,D.pause(),G.pause(),m.pause(),A.pause())}function f(){return la<ka}function r(){var a="HMD"===Z.stereo&&
v.YD();a?a.requestAnimationFrame(r):ea(r);var d=performance.now()/1E3;ha||(ha=d);var e=d-ha;if(!(e<1/Z.Df)){for(var g=V.Xn(),h=0;h<da.length;h++)da[h](g,e);f()||(la>ha&&(e-=la-Math.max(ka,ha)),g+=e,V.SG(g),K.update(),L.update(),H.update(),h=e,H.hg()&&(P.reset(),Q.update(h),p.update(g,h),c.update(g,h),D.update(g,h),h&&x.update(h),H.hg()&&(G.update(g,h),H.hg()&&(v.update(g),C.update(g,h),H.hg()&&(A.update(),N.update(g,h),ja.update(),k(h,g),H.hg()&&(q.update(g,h),A.eI(),E&&(E(Y.toDataURL()),E=null)))))),
b(e));ha=d;a&&a.isPresenting&&a.submitFrame()}}function l(){var a=60,c=0,b=Z.RC,d=Z.iO;return function(f){f<1/Z.Df||(a=R.lc(1/f,a,f,b),f=G.SO(),c=(c+1)%d,0==c&&e(Math.round(a),f))}}var A=n("__anchors"),x=n("__animation"),L=n("__assets"),M=n("__config"),F=n("__compat"),J=n("__container"),C=n("__controls"),H=n("__data"),K=n("__debug"),d=n("__extensions"),h=n("__geometry"),v=n("__input"),P=n("__hud"),c=n("__nla"),p=n("__logic_nodes"),N=n("__objects"),G=n("__physics"),u=n("__print"),z=n("__renderer"),
q=n("__scenes"),D=n("__sfx"),I=n("__shaders"),m=n("__textures"),V=n("__time"),Q=n("__transform"),R=n("__util"),X=n("__version"),ja=n("__particles"),W=M.context,Z=M.v,Y=null,ia=null,ha=0,ka=0,la=0,da=[],E=null,oa=["webgl","experimental-webgl"],U=["webgl2","experimental-webgl2"],ea=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/
Z.Df)}}();a.yf=function(a,c){M.fS();u.pS(Z.console_verbose);var b=X.uz()+" "+X.type()+" ("+X.Rv()+")";u.log("%cINIT ENGINE","color: #00a",b);if(!window.WebGLRenderingContext)return null;y();Y=a;c?(P.yf(c),ia=c):(M.v.show_hud_debug_info=!1,M.P.Lr=!1);F.dL();F.qv("Chrome")||F.qv("Firefox")||(Z.ld=!1);b=g(a,Z.ld);!b&&Z.ld&&(Z.ld=!1,b=g(a,!1));if(!b)return null;u.log("%cINIT WEBGL "+(Z.ld?"2":"1"),"color: #00a");B(Y,ia,b);M.fL();F.XR(b);I.gQ();Z.lr&&(a.style["touch-action"]="none");u.log("%cSET PRECISION:",
"color: #00a",Z.precision);return b};a.resize=function(a,c,b){u.kb("main.resize","container.resize");J.resize(a,c,b)};a.TR=function(a){e=a};a.iX=function(){e=function(){}};a.r1=function(a){k=a};a.mX=function(){w()};a.UZ=function(){u.kb("main.global_timeline","time.get_timeline");return V.Xn()};a.pause=t;a.nh=function(){f()&&(la=performance.now()/1E3,D.nh(),G.nh(),m.play(!0),A.nh())};a.lo=f;a.reset=function(){H.gt(0);ia=Y=null;la=ka=ha=0;e=function(){};b=function(){};k=function(){};da.length=0;V.reset()};
a.PW=function(a){E=a};a.BY=function(){u.kb("main.get_canvas_elem","container.get_canvas");return Y};a.Xv=function(){return F.Xv()};a.Om=function(a){for(var c=0;c<da.length;c++)if(da[c]==a)return;da.push(a)};a.mR=function(a){for(var c=0;c<da.length;c++)if(da[c]==a){da.splice(c,1);break}}};b4w.module.physics=function(a,n){n("__config");var k=n("__ipc"),b=n("__physics"),e=n("__print"),y=n("__util");a.HI=0;a.GU=1;a.FU=2;a.Oz=3;a.CC=function(a){b.ea(a)?b.CC(a):e.error("No physics for object "+a.name)};a.aw=function(a){b.ea(a)?b.aw(a):e.error("No physics for object "+a.name)};a.c_=function(a){return b.ea(a)};a.Ow=function(a){return b.Ow(a)};a.lE=function(a){return b.lE(a)};a.HG=function(a,k){b.ea(a)?b.HG(a,k):e.error("No physics for object "+a.name)};a.U0=function(a,k,n){b.ea(a)?b.M("set_damping",
a.r.J,k,n):e.error("No physics for object "+a.name)};a.E0=function(a){if(b.ea(a)){var k=a.Hf;b.M("set_damping",a.r.J,k.Qv,k.ky)}else e.error("No physics for object "+a.name)};a.Es=function(a,k,n){b.ea(a)?b.Es(a,k,n):e.error("No physics for object "+a.name)};a.u=function(a){b.ea(a)?b.u(a):e.error("No physics for object "+a.name)};a.cB=function(a,k,n,t){b.ea(a)?b.cB(a,k,n,t):e.error("No physics for object "+a.name)};a.dB=function(a,k,n,t){b.ea(a)?b.dB(a,k,n,t):e.error("No physics for object "+a.name)};
a.Ru=function(a,k,n,t){b.ea(a)?b.Ru(a,k,n,t,!1):e.error("No physics for object "+a.name)};a.uW=function(a,k,n,t){b.ea(a)?b.Ru(a,k,n,t,!0):e.error("No physics for object "+a.name)};a.bB=function(a,k,n,t){b.ea(a)?b.bB(a,k,n,t):e.error("No physics for object "+a.name)};a.um=function(a,k){b.ea(a)?(b.Fd(a)||b.Gd(a)||e.error("Wrong object"),b.um(a,y.S(k,-1,1))):e.error("No physics for object "+a.name)};a.K2=function(a,k,n){if(b.ea(a)){b.Fd(a)||b.Gd(a)||e.error("Wrong object");k=y.S(k,0,1);var t=a.n.Uk;
-1==n||1==n?t=Math.max(-1,Math.min(t+n*k,1)):0==n&&0<=t?(t-=k,t=Math.max(0,t)):0==n&&0>t?(t+=k,t=Math.min(0,t)):e.error("Wrong steering direction");b.um(a,y.S(t,-1,1))}else e.error("No physics for object "+a.name)};a.tm=function(a,k){b.ea(a)?(b.Fd(a)||b.Gd(a)||e.error("Wrong object"),b.tm(a,y.S(k,-1,1))):e.error("No physics for object "+a.name)};a.J2=function(a,k,n){if(b.ea(a)){b.Fd(a)||b.Gd(a)||e.error("Wrong object");k=y.S(k,0,1);var t=a.n.em;-1==n||1==n?t=Math.max(-1,Math.min(t+n*k,1)):0==n&&0<=
t?(t-=k,t=Math.max(0,t)):0==n&&0>t?(t+=k,t=Math.min(0,t)):e.error("Wrong steering direction");b.tm(a,y.S(t,-1,1))}else e.error("No physics for object "+a.name)};a.tz=function(a,k){b.ea(a)?(b.Fd(a)||b.Gd(a)||e.error("Wrong object"),b.tz(a,y.S(k,0,1))):e.error("No physics for object "+a.name)};a.I2=function(a,k){if(b.ea(a)){b.Fd(a)||b.Gd(a)||e.error("Wrong object");k=y.S(k,-1,1);var n=a.n.Um;b.tz(a,y.S(n+n*k,0,1))}else e.error("No physics for object "+a.name)};a.Fd=function(a){return b.Fd(a)};a.Gd=
function(a){return b.Gd(a)};a.JZ=function(a){if(!b.ea(a))return e.error("No physics for object "+a.name),null;if(b.Fd(a)||b.Gd(a))return a.Vd.name;e.error("Wrong object");return null};a.LZ=function(a){if(!b.ea(a))return e.error("No physics for object "+a.name),null;if(b.Fd(a)||b.Gd(a))return a.n.Uk;e.error("Wrong object");return null};a.KZ=function(a){if(!b.ea(a))return e.error("No physics for object "+a.name),null;if(b.Fd(a)||b.Gd(a))return a.n.em;e.error("Wrong object")};a.IZ=function(a){if(!b.ea(a))return e.error("No physics for object "+
a.name),null;if(b.Fd(a)||b.Gd(a))return a.n.Um;e.error("Wrong object")};a.TD=function(a){if(!b.ea(a))return e.error("No physics for object "+a.name),null;if(b.Fd(a)||b.Gd(a))return b.TD(a);e.error("Wrong object")};a.Ze=function(a){return b.Ze(a)};a.ry=function(a,k,n){b.ea(a)?b.ry(a,k,n):e.error("No physics for object "+a.name)};a.xs=function(a,k){b.ea(a)?b.xs(a,k):e.error("No physics for object "+a.name)};a.CG=function(a,k){b.ea(a)?b.CG(a,k):e.error("No physics for object "+a.name)};a.BG=function(a,
k){b.ea(a)?b.BG(a,k):e.error("No physics for object "+a.name)};a.yG=function(a,k){b.ea(a)?b.yG(a,k):e.error("No physics for object "+a.name)};a.AB=function(a){b.ea(a)?b.AB(a):e.error("No physics for object "+a.name)};a.BB=function(a,k,n){b.ea(a)?b.BB(a,k,n):e.error("No physics for object "+a.name)};a.ys=function(a,k,n){b.ea(a)?b.ys(a,k,n):e.error("No physics for object "+a.name)};a.AG=function(a,k){b.ea(a)?b.AG(a,k):e.error("No physics for object "+a.name)};a.zG=function(a,k){b.ea(a)?b.zG(a,k):e.error("No physics for object "+
a.name)};a.Ou=function(a,k,n,t){b.ea(a)?b.Ou(a,k,n,t||!1):e.error("No physics for object "+a.name)};a.ay=function(a,k,n){b.ea(a)?b.ay(a,k||"ANY",n):e.error("No physics for object "+a.name)};a.Qu=function(a,k){b.ea(a)?b.Qu(a,k):e.error("No physics for object "+a.name)};a.sv=function(a){b.ea(a)?b.sv(a):e.error("No physics for object "+a.name)};a.Yp=function(a,k,n,t,f,r){a=a||null;if(null==a||b.ea(a))return b.Yp(a,k,n,t,f,r||!1,!1,!1,!1);e.error("No physics for object "+a.name)};a.mW=function(a,k,n,
t,f,r,l,A,x){a=a||null;if(null==a||b.ea(a))return b.Yp(a,k,n,t,f,r||!1,l||!1,A||!1,x||!1);e.error("No physics for object "+a.name)};a.by=function(a){b.CE(a)?b.by(a):e.error("Wrong ray test ID")};a.yB=function(a,k,n){b.CE(a)?b.yB(a,k,n):e.error("Wrong ray test ID")};a.ZA=function(a,k,n,t,f,r,l,A,x,y){b.ea(k)&&b.ea(f)?b.ZA(a,k,n,t,f,r,l,A,x,y):e.error("Wrong objects")};a.NB=function(a){b.ea(a)&&b.mP(a)?b.NB(a):e.error("Wrong object")};a.XF=function(a,k,n,t,f,r){b.ea(a)&&b.ea(t)?b.XF(a,k,n,t,f,r):e.error("Wrong objects")};
a.hP=k.hP};b4w.module.scenes=function(a,n){var k=n("__batch"),b=n("__camera"),e=n("__data"),y=n("__graph"),g=n("__objects"),B=n("__obj_util"),w=n("__physics"),t=n("__print"),f=n("__scenes"),r=n("__util");a.vc=g.vc;a.vs=function(a){var b=f.Tn();f.vs(r.Lc("name",a,b))};a.p=function(){return f.za()?f.p().name:""};a.zZ=function(){for(var a=f.Tn(),b=[],e=0;e<a.length;e++)b.push(a[e].name);return b};a.uw=function(){if(f.za())return f.bl(f.p());t.error("No active scene");return!1};a.jZ=function(a,b){var e=g.gc(g.It,
a,b|0);if(e)return e;t.error("get object "+a+": not found")};a.hZ=function(a,b,e){if(a=g.gc(g.Ht,a,b,e|0))return a;t.error("get object "+b+": not found")};a.iZ=function(a,b){var e=g.gc(g.Hc,a,b|0);if(e)return e;t.error("get object "+a+": not found")};a.cr=function(a,b){var e=g.cr(a,b|0);if(e)return e;t.error("get object "+a+": not found")};a.Ew=function(a){return B.Ew(a)};a.es=g.es;a.k0=function(a){return a&&a.g&&a.g.hc};a.LG=function(a,b){a&&a.g&&a.g.hc?g.LG(a,b):t.error("set_outline_intensity(): wrong object")};
a.rZ=function(a){if(a&&a.g&&a.g.hc)return a.g.kh;t.error("get_outline_intensity(): wrong object")};a.Ck=function(a,b,e,f){a&&a.g&&a.g.hc?g.Ck(a,b,e,f):t.error("apply_outline_anim(): wrong object")};a.xW=function(a){if(a&&a.g&&a.g.hc){var b=a.g.Hl;g.Ck(a,b.Il,b.Jl,b.Kl)}else t.error("apply_outline_anim_def(): wrong object")};a.nq=function(a){a&&a.g&&a.g.hc?g.nq(a):t.error("clear_outline_anim(): wrong object")};a.KG=f.KG;a.qZ=function(a){var b=f.p();if(b=f.qa(b,"OUTLINE"))return a=a||new Float32Array(3),
a.set(b.jh),a};a.As=function(a){f.za()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),f.As(a)):t.error("No active scene")};a.AZ=function(){if(!f.za())return t.error("No active scene"),
!1;var a=f.p(),b=f.qa(a,"SHADOW_CAST");if(!b)return null;var e=a.j.Rc,g=f.qa(a,"MAIN_OPAQUE"),k=f.qa(a,"SHADOW_RECEIVE"),n={};n.csm_resolution=e.csm_resolution;n.self_shadow_polygon_offset=b.self_shadow_polygon_offset;k&&(n.self_shadow_normal_offset=k.self_shadow_normal_offset);n.enable_csm=e.enable_csm;n.csm_num=e.csm_num;n.csm_first_cascade_border=e.csm_first_cascade_border;n.first_cascade_blur_radius=e.first_cascade_blur_radius;n.csm_last_cascade_border=e.csm_last_cascade_border;n.last_cascade_blur_radius=
e.last_cascade_blur_radius;n.fade_last_cascade=e.fade_last_cascade;n.blend_between_cascades=e.blend_between_cascades;e.enable_csm?(n.csm_borders=f.MO(a,g.k),n.blur_radii=new Float32Array(e.csm_num),n.blur_radii.set(g.k.cs.subarray(0,e.csm_num))):(n.csm_borders=null,n.blur_radii=null);return n};a.x1=function(a){if(f.za()){var e=f.p();"number"==typeof a.self_shadow_polygon_offset&&y.ma(e.j.Pa,function(b,e){"SHADOW_CAST"===e.type&&(e.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var g=f.qa(e,
"SHADOW_RECEIVE");g&&("number"==typeof a.self_shadow_normal_offset&&(g.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(g.pcf_blur_radius=a.pcf_blur_radius));var n=f.qa(e,"MAIN_BLEND");n&&("number"==typeof a.self_shadow_normal_offset&&(n.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(n.pcf_blur_radius=a.pcf_blur_radius),n.ra=!0);n=e.j.Rc;"number"==typeof a.csm_first_cascade_border&&(n.csm_first_cascade_border=
a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(n.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(n.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(n.last_cascade_blur_radius=a.last_cascade_blur_radius);if(g){for(var r=g.D,w=0;w<r.length;w++){var J=r[w];J.lg.Qd&&(J=J.G,k.eB(J,n),k.Uc(J))}g.ra=!0}g=B.aa(e.Gh,e).U;for(w=0;w<g.length;w++)b.nz(g[w],n);f.my(e)}else t.error("No active scene")};
a.qD=function(){if(!f.za())return t.error("No active scene"),!1;var a=f.p();return f.qD(a)};a.ty=function(a,b,e){if(f.za()){var g=f.p(),k=f.qa(g,"MAIN_OPAQUE");f.ty(g,a||0==a?parseFloat(a):k.Sg,b||0==b?b:k.ne,e||0==e?e:k.Je)}else t.error("No active scene")};a.uD=function(a){if(!f.za())return t.error("No active scene"),!1;var b=f.p();return f.uD(b,a)};a.xy=function(a){if(f.za()){var b=f.p();f.xy(b,a)}else t.error("No active scene")};a.PD=function(){if(!f.za())return t.error("No active scene"),!1;var a=
f.p();return f.PD(a)};a.QG=function(a){if(f.za()){var b=f.p();f.QG(b,a)}else t.error("No active scene")};a.CY=function(){if(!f.za())return t.error("No active scene"),null;var a=f.p(),a=f.qa(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.Q0=function(a){if(f.za()){var b=f.p();if(b=f.qa(b,"COMPOSITING"))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=
a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.ra=!0}else t.error("No active scene")};a.ND=function(){if(!f.za())return t.error("No active scene"),!1;var a=f.p();return f.ND(a)};a.OG=function(a){if(f.za()){var b=f.p();f.OG(b,a)}else t.error("No active scene")};a.oD=function(){if(!f.za())return t.error("No active scene"),!1;var a=f.p();return f.qa(a,"DOF")?f.oD(a):null};a.EG=function(a){if(f.za()){var b=f.p();f.EG(b,a)}else t.error("No active scene")};
a.xD=function(){if(!f.za())return t.error("No active scene"),!1;var a=f.p();return f.qa(a,"GOD_RAYS")?f.xD(a):null};a.GG=function(a){if(f.za()){var b=f.p();f.GG(b,a)}else t.error("No active scene")};a.hD=function(){if(!f.za())return t.error("No active scene"),!1;var a=f.p();return f.qa(a,"BLOOM")?f.hD(a):null};a.wG=function(a){if(f.za()){var b=f.p();f.wG(b,a)}else t.error("No active scene")};a.wD=function(){if(!f.za())return t.error("No active scene"),!1;var a=f.p();return f.qa(a,"GLOW_COMBINE")?
f.wD(a):null};a.FG=function(a){if(f.za()){var b=f.p();f.FG(b,a)}else t.error("No active scene")};a.$D=function(){if(!f.za())return t.error("No active scene"),!1;var a=f.p();return f.$D(a)};a.WG=function(a){if(f.za()){var b=f.p();g.WG(b,a)}else t.error("No active scene")};a.XD=function(a,b){if(!f.za())return t.error("No active scene"),0;var e=f.p();return e.j.mc?f.XD(e,a,b):(t.error("No water parameters on the active scene"),0)};a.VG=function(a){if(f.za()){var b=f.p();f.VG(b,a)}else t.error("No active scene")};
a.WD=function(a){if(f.za()){var b=f.p();f.WD(b,a)}else t.error("No active scene")};a.F2=function(){if(f.za()){var a=f.p();f.bI(a)}else t.error("No active scene")};a.j_=function(a,b){b=b||!1;!B.Pc(a)&&!B.fo(a)||B.Ha(a)?b?f.$m(a,!0):f.zB(a,!0):t.error("show/hide is only supported for dynamic objects.")};a.H1=function(a,b){b=b||!1;!B.Pc(a)&&!B.fo(a)||B.Ha(a)?b?f.$m(a,!1):f.zB(a,!1):t.error("show/hide is only supported for dynamic objects.")};a.Yw=function(a){if(B.EP(a)||B.fo(a)||B.wr(a))return f.Yw(a);
t.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.Ar=function(a){return a.g.Ar};a.aX=function(a){t.kb("scenes.check_object","scenes.check_object_by_name");return f.za()?g.KQ(a,f.p()):(t.error("No active scene"),!1)};a.dX=function(a,b){return g.gc(g.It,a,b|0)?!0:!1};a.bX=function(a,b,e){return g.gc(g.Ht,a,b,e|0)?!0:!1};a.cX=function(a,b){return g.gc(g.Hc,a,b|0)?!0:!1};a.uj=function(a,b){var e=f.p();a||(a="ALL");b||0===b||(b=g.vc);return g.Pb(e,a,b)};a.mZ=function(a){return a?
a.Qj:(t.error("Wrong object name"),"")};a.nZ=function(a){if(!a)return t.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Qj),a=B.Xg(a);return b.reverse()};a.oZ=function(a){return a&&a.type?a.type:(t.error("Wrong object"),"UNDEFINED")};a.lZ=function(a){t.kb("scenes.get_object_dg_parent","objects.get_dg_parent");return B.Xg(a)};a.kZ=function(a){return a.zd.slice(0)};a.sD=function(){for(var a=g.Pb(f.p(),"MESH",g.vc),b=0;b<a.length;b++){var e=a[b];if(w.Ze(e))return e}return null};a.MD=function(a,
b){b||0===b||(b=1);if(!f.za())return t.error("No active scene"),!1;var e=f.p();return f.MD(e,a,b)};a.jD=function(){return f.jD()};a.GZ=function(a){return B.Pc(a)?a.g.type:null};a.Yq=function(){if(!f.za())return t.error("No active scene"),!1;var a=f.p();return f.Yq(a)};a.Ak=function(a,b){if(a.g.xE){if(b)var e=f.Tn(),e=r.Lc("name",b,e);else e=f.p();f.Ak(e,a,!0)}else t.error('object "'+a.name+'" has been created not by coping.')};a.Jo=function(a){(B.Pc(a)||B.fo(a))&&B.Ha(a)?(g.Sr(a,!1,a.g.yE,!1,!1),
e.cR(a),g.Sr(a,!0,!0,!0,!0),g.Jo(a)):t.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.$E=function(a){var b=f.p();if(b.timeline_markers&&a in b.timeline_markers)return f.$E(b,a);t.error('"'+a+'" marker not found.');return 0};a.eZ=function(){var a=f.p();return(a=f.qa(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.i1=function(a){var b=f.p();(b=f.qa(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=
a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):t.error("The motion blur subscene doesn't exist.")};a.OW=function(){var a=f.p();return Boolean(f.qa(a,"COLOR_PICKING"))}};b4w.module.transform=function(a,n){var k=n("__obj_util"),b=n("__physics"),e=n("__print"),y=n("__quat"),g=n("__transform"),B=n("__tsr"),w=n("__util"),t=new Float32Array(4),f=new Float32Array(3),r=new Float32Array(4);a.tk=g.tk;a.zA=g.zA;a.kc=function(a,n,r,t){k.Ha(a)?(f[0]=n,f[1]=r,f[2]=t,g.kc(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Fs=function(a,n,r,t){k.Ha(a)?(f[0]=n,f[1]=r,f[2]=t,g.Fs(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.nS=function(a,f){k.Ha(a)?(g.kc(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.A1=function(a,f){k.Ha(a)?(g.Fs(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.z1=function(a,n,r,t,y){k.Ha(a)?(f[0]=n,f[1]=r,f[2]=t,w.Ec(f,1,B.B(y.g.i),B.q(y.g.i),f),g.kc(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.xf=function(a,b){b||(b=new Float32Array(3));g.xf(a,b);return b};a.SD=function(a,b){b||(b=new Float32Array(3));g.SD(a,
b);return b};a.rg=function(a,f,n,t,w){k.Ha(a)?(r[0]=f,r[1]=n,r[2]=t,r[3]=w,g.rg(a,r),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Ds=function(a,f,n,t,w){k.Ha(a)?(r[0]=f,r[1]=n,r[2]=t,r[3]=w,g.Ds(a,r),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.w1=function(a,f){k.Ha(a)?(g.rg(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.u1=function(a,f){k.Ha(a)?(g.Ds(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.fl=function(a,b){b||(b=new Float32Array(4));g.fl(a,b);return b};a.HD=function(a,b){b||(b=new Float32Array(4));g.HD(a,b);return b};a.Cy=function(a,n,r,t){k.Ha(a)?(f[0]=n,f[1]=r,f[2]=t,g.Cy(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Dy=function(a,n,r,t){k.Ha(a)?(f[0]=n,f[1]=r,f[2]=t,g.Dy(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.t1=function(a,f){k.Ha(a)?(g.Cy(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.s1=function(a,f){k.Ha(a)?(g.Dy(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.ve=function(a,b){k.Ha(a)?(g.ve(a,b),g.o(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Ey=function(a,b){k.Ha(a)?(g.Ey(a,b),g.o(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Oc=function(a){return g.Oc(a)};a.JD=function(a){return g.JD(a)};a.LX=function(a){if("EMPTY"!=a.type)e.error("Wrong object: "+a.name);else{for(var f=0;f<a.zd.length;f++)if(!k.Ha(a.zd[f])){e.error('Wrong object: "'+
a.zd[f].name+'" is not dynamic.');return}g.kc(a,[0,0,0]);g.rg(a,[0,0,0,1]);g.ve(a,1);g.o(a);b.u(a)}};a.$q=function(a){return k.Pc(a)?g.$q(a):(e.error("Wrong object: "+a.name),0)};a.Zq=function(a,b,f){return k.Pc(a)?g.Zq(a,b,f):(e.error("Wrong object: "+a.name),null)};a.Ef=function(a,f,n,r){k.Ha(a)?(g.Ef(a,f,n,r),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.H0=function(a,f){if(k.Ha(a)){var n=y.setAxisAngle(w.Ke,f,r);g.jy(a,n);g.o(a);b.u(a)}else e.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.I0=function(a,f){if(k.Ha(a)){var n=y.setAxisAngle(w.uc,f,r);g.jy(a,n);g.o(a);b.u(a)}else e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.J0=function(a,f){if(k.Ha(a)){var n=y.setAxisAngle(w.lf,f,r);g.jy(a,n);g.o(a);b.u(a)}else e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.CD=function(a){return g.CD(a)};a.rh=function(a,f){k.Ha(a)?(g.rh(a,f),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Gs=function(a,f){k.Ha(a)?(g.Gs(a,f),g.o(a),
b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Yn=function(a,b){b||(b=new Float32Array(8));g.Yn(a,b);return b};a.Zn=function(a,b){b||(b=new Float32Array(8));g.Zn(a,b);return b};a.distance=function(a,b){return g.distance(a,b)};a.g1=function(a,f){k.Ha(a)?(B.Wg(f,t),g.rh(a,t),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.h1=function(a,f){k.Ha(a)?(B.Wg(f,t),g.Gs(a,t),g.o(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.cZ=function(a,b){b||
(b=new Float32Array(16));g.Yn(a,t);B.GH(t,b);return b};a.dZ=function(a,b){b||(b=new Float32Array(16));g.Zn(a,t);B.GH(t,b);return b}};b4w.module.util=function(a,n){var k=n("__compat"),b=n("__obj_util"),e=n("__print"),y=n("__quat"),g=n("__util"),B=n("__vec3"),w=new Float32Array(6);a.Ke=new Float32Array([1,0,0]);a.uc=new Float32Array([0,1,0]);a.lf=new Float32Array([0,0,1]);a.vt=new Float32Array([-1,0,0]);a.md=new Float32Array([0,-1,0]);a.Mi=new Float32Array([0,0,-1]);a.BA=g.BA;a.IA=g.IA;a.JA=g.JA;a.DA=g.DA;a.FA=g.FA;a.LA=g.LA;a.CA=g.CA;a.HA=g.HA;a.Fu=g.Fu;a.EA=g.EA;a.GA=g.GA;a.KA=g.KA;a.cY=function(a){return new Float32Array(a||0)};
a.assert=g.assert;a.NE=g.NE;a.Lc=g.Lc;a.Jr=function(a){return g.Jr(a)};a.Sh=function(a,b){b||(b=new Float32Array(4));return g.Sh(a,b)};a.Hx=function(a,b,e){e||(e=y.create());return g.Hx(a,b,e)};a.bG=function(a,b,e){e||(e=B.create());return g.bG(a,b,e)};a.aG=function(a,b){b||(b=new Float32Array(3));return g.aG(a,b)};a.sign=g.sign;a.S=g.S;a.Cb=g.Cb;a.VZ=function(a,b){return g.Ux(a,g.md,g.uc,g.Mi,b)};a.kv=function(a,b){return g.kv(a,b)};a.Ux=function(a,b,k,l,n){return 0!=B.dot(k,l)?(e.error("Wrong in-plane direction"),
null):g.Ux(a,b,k,l,n)};a.nE=g.nE;a.lc=g.lc;a.Yl=g.Yl;a.bi=g.bi;a.VB=g.VB;a.$F=g.$F;a.dG=g.dG;a.FI=g.FI;a.jx=function(a,b,k,l,n){e.kb("util.line_plane_intersect","math.line_plane_intersect");w[0]=k[0];w[1]=k[1];w[2]=k[2];w[3]=l[0];w[4]=l[1];w[5]=l[2];return g.jx(a,b,w,n)};a.Pc=function(a){e.kb("util.is_mesh","objects.is_mesh");return b.Pc(a)};a.Cj=function(a){e.kb("util.is_armature","objects.is_armature");return b.Cj(a)};a.Dg=g.Dg;a.qf=g.qf;a.dk=g.dk;a.lerp=g.lerp;a.jb=g.jb;a.Ld=g.Ld;a.Yv=g.Yv;a.jo=
k.jo};"object"==typeof module&&module.hw&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,n){n("__print");var k=n("__version");a.version=k.version;a.uz=k.uz;a.type=k.type;a.pC=k.pC;a.Rv=k.Rv};"object"==typeof module&&module.hw&&b4w.module.version(exports);b4w.register("guitar_presentation",function(a,n){function k(a,e){e?g.load(f+"guitar_presentation.json",b):console.log("b4w init failure")}function b(a,b){if(b){console.log("App started: "+(new Date).toString());console.log(typeof w);var f=document.getElementsByTagName("script");console.log(f[f.length-1].src.toString());e.ON()}else console.log("b4w load failure")}var e=n("app"),y=n("config"),g=n("data"),B=n("version"),w=n("__logic_nodes"),t="DEBUG"===B.type(),f=y.Iw()+"guitar_presentation/";a.yf=function(){e.yf({canvas_container_id:"main_canvas_container",
callback:k,show_fps:t,console_verbose:t,autoresize:!0})}});b4w.require("guitar_presentation").yf();var Fd=["b4w","$","jQuery"],Gd=[],Od;for(Od in window)-1!=Fd.indexOf(Od)||Od in zd||Gd.push(Od);Gd.length&&console.error("globals detected:",Gd);

var Bd={},Fd;for(Fd in window)Bd[Fd]=!0;var b4w="object"===typeof b4w?b4w:function(a){var l={};a.module=l;var m={};a.ha=function(a,e){var x=l[a];x&&(x.yk=null);m[e||"__b4w_default"]=null};a.register=function(a,e){l[a]||(l[a]=e)};a.require=function(a,e){if(!l[a])throw Error('Module "'+a+'" not found');e=e||"__b4w_default";m[e]||(m[e]=function(a){return function(b){var e=l[b];if(!e)throw Error('Module "'+b+'" not found');e.yk||(e.yk={});e.yk[a]||(e.yk[a]={},e(e.yk[a],m[a]));return e.yk[a]}}(e));return m[e](a)};a.module_check=function(a){return l[a]?
!0:!1};a.get_namespace=function(a){for(var e in m)if(m[e]==a)return e;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.app=function(a,l){function m(){var a=p.po();document.addEventListener("visibilitychange",function(){document.hidden?(a=p.po(),p.pause()):a||p.oh()},!1)}function b(){var a=0,c=d.le(),h=p.po(),n=!0;p.Sm(function(){if(0==a%10){var d=c.getBoundingClientRect();d.top>window.innerHeight||0>d.bottom?(n&&(h=p.po()),p.pause(),n=!1):h||n||(p.oh(),n=!0)}a++})}function e(a,c,h,n){var b=document.createElement("canvas"),e=document.getElementById(a);b.style.position="absolute";b.style.left=0;b.style.top=
0;b.style.width=e.offsetWidth+"px";b.style.height=e.offsetHeight+"px";b.width=e.offsetWidth*window.devicePixelRatio;b.height=e.offsetHeight*window.devicePixelRatio;c?(c=document.createElement("canvas"),c.style.position="absolute",b.style.left=0,b.style.top=0,c.style.pointerEvents="none"):c=null;e||(K.error('Warning: canvas container "'+a+'" not found, appending to body'),e=document.body);e.appendChild(b);if(!p.zf(b,c))return h&&F("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
n),!1;c&&d.xr(c,"LAST");return!0}function x(a,c){a?(c&&(document.getElementById(c).style.display="block"),n=document.getElementById(a)):(n=document.createElement("div"),n.innerHTML=0,n.style.cssText="position:absolute;top: 23px;right: 20px;font-size: 45px;line-height: 50px;font-weight: bold;color: #000;",d.xr(n,"JUST_AFTER_CANVAS"))}function k(a,d){var c=String(a);d&&(c+="/"+String(d));n.innerHTML=c}function B(a){a=document.getElementById(a);var d=a.cloneNode(!0);a.parentNode.replaceChild(d,a);return d}
function r(a,d,c){var h=Math.max(D.DP(a),1),n=y.jl(a,aa);d=u.Cb(n,d,W);d[1]=0;C.normalize(d,d);C.scale(d,h*c,d);c=y.yf(a,ba);C.add(c,d,c);D.lc(a,c)}function w(a,d){var c=D.AE(a,ea);if(c.up!=c.down){var h=D.hl(a,la)[1],c=(c.down-h)/(c.down-c.up),h=D.zE(a,ea),c=Math.max(c,2/h.max);D.BE(a,0,c*d)}}function f(a,d,c,h){y.Ff(a,5*d,5*c,5*h)}function q(a,d,c){var h=D.jz(a),n=Math.abs(d);c=Math.pow(n*c,1-Math.pow(n*c,.15));y.Ff(a,0,0>d?.001<h?-h*c:0:c/(1-c)*h,0)}function g(a,d,c,h){for(var n=c*d;0<a;--a)c+=
n,h+=n,n=c*d;return h}function z(a,d,c,h,n){n?(n=D.kT(a,W),a=D.yf(a),a=C.dist(n,a)+h,h=0<d?g(d,-c,a,h):g(-d,c/(1-c),a,h)):h-=2*d*c;return h}function A(a,d,n,b,e){function v(a,d,c,wa){if(1==c){D.hg(a,G);var n=F?.003*G.trans:.003*G.rot;c=h.Xe(a,d,0);h.gg(a,d,0)===h.Pp?(xb+="X"==wa?-c*n:0,Oa+="Y"==wa?-c*n:0):h.gg(a,d,0)===h.Np&&(a=F?.003*G.rot:7.5E-4*G.trans,Qb+="X"==wa?-c*a:0,Yb+="Y"==wa?-c*a:0)}}function p(a){D.hg(a,G);eb-=.05*G.zoom}function k(a){D.hg(a,G);tb-=.002*G.trans}function g(a){D.hg(a,G);
eb+=.05*G.zoom}function m(a){D.hg(a,G);tb+=.002*G.trans}function K(a,d,c,wa){if(1==c){c=h.Xe(a,d,1);D.hg(a,G);if(F)n=.003*G.trans,b=7.5E-4*G.rot;else var n=.003*G.rot,b=7.5E-4*G.trans;if(1===h.gg(a,d,0))Ha+="X"==wa?-c*n:0,jb+="Y"==wa?-c*n:0;else if(2===h.gg(a,d,0)||3===h.gg(a,d,0))Sa+="X"==wa?-c*b:0,qa+="Y"==wa?-c*b:0}}function Q(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function x(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function M(a){return a[0]&&(a[1]||-.1>a[2])}function A(a){return a[0]&&(a[1]||.1<
a[2])}function N(a){return a[0]&&(a[1]||a[2]||a[3])}function U(a,d,c){if(1==c)switch(c=h.Xe(a,d,0),D.hg(a,G),d){case "FORWARD":aa?ma[0]=1:F?(d=D.hl(a,la)[1],d=Math.abs(d)>=Math.PI/4?u.Oi:u.md,r(a,d,.5*G.trans*c)):H?q(a,-G.zoom,c):f(a,0,-G.trans*c,0);break;case "BACKWARD":aa?ma[0]=-1:F?(d=D.hl(a,la)[1],d=Math.abs(d)>=Math.PI/4?u.lf:u.wc,r(a,d,.5*G.trans*c)):H?q(a,G.zoom,c):f(a,0,G.trans*c,0);break;case "UP":F?w(a,30*-G.zoom*c):aa||f(a,0,0,-G.trans*c);break;case "DOWN":F?w(a,30*G.zoom*c):aa||f(a,0,
0,G.trans*c);break;case "LEFT":aa?ma[1]=1:F?r(a,u.zt,.5*G.trans*c):f(a,-G.trans*c,0,0);break;case "RIGHT":aa?ma[1]=-1:F?r(a,u.Ke,.5*G.trans*c):f(a,G.trans*c,0,0);break;case "ROT_LEFT":H?D.bp(a,.75*-G.rot*c,0):D.Pn(a,.75*G.rot*c,0);break;case "ROT_RIGHT":H?D.bp(a,.75*G.rot*c,0):D.Pn(a,.75*-G.rot*c,0);break;case "ROT_UP":H?D.bp(a,0,.75*-G.rot*c):D.Pn(a,0,.75*G.rot*c);break;case "ROT_DOWN":H?D.bp(a,0,.75*G.rot*c):D.Pn(a,0,.75*-G.rot*c)}else switch(d){case "FORWARD":case "BACKWARD":aa&&(ma[0]=0);break;
case "LEFT":case "RIGHT":aa&&(ma[1]=0)}aa&&(R.wy(aa,ma[0],ma[1]),a=D.Zq(a,Y),R.Cs(aa,a[0],a[1]))}T=a;O=d;V=n;var B=t.Aw();J(B);var H=!1,aa=null,F=!1;switch(D.Wh(B)){case D.bb:H=!a;break;case D.xc:aa=t.AD();break;case D.Vf:return;case D.yc:F=!0}var G=D.hg(B,fa);a=h.Cq();if(R.Uw(B)){var l=h.Iv(B,null,!0);h.ja(B,"CAMERA_COLLISION",h.Cg,[l],null,function(a,d){var c=h.gg(a,d,0).coll_dist;if(0>c){var wa=h.gg(a,d,0).coll_norm,n=W;C.scale(wa,-.25*c,n);c=y.yf(a,ba);C.add(c,n,c);y.vS(a,c)}})}if(aa){var l=y.yf(B),
ea=y.jl(B),ea=u.ov(ea);l[1]-=.5;R.Is(aa,l,ea);I.fL(B,aa);var ma=new Float32Array(2),Ja=!0;R.Bs(aa,R.Wz);h.Nk(B,"TOGGLE_CHAR_MOVE_TYPE",h.mf,h.qJ,function(){Ja=!Ja;R.Bs(aa,Ja?R.Wz:R.TI)})}var Da=c.oM(),l=Da.length?Da[Da.length-1]:0,Ka,Ma,Ga,ra,ib,Ea;d?Ka=Ma=Ga=ra=ib=Ea=d=l=h.Jv(0):(Ka=h.dc(h.lA),Ma=h.dc(h.jA),Ga=h.dc(h.eA),ra=h.dc(h.fA),ib=h.dc(h.wJ),Ea=h.dc(h.rJ),d=h.Dq(c.Fp,l),l=h.Dq(c.Gp,l));var wa=h.dc(h.kA),fb=h.dc(h.gA),Eb=h.dc(h.hA),na=h.dc(h.iA),ea=h.Mk(c.Bp,Da),cc=h.Mk(c.Cp,Da),oa=h.Mk(c.Dp,
Da),Da=h.Mk(c.Ep,Da);F||(h.ja(B,"FORWARD",h.Ua,[a,Ka,cc],M,U),h.ja(B,"BACKWARD",h.Ua,[a,Ma,cc],A,U));H?(h.ja(B,"ROT_UP",h.Ua,[a,wa,ib,Da],Q,U),h.ja(B,"ROT_DOWN",h.Ua,[a,fb,Ea,Da],x,U),h.ja(B,"ROT_LEFT",h.Ua,[a,Eb,Ga,oa],Q,U),h.ja(B,"ROT_RIGHT",h.Ua,[a,na,ra,oa],x,U)):F?(h.ja(B,"LEFT",h.Ua,[a,Eb,Ga,ea],Q,U),h.ja(B,"RIGHT",h.Ua,[a,na,ra,ea],x,U),h.ja(B,"FORWARD",h.Ua,[a,wa,Ka,cc],Q,U),h.ja(B,"BACKWARD",h.Ua,[a,fb,Ma,cc],x,U),h.ja(B,"UP",h.Ua,[a,Ea,Da],A,U),h.ja(B,"DOWN",h.Ua,[a,ib,Da],M,U)):(h.ja(B,
"UP",h.Ua,[a,ib,d],N,U),h.ja(B,"DOWN",h.Ua,[a,Ea,l],N,U),h.ja(B,"LEFT",h.Ua,[a,Ga,ea],M,U),h.ja(B,"RIGHT",h.Ua,[a,ra,ea],A,U),h.ja(B,"ROT_UP",h.Ua,[a,wa,Da],M,U),h.ja(B,"ROT_DOWN",h.Ua,[a,fb,Da],A,U),h.ja(B,"ROT_LEFT",h.Ua,[a,Eb,oa],M,U),h.ja(B,"ROT_RIGHT",h.Ua,[a,na,oa],A,U));if(!n){var Za=0;n=h.Mv(b);var Fa=0,Da=h.Ov(b);h.ja(B,"MOUSE_WHEEL",h.Bg,[n],null,function(a,d,c){1==c&&(d=h.Xe(a,d,0),D.hg(a,G),H||F?Za=z(a,d,G.zoom,Za,H):(G.trans*=1+d*G.zoom,D.wS(a,G)))});h.ja(B,"TOUCH_ZOOM",h.Bg,[Da],null,
function(a,d,c){1==c&&(c=h.Xe(a,d,0),D.hg(a,G),h.gg(a,d,0)===h.Op&&(Fa=z(a,c,.03*G.zoom,Fa,H)))});h.ja(B,"ZOOM_INTERPOL",h.Cg,[a],null,function(a,d){if(H||F)if(1E-5<Math.abs(Za)||1E-5<Math.abs(Fa)){var c=h.Xe(a,d,0),wa=u.mc(Za,0,c,.1*L);Za-=wa;c=u.mc(Fa,0,c,.15*L);Fa-=c;F?w(a,-(wa+c)):(wa=D.jz(a)+wa+c,wa=Math.max(wa,.001),D.mT(a,wa))}else Fa=Za=0})}var Ha=0,jb=0,Sa=0,qa=0,tb=0,eb=0;H?(h.ja(B,"GMPD_PAN_Y_POS",h.Ua,[d],null,g),h.ja(B,"GMPD_PAN_Y_NEG",h.Ua,[l],null,p),h.ja(B,"GMPD_PAN_X_POS",h.Ua,[ea],
function(a){return-.1>a[0]},k),h.ja(B,"GMPD_PAN_X_NEG",h.Ua,[ea],function(a){return.1<a[0]},m)):F&&(h.ja(B,"GMPD_PAN_X_POS",h.Ua,[oa],function(a){return-.1>a[0]},k),h.ja(B,"GMPD_PAN_X_NEG",h.Ua,[oa],function(a){return.1<a[0]},m));if(e){e=h.Ok("X",window);n=h.Ok("Y",window);d=h.sn(b);var l=h.sn(window),uc=!1,ea=function(a){a[2]?uc=!0:a[0]||(uc=!1);return uc&&a[0]};h.ja(B,"MOUSE_X",h.Cg,[l,e,d],ea,K,"X");h.ja(B,"MOUSE_Y",h.Cg,[l,n,d],ea,K,"Y");e=c.da(c.Oc,window);c.hz(e,!1)}else e=h.Ok("X",b),n=h.Ok("Y",
b),d=h.sn(b),h.ja(B,"MOUSE_X",h.Bg,[d,e],null,K,"X"),h.ja(B,"MOUSE_Y",h.Bg,[d,n],null,K,"Y");var xb=0,Oa=0,Qb=0,Yb=0;e=h.Fq("X",b);b=h.Fq("Y",b);h.ja(B,"TOUCH_X",h.Bg,[e],null,v,"X");h.ja(B,"TOUCH_Y",h.Bg,[b],null,v,"Y");h.ja(B,"ROT_TRANS_INTERPOL",h.Cg,[a],null,function(a,d){if(1E-5<Math.abs(Ha)||1E-5<Math.abs(jb)||1E-5<Math.abs(xb)||1E-5<Math.abs(Oa)||1E-5<Math.abs(Sa)||1E-5<Math.abs(qa)||1E-5<Math.abs(Qb)||1E-5<Math.abs(Yb)||1E-5<Math.abs(tb)||1E-5<Math.abs(eb)){var c=h.Xe(a,d,0),wa=u.mc(Ha,0,
c,.08*L),n=u.mc(jb,0,c,.08*L);Ha-=wa;jb-=n;var b=u.mc(xb,0,c,.12*L),e=u.mc(Oa,0,c,.12*L);xb-=b;Oa-=e;var f=u.mc(Sa,0,c,.08*L),y=u.mc(qa,0,c,.08*L);Sa-=f;qa-=y;var C=u.mc(Qb,0,c,.12*L),v=u.mc(Yb,0,c,.12*L);Qb-=C;Yb-=v;var p=u.mc(tb,0,c,.08*L),c=u.mc(eb,0,c,.08*L);tb-=p;eb-=c;H?(D.bp(a,wa+b,n+e),n=D.jz(a),D.lT(a,n*(f+C+p),n*(y+v+c))):F?(wa+b&&r(a,u.Ke,.2*(wa+b)),n+e&&(y=D.hl(a,la)[1],r(a,Math.abs(y)>Math.PI/4?u.lf:u.wc,.2*(n+e))),D.BE(a,f+C+p,0)):(D.Pn(a,.5*(wa+b),.5*(n+e)),aa&&(f=D.Zq(a,Y),R.Cs(aa,
f[0],f[1])))}});h.Nk(B,"DEC_STEREO_DIST",h.mf,h.uJ,function(a){var d=D.$D(a);D.bH(a,.9*d)});h.Nk(B,"INC_STEREO_DIST",h.mf,h.xJ,function(a){var d=D.$D(a);D.bH(a,1.1*d)})}function J(a){var d=D.Wh(a),c=h.Hv(function(){var c=D.Wh(a),n=c!=d;d=c;return n});h.ja(a,"CHANGE_MOVE_STYLE",h.Cg,[c],null,function(){N();A(T,O,V)})}function N(){for(var a=t.Aw(),d="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE".split(" "),
c=0;c<d.length;c++)h.Oo(a,d[c]);D.Wh(a)==D.xc&&t.AD()&&I.remove(a)}function F(a,d,c,n){var h=document.createElement("div"),b=document.createElement("div"),e=document.createElement("div");if(n)for(var f=0;f<n.length;f++){var y=document.getElementById(n[f]);y&&y.parentNode.removeChild(y)}h.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";b.style.cssText="color:#fff;font-size:24px;";e.style.cssText="color:#fff;font-size:20px;";b.innerHTML=
a;e.innerHTML=d+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";h.appendChild(b);h.appendChild(e);document.body.appendChild(h)}function G(a,d,c,n,h){function b(){var f=performance.now()-e;h(d+f*(c-d)/n);(f>=n||!a.parentNode)&&p.wR(b)}var e=performance.now();p.Sm(b)}l("animation");var D=l("camera"),H=l("config"),I=l("constraints"),d=l("container"),h=l("controls"),v=l("data"),M=l("debug"),c=l("input"),p=l("main"),R=l("physics"),K=l("print"),t=
l("scenes"),y=l("transform"),u=l("util"),C=l("vec3"),L=1,n=null,T=!1,O=!1,V=!1,Y=new Float32Array(2),la=new Float32Array(2),W=new Float32Array(3),ba=new Float32Array(3);new Float32Array(3);var aa=new Float32Array(4),fa={},ea={};a.zf=function(a){function c(){var a=e(C,I,K,u),n=d.$q();if(a){var h=d.le();d.oi();z&&(x(L,t),p.cS(k));Q&&(m(),b());g&&p.Sm(function(){h.style.height=h.clientWidth/g+"px"});y&&p.Sm(d.oi);r&&p.Sm(function(){d.sw()});f(n,!0)}else f(n,!1)}function n(a){a.keyCode==h.vJ&&(p.po()?
p.oh():p.pause())}function f(){}a=a||{};var y=!1,C=null,u=null,L=null,g=0,t=null,T=!0,Q=!0,K=!0,O=!1,z=!1,q=!1,r=!1,w;for(w in a)switch(w){case "canvas_container_id":C=a.canvas_container_id;break;case "callback":f=a.callback;break;case "autoresize":y=a.autoresize;break;case "do_not_use_onload":break;case "show_hud_debug_info":q=a.show_hud_debug_info;break;case "sfx_mix_mode":O=a.sfx_mix_mode;break;case "show_fps":z=a.show_fps;break;case "track_container_position":r=a.track_container_position;break;
case "fps_wrapper_id":t=a.fps_wrapper_id;break;case "fps_elem_id":L=a.fps_elem_id;break;case "error_purge_elements":u=a.error_purge_elements;break;case "report_init_failure":K=a.report_init_failure;break;case "pause_invisible":Q=a.pause_invisible;break;case "key_pause_enabled":T=a.key_pause_enabled;break;case "force_container_ratio":g=a.force_container_ratio;break;default:H.set(w,a[w])}T&&document.addEventListener("keydown",n,!1);H.set("show_hud_debug_info",q);H.set("sfx_mix_mode",O);var I=q||O||
null;"complete"==document.readyState?window.setTimeout(c,0):window.addEventListener("load",c,!1);window.addEventListener("unload",function(){v.ha()},!1)};a.oi=function(){K.kb("app.resize_to_container","container.resize_to_container");d.oi()};a.p1=function(a,d){var c=B(a);c.addEventListener("mouseup",function(){d(c.value)},!1)};a.o1=function(a,d){var c=B(a);c.addEventListener("change",function(){var a=c.checked;d(void 0!=a?a:c.value)},!1)};a.q1=function(a,d){var c=B(a);c.addEventListener("keypress",
function(a){d(a.keyCode,c.value)},!1)};a.YN=A;a.MX=N;a.S0=function(a){K.bg("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var d=t.Aw();D.Ey(d,a)};a.YX=function(a){function d(a){return a[0]&&(a[1]||a[2])}function c(a,d,b){if(1==b)switch(b=h.Xe(a,d,0),d){case "FORWARD":n?R.ym(a,1):y.Ff(a,0,0,1*b);break;case "BACKWARD":n?R.ym(a,-1):y.Ff(a,0,0,-1*b);break;case "LEFT":n?R.xm(a,-1):y.Ff(a,1*b,0,0);break;case "RIGHT":n?
R.xm(a,1):y.Ff(a,-1*b,0,0)}else switch(d){case "FORWARD":case "BACKWARD":n&&R.ym(a,0);break;case "LEFT":case "RIGHT":n&&R.xm(a,0)}}var n=R.Fd(a)||R.Gd(a),b=h.Cq(),e=h.dc(h.lA),f=h.dc(h.jA),C=h.dc(h.eA),v=h.dc(h.fA),u=h.dc(h.kA),L=h.dc(h.gA),p=h.dc(h.hA),k=h.dc(h.iA);h.ja(a,"FORWARD",h.Ua,[b,e,u],d,c);h.ja(a,"BACKWARD",h.Ua,[b,f,L],d,c);h.ja(a,"LEFT",h.Ua,[b,C,p],d,c);h.ja(a,"RIGHT",h.Ua,[b,v,k],d,c)};a.OX=function(a){for(var d=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<d.length;c++)h.Oo(a,d[c])};
a.WX=function(){K.fc("app.enable_controls() deprecated")};a.NX=function(){K.fc("app.disable_controls() deprecated")};a.XX=function(){h.Nk(null,"CAMERA_SHOT",h.mf,h.sJ,function(){M.zQ()});h.Nk(null,"LIGHT_SHOT",h.mf,h.tJ,function(){M.CQ()});h.Nk(null,"TELEMETRY",h.mf,h.yJ,function(){M.Tx()})};a.G0=function(a,d,c){function n(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?d():(document.removeEventListener("fullscreenchange",
n,!1),document.removeEventListener("webkitfullscreenchange",n,!1),document.removeEventListener("mozfullscreenchange",n,!1),document.removeEventListener("MSFullscreenChange",n,!1),c())}d=d||function(){};c=c||function(){};document.addEventListener("fullscreenchange",n,!1);document.addEventListener("webkitfullscreenchange",n,!1);document.addEventListener("mozfullscreenchange",n,!1);document.addEventListener("MSFullscreenChange",n,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||
a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():K.error("B4W App: request fullscreen method is not supported")};a.eY=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof a&&K.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.fX=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||
window.document.webkitFullscreenEnabled?!0:!1};a.F0=F;a.OZ=function(a){a=!!a;var d=decodeURIComponent(location.href.toString());if(-1==d.indexOf("?"))return null;for(var d=d.split("?")[1].split("&"),c={},n=0;n<d.length;n++){var h=d[n].split("="),b=h[0];1<h.length?(h=h[1],a?b in c?c[b].push(h):c[b]=[h]:c[b]=h):a?b in c||(c[b]=[]):c[b]=""}return c};a.Rv=function(a,d,c,n,h,b,e,f){function y(h){a&&(C[d]=b+h+e,c>n&&h<=n||c<n&&h>=n)&&(C[d]=b+n+e,f())}if(a&&d&&isFinite(c)&&isFinite(n)&&isFinite(h)){b=b||
"";e=e||"";f=f||function(){};var C=a.style,v=d.charAt(0).toUpperCase()+d.slice(1);if(void 0==C[d])if(void 0!=C["webkit"+v])d="webkit"+v;else if(void 0!=C["ms"+v])d="ms"+v;else if(void 0!=C["moz"+v])d="moz"+v;else return;G(a,c,n,h,y)}};a.CL=function(a,d,c,n,h,b){function e(h){a&&(0<=h&&a.setAttribute(d,h),c>n&&h<=n||c<n&&h>=n)&&(a.setAttribute(d,n),b())}a&&d&&isFinite(c)&&isFinite(n)&&isFinite(h)&&(b=b||function(){},G(a,c,n,h,e))};a.rR=function(d){if(d.length){var c=d.shift(),n=c.elem,h=c.prop,b=c.from,
e=c.to,f=c.duration,y=c.opt_prefix,C=c.opt_suffix,v=function(){c.cb&&c.cb();a.rR(d)};"css"==c.type?a.Rv(n,h,b,e,f,y,C,v):"attr"==c.type&&a.CL(n,h,b,e,f,v)}};a.T0=function(a){L=a};a.IY=function(){return L}};b4w.module.animation=function(a,l){var m=l("__animation"),b=l("__armature"),e=l("__obj_util"),x=l("__print"),k=l("__tsr");a.zc=m.zc;a.BA=m.BA;a.CA=m.CA;a.DA=m.DA;a.EA=m.EA;a.FA=m.FA;a.GA=m.GA;a.Gu=m.Gu;a.Km=m.Km;a.tA=m.tA;a.Bu=m.Bu;a.Cu=m.Cu;a.wA=m.wA;a.vA=m.vA;a.uA=m.uA;a.Lp=m.Lp;a.Oz=m.Oz;a.Pz=m.Pz;a.wt=m.wt;var B=k.create();a.Xb=function(a){return m.Xb(a)};a.lD=function(a){return m.MF(a)?m.lD(a):[]};a.OY=function(a,b){if(!m.Xb(a))return null;b=b||m.zc;return m.QO(a,b)};a.apply=function(a,b,e){if(e>
m.Gu)x.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=e||m.zc;if(m.Xb(a)){var k=m.Mw(a,b);if(-1!=k&&k!=e){x.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+k+'").');return}}m.wU(a,b)?m.apply(a,b,e):x.error('No fcurves in action "'+b+'"')}};a.remove=function(a){m.remove(a)};a.uG=function(a,b){m.Xb(a)&&(b=b||m.zc,m.uG(a,b))};a.cq=function(a){m.cq(a)};a.play=function(a,b,e){m.Xb(a)?(e=e||m.zc,m.play(a,
b,e),m.RT(a,0,e,!0)):x.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){m.Xb(a)&&(b=b||m.zc,m.stop(a,b))};a.bi=function(a,b){if(!m.Xb(a))return!1;b=b||m.zc;return m.bi(a,b)};a.Xl=function(a,b,e){m.Xb(a)&&(e=e||m.zc,m.Xl(a,b,e))};a.By=function(a,b){m.Xb(a)&&m.By(a,b)};a.e1=function(a,b){if(m.Xb(a)){b=b||m.zc;var e=m.Dw(a,b),k=m.Cw(a,b);m.Xl(a,e+k-m.zJ,b)}};a.Zn=function(a,b){if(!m.Xb(a))return 0;b=b||m.zc;return m.vD(a,b)};a.$G=function(a,b,e){m.Xb(a)&&(e=e||m.zc,m.$G(a,
b||1,e))};a.XD=function(a,b){if(!m.Xb(a))return 0;b=b||m.zc;return a.W[b]?m.XD(a,b):0};a.Dw=function(a,b){return m.Xb(a)&&(b=b||m.zc,a.W[b])?m.Dw(a,b):-1};a.Cw=function(a,b){return m.Xb(a)&&(b=b||m.zc,a.W[b])?m.Cw(a,b):-1};a.Uo=function(a,b,e){m.Xb(a)&&(e=e||m.zc,m.Uo(a,b,e))};a.oD=function(a,b){if(!m.Xb(a))return null;b=b||m.zc;return m.oD(a,b)};a.hB=function(a,b,e,k){k=k||m.zc;m.Xb(a)&&m.hB(a,b,e,k)};a.$C=function(a){return m.$C(a)};a.GY=function(a,k,f){x.kb("get_bone_translation","armature.get_bone_tsr");
if(!e.$g(a))return null;if(!b.iM(a,k))return x.error('There is no bone: "',k,'" in "',a.name,'".'),null;f||(f=new Float32Array(3));b.Yq(a,k,!1,B);f[0]=B[0];f[1]=B[1];f[2]=B[2];return f};a.ZY=function(){x.fc("get_first_armature_object() deprecated");return null};a.Mw=function(a,b){return m.Xb(a)&&b?m.Mw(a,b):null};a.mD=function(a,b){return m.Xb(a)?m.mD(a,b):null};a.iB=function(a,b){return m.iB(a,b)};a.KZ=function(a){return a.g.Jh};a.YG=function(a,b,f){e.$g(a)?(b=Math.min(Math.max(b,0),1),a.g.Jh!=b&&
m.YG(a,b,f||0)):x.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.__animation=function(a,l){function m(a,d){var c=a.W[d];c&&c.pw&&c.Mn&&(c.Mn=!1,c.pw(a,d))}function b(a,d,c){c=a.W[c];c.type=30;var b=d.pa,n=d.La-b+1;c.start=b;c.length=n;c.ge=b;c.Fg=d.name;for(n=b=0;n<a.Gc.length;n++){var h=a.Gc[n];if(h==d)break;else b+=h.La-h.pa+1}c.uI=b}function e(a,d){a.type=50;a.Fg=d.name;a.start=d.pa;a.length=d.La-a.start;d.nd||(a.length+=d.lx)}function x(a){return a.replace(/_B4W_BAKED$/,"")}function k(a,d){if(a.animation_data){var c=a.animation_data.action;c&&60==
c.j.type&&d.push(c)}for(var c=a.nodes,b=0;b<c.length;b++){var n=c[b];n.node_group&&(n=n.node_group.node_tree)&&k(n,d)}}function B(a){return T.hc(a)&&a.g.Gc?!0:!1}function r(a,d,c){var b=a.W;if(-1==c)for(c=0;8>c;c++){var n=b[c];n&&(n.ge=d,f(a,0,c,!0))}else if(n=b[c])n.ge=d,f(a,0,c,!0)}function w(a,d,c){if(-1==d)for(d=0;8>d;d++){var b=a[d];b&&c(b)}else(b=a[d])&&c(b)}function f(a,d,c,b){F(a,d,c,b);m(a,c);a.g.Yi&&(H(a,d),D(a,d))}function q(a,c,b){var n=c.frame_range;if(n[0]>n[1])return Y.warn('Incompatible action "'+
c.name+'" has been applied to object "'+a.name+'"'),!1;var h=c.j,e=a.W[b];e.Fg=c.name;e.Lu=n;e.$A=h.XF;e.YA=h.tB;e.Lg.set(h.Lg);e.start=n[0];e.length=n[1]-n[0];e.ge=n[0];switch(h.type){case 10:if(T.$g(a)){e.type=10;var f=g(a,c);if(!f){for(var f=a.g.Oe,n=[],y=[],C=c.j.Jx,v=0;v<C;v++){for(var u in f){var L=f[u],p=L.et,Q=c.j.hv[u];Q?ea.copy(Q.subarray(8*v,8*v+8),p):ea.identity(p);L.ft=!1}L=I(f);n.push(L.trans);y.push(L.Wa)}f={trans:n,Wa:y};a.zk.push(c,f)}e.trans=f.trans;e.Wa=f.Wa;e=f;f=a.g;u=f.Rs;y=
a.W[b];n=y.Ry;a:{C=f.lH;for(v=0;v<C.length;v+=2)if(c==C[v]){C=C[v+1];break a}C=null}if(C)y.Ry=C;else{for(y=0;y<u.length;y++){for(var C=u[y].Ik,v=[],L=[],p=e.trans,Q=e.Wa,k=0;k<p.length;k++){var t=d(p[k],Q[k],C);v.push(t.trans);L.push(t.Wa)}n.push({trans:v,Wa:L})}f.lH.push(c,n)}f.Yi&&(c=f.it,b>c[1]?(e=c[1],c[1]=b,c[0]=e):b>c[0]&&b<c[1]&&(c[0]=b),z(a))}break;case 40:T.Hj(a)&&(e.volume=h.Fa.volume||null,e.pitch=h.Fa.pitch||null,e.type=40);break;case 70:T.nl(a)&&(e.color=h.Fa.color||null,e.Sg=h.Fa.energy||
null,e.type=70);break;case 60:if("MESH"==a.type){e.type=60;u=g(a,c);if(!u){u=[];n=[];y=[];C=[];v=[];L=c.j;for(f in L.Fa)for(p=c.name+"%join%"+f,Q=0;Q<a.A.length;Q++)for(k=a.A[Q].X,t=0;t<k.length;t++){var m=k[t],wa=m.CF,K=m.DF;wa&&(wa=J(f,p,L,n,u,wa),K=J(f,p,L,C,y,K),(wa||K)&&v.push(m))}u={vU:u,values:n,IR:y,JR:C,Ur:v};a.zk.push(c,u)}e.Il=u.vU;e.FF=u.values;e.Hl=u.IR;e.EF=u.JR;e.Ur=u.Ur}break;case 20:if(f=h.Fa.tsr){e.type=20;u=g(a,c);if(!u){u=c.j.Jx;n=[];y=[];for(C=0;C<u;C++)n.push(f.subarray(8*C,
8*C+4)),y.push(f.subarray(8*C+4,8*C+8));u={trans:n,Wa:y};a.zk.push(c,u)}e.trans=u.trans;e.Wa=u.Wa;O.Lx(a)&&O.cU(a,e.trans[0],e.Wa[0])}else return Y.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:T.qo(a)&&(e.Sg=h.Fa["light_settings.environment_energy"]||null,e.ne=h.Fa.horizon_color||null,e.Je=h.Fa.zenith_color||null,e.XC=h.Fa["mist_settings.intensity"]||null,e.VC=h.Fa["mist_settings.depth"]||null,e.YC=h.Fa["mist_settings.start"]||null,e.WC=h.Fa["mist_settings.height"]||
null,e.UC=h.Fa.b4w_fog_color||null,e.type=80)}T.$g(a)&&10!=h.type&&A(a,b);return!0}function g(a,d){for(var c=a.zk,n=0;n<c.length;n+=2)if(d==c[n])return c[n+1];return null}function z(a){var d=a.g.it;if(-1!=d[0]&&-1!=d[1]){var c=a.W;a=c[d[1]].ge;var n=Math.floor(a),b=a-n,d=c[d[0]];a=d.ge;n=Math.floor(a);d.ge=n+b}}function A(a,d){var c=a.g.it,n=c[1];c[0]=-1;c[1]=-1;if(-1!=d)for(var b=a.W;0<=n;n--){var h=b[n];if(h&&10==h.type)if(n>c[1])c[1]=n;else{n>c[0]&&(c[1]=n);break}}}function J(a,d,c,n,b,h){for(var e=
!1,f=0;f<h.length;f+=2)d==h[f]&&(b.push(h[f+1]),n.push(new Float32Array(c.Fa[a])),e=!0);return e}function N(a){a=a.j;for(var d in a.Fa)if(-1!=d.indexOf("nodes"))return!0;return!1}function F(a,d,c,n){if((c=a.W[c])&&null!=c.type&&(c.play||n)){var b=a.g,h=c.ge,e=c.start,f=c.length,h=h+c.speed*d*aa.Ec(),C=c.type,y=c.speed;if(0<=y&&h>=e+f||0>y&&h<e)switch(n||(c.Mn=!0),c.behavior){case 10:h=0<=y?(h-e)%f+e:e+f-1E-6;break;case 20:h=0<=y?e:e+f-1E-6;c.play=!1;break;case 30:h=0<=y?e+f-1E-6:e,c.play=!1}c.ge=
h;switch(C){case 10:if(!b.Yi){n=G(c);d=n[0];var v=n[1];n=n[2];b.Kd=c.Wa[d];b.te=c.Wa[v];b.Td=c.trans[d];b.Ee=c.trans[v];b.Ue=n;n=b.Rs;c=c.Ry;for(var u=0;u<n.length;u++){var L=n[u],p=c[u];L.Kd=p.Wa[d];L.te=p.Wa[v];L.Td=p.trans[d];L.Ee=p.trans[v];L.Ue=b.Ue}fa.p(a)}break;case 20:n=G(c);var b=ha,v=n[0],u=n[1],L=n[2],p=c.trans,k=p[v][1],h=p[v][2],e=p[u][1],f=p[u][2];b[0]=(1-L)*p[v][0]+L*p[u][0];b[1]=(1-L)*k+L*e;b[2]=(1-L)*h+L*f;v=Z;h=n[0];u=n[1];L=n[2];p=c.Wa;k=Q;k[0]=p[h][0];k[1]=p[h][1];k[2]=p[h][2];
k[3]=p[h][3];h=Ba;h[0]=p[u][0];h[1]=p[u][1];h[2]=p[u][2];h[3]=p[u][3];la.slerp(k,h,L,v);u=n[2];L=c.trans;n=(1-u)*L[n[0]][3]+u*L[n[1]][3];a.parent&&a.ls&&(u=ta,ea.rh(b,n,v,u),ea.multiply(a.ls,u,u),ea.Xh(u,b),ea.Lw(u,v),n=ea.Pc(u));c.rz&&(u=ja,fa.yf(a,u),ia.bm(b,u,d,c.rz,b));c.$x&&(u=Q,fa.jl(a,u),ia.qH(v,u,d,c.$x,v));h=c.Lg;h[0]&&fa.Js(a,b);h[1]&&fa.Hs(a,v);h[2]&&fa.Ly(a,n);fa.p(a);V.u(a);break;case 30:n=c.ge-c.start;0>n&&(n=0);n>=c.length&&(n=c.length);a=Math.floor(n);d=a+1;n-=a;10!=c.behavior&&d==
c.length&&(d=--a,n=1);c=c.uI;Ca[0]=a+c;Ca[1]=d+c;Ca[2]=n;n=Ca;b.Az=n[0];b.tI=n[2];break;case 40:n=G(c);d=n[0];b=n[1];n=n[2];c.volume&&ba.AS(a,(1-n)*c.volume[d]+n*c.volume[b]);c.pitch&&ba.jR(a,(1-n)*c.pitch[d]+n*c.pitch[b]);break;case 50:d=10==c.behavior?(h-e)/aa.Ec():h/aa.Ec();O.tS(a,c.Fg,d);break;case 60:n=G(c);d=n[0];b=n[1];n=n[2];p=c.FF;k=c.Il;a=c.EF;v=c.Hl;u=c.Ur;for(c=0;c<k.length;c++)for(h=p[c],L=k[c],e=(1-n)*h[d]+n*h[b],h=0;h<u.length;h++)u[h].Qj[L]=e;for(c=0;c<v.length;c++)for(p=a[c],L=v[c],
p=va.lerp(p.subarray(3*d,3*d+3),p.subarray(3*b,3*b+3),n,ha),h=0;h<u.length;h++)u[h].qe[3*L]=p[0],u[h].qe[3*L+1]=p[1],u[h].qe[3*L+2]=p[2];break;case 70:n=G(c);d=n[0];b=n[1];n=n[2];h=c.Lg;(f=c.Sg)&&h[0]&&E.kS(a.$b,(1-n)*f[d]+n*f[b]);(c=c.color)&&h[1]&&(ha[0]=(1-n)*c[3*d]+n*c[3*b],ha[1]=(1-n)*c[3*d+1]+n*c[3*b+1],ha[2]=(1-n)*c[3*d+2]+n*c[3*b+2],E.jS(a.$b,ha));e=a.A;for(c=0;c<e.length;c++)ka.OT(a,e[c].Ta);break;case 80:n=G(c);d=n[0];b=n[1];n=n[2];h=c.Lg;e=a.A;y=ka.qa(e[0].Ta,"MAIN_OPAQUE");f=c.Sg;f=h[0]?
(1-n)*f[d]+n*f[b]:y.Sg;C=c.ne;h[1]?(ha[0]=(1-n)*C[3*d]+n*C[3*b],ha[1]=(1-n)*C[3*d+1]+n*C[3*b+1],ha[2]=(1-n)*C[3*d+2]+n*C[3*b+2],C=ha):C=y.ne;var g=c.Je;h[2]?(ja[0]=(1-n)*g[3*d]+n*g[3*b],ja[1]=(1-n)*g[3*d+1]+n*g[3*b+1],ja[2]=(1-n)*g[3*d+2]+n*g[3*b+2],y=ja):y=y.Je;g=c.XC;h[3]&&(v=(1-n)*g[d]+n*g[b]);g=c.VC;h[4]&&(u=(1-n)*g[d]+n*g[b]);g=c.YC;h[5]&&(L=(1-n)*g[d]+n*g[b]);g=c.WC;h[6]&&(p=(1-n)*g[d]+n*g[b]);c=c.UC;h[7]&&(Z[0]=(1-n)*c[3*d]+n*c[3*b],Z[1]=(1-n)*c[3*d+1]+n*c[3*b+1],Z[2]=(1-n)*c[3*d+2]+n*c[3*
b+2],k=Z);for(c=0;c<e.length;c++)d=a.A[c].Ta,(h[0]||h[1]||h[2])&&ka.yy(d,f,C,y),h[3]&&ka.aS(d,v),h[4]&&ka.ZR(d,u),h[5]&&ka.bS(d,L),h[6]&&ka.$R(d,p),h[7]&&ka.Cy(d,k);break;default:ia.l("Unknown animation type:"+C)}}}function G(a){var c=a.Lu[0],d=a.Lu[1]-c,c=a.ge-c;0>c&&(c=0);c>=d&&(c=d);c/=a.$A;d=Math.floor(c);a=a.YA[d]?c-d:0;c=Math.ceil(d+a);Ca[0]=d;Ca[1]=c;Ca[2]=a;return Ca}function D(a,c){var d=a.g,n=d.Jh,b=d.it,h=b[0],b=b[1];if(-1!=b){if(-1!=h){var e=a.W[h];if(e.play||0==c){var f=G(e),C=f[0],y=
f[1];d.Ue=f[2];var f=e.Wa[C],u=e.Wa[y],C=e.trans[C],y=e.trans[y]}else n=1}else n=1;b=a.W[b];if(b.play||0==c){var h=G(b),v=h[0],L=h[1];d.Ue=h[2]}else if(-1!=h&&e.play)n=0;else return;h=b.Wa[v];e=b.Wa[L];v=b.trans[v];L=b.trans[L];if(1==n)d.Kd.set(h),d.te.set(e),d.Td.set(v),d.Ee.set(L);else if(0==n)d.Kd.set(f),d.te.set(u),d.Td.set(C),d.Ee.set(y);else{for(b=0;b<f.length;b+=4){for(var p=Z,k=Q,g=0;4>g;g++)p[g]=f[b+g],k[g]=h[b+g];la.slerp(p,k,n,p);for(g=0;4>g;g++)d.Kd[b+g]=p[g];for(g=0;4>g;g++)p[g]=u[b+
g],k[g]=e[b+g];la.slerp(p,k,n,p);for(g=0;4>g;g++)d.te[b+g]=p[g]}ia.vB(C,v,n,d.Td);ia.vB(y,L,n,d.Ee)}fa.p(a);ga.aU(a)}}function H(a,c){var d=a.g,n=d.Jh,b=d.Qu;if(0!=b){var n=d.Pu-n,h=b*c;ia.sign(n)==ia.sign(b)&&Math.abs(h)<Math.abs(n)?d.Jh+=h:(d.Jh=d.Pu,d.Qu=0)}}function I(a){var c=[],d=[],n=new Float32Array(4),b=new Float32Array(4),h;for(h in a){var e=a[h],f=n,C=b,y=e.oq,u=y[y.length-1],v=u.tz;u.ft||ea.identity(v);for(u=y.length-1;0<=u;u--){var L=y[u],p=L.tz;if(L.ft)v=p;else{var g=L.Di,k=L.et;ea.invert(g,
ta);ea.multiply(k,ta,ta);ea.multiply(g,ta,ta);ea.multiply(v,ta,p);v=p;L.ft=!0}}y=L.tz;f[0]=y[0];f[1]=y[1];f[2]=y[2];f[3]=y[3];C[0]=y[4];C[1]=y[5];C[2]=y[6];C[3]=y[7];la.normalize(C,C);e=e.Mh;for(f=0;4>f;f++)C=4*e+f,c[C]=n[f],d[C]=b[f]}return{trans:c,Wa:d}}function d(a,c,d){var n=[],b=[];new Float32Array(4);new Float32Array(4);for(var h in d)for(var e=d[h],f=e.Mh,e=e.$v,y=0;4>y;y++){var C=4*e+y,u=4*f+y;n[C]=a[u];b[C]=c[u]}n=new Float32Array(n);b=new Float32Array(b);return{trans:n,Wa:b}}function h(a){var c=
a.j,d;if(c.hv)d=10;else if(c.Fa)if("volume"in c.Fa||"pitch"in c.Fa)d=40;else if(N(a))d=60;else{var n;a:{if(a.j.Fa){n=a.fcurves;for(var b in n)if("color"==b&&!n[b][3]){n=!0;break a}if("energy"==b){n=!0;break a}}n=!1}if(n)d=70;else if(n=a.j.Fa,"light_settings.environment_energy"in n||"horizon_color"in n||"zenith_color"in n||"mist_settings.intensity"in n||"mist_settings.depth"in n||"mist_settings.start"in n||"mist_settings.height"in n||"b4w_fog_color"in n)d=80;else{a:{if(a.j.Fa)for(d in a=a.fcurves,
a)if("location"==d||"rotation_quaternion"==d||"scale"==d){d=!0;break a}d=!1}d=d?20:0}}else d=0;c.type=d}function N(a){if(a=a.j.Fa)for(var c in a)if(-1!=c.indexOf("nodes"))return!0;return!1}function v(a,c){c[0]=c[1]=c[2]=0;for(var d in a)"location"==d?c[0]=1:"rotation_quaternion"==d?c[1]=1:"scale"==d&&(c[2]=1)}function M(a,c){c[0]=c[1]=0;for(var d in a)"energy"==d?c[0]=1:"color"==d&&(c[1]=1)}function c(a,c){c[0]=c[1]=c[2]=0;c[3]=c[4]=c[5]=0;c[6]=c[7]=0;for(var d in a)"light_settings.environment_energy"==
d?c[0]=1:"horizon_color"==d?c[1]=1:"zenith_color"==d?c[2]=1:"mist_settings.intensity"==d?c[3]=1:"mist_settings.depth"==d?c[4]=1:"mist_settings.start"==d?c[5]=1:"mist_settings.height"==d?c[6]=1:"b4w_fog_color"==d&&(c[7]=1)}function p(a,c,d,n,b,h,e){var f=a+(c-a)/2,y=R(f,n,b,h,e)-d;return.02>Math.abs(y)?f:0<y?p(a,f,d,n,b,h,e):p(f,c,d,n,b,h,e)}function R(a,c,d,n,b){var h=1-a;return c*h*h*h+3*d*h*h*a+3*n*h*a*a+b*a*a*a}function K(a,c){var d={type:null,Fg:null,Lu:null,$A:0,YA:null,Lg:new Int8Array(8),Wa:null,
trans:null,Ry:[],play:!1,behavior:20,ge:0,start:0,length:0,rz:0,$x:0,Mn:!1,uI:null,speed:1,volume:null,pitch:null,color:null,Sg:null,Je:null,ne:null,XC:null,VC:null,YC:null,WC:null,UC:null,FF:[],Il:[],EF:[],Hl:[],Ur:null};if(!a.W.length)for(var n=0;8>n;n++)a.W.push(null);a.W[c]=d;-1==ua.indexOf(a)&&ua.push(a)}function t(a,c){fa.p(a);V.u(a);f(a,0,c,!0)}function y(a,c,d){d=d||0;if(T.hc(a)){var n=u(a,c);if(n)return K(a,d),b(a,n,d),t(a,d),!0;if((n=C(a,c))&&"EMITTER"==n.$r){K(a,d);c=n.name;for(var n=d,
h=a.A,f=0;f<h.length;f++)for(var y=h[f].X,v=0;v<y.length;v++){var L=y[v].Qa;L&&L.name==c&&e(a.W[n],L)}t(a,d);return!0}}if(n=ia.Mc("name",c,sa)||ia.Mc("name",c+"_B4W_BAKED",sa)){K(a,d);if(q(a,n,d))return t(a,d),!0;a.W[d]=null}Y.error('Unsupported object: "'+a.name+'" or animation name: "'+c+'"');return!1}function u(a,c){for(var d=0;d<a.Gc.length;d++){var n=a.Gc[d];if(n.name===c)return n}return null}function C(a,c){for(var d=a.A,n=0;n<d.length;n++)for(var b=d[n].X,h=0;h<b.length;h++){var e=b[h].Qa;
if(e&&e.name===c)return e}return null}function L(a){a=a.modifiers;for(var c=0;c<a.length;c++){var d=a[c];if("ARMATURE"==d.type)return d.object}return null}var n=l("__config"),T=l("__obj_util"),O=l("__particles"),V=l("__physics"),Y=l("__print"),la=l("__quat"),W=l("__reformer"),ba=l("__sfx"),aa=l("__time"),fa=l("__transform"),ea=l("__tsr"),ia=l("__util"),va=l("__vec3"),ga=l("__armature"),E=l("__lights"),ka=l("__scenes"),S=n.Zi,X=n.v;a.zJ=1E-6;a.tA=0;a.Bu=10;a.Cu=20;a.wA=30;a.vA=40;a.uA=50;a.Lp=60;a.FJ=
70;a.EJ=80;a.zc=0;a.BA=1;a.CA=2;a.DA=3;a.EA=4;a.FA=5;a.GA=6;a.Gu=7;a.Km=-1;a.Oz=10;a.Pz=20;a.wt=30;var Ca=Array(3),ha=new Float32Array(3),ja=new Float32Array(3),Z=new Float32Array(4),Q=new Float32Array(4),Ba=new Float32Array(4),ta=ea.create();new Float32Array(16);var ua=[],sa=[];a.GD=function(){return ia.trunc((X.pF-50)/4)};a.$C=function(a){return a/aa.Ec()};a.update=function(a){for(var c=0;c<ua.length;c++){for(var d=ua[c],n=0;8>n;n++)F(d,a,n);d.g.Yi&&(H(d,a),D(d,a))}for(c=0;c<ua.length;c++)for(d=
ua[c],n=0;8>n&&d.W.length;n++)m(d,n)};a.PO=function(){return sa};a.lD=function(a){var c=[];if(B(a))for(var d=0;d<a.Gc.length;d++)c.push(a.Gc[d].name);for(var n=[],d=0;d<sa.length;d++){var b=sa[d],h=b.j;20==h.type?n.push(b):10==h.type&&"ARMATURE"==a.type?n.push(b):40==h.type&&"SPEAKER"==a.type?n.push(b):80==h.type&&"WORLD"==a.type&&n.push(b)}if("MESH"==a.type)for(d=0;d<a.pf.length;d++)b=a.pf[d],60==b.j.type&&n.push(b);for(d=0;d<n.length;d++)c.push(x(n[d].name));if(O.Lx(a)&&O.KF(a))for(a=a.A,d=0;d<
a.length;d++)for(n=a[d].X,b=0;b<n.length;b++)(h=n[b].Qa)&&c.push(h.name);return c};a.e2=x;a.mD=function(a,c){var d=a.W[c];return d?d.type:0};a.cq=function(a){for(var c=0,d=a.A,n=0;n<d.length;n++)for(var h=d[n].X,f=0;f<h.length;f++){var y=h[f].Qa;y&&"EMITTER"==y.$r&&!h[f].eg&&(K(a,c),e(a.W[c],y),t(a,c),a.W[c].behavior=y.nd?10:a.Xi,c++)}d=a.pf.slice();for(n=0;n<d.length;n++)h=d[n],K(a,c),q(a,h,c)?(t(a,c),a.W[c].behavior=a.Xi,c++):a.W[c]=null;B(a)&&(K(a,c),b(a,a.Gc[0],c),t(a,c),a.W[c].behavior=a.Xi)};
a.Ou=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:ia.l("Wrong animation behavior")}};a.TO=function(a){var c=[];a=a.data.materials;for(var d=0;d<a.length;d++){var n=a[d].node_tree;n&&k(n,c)}return c};a.play=function(a,c,d){w(a.W,d,function(a){a.play=!0;a.pw=c?c:null;a.Mn=!1});a.g.Yi&&z(a)};a.stop=function(a,c){w(a.W,c,function(a){a.play=!1;a.pw=null;a.Mn=!1})};a.bi=function(a,c){var d=a.W;if(-1==c)for(var n=0;8>n;n++){if(d[n]&&d[n].play)return!0}else if(d=
d[c])return d.play;return!1};a.Xl=r;a.By=function(a,c){c=c||0;w(a.W,c,function(d){r(a,d.start,c)})};a.vD=function(a,c){var d=a.W[c];return d&&d.ge?d.ge:0};a.JE=function(a,c){var d=a.W[c];return d&&10==d.behavior};a.Uo=function(a,c,d){w(a.W,d,function(a){a.behavior=c})};a.oD=function(a,c){var d=a.W[c];return d&&d.behavior};a.hB=function(a,c,d,n){w(a.W,n,function(a){a.rz=c||0;a.$x=d||0})};a.uG=function(a,c){if(-1==c)for(var d=0;8>d;d++)a.W[d]=null;else a.W[c]=null;a.g.Yi&&A(a,c)};a.RT=f;a.MF=function(a){if("ARMATURE"==
a.type||a.dq||"WORLD"==a.type)return!0;for(var c=0;c<a.pf.length;c++){var d=a.pf[c].j.type;if(20==d||10==d||40==d&&"SPEAKER"==a.type||70==d&&"LAMP"==a.type||60==d&&"MESH"==a.type)return!0}return O.Lx(a)&&O.KF(a)||"MESH"==a.type&&a.Gc.length?!0:!1};a.zB=function(a,c){if("ARMATURE"==c.type||L(a)||"WORLD"==c.type)return!0;for(var d=0;d<c.pf.length;d++){var n=c.pf[d].j.type;if(20==n||10==n||40==n&&"SPEAKER"==c.type||60==n&&"MESH"==c.type)return!0}return O.QL(a)&&O.PL(a)||"MESH"==c.type&&a.data.b4w_vertex_anim.length?
!0:!1};a.Xb=function(a){return Boolean(a.W.length)};a.XL=I;a.iO=d;a.SK=function(a){function d(a,c){for(var n=0;n<c;n++){var b=a.subarray(8*n+4,8*n+8);la.normalize(b,b)}}function n(a,c){if(-1<a.indexOf("location"))var d=0,b=c;else-1<a.indexOf("rotation_quaternion")?(d=4,b=0==c?3:c-1):-1<a.indexOf("scale")?(d=3,b=0):(d=0,b=c);return d+b}function b(a,c,d,n,h){if(-1<d.search(e)){a=c;d=d.split('"')[1];var wa=f}else 8==h?(d="tsr",wa=f):wa=1<h?new Float32Array(h):0;if(!a[d]){h=a;c=d;if("object"==typeof wa&&
wa.length)for(var y=wa.length,u=new Float32Array(n*y),C=0;C<n;C++)for(var v=0;v<y;v++)u[C*y+v]=wa[v];else if("number"==typeof wa)for(u=new Float32Array(n),C=0;C<n;C++)u[C]=wa;else ia.l("Wrong storage default value");h[c]=u}return a[d]}var e=new RegExp(/pose.bones\[\".+\"\]/g),f=ea.create(),y=a.j={type:0,Jx:0,XF:0,Fa:null,hv:null,tB:null,Lg:new Int8Array(8)};y.XF=1/S.rj;var C=a.fcurves,u={},L={},p=0,g;for(g in C){var k=C[g],Q;for(Q in k){var t=k[Q],m=t.Yd;W.gM(t,a);t=t.num_channels;p||(p=m.length);
for(var t=b(u,L,g,p,t),K=t.length/p,wa=n(g,Q|0),T=0;T<p;T++)t[T*K+wa]=m[T]}}if(ia.Yn(u)){for(var O in u)"tsr"==O&&d(u[O],p);y.Fa=u}if(ia.Yn(L)){for(var z in L)d(L[z],p);y.hv=L}y.Jx=p;y.tB=a.JK;"tsr"in u&&v(C,y.Lg);("color"in u||"energy"in u)&&M(C,y.Lg);("light_settings.environment_energy"in u||"horizon_color"in u||"zenith_color"in u||"mist_settings.intensity"in u||"mist_settings.depth"in u||"mist_settings.start"in u||"mist_settings.height"in u||"b4w_fog_color"in u)&&c(C,y.Lg);h(a);sa.push(a)};a.SO=
function(a,c){return(c-a)*S.rj+1};a.sL=function(a,c,d,n,b,h){var e=new Float32Array(2),f=new Float32Array(2),y=new Float32Array(2),C=new Float32Array(2),u=c[1],v=c[2],L=c[a.last_frame_offset+1];a=c[a.last_frame_offset+2];for(var g=0,k=0,Q=null;b<=h;b++)if(b<u)for(var t=0;t<S.rj;t++)d[g++]=v;else if(b>L)for(t=0;t<S.rj;t++)d[g++]=a;else{var wa=c[k],m=3;0===wa&&(m+=2);0===Q&&(m+=2);var T=2===wa?0:1;if(c[k+1]==c[k+m+1])Q=wa,k+=m;else{t=0;b==c[k+1]&&(T&&(n[g]=1),d[g]=c[k+2],g++,t++);if(b==L)for(;t<S.rj;t++)d[g++]=
a;else for(e[0]=c[k+1],e[1]=c[k+2],0!==wa?(f[0]=0,f[1]=0):0===Q?(f[0]=c[k+5],f[1]=c[k+6]):(f[0]=c[k+3],f[1]=c[k+4]),0!==wa?(y[0]=0,y[1]=0):(y[0]=c[k+m+3],y[1]=c[k+m+4]),C[0]=c[k+m+1],C[1]=c[k+m+2];t<S.rj;t++){var K=b+t/S.rj;switch(wa){case 0:var O=e,z=f,q=y,I=C,x=[],M=[],A=void 0,r=void 0,V=void 0,A=void 0;x[0]=O[0]-z[0];x[1]=O[1]-z[1];M[0]=I[0]-q[0];M[1]=I[1]-q[1];V=I[0]-O[0];A=Math.abs(x[0]);r=Math.abs(M[0]);0!=A+r&&A+r>V&&(A=V/(A+r),z[0]=O[0]-A*x[0],z[1]=O[1]-A*x[1],q[0]=I[0]-A*M[0],q[1]=I[1]-
A*M[1]);T&&(n[g]=1);d[g]=R(p(0,1,K,e[0],f[0],y[0],C[0]),e[1],f[1],y[1],C[1]);g++;break;case 1:T&&(n[g]=1);O=e[0];z=e[1];q=(C[1]-z)/(C[0]-O);d[g]=q*K+(z-q*O);g++;break;case 2:T&&(n[g]=1);d[g]=c[k+2];g++;break;default:ia.l("Unknown keyframe interpolation mode: "+wa)}}b+1==c[k+m+1]&&(Q=wa,k+=m)}}};a.apply=y;a.nL=function(a,c,d){d=d||0;var n=ia.Mc("uuid",c,sa);if(n){K(a,d);if(q(a,n,d)){t(a,d);return}a.W[d]=null}Y.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.wU=function(a,c){var d=
ia.Mc("name",c,sa)||ia.Mc("name",c+"_B4W_BAKED",sa);if(d){if(0==d.j.type)return!1}else if(!(C(a,c)||T.hc(a)&&u(a,c)))return!1;return!0};a.Mw=function(a,c){for(var d=a.W,n=0;n<d.length;n++){var b=d[n];if(b&&x(b.Fg)==x(c))return n}return-1};a.QO=function(a,c){var d=a.W[c];return d&&d.Fg?x(d.Fg):null};a.remove=function(a){a.W.length=0;a=ua.indexOf(a);-1!=a&&ua.splice(a,1)};a.vR=function(a){for(var c=sa.length-1;0<=c;c--)sa[c].KK==a&&sa.splice(c,1)};a.iB=function(a,c){if(!a.W.length)return y(a,c,0)?0:
-1;for(var d=0;d<a.W.length;d++)if(!a.W[d])return y(a,c,d)?d:-1};a.YG=function(a,c,d){a.g.Qu=(c-a.g.Jh)/d;a.g.Pu=c};a.$G=function(a,c,d){w(a.W,d,function(a){a.speed=c})};a.XD=function(a,c){return a.W[c].speed};a.Dw=function(a,c){return a.W[c].start};a.Cw=function(a,c){return a.W[c].length};a.ha=function(){ua.length=0;sa.length=0};a.mO=function(a){var c=(a[0]||a[1]||a[2]).Yd.length,d=Z,n=ha,b=Boolean(a[0]);b||(a[0]={Yd:new Float32Array(c),num_channels:8});var h=Boolean(a[1]);h||(a[1]={Yd:new Float32Array(c),
num_channels:8});var e=Boolean(a[2]);e||(a[2]={Yd:new Float32Array(c),num_channels:8});a[3]={Yd:new Float32Array(c),num_channels:8};for(var f=0;f<c;f++)n[0]=b?a[0].Yd[f]:0,n[1]=h?a[1].Yd[f]:0,n[2]=e?a[2].Yd[f]:0,ia.Th(n,d),a[0].Yd[f]=d[3],a[1].Yd[f]=d[0],a[2].Yd[f]=d[1],a[3].Yd[f]=d[2]};a.qD=L;a.OS=function(a,c){for(var d=7,n=0,b=0;b<sa.length;b++){var h=sa[b];if(h.name==c){n=h.j.type;break}}0==n&&(u(a,c)?n=30:(b=C(a,name))&&"EMITTER"==b.$r&&(n=50));for(b=0;8>b;b++)if(h=a.W[b]){if(h.type==n)return b}else b<
d&&(d=b);return d}};b4w.module.__config=function(a,l){function m(){return b4w.module_check(a.qd.mq)}function b(){for(var b=a.qd,m=null,x=document.getElementsByTagName("script"),w=0;w<x.length;w++){for(var f=x[w].src,q=0;q<b.TE.length;q++)if(0<=f.indexOf(b.TE[q])){m=f;break}if(null!==m)break}m||(e.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),m=document.location.href);b=m.indexOf("?");0<=b&&(m=m.substring(0,b));return m.substring(0,m.lastIndexOf("/")+1)}var e=l("__print"),
x=l("__util");a.Ri=1;a.Qi=2;a.vk=3;a.Eu=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!0};a.JM=x.ia(a.context);a.v={alpha_sort:!0,alpha_sort_threshold:.1,Lj:[5,7],Ef:1E4,console_verbose:!1,do_not_load_resources:!1,mt:!1,ZC:1.5,sO:10,background_color:[0,0,0,0],canvas_resolution_factor:1,rm:3,allow_cors:!1,rw:!1,Zp:!0,show_hud_debug_info:!1,KX:!0,Yl:!0,stereo:"NONE",Ko:!0,gd:!0,Rd:!0,Tk:!0,kl:!0,kq:!0,Mj:!0,Kk:!0,antialiasing:!0,smaa:!1,debug_view:!1,LI:!1,Qn:!0,as:!0,
Jc:!0,water_dynamic:!0,vi:!0,Os:!0,Rb:1024,fi:512,qI:!0,precision:"highp",quality:a.Qi,Yp:!0,PQ:!1,iH:!1,ew:!1,yI:!1,Af:!1,fw:!1,Yw:!1,yv:!1,O1:!1,To:!1,allow_hidpi:!1,QC:!1,yx:!1,enable_selectable:!0,enable_outlining:!0,Yg:!0,pF:128,qr:!1,RC:!1,qx:[0,0],Hn:!1,iG:!0,Nu:!1,url_params:null,ld:!0,uc:4,DG:!1,yG:!1,RB:!1,media_auto_activation:!0,oF:4,Lr:!1,cB:!1,gl_debug:!1,dD:"",MB:!1};a.HN=x.ia(a.v);a.Zi={Wq:-1,aD:!1,rj:1};a.controls={LQ:1/120};a.Ne={dir:"ASSETS=assets/",GQ:15,prevent_caching:!0,
wx:!1,Yv:!1};a.vL=x.ia(a.Ne);a.qd={shaders_dir:"",JS:"include/",J1:"postprocessing/",mq:"built_in_data",TE:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js guitar_presentation.min.js".split(" "),zG:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.BP={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{Dj:.064,Kh:.035,pi:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],Cm:.11,$h:.062,Lh:.004}};a.r=
{enabled:!0,Ef:60,ep:"",lv:!1,ping:!1,jp:!0};a.$Q=x.ia(a.r);a.Vl={jr:1024,xn:384,uC:32,AN:128,zN:256,YF:.25,hR:.5,gR:1};a.OR=x.ia(a.Vl);a.P={Jz:!0,Pr:!1,pB:!1,SB:!1,IC:!1};a.HS=x.ia(a.P);a.ic={outlining_overview_mode:!1,kh:[1,.4,.05],Ml:.2,Nl:3.8,Ol:1};a.Jq={enabled:!1,hT:"COPY",gT:0,NS:"COLOR"};a.DN=x.ia(a.Jq);a.qL=function(){var b=a.v,e=a.r,m=a.Vl;switch(b.quality){case a.vk:b.Yl=!0;b.vi=!0;b.Rd=!0;b.Tk=!0;b.kl=!0;b.kq=!0;b.Ko=!0;b.gd=!0;b.Qn=!0;b.as=!0;b.Jc=!0;m.jr=2048;b.rm=3;b.Zp=!0;b.mt=!1;
b.precision="highp";b.water_dynamic=!0;b.Os=!0;b.antialiasing=!0;b.smaa=!1;b.Kk=!0;b.Mj=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Yg=!0;b.uc=16;e.Ef=120;break;case a.Qi:b.Yl=!0;b.vi=!0;b.Rd=!0;b.Tk=!0;b.kl=!0;b.kq=!0;b.Ko=!0;b.gd=!0;b.Qn=!0;b.as=!0;b.Jc=!0;m.jr=1024;b.rm=3;b.Zp=!0;b.mt=!1;b.precision="highp";b.water_dynamic=!0;b.Os=!0;b.antialiasing=!0;b.smaa=!1;b.Kk=!0;b.Mj=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Yg=!0;b.uc=4;e.Ef=60;break;case a.Ri:b.Yl=!1,b.vi=!1,b.Rd=!1,b.Tk=!1,b.kl=!1,
b.kq=!1,b.Ko=!1,b.gd=!1,b.Qn=!1,b.as=!1,b.Jc=!1,m.jr=512,b.rm=2,b.Zp=!1,b.mt=!0,b.precision="mediump",b.water_dynamic=!1,b.Os=!1,b.antialiasing=!1,b.smaa=!1,b.Kk=!1,b.Mj=!1,b.allow_hidpi=!1,b.enable_outlining=!1,b.Yg=!1,b.uc=1,e.Ef=60}};a.set=function(b,m){switch(b){case "allow_cors":a.v.allow_cors=m;break;case "allow_hidpi":a.v.allow_hidpi=m;break;case "alpha":a.context.alpha=m;break;case "alpha_sort":a.v.alpha_sort=m;break;case "alpha_sort_threshold":a.v.alpha_sort_threshold=m;break;case "anaglyph_use":e.bO();
a.v.stereo=m?"ANAGLYPH":a.v.stereo;break;case "animation_framerate":a.Zi.Wq=m;break;case "antialiasing":a.v.antialiasing=m;break;case "assets_dds_available":a.Ne.Yv=m;break;case "assets_min50_available":a.Ne.wx=m;break;case "audio":a.P.Jz=m;break;case "background_color":a.v.background_color=m;break;case "built_in_module_name":a.qd.mq=m;break;case "canvas_resolution_factor":a.v.canvas_resolution_factor=m;break;case "console_verbose":a.v.console_verbose=m;break;case "do_not_load_resources":a.v.do_not_load_resources=
m;break;case "gamepad_setting_cont":a.v.dD=m;break;case "stereo":a.v.stereo=m;break;case "media_auto_activation":a.v.media_auto_activation=m;break;case "physics_enabled":a.r.enabled=m;break;case "physics_uranium_path":a.r.ep=m;break;case "physics_calc_fps":a.r.lv=m;break;case "physics_use_workers":a.r.jp=m;break;case "precision":a.v.precision=m;break;case "prevent_caching":a.Ne.prevent_caching=m;break;case "quality":a.v.quality=m;break;case "sfx_mix_mode":a.P.Pr=m;break;case "shaders_dir":a.qd.shaders_dir=
m;break;case "show_hud_debug_info":a.v.show_hud_debug_info=m;break;case "smaa":a.v.smaa=m;break;case "smaa_search_texture_path":a.qd.smaa_search_texture_path=m;break;case "smaa_area_texture_path":a.qd.smaa_area_texture_path=m;break;case "debug_view":a.v.debug_view=m;break;case "enable_selectable":a.v.enable_selectable=m;break;case "enable_outlining":a.v.enable_outlining=m;break;case "outlining_overview_mode":a.ic.outlining_overview_mode=m;break;case "glow_materials":a.v.Yg=m;break;case "url_params":a.v.url_params=
m;break;case "gl_debug":a.v.gl_debug=m;break;default:e.error("Unknown config property: "+b)}};a.get=function(b){switch(b){case "allow_cors":return a.v.allow_cors;case "allow_hidpi":return a.v.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.v.alpha_sort;case "alpha_sort_threshold":return a.v.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.v.stereo;case "animation_framerate":return a.Zi.Wq;case "antialiasing":return a.v.antialiasing;case "assets_dds_available":return a.Ne.Yv;
case "assets_min50_available":return a.Ne.wx;case "audio":return a.P.Jz;case "background_color":return a.v.background_color;case "built_in_module_name":return a.qd.mq;case "canvas_resolution_factor":return a.v.canvas_resolution_factor;case "console_verbose":return a.v.console_verbose;case "do_not_load_resources":return a.v.do_not_load_resources;case "gamepad_setting_cont":return a.v.dD;case "is_mobile_device":return a.v.Af;case "stereo":return a.v.stereo;case "media_auto_activation":return a.v.media_auto_activation;
case "physics_enabled":return a.r.enabled;case "physics_uranium_path":return a.r.ep;case "physics_calc_fps":return a.r.lv;case "physics_use_workers":return a.r.jp;case "precision":return a.v.precision;case "prevent_caching":return a.Ne.prevent_caching;case "quality":return a.v.quality;case "sfx_mix_mode":return a.P.Pr;case "shaders_dir":return a.qd.shaders_dir;case "show_hud_debug_info":return a.v.show_hud_debug_info;case "smaa":return a.v.smaa;case "smaa_search_texture_path":return a.qd.smaa_search_texture_path;
case "smaa_area_texture_path":return a.qd.smaa_area_texture_path;case "debug_view":return a.v.debug_view;case "enable_selectable":return a.v.enable_selectable;case "enable_outlining":return a.v.enable_outlining;case "outlining_overview_mode":return a.ic.outlining_overview_mode;case "glow_materials":return a.v.Yg;case "url_params":return a.v.url_params;case "gl_debug":return a.v.gl_debug;default:e.error("Unknown config property: "+b)}};a.reset=function(){a.context=x.ia(a.JM);a.v=x.ia(a.HN);a.Ne=x.ia(a.vL);
a.r=x.ia(a.$Q);a.Vl=x.ia(a.OR);a.P=x.ia(a.HS);a.Jq=x.ia(a.DN)};a.EE=m;a.nS=function(){var e=a.qd,x=a.r;m()||""!=e.shaders_dir||(e.shaders_dir=b()+"../shaders/");if(m())e.smaa_search_texture_path="smaa_search_texture.png",e.smaa_area_texture_path="smaa_area_texture.png";else if(""==e.smaa_search_texture_path||""==e.smaa_area_texture_path){var r=b()+e.zG;e.smaa_search_texture_path=e.smaa_search_texture_path||r+"smaa_search_texture.png";e.smaa_area_texture_path=e.smaa_area_texture_path||r+"smaa_area_texture.png"}x.enabled&&
""==x.ep&&(r=b()+e.zG,x.ep=r+"uranium.js")};a.Ow=function(){return a.Ne.dir.replace("ASSETS=","")}};b4w.module.__print=function(a){function l(a,b){var e=[];-1<a[0].indexOf("%c")?e.push(a[0].replace("%c","%c"+b+": ")):e.push(b+": "+a[0]);for(var g=1;g<a.length;g++)e.push(a[g]);return e}function m(){k++;var a=l(arguments,"B4W ERROR");console.error.apply(console,a)}function b(a){a in r||(r[a]=a,m([a]))}function e(a,e){b(a+"() is deprecated, use "+e+"() instead.")}var x=!1,k=0,B=0,r={};a.xS=function(a){x=a};a.rx=function(){console.log.apply(console,arguments)};a.log=function(){if(x){var a=l(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=m;a.fc=b;a.kb=e;a.bg=function(a,f){switch(1<f.length){case !0:b(a+"() is deprecated, use "+f.slice(0,-1).join("(), ")+"() or "+f[f.length-1]+"() instead.");break;case !1:e(a,f[0])}};a.bO=function(){b('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){B++;var a=l(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=l(arguments,"B4W INFO");console.info.apply(console,a)};a.eO=function(){k++;
var a=l(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.fO=function(){B++;var a=l(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){x&&console.time.apply(console,arguments)};a.timeEnd=function(){x&&console.timeEnd.apply(console,arguments)};a.group=function(){x&&console.group.apply(console,arguments)};a.groupCollapsed=function(){x&&console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){x&&console.groupEnd.apply(console,arguments)};a.clear=
function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.qP=function(){return B};a.ZO=function(){return k};a.WB=function(){k=B=0}};b4w.module.print=b4w.module.__print;b4w.module.__util=function(a,l){function m(a){return 0<a?1:0>a?-1:0}function b(a){var c=a[0],d=a[1],n=a[2],b=a[3],h=Math.sqrt(c*c+d*d+n*n),h=1/h;a[0]=c*h;a[1]=d*h;a[2]=n*h;a[3]=b*h}function e(a,c){var d=c;switch(typeof a){case "number":return x(a,d);case "string":return k(a,d);case "boolean":return x(a|0,d);case "function":case "undefined":return x(0,d);case "object":if(a){switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return x(0,
d)}if(a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength)for(var n=0;n<a.length;n++)d=x(a[n],d);else if(a instanceof Array)for(n=0;n<a.length;n++)d=e(a[n],d);else for(n in a)d=e(a[n],d)}else d=x(0,d)}return d}function x(a,c){var d=c;O[0]=a;d=(d<<5)-d+V[0];d&=d;d=(d<<5)-d+V[1];return d&d}function k(a,c){for(var d=c,n=0;n<a.length;n++)d=(d<<5)-d+a.charCodeAt(n),d&=d;return d}function B(a){return(34*a+1)*a%289}function r(a){return a-Math.floor(a)}function w(a){return f((34*a+5)*a)}function f(a){return a-
289*Math.floor(a/289)}function q(a){return a-7*Math.floor(a/7)}function g(a){a&&d.error.apply(d,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";}function z(a,c,d){a-=c;d-=c;return c+(a-Math.floor(a/d)*d)}function A(a){return z(a,0,2*Math.PI)}function J(a,c){if(a&&c){var d=a instanceof Array;if(d!=c instanceof Array)return!1;var n=
a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(n!=(c.buffer instanceof ArrayBuffer&&"undefined"!==c.byteLength))return!1;if(d){if(a.length!=c.length)return!1;for(d=0;d<a.length;d++)if(!N(a[d],c[d]))return!1}else if(n){if(a.length!=c.length)return!1;for(d=0;d<a.length;d++)if(a[d]!=c[d])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==c}for(var b in a)if(!N(a[b],c[b]))return!1;
for(b in c)if(!(b in a))return!1}return!0}return!(a||c)}function N(a,c){if(typeof a!=typeof c)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==c;case "object":return J(a,c);default:return!0}}function F(a){if(""==a)return".";var c=0==a.indexOf("/")|0;c&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(c=2);a=a.split("/");for(var d=[],n=0;n<a.length;n++){var b=a[n];""!=b&&"."!=b&&(".."!=b||!c&&!d.length||d.length&&".."==d[d.length-1]?d.push(b):d.length&&d.pop())}a=d.join("/");
for(n=0;n<c;n++)a="/"+a;return a||"."}var G=l("__boundings"),D=l("__mat3"),H=l("__mat4"),I=l("__math"),d=l("__print"),h=l("__tsr"),v=l("__quat"),M=l("__vec3"),c=l("__vec4"),p=0,R={},K=[E,ka,S,X,Ca],t=new Float32Array(3),y=new Float32Array(3),u=new Float32Array(4),C=new Float32Array(4),L=new Float32Array(9),n=new Float32Array(16),T=new Float32Array(16),O=new Float64Array(1),V=new Uint32Array(O.buffer),Y=new Float32Array([0,0,0]),la=new Float32Array([0,0,0,1]),W=new Float32Array([0,0,0,1,0,0,0,1]),
ba=new Float32Array([1,1,1]),aa=new Float32Array([1,0,0]),fa=new Float32Array([0,1,0]),ea=new Float32Array([0,0,1]),ia=new Float32Array([-1,0,0]),va=new Float32Array([0,-1,0]),ga=new Float32Array([0,0,-1]),E=0,ka=1,S=2,X=4,Ca=5,ha=Math.floor(44488.07041494893),ja=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,
0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.IA=Y;a.Fu=la;a.jW=W;a.Iu=ba;a.Ke=aa;a.wc=fa;a.lf=ea;a.zt=ia;a.md=va;a.Oi=ga;a.JA=E;a.QA=ka;a.RA=S;a.LA=3;a.NA=X;a.TA=Ca;a.KA=6;a.PA=7;a.Ju=8;a.MA=9;a.OA=10;a.SA=11;a.$I=ja;a.Bf=function(a){return"undefined"!=typeof a};a.YE=function(a,c,d){for(var n=[],b=d.length,h=0;h<b;h++){var e=d[h];e[a]==c&&n.push(e)}return n};a.rO=function(a,c){var d=a.length,n=new Float32Array(d+c.length);n.set(a);n.set(c,d);return n};a.xT=
function(a,c){var d=a.length,n=new Uint32Array(d+c.length);n.set(a);n.set(c,d);return n};a.pM=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.tL=function(a,c){var d=[],n={},b=c.length,h,e;for(h=0;h<b;h++)n[c[h]]=!0;b=a.length;for(h=0;h<b;h++)e=a[h],e in n&&d.push(e);return d};a.sign=m;a.P_=function(a,c,d){for(var n=d.length,b=0;b<n;b++)if(d[b][a]==c)return!0;return!1};a.Mc=function(a,c,d){for(var n=0;n<d.length;n++){var b=d[n];if(b[a]===c)return b}return null};
a.N_=function(a,c,d,n,b){for(var h=0;h<b.length;h++){var e=b[h];if(e[a]==c&&e[d]==n)return e}return null};a.fP=function(a,c){for(var d=0;d<a.length;d++)if(a[d].uuid==c)return d;return-1};a.mL=function(a,c){for(var d=0;d<a.length;d++)if(a[d]==c)return;a.push(c)};a.nX=function(a){for(var c=0;c<a.length-1;c++)for(var d=a[c],n=c+1;n<a.length;n++)if(d==a[n])return!1;return!0};a.sT=function(a,c,d,n){n||(n=new Float32Array(16));H.identity(n);n[12]=a;n[13]=c;n[14]=d};var Z=1;a.sR=function(){Z=(69069*Z+5)%
Math.pow(2,32);return Math.round(Z/65536)%32768/32767};a.ZS=function(a){Z=a};a.ef=function(a){var c=a[0]%ha*48271-3399*Math.floor(a[0]/ha);a[0]=0<c?c:c+2147483647;return(a[0]-1)/2147483646};a.vr=function(a,c){c||(c=[]);c[0]=5E4+Math.floor(a);return c};a.Th=function(a,c){c||(c=new Float32Array(4));var d=Math.cos(a[1]/2),n=Math.cos(a[2]/2),b=Math.cos(a[0]/2),h=Math.sin(a[1]/2),e=Math.sin(a[2]/2),f=Math.sin(a[0]/2);c[0]=d*n*f+h*e*b;c[1]=h*n*b+d*e*f;c[2]=d*e*b-h*n*f;c[3]=d*n*b-h*e*f;return c};a.Mx=function(a,
c,d){var n=a[0],b=a[1];a=a[2];var h=Math.cos(n/2),e=Math.cos(b/2),f=Math.cos(a/2),y=Math.sin(n/2),b=Math.sin(b/2),C=Math.sin(a/2);if(-1<K.indexOf(c))var u=Math.cos((n+a)/2),v=Math.sin((n+a)/2),L=Math.cos((n-a)/2),p=Math.sin((n-a)/2),g=Math.cos((a-n)/2),t=Math.sin((a-n)/2);switch(c){case E:d[0]=e*v;d[1]=b*L;d[2]=b*p;d[3]=e*u;break;case ka:d[0]=b*p;d[1]=e*v;d[2]=b*L;d[3]=e*u;break;case S:d[0]=b*L;d[1]=b*p;d[2]=e*v;d[3]=e*u;break;case 3:d[0]=e*v;d[1]=b*t;d[2]=b*g;d[3]=e*u;break;case X:d[0]=b*g;d[1]=
e*v;d[2]=b*t;d[3]=e*u;break;case Ca:d[0]=b*t;d[1]=b*g;d[2]=e*v;d[3]=e*u;break;case 6:d[0]=y*e*f+h*b*C;d[1]=h*b*f-y*e*C;d[2]=h*e*C+y*b*f;d[3]=h*e*f-y*b*C;break;case 7:d[0]=h*e*C+y*b*f;d[1]=y*e*f+h*b*C;d[2]=h*b*f-y*e*C;d[3]=h*e*f-y*b*C;break;case 8:d[0]=h*b*f-y*e*C;d[1]=h*e*C+y*b*f;d[2]=y*e*f+h*b*C;d[3]=h*e*f-y*b*C;break;case 9:d[0]=y*e*f-h*b*C;d[1]=h*e*C-y*b*f;d[2]=h*b*f+y*e*C;d[3]=h*e*f+y*b*C;break;case 10:d[0]=h*b*f+y*e*C;d[1]=y*e*f-h*b*C;d[2]=h*e*C-y*b*f;d[3]=h*e*f+y*b*C;break;case 11:d[0]=h*e*
C-y*b*f,d[1]=h*b*f+y*e*C,d[2]=y*e*f-h*b*C,d[3]=h*e*f+y*b*C}return d};a.mG=function(a,d,c){var n=a[0],b=a[1],h=a[2];a=a[3];switch(d){case E:c[0]=Math.atan2(n*b+h*a,b*a-n*h);c[1]=Math.acos(1-2*(b*b+h*h));c[2]=Math.atan2(n*b-h*a,n*h+b*a);break;case ka:c[0]=Math.atan2(n*a+b*h,h*a-n*b);c[1]=Math.acos(1-2*(n*n+h*h));c[2]=Math.atan2(b*h-n*a,n*b+h*a);break;case S:c[0]=Math.atan2(n*h+b*a,n*a-b*h);c[1]=Math.acos(1-2*(n*n+b*b));c[2]=Math.atan2(n*h-b*a,n*a+b*h);break;case 3:c[0]=Math.atan2(n*h-b*a,n*b+h*a);c[1]=
Math.acos(1-2*(b*b+h*h));c[2]=Math.atan2(n*h+b*a,h*a-n*b);break;case X:c[0]=Math.atan2(n*b-h*a,n*a+b*h);c[1]=Math.acos(1-2*(n*n+h*h));c[2]=Math.atan2(n*b+h*a,n*a-b*h);break;case Ca:c[0]=Math.atan2(b*h-n*a,n*h+b*a);c[1]=Math.acos(1-2*(n*n+b*b));c[2]=Math.atan2(n*a+b*h,b*a-n*h);break;case 6:c[0]=Math.atan2(2*(n*a-b*h),1-2*(n*n+b*b));c[1]=Math.asin(2*(n*h+b*a));c[2]=Math.atan2(2*(h*a-n*b),1-2*(b*b+h*h));break;case 7:c[0]=Math.atan2(2*(b*a-n*h),1-2*(b*b+h*h));c[1]=Math.asin(2*(n*b+h*a));c[2]=Math.atan2(2*
(n*a-b*h),1-2*(n*n+h*h));break;case 8:c[0]=Math.atan2(2*(h*a-n*b),1-2*(n*n+h*h));c[1]=Math.asin(2*(n*a+b*h));c[2]=Math.atan2(2*(b*a-n*h),1-2*(n*n+b*b));break;case 9:c[0]=Math.atan2(2*(n*a+b*h),1-2*(n*n+h*h));c[1]=Math.asin(2*(h*a-n*b));c[2]=Math.atan2(2*(n*h+b*a),1-2*(b*b+h*h));break;case 10:c[0]=Math.atan2(2*(n*h+b*a),1-2*(n*n+b*b));c[1]=Math.asin(2*(n*a-b*h));c[2]=Math.atan2(2*(n*b+h*a),1-2*(n*n+h*h));break;case 11:c[0]=Math.atan2(2*(n*b+h*a),1-2*(b*b+h*h)),c[1]=Math.asin(2*(b*a-n*h)),c[2]=Math.atan2(2*
(n*a+b*h),1-2*(n*n+b*b))}return c};a.cO=function(a){var c=D.create(),d=Math.cos(a[0]),n=Math.cos(a[1]),b=Math.cos(a[2]),h=Math.sin(a[0]),e=Math.sin(a[1]);a=Math.sin(a[2]);var f=d*b,y=d*a,C=h*b,u=h*a;c[0]=n*b;c[1]=n*a;c[2]=-e;c[3]=e*C-y;c[4]=e*u+f;c[5]=n*h;c[6]=e*f+u;c[7]=e*y-C;c[8]=n*d;return c};a.lG=function(a,c){var d=a[0],n=a[1],b=a[2],h=a[3],e=b*b,f=d*n+b*h;.499999<f?(c[0]=0,c[1]=2*Math.atan2(d,h),c[2]=Math.PI/2):-.499999>f?(c[0]=0,c[1]=-2*Math.atan2(d,h),c[2]=-Math.PI/2):(c[0]=Math.atan2(2*d*
h-2*n*b,1-2*d*d-2*e),c[1]=Math.atan2(2*n*h-2*d*b,1-2*n*n-2*e),c[2]=Math.asin(2*d*n+2*b*h));return c};a.Cb=function(a,c,d){d||(d=new Float32Array(3));M.transformQuat(c,a,d);return d};a.dw=function(a,c,d){d||(d=new Float32Array(4));a=M.normalize(a,t);var n=M.dot(c,a);a=M.cross(c,a,y);n=Math.acos(n);d[0]=a[0]*Math.sin(n/2);d[1]=a[1]*Math.sin(n/2);d[2]=a[2]*Math.sin(n/2);d[3]=Math.cos(n/2);return d};a.tT=function(a,c,d,n){n||(n=new Float32Array(4));M.transformQuat(d,c,n);n[3]=-M.dot(a,n)};a.NN=function(a){var c=
h.B(a.g.i);switch(a.type){case "CAMERA":t[0]=0;t[1]=-1;t[2]=0;M.transformQuat(t,c,t);y[0]=0;y[1]=0;y[2]=-1;break;case "MESH":t[0]=0;t[1]=0;t[2]=1;M.transformQuat(t,c,t);y[0]=0;y[1]=0;y[2]=1;break;case "EMPTY":t[0]=0,t[1]=1,t[2]=0,M.transformQuat(t,c,t),y[0]=0,y[1]=1,y[2]=0}t[1]=0;M.normalize(t,t);a=M.dot(t,y);return Math.acos(a)*(0<-t[0]*y[2]?-1:1)};a.vB=function(a,c,d,n){if(0!=d){n=n||[];for(var b=0;b<a.length;b++)n[b]=(1-d)*a[b]+d*c[b]}};a.z2=function(){p++;return p.toString(16)};a.cp=function(a){R[a]||
(R[a]=0);var c=a+R[a];R[a]++;return c};a.sf=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.Cc=function(a){var c={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,wa:0,ab:null,N:[],ba:c,Oa:[],kd:{I:G.bc(),na:G.kf(),R:G.bc(),Ha:G.kf()}}};a.Ph=function(a){return JSON.parse(JSON.stringify(a))};a.ia=function(c){if(!(c instanceof Object))return c;var d;d=c.constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:d=
new d(c);break;case Array:d=new d(c.length);for(var n=0;n<c.length;n++)d[n]=a.ia(c[n]);break;default:for(n in d=new d,c)d[n]=a.ia(c[n])}return d};a.hn=function(a){var c=a instanceof Array?[]:{},d;for(d in a)if(a[d]instanceof Object){var n=a[d].constructor;switch(n){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c[d]=new n(a[d]);break;case Array:c[d]=a[d].slice(0);break;default:c[d]=a[d]}}else c[d]=a[d];return c};
a.Nr=function(a,c){c||(c=new Float32Array(4));D.fromMat4(a,L);var d=L[0],n=L[3],b=L[6],h=L[1],e=L[4],f=L[7],y=L[2],C=L[5],u=L[8],d=Math.sqrt(d*d+n*n+b*b)||1,h=Math.sqrt(h*h+e*e+f*f)||1,y=Math.sqrt(y*y+C*C+u*u)||1;L[0]/=d;L[3]/=d;L[6]/=d;L[1]/=h;L[4]/=h;L[7]/=h;L[2]/=y;L[5]/=y;L[8]/=y;v.fromMat3(L,c);v.normalize(c,c);return c};a.nF=function(a,c){c||(c=new Float32Array(3));c[0]=a[12];c[1]=a[13];c[2]=a[14];return c};a.mF=function(a){u[0]=.577350269189626;u[1]=.577350269189626;u[2]=.577350269189626;u[3]=
0;c.transformMat4(u,a,u);return c.length(u)};a.Rq=function(a,c){var d=c.left,n=c.right,h=c.top,e=c.bottom,f=c.near,y=c.far;d[0]=a[3]+a[0];d[1]=a[7]+a[4];d[2]=a[11]+a[8];d[3]=a[15]+a[12];n[0]=a[3]-a[0];n[1]=a[7]-a[4];n[2]=a[11]-a[8];n[3]=a[15]-a[12];h[0]=a[3]-a[1];h[1]=a[7]-a[5];h[2]=a[11]-a[9];h[3]=a[15]-a[13];e[0]=a[3]+a[1];e[1]=a[7]+a[5];e[2]=a[11]+a[9];e[3]=a[15]+a[13];f[0]=a[3]+a[2];f[1]=a[7]+a[6];f[2]=a[11]+a[10];f[3]=a[15]+a[14];y[0]=a[3]-a[2];y[1]=a[7]-a[6];y[2]=a[11]-a[10];y[3]=a[15]-a[14];
b(d);b(n);b(h);b(e);b(f);b(y)};a.T1=function(a,c,d){return d<-I.df(a,c.left)||d<-I.df(a,c.right)||d<-I.df(a,c.top)||d<-I.df(a,c.bottom)||d<-I.df(a,c.near)||d<-I.df(a,c.far)?!0:!1};a.XN=function(a,c,d,n,b){h=M.dot(d,c.far);e=M.dot(n,c.far);f=M.dot(b,c.far);h=Math.sqrt(h*h+e*e+f*f);if(h<-I.df(a,c.near)||h<-I.df(a,c.far))return!0;var h=M.dot(d,c.left),e=M.dot(n,c.left),f=M.dot(b,c.left);if(Math.sqrt(h*h+e*e+f*f)<-I.df(a,c.left))return!0;h=M.dot(d,c.right);e=M.dot(n,c.right);f=M.dot(b,c.right);if(Math.sqrt(h*
h+e*e+f*f)<-I.df(a,c.right))return!0;h=M.dot(d,c.top);e=M.dot(n,c.top);f=M.dot(b,c.top);if(Math.sqrt(h*h+e*e+f*f)<-I.df(a,c.top))return!0;h=M.dot(d,c.bottom);e=M.dot(n,c.bottom);f=M.dot(b,c.bottom);return Math.sqrt(h*h+e*e+f*f)<-I.df(a,c.bottom)?!0:!1};a.Rl=function(a,c,d,n){n||(n=0);for(var b=a.length,h=0;h<b;h+=3){var e=a[h],f=a[h+1],y=a[h+2];d[n+h]=c[0]*e+c[4]*f+c[8]*y+c[12];d[n+h+1]=c[1]*e+c[5]*f+c[9]*y+c[13];d[n+h+2]=c[2]*e+c[6]*f+c[10]*y+c[14]}};a.zU=function(a,c,d){for(var n=0,n=0,b=a.length,
h=0;h<b;h+=3){var e=a[h],f=a[h+1],y=a[h+2];d[n+h]=c[0]*e+c[4]*f+c[8]*y;d[n+h+1]=c[1]*e+c[5]*f+c[9]*y;d[n+h+2]=c[2]*e+c[6]*f+c[10]*y}};a.jT=function(a,c,d){for(var n=0,n=0,b=a.length,h=0;h<b;h+=4){var e=a[h],f=a[h+1],y=a[h+2];d[n+h]=c[0]*e+c[4]*f+c[8]*y;d[n+h+1]=c[1]*e+c[5]*f+c[9]*y;d[n+h+2]=c[2]*e+c[6]*f+c[10]*y;d[n+h+3]=a[h+3]}};a.xU=function(a,d,n){n||(n=new Float32Array(3));u[0]=a[0];u[1]=a[1];u[2]=a[2];u[3]=0;c.transformMat4(u,d,u);n[0]=u[0];n[1]=u[1];n[2]=u[2]};a.rY=function(a,c){var d=a.length;
d||g("flatten(): Wrong or empty array");var n=a[0].length;n||g("flatten(): Wrong or empty subarray");c||(c=new Float32Array(d*n));for(var b=0;b<d;b++)for(var h=0;h<n;h++)c[b*n+h]=a[b][h];return c};a.yU=function(a){for(var c=[],d=0;d<a.length;d+=3){var n=new Float32Array([a[d],a[d+1],a[d+2]]);c[d/3]=n}return c};a.jq=function(c,d,n,b){if(b<n)return n;var h=n+Math.floor((b-n)/2);return c[h]>d?a.jq(c,d,n,h-1):c[h]<d?a.jq(c,d,h+1,b):h};a.Qh=function(a,c){for(var d=0;d<a.length;d++)if(a[d]!=c[d])return!1;
return!0};a.wX=function(a,c,d){for(var n=0;n<a.length;n++)if(Math.abs(a[n]-c[n])>d)return!1;return!0};a.P0=function(a,c,d){d||(d=new Float32Array(16));for(var n=0;12>n;n++)d[n]=a[n]*c;d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.vT=function(a,c,d,b,h){h||(h=new Float32Array(16));c=H.fromRotationTranslation(d,b,n);H.multiply(c,a,h);return h};a.Fc=function(a,c,d,b,h){h||(h=new Float32Array(3));d=H.fromRotationTranslation(d,b,n);1!==c&&(b=H.identity(T),c=M.set(c,c,c,t),H.scale(b,c,b),
H.multiply(d,b,d));M.transformMat4(a,d,h);return h};a.t2=function(a,d,b,h,e){e||(e=new Float32Array(4));d=H.fromRotationTranslation(b,h,n);c.transformMat4(a,d,e);return e};a.C_=function(a,c,d,b,h){h||(h=new Float32Array(3));c=H.fromRotationTranslation(d,b,n);H.invert(c,c);M.transformMat4(a,c,h);return h};a.r2=function(a,c,d){d||(d=new Float32Array(16));H.fromRotationTranslation(c,a,d);a=a[3];for(c=0;12>c;c++)d[c]*=a;return d};a.Z_=function(c,d,n){a.nF(c,d);d[3]=a.mF(c);a.Nr(c,n)};a.KW=function(a){for(var c=
[],d=0;d<a.length;d++)c.push(a[d]);return JSON.stringify(c)};a.KR=function(a,c,d,n){n||(n=new Float32Array(3));M.subtract(c,a,t);M.transformQuat(t,d,t);M.subtract(c,t,n)};a.EO=function(){t[0]=0;t[1]=0;t[2]=0;var a=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),n=new Float32Array(16),b=new Float32Array(16),h=new Float32Array(16);H.lookAt(t,[-1,0,0],[0,-1,0],a);H.scale(a,[-1,1,1],a);H.scale(a,[-1,1,-1],c);H.lookAt(t,[0,-1,0],[0,0,-1],d);H.scale(d,[1,1,-1],d);H.scale(d,[1,-1,-1],
n);H.lookAt(t,[0,0,-1],[0,-1,0],b);H.scale(b,[-1,1,1],b);H.scale(b,[-1,1,-1],h);return[a,c,d,n,b,h]};a.IO=function(){t[0]=0;t[1]=0;t[2]=0;var a=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),n=new Float32Array(16),b=new Float32Array(16),h=new Float32Array(16);H.lookAt(t,[1,0,0],[0,-1,0],a);H.scale(a,[-1,1,-1],c);H.lookAt(t,[0,1,0],[0,0,1],d);H.scale(d,[1,-1,-1],n);H.lookAt(t,[0,0,1],[0,-1,0],b);H.scale(b,[-1,1,-1],h);return[a,c,d,n,b,h]};a.AB=function(a,c){return e(a,c)};a.xE=
e;a.n_=k;a.DQ=function(a,c){c[15]=1;c[14]=0;c[13]=0;c[12]=0;c[11]=0;c[10]=a[8];c[9]=a[7];c[8]=a[6];c[7]=0;c[6]=a[5];c[5]=a[4];c[4]=a[3];c[3]=0;c[2]=a[2];c[1]=a[1];c[0]=a[0];return c};a.kG=function(a,c){c||(c=a);var d=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<d?(c[3]=2*Math.acos(a[3]),d=1/Math.sqrt(d),c[0]=a[0]*d,c[1]=a[1]*d,c[2]=a[2]*d):(c[3]=0,c[0]=1,c[1]=0,c[2]=0);return c};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.jb=function(a){return a*Math.PI/180};a.Ld=function(a){return 180*
a/Math.PI};a.Uy=function(a){var c=.366025403784439*a[0]+.366025403784439*a[1],d=Math.floor(a[0]+c),n=Math.floor(a[1]+c),b=.211324865405187*d+.211324865405187*n,c=a[0]-d+b;a=a[1]-n+b;var h=c>a?1:0,e=1-h,b=c+.211324865405187-h,f=a+.211324865405187-e,y=c+-.577350269189626,C=a+-.577350269189626,d=d%289,n=n%289,u=B(B(n)+d),e=B(B(n+e)+d+h),v=B(B(n+1)+d+1),d=Math.max(.5-(c*c+a*a),0),n=Math.max(.5-(b*b+f*f),0),h=Math.max(.5-(y*y+C*C),0),L=2*r(.024390243902439*u)-1,p=2*r(.024390243902439*e)-1,g=2*r(.024390243902439*
v)-1,u=Math.abs(L)-.5,e=Math.abs(p)-.5,v=Math.abs(g)-.5,L=L-Math.floor(L+.5),p=p-Math.floor(p+.5),g=g-Math.floor(g+.5),d=d*d*d*d*(1.79284291400159-.85373472095314*(L*L+u*u)),n=n*n*n*n*(1.79284291400159-.85373472095314*(p*p+e*e)),h=h*h*h*h*(1.79284291400159-.85373472095314*(g*g+v*v));return 130*(d*(L*c+u*a)+n*(p*b+e*f)+h*(g*y+v*C))};a.FB=function(a){var c=1/7,d=c/2,n=f(Math.floor(a[0])),b=f(Math.floor(a[1])),h=r(a[0]);a=r(a[1]);var e=h-.5,y=h-1.5,h=a-.5;a-=1.5;var C=w(n),u=w(n+1),v=C,n=u,C=w(C+b),
u=w(u+b),v=w(v+b+1),n=w(n+b+1),b=e+.7*(q(C)*c+d),L=y+.7*(q(u)*c+d),e=e+.7*(q(v)*c+d),y=y+.7*(q(n)*c+d),C=h+.7*(q(Math.floor(C*c))*c+d),h=h+.7*(q(Math.floor(u*c))*c+d),v=a+.7*(q(Math.floor(v*c))*c+d),c=a+.7*(q(Math.floor(n*c))*c+d);return Math.min(b*b+C*C,L*L+h*h,e*e+v*v,y*y+c*c)};a.Zx=function(a,c,d,n,b){b||(b=new Float32Array(4));a=M.transformQuat(c,a,t);c=d[0];var h=d[1];d=d[2];L[0]=h*h+d*d;L[1]=-h*c;L[2]=-d*c;L[3]=-c*h;L[4]=c*c+d*d;L[5]=-d*h;L[6]=-c*d;L[7]=-h*d;L[8]=c*c+h*h;M.transformMat3(a,L,
a);M.normalize(a,a);v.rotationTo(n,a,b);return b};a.ov=function(a,c){c||(c=new Float32Array(4));var d=u,n=C,d=v.setAxisAngle([0,1,0],Math.PI,v.create()),n=v.setAxisAngle([1,0,0],Math.PI/2,v.create());v.multiply(d,n,d);v.multiply(a,d,c);return c};a.ha=function(){p=0;R={}};a.S=function(a,c,d){return Math.min(Math.max(a,c),d)};a.mc=function(a,c,d,n){d=Math.exp(-d/n);return(1-d)*a+d*c};a.bm=function(a,c,d,n,b){b||(b=new Float32Array(a.length));d=Math.exp(-d/n);for(n=0;n<b.length;n++)b[n]=(1-d)*a[n]+d*
c[n];return b};a.qH=function(a,c,d,n,b){b||(b=new Float32Array(a.length));v.slerp(a,c,Math.exp(-d/n),b)};a.D_=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.di=function(a,c){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(c&&c==a.length||!c)return!0;return!1};a.cC=function(a,c){var d=D.fromQuat(a,L);y[0]=0;y[1]=1;y[2]=0;t[0]=d[3];t[1]=d[4];t[2]=d[5];var n=M.cross(y,t,t);M.normalize(n,n);var b=d[7];!c&&0<b&&(n[0]*=-1,n[1]*=-1,n[2]*=-1);
y[0]=d[0];y[1]=d[1];y[2]=d[2];M.normalize(y,y);v.rotationTo(y,n,C);v.multiply(C,a,a)};a.nD=function(a,c,d,n){d=d*c-.5;var b=n*c-.5;n=d-Math.floor(d);var h=b-Math.floor(b);d=Math.floor(d);var b=Math.floor(b),e=c-1,f=a[b*c+d],y=a[b*c+Math.min(d+1,e)],C=a[Math.min(b+1,e)*c+d];a=a[Math.min(b+1,e)*c+Math.min(d+1,e)];return(f*(1-n)+y*n)*(1-h)+(C*(1-n)+a*n)*h};a.bk=function(a){for(var c=0,d=0;3>d;d++)0<(a&1<<d)&&c++;return c};a.AG=function(a){for(var c=[0,0,0],d=0;3>d;d++)0<(a&1<<d)&&(c[2-d]=1);return c};
a.Po=function(a,c){var d=0;(1==c||2==c)&&0<(a&4)&&d++;2==c&&0<(a&2)&&d++;return d};a.xw=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"==a?c:c&3|8).toString(16)})};a.Yn=function(a){var c=0,d;for(d in a)a.hasOwnProperty(d)&&c++;return c};a.oG=function(a){if(!a.length)return null;var c=Math.floor(Math.random()*a.length);return a[c]};a.RI=function(a,c,d){d||(d=new Float32Array(3));d[0]=a[0]-c[0];d[1]=0;d[2]=a[2]-c[2];M.normalize(d,
d)};a.uT=function(a,c,d){var n=a[0],b=a[1];a=a[2];var h=c[0],e=c[1],f=c[2];c=c[3];var y=e*a-f*b,C=f*n-h*a,u=h*b-e*n,v=e*u-f*C,f=f*y-h*u,h=h*C-e*y;d[0]=n+2*y*c+2*v;d[1]=b+2*C*c+2*f;d[2]=a+2*u*c+2*h};a.assert=function(a){a||g("Assertion failed")};a.l=g;a.qf=z;a.Eg=A;a.Iw=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.CH=function(a,c){for(var d in a){var n=!0,b=a[d],h=c[d];switch(typeof b){case "number":case "string":case "boolean":n=b==h;break;case "object":n=J(b,h)}if(!n)return!1}return!0};a.Yx=
function(a,c){var d=a[0],n=a[2],b=a[3];c[0]=a[1];c[1]=n;c[2]=b;c[3]=d};a.eD=function(a){a+=1;132651<a&&d.error("Color ID pool depleted");var c=Math.floor(a/2601);a%=2601;var n=Math.floor(a/51);return new Float32Array([c/51,n/51,a%51/51])};a.ox=function(a,d,n,b){u.set(a);u[3]=d;t[0]=n[3];t[1]=n[4];t[2]=n[5];C.set(t);C[3]=0;a=c.dot(u,C);if(0==a)return null;M.copy(n,t);C.set(t);C[3]=1;a=-c.dot(u,C)/a;b[0]=n[0]+a*n[3];b[1]=n[1]+a*n[4];b[2]=n[2]+a*n[5];return b};a.jP=function(a,c,d,n){var b=c[0]-a[0],
h=d[0]-a[0],e=c[1]-a[1],f=d[1]-a[1];c=c[2]-a[2];a=d[2]-a[2];n[0]=e*a-c*f;n[1]=h*c-b*a;n[2]=b*f-e*h;return n};a.zX=function(a,c){for(var d=0;d<a.length;d++)c[d]=a[d];return c};a.CG=function(a,c,d){var n=M.dot(a,c);-.9999999>n?(M.cross(aa,a,t),1E-6>M.length(t)&&M.cross(fa,a,t),M.normalize(t,t),v.setAxisAngle(t,Math.PI,d)):(M.cross(a,c,t),d.set(t),d[3]=1+n,v.normalize(d,d));return d};a.ej=function(a,c,d){if(c==d)return d-a;a=A(a);c=A(c);d=A(d);c=2*Math.PI-c;d=A(d+c);a=A(a+c);return a>d?(d-=a,a=2*Math.PI-
a,-d>a?a:d):0};a.gk=function(a,c,d){isFinite(c)&&isFinite(d)&&(a=clamp(a,c,d));return a*a*(3-2*a)};a.lerp=function(a,c,d){return c+a*(d-c)};a.uL=function(a,c){for(var d=0;d<a.length;d++)for(var n=0;n<c.length;n++)if(c[n]==a[d])return!0;return!1};a.GX=function(a){for(var c=Array(a),d=0;d<a;d++)c[d]=0;return c};a.xI=function(a,c){for(var d=Math.max(a.length,c.length),n=0;n<d;n++){var b=m((n>=a.length?0:a[n])-(n>=c.length?0:c[n]));if(b)return b}return 0};a.Ii=function(a){return a.join(".")};a.AH=function(a){return a.split(".").map(function(a){return a|
0})};a.W1=function(a,c){c[0]=Math.pow(a[0],2.2);c[1]=Math.pow(a[1],2.2);c[2]=Math.pow(a[2],2.2);return c};a.Q_=function(a,c){c[0]=Math.pow(a[0],1/2.2);c[1]=Math.pow(a[1],1/2.2);c[2]=Math.pow(a[2],1/2.2);return c};a.vo=function(a){var c=a.split("://",2);return 1<c.length?(c[1]=F(c[1]),c.join("://")):F(a)};a.en=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.WN=function(a,c,d,n){n[0]=a[0];n[1]=c[0];n[2]=d[0];n[3]=a[1];n[4]=c[1];n[5]=d[1];n[6]=a[2];n[7]=c[2];n[8]=d[2];return n}};b4w.module.__boundings=function(a,l){function m(a,d){for(var b=a[0],e=a[1],f=a[2],c=a[0],p=a[1],g=a[2],m=3;m<a.length;m+=3)var t=a[m],y=a[m+1],u=a[m+2],b=Math.max(b,t),e=Math.max(e,y),f=Math.max(f,u),c=Math.min(c,t),p=Math.min(p,y),g=Math.min(g,u);d.max_x=b;d.max_y=e;d.max_z=f;d.min_x=c;d.min_y=p;d.min_z=g;return d}function b(a,d){d||(d=new Float32Array(24));var b=a.max_x,e=a.max_y,f=a.max_z,c=a.min_x,p=a.min_y,g=a.min_z;d[0]=c;d[1]=p;d[2]=g;d[3]=b;d[4]=p;d[5]=g;d[6]=b;d[7]=e;d[8]=g;d[9]=c;d[10]=
e;d[11]=g;d[12]=c;d[13]=p;d[14]=f;d[15]=b;d[16]=p;d[17]=f;d[18]=b;d[19]=e;d[20]=f;d[21]=c;d[22]=e;d[23]=f;return d}function e(){return{$d:new Float32Array(3),ae:new Float32Array(3),be:new Float32Array(3),O:new Float32Array([0,0,0])}}function x(a,d,b,e){return{$d:new Float32Array(a),ae:new Float32Array(d),be:new Float32Array(b),O:new Float32Array([e[0],e[1],e[2]])}}function k(a,d){var b=q.$L(a,F),b=d?q.UL(a,b,D):g.identity(D),b=q.nO(b,G);f.copy(a,A);f.transformMat3(A,b,A);for(var e=A[0],m=e,c=A[1],
p=c,k=A[2],K=k,t=0,y=0,u=0,C=0,L=0,n=0,T=3;T<a.length;T+=3)A[0]=a[T],A[1]=a[T+1],A[2]=a[T+2],f.transformMat3(A,b,A),t=A[0],y=A[1],u=A[2],t>e&&(e=t),t<m&&(m=t),y>c&&(c=y),y<p&&(p=y),u>k&&(k=u),u<K&&(K=u);c-=p;k-=K;e=Math.max(e-m,1E-9);c=Math.max(c,1E-9);k=Math.max(k,1E-9);m=g.identity(D);m[0]=0!=e?1/e:1E8;m[4]=0!=c?1/c:1E8;m[8]=0!=k?1/k:1E8;g.transpose(b,H);A[0]=a[0];A[1]=a[1];A[2]=a[2];f.transformMat3(A,b,A);f.transformMat3(A,m,A);f.transformMat3(A,H,A);t=A[0];y=A[0];u=A[1];C=A[1];L=A[2];n=A[2];for(T=
3;T<a.length;T+=3)A[0]=a[T],A[1]=a[T+1],A[2]=a[T+2],f.transformMat3(A,b,A),f.transformMat3(A,m,A),f.transformMat3(A,H,A),t=Math.max(t,A[0]),y=Math.min(y,A[0]),u=Math.max(u,A[1]),C=Math.min(C,A[1]),L=Math.max(L,A[2]),n=Math.min(n,A[2]);T=Math.sqrt((t-y)*(t-y)+(u-C)*(u-C)+(L-n)*(L-n))/2;T=Math.min(T,1);N[0]=(t+y)/2;N[1]=(u+C)/2;N[2]=(L+n)/2;t=N;m=g.identity(D);m[0]=e;m[4]=c;m[8]=k;f.transformMat3(t,b,t);f.transformMat3(t,m,t);f.transformMat3(t,H,t);m=[b[0],b[3],b[6]];y=[b[1],b[4],b[7]];b=[b[2],b[5],
b[8]];f.scale(m,e*T,m);f.scale(y,c*T,y);f.scale(b,k*T,b);return x(m,y,b,t)}function B(a,d,b){f.add(d,b,a.O);f.scale(a.O,.5,a.O);a.mb=f.distance(a.O,d);return a}var r=l("__tsr"),w=l("__util"),f=l("__vec3"),q=l("__math"),g=l("__mat3");l("__quat");var z=new Float32Array(24),A=new Float32Array(3),J=new Float32Array(3),N=new Float32Array(3),F=new Float32Array(3),G=new Float32Array(9),D=new Float32Array(9),H=new Float32Array(9);new Float32Array(9);a.yq=function(a,d){d.min_x=a.min_x;d.max_x=a.max_x;d.min_y=
a.min_y;d.max_y=a.max_y;d.min_z=a.min_z;d.max_z=a.max_z};a.UW=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.bc=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.VL=function(a){var d=a.max_x-a.min_x,b=a.max_y-a.min_y;b<d&&(d=b);a=a.max_z-a.min_z;a<d&&(d=a);return d};a.Nn=function(a,d){var b=a.max_y,e=a.max_z,f=a.min_x,c=a.min_y,p=a.min_z;a.max_x=Math.max(d.max_x,a.max_x);a.max_y=Math.max(d.max_y,b);a.max_z=Math.max(d.max_z,
e);a.min_x=Math.min(d.min_x,f);a.min_y=Math.min(d.min_y,c);a.min_z=Math.min(d.min_z,p)};a.HL=m;a.Hg=function(e,d,h){h||(h=a.bc());e=b(e,z);r.tm(e,d,e);return m(e,h)};a.On=b;a.L1=function(b,d,h){h||(h=a.bc());var e=d.min_x,f=d.max_x,c=d.min_y,p=d.max_y,g=d.min_z;d=d.max_z;if(e>=b.max_x||f<=b.min_x||c>=b.max_y||p<=b.min_y||g>=b.max_z||d<=b.min_z)return h.min_x=-.1,h.max_x=.1,h.min_y=-.1,h.max_y=.1,h.min_z=-.2,h.max_z=-.1,h;h.min_x=Math.max(b.min_x,e);h.max_x=Math.min(b.max_x,f);h.min_y=Math.max(b.min_y,
c);h.max_y=Math.min(b.max_y,p);h.min_z=Math.max(b.min_z,g);h.max_z=Math.min(b.max_z,d);return h};a.d2=function(b,d,h){h||(h=a.bc());var e=b.max_x-b.min_x,f=b.max_y-b.min_y,c=b.max_z-b.min_z;h.min_x=b.min_x-.5*(d-1)*e;h.max_x=b.max_x+.5*(d-1)*e;h.min_y=b.min_y-.5*(d-1)*f;h.max_y=b.max_y+.5*(d-1)*f;h.min_z=b.min_z-.5*(d-1)*c;h.max_z=b.max_z+.5*(d-1)*c;return h};a.iv=function(b,d,h){h||(h=a.Mi());r.Fc(b.O,d,h.O);h.mb=b.mb*r.Pc(d);return h};a.Jk=function(a,d,b){b||(b=e());r.Fc(a.O,d,b.O);f.copy(a.$d,
b.$d);f.copy(a.ae,b.ae);f.copy(a.be,b.be);r.Tc(b.$d,d,b.$d);r.Tc(b.ae,d,b.ae);r.Tc(b.be,d,b.be);return b};a.Bq=function(a,d){return{mb:a,O:new Float32Array(d)}};a.Mi=function(){return{O:new Float32Array([0,0,0]),mb:0}};a.kf=e;a.rn=x;a.JL=function(){return{O:new Float32Array([0,0,0]),mb:1E12}};a.dO=function(a,d){var b=f.subtract(d.O,a.O,f.create());0==f.length(b)&&f.set(1,0,0,b);var e=f.normalize(b,f.create()),b=f.scale(e,a.mb,f.create());f.add(b,a.O,b);var g=f.scale(e,-a.mb,f.create());f.add(g,a.O,
g);var c=f.scale(e,d.mb,f.create());f.add(c,d.O,c);var p=f.scale(e,-d.mb,f.create());f.add(p,d.O,p);b=[b,g,c,p];e=f.normalize(e,f.create());g=b[0];c=b[0];for(p=1;p<b.length;p++){var m=f.dot(b[p],e);m<f.dot(g,e)&&(g=b[p]);m>f.dot(c,e)&&(c=b[p])}e=[g,c];b=e[0];e=e[1];a.O=f.scale(f.add(b,e,f.create()),.5,f.create());a.mb=f.length(f.subtract(e,b,f.create()))/2};a.Aq=k;a.kv=function(a,d){var b=w.ia(a),e=r.Xh(d,F);f.subtract(b.O,e,b.O);return b};a.dC=function(a,d){var b=d.max_y,e=d.min_y,f=Math.max(0,b-
e-2*a);return{mb:a,height:f,O:new Float32Array([0,(b+e)/2,0])}};a.fC=function(a,d){var b=d.max_y,e=d.min_y,f=Math.max(0,b-e);return{mb:a,height:f,O:new Float32Array([0,(b+e)/2,0])}};a.eC=function(a,d){var b=d.max_y,e=d.min_y,f=Math.max(0,b-e);return{mb:a,height:f,O:new Float32Array([0,(b+e)/2,0])}};a.cX=function(a,d){return a.min_x>d.max_x||a.max_x<d.min_x?!1:a.min_y>d.max_y||a.max_y<d.min_y?!1:a.min_z>d.max_z||a.max_z<d.min_z?!1:!0};a.tR=function(a){for(var d=0,b=0,e=0,f=0,c=0,p=0,g=0,m=0,t=0,y=
0,u=0,C=0,L=0,n=0,T=0;T<a.submeshes.length;T++){var O=a.submeshes[T];if(O.position.length){d=f=O.position[0];b=c=O.position[1];e=p=O.position[2];break}}for(T=0;T<a.submeshes.length;T++){for(var O=a.submeshes[T],q=O.position,g=y=O.position[0],m=u=O.position[1],t=C=O.position[2],x=0;x<q.length/3;x++)var A=q[3*x],r=q[3*x+1],J=q[3*x+2],d=Math.max(A,d),b=Math.max(r,b),e=Math.max(J,e),f=Math.min(A,f),c=Math.min(r,c),p=Math.min(J,p),g=Math.max(A,g),m=Math.max(r,m),t=Math.max(J,t),y=Math.min(A,y),u=Math.min(r,
u),C=Math.min(J,C),L=Math.max(Math.sqrt(A*A+r*r+J*J),L),n=Math.max(Math.sqrt(A*A+J*J),n);q=O.boundings.bounding_box;q.max_x=g;q.min_x=y;q.max_y=m;q.min_y=u;q.max_z=t;q.min_z=C;q=z;q[0]=y;q[1]=u;q[2]=C;q[3]=g;q[4]=u;q[5]=C;q[6]=g;q[7]=m;q[8]=C;q[9]=y;q[10]=m;q[11]=C;q[12]=y;q[13]=u;q[14]=t;q[15]=g;q[16]=u;q[17]=t;q[18]=g;q[19]=m;q[20]=t;q[21]=y;q[22]=m;q[23]=t;g=k(q,!1);O.boundings.bounding_ellipsoid_center=g.O;O.boundings.bounding_ellipsoid_axes=[g.$d[0],g.ae[1],g.be[2]]}a.b4w_bounding_box.max_x=
d;a.b4w_bounding_box.min_x=f;a.b4w_bounding_box.max_y=b;a.b4w_bounding_box.min_y=c;a.b4w_bounding_box.max_z=e;a.b4w_bounding_box.min_z=p;a.b4w_bounding_box_source.max_x=d;a.b4w_bounding_box_source.min_x=f;a.b4w_bounding_box_source.max_y=b;a.b4w_bounding_box_source.min_y=c;a.b4w_bounding_box_source.max_z=e;a.b4w_bounding_box_source.min_z=p;a.b4w_bounding_sphere_radius=L;a.b4w_bounding_cylinder_radius=n;q=z;q[0]=f;q[1]=c;q[2]=p;q[3]=d;q[4]=c;q[5]=p;q[6]=d;q[7]=b;q[8]=p;q[9]=f;q[10]=b;q[11]=p;q[12]=
f;q[13]=c;q[14]=e;q[15]=d;q[16]=c;q[17]=e;q[18]=d;q[19]=b;q[20]=e;q[21]=f;q[22]=b;q[23]=e;g=k(q,!1);a.b4w_bounding_ellipsoid_center=g.O;a.b4w_bounding_ellipsoid_axes=[g.$d[0],g.ae[1],g.be[2]]};a.cP=function(b){var d=b.subarray(0,3),h=b.subarray(6,9),e=b.subarray(12,15),g=b.subarray(18,21);b=f.subtract(h,d,A);f.normalize(b,b);var c=w.jP(d,h,e,J),c=f.cross(c,b,c);f.normalize(c,c);var p=f.create(),m=f.create();f.subtract(h,d,N);m[0]=f.dot(N,b);m[1]=f.dot(N,c);h=f.create();f.subtract(e,d,N);h[0]=f.dot(N,
b);h[1]=f.dot(N,c);e=f.create();f.subtract(g,d,N);e[0]=f.dot(N,b);e[1]=f.dot(N,c);g=a.Mi();e=[p,m,h,e];p=B(g,e[0],e[1]);for(g=2;g<e.length;g++)if(f.distance(p.O,e[g])>p.mb){for(var k=p,p=e,m=e[g],h=g-1,k=B(k,m,p[0]),t=1;t<=h;t++)if(f.distance(k.O,p[t])>k.mb){for(var y=k,k=p,u=m,C=p[t],L=t-1,y=B(y,u,C),n=0;n<=L;n++)if(f.distance(y.O,k[n])>y.mb){var T=u,q=C,z=k[n],x=f.subtract(q,z,N),x=f.squaredLength(x),r=f.subtract(T,z,N),D=f.squaredLength(r),r=f.subtract(T,q,N),H=f.squaredLength(r),r=x*(D+H-x),aa=
D*(H+x-D),x=H*(x+D-H),D=r+aa+x;f.copy(T,y.O);f.scale(y.O,r/D,y.O);f.scaleAndAdd(y.O,q,aa/D,y.O);f.scaleAndAdd(y.O,z,x/D,y.O);y.mb=f.distance(y.O,T)}k=y}p=k}g=p;b=f.scale(b,g.O[0],N);f.scaleAndAdd(b,c,g.O[1],b);f.add(b,d,g.O);return g}};b4w.module.__tsr=function(a,l){function m(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function b(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function e(a,b,e,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=b;f[4]=e[0];f[5]=e[1];f[6]=e[2];f[7]=e[3];return f}function x(a,b,e){var f=b[0],g=b[1],m=b[2],k=b[3],d=b[4],h=b[5],v=b[6];b=b[7];var q=a[0]*k,c=a[1]*k,p=a[2]*k;a=b*q+h*p-v*c;var k=b*c+v*q-d*p,z=b*p+d*c-h*q,q=-d*q-h*c-v*p;e[0]=a*b+q*-d+k*-v-z*-h;e[1]=k*b+q*-h+z*-d-a*-v;e[2]=z*b+q*-v+a*-h-k*-d;
e[0]+=f;e[1]+=g;e[2]+=m;return e}var k=l("__mat4"),B=l("__quat"),r=l("__util"),w=l("__vec3"),f=Math.sin(-Math.PI/4),q=-f,g=new Float32Array(3),z=new Float32Array(4),A=new Float32Array(16);a.create=m;a.yY=function(a,b,e,f,g,k,q,d){var h=m();h[0]=a;h[1]=b;h[2]=e;h[3]=f;h[4]=g;h[5]=k;h[6]=q;h[7]=d;return h};a.$f=b;a.zY=function(a,e,f,g,m,k,q,d){var h=b();h[0]=a;h[1]=e;h[2]=f;h[3]=g;h[4]=m;h[5]=k;h[6]=q;h[7]=d;return h};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];
b[6]=a[6];b[7]=a[7];return b};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.rh=e;a.ff=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.ve=function(a,b){b[3]=a;return b};a.uS=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.ti=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.q=function(a){return a.subarray(0,3)};a.Xh=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Pc=function(a){return a[3]};a.B=function(a){return a.subarray(4,
8)};a.Lw=function(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b};a.invert=function(a,b){var e=1/a[3];if(!e)return null;var f=a[0],g=a[1],m=a[2];z[0]=a[4];z[1]=a[5];z[2]=a[6];z[3]=a[7];B.invert(z,z);var k=z[0],d=z[1],h=z[2],v=z[3],f=f*e,g=g*e,q=m*e,m=v*f+d*q-h*g,c=v*g+h*f-k*q,p=v*q+k*g-d*f,f=-k*f-d*g-h*q;b[0]=-(m*v+f*-k+c*-h-p*-d);b[1]=-(c*v+f*-d+p*-k-m*-h);b[2]=-(p*v+f*-h+m*-d-c*-k);b[3]=e;b[4]=k;b[5]=d;b[6]=h;b[7]=v;return b};a.RH=function(a,b){var e=a[3];k.fromRotationTranslation(a.subarray(4,
8),a.subarray(0,3),b);for(var f=0;12>f;f++)b[f]*=e};a.Xg=function(a,b){var f=r.nF(a,g),m=r.mF(a),k=r.Nr(a,z);e(f,m,k,b)};a.multiply=function(a,b,e){x(b,a,e);e[3]=a[3]*b[3];var f=a[4],g=a[5],m=a[6];a=a[7];var k=b[4],d=b[5],h=b[6];b=b[7];e[4]=f*b+a*k+g*h-m*d;e[5]=g*b+a*d+m*k-f*h;e[6]=m*b+a*h+f*d-g*k;e[7]=a*b-f*k-g*d-m*h;return e};a.vT=function(a,b,e){var f=b[3];b=k.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),A);for(var g=0;12>g;g++)b[g]*=f;k.multiply(b,a,e);return e};a.Fc=x;a.s2=function(a,
b,e){var f=b[3],g=a[0]-b[0],m=a[1]-b[1],k=a[2]-b[2];a=b[4];var d=b[5],h=b[6];b=b[7];var v=a*a+d*d+h*h+b*b,v=v?1/v:0;a=-a*v;d=-d*v;h=-h*v;b*=v;var v=b*g+d*k-h*m,q=b*m+h*g-a*k,c=b*k+a*m-d*g,g=-a*g-d*m-h*k;e[0]=v*b+g*-a+q*-h-c*-d;e[1]=q*b+g*-d+c*-a-v*-h;e[2]=c*b+g*-h+v*-d-q*-a;e[0]/=f;e[1]/=f;e[2]/=f;return e};a.tm=function(a,b,e,f){f||(f=0);var g=a.length,m=b[0],k=b[1],d=b[2],h=b[3],v=b[4],q=b[5],c=b[6];b=b[7];for(var p=0;p<g;p+=3){var z=a[p]*h,K=a[p+1]*h,t=a[p+2]*h,y=b*z+q*t-c*K,u=b*K+c*z-v*t,C=b*
t+v*K-q*z,z=-v*z-q*K-c*t;e[f+p]=y*b+z*-v+u*-c-C*-q;e[f+p+1]=u*b+z*-q+C*-v-y*-c;e[f+p+2]=C*b+z*-c+y*-q-u*-v;e[f+p]+=m;e[f+p+1]+=k;e[f+p+2]+=d}};a.aI=function(a,b,e,f){f||(f=0);var g=a.length,m=b[3],k=b[4],d=b[5],h=b[6];b=b[7];for(var v=0;v<g;v+=3){var q=a[v]*m,c=a[v+1]*m,p=a[v+2]*m,z=b*q+d*p-h*c,K=b*c+h*q-k*p,t=b*p+k*c-d*q,q=-k*q-d*c-h*p;e[f+v]=z*b+q*-k+K*-h-t*-d;e[f+v+1]=K*b+q*-d+t*-k-z*-h;e[f+v+2]=t*b+q*-h+z*-d-K*-k}};a.Tc=function(a,b,e){var f=b[3],g=b[4],m=b[5],k=b[6];b=b[7];var d=a[0]*f,h=a[1]*
f,v=a[2]*f;a=b*d+m*v-k*h;var f=b*h+k*d-g*v,q=b*v+g*h-m*d,d=-g*d-m*h-k*v;e[0]=a*b+d*-g+f*-k-q*-m;e[1]=f*b+d*-m+q*-g-a*-k;e[2]=q*b+d*-k+a*-m-f*-g};a.bI=function(a,b,e,f){f||(f=0);var g=a.length,m=b[3],k=b[4],d=b[5],h=b[6];b=b[7];for(var v=0;v<g;v+=4){var q=a[v]*m,c=a[v+1]*m,p=a[v+2]*m,z=b*q+d*p-h*c,K=b*c+h*q-k*p,t=b*p+k*c-d*q,q=-k*q-d*c-h*p;e[f+v]=z*b+q*-k+K*-h-t*-d;e[f+v+1]=K*b+q*-d+t*-k-z*-h;e[f+v+2]=t*b+q*-h+z*-d-K*-k;e[f+v+3]=a[v+3]}};a.translate=function(a,b,e){var f=a[3],g=a[4],m=a[5],k=a[6],
d=a[7],h=b[0]*f,v=b[1]*f,q=b[2]*f;b=d*h+m*q-k*v;var f=d*v+k*h-g*q,c=d*q+g*v-m*h,h=-g*h-m*v-k*q;e[0]=a[0]+b*d+h*-g+f*-k-c*-m;e[1]=a[1]+f*d+h*-m+c*-g-b*-k;e[2]=a[2]+c*d+h*-k+b*-m-f*-g;e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];return e};a.cx=function(a,b,e,f){w.lerp(a.subarray(0,3),b.subarray(0,3),e,f.subarray(0,3));var g=a[3];f[3]=g+e*(b[3]-g);B.slerp(a.subarray(4,8),b.subarray(4,8),e,f.subarray(4,8));return f};a.hY=function(a,b,e,f){var g=a.subarray(0,3),m=b.subarray(0,3),k=f.subarray(0,3);
k[0]=m[0]*(e+1)-g[0]*e;k[1]=m[1]*(e+1)-g[1]*e;k[2]=m[2]*(e+1)-g[2]*e;f[3]=b[3]*(e+1)-a[3]*e;a=a.subarray(4,8);b=b.subarray(4,8);g=f.subarray(4,8);g[0]=b[0]*(e+1)-a[0]*e;g[1]=b[1]*(e+1)-a[1]*e;g[2]=b[2]*(e+1)-a[2]*e;g[3]=b[3]*(e+1)-a[3]*e;B.normalize(g,g);return f};a.LP=function(a,b,e,f,g){g[0]=a[0]+b*e[0];g[1]=a[1]+b*e[1];g[2]=a[2]+b*e[2];g[3]=a[3];e=f[0];var m=f[1];f=f[2];var k=a[4],d=a[5],h=a[6],v=a[7];g[4]=.5*(e*v+m*h-f*d);g[5]=.5*(m*v+f*k-e*h);g[6]=.5*(f*v+e*d-m*k);g[7]=.5*(-e*k-m*d-f*h);g[4]=
a[4]+g[4]*b;g[5]=a[5]+g[5]*b;g[6]=a[6]+g[6]*b;g[7]=a[7]+g[7]*b;a=g[4];b=g[5];e=g[6];m=g[7];a=a*a+b*b+e*e+m*m;0<a&&(a=1/Math.sqrt(a),g[4]*=a,g[5]*=a,g[6]*=a,g[7]*=a)};a.SH=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var e=a[4],g=a[5],m=a[6],k=a[7];b[4]=e*q+k*f;b[5]=g*q+m*f;b[6]=m*q-g*f;b[7]=k*q-e*f};a.qT=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__vec3=function(a){var l="undefined"!==typeof Float32Array?Float32Array:Array,m=Math.random;a.create=function(){var a=new l(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var e=new l(3);e[0]=a[0];e[1]=a[1];e[2]=a[2];return e};a.fromValues=function(a,e,m){var k=new l(3);k[0]=a;k[1]=e;k[2]=m;return k};a.copy=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];return e};a.set=function(a,e,m,k){k[0]=a;k[1]=e;k[2]=m;return k};a.add=function(a,e,m){m[0]=a[0]+e[0];m[1]=a[1]+e[1];m[2]=a[2]+e[2];
return m};a.subtract=function(a,e,m){m[0]=a[0]-e[0];m[1]=a[1]-e[1];m[2]=a[2]-e[2];return m};a.sub=a.subtract;a.multiply=function(a,e,m){m[0]=a[0]*e[0];m[1]=a[1]*e[1];m[2]=a[2]*e[2];return m};a.mul=a.multiply;a.divide=function(a,e,m){m[0]=a[0]/e[0];m[1]=a[1]/e[1];m[2]=a[2]/e[2];return m};a.div=a.divide;a.min=function(a,e,m){m[0]=Math.min(a[0],e[0]);m[1]=Math.min(a[1],e[1]);m[2]=Math.min(a[2],e[2]);return m};a.max=function(a,e,m){m[0]=Math.max(a[0],e[0]);m[1]=Math.max(a[1],e[1]);m[2]=Math.max(a[2],
e[2]);return m};a.scale=function(a,e,m){m[0]=a[0]*e;m[1]=a[1]*e;m[2]=a[2]*e;return m};a.scaleAndAdd=function(a,e,m,k){k[0]=a[0]+e[0]*m;k[1]=a[1]+e[1]*m;k[2]=a[2]+e[2]*m;return k};a.distance=function(a,e){var m=e[0]-a[0],k=e[1]-a[1],B=e[2]-a[2];return Math.sqrt(m*m+k*k+B*B)};a.dist=a.distance;a.squaredDistance=function(a,e){var m=e[0]-a[0],k=e[1]-a[1],B=e[2]-a[2];return m*m+k*k+B*B};a.sqrDist=a.squaredDistance;a.length=function(a){var e=a[0],m=a[1];a=a[2];return Math.sqrt(e*e+m*m+a*a)};a.len=a.length;
a.squaredLength=function(a){var e=a[0],m=a[1];a=a[2];return e*e+m*m+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,e){e[0]=-a[0];e[1]=-a[1];e[2]=-a[2];return e};a.inverse=function(a,e){e[0]=1/a[0];e[1]=1/a[1];e[2]=1/a[2];return e};a.normalize=function(a,e){var m=a[0],k=a[1],B=a[2],m=m*m+k*k+B*B;0<m&&(m=1/Math.sqrt(m),e[0]=a[0]*m,e[1]=a[1]*m,e[2]=a[2]*m);return e};a.dot=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]};a.cross=function(a,e,m){var k=a[0],B=a[1];a=a[2];var r=e[0],w=e[1];e=e[2];
m[0]=B*e-a*w;m[1]=a*r-k*e;m[2]=k*w-B*r;return m};a.lerp=function(a,e,m,k){var B=a[0],r=a[1];a=a[2];k[0]=B+m*(e[0]-B);k[1]=r+m*(e[1]-r);k[2]=a+m*(e[2]-a);return k};a.o_=function(a,e,m,k,B,r){var w=B*B,f=w*(2*B-3)+1,q=w*(B-2)+B,g=w*(B-1);B=w*(3-2*B);r[0]=a[0]*f+e[0]*q+m[0]*g+k[0]*B;r[1]=a[1]*f+e[1]*q+m[1]*g+k[1]*B;r[2]=a[2]*f+e[2]*q+m[2]*g+k[2]*B;return r};a.sB=function(a,e,m,k,B,r){var w=1-B,f=w*w,q=B*B,g=f*w,f=3*B*f,w=3*q*w;B*=q;r[0]=a[0]*g+e[0]*f+m[0]*w+k[0]*B;r[1]=a[1]*g+e[1]*f+m[1]*w+k[1]*B;r[2]=
a[2]*g+e[2]*f+m[2]*w+k[2]*B;return r};a.random=function(a,e){a=a||1;var x=2*m()*Math.PI,k=2*m()-1,B=Math.sqrt(1-k*k)*a;e[0]=Math.cos(x)*B;e[1]=Math.sin(x)*B;e[2]=k*a;return e};a.transformMat4=function(a,e,m){var k=a[0],B=a[1];a=a[2];var r=e[3]*k+e[7]*B+e[11]*a+e[15],r=r||1;m[0]=(e[0]*k+e[4]*B+e[8]*a+e[12])/r;m[1]=(e[1]*k+e[5]*B+e[9]*a+e[13])/r;m[2]=(e[2]*k+e[6]*B+e[10]*a+e[14])/r;return m};a.transformMat3=function(a,e,m){var k=a[0],B=a[1];a=a[2];m[0]=k*e[0]+B*e[3]+a*e[6];m[1]=k*e[1]+B*e[4]+a*e[7];
m[2]=k*e[2]+B*e[5]+a*e[8];return m};a.transformQuat=function(a,e,m){var k=a[0],B=a[1],r=a[2];a=e[0];var w=e[1],f=e[2];e=e[3];var q=e*k+w*r-f*B,g=e*B+f*k-a*r,z=e*r+a*B-w*k,k=-a*k-w*B-f*r;m[0]=q*e+k*-a+g*-f-z*-w;m[1]=g*e+k*-w+z*-a-q*-f;m[2]=z*e+k*-f+q*-w-g*-a;return m};a.rotateX=function(a,e,m,k){var B=[],r=[];B[0]=a[0]-e[0];B[1]=a[1]-e[1];B[2]=a[2]-e[2];r[0]=B[0];r[1]=B[1]*Math.cos(m)-B[2]*Math.sin(m);r[2]=B[1]*Math.sin(m)+B[2]*Math.cos(m);k[0]=r[0]+e[0];k[1]=r[1]+e[1];k[2]=r[2]+e[2];return k};a.rotateY=
function(a,e,m,k){var B=[],r=[];B[0]=a[0]-e[0];B[1]=a[1]-e[1];B[2]=a[2]-e[2];r[0]=B[2]*Math.sin(m)+B[0]*Math.cos(m);r[1]=B[1];r[2]=B[2]*Math.cos(m)-B[0]*Math.sin(m);k[0]=r[0]+e[0];k[1]=r[1]+e[1];k[2]=r[2]+e[2];return k};a.rotateZ=function(a,e,m,k){var B=[],r=[];B[0]=a[0]-e[0];B[1]=a[1]-e[1];B[2]=a[2]-e[2];r[0]=B[0]*Math.cos(m)-B[1]*Math.sin(m);r[1]=B[0]*Math.sin(m)+B[1]*Math.cos(m);r[2]=B[2];k[0]=r[0]+e[0];k[1]=r[1]+e[1];k[2]=r[2]+e[2];return k};a.forEach=function(){var b=a.create();return function(a,
m,k,B,r,w){m||(m=3);k||(k=0);for(B=B?Math.min(B*m+k,a.length):a.length;k<B;k+=m)b[0]=a[k],b[1]=a[k+1],b[2]=a[k+2],r(b,w,b),a[k]=b[0],a[k+1]=b[1],a[k+2]=b[2];return a}}();a.qW=function(b,e){var m=a.fromValues(b[0],b[1],b[2]),k=a.fromValues(e[0],e[1],e[2]);a.normalize(m,m);a.normalize(k,k);m=a.dot(m,k);return 1<m?0:Math.acos(m)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var l="undefined"!==typeof Float32Array?Float32Array:Array,m=Math.random;a.create=function(){var a=new l(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var e=new l(4);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];return e};a.fromValues=function(a,e,m,k){var B=new l(4);B[0]=a;B[1]=e;B[2]=m;B[3]=k;return B};a.copy=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];return e};a.set=function(a,e,m,k,B){B[0]=a;B[1]=e;B[2]=m;B[3]=k;return B};a.add=function(a,e,m){m[0]=
a[0]+e[0];m[1]=a[1]+e[1];m[2]=a[2]+e[2];m[3]=a[3]+e[3];return m};a.subtract=function(a,e,m){m[0]=a[0]-e[0];m[1]=a[1]-e[1];m[2]=a[2]-e[2];m[3]=a[3]-e[3];return m};a.sub=a.subtract;a.multiply=function(a,e,m){m[0]=a[0]*e[0];m[1]=a[1]*e[1];m[2]=a[2]*e[2];m[3]=a[3]*e[3];return m};a.mul=a.multiply;a.divide=function(a,e,m){m[0]=a[0]/e[0];m[1]=a[1]/e[1];m[2]=a[2]/e[2];m[3]=a[3]/e[3];return m};a.div=a.divide;a.min=function(a,e,m){m[0]=Math.min(a[0],e[0]);m[1]=Math.min(a[1],e[1]);m[2]=Math.min(a[2],e[2]);m[3]=
Math.min(a[3],e[3]);return m};a.max=function(a,e,m){m[0]=Math.max(a[0],e[0]);m[1]=Math.max(a[1],e[1]);m[2]=Math.max(a[2],e[2]);m[3]=Math.max(a[3],e[3]);return m};a.scale=function(a,e,m){m[0]=a[0]*e;m[1]=a[1]*e;m[2]=a[2]*e;m[3]=a[3]*e;return m};a.scaleAndAdd=function(a,e,m,k){k[0]=a[0]+e[0]*m;k[1]=a[1]+e[1]*m;k[2]=a[2]+e[2]*m;k[3]=a[3]+e[3]*m;return k};a.distance=function(a,e){var m=e[0]-a[0],k=e[1]-a[1],B=e[2]-a[2],r=e[3]-a[3];return Math.sqrt(m*m+k*k+B*B+r*r)};a.dist=a.distance;a.squaredDistance=
function(a,e){var m=e[0]-a[0],k=e[1]-a[1],B=e[2]-a[2],r=e[3]-a[3];return m*m+k*k+B*B+r*r};a.sqrDist=a.squaredDistance;a.length=function(a){var e=a[0],m=a[1],k=a[2];a=a[3];return Math.sqrt(e*e+m*m+k*k+a*a)};a.len=a.length;a.squaredLength=function(a){var e=a[0],m=a[1],k=a[2];a=a[3];return e*e+m*m+k*k+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,e){e[0]=-a[0];e[1]=-a[1];e[2]=-a[2];e[3]=-a[3];return e};a.inverse=function(a,e){e[0]=1/a[0];e[1]=1/a[1];e[2]=1/a[2];e[3]=1/a[3];return e};a.normalize=
function(a,e){var m=a[0],k=a[1],B=a[2],r=a[3],w=m*m+k*k+B*B+r*r;0<w&&(w=1/Math.sqrt(w),e[0]=m*w,e[1]=k*w,e[2]=B*w,e[3]=r*w);return e};a.dot=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]*e[3]};a.lerp=function(a,e,m,k){var B=a[0],r=a[1],w=a[2];a=a[3];k[0]=B+m*(e[0]-B);k[1]=r+m*(e[1]-r);k[2]=w+m*(e[2]-w);k[3]=a+m*(e[3]-a);return k};a.random=function(b,e){b=b||1;e[0]=m();e[1]=m();e[2]=m();e[3]=m();a.normalize(e,e);a.scale(e,b,e);return e};a.transformMat4=function(a,e,m){var k=a[0],B=a[1],r=
a[2];a=a[3];m[0]=e[0]*k+e[4]*B+e[8]*r+e[12]*a;m[1]=e[1]*k+e[5]*B+e[9]*r+e[13]*a;m[2]=e[2]*k+e[6]*B+e[10]*r+e[14]*a;m[3]=e[3]*k+e[7]*B+e[11]*r+e[15]*a;return m};a.transformQuat=function(a,e,m){var k=a[0],B=a[1],r=a[2],w=e[0],f=e[1],q=e[2];e=e[3];var g=e*k+f*r-q*B,z=e*B+q*k-w*r,A=e*r+w*B-f*k,k=-w*k-f*B-q*r;m[0]=g*e+k*-w+z*-q-A*-f;m[1]=z*e+k*-f+A*-w-g*-q;m[2]=A*e+k*-q+g*-f-z*-w;m[3]=a[3];return m};a.forEach=function(){var b=a.create();return function(a,m,k,B,r,w){m||(m=4);k||(k=0);for(B=B?Math.min(B*
m+k,a.length):a.length;k<B;k+=m)b[0]=a[k],b[1]=a[k+1],b[2]=a[k+2],b[3]=a[k+3],r(b,w,b),a[k]=b[0],a[k+1]=b[1],a[k+2]=b[2],a[k+3]=b[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,l){var m=l("__vec3"),b=l("__vec4"),e=l("__mat3"),x="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new x(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=m.create(),e=m.fromValues(1,0,0),r=m.fromValues(0,1,0);return function(w,f,q){var g=m.dot(w,f);if(-.9999999>g)return m.cross(e,w,b),1E-6>m.length(b)&&m.cross(r,w,b),m.normalize(b,b),a.setAxisAngle(b,Math.PI,q),q;if(.9999999<g)return q[0]=0,q[1]=0,q[2]=0,q[3]=1,q;m.cross(w,
f,b);q[0]=b[0];q[1]=b[1];q[2]=b[2];q[3]=1+g;return a.normalize(q,q)}}();a.setAxes=function(){var b=e.create();return function(e,m,w,f){b[0]=m[0];b[3]=m[1];b[6]=m[2];b[1]=w[0];b[4]=w[1];b[7]=w[2];b[2]=-e[0];b[5]=-e[1];b[8]=-e[2];return a.normalize(a.fromMat3(b,f),f)}}();a.clone=b.clone;a.fromValues=b.fromValues;a.copy=b.copy;a.set=b.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,e){b*=.5;var m=Math.sin(b);e[0]=m*a[0];e[1]=m*a[1];e[2]=m*a[2];e[3]=Math.cos(b);
return e};a.add=b.add;a.multiply=function(a,b,e){var m=a[0],f=a[1],q=a[2];a=a[3];var g=b[0],z=b[1],A=b[2];b=b[3];e[0]=m*b+a*g+f*A-q*z;e[1]=f*b+a*z+q*g-m*A;e[2]=q*b+a*A+m*z-f*g;e[3]=a*b-m*g-f*z-q*A;return e};a.mul=a.multiply;a.scale=b.scale;a.rotateX=function(a,b,e){b*=.5;var m=a[0],f=a[1],q=a[2];a=a[3];var g=Math.sin(b);b=Math.cos(b);e[0]=m*b+a*g;e[1]=f*b+q*g;e[2]=q*b-f*g;e[3]=a*b-m*g;return e};a.rotateY=function(a,b,e){b*=.5;var m=a[0],f=a[1],q=a[2];a=a[3];var g=Math.sin(b);b=Math.cos(b);e[0]=m*
b-q*g;e[1]=f*b+a*g;e[2]=q*b+m*g;e[3]=a*b-f*g;return e};a.rotateZ=function(a,b,e){b*=.5;var m=a[0],f=a[1],q=a[2];a=a[3];var g=Math.sin(b);b=Math.cos(b);e[0]=m*b+f*g;e[1]=f*b-m*g;e[2]=q*b+a*g;e[3]=a*b-q*g;return e};a.calculateW=function(a,b){var e=a[0],m=a[1],f=a[2];b[0]=e;b[1]=m;b[2]=f;b[3]=Math.sqrt(Math.abs(1-e*e-m*m-f*f));return b};a.dot=b.dot;a.lerp=b.lerp;a.slerp=function(a,b,e,m){var f=a[0],q=a[1],g=a[2];a=a[3];var z=b[0],A=b[1],x=b[2];b=b[3];var l,F,G;F=f*z+q*A+g*x+a*b;0>F&&(F=-F,z=-z,A=-A,
x=-x,b=-b);1E-6<1-F?(l=Math.acos(F),G=Math.sin(l),F=Math.sin((1-e)*l)/G,e=Math.sin(e*l)/G):F=1-e;m[0]=F*f+e*z;m[1]=F*q+e*A;m[2]=F*g+e*x;m[3]=F*a+e*b;return m};a.V1=function(){var b=a.create(),e=a.create();return function(m,w,f,q,g,z){a.slerp(m,q,g,b);a.slerp(w,f,g,e);a.slerp(b,e,2*g*(1-g),z);return z}}();a.invert=function(a,b){var e=a[0],m=a[1],f=a[2],q=a[3],g=e*e+m*m+f*f+q*q,g=g?1/g:0;b[0]=-e*g;b[1]=-m*g;b[2]=-f*g;b[3]=q*g;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=b.length;a.len=a.length;a.squaredLength=b.squaredLength;a.sqrLen=a.squaredLength;a.normalize=b.normalize;a.fromMat3=function(a,b){var e=a[0]+a[4]+a[8];if(0<e)e=Math.sqrt(e+1),b[3]=.5*e,e=.5/e,b[0]=(a[5]-a[7])*e,b[1]=(a[6]-a[2])*e,b[2]=(a[1]-a[3])*e;else{var m=0;a[4]>a[0]&&(m=1);a[8]>a[3*m+m]&&(m=2);var f=(m+1)%3,q=(m+2)%3,e=Math.sqrt(a[3*m+m]-a[3*f+f]-a[3*q+q]+1);b[m]=.5*e;e=.5/e;b[3]=(a[3*f+q]-a[3*q+f])*e;b[f]=(a[3*f+m]+a[3*m+f])*e;b[q]=(a[3*q+m]+a[3*m+q])*e}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var l="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new l(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};a.clone=function(a){var b=new l(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,b){if(b===a){var e=a[1],x=a[2],k=a[5];b[1]=a[3];b[2]=a[6];b[3]=e;b[5]=a[7];b[6]=x;b[7]=k}else b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8];return b};a.invert=function(a,b){var e=a[0],x=a[1],k=a[2],B=a[3],r=a[4],w=a[5],f=a[6],q=a[7],g=a[8],z=g*r-w*q,A=-g*B+w*f,J=
q*B-r*f,l=e*z+x*A+k*J;if(!l)return null;l=1/l;b[0]=z*l;b[1]=(-g*x+k*q)*l;b[2]=(w*x-k*r)*l;b[3]=A*l;b[4]=(g*e-k*f)*l;b[5]=(-w*e+k*B)*l;b[6]=J*l;b[7]=(-q*e+x*f)*l;b[8]=(r*e-x*B)*l;return b};a.adjoint=function(a,b){var e=a[0],x=a[1],k=a[2],B=a[3],r=a[4],w=a[5],f=a[6],q=a[7],g=a[8];b[0]=r*g-w*q;b[1]=k*q-x*g;b[2]=x*w-k*r;b[3]=w*f-B*g;b[4]=e*g-k*f;b[5]=k*B-e*w;b[6]=B*q-r*f;b[7]=x*f-e*q;b[8]=e*r-x*B;return b};a.determinant=function(a){var b=a[3],e=a[4],x=a[5],k=a[6],B=a[7],r=a[8];return a[0]*(r*e-x*B)+a[1]*
(-r*b+x*k)+a[2]*(B*b-e*k)};a.multiply=function(a,b,e){var x=a[0],k=a[1],B=a[2],r=a[3],w=a[4],f=a[5],q=a[6],g=a[7];a=a[8];var z=b[0],A=b[1],J=b[2],l=b[3],F=b[4],G=b[5],D=b[6],H=b[7];b=b[8];e[0]=z*x+A*r+J*q;e[1]=z*k+A*w+J*g;e[2]=z*B+A*f+J*a;e[3]=l*x+F*r+G*q;e[4]=l*k+F*w+G*g;e[5]=l*B+F*f+G*a;e[6]=D*x+H*r+b*q;e[7]=D*k+H*w+b*g;e[8]=D*B+H*f+b*a;return e};a.mul=a.multiply;a.translate=function(a,b,e){var x=a[0],k=a[1],B=a[2],r=a[3],w=a[4],f=a[5],q=a[6],g=a[7];a=a[8];var z=b[0];b=b[1];e[0]=x;e[1]=k;e[2]=B;
e[3]=r;e[4]=w;e[5]=f;e[6]=z*x+b*r+q;e[7]=z*k+b*w+g;e[8]=z*B+b*f+a;return e};a.rotate=function(a,b,e){var x=a[0],k=a[1],B=a[2],r=a[3],w=a[4],f=a[5],q=a[6],g=a[7];a=a[8];var z=Math.sin(b);b=Math.cos(b);e[0]=b*x+z*r;e[1]=b*k+z*w;e[2]=b*B+z*f;e[3]=b*r-z*x;e[4]=b*w-z*k;e[5]=b*f-z*B;e[6]=q;e[7]=g;e[8]=a;return e};a.scale=function(a,b,e){var x=b[0];b=b[1];e[0]=x*a[0];e[1]=x*a[1];e[2]=x*a[2];e[3]=b*a[3];e[4]=b*a[4];e[5]=b*a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];return e};a.zO=function(a,b){b[0]=1;b[1]=0;b[2]=
0;b[3]=0;b[4]=1;b[5]=0;b[6]=a[0];b[7]=a[1];b[8]=1;return b};a.xO=function(a,b){var e=Math.sin(a),x=Math.cos(a);b[0]=x;b[1]=e;b[2]=0;b[3]=-e;b[4]=x;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};a.yO=function(a,b){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=a[1];b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};a.fromMat2d=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=0;b[3]=a[2];b[4]=a[3];b[5]=0;b[6]=a[4];b[7]=a[5];b[8]=1;return b};a.fromQuat=function(a,b){var e=a[0],x=a[1],k=a[2],B=a[3],r=e+e,w=x+x,f=k+k,e=e*r,q=x*r,x=x*w,g=k*r,z=
k*w,k=k*f,r=B*r,w=B*w,B=B*f;b[0]=1-x-k;b[3]=q-B;b[6]=g+w;b[1]=q+B;b[4]=1-e-k;b[7]=z-r;b[2]=g-w;b[5]=z+r;b[8]=1-e-x;return b};a.normalFromMat4=function(a,b){var e=a[0],x=a[1],k=a[2],B=a[3],r=a[4],w=a[5],f=a[6],q=a[7],g=a[8],z=a[9],A=a[10],J=a[11],l=a[12],F=a[13],G=a[14],D=a[15],H=e*w-x*r,I=e*f-k*r,d=e*q-B*r,h=x*f-k*w,v=x*q-B*w,M=k*q-B*f,c=g*F-z*l,p=g*G-A*l,g=g*D-J*l,R=z*G-A*F,z=z*D-J*F,A=A*D-J*G,J=H*A-I*z+d*R+h*g-v*p+M*c;if(!J)return null;J=1/J;b[0]=(w*A-f*z+q*R)*J;b[1]=(f*g-r*A-q*p)*J;b[2]=(r*z-w*
g+q*c)*J;b[3]=(k*z-x*A-B*R)*J;b[4]=(e*A-k*g+B*p)*J;b[5]=(x*g-e*z-B*c)*J;b[6]=(F*M-G*v+D*h)*J;b[7]=(G*d-l*M-D*I)*J;b[8]=(l*v-F*d+D*H)*J;return b};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.wO=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var l="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new l(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var b=new l(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.copy=function(a,b){b[0]=a[0];
b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,b){if(b===a){var e=a[1],x=a[2],k=a[3],B=a[6],r=a[7],w=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=e;b[6]=a[9];b[7]=a[13];b[8]=x;b[9]=B;b[11]=a[14];b[12]=k;b[13]=
r;b[14]=w}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};a.invert=function(a,b){var e=a[0],x=a[1],k=a[2],B=a[3],r=a[4],w=a[5],f=a[6],q=a[7],g=a[8],z=a[9],A=a[10],J=a[11],l=a[12],F=a[13],G=a[14],D=a[15],H=e*w-x*r,I=e*f-k*r,d=e*q-B*r,h=x*f-k*w,v=x*q-B*w,M=k*q-B*f,c=g*F-z*l,p=g*G-A*l,R=g*D-J*l,K=z*G-A*F,t=z*D-J*F,y=A*D-J*G,u=H*y-I*t+d*K+h*R-v*p+M*c;if(!u)return null;
u=1/u;b[0]=(w*y-f*t+q*K)*u;b[1]=(k*t-x*y-B*K)*u;b[2]=(F*M-G*v+D*h)*u;b[3]=(A*v-z*M-J*h)*u;b[4]=(f*R-r*y-q*p)*u;b[5]=(e*y-k*R+B*p)*u;b[6]=(G*d-l*M-D*I)*u;b[7]=(g*M-A*d+J*I)*u;b[8]=(r*t-w*R+q*c)*u;b[9]=(x*R-e*t-B*c)*u;b[10]=(l*v-F*d+D*H)*u;b[11]=(z*d-g*v-J*H)*u;b[12]=(w*p-r*K-f*c)*u;b[13]=(e*K-x*p+k*c)*u;b[14]=(F*I-l*h-G*H)*u;b[15]=(g*h-z*I+A*H)*u;return b};a.adjoint=function(a,b){var e=a[0],x=a[1],k=a[2],B=a[3],r=a[4],w=a[5],f=a[6],q=a[7],g=a[8],z=a[9],A=a[10],J=a[11],l=a[12],F=a[13],G=a[14],D=a[15];
b[0]=w*(A*D-J*G)-z*(f*D-q*G)+F*(f*J-q*A);b[1]=-(x*(A*D-J*G)-z*(k*D-B*G)+F*(k*J-B*A));b[2]=x*(f*D-q*G)-w*(k*D-B*G)+F*(k*q-B*f);b[3]=-(x*(f*J-q*A)-w*(k*J-B*A)+z*(k*q-B*f));b[4]=-(r*(A*D-J*G)-g*(f*D-q*G)+l*(f*J-q*A));b[5]=e*(A*D-J*G)-g*(k*D-B*G)+l*(k*J-B*A);b[6]=-(e*(f*D-q*G)-r*(k*D-B*G)+l*(k*q-B*f));b[7]=e*(f*J-q*A)-r*(k*J-B*A)+g*(k*q-B*f);b[8]=r*(z*D-J*F)-g*(w*D-q*F)+l*(w*J-q*z);b[9]=-(e*(z*D-J*F)-g*(x*D-B*F)+l*(x*J-B*z));b[10]=e*(w*D-q*F)-r*(x*D-B*F)+l*(x*q-B*w);b[11]=-(e*(w*J-q*z)-r*(x*J-B*z)+g*
(x*q-B*w));b[12]=-(r*(z*G-A*F)-g*(w*G-f*F)+l*(w*A-f*z));b[13]=e*(z*G-A*F)-g*(x*G-k*F)+l*(x*A-k*z);b[14]=-(e*(w*G-f*F)-r*(x*G-k*F)+l*(x*f-k*w));b[15]=e*(w*A-f*z)-r*(x*A-k*z)+g*(x*f-k*w);return b};a.determinant=function(a){var b=a[0],e=a[1],x=a[2],k=a[3],B=a[4],r=a[5],w=a[6],f=a[7],q=a[8],g=a[9],z=a[10],A=a[11],l=a[12],N=a[13],F=a[14];a=a[15];return(b*r-e*B)*(z*a-A*F)-(b*w-x*B)*(g*a-A*N)+(b*f-k*B)*(g*F-z*N)+(e*w-x*r)*(q*a-A*l)-(e*f-k*r)*(q*F-z*l)+(x*f-k*w)*(q*N-g*l)};a.multiply=function(a,b,e){var x=
a[0],k=a[1],B=a[2],r=a[3],w=a[4],f=a[5],q=a[6],g=a[7],z=a[8],A=a[9],l=a[10],N=a[11],F=a[12],G=a[13],D=a[14];a=a[15];var H=b[0],I=b[1],d=b[2],h=b[3];e[0]=H*x+I*w+d*z+h*F;e[1]=H*k+I*f+d*A+h*G;e[2]=H*B+I*q+d*l+h*D;e[3]=H*r+I*g+d*N+h*a;H=b[4];I=b[5];d=b[6];h=b[7];e[4]=H*x+I*w+d*z+h*F;e[5]=H*k+I*f+d*A+h*G;e[6]=H*B+I*q+d*l+h*D;e[7]=H*r+I*g+d*N+h*a;H=b[8];I=b[9];d=b[10];h=b[11];e[8]=H*x+I*w+d*z+h*F;e[9]=H*k+I*f+d*A+h*G;e[10]=H*B+I*q+d*l+h*D;e[11]=H*r+I*g+d*N+h*a;H=b[12];I=b[13];d=b[14];h=b[15];e[12]=H*x+
I*w+d*z+h*F;e[13]=H*k+I*f+d*A+h*G;e[14]=H*B+I*q+d*l+h*D;e[15]=H*r+I*g+d*N+h*a;return e};a.mul=a.multiply;a.translate=function(a,b,e){var x=b[0],k=b[1];b=b[2];var l,r,w,f,q,g,z,A,J,N,F,G;a===e?(e[12]=a[0]*x+a[4]*k+a[8]*b+a[12],e[13]=a[1]*x+a[5]*k+a[9]*b+a[13],e[14]=a[2]*x+a[6]*k+a[10]*b+a[14],e[15]=a[3]*x+a[7]*k+a[11]*b+a[15]):(l=a[0],r=a[1],w=a[2],f=a[3],q=a[4],g=a[5],z=a[6],A=a[7],J=a[8],N=a[9],F=a[10],G=a[11],e[0]=l,e[1]=r,e[2]=w,e[3]=f,e[4]=q,e[5]=g,e[6]=z,e[7]=A,e[8]=J,e[9]=N,e[10]=F,e[11]=G,
e[12]=l*x+q*k+J*b+a[12],e[13]=r*x+g*k+N*b+a[13],e[14]=w*x+z*k+F*b+a[14],e[15]=f*x+A*k+G*b+a[15]);return e};a.scale=function(a,b,e){var x=b[0],k=b[1];b=b[2];e[0]=a[0]*x;e[1]=a[1]*x;e[2]=a[2]*x;e[3]=a[3]*x;e[4]=a[4]*k;e[5]=a[5]*k;e[6]=a[6]*k;e[7]=a[7]*k;e[8]=a[8]*b;e[9]=a[9]*b;e[10]=a[10]*b;e[11]=a[11]*b;e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.rotate=function(a,b,e,x){var k=e[0],l=e[1];e=e[2];var r=Math.sqrt(k*k+l*l+e*e),w,f,q,g,z,A,J,N,F,G,D,H,I,d,h,v,M,c,p,R;if(1E-7>Math.abs(r))return null;
r=1/r;k*=r;l*=r;e*=r;w=Math.sin(b);f=Math.cos(b);q=1-f;b=a[0];r=a[1];g=a[2];z=a[3];A=a[4];J=a[5];N=a[6];F=a[7];G=a[8];D=a[9];H=a[10];I=a[11];d=k*k*q+f;h=l*k*q+e*w;v=e*k*q-l*w;M=k*l*q-e*w;c=l*l*q+f;p=e*l*q+k*w;R=k*e*q+l*w;k=l*e*q-k*w;l=e*e*q+f;x[0]=b*d+A*h+G*v;x[1]=r*d+J*h+D*v;x[2]=g*d+N*h+H*v;x[3]=z*d+F*h+I*v;x[4]=b*M+A*c+G*p;x[5]=r*M+J*c+D*p;x[6]=g*M+N*c+H*p;x[7]=z*M+F*c+I*p;x[8]=b*R+A*k+G*l;x[9]=r*R+J*k+D*l;x[10]=g*R+N*k+H*l;x[11]=z*R+F*k+I*l;a!==x&&(x[12]=a[12],x[13]=a[13],x[14]=a[14],x[15]=a[15]);
return x};a.rotateX=function(a,b,e){var x=Math.sin(b);b=Math.cos(b);var k=a[4],l=a[5],r=a[6],w=a[7],f=a[8],q=a[9],g=a[10],z=a[11];a!==e&&(e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);e[4]=k*b+f*x;e[5]=l*b+q*x;e[6]=r*b+g*x;e[7]=w*b+z*x;e[8]=f*b-k*x;e[9]=q*b-l*x;e[10]=g*b-r*x;e[11]=z*b-w*x;return e};a.rotateY=function(a,b,e){var x=Math.sin(b);b=Math.cos(b);var k=a[0],l=a[1],r=a[2],w=a[3],f=a[8],q=a[9],g=a[10],z=a[11];a!==e&&(e[4]=a[4],e[5]=a[5],e[6]=a[6],
e[7]=a[7],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);e[0]=k*b-f*x;e[1]=l*b-q*x;e[2]=r*b-g*x;e[3]=w*b-z*x;e[8]=k*x+f*b;e[9]=l*x+q*b;e[10]=r*x+g*b;e[11]=w*x+z*b;return e};a.rotateZ=function(a,b,e){var x=Math.sin(b);b=Math.cos(b);var k=a[0],l=a[1],r=a[2],w=a[3],f=a[4],q=a[5],g=a[6],z=a[7];a!==e&&(e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);e[0]=k*b+f*x;e[1]=l*b+q*x;e[2]=r*b+g*x;e[3]=w*b+z*x;e[4]=f*b-k*x;e[5]=q*b-l*x;e[6]=g*b-r*x;e[7]=z*b-w*x;return e};
a.zO=function(a,b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=a[0];b[13]=a[1];b[14]=a[2];b[15]=1;return b};a.yO=function(a,b){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a[1];b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=a[2];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.xO=function(a,b,e){var x=b[0],k=b[1];b=b[2];var l=Math.sqrt(x*x+k*k+b*b),r;if(1E-7>Math.abs(l))return null;l=1/l;x*=l;k*=l;b*=l;l=Math.sin(a);a=Math.cos(a);r=1-a;e[0]=x*x*r+a;e[1]=k*x*r+b*
l;e[2]=b*x*r-k*l;e[3]=0;e[4]=x*k*r-b*l;e[5]=k*k*r+a;e[6]=b*k*r+x*l;e[7]=0;e[8]=x*b*r+k*l;e[9]=k*b*r-x*l;e[10]=b*b*r+a;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.vY=function(a,b){var e=Math.sin(a),l=Math.cos(a);b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=l;b[6]=e;b[7]=0;b[8]=0;b[9]=-e;b[10]=l;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.wY=function(a,b){var e=Math.sin(a),l=Math.cos(a);b[0]=l;b[1]=0;b[2]=-e;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=e;b[9]=0;b[10]=l;b[11]=0;b[12]=0;b[13]=0;
b[14]=0;b[15]=1;return b};a.xY=function(a,b){var e=Math.sin(a),l=Math.cos(a);b[0]=l;b[1]=e;b[2]=0;b[3]=0;b[4]=-e;b[5]=l;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromRotationTranslation=function(a,b,e){var l=a[0],k=a[1],B=a[2],r=a[3],w=l+l,f=k+k,q=B+B;a=l*w;var g=l*f,l=l*q,z=k*f,k=k*q,B=B*q,w=r*w,f=r*f,r=r*q;e[0]=1-(z+B);e[1]=g+r;e[2]=l-f;e[3]=0;e[4]=g-r;e[5]=1-(a+B);e[6]=k+w;e[7]=0;e[8]=l+f;e[9]=k-w;e[10]=1-(a+z);e[11]=0;e[12]=b[0];e[13]=b[1];e[14]=b[2];
e[15]=1;return e};a.tY=function(a,b,e,l){var k=a[0],B=a[1],r=a[2],w=a[3],f=k+k,q=B+B,g=r+r;a=k*f;var z=k*q,k=k*g,A=B*q,B=B*g,r=r*g,f=w*f,q=w*q,w=w*g,g=e[0],J=e[1];e=e[2];l[0]=(1-(A+r))*g;l[1]=(z+w)*g;l[2]=(k-q)*g;l[3]=0;l[4]=(z-w)*J;l[5]=(1-(a+r))*J;l[6]=(B+f)*J;l[7]=0;l[8]=(k+q)*e;l[9]=(B-f)*e;l[10]=(1-(a+A))*e;l[11]=0;l[12]=b[0];l[13]=b[1];l[14]=b[2];l[15]=1;return l};a.uY=function(a,b,e,l,k){var B=a[0],r=a[1],w=a[2],f=a[3],q=B+B,g=r+r,z=w+w;a=B*q;var A=B*g,B=B*z,J=r*g,r=r*z,w=w*z,q=f*q,g=f*g,f=
f*z,z=e[0],N=e[1];e=e[2];var F=l[0],G=l[1];l=l[2];k[0]=(1-(J+w))*z;k[1]=(A+f)*z;k[2]=(B-g)*z;k[3]=0;k[4]=(A-f)*N;k[5]=(1-(a+w))*N;k[6]=(r+q)*N;k[7]=0;k[8]=(B+g)*e;k[9]=(r-q)*e;k[10]=(1-(a+J))*e;k[11]=0;k[12]=b[0]+F-(k[0]*F+k[4]*G+k[8]*l);k[13]=b[1]+G-(k[1]*F+k[5]*G+k[9]*l);k[14]=b[2]+l-(k[2]*F+k[6]*G+k[10]*l);k[15]=1;return k};a.fromQuat=function(a,b){var e=a[0],l=a[1],k=a[2],B=a[3],r=e+e,w=l+l,f=k+k,e=e*r,q=l*r,l=l*w,g=k*r,z=k*w,k=k*f,r=B*r,w=B*w,B=B*f;b[0]=1-l-k;b[1]=q+B;b[2]=g-w;b[3]=0;b[4]=q-
B;b[5]=1-e-k;b[6]=z+r;b[7]=0;b[8]=g+w;b[9]=z-r;b[10]=1-e-l;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.frustum=function(a,b,e,l,k,B,r){var w=1/(b-a),f=1/(l-e),q=1/(k-B);r[0]=2*k*w;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=2*k*f;r[6]=0;r[7]=0;r[8]=(b+a)*w;r[9]=(l+e)*f;r[10]=(B+k)*q;r[11]=-1;r[12]=0;r[13]=0;r[14]=B*k*2*q;r[15]=0;return r};a.perspective=function(a,b,e,l,k){a=1/Math.tan(a/2);var B=1/(e-l);k[0]=a/b;k[1]=0;k[2]=0;k[3]=0;k[4]=0;k[5]=a;k[6]=0;k[7]=0;k[8]=0;k[9]=0;k[10]=(l+e)*B;k[11]=-1;k[12]=
0;k[13]=0;k[14]=2*l*e*B;k[15]=0;return k};a.r0=function(a,b,e,l){var k=Math.tan(a.upDegrees*Math.PI/180),B=Math.tan(a.downDegrees*Math.PI/180),r=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var w=2/(r+a),f=2/(k+B);l[0]=w;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=f;l[6]=0;l[7]=0;l[8]=-((r-a)*w*.5);l[9]=(k-B)*f*.5;l[10]=e/(b-e);l[11]=-1;l[12]=0;l[13]=0;l[14]=e*b/(b-e);l[15]=0;return l};a.ortho=function(a,b,e,l,k,B,r){var w=1/(a-b),f=1/(e-l),q=1/(k-B);r[0]=-2*w;r[1]=0;r[2]=0;r[3]=
0;r[4]=0;r[5]=-2*f;r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=2*q;r[11]=0;r[12]=(a+b)*w;r[13]=(l+e)*f;r[14]=(B+k)*q;r[15]=1;return r};a.lookAt=function(m,b,e,l){var k,B,r,w,f,q,g,z,A=m[0],J=m[1];m=m[2];r=e[0];w=e[1];B=e[2];g=b[0];e=b[1];k=b[2];if(1E-7>Math.abs(A-g)&&1E-7>Math.abs(J-e)&&1E-7>Math.abs(m-k))return a.identity(l);b=A-g;e=J-e;g=m-k;z=1/Math.sqrt(b*b+e*e+g*g);b*=z;e*=z;g*=z;k=w*g-B*e;B=B*b-r*g;r=r*e-w*b;(z=Math.sqrt(k*k+B*B+r*r))?(z=1/z,k*=z,B*=z,r*=z):r=B=k=0;w=e*r-g*B;f=g*k-b*r;q=b*B-e*k;(z=Math.sqrt(w*
w+f*f+q*q))?(z=1/z,w*=z,f*=z,q*=z):q=f=w=0;l[0]=k;l[1]=w;l[2]=b;l[3]=0;l[4]=B;l[5]=f;l[6]=e;l[7]=0;l[8]=r;l[9]=q;l[10]=g;l[11]=0;l[12]=-(k*A+B*J+r*m);l[13]=-(w*A+f*J+q*m);l[14]=-(b*A+e*J+g*m);l[15]=1;return l};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.wO=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__math=function(a,l){function m(a,b){for(var e=a[1],f=1,k=2;k<a.length;k++)4!=k&&8!=k&&Math.abs(a[k])>Math.abs(e)&&(e=a[k],f=k);for(var m=Math.floor(f/3),f=f%3,e=.5*Math.atan(2*e/(a[3*m+m]-a[3*f+f])),k=0;k<b.length;k++)b[k]=0==k||4==k||8==k?1:0;b[f+3*m]=-Math.sin(e);b[m+3*f]=Math.sin(e);b[m+3*m]=Math.cos(e);b[f+3*f]=Math.cos(e);return b}function b(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}var e=l("__vec3"),x=l("__mat3"),k=new Float32Array(3),B=new Float32Array(9),r=new Float32Array(9),
w=new Float32Array(9),f=new Float32Array(9);a.CZ=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];return b};a.DZ=function(a,b){b=b||new Float32Array(3);return e.copy(a,b)};a.XG=function(a,b){e.copy(b,a)};a.Hy=function(a,b){e.normalize(b,k);a[3]=k[0];a[4]=k[1];a[5]=k[2]};a.VW=function(a,b,e){e=e||new Float32Array(3);e[0]=a[0]+a[3]*b;e[1]=a[1]+a[4]*b;e[2]=a[2]+a[5]*b};a.$L=function(a,b){for(var f=0;f<a.length;f+=3)b[0]+=a[f],b[1]+=a[f+1],b[2]+=a[f+2];return e.scale(b,3/a.length,
b)};a.UL=function(a,b,e){for(var f=0;f<e.length;f++)e[f]=0;for(f=0;f<a.length;f+=3){var k=a[f]-b[0],m=a[f+1]-b[1],r=a[f+2]-b[2];e[0]+=k*k;e[1]+=k*m;e[2]+=k*r;e[4]+=m*m;e[5]+=m*r;e[8]+=r*r}e[3]=e[1];e[6]=e[2];e[7]=e[5];for(f=0;f<e.length;f++)e[f]*=3/a.length;return e};a.nO=function(a,e){var k=x.copy(a,B);if(5E-4>b(k))return x.identity(e);var A=m(k,r),l=x.transpose(A,w);x.multiply(k,l,f);x.multiply(A,f,k);for(var N=x.copy(A,e),F=1;5E-4<=b(k)&&100>F;)A=m(k,r),l=x.transpose(A,w),x.multiply(k,l,f),x.multiply(A,
f,k),x.multiply(A,N,N),F++;return N};a.df=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}};b4w.module.__obj_util=function(a,l){function m(a){if(!(a instanceof Object))return a;var b=null,e=null,k=null,A=null;a.fa&&(b=a.fa,a.fa=null);a.Sc&&(e=a.Sc,a.Sc=null);a.Oa&&(k=a.Oa,a.Oa=null);a.rb&&(A=a.rb,a.rb=null);var r;r=a.constructor;switch(r){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:r=new r(a);break;case Array:r=new r(a.length);for(var l=0;l<a.length;l++)r[l]=m(a[l]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:r=
a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:r=null;break;case Function:r=a;break;default:for(l in r=new r,a)r[l]=m(a[l])}b&&(r.fa=b,a.fa=b);e&&(r.Sc=e,a.Sc=e);k&&(r.Oa=k,a.Oa=k);A&&(r.rb=A,a.rb=A);return r}function b(a,b){for(var e=a.A,k=0;k<e.length;k++){var m=e[k];if(m.Ta==b)return m}return null}function e(a){return a.li?a.parent:a.parent?e(a.parent):null}var x=l("__tsr"),k=l("__util"),B=l("__vec3"),r=l("__vec4"),w=l("__config").v;new Float32Array(4);new Float32Array(4);new Float32Array(4);
x.create();x.create();a.Pk=function(a){a={id:0,type:a,Ad:0,i:x.$f(),Nz:x.$f(),QI:x.$f(),pivot:new Float32Array(3),wb:new Float32Array(3),ll:0,ml:0,HE:!1,IE:!1,vq:null,lh:0,$s:!1,hf:B.create(),use_panning:!1,lb:0,lp:1,kp:1,mp:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,je:null,yT:!1,$a:null,va:null,fb:null,Lc:null,Kc:null,cf:null,Ln:!0,Ll:{Ml:1,Nl:1,Ol:0},Qe:null,se:null,kc:new Float32Array(4),Tn:0,In:0,uo:0,xl:0,Sk:!1,ye:!1,Qd:!1,Pd:!1,rd:!1,fd:!1,Md:!1,qg:"",Jg:!1,Ie:!1,Mq:!1,ag:!1,Jc:!1,
mj:!1,zj:!1,Gr:!1,qi:!1,Zr:!1,ic:!1,Yr:!1,QF:!1,Ar:!1,Er:!1,tw:!1,op:0,Ag:0,Dh:0,Qg:0,Pg:0,Ig:0,dh:"",ad:null,iq:!1,rf:!1,ev:!1,Xm:"",Wm:!1,Ue:0,time:0,Az:0,tI:0,eh:0,Sn:!1,Gc:!1,Qf:!1,ui:[],ql:!1,Yi:!1,Jh:1,Qu:0,Pu:1,it:new Int8Array([-1,-1]),Rs:[],qF:[],lH:[],Kd:null,te:null,Td:null,Ee:null,Oe:null,Ik:null,Ux:null,Xu:null,Wu:null,Gk:null,R:null,bv:null,$u:null,av:null,Pe:null,Ha:null,ei:1E4};B.copy(k.wc,a.hf);return a};a.tn=function(a,b,e){e||(e=a);return{name:a,Gi:k.xw(),Tj:e,type:b,dj:!1,Ea:!1,
mo:!1,hp:!1,g:null,zb:null,P:null,$b:null,dq:null,anchor:null,Yk:null,Or:null,A:[],Gc:[],zd:[],Ev:[],W:[],Lo:[],af:[],zk:[],Lf:null,ck:[],parent:null,li:!1,Bo:"",st:null,ls:null,kk:!1,pb:"",zq:"AUTO",Ed:!1,Ze:!1,Gj:!1,r:null,n:null,Se:null,Vd:null,Zk:null,KB:null,Sx:[],If:{hs:"NO_COLLISION",ip:!1,sI:!1,kg:0,wI:0,vI:0,Wv:0,py:0,rQ:!1,sQ:!1,tQ:!1,uQ:!1,vQ:!1,wQ:!1,mn:0,kn:0,nn:0,xz:!1,uq:"BOX",gp:!1},PF:{at:0,Nx:0,re:0,ey:0},Xi:0,pf:[],Dx:!1,AF:!1,rF:[]}};a.Fv=function(a){return a instanceof Array?
a.slice():a};a.KM=function(a){for(var b=[],e=0;e<a.length;e++){var k=a[e],A={},r;for(r in k)k[r]==k.I?A.I=m(k.I):k[r]==k.na?A.na=m(k.na):A[r]=k[r];b.push(A)}return b};a.Lk=m;a.Ea=function(a){return a.Ea};a.ko=function(a){return"MESH"==a.type&&a.Ea};a.Tm=function(a,b){a.A.push({Ta:b,yr:!1,X:[],og:[],Ng:null,Oy:[],Ij:0,LF:!1,U:[],kH:[]})};a.aq=function(a,e,g){b(a,e).X.push(g)};a.E0=function(a,b){for(var e=a.A,k=0;k<e.length;k++)if(e[k].Ta==b){e.splice(k,1);break}};a.aa=b;a.lI=function(a,b){for(var e=
0;e<a.length;e++)r.copy(b,a[e].g.kc)};a.qy=function(a,b,e){for(var k=0;k<a.A.length;k++){var m=a.A[k];e&&m.Ta!=e||(m.yr=b)}};a.fr=function(a,b){for(var e=[],k=b?w.oF-1:w.oF,m=0;m<a.length;m++){var r=a[m];r.$b.jD&&e.length<k&&e.push(r)}return e.length?e:a[0]?[a[0]]:[]};a.OB=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var e=b.material-1,k=a.data.materials;if(0<=e&&e<k.length&&("ADD"==k[e].game_settings.alpha_blend||"ALPHA"==k[e].game_settings.alpha_blend||"ALPHA_SORT"==
k[e].game_settings.alpha_blend))return!0}return!1};a.sM=function(a){a=a.A;for(var b=0;b<a.length;b++)for(var e=a[b].X,k=0;k<e.length;k++)for(var m=e[k].Tb.Rg,r=0;r<m.length;r++){var l=m[r];if("USE_ZUP_MODEL_MATRIX_INVERSE"==l[0]&&"1"==l[1])return!0}return!1};a.fD=function(a,b){return a+"*"+b};a.dr=function(a){return a.li?null:a.parent};a.xf=e;a.Gw=function(a,b){for(var g=[],k=0;k<b.length;k++){var m=b[k];e(m)==a&&g.push(m)}return g};a.Kw=function(a){return a.g.Ad};a.hc=function(a){return"MESH"===
a.type};a.$g=function(a){return"ARMATURE"===a.type};a.Hj=function(a){return"SPEAKER"===a.type};a.ka=function(a){return"CAMERA"===a.type};a.nl=function(a){return"LAMP"===a.type};a.Ej=function(a){return"EMPTY"===a.type};a.ME=function(a){return"LINE"===a.type};a.qo=function(a){return"WORLD"===a.type}};b4w.module.__particles=function(a,l){function m(){q.l("_rand() undefined")}function b(a,b,e,g,k,d){var h=a.Kq,v=a.wf,q=a.time;a=a.cG;for(var c=0;c<h.length;c+=4){var p=h[c];if(q>a&&q>=p&&p>a||q<a&&(p>a||q>=p))for(p=0;8>p;p++)v[8*c+p]=g[p],A[p]=g[p];else for(p=0;8>p;p++)A[p]=v[8*c+p];p=J;p[0]=b[3*c];p[1]=b[3*c+1];p[2]=b[3*c+2];f.Fc(p,A,p);k[3*c]=p[0];k[3*c+1]=p[1];k[3*c+2]=p[2];var m=J;m[0]=e[3*c];m[1]=e[3*c+1];m[2]=e[3*c+2];f.Tc(m,A,m);d[3*c]=m[0];d[3*c+1]=m[1];d[3*c+2]=m[2];for(p=1;4>p;p++)k[3*(c+
p)]=k[3*c],k[3*(c+p)+1]=k[3*c+1],k[3*(c+p)+2]=k[3*c+2],d[3*(c+p)]=m[0],d[3*(c+p)+1]=m[1],d[3*(c+p)+2]=m[2]}}function e(a){a?(q.ZS(a),m=function(){return q.sR()}):m=function(){return Math.random()}}var x=l("__config"),k=l("__batch"),B=l("__geometry"),r=l("__textures"),w=l("__time"),f=l("__tsr"),q=l("__util"),g=l("__vec3"),z=x.v,A=new Float32Array(8),J=new Float32Array(3),N=[];a.update=function(){for(var a=0;a<N.length;a++)for(var e=N[a],f=e.A,g=0;g<f.length;g++)for(var k=e,d=f[g].X,h=0;h<d.length;h++){var v=
d[h],q=v.Qa;q&&q.ot&&!v.eg&&(b(q,q.Ql,q.HF,k.g.i,q.Vx,q.Ix),q.OQ=!0)}};a.Lx=function(a){a=a.A;for(var b=0;b<a.length;b++)for(var e=a[b].X,f=0;f<e.length;f++)if(e[f].Qa)return!0;return!1};a.KF=function(a){a=a.A;for(var b=0;b<a.length;b++)for(var e=a[b].X,f=0;f<e.length;f++){var g=e[f].Qa;if(g&&"EMITTER"==g.$r)return!0}return!1};a.QL=function(a){return 0<a.particle_systems.length};a.PL=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;
return!1};a.xP=function(a){for(var b=0;b<a.particle_systems.length;b++){var e=a.particle_systems[b].settings;if("HAIR"==e.type&&e.b4w_dynamic_grass)return!0}return!1};a.JP=function(a,b,e){var f=a.Qa={name:b.name,$r:b.settings.type,time:0,cG:-1,ot:!1,pa:0,La:0,PH:0,lx:0,cF:0,nd:!1,kg:0,Ex:0,kE:0,pj:0,ke:0,MI:0,size:0,eB:0,dB:0,ZB:0,YB:new Float32Array(16),Ql:null,Vx:null,HF:null,Ix:null,Kq:null,aw:null,wf:null,SF:null,NH:0,OH:0};f.pa=b.settings.frame_start;f.La=b.settings.frame_end;f.PH=(f.La-f.pa)/
w.Ec();f.lx=b.settings.lifetime;f.cF=f.lx/w.Ec();f.nd=b.settings.b4w_cyclic?1:0;f.kg=b.settings.mass;f.Ex=b.settings.normal_factor;f.kE=9.81*b.settings.effector_weights.gravity;f.pj=b.settings.b4w_fade_in/w.Ec();f.ke=b.settings.b4w_fade_out/w.Ec();f.MI=b.settings.effector_weights.wind;f.ot="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var g,d,h;a.Sw?(g=e.halo.size,d=e.halo.hardness,30>d?(d=.5,h=.9):40>d?(d=.1,h=1):50>d?(d=0,h=.8):(d=0,h=.5)):(g=b.settings.particle_size,h=d=1);f.size=g;f.eB=d;f.dB=
h;e.use_nodes&&"BILLBOARD"==b.settings.render_type&&(k.Od(a,"NODES",1),k.Od(a,"PARTICLE_BATCH",1),a.K2=!0,a.eo=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&z.Yp&&(g=[],r.TL(b[0].texture.color_ramp,r.AA,g),g=new Uint8Array(g.map(function(a){return q.S(255*a,0,255)})),k.jL(a,g,r.AA),k.Od(a,"USE_COLOR_RAMP",1));e=e.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(e[0]&&"STRAND"==e[0].texture_coords&&e[0].texture&&
"BLEND"==e[0].texture.type&&e[0].texture.use_color_ramp){e=e[0].texture.color_ramp.elements;b=Math.min(4*e.length,a.length);for(g=0;g<b;g+=4)d=e[g/4],a[g]=d.position,a[g+1]=d.color[0],a[g+2]=d.color[1],a[g+3]=d.color[2];f.ZB=e.length}f.YB.set(a)};a.FO=function(a,f,k,z){var A=a.Qa,d=z.i,h=k.settings.count,v=k.settings.frame_start/w.Ec(),r=k.settings.frame_end/w.Ec(),c=k.settings.lifetime/w.Ec(),p=k.settings.lifetime_random,l=k.settings.emit_from,K=k.settings.factor_random;if(k.settings.use_rotations)var t=
k.settings.angular_velocity_mode,y=k.settings.angular_velocity_factor;else t="NONE",y=0;var u=k.settings.b4w_randomize_emission,C=k.settings.b4w_cyclic;A.NH=k.settings.billboard_tilt;A.OH=k.settings.billboard_tilt_random;e(k.seed);var L;f=B.OC(f,["a_position","a_normal"],null,z);switch(l){case "VERT":var n=f.N[0].a_position;L=f.N[0].a_normal;f=n.length/3;l=[];for(k=0;k<h;k++)z=Math.round((f-1)*m()),l.push(z),l.push(z),l.push(z),l.push(z);f=[];for(k=0;k<l.length;k++)f.push(n[3*l[k]]),f.push(n[3*l[k]+
1]),f.push(n[3*l[k]+2]);n=new Float32Array(f);f=[];for(k=0;k<l.length;k++)f.push(L[3*l[k]]),f.push(L[3*l[k]+1]),f.push(L[3*l[k]+2]);L=new Float32Array(f);break;case "FACE":n=[];L=[];k=[];q.vr(0,k);l=B.zw(f,h,!1,k);q.vr(0,k);f=B.zw(f,h,!0,k);for(k=0;k<l.length;k++)n.push(l[k][0],l[k][1],l[k][2]),n.push(l[k][0],l[k][1],l[k][2]),n.push(l[k][0],l[k][1],l[k][2]),n.push(l[k][0],l[k][1],l[k][2]),L.push(f[k][0],f[k][1],f[k][2]),L.push(f[k][0],f[k][1],f[k][2]),L.push(f[k][0],f[k][1],f[k][2]),L.push(f[k][0],
f[k][1],f[k][2]);n=new Float32Array(n);L=new Float32Array(L);break;case "VOLUME":q.l("Particle emission from volume is not supported");break;default:q.l("Wrong emit from option")}L=[n,L];n=L[0];L=L[1];A.Ql=new Float32Array(n);A.HF=new Float32Array(L);A.Vx=new Float32Array(n.length);A.Ix=new Float32Array(L.length);l=[];r=(r-v)/h;for(f=0;f<h;f++)k=u?r*f+10*r*(.5-m()):r*f,C||(k+=v),l.push(k),l.push(k),l.push(k),l.push(k);v=new Float32Array(l);A.Kq=new Float32Array(v);A.aw=new Float32Array(v);if(A.ot){A.wf=
new Float32Array(8*v.length);for(u=0;u<8*v.length;u++)for(C=0;8>C;C++)A.wf[8*u+C]=d[C];b(A,n,L,d,n,L)}d=q.Cc("EMITTER_PARTICLES");u=q.sf();u.a_position=n;u.a_normal=L;d.N[0]=u;a.Sh=B.wp;a=[];for(u=0;u<h;u++)a.push(4*u,4*u+2,4*u+1,4*u,4*u+3,4*u+2);a=new Uint16Array(a);d.ab=a;a=d.ba;u=[];for(C=0;C<h;C++)u.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);u=new Float32Array(u);a.a_p_bb_vertex=u;d.wa=n.length/3;a=[];p*=c;for(u=0;u<h;u++)C=p*m(),a.push(c-C),a.push(c-C),a.push(c-C),a.push(c-C);c=d.ba;p=[];for(u=0;u<h;u++)C=
Math.random(),p.push(a[4*u],v[4*u],C),p.push(a[4*u+1],v[4*u+1],C),p.push(a[4*u+2],v[4*u+2],C),p.push(a[4*u+3],v[4*u+3],C);p=new Float32Array(p);c.a_p_data=p;c=d.ba;p=[];for(a=0;a<h;a++){v=[m()-.5,m()-.5,m()-.5];g.normalize(v,v);p.push(K*v[0]);p.push(K*v[1]);p.push(K*v[2]);switch(t){case "NONE":p.push(0);break;case "SPIN":case "VELOCITY":p.push(y);break;case "RAND":p.push(2*y*(m()-.5));break;default:q.l("Undefined velocity factor")}v=p.slice(-4);for(u=0;12>u;u++)p.push(v[u%4])}h=new Float32Array(p);
c.a_p_vels=h;A.SF=new Float32Array(d.ba.a_p_data);return d};a.tS=function(a,b,e){a=a.A;for(var f=0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d].Qa;h&&h.name==b&&!g[d].eg&&(h.cG=h.time,h.time=e)}};a.lR=function(a){for(var b=a.wa,e=a.N[0].a_position,f=a.ba.a_texcoord,g=[],d=[],h=0;h<b;h++)d.push(e[3*h]),d.push(e[3*h+1]),g.push(e[3*h+2]);g=new Float32Array(g);d=new Float32Array(d);a.ba.a_lf_dist=g;a.ba.a_lf_bb_vertex=d;a.ba.a_texcoord=f;return a};a.C1=function(a,b,e){a=a.A;for(var f=
0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d].Qa;h&&h.name==b&&(h.size=e)}};a.n1=function(a,b,e){a=a.A;for(var f=0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d].Qa;h&&h.name==b&&(h.Ex=e)}};a.$0=function(a,b,e){a=a.A;for(var f=0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d],k=h.Qa;if(k&&k.name==b){var q=k.Kq;if(1==e)var c=q;else if(0==e)for(var c=k.aw,p=0;p<c.length;p+=4)c[p]=1E4,c[p+1]=c[p],c[p+2]=c[p],c[p+3]=c[p];else for(var m=4/e,c=k.aw,K=0,
p=0;p<c.length;p+=4)p>=K?(c[p]=q[p],K+=m):c[p]=1E4,c[p+1]=c[p],c[p+2]=c[p],c[p+3]=c[p];h=h.oa;if(h.ed.a_p_data){k=k.SF;for(p=0;p<k.length;p+=3)k[p+1]=c[Math.round(p/3)];B.IT(h,k)}}}};a.cU=function(a,b,e){a=a.A;for(var f=0;f<a.length;f++)for(var g=a[f].X,d=0;d<g.length;d++){var h=g[d].Qa;if(h&&h.ot)for(var k=0;k<8*h.Kq.length;k++)h.wf[8*k]=b[0],h.wf[8*k+1]=b[1],h.wf[8*k+2]=b[2],h.wf[8*k+3]=b[3],h.wf[8*k+4]=e[0],h.wf[8*k+5]=e[1],h.wf[8*k+6]=e[2],h.wf[8*k+7]=e[3]}};a.WT=function(a,b,e){if(b.ds){for(var f=
[],g=0;g<e;g++)f.push(1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1);a.ba.a_tangent=new Float32Array(f)}if(b.Ox){f=[];for(g=0;g<e;g++)f.push(g,g,g,g);a.ba[b.Ox.name]=new Float32Array(f)}};a.VT=function(a){-1==N.indexOf(a)&&N.push(a)};a.xR=function(a){a=N.indexOf(a);-1!=a&&N.splice(a,1)};a.ha=function(){N.length=0}};b4w.module.__batch=function(a,l){function m(a){a={type:a,sb:"",id:0,hy:0,jn:-1,Kl:"",yC:-1,Iq:-1,Zv:0,tf:0,Qk:[],fa:[],Sc:[],Df:[],pn:[],mk:null,Hc:{},rb:null,Tb:{zm:null,al:null,Rg:[],Pj:[]},Gl:"",eq:[],q0:null,oa:null,Qf:!1,jj:!1,AC:!1,Kx:0,wo:0,RE:0,SE:0,jE:0,Pw:0,Cd:new Float32Array(3),fe:new Float32Array(16),Wi:!1,eb:!1,GM:!1,Ka:!1,Eh:!1,Db:!1,Fe:!1,ag:!1,ye:!1,Pd:!1,Qd:!1,rd:!1,fd:!1,Md:!1,Jc:!1,eG:!1,Sh:E.Em,Tf:!1,qv:!1,eg:!1,qR:"",K1:"",mE:!1,qE:0,nE:0,rE:0,sE:0,pE:new Float32Array(3),oE:new Float32Array(3),
Sw:!1,Ak:0,Wk:0,Bn:1,ss:0,Vs:0,Wy:1,bs:0,An:0,Qm:1,GF:0,xx:0,Sj:0,tG:0,ie:Array(2),cm:new Float32Array(3),Bi:new Float32Array(3),Yo:new Float32Array(3),uf:new Float32Array(4),sj:new Float32Array(4),ul:null,ix:null,gx:null,fx:null,hx:null,eo:!1,pk:!1,water_dynamic:!1,Gz:!1,II:!1,JI:0,KI:0,HI:0,tt:.1,Ms:0,Qs:0,Vq:0,TC:new Float32Array(2),SC:new Float32Array(2),qw:new Float32Array(2),Ls:new Float32Array(3),Ps:new Float32Array(3),Rj:null,Mo:!1,Qa:null,dF:0,ds:!1,Ox:null,Qj:null,Il:null,CF:null,qe:null,
Hl:null,DF:null,R:null,Ha:null,I:null,na:null};a.uf[3]=1;a.GM=!0;a.Ka=!0;a.dF=1;return a}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.sb=a.eb?a.Eh?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.sb=a.Pd?"CAST":"RECEIVE";break;case "COLOR_ID":a.sb=a.Eh?"COLOR_ID_XRAY":"COLOR_ID"}}function e(a){var c=a.oa;a.oa=null;var d=X.Lk(a);a.oa=c;d.oa=c;return d}function x(a,c){for(var d=[],b=0;b<a.length;b++){var n=a[b],e=n.ya.g,h=ea.bc();ea.yq(e.Gk,h);var f=n.data.b4w_bounding_cylinder_radius,
y=n.data.b4w_bounding_sphere_radius,C=n.data.b4w_bounding_sphere_center,g=n.data.b4w_bounding_ellipsoid_axes,u=n.data.b4w_bounding_ellipsoid_center;if(e.rf){var f=Math.max(Math.abs(h.max_x),Math.abs(h.min_x)),y=Math.max(Math.abs(h.max_y),Math.abs(h.min_y)),L=Math.max(Math.abs(h.max_z),Math.abs(h.min_z)),L=Math.sqrt(f*f+y*y+L*L),f=Math.sqrt(f*f+y*y);h.max_x=h.max_y=h.max_z=L;h.min_x=h.min_y=h.min_z=-L;y=L;C[0]=C[1]=C[2]=0;g[0]=g[1]=g[2]=L;u[0]=u[1]=u[2]=0}e.R=h;L=ea.Hg(h,e.i);e.I=L;r(e,f,f,h);h=ea.Bq(y,
C);e.Pe=h;h=ea.iv(h,e.i);e.Yc=h;g=ea.rn([g[0],0,0],[0,g[1],0],[0,0,g[2]],u);e.Ha=g;g=ea.Jk(g,e.i);e.na=g;d=d.concat(B(n,e,c))}return d}function k(a,d){for(var b=[],e=[],h={},f=0;f<a.length;f++){var y=a[f],C=y.ya.g,g=ea.bc();ea.yq(C.Gk,g);var u=ea.Hg(g,C.i),p=ea.Bq(y.data.b4w_bounding_sphere_radius,y.data.b4w_bounding_sphere_center),k=ea.iv(p,C.i),v=y.data.b4w_bounding_ellipsoid_axes,v=ea.rn([v[0],0,0],[0,v[1],0],[0,0,v[2]],y.data.b4w_bounding_ellipsoid_center),t=ea.Jk(v,C.i);C.R=g;C.I=u;C.Pe=p;C.Yc=
k;C.Ha=v;C.na=t;g={};g.ye=C.ye;g.Pd=C.Pd;g.Qd=C.Qd;g.qi=C.qi;g.Zr=C.Zr;g.ic=C.ic;g.Yr=C.Yr;g.Ll=C.Ll;g.rd=C.rd;g.fd=C.fd;g.Md=C.Md;g.Qe=C.Qe;g.se=C.se;g.qg=C.qg;g.Jg=C.Jg;g.Ie=C.Ie;g.dh=C.dh;g.ad=C.ad;g.rf=C.rf;g.Xm=C.Xm;g.Wm=C.Wm;g.Jc=C.Jc;g.mj=C.mj;g.Mq=C.Mq;g.ag=C.ag;g.jn=y.b4w_cluster_data.cluster_id;g.ei=C.ei;g.uo=C.uo;g.xl=C.xl;g.Sk=C.Sk;C=JSON.stringify(g);h[C]=h[C]||[];h[C].push(y)}for(var Ma in h){g=JSON.parse(Ma);delete g.jn;var y=h[Ma],C=X.Pk("STATIC"),T;for(T in g)C[T]=g[T];C.Ad=a[0].ya.g.Ad;
C.Ag=0;C.Dh=0;C.Qg=0;C.Pg=0;C.Ig=0;C.zj=!1;for(f=0;f<y.length;f++)g=y[f].ya,0==f?(C.I=U.ia(g.g.I),C.Yc=U.ia(g.g.Yc)):(ea.Nn(C.I,g.g.I),ea.dO(C.Yc,g.g.Yc));C.na=ea.kf();C.Ha=ea.kf();C.R=U.ia(C.I);C.Pe=U.ia(C.Yc);e.push({g:C,RL:y})}for(h=0;h<e.length;h++)for(f=e[h].g,Ma=e[h].RL,T=0;T<Ma.length;T++){y=Ma[T];C=y.ya.g;g=B(y,f,d);u=sa.create();C.rf&&!C.ev?sa.ff(sa.q(C.i),u):sa.copy(C.i,u);p={};if(f.Ie||f.rf)p.au_center_pos=[u[0],u[1],u[2]];f.Ie&&(p.au_wind_bending_amp=[C.Ag],p.au_wind_bending_freq=[y.b4w_wind_bending_freq],
p.au_detail_bending_amp=[y.b4w_detail_bending_amp],p.au_detail_bending_freq=[y.b4w_detail_bending_freq],p.au_branch_bending_amp=[y.b4w_branch_bending_amp]);for(k=0;k<g.length;k++){var S=g[k].g,v=g[k].Ae,t=g[k].G;S.Ar?S.rf?E.cT(v,u):E.bz(v,u):("COLOR_ID"==t.type&&(g[k].g=C,t.Kl=y.uuid,c(t,C),S=n(C),L(t,S)),v=E.bz(v,u),E.bT(v,p))}b=b.concat(g)}return b}function B(a,d,b){var e=[],h=w(b,d,!d.Sk,!1),y=n(d),g=a.data,p=g.materials,k=Array(p.length),v=Array(p.length),Ma=Ba.Ob(b,"MAIN_OPAQUE"),T=!1;Ma&&(T=
Ma.Ir.length?!0:!1);for(var S=0;S<h.length;S++)for(var K=h[S],q=0;q<p.length;q++){var O=p[q];if((!O.b4w_lens_flares||T)&&!E.wE(g,q)){var z=m(K);"COLOR_ID"==K&&(z.qv=!(a.b4w_do_not_render||O.b4w_do_not_render));"MAIN"==K?k[q]=z:"DEBUG_VIEW"==K&&(v[q]=z);z.jn=a.b4w_cluster_data.cluster_id;if(C(z,O)){"SHADOW"==K&&k[q]&&(z.Fe=k[q].Fe);z.Sh=d.Qf||d.ag?E.wp:E.Em;c(z,d);for(var A=z,l=a.particle_systems,r=0;r<l.length;r++){var V=l[r].settings.b4w_vcol_from_name,Ga=l[r].settings.b4w_vcol_to_name;""!==V&&""!==
Ga&&(A.Hc[V]={vj:!1,src:[{name:V,$e:7}]})}"DYNAMIC"==d.type&&(z.Kl=a.uuid);L(z,y);var aa=E.NC(g,q,z.pn,d.Ik,z.Hc,z.mk),M=aa.kd;M.I=ea.Hg(M.R,a.ya.g.i);M.na=ea.Jk(M.Ha,a.ya.g.i);O.b4w_lens_flares&&(aa=Ca.lR(aa));e.push({G:z,Ae:aa,Hd:[O.name],g:d,ue:[a]})}}}for(S=0;S<v.length;S++)v[S]&&(v[S].Iq=k[S].id,L(v[S],v[S].hy));var R=a.particle_systems;if(0<R.length&&e.length){for(var Ka=!1,ra=!1,S=0;S<R.length;S++){var H=R[S],B=H.settings;B.use_render_emitter&&(Ka=!0);"HAIR"!=B.type||"OBJECT"!=B.render_type&&
"GROUP"!=B.render_type&&H.transforms.length||(ra=!0);if(Ka&&ra)break}var x=e[0].G.Hc,Q;if(ra){var I;if(1<p.length){for(var D=a.ya.g,J={},Da=0;Da<R.length;Da++){var mb=R[Da].settings;if("HAIR"==mb.type&&("OBJECT"==mb.render_type||"GROUP"==mb.render_type)){var Ra=mb.b4w_vcol_from_name,Ia=mb.b4w_vcol_to_name;""!==Ra&&""!==Ia&&(J[Ra]=U.ia(x[Ra]))}}"a_bending_col_main"in x&&(J.a_bending_col_main=U.ia(x.a_bending_col_main));"a_bending_col_detail"in x&&(J.a_bending_col_detail=U.ia(x.a_bending_col_detail));
I=E.OC(g,[],J,D)}else I=e[0].Ae;Q=I}else Q=null;for(var G,F=Q,Y=a.ya,ga=[],ib=a.particle_systems,N=a.data,fa=0;fa<ib.length;fa++){var Ea=ib[fa],ha=Ea.settings;if(ha.count)if("EMITTER"==ha.type){if("DYNAMIC"==d.type){var W=m("PARTICLES");W.R=d.R;W.Ha=d.Ha;W.I=d.I;W.na=d.na;var ba,ia=N.materials,la=Ea.settings.material-1;la>=ia.length&&(va.warn('Wrong material used for rendering particle system "'+Ea.name+'"'),la=0);ba=ia[la];"HALO"===Ea.settings.render_type&&"HALO"===ba.type&&(W.Sw=!0);f(W,ba);var ka=
W,P=a,ja=Ea.settings;switch(ja.b4w_billboard_align){case "VIEW":t(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":t(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":t(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":t(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:U.l("Wrong billboard align value")}t(ka,"BILLBOARD",0);var ua=ja.b4w_enable_soft_particles&&X.OB(P,ja);t(ka,"SOFT_PARTICLES",0<ja.b4w_particles_softness&&ua&&ca.Lq?1:0);t(ka,"SOFT_STRENGTH",ta.H(ja.b4w_particles_softness));
ta.V(ka.Tb,"WORLD_SPACE","WORLD"==ja.b4w_coordinate_system?1:0);W.ag=!0;W.Kl=Y.name+"_"+ha.uuid;W.qR=Ea.name;L(W,y);Ca.JP(W,Ea,ba);var pa=Ca.FO(W,N,Ea,Y.g);Ca.WT(pa,W,ha.count);Ca.VT(Y);c(W,Y.g);ga.push({G:W,Ae:pa,Hd:[ba.name],g:d,ue:[a]})}}else if("HAIR"==ha.type){var xa=U.vr(Ea.seed);ha.b4w_dynamic_grass&&(d.mj=!0);var ma=Z.PB(ca.qx)&&!ha.b4w_initial_rand_rotation&&!ha.b4w_hair_billboard,Aa=4;ma&&(Aa=8);if(Ea.transforms.length)var za=Ea.transforms;else for(var Ja=E.zw(F,ha.count,!1,xa),za=new Float32Array(Ja.length*
Aa),gb=0;gb<Ja.length;gb++){var rd=.75+.5*U.ef(xa);za[gb*Aa]=Ja[gb][0];za[gb*Aa+1]=Ja[gb][1];za[gb*Aa+2]=Ja[gb][2];za[gb*Aa+3]=rd;ma&&(za[gb*Aa+4]=1,za[gb*Aa+5]=0,za[gb*Aa+6]=0,za[gb*Aa+7]=0)}var vb=Ba.Ob(b,"GRASS_MAP")?!0:!1;if("OBJECT"==ha.render_type)var Hb=[w(b,ha.dupli_object.ya.g,!d.Sk,!0)],oc=u(a,d,x,F,[ha.dupli_object],Hb,[za],ha,Ea,vb,xa,!1),ga=ga.concat(oc);else if("GROUP"==ha.render_type){for(var Ua=ha.dupli_group.objects,Hb=[],gb=0;gb<Ua.length;gb++){var yb=w(b,Ua[gb].ya.g,!d.Sk,!0);Hb.push(yb)}for(var Ib=
!1,zb=[],gb=0;gb<Ua.length;gb++)zb.push(Ua[gb].ya);if(ha.use_whole_group){for(var Jb,Kb=za,pc=zb,Zb=ma,qc=Aa,nb={},pb=new Float32Array([0,0,0,1]),La=0;La<Kb.length;La+=qc)for(var cb=0;cb<pc.length;cb++){var ic=da.create();da.scale(sa.q(pc[cb].g.i),sa.Pc(pc[cb].g.i),ic);var hb=da.clone([Kb[La],Kb[La+1],Kb[La+2]]);nb[cb]||(nb[cb]=new Float32Array(Kb.length));Zb&&(nb[cb][La+4]=pb[0]=Kb[La+4],nb[cb][La+5]=pb[1]=Kb[La+5],nb[cb][La+6]=pb[2]=Kb[La+6],nb[cb][La+7]=pb[3]=Kb[La+7],U.Yx(pb,pb),U.uT(ic,pb,ic));
da.add(hb,ic,hb);nb[cb][La]=hb[0];nb[cb][La+1]=hb[1];nb[cb][La+2]=hb[2];nb[cb][La+3]=Kb[La+3]}Jb=nb;Ib=!0}else{var wc;if(ha.use_group_count){for(var Ab=za,Va=zb,Tb=ha.dupli_weights,fc=xa,Gc=ma,ob=Aa,$a={},$b=[],ya=0;ya<Va.length;ya++)for(var Nb=Va[ya],db=Nb.Tj||Nb.name,gc=0;gc<Tb.length;gc++){var Na=Tb[gc];db==Na.name&&$b.push(Na)}Tb.length!=$b.length&&va.error("dupli weights match failed");for(ya=0;ya<Ab.length;ya+=ob){for(var kb,Bb=$b,ac=[0],Pa=0;Pa<Bb.length;Pa++)ac[Pa+1]=ac[Pa]+Bb[Pa].count;for(var Xa=
ac[ac.length-1]*U.ef(fc),wb=0,Pa=0;Pa<ac.length;Pa++)if(Xa>=ac[Pa]&&Xa<ac[Pa+1]){wb=Pa;break}kb=wb;$a[kb]=$a[kb]||[];$a[kb].push(Ab[ya],Ab[ya+1],Ab[ya+2],Ab[ya+3]);Gc&&$a[kb].push(Ab[ya+4],Ab[ya+5],Ab[ya+6],Ab[ya+7])}for(kb in $a)$a[kb]=new Float32Array($a[kb]);wc=$a}else{for(var Ya=za,rc=xa,Ub=ma,ab=Aa,bb=zb.length,lb={},qb=0;qb<Ya.length;qb+=ab){var Cb=Math.floor(bb*U.ef(rc));lb[Cb]=lb[Cb]||[];lb[Cb].push(Ya[qb],Ya[qb+1],Ya[qb+2],Ya[qb+3]);Ub&&lb[Cb].push(Ya[qb+4],Ya[qb+5],Ya[qb+6],Ya[qb+7])}for(Cb in lb)lb[Cb]=
new Float32Array(lb[Cb]);wc=lb}Jb=wc}oc=u(a,d,x,F,Ua,Hb,Jb,ha,Ea,vb,xa,Ib);ga=ga.concat(oc)}"INSTANCE"==ha.b4w_wind_bend_inheritance&&Y.g.Ie&&va.warn('Emitter object "'+Y.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else U.l("Unknown particle settings type")}G=ga;e=Ka?e.concat(G):G}return e}function r(a,c,d,b){a.bv=ea.fC(c,b);a.$u=ea.dC(d,b);a.av=ea.eC(c,b)}function w(a,c,d,b){var n=
[];b||(c.qi&&Ba.Ob(a,"COLOR_PICKING")||c.ic&&Ba.Ob(a,"OUTLINE_MASK"))&&n.push("COLOR_ID");d&&(n.push("MAIN"),n.push("NODES_GLOW"),Ba.Ob(a,"DEBUG_VIEW")&&n.push("DEBUG_VIEW"),Ba.Ob(a,"SHADOW_RECEIVE")&&n.push("SHADOW"),Ba.Ob(a,"GRASS_MAP")&&n.push("GRASS_MAP"));n.push("PHYSICS");if(c.Pd||c.fd)for(a=null,c.Pd&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),c.fd&&(c=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?U.tL(a,c):c),c=a,a=0;a<c.length;a++)d=n.indexOf(c[a]),-1!==d&&n.splice(d,
1);return n}function f(a,c){var d;switch(a.type){case "MAIN":if(c.b4w_do_not_render)d=!1;else{if(c.use_nodes&&"HALO"!=c.type)G(a,c,"MAIN");else{z(a,c);d=c.game_settings.alpha_blend;a.Eh=c.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.Sj=c.offset_z;a.Bi.set([1,1,1]);var b=c.texture_slots;P.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf);if(c.b4w_lens_flares){O(a,"special_lens_flares.glslv","special_lens_flares.glslf");K(a,"a_position");K(a,"a_texcoord");var n=ua.Dc(b[0],
null);V(a,n)}else{O(a,"main.glslv","main_stack.glslf");c.use_shadeless||(d=S.Lv(c.uuid,c.name,{Fe:c.use_shadeless,Cn:c.diffuse_shader,dm:c.specular_shader}),a.Tb.Pj=S.wq(d));var e=A("use_map_color_diffuse",b),h=A("use_map_color_spec",b),f=A("use_map_normal",b),C=A("use_map_mirror",b),y=A("use_stencil",b);d=e[0];h=h[0];f=f[0];C=C[0];e=e[1];b=y[0]&&A("use_rgb_to_intensity",b)[0];if(d){switch(d.blend_type){case "MIX":t(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":t(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}n=ua.Dc(d,null);V(a,n,"u_colormap0");a.An=d.diffuse_color_factor;a.Qm=d.use_map_alpha?d.alpha_factor:0;a.Bi.set(d.scale)}y=d&&d==h;h&&(y||(n=ua.Dc(h,null),V(a,n,"u_specmap0")),a.Vs=h.specular_color_factor);if(f&&(K(a,"a_normal"),K(a,"a_tangent"),a.ds=!0,n=ua.Dc(f,null),V(a,n,"u_normalmap0"),a.GF=f.normal_factor,n=f.texture,n.b4w_use_map_parallax&&ca.as)){var u=ta.H(n.b4w_parallax_steps),L=ta.H(n.b4w_parallax_lod_dist);t(a,"PARALLAX",1);t(a,"PARALLAX_STEPS",u);t(a,"PARALLAX_LOD_DIST",
L);a.bs=n.b4w_parallax_scale}C&&(n=ua.Dc(C,null),V(a,n,"u_mirrormap"),a.xx=C.mirror_factor);if(C=d&&e&&b?1:0)n=ua.Dc(e,null),V(a,n,"u_colormap1"),n=ua.Dc(b,null),V(a,n,"u_stencil0");(n=d||h||f)&&a.Bi.set(n.scale);t(a,"TEXTURE_SPEC",void 0==h?0:1);t(a,"ALPHA_AS_SPEC",y?1:0);t(a,"TEXTURE_STENCIL_ALPHA_MASK",C);K(a,"a_position");K(a,"a_normal");(d||h||f)&&K(a,"a_texcoord");if(c.b4w_water){a.pk=!0;a.water_dynamic=c.b4w_water_dynamic;c.b4w_water_shore_smoothing&&!a.eb?(va.warn('Material: "'+c.name+'" is opaque.',
"Disabling shore smoothing."),a.Gz=!1):a.Gz=c.b4w_water_shore_smoothing;O(a,"special_water.glslv","special_water.glslf");C=S.Lv(c.uuid,c.name,{Fe:!1,Cn:c.diffuse_shader,dm:c.specular_shader});a.Tb.Pj=S.wq(C);K(a,"a_position");ca.LI?(K(a,"a_polyindex"),a.Ka=!0,a.wireframe_edge_color=[0,0,0],ga.ZD()?t(a,"DEBUG_WIREFRAME",1):t(a,"DEBUG_WIREFRAME",2)):t(a,"DEBUG_WIREFRAME",0);y=c.texture_slots;C=A("use_map_normal",y);n=A("use_map_mirror",y)[0];C.length&&(u=ua.Dc(C[0]),V(a,u,"u_normalmap0"),a.tt=c.b4w_water_norm_uv_velocity);
t(a,"NUM_NORMALMAPS",C.length);a.Rj=Array(C.length);for(u=0;u<C.length;u++)a.Rj[u]=new Float32Array(2),a.Rj[u].set([C[u].scale[0],C[u].scale[1]]);n&&(u=ua.Dc(n),V(a,u,"u_mirrormap"),a.xx=n.mirror_factor);n=null;if(ca.Qn)for(u=0;u<y.length;u++){var p=y[u];if(!0===p.texture.b4w_water_foam){n=p;break}}n?(t(a,"FOAM",1),u=ua.Dc(n),V(a,u,"u_foam"),a.Vq=c.b4w_foam_factor,a.TC.set(n.texture.b4w_foam_uv_freq),a.SC.set(n.texture.b4w_foam_uv_magnitude),a.qw[0]=n.scale[0],a.qw[1]=n.scale[1]):t(a,"FOAM",0);for(u=
0;u<y.length;u++)if(p=y[u],!0===p.texture.b4w_shore_dist_map){var k=p;break}k&&ca.Yp?(k=ua.Dc(k),V(a,k,"u_shore_dist_map"),t(a,"SHORE_PARAMS",1),k=p.texture.b4w_shore_boundings,t(a,"MAX_SHORE_DIST",ta.H(p.texture.b4w_max_shore_dist)),t(a,"SHORE_MAP_SIZE_X",ta.H(k[0]-k[1])),t(a,"SHORE_MAP_SIZE_Y",ta.H(k[2]-k[3])),t(a,"SHORE_MAP_CENTER_X",ta.H((k[0]+k[1])/2)),t(a,"SHORE_MAP_CENTER_Y",ta.H((k[2]+k[3])/2))):t(a,"SHORE_PARAMS",0);if(c.b4w_generated_mesh)t(a,"GENERATED_MESH",1),a.II=!0,a.JI=c.b4w_water_num_cascads,
a.KI=c.b4w_water_subdivs,a.HI=c.b4w_water_detailed_dist;else{K(a,"a_normal");if(n||C.length)K(a,"a_texcoord"),K(a,"a_tangent"),a.ds=!0;t(a,"GENERATED_MESH",0)}if(c.b4w_water_dynamic){var p=ta.H(c.b4w_water_dst_noise_scale0),k=ta.H(c.b4w_water_dst_noise_scale1),C=ta.H(c.b4w_water_dst_noise_freq0),y=ta.H(c.b4w_water_dst_noise_freq1),n=ta.H(c.b4w_water_dir_min_shore_fac),u=ta.H(c.b4w_water_dir_freq),L=ta.H(c.b4w_water_dir_noise_scale),v=ta.H(c.b4w_water_dir_noise_freq),Ma=ta.H(c.b4w_water_dir_min_noise_fac),
T=ta.H(c.b4w_water_dst_min_fac),m=ta.H(c.b4w_water_waves_hor_fac);t(a,"DST_NOISE_SCALE_0",p);t(a,"DST_NOISE_SCALE_1",k);t(a,"DST_NOISE_FREQ_0",C);t(a,"DST_NOISE_FREQ_1",y);t(a,"DIR_MIN_SHR_FAC",n);t(a,"DIR_FREQ",u);t(a,"DIR_NOISE_SCALE",L);t(a,"DIR_NOISE_FREQ",v);t(a,"DIR_MIN_NOISE_FAC",Ma);t(a,"DST_MIN_FAC",T);t(a,"WAVES_HOR_FAC",m)}N(a,c);F(a,c);a.Ls.set(c.b4w_shallow_water_col);a.Ps.set(c.b4w_shore_water_col);a.Ms=c.b4w_shallow_water_col_fac;a.Qs=c.b4w_shore_water_col_fac;t(a,"ABSORB",ta.H(c.b4w_water_absorb_factor));
t(a,"SSS_STRENGTH",ta.H(c.b4w_water_sss_strength));t(a,"SSS_WIDTH",ta.H(c.b4w_water_sss_width))}"HALO"===c.type&&(O(a,"halo.glslv","halo.glslf"),q(a,c),a.pn=["a_position"]);t(a,"TEXCOORD",0);t(a,"NORMAL_TEXCOORD",0);d&&g(a,d,"TEXTURE_COLOR0_CO");e&&g(a,e,"TEXTURE_COLOR1_CO");b&&g(a,b,"TEXTURE_STENCIL_ALPHA_MASK_CO");h&&g(a,h,"TEXTURE_SPEC_CO");f&&g(a,f,"TEXTURE_NORM_CO");t(a,"SHADELESS",c.use_shadeless?1:0);a.Fe=c.use_shadeless}d=c.game_settings.alpha_blend;t(a,"ALPHA","OPAQUE"===d?0:1);t(a,"ALPHA_CLIP",
"CLIP"===d?1:0);t(a,"DOUBLE_SIDED_LIGHTING",c.b4w_double_sided_lighting?1:0);c.use_vertex_color_paint?(t(a,"VERTEX_COLOR",1),K(a,"a_color")):t(a,"VERTEX_COLOR",0);a.Ak=c.ambient;a.Bn=c.diffuse_intensity;a.Wk=c.emit;a.Yo.set(c.specular_color);a.Wy=c.specular_alpha;N(a,c);F(a,c);c.b4w_wettable?t(a,"WETTABLE",1):t(a,"WETTABLE",0);J(a,c);c.b4w_refractive&&!a.eb?(va.warn('Material "'+c.name+'" is not blend. Disabling refractions.'),a.Mo=!1):a.Mo=c.b4w_refractive;a.tG=c.b4w_refr_bump}d=!0}break;case "NODES_GLOW":d=
G(a,c,"GLOW");break;case "SHADOW":if(c.b4w_lens_flares||c.b4w_water||c.b4w_do_not_render||"HALO"===c.type)d=!1;else if(z(a,c),a.eb)d=!1;else{h=c.game_settings.alpha_blend;c.use_nodes&&"CLIP"==h?G(a,c,"SHADOW"):(O(a,"shadow.glslv","shadow.glslf"),P.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf));K(a,"a_position");K(a,"a_normal");t(a,"ALPHA","OPAQUE"===h?0:1);a.Bi.set([1,1,1]);if((d=A("use_map_color_diffuse",c.texture_slots)[0])&&"CLIP"===h){switch(d.blend_type){case "MIX":t(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":t(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Bi.set(d.scale);t(a,"TEXTURE_COLOR",1);K(a,"a_texcoord");if("IMAGE"==d.texture.j.source||"ENVIRONMENT_MAP"==d.texture.j.source||"CANVAS"==d.texture.j.source)h=ua.Dc(d),V(a,h,"u_colormap0");"NONE"==d.texture.j.source&&(h=ua.Dc(d),V(a,h,"u_colormap0"))}else t(a,"TEXTURE_COLOR",0);d=!0}break;case "PHYSICS":c.b4w_collision?(a.ip=c.b4w_use_ghost,a.pb=c.b4w_collision_id,a.mn=c.b4w_collision_margin,
a.kn=c.b4w_collision_group,a.nn=c.b4w_collision_mask,a.Tn=c.physics.friction,a.In=c.physics.elasticity,d=!0):c.b4w_water?(a.pk=!0,a.GU=c.b4w_water_dynamic,a.dst_noise_scale0=c.b4w_water_dst_noise_scale0,a.dst_noise_scale1=c.b4w_water_dst_noise_scale1,a.dst_noise_freq0=c.b4w_water_dst_noise_freq0,a.dst_noise_freq1=c.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=c.b4w_water_dir_min_shore_fac,a.dir_freq=c.b4w_water_dir_freq,a.dir_noise_scale=c.b4w_water_dir_noise_scale,a.dir_noise_freq=c.b4w_water_dir_noise_freq,
a.dir_min_noise_fac=c.b4w_water_dir_min_noise_fac,a.dst_min_fac=c.b4w_water_dst_min_fac,a.waves_hor_fac=c.b4w_water_waves_hor_fac,d=!0):d=!1;break;case "COLOR_ID":if(c.b4w_lens_flares||"HALO"===c.type)d=!1;else{z(a,c);a.Tf=!1;a.Ka=!0;a.eb=!1;h=c.game_settings.alpha_blend;a.Eh=c.b4w_render_above_all&&"OPAQUE"!=h&&"CLIP"!=h;c.use_nodes&&"CLIP"==h?G(a,c,"COLOR_ID"):(O(a,"color_id.glslv","color_id.glslf"),P.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf));K(a,"a_position");
t(a,"ALPHA","OPAQUE"===h?0:1);a.Bi.set([1,1,1]);if((d=A("use_map_color_diffuse",c.texture_slots)[0])&&"CLIP"===h){switch(d.blend_type){case "MIX":t(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":t(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Bi.set(d.scale);t(a,"TEXTURE_COLOR",1);K(a,"a_texcoord");if("IMAGE"==d.texture.j.source||"ENVIRONMENT_MAP"==d.texture.j.source)h=ua.Dc(d),V(a,h,"u_colormap0");"NONE"==d.texture.j.source&&(h=ua.Dc(d),V(a,h,"u_colormap0"))}else t(a,
"TEXTURE_COLOR",0);d=!0}break;case "GRASS_MAP":!c.b4w_terrain||c.b4w_do_not_render?d=!1:(z(a,c),a.eb=!1,a.Tf=!1,a.Ka=!0,O(a,"grass_map.glslv","grass_map.glslf"),K(a,"a_position"),d=c.b4w_dynamic_grass_size?c.b4w_dynamic_grass_size:null,h=c.b4w_dynamic_grass_color?c.b4w_dynamic_grass_color:null,a.Hc.a_grass_size={vj:!0,src:[]},d?(a.Hc.a_grass_size.src.push({name:d,$e:4}),t(a,"DYNAMIC_GRASS_SIZE",1)):t(a,"DYNAMIC_GRASS_SIZE",0),a.Hc.a_grass_color={vj:!0,src:[]},h?(a.Hc.a_grass_color.src.push({name:h,
$e:7}),t(a,"DYNAMIC_GRASS_COLOR",1)):t(a,"DYNAMIC_GRASS_COLOR",0),d=!0);break;case "DEBUG_VIEW":d=M(a,c);break;case "PARTICLES":a:if(c.b4w_do_not_render)d=!1;else{d=c.texture_slots;if(a.Sw)O(a,"particle_system.glslv","particle_system_stack.glslf"),t(a,"HALO_PARTICLES",1),q(a,c);else{h={Fe:!1,Cn:c.diffuse_shader,dm:c.specular_shader};if(c.use_nodes){O(a,"particle_system.glslv","particle_system.glslf");G(a,c,"PARTICLES");d=!0;break a}O(a,"particle_system.glslv","particle_system_stack.glslf");h=S.Lv(c.uuid,
c.name,h);a.Tb.Pj=S.wq(h);if(d=A("use_map_color_diffuse",d)[0]){t(a,"TEXTURE_COLOR",1);switch(d.blend_type){case "MIX":t(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":t(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.An=d.diffuse_color_factor;a.Qm=d.use_map_alpha?d.alpha_factor:0;d=ua.Dc(d);V(a,d)}}P.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf);a.Ak=c.ambient;a.Bn=c.diffuse_intensity;a.Wk=c.emit;a.Yo.set(c.specular_color);a.Wy=c.specular_alpha;
K(a,"a_position");K(a,"a_normal");d=c.game_settings.alpha_blend;t(a,"ALPHA","OPAQUE"===d?0:1);t(a,"ALPHA_CLIP","CLIP"===d?1:0);t(a,"PARTICLES_SHADELESS",c.use_shadeless?1:0);N(a,c);F(a,c);z(a,c);d=c.game_settings.alpha_blend;a.Eh=c.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.Sj=c.offset_z;d=!0}break;default:U.l("Wrong batch type: "+a.type)}return d}function q(a,c){var d=c.halo;t(a,"NUM_RINGS",d.ring_count);t(a,"NUM_LINES",d.line_count);t(a,"NUM_STARS",d.star_tip_count);t(a,"SKY_STARS",c.b4w_halo_sky_stars?
1:0);a.qE=d.size;a.nE=d.hardness/20;a.pE.set(d.b4w_halo_rings_color);a.oE.set(d.b4w_halo_lines_color);a.rE=1/c.b4w_halo_stars_blend_height;a.sE=c.b4w_halo_stars_min_height;a.mE=!0}function g(a,c,d){switch(c.texture_coords){case "UV":case "ORCO":t(a,d,"TEXTURE_COORDS_UV_ORCO");t(a,"TEXCOORD",1);break;case "NORMAL":t(a,d,"TEXTURE_COORDS_NORMAL");t(a,"NORMAL_TEXCOORD",1);break;default:t(a,d,0)}}function z(a,c){var d=c.game_settings,b=d.alpha_blend;switch(b){case "ALPHA_SORT":a.eb=!0;a.Tf=!0;a.Ka=!0;
a.Wi=!1;break;case "ALPHA":a.eb=!0;a.Tf=!1;a.Ka=!0;a.Wi=!1;break;case "CLIP":a.eb=!1;a.Tf=!1;a.Ka=!0;a.Wi=!0;break;case "ADD":a.eb=!0;a.Tf=!1;a.Ka=!1;a.Wi=!1;break;case "OPAQUE":a.eb=!1;a.Tf=!1;a.Ka=!0;a.Wi=!1;break;default:U.l("Unknown alpha blend mode: "+b)}a.Db=d.use_backface_culling}function A(a,c){for(var d=[],b=c.length,n=0;n<b;n++){var e=c[n];1==e[a]&&e.texture&&e.texture.j&&d.push(e)}return d}function J(a,c){var d=c.raytrace_transparency;a.sj[0]=d.fresnel;a.sj[1]=1-d.fresnel_factor/5;d=c.raytrace_mirror;
a.ss=d.reflect_factor;a.sj[2]=d.fresnel;a.sj[3]=1-d.fresnel_factor/5}function N(a,c){var d,b=0;switch(c.specular_shader){case "PHONG":case "COOKTORR":d=c.specular_hardness;break;case "WARDISO":d=c.specular_slope;break;case "TOON":d=c.specular_toon_size;b=c.specular_toon_smooth;break;case "BLINN":d=c.specular_ior;b=c.specular_hardness;break;default:va.error("unsupported specular shader: "+c.specular_shader+' (material "'+c.name+'")'),d=c.specular_hardness}a.cm[0]=c.specular_intensity;a.cm[1]=d;a.cm[2]=
b}function F(a,c){switch(c.diffuse_shader){case "LAMBERT":a.ie[0]=0;a.ie[1]=0;break;case "OREN_NAYAR":a.ie[0]=c.roughness;a.ie[1]=0;break;case "FRESNEL":a.ie[0]=c.diffuse_fresnel;a.ie[1]=c.diffuse_fresnel_factor;break;case "MINNAERT":a.ie[0]=c.darkness;a.ie[1]=0;break;case "TOON":a.ie[0]=c.diffuse_toon_size;a.ie[1]=c.diffuse_toon_smooth;break;default:va.error("unsupported diffuse shader: "+c.diffuse_shader+' (material "'+c.name+'")'),a.ie[0]=0,a.ie[1]=0}}function G(a,c,d){if(!c.use_nodes||c.b4w_do_not_render)return!1;
var b;switch(d){case "MAIN":O(a,"main.glslv","main.glslf");b=!1;break;case "GLOW":O(a,"main.glslv","main.glslf");b=!0;break;case "SHADOW":O(a,"shadow.glslv","shadow.glslf");b=!1;break;case "COLOR_ID":O(a,"color_id.glslv","color_id.glslf"),b=!1}var n=c.node_tree;d=S.IM(n,c.uuid,!1,c.name,d);if(!d.Pa)return va.error('Failed to create node graph for material "'+c.name+'", disable nodes'),v(a,c),!0;a.Gl=d.id;a.eo=!0;t(a,"NODES",1);t(a,"DOUBLE_SIDED_LIGHTING",c.b4w_double_sided_lighting?1:0);K(a,"a_position");
c.use_orco_tex_coord&&K(a,"a_orco_tex_coord");z(a,c);a.Sj=c.offset_z;var e=c.game_settings.alpha_blend;b?(t(a,"ALPHA",1),t(a,"ALPHA_CLIP",0)):(t(a,"ALPHA","OPAQUE"===e?0:1),t(a,"ALPHA_CLIP","CLIP"===e?1:0));a.Eh=c.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;P.set(c.diffuse_color[0],c.diffuse_color[1],c.diffuse_color[2],c.alpha,a.uf);a.Wk=c.emit;a.Ak=c.ambient;J(a,c);c.b4w_wettable?t(a,"WETTABLE",1):t(a,"WETTABLE",0);var h=null,f=!1;ka.ma(d.Pa,function(d,b){switch(b.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var n=
b.data.name,e=b.data.value;a.mk||(a.mk={});a.mk[e]=n;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":n=b.data.name;a.Hc[n]={vj:!0,src:[{name:b.data.value}]};e=0;if("GEOMETRY_VC"==b.type)e=7;else for(var C=0;C<b.Sa.length;C++){var y="RGB".indexOf(b.Sa[C].identifier);-1<y&&(e|=1<<2-y)}a.Hc[n].src[0].$e=e;break;case "TEX_COORD_NO":case "GEOMETRY_NO":K(a,"a_normal");break;case "MATERIAL_BEGIN":K(a,"a_normal");f=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":n=
b.data.name;e=b.data.value;if(!e.j){va.warn('Wrong texture "'+b.data.value.name+'" in material "'+c.name+'".');v(a,c);break}!1!==e.j.Xp&&(e.j.Xp="TEXTURE_ENVIRONMENT"!=b.type?!0:!1);V(a,e.j,n);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":t(a,"CALC_TBN_SPACE",1);K(a,"a_normal");K(a,"a_tangent");a.ds=!0;n=b.data.name;e=b.data.value;e.j.Xp=!1;V(a,e.j,n);break;case "LAMP":b.data&&(a.ul=b.data);break;case "B4W_REFRACTION":a.eb?a.Mo=!0:(a.Mo=!0,va.warn('Material "'+c.name+'" is not blend. Disabling refractions.'));
break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":h||(h=b.data.Ja);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&b.data&&(a.Ox=b.data);break;case "VECT_TRANSFORM":switch(Number(b.Nb[1][1])){case S.IK:t(a,"USE_ZUP_MODEL_MATRIX_INVERSE",1);break;case S.HK:t(a,"USE_ZUP_VIEW_MATRIX",1);break;case S.GK:t(a,"USE_ZUP_MODEL_MATRIX",1);break;case S.FK:t(a,"USE_ZUP_MODEL_MATRIX",1);t(a,"USE_ZUP_VIEW_MATRIX",1);break;case S.EK:t(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1);break;case S.DK:t(a,"USE_ZUP_MODEL_MATRIX_INVERSE",
1),t(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1)}break;case "B4W_VECTOR_VIEW":t(a,"USE_ZUP_VIEW_MATRIX",1);break;case "B4W_REFLECT":t(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1)}});h&&V(a,h,"u_nodes_texture");f||(a.Fe=!0);b=a.Tb.Pj=S.wq(d.Pa);D(n,a,c.name);n=a.Il;d=a.Hl;for(e=0;e<b.length;e++){var C=b[e];switch(C.id){case "VALUE":var y=C.cs[0];if(y)for(var g=0;g<n.length;g+=2)if(n[g]==y){C.Nb.push(["VALUE_IND",n[g+1]]);break}break;case "RGB":if(y=C.cs[0])for(g=0;g<d.length;g+=2)if(d[g]==y){C.Nb.push(["RGB_IND",d[g+
1]]);break}}}t(a,"NUM_VALUES",a.Qj.length);t(a,"NUM_RGBS",a.qe.length);return!0}function D(a,c,d){var b=[],n=[],e=[],h=[],f=[],C=[];H(a,d,a.animation_data,b,n,e,h,f,C);c.Qj=b;c.Il=n;c.CF=e;c.qe=h;c.Hl=f;c.DF=C}function H(a,c,b,n,e,h,f,C,y){for(var g=0;g<a.nodes.length;g++){var u=a.nodes[g];if("VALUE"==u.type){var L=d(c,u.name);n.push(u.outputs[0].default_value);e.push(L,e.length/2)}else"RGB"==u.type?(L=d(c,u.name),u=u.outputs[0].default_value.slice(0,3),f.push(u[0],u[1],u[2]),C.push(L,C.length/2)):
"GROUP"==u.type&&(L=u.node_group.node_tree,H(L,d(c,u.name),L.animation_data,n,e,h,f,C,y))}if(b)for((a=b.action)&&a.j.type==xa.Lp&&I(a,c,h,e,y,C),b=b.nla_tracks,n=0;n<b.length;n++)for(f=b[n].strips,g=0;g<b[n].strips.length;g++)(a=f[g].action)&&a.j.type==xa.Lp&&I(a,c,h,e,y,C)}function I(a,c,b,n,e,f){var C=a.j.Fa,y;for(y in C){var g=d(c,y.match(/"(.*?)"/)[1]),C=h(n,g);null!=C?(g=d(a.name,y),b.push(g,C)):(C=h(f,g),null!=C&&(g=d(a.name,y),e.push(g,C)))}}function d(a,c){return a+"%join%"+c}function h(a,
c){for(var d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null}function v(a,c){switch(a.type){case "SHADOW":O(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":O(a,"color_id.glslv","color_id.glslf");break;default:O(a,"main.glslv","main_stack.glslf")}t(a,"SHADELESS",1);K(a,"a_position");K(a,"a_normal");P.set(1,0,1,1,a.uf);if(c){var d=c.game_settings.alpha_blend;t(a,"ALPHA","OPAQUE"===d?0:1);t(a,"ALPHA_CLIP","CLIP"===d?1:0);t(a,"VERTEX_COLOR",0);a.Sj=c.offset_z;z(a,c)}return!0}function M(a,
c){if(c&&(c.b4w_lens_flares||c.b4w_do_not_render))return!1;O(a,"debug_view.glslv","debug_view.glslf");K(a,"a_position");K(a,"a_normal");K(a,"a_polyindex");a.Ka=!0;a.wireframe_edge_color=[0,0,0];return!0}function c(a,c){if("PHYSICS"!==a.type){"DYNAMIC"==c.type?(c.Ar?t(a,"AU_QUALIFIER","attribute"):t(a,"AU_QUALIFIER","uniform"),t(a,"STATIC_BATCH",0)):(t(a,"AU_QUALIFIER","attribute"),t(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(ga.ZD()?t(a,"WIREFRAME_QUALITY",1):t(a,"WIREFRAME_QUALITY",0),a.jj?(t(a,
"DEBUG_SPHERE",1),a.AC?t(a,"DEBUG_SPHERE_DYNAMIC",1):t(a,"DEBUG_SPHERE_DYNAMIC",0)):t(a,"DEBUG_SPHERE",0),t(a,"ALPHA",1));c.Qf&&(a.Qf=c.Qf);c.Ie?(""!==c.dh?(a.Hc.a_bending_col_main={vj:!0,src:[{name:c.dh,$e:4}]},K(a,"a_bending_col_main"),""!==c.ad.aF&&""!==c.ad.$E&&""!==c.ad.RF?(a.Hc.a_bending_col_detail={vj:!0,src:[{name:c.ad.aF,$e:4},{name:c.ad.$E,$e:2},{name:c.ad.RF,$e:1}]},K(a,"a_bending_col_detail"),K(a,"a_normal"),t(a,"DETAIL_BEND",1)):t(a,"DETAIL_BEND",0),t(a,"MAIN_BEND_COL",1)):t(a,"MAIN_BEND_COL",
0),t(a,"WIND_BEND",1)):t(a,"WIND_BEND",0);c.iq?t(a,"BEND_CENTER_ONLY",1):t(a,"BEND_CENTER_ONLY",0);t(a,"BILLBOARD_PRES_GLOB_ORIENTATION",c.ev|0);c.rf?t(a,"BILLBOARD",1):t(a,"BILLBOARD",0);c.rf&&c.Ar?t(a,"HAIR_BILLBOARD",1):t(a,"HAIR_BILLBOARD",0);c.Wm?t(a,"BILLBOARD_SPHERICAL",1):t(a,"BILLBOARD_SPHERICAL",0);switch(c.Xm){case "RANDOM":t(a,"BILLBOARD_RANDOM",1);t(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":t(a,"BILLBOARD_RANDOM",0);t(a,"BILLBOARD_JITTERED",1);break;default:t(a,"BILLBOARD_RANDOM",
0),t(a,"BILLBOARD_JITTERED",0)}c.Jc&&ca.Yp?t(a,"DYNAMIC_GRASS",1):t(a,"DYNAMIC_GRASS",0);a.Jc=c.Jc;"PARTICLES"!=a.type&&(a.ag=c.ag);a.ye=c.ye;a.Pd=c.Pd;a.Qd=c.Qd&&!a.Fe&&!(a.eb&&ca.ew);a.rd=c.rd;a.fd=c.fd;a.Md=c.Md;c.ql?(K(a,"a_influence"),t(a,"SKINNED",1),ca.Nu?(t(a,"DISABLE_TANGENT_SKINNING",1),t(a,"FRAMES_BLENDING",0)):(t(a,"DISABLE_TANGENT_SKINNING",0),c.Sn?t(a,"FRAMES_BLENDING",1):t(a,"FRAMES_BLENDING",0)),t(a,"MAX_BONES",c.eh)):(t(a,"SKINNED",0),t(a,"FRAMES_BLENDING",0),t(a,"DISABLE_TANGENT_SKINNING",
0));c.Gc?(t(a,"VERTEX_ANIM",1),ca.yI?t(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):t(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):t(a,"VERTEX_ANIM",0);c.ql&&c.Gc&&U.l("Skinning and vertex animation are mutually exlusive");c.Mq?t(a,"DISABLE_FOG",1):t(a,"DISABLE_FOG",0)}}function p(a,c,d){if(c.length){for(var b=X.fr(c,ca.Rd&&d.b4w_enable_ssao),n=a.Tb,e=0,h=0;h<a.Tb.Pj.length;h++){var f=a.Tb.Pj[h];if("LIGHTING_LAMP"==f.id){var C=c[e++%c.length],y=C.$b;"AREA"==y.type&&(C=c[e++%c.length],y=C.$b);
var g=X.aa(C,d);if("SPOT"==y.type||"POINT"==y.type)var u=Math.cos(y.em/2);if("SPOT"==y.type)var L=y.Ws*(1-u);g=g.Ij;C=b.indexOf(C);f.Nb=[["LAMP_TYPE",y.type],["LAMP_IND",g],["LAMP_LIGHT_FACT_IND",Math.floor(g/2)],["LAMP_FAC_CHANNELS",0==g%2?"rg":"ba"],["LAMP_SPOT_SIZE",ta.H(u||.01)],["LAMP_SPOT_BLEND",ta.H(L||.01)],["LAMP_LIGHT_DIST",ta.H(y.distance)],["LAMP_SHADOW_MAP_IND",C]]}}if(a.ul){d=0;for(var p in a.ul)d++;a.ix=new Float32Array(3*d);a.gx=new Float32Array(3*d);a.fx=new Float32Array(3*d);a.hx=
new Float32Array(4*d);ta.V(n,"NUM_LAMP_LIGHTS",d);for(h=0;h<c.length;h++)R(a,c[h])}}}function R(a,c){if(c.Gi in a.ul){var d=a.ul[c.Gi];a.ix.set(sa.q(c.g.i),3*d);a.gx.set(c.$b.direction,3*d);a.fx.set(c.$b.on,3*d);var b=Ka,n=c.$b;b[0]=-1;b[1]=-1;b[2]=-1;b[3]=n.lk?1:0;switch(n.type){case "POINT":b[2]=n.distance;break;case "SPOT":b[2]=n.distance;var e=b[0]=Math.cos(n.em/2);b[1]=n.Ws*(1-e)}a.hx.set(b,4*d)}}function K(a,c){var d=a.pn;-1==d.indexOf(c)&&d.push(c)}function t(a,c,d){ta.V(a.Tb,c,d)}function y(a,
c){if("PHYSICS"==a.type)0<c.Oa.length&&E.dT(c,c.N[0]),a.Ae=c;else{var d=a.Tf,b=a.Sh;a.mE&&"PARTICLES"!=a.type&&(c=E.hO(c));a.II&&(c=ha.MO(a.JI,a.KI,a.HI));d=E.fT(c,d,b,a.Hc);a.oa=d;a.ag||d.ur||a.Qf||(d.Aj=null,d.sd=null);d=c.N.length;a.Kx=c.wa*d;a:switch(a.Sh){case E.Em:case E.xp:case E.wp:b=!0;break a;default:b=!1}b?E.SP(c)?a.wo=c.ab.length/3*d:a.wo=c.wa/3*d:a.wo=0}}function u(a,d,b,e,h,f,y,g,u,p,k,v){var t=a.ya,Ma=[],T=g.b4w_dynamic_grass;if(!p&&T)return Ma;for(var S="INSTANCE"==g.b4w_wind_bend_inheritance,
K="INSTANCE"==g.b4w_shadow_inheritance,q="INSTANCE"==g.b4w_reflection_inheritance,O=[],z=[],A=0;A<h.length;A++){var l=h[A].ya.g,r=U.hn(d);r.rf=g.b4w_hair_billboard;r.Xm=g.b4w_hair_billboard_type;r.Wm="SPHERICAL"==g.b4w_hair_billboard_geometry;r.Jc=T;r.Ar=!0;S?(r.Ie=l.Ie,r.op=l.op,r.Dh=l.Dh,r.Qg=l.Qg,r.dh=l.dh,r.Pg=l.Pg,r.Ig=l.Ig,r.Ag=l.Ag,r.ad=l.ad,r.iq=!1):(r.Ie=t.g.Ie,r.op=t.g.op,r.Dh=t.g.Dh,r.Qg=t.g.Qg,r.dh=t.g.dh,r.Pg=t.g.Pg,r.Ig=t.g.Ig,r.Ag=t.g.Ag,r.ad=t.g.ad,r.iq=!0);K?(r.ye=l.ye,r.Pd=l.Pd,
r.Qd=l.Qd):(r.ye=t.g.ye,r.Pd=t.g.Pd,r.Qd=t.g.Qd);q?(r.rd=l.rd,r.fd=l.fd,r.Md=l.Md,r.Qe=l.Qe,r.se=l.se,r.qg=l.qg):(r.rd=t.g.rd,r.fd=t.g.fd,r.Md=t.g.Md,r.Qe=t.g.Qe,r.se=t.g.se,r.qg=t.g.qg);O.push(r);var V=y[A];V||(V=new Float32Array);v&&U.vr(u.seed,k);var Ga=new Float32Array(3),w=new Float32Array([0,0,0,1]),aa=[],R=Z.PB(ca.qx)&&!g.b4w_initial_rand_rotation&&!g.b4w_hair_billboard,M=4;R&&(M=8);for(var X=0;X<V.length;X+=M){Ga[0]=V[X];Ga[1]=V[X+1];Ga[2]=V[X+2];var Ka=V[X+3]*sa.Pc(l.i);if(g.b4w_initial_rand_rotation){switch(g.b4w_rotation_type){case "XYZ":var ra=
new Float32Array([U.ef(k),U.ef(k),U.ef(k)]);da.normalize(ra,ra);break;case "Z":ra=new Float32Array([0,1,0]);break;default:U.l("Unsupported random rotation type: "+g.b4w_rotation_type)}ja.setAxisAngle(ra,g.b4w_rand_rotation_strength*(2*Math.PI*U.ef(k)-Math.PI),w)}else R&&(w.set(V.subarray(X+4,X+8)),U.Yx(w,w),g.use_whole_group||(g.use_rotation_dupli?ja.multiply(w,sa.B(l.i),w):ja.multiply(w,Aa,w)));var H=sa.rh(Ga,Ka,w,sa.create());aa.push(H)}z.push(aa)}for(var B={},A=0;A<h.length;A++){var Ca=h[A],mb=
f[A],r=O[A],Ra={};r.Ie&&(Ra.au_wind_bending_amp=[r.Ag],Ra.au_wind_bending_freq=[r.Dh],Ra.au_detail_bending_freq=[r.Qg],Ra.au_detail_bending_amp=[r.Pg],Ra.au_branch_bending_amp=[r.Ig],r.Ag=0,r.Dh=0,r.Qg=0,r.Pg=0,r.Ig=0);var x=n(r),aa=z[A];if(aa.length){for(var Q=Ca.data,I=Q.materials,D=Array(I.length),J=Array(I.length),X=0;X<I.length;X++)if(!E.wE(Q,X))for(var Da=0;Da<mb.length;Da++){var G=mb[Da],F=m(G),Y=I[X];"COLOR_ID"==G&&(F.qv=!(Ca.b4w_do_not_render||Y.b4w_do_not_render));"MAIN"==G?D[X]=F:"DEBUG_VIEW"==
G&&(J[X]=F);F.jn=a.b4w_cluster_data.cluster_id;if(C(F,Y)){"SHADOW"==G&&D[X]&&(F.Fe=D[X].Fe);F.Sh=E.Em;c(F,r);F.Kl=g.uuid;"JITTERED"==g.b4w_hair_billboard_type&&(F.RE=g.b4w_hair_billboard_jitter_amp,F.SE=g.b4w_hair_billboard_jitter_freq);T&&(F.jE=g.b4w_dynamic_grass_scale_threshold);S||(delete F.Hc.a_bending_col_main,delete F.Hc.a_bending_col_detail);L(F,x);var ga=E.NC(Q,X,F.pn,d.Ik,F.Hc,F.mk),ib=E.AQ(ga,Ra,aa,t),N=ib,fa=aa;N.ba.au_center_pos=new Float32Array(3*N.wa);for(var ea=fa.length,Ea=N.wa/ea,
ha=0;ha<ea;ha++)for(var W=fa[ha],ba=3*Ea*ha,ia=0;ia<Ea;ia++)N.ba.au_center_pos[ba+3*ia]=W[0],N.ba.au_center_pos[ba+3*ia+1]=W[1],N.ba.au_center_pos[ba+3*ia+2]=W[2];ib=N;if(r.Ie&&r.iq){var ka=ib,la=t.g.i;ka.ba.a_emitter_center=new Float32Array(3*ka.wa);var P=da.fromValues(0,0,0);sa.Fc(P,la,P);for(var Ba=0;Ba<ka.wa;Ba++)ka.ba.a_emitter_center[3*Ba]=P[0],ka.ba.a_emitter_center[3*Ba+1]=P[1],ka.ba.a_emitter_center[3*Ba+2]=P[2];ib=ka}var ta=g.b4w_vcol_from_name,ua=g.b4w_vcol_to_name,pa=F,xa=b,ma=!S,za=Q,
Ja=[];if(""!==ta&&""!==ua){var yb,Ib=ua,zb=pa.Hc,Jb=[],Kb=void 0;for(Kb in zb)for(var pc=zb[Kb].src,Zb=0,qc=0;qc<pc.length;qc++){var nb=pc[qc].$e;Ib==pc[qc].name&&Jb.push(Kb,nb,Zb);Zb+=U.bk(nb)}yb=Jb;if(0<yb.length)for(var pb=0;pb<yb.length;pb+=3)Ja.push({Jn:ta,Qq:7,es:yb[pb],fs:yb[pb+1],Nq:yb[pb+2]});else E.vP(pa.pn,"a_color")&&ua==za.active_vcol_name&&Ja.push({Jn:ta,Qq:7,es:"a_color",fs:7,Nq:0})}ma&&("a_bending_col_main"in xa&&Ja.push({Jn:"a_bending_col_main",Qq:4,es:"a_bending_col_main",fs:4,Nq:0}),
"a_bending_col_detail"in xa&&Ja.push({Jn:"a_bending_col_detail",Qq:7,es:"a_bending_col_detail",fs:7,Nq:0}));for(var La=ib,cb=aa,ic=e,hb=Ja,wc=F.Hc,Ab=!1,Va=0;Va<hb.length;Va++){var Tb=hb[Va].Jn,fc=ic.ba[Tb];if(fc&&0<fc.length){Ab=!0;break}}if(Ab){var Gc,ob=t.g.R,$a=ic.N[0].a_position,$b=cb,ya=B,Nb=new Float32Array(3),db=new Float32Array(3),gc=new Uint32Array($b.length);if(!("verts_indices"in ya)){ya.Kg=new Float32Array(3);ya.Gg=new Float32Array(3);ya.Dz=new Uint32Array($a.length/3);ya.xo=new Uint32Array($a.length/
3);ya.Kg[0]=(ob.max_x-ob.min_x)/20;ya.Kg[1]=(ob.max_y-ob.min_y)/20;ya.Kg[2]=(ob.max_z-ob.min_z)/20;ya.Gg[0]=ob.min_x;ya.Gg[1]=ob.min_y;ya.Gg[2]=ob.min_z;for(var Na=0;Na<$a.length/3;Na++){var kb=U.trunc(($a[3*Na]-ya.Gg[0])/ya.Kg[0]),Bb=U.trunc(($a[3*Na+1]-ya.Gg[1])/ya.Kg[1]),ac=U.trunc(($a[3*Na+2]-ya.Gg[2])/ya.Kg[2]),kb=U.S(kb,0,19),Bb=U.S(Bb,0,19),ac=U.S(ac,0,19);ya.Dz[Na]=Na;ya.xo[Na]=ac*Math.pow(20,2)+20*Bb+kb}E.rH(ya.xo,ya.Dz,E.Hu,!0);ya.nk=new Uint32Array(Math.pow(20,3));for(Na=0;Na<ya.xo.length;Na++)ya.nk[ya.xo[Na]]++;
delete ya.xo;for(Na=1;Na<ya.nk.length;Na++)ya.nk[Na]+=ya.nk[Na-1]}for(var Pa=0;Pa<$b.length;Pa++){Nb[0]=$b[Pa][0];Nb[1]=$b[Pa][1];Nb[2]=$b[Pa][2];for(var Xa=1E10,wb=-1,Ya=U.trunc((Nb[0]-ya.Gg[0])/ya.Kg[0]),rc=U.trunc((Nb[1]-ya.Gg[1])/ya.Kg[1]),Ub=U.trunc((Nb[2]-ya.Gg[2])/ya.Kg[2]),Ya=U.S(Ya,0,19),rc=U.S(rc,0,19),Ub=U.S(Ub,0,19),ab=Ub*Math.pow(20,2)+20*rc+Ya,bb=ya.nk[ab],lb=0==ab?0:ya.nk[ab-1];lb<bb;lb++){var qb=ya.Dz[lb];db[0]=$a[3*qb];db[1]=$a[3*qb+1];db[2]=$a[3*qb+2];da.sub(db,Nb,db);var Cb=da.sqrLen(db);
Cb<=Xa&&(Xa=Cb,wb=qb)}if(-1==wb)for(lb=0;lb<$a.length/3;lb++)db[0]=$a[3*lb],db[1]=$a[3*lb+1],db[2]=$a[3*lb+2],da.sub(db,Nb,db),Cb=da.sqrLen(db),Cb<=Xa&&(Xa=Cb,wb=lb);gc[Pa]=wb}Gc=gc;for(var gd=La.wa/cb.length,Va=0;Va<hb.length;Va++){var Ob=hb[Va].es,Kc=hb[Va].fs,Tb=hb[Va].Jn,xc=hb[Va].Qq,fc=ic.ba[Tb];switch(Ob){case "a_bending_col_main":var Vb=1;break;case "a_bending_col_detail":Vb=3;break;case "a_color":Vb=3;break;default:for(var jc=Vb=0;jc<wc[Ob].src.length;jc++)Vb+=U.bk(wc[Ob].src[jc].$e)}if(fc&&
0<fc.length){var Vc=U.bk(xc),kc=U.bk(Kc),sc=xc&Kc,yc=U.AG(sc);sc!=Kc&&va.error("Wrong color extraction from "+Tb+" to "+Ob+".");if("a_bending_col_main"==Ob||"a_bending_col_detail"==Ob)La.ba[Ob]=new Float32Array(La.wa*kc);for(jc=0;jc<cb.length;jc++){var bc=Gc[jc],Hc=bc*Vc,Wb=jc*gd*Vb;if(-1!=bc)for(var hc=0;hc<gd;hc++)for(var lc=hc*Vb,Db=0;Db<yc.length;Db++)yc[Db]&&(La.ba[Ob][Wb+lc+(hb[Va].Nq+U.Po(Kc,Db))]=fc[Hc+U.Po(xc,Db)])}}else La.ba[Ob]=new Float32Array(0)}}ib=La;Ma.push({G:F,Ae:ib,Hd:[Y.name],
g:r,ue:[a]})}}for(X=0;X<J.length;X++)J[X]&&(J[X].Iq=D[X].id,L(J[X],J[X].hy))}}return Ma}function C(a,c){var d=!0;"NODES_GLOW"==a.type&&(d=S.NB(c));return d=d&&f(a,c)}function L(a,c){var d=null,b=null,n=a.R,e=a.Ha,h=a.I,f=a.na;a.R=null;a.Ha=null;a.I=null;a.na=null;for(var C=0;C<a.fa.length;C++){var y=a.fa[C].ce;y&&(d||(d={}),d[C]=y,a.fa[C].ce=null);if(y=a.fa[C].Ba)b||(b={}),b[C]=y,a.fa[C].Ba=null}a.id=0;a.hy=c;a.id=U.AB(a,c);a.R=n;a.Ha=e;a.I=h;a.na=f;if(d)for(var g in d)a.fa[g].ce=d[g];if(b)for(g in b)a.fa[g].Ba=
b[g]}function n(a){var c=a.Oe;a.Oe=null;var d=U.AB(a,0);a.Oe=c;return d}function T(a,d,b,e,h,f){var C=m("DEBUG_VIEW");O(C,"debug_view.glslv","debug_view.glslf");C.jj=!0;C.Ka=!0;C.Kl=b;h&&(C.AC=!0);c(C,d);d=n(d);L(C,d);e?(d=h?a.O:[0,0,0],e=ha.yw(1,d),b=[da.length(a.$d),da.length(a.ae),da.length(a.be)],E.EG(e,b,d),h||(sa.ff(a.O,Ma),h=da.normalize(a.$d,ma),d=da.normalize(a.ae,Ja),a=da.normalize(a.be,Da),a=U.WN(h,d,a,ra),pa.invert(a,a),a=ja.fromMat3(a,Ka),sa.ti(a,Ma),sa.ve(1,Ma),E.bz(e,Ma))):e=ha.yw(a.mb,
a.O);C.R=U.ia(f.R);C.Ha=U.ia(f.Ha);C.I=U.ia(f.I);C.na=U.ia(f.na);E.Zs(e,1,!0);e.ba.a_polyindex=E.Sq(e);y(C,e);return C}function O(a,c,d){a.Tb.zm=c;a.Tb.al=d;ta.XR(a.Tb)}function V(a,c,d){1==a.fa.length&&0==a.Sc.length&&a.Sc.push("default0");d=d||"default"+String(a.fa.length);-1==a.Sc.indexOf(d)&&(a.fa.push(c),a.Sc.push(d));a.rb&&Q.nB(a)}function Y(a){a.Tb||U.l("No shaders info for batch "+a.name);a.rb=ta.UO(a.Tb);Q.AL(a.rb);Q.wL(a);Q.nB(a)}function la(a,c,d){a=a.A[0].X;for(var b=0;b<a.length;b++)if(a[b].type==
d&&!a[b].eg&&-1!=a[b].Df.indexOf(c))return a[b];return null}function W(a,c,d){a=a.A[0].X;for(var b=0;b<a.length;b++)if(a[b].type==d&&a[b].eg&&-1!=a[b].Df.indexOf(c))return a[b];return null}function ba(a,c){a.uf.set(c.uf);a.Bn=c.Bn;a.Yo.set(c.Yo);a.Vs=c.Vs;a.cm.set(c.cm);a.Wk=c.Wk;a.Ak=c.Ak;a.An=c.An;a.Qm=c.Qm;a.ss=c.ss;a.sj.set(c.sj);a.bs=c.bs;a.Ls.set(c.Ls);a.Ms=c.Ms;a.Ps.set(c.Ps);a.Qs=c.Qs;a.Vq=c.Vq;a.tt=c.tt}function aa(a,c){for(var d=a.Il,b=0;b<d.length;b+=2)if(d[b]==c)return d[b+1];return null}
function fa(a,c){for(var d=a.Hl,b=0;b<d.length;b+=2)if(d[b]==c)return d[b+1];return null}var ea=l("__boundings"),ia=l("__config"),va=l("__print"),ga=l("__extensions"),E=l("__geometry"),ka=l("__graph"),S=l("__nodemat"),X=l("__obj_util"),Ca=l("__particles"),ha=l("__primitives"),ja=l("__quat"),Z=l("__reformer"),Q=l("__renderer"),Ba=l("__scenegraph"),ta=l("__shaders"),ua=l("__textures"),sa=l("__tsr"),U=l("__util"),xa=l("__animation"),da=l("__vec3"),P=l("__vec4"),pa=l("__mat3"),ca=ia.v,za=["MAIN"],Aa=
new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]),ma=new Float32Array(3),Ja=new Float32Array(3),Da=new Float32Array(3),Ka=new Float32Array(4),Ma=sa.create(),Ga=new Float32Array(24),ra=pa.create();a.MU=ib;var ib="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Ea={};a.EL=function(a){return Ea[a]||null};a.FL=function(a,c){Ea[a]=c};a.z_=m;a.LO=function(a,c,d,n){for(var e=[],h=[],f=0;f<c.length;f++){var C=c[f],g=C.ya;g.mo||(X.Ea(g)?e.push(C):h.push(C))}for(var f=
[],f=f.concat(x(e,a.j.Pa)),g=f=f.concat(k(h,a.j.Pa)),e=[],h=[],u={},f=0;f<g.length;f++){var L=g[f].G,v=g[f].g,t=null;if(L.id in u){var Ma=u[L.id],S=h[Ma].G,K=h[Ma].g,q=null,m=null,O=L.R,z=L.Ha,r=L.I,l=L.na;L.R=null;L.Ha=null;L.I=null;L.na=null;var A=S.R,V=S.Ha,w=S.I,aa=S.na;S.R=null;S.Ha=null;S.I=null;S.na=null;for(C=0;C<L.fa.length;C++){var R=L.fa[C].ce;R&&(q||(q={}),q[C]=R,L.fa[C].ce=null);if(R=L.fa[C].Ba)m||(m={}),m[C]=R,L.fa[C].Ba=null}U.CH(L,S)&&U.CH(v,K)&&(t=h[Ma]);L.R=O;L.Ha=z;L.I=r;L.na=l;
S.R=A;S.Ha=V;S.I=w;S.na=aa;if(q)for(C in q)L.fa[C].ce=q[C];if(m)for(C in m)L.fa[C].Ba=m[C];if(!t){do L.id++;while(u[L.id])}}t||(t={G:L,g:g[f].g,ue:[],cz:[],Hd:[]},u[L.id]=h.length,h.push(t));t.ue=t.ue.concat(g[f].ue);g[f].Ae&&g[f].Ae.wa&&t.cz.push(g[f].Ae);if(t.Hd.length)for(C=0;C<g[f].Hd.length;C++)L=g[f].Hd[C],-1==t.Hd.indexOf(L)&&t.Hd.push(L);else t.Hd=g[f].Hd;E.rH(t.Hd,t.cz,E.yK,!1)}for(f=0;f<h.length;f++){g=h[f].cz;if(0==g.length)C=U.Cc(U.cp("%empty"));else if(1==g.length)C=g[0];else{u=[];for(C=
0;C<g.length;C++)E.TP(g[C])||u.push(C);if(u.length<g.length)for(C=0;C<u.length;C++)E.Zs(g[u[C]]);C=E.eT(g)}"PARTICLES"!=h[f].G.type&&(g=C.kd,h[f].G.R=U.ia(g.R),h[f].G.Ha=U.ia(g.Ha),h[f].G.I=U.ia(g.I),h[f].G.na=U.ia(g.na));e.push({G:h[f].G,g:h[f].g,Ae:C,Hd:h[f].Hd,ue:h[f].ue})}for(h=0;h<e.length;h++)if(g=e[h].G,g.Df=e[h].Hd,y(g,e[h].Ae),p(g,d,a),"STATIC"==e[h].g.type&&"COLOR_ID"!=g.type){f=U.cp("%meta%"+g.type+"%"+g.Df.join("%")+"%");u=X.tn(f,"MESH");u.g=U.ia(e[h].g);X.Tm(u,a);X.aq(u,a,g);n.push(u);
t=[];for(C=0;C<e[h].ue.length;C++){f=e[h].ue[C];f=f.ya;ea.On(f.g.I,Ga);for(L=0;L<Ga.length;L++)t.push(Ga[L]);"MAIN"==g.type&&f.rF.push(u)}u.g.na=ea.Aq(t,!0);u.g.Ha=ea.kv(u.g.na,u.g.i)}else for(u=[],C=0;C<e[h].ue.length;C++)f=e[h].ue[C],f=f.ya,-1==u.indexOf(f.name)&&(X.aq(f,a,g),u.push(f.name));if(ca.debug_view){for(h=0;h<e.length;h++)if(d=e[h].g,"DYNAMIC"==d.type&&(f=e[h].ue[0].ya,-1<za.indexOf(e[h].G.type))){C=X.aa(f,a);g=C.X;u=!1;for(C=0;C<g.length;C++)g[C].jj&&(u=!0);u||(d=T(d.Ha,d,f.name,!0,!0,
d),X.aq(f,a,d))}for(h=0;h<n.length;h++)f=n[h],d=f.g,C=X.aa(f,a),g=C.X,-1<za.indexOf(g[0].type)&&(d=T(g[0].na,d,f.name,!0,!1,g[0]),X.aq(f,a,d));for(h=0;h<e.length;h++)g=e[h].G,"DEBUG_VIEW"==g.type&&(g.yC=h)}for(h=0;h<c.length;h++)for(C=X.aa(c[h].ya,a),g=C.X,C=0;C<g.length;C++)b(g[C]);for(h=0;h<n.length;h++)for(C=X.aa(n[h],a),g=C.X,C=0;C<g.length;C++)b(g[C])};a.cL=function(a,c,d){var n=a.j.Mz,h=m("MAIN");O(h,"special_skydome.glslv","special_skydome.glslf");if(c.procedural_skydome)t(h,"PROCEDURAL_SKYDOME",
1),h.eG=!0;else{var f=n.Ty;if(f){t(h,"WO_SKYTEX",1);var C=ua.Dc(n.pH,null);V(h,C,"u_sky");f.invert&&t(h,"MTEX_NEGATIVE",1);f.rU&&t(h,"MTEX_RGBTOINT",1);t(h,"BLENDTYPE",f.LL);f.nU&&t(h,"WOMAP_BLEND",1);f.oU&&t(h,"WOMAP_HORIZ",1);f.qU&&t(h,"WOMAP_ZENUP",1);f.pU&&t(h,"WOMAP_ZENDOWN",1)}n.sU&&t(h,"WO_SKYBLEND",1);n.tU&&t(h,"WO_SKYPAPER",1);n.uU&&t(h,"WO_SKYREAL",1)}c.rd&&(h.rd=!0,c.fd&&(h.fd=!0));h.Sj=99999;K(h,"a_position");c=ha.HO();y(h,c);b(h);n=X.aa(d,a);d.g.mj=!0;d.g.R=ea.bc();d.g.Pe=ea.Mi();d.g.I=
ea.bc();d.g.Yc=ea.Mi();d.g.Ha=ea.kf();d.g.na=ea.kf();h.Ha=ea.kf();h.na=ea.kf();h.R=ea.bc();h.I=ea.bc();L(h);n.X.push(h);Ba.Ob(a.j.Pa,"DEBUG_VIEW")&&(a=e(h),a.type="DEBUG_VIEW",a.sb="",M(a),t(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),c.ba.a_polyindex=E.Sq(c),y(a,c),a.Iq=h.id,L(a),n.X.push(a))};a.Kv=function(a,c,d){d=X.aa(a,d).X;var b=[];Ba.Ob(c,"SHADOW_CAST");var n=Ba.Ob(c,"MAIN_PLANE_REFLECT"),h=Ba.Ob(c,"MAIN_CUBE_REFLECT"),f=Ba.Ob(c,"OUTLINE_MASK");c=Ba.Ob(c,"COLOR_PICKING");for(var C=0;C<d.length;C++){var g=
d[C],y=null;"SHADOW"==g.type&&"RECEIVE"==g.sb&&g.ye&&(y=e(g),y.sb="CAST");"MAIN"!=g.type&&"PARTICLES"!=g.type||!n&&!h||!g.rd||(y=e(g),y.sb="REFLECT",y.Qa=g.Qa,y.Tf&&(y.Tf=!1,y.Ka=!1));"COLOR_ID"==g.type&&g.qv&&f&&a.g.ic&&(c&&a.g.qi?(y=e(g),y.sb="OUTLINE"):g.sb="OUTLINE");y&&(y.eg=!0,L(y,a.g.id),b.push(y))}d.push.apply(d,b)};a.lS=r;a.IU=function(a,c,d){c?c=d*(c.max_y-c.min_y):(c=1,U.l("No bounding box for mesh"));if(0==c)return 0;a=c*Math.tan(U.jb(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/
c};a.GL=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.jL=function(a,c,d){c=ua.hD(c,d);V(a,c,"u_color_ramp_tex")};a.DT=v;a.CT=p;a.iS=R;a.mB=function(a,c){t(a,"CSM_SECTION0",0);t(a,"CSM_SECTION1",0);t(a,"CSM_SECTION2",0);t(a,"CSM_SECTION3",0);t(a,"NUM_CAST_LAMPS",0);if(c){t(a,"NUM_CAST_LAMPS",c.Cf.length);ca.Lr&&t(a,"MAC_OS_SHADOW_HACK",1);for(var d=0;d<c.csm_num;d++)t(a,"CSM_SECTION"+String(d),1);t(a,"SHADOW_TEX_RES",ta.H(c.csm_resolution));
t(a,"CSM_FADE_LAST_CASCADE",c.fade_last_cascade?1:0);t(a,"CSM_BLEND_BETWEEN_CASCADES",c.blend_between_cascades?1:0)}else t(a,"SHADOW_TEX_RES",0),t(a,"CSM_FADE_LAST_CASCADE",0),t(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.Od=t;a.Ew=function(a,c){return ta.YO(a.Tb,c)};a.AT=y;a.BT=L;a.ZL=n;a.CX=T;a.Ek=V;a.GR=function(a,c,d){d=a.Sc.indexOf(d);-1<d&&(a.fa[d]=c)};a.lN=function(a,c){var d=m("MAIN");d.eb=!0;P.set(c[0],c[1],c[2],.5,d.uf);d.Sh=E.xp;y(d,a);O(d,"main.glslv","main_stack.glslf");t(d,"SHADELESS",1);Y(d);
return d};a.Uc=Y;a.KO=function(a,c){for(var d=0;d<c.length;d++){var n=c[d].ya,e=m("LINE");O(e,"line.glslv","line.glslf");e.eb=!0;var h=ha.JO();y(e,h);b(e);e.R=ea.bc();e.I=ea.bc();e.Ha=ea.kf();e.na=ea.kf();X.Tm(n,a);X.aa(n,a).X.push(e);Y(e)}};a.hM=function(a){return a.rb.Do.length?a.rb.Rx.u_cube_fog?!0:!1:!1};a.UM=function(){var a=m("DEPTH_PACK");a.Db=!0;a.Ka=!1;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");Y(a);return a};a.Nv=function(a){var c=m("POSTPROCESSING");
O(c,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":t(c,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":t(c,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":t(c,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":t(c,"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":t(c,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":t(c,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":t(c,"POST_EFFECT",
"POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":t(c,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;case "FLIP_CUBEMAP_COORDS":t(c,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:U.l("Wrong postprocessing effect: "+a)}c.Db=!0;c.Ka=!1;a=ha.tc();y(c,a);Y(c);return c};a.pN=function(a){var c=m("SSAO");c.Ka=!1;c.Db=!0;var d=ha.tc();y(c,d);O(c,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");t(c,"SSAO_QUALITY","SSAO_QUALITY_"+a.wH);t(c,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:ua.NO("SSAO_TEXTURE",
a)};d={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=ua.Dc(a,d);V(c,a,"u_ssao_special_tex");Y(c);return c};a.qN=function(a){var c=m("SSAO_BLUR");c.Ka=!1;c.Db=!0;var d=ha.tc();y(c,d);O(c,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");t(c,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);
Y(c);return c};a.VM=function(){var a=m("DOF");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");t(a,"DEPTH_RGBA",1);Y(a);return a};a.dN=function(){var a=m("OUTLINE");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");Y(a);return a};a.XM=function(){var a=m("GLOW_COMBINE");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");Y(a);
return a};a.YM=function(a,c,d){var b=m("GOD_RAYS");b.Ka=!1;b.Db=!0;var n=ha.CO();y(b,n);O(b,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");t(b,"DEPTH_RGBA",a?1:0);t(b,"WATER_EFFECTS",c?1:0);t(b,"STEPS_PER_PASS",ta.H(d,1));Y(b);return b};a.ZM=function(){var a=m("GOD_RAYS_COM");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");t(a,"SAFARI_CANVAS_ALPHA_HACK",ca.DG?1:0);Y(a);return a};a.gN=function(){var a=m("SKY");
a.Ka=!1;a.Db=!0;var c=ha.DO();y(a,c);O(a,"procedural_skydome.glslv","procedural_skydome.glslf");t(a,"WATER_EFFECTS",1);Y(a);return a};a.NM=function(a){var c=m("ANTIALIASING");c.Ka=!1;c.Db=!0;var d=ha.tc();y(c,d);O(c,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ca.iG?(t(c,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),t(c,"AA_QUALITY",a.BO)):t(c,"AA_METHOD","AA_METHOD_FXAA_LIGHT");Y(c);return c};a.nN=function(a){var c=m("SMAA"),d=ha.tc();y(c,d);O(c,"postprocessing/smaa.glslv",
"postprocessing/smaa.glslf");t(c,"AA_METHOD","AA_METHOD_SMAA_HIGH");t(c,"SMAA_PASS",a);t(c,"SMAA_PREDICATION",0);t(c,"SMAA_REPROJECTION",0);Y(c);c.Ka=!1;c.Db=!0;return c};a.SM=function(){var a=m("COMPOSITING");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");Y(a);return a};a.cN=function(){var a=m("MOTION_BLUR");a.Db=!0;a.Ka=!1;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");Y(a);return a};
a.rN=function(a){var c=m("STEREO");c.Db=!0;c.Ka=!1;var d=ha.tc();y(c,d);O(c,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");t(c,"ANAGLYPH","ANAGLYPH"===a?1:0);Y(c);return c};a.$M=function(){var a=m("LUMINANCE");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");Y(a);return a};a.OM=function(){var a=m("LUMINANCE");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");
Y(a);return a};a.aN=function(){var a=m("LUMINANCE_X_BLUR");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");Y(a);return a};a.PM=function(){var a=m("POSTPROCESSING");a.Db=!0;a.Ka=!1;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");Y(a);return a};a.QM=function(){var a=m("BLOOM");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
Y(a);return a};a.vN=function(){var a=m("VELOCITY");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");Y(a);return a};a.MM=function(){var a=m("ANCHOR_VISIBILITY");a.Ka=!0;a.Db=!0;a.Sh=E.Zz;O(a,"anchors.glslv","anchors.glslf");var c=ha.iD(1);y(a,c);t(a,"ANCHOR_NUM",1);Y(a);a.Ql=new Float32Array([0,0,0]);return a};a.eN=function(){var a=m("PERFORMANCE");a.Ka=!1;a.Db=!0;var c=ha.tc();y(a,c);O(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
t(a,"POST_EFFECT","POST_EFFECT_X_BLUR");Y(a);return a};a.zT=function(a,c){var d=c.length/3;if(d!=a.Ql.length/3){var b=ha.iD(d);y(a,b);t(a,"ANCHOR_NUM",d);Y(a)}a.Ql=c};a.$Y=function(a){if(!a.A.length)return null;a=a.A[0];return a.X.length?a.X[0]:null};a.pY=la;a.qY=W;a.j1=ba;a.bX=function(a,c){for(var d=a.A[0].X,b=0;b<d.length;b++)if(d[b].type==c)return!0;return!1};a.UB=function(a){for(var c=a.fa,d=0;d<c.length;d++){var b=c[d];b.Oh&&ua.IN(b.hb)}a.oa.Oh&&E.DM(a.oa);a.rb.Oh&&ta.FM(a.rb);a.Gl&&(c=S.JD(a.Gl))&&
c.TB&&S.EM(a.Gl)};a.HP=function(a,c,d,b){for(var n=["MAIN","SHADOW","COLOR_ID"],e=!1,h=0;h<n.length;h++){var f=n[h],C=la(a,c,f),g=la(d,b,f);if(C&&g){var e=!0,y=W(d,b,f);"MAIN"==f&&(ba(g,C),y&&ba(y,C));for(f=0;f<g.Sc.length;f++){var u=g.Sc[f];if(-1!==ib.indexOf(u)){var L=C.Sc.indexOf(u);-1!==L&&(g.fa[f]=C.fa[L],y&&(u=y.Sc.indexOf(u),-1!==u&&(y.fa[u]=C.fa[L])))}}}}e||va.error("Wrong objects for inheriting material!")};a.Gy=function(a,c,d){var b=c[0],n=la(a,b,"MAIN");if(null===n)va.error('Material "'+
b+'" was not found in the object "'+a.name+'".');else if(c=c.join("%join%"),n=aa(n,c),null!==n)for(c=0;c<a.A.length;c++)for(var e=a.A[c].X,h=0;h<e.length;h++){var f=e[h];-1!=f.Df.indexOf(b)&&f.Qj&&(f.Qj[n]=d)}else va.error('Value node "'+c+'" was not found in the object "'+a.name+'".')};a.Fy=function(a,c,d,b,n){var e=c[0],h=c.join("%join%");c=fa(la(a,e,"MAIN"),h);if(null!=c)for(h=0;h<a.A.length;h++)for(var f=a.A[h].X,C=0;C<f.length;C++){var g=f[C];-1!=g.Df.indexOf(e)&&g.qe&&(g.qe[3*c]=d,g.qe[3*c+
1]=b,g.qe[3*c+2]=n)}else va.error('RGB node "'+h+'" was not found in the object "'+a.name+'".')};a.LD=function(a,c){var d=c.join("%join%"),b=la(a,c[0],"MAIN"),n=aa(b,d);if(null!=n)return b.Qj[n];va.error('Value node "'+d+'" was not found in the object "'+a.name+'".');return null};a.KD=function(a,c,d){var b=c.join("%join%");c=la(a,c[0],"MAIN");var n=fa(c,b);if(null!=n)return d[0]=c.qe[3*n],d[1]=c.qe[3*n+1],d[2]=c.qe[3*n+2],d;va.error('RGB node "'+b+'" was not found in the object "'+a.name+'".');return null};
a.ha=function(){Ea={}}};b4w.module.__extensions=function(a,l){function m(a){if(a in B)return B[a];var b=k.getExtension(a)||null;B[a]=b;e.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}var b=l("__config"),e=l("__print"),x=b.v,k=null,B={};a.xe=function(a){k=a};a.SD=function(){return m("WEBGL_compressed_texture_s3tc")||m("WEBKIT_WEBGL_compressed_texture_s3tc")||m("MOZ_WEBGL_compressed_texture_s3tc")};a.XO=function(){return x.ld?{}:m("WEBGL_depth_texture")||m("WEBKIT_WEBGL_depth_texture")||m("MOZ_WEBGL_depth_texture")};
a.RO=function(){return m("EXT_texture_filter_anisotropic")||m("WEBKIT_EXT_texture_filter_anisotropic")||m("MOZ_EXT_texture_filter_anisotropic")};a.Fw=function(){return m("WEBGL_debug_shaders")};a.QD=function(){return m("WEBGL_debug_renderer_info")};a.xD=function(){return x.ld?{}:m("OES_element_index_uint")};a.ZD=function(){return x.ld?null:m("OES_standard_derivatives")};a.Hw=function(){return m("EXT_disjoint_timer_query")};a.ha=function(){B={}}};b4w.module.__geometry=function(a,l){function m(a,c){for(var d=1;d<a.Oa.length;d++){for(var b=a.Oa[d].pd,e=b.a_position,h=b.a_normal,f=c.a_position,g=c.a_normal,y=e.length,u=a.Oa[d].wr,k=0;k<y;k++)f[k]+=u*e[k],g[k]+=u*h[k];b=b.a_tangent;e=c.a_tangent;h=b.length;for(k=0;k<h;k++)e[k]+=u*b[k]}}function b(a){return 65536<a.wa?h.xD()?!1:!0:!1}function e(a){return 0<a.ab.length?!0:!1}function x(a,c,d){if(!e(a))return a;d||v.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.wa*(c||
1)+", will use drawArrays","color: #aa0");c=a.ab;d=a.wa;var b=a.ba,h=a.N,f;for(f in b){var g=b[f],y=J(g,d);b[f]=k(c,g,y)}for(b=0;b<h.length;b++){var u=h[b];for(f in u)g=u[f],y=J(g,d),u[f]=k(c,g,y)}for(b=0;b<a.Oa.length;b++){f=a.Oa[b].pd;for(var p in f)g=f[p],y=J(g,d),f[p]=k(c,g,y)}a.wa=c.length;a.ab=new Uint16Array(0);return a}function k(a,c,d){if(0==c.length)return new Float32Array(0);for(var b=new Float32Array(a.length*d),e=0;e<a.length;e++)for(var h=a[e],f=0;f<d;f++)b[d*e+f]=c[d*h+f];return b}
function B(a,d){var b=a.sd,e=a.ed[d];if(e)return b.subarray(e.offset,e.offset+e.length);c.l("extract_array() failed; invalid name: "+d)}function r(d,b){var n,e;switch(b){case a.Em:case a.xp:n=u.TRIANGLES;e=u.STATIC_DRAW;break;case a.Zz:n=u.POINTS;e=u.STATIC_DRAW;break;case a.wp:n=u.TRIANGLES;e=u.DYNAMIC_DRAW;break;case a.VI:n=u.POINTS;e=u.DYNAMIC_DRAW;break;case a.WI:n=u.LINES;e=u.STATIC_DRAW;break;default:c.l("Wrong draw_mode")}d.mode=n;d.fp=e}function w(a){a.Aj?(a.Zg||(a.Zg=u.createBuffer()),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,
a.Zg),u.bufferData(u.ELEMENT_ARRAY_BUFFER,a.Aj,a.fp),a.Hq=a.Aj.byteLength):a.Hq=0;a.Hi||(a.Hi=u.createBuffer());u.bindBuffer(u.ARRAY_BUFFER,a.Hi);u.bufferData(u.ARRAY_BUFFER,a.sd,a.fp);a.BC=a.sd.byteLength}function f(a){for(var b=a[0],n=c.Cc("JOIN_"+a.length+"_SUBMESHES"),e=0,h=0;h<a.length;h++)e+=a[h].ab.length;n.ab=new Uint32Array(e);var f=e=0,g=0;if(0<a[0].Oa.length)for(var u=0;u<a[0].Oa.length;u++){for(h=0;h<a.length;h++)e+=a[h].Oa[u].pd.a_position.length,f+=a[h].Oa[u].pd.a_normal.length,g+=a[h].Oa[u].pd.a_tangent.length;
h={a_position:new Float32Array(e),a_normal:new Float32Array(f),a_tangent:new Float32Array(g)};n.Oa.push({wr:a[0].Oa[u].wr,pd:h})}for(h=e=0;h<a.length;h++)e+=a[h].wa;n.wa=e;var f=a[0],k;for(k in f.ba){for(h=e=0;h<a.length;h++)e+=a[h].ba[k].length;n.ba[k]=new Float32Array(e)}for(k in f.N[0]){for(h=e=0;h<a.length;h++)e+=a[h].N[0][k].length;for(h=0;h<f.N.length;h++)n.N[h]=n.N[h]||{},n.N[h][k]=new Float32Array(e)}h=n.kd;h.I=c.ia(b.kd.I);h.na=c.ia(b.kd.na);h.R=c.ia(b.kd.R);h.Ha=c.ia(b.kd.Ha);f=e=0;g=[];
for(b=0;b<a.length;b++){var u=a[b],p=u.ab,v=u.wa,t=u.ba;d.On(u.kd.I,y);d.Nn(h.I,u.kd.I);for(k=0;k<y.length;k++)g.push(y[k]);for(k=0;k<p.length;k++)n.ab[e+k]=p[k]+f;var e=e+p.length,K;for(K in t){var p=t[K],q=f*J(p,v);n.ba[K].set(p,q)}for(k=0;k<u.N.length;k++){var t=u.N[k],m=n.N[k];for(K in t)p=t[K],q=f*J(p,v),m[K].set(p,q)}f+=v}n.kd.na=d.Aq(g,!0);if(0<n.Oa.length)for(b=0;b<n.Oa.length;b++)for(K=n.Oa[b].pd,k=f=e=h=0;k<a.length;k++)g=a[k].Oa[b].pd,K.a_position.set(g.a_position,h),K.a_normal.set(g.a_normal,
e),K.a_tangent.set(g.a_tangent,f),h+=g.a_position.length,e+=g.a_normal.length,f+=g.a_tangent.length;return n}function q(a,b,n,e,h,f){var y=a.submeshes[b],u=y.base_length,k=a.materials[b],p=c.Cc("SUBMESH_"+a.name+"_"+k.name);p.wa=u;var t=!1;if(z(n,"a_texcoord")){var K=null,q=a.materials[b];b=a.submeshes[b];if(q.texture_slots.length)switch(q=q.texture_slots[0],q.texture_coords){case "UV":q=a.uv_textures.indexOf(q.uv_layer);0==q?K=new Float32Array(b.texcoord):1==q&&(K=new Float32Array(b.texcoord2));
break;case "ORCO":for(var m=a.b4w_bounding_box_source,K=new Float32Array(2*b.base_length),q=(m.max_x+m.min_x)/2,r=(m.max_z+m.min_z)/2,l=m.max_x-m.min_x,m=m.max_z-m.min_z,E=0,w=0;w<b.position.length;w+=3)K[E++]=(b.position[w]-q)/l+.5,K[E++]=(r-b.position[w+2])/m+.5}null===K&&(K=new Float32Array(2*b.base_length));b=K}else b=new Float32Array(0);if(z(n,"a_orco_tex_coord")){K=a.b4w_bounding_box_source;q=new Float32Array(3*y.base_length);r=K.max_x-K.min_x;l=K.max_y-K.min_y;m=K.max_z-K.min_z;for(w=E=0;w<
y.position.length;w+=3)0==r?q[E++]=.5:q[E++]=c.S(parseFloat(((y.position[w]-K.min_x)/r).toFixed(5)),0,1),0==m?q[E++]=.5:q[E++]=c.S(parseFloat(((K.max_z-y.position[w+2])/m).toFixed(5)),0,1),0==l?q[E++]=.5:q[E++]=c.S(parseFloat(((y.position[w+1]-K.min_y)/l).toFixed(5)),0,1);K=q}else K=new Float32Array(0);var S,q=y.group;if(z(n,"a_influence")&&e){r=new Float32Array(4*u);l=q.length/u;m=new Float32Array(l);for(E=0;E<l;E++)for(S in m[E]=-1,e)if(w=e[S],w.zI===E){m[E]=w.$v;break}var X=3<l?l:4;e=new Float32Array(X);
S=new Uint32Array(X);for(var E=new Float32Array(4),w=new Float32Array(X),X=new Uint32Array(X),R=new Float32Array(4),M=0;M<u;M++)e.set(w),S.set(X),E.set(R),r.set(A(q,l,M,u,m,e,S,E),4*M)}else r=new Float32Array(0);S=r;e=h?c.ia(h):{};e.a_color={vj:!0};e.a_color.src=z(n,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,$e:7}]:[];h={a_texcoord:b,a_influence:S,a_orco_tex_coord:K};S=y.vertex_colors;b=y.color;K=a.name;q=[];for(r=0;r<S.length;r++)q.push(S[r].name);for(var H in e)if(r=e[H].src,r.length){for(m=
l=0;m<r.length;m++)l+=c.bk(r[m].$e);h[H]=new Float32Array(l*u);for(m=E=0;m<r.length;m++){var Z=r[m].name,w=r[m].$e,X=c.AG(w),B=q.indexOf(Z);-1==B&&c.l('vertex color "'+Z+'" for mesh "'+K+'" not found.');R=S[B].mask;M=c.bk(R);(w&R)!==w&&v.error("Wrong color extraction from "+Z+" to "+H+".");for(var I=Z=0;I<B;I++)Z+=c.bk(S[I].mask);B=Z*u;for(Z=0;Z<u;Z++)for(I=0;3>I;I++)X[I]&&(h[H][Z*l+(E+c.Po(w,I))]=b[B+Z*M+c.Po(R,I)]);E+=M}}else h[H]=new Float32Array(0);H=a.uv_textures;e=y.texcoord;S=y.texcoord2;if(f)for(var J in f){b=
H.indexOf(J);if(0==b)var F=new Float32Array(e);else 1==b&&(F=new Float32Array(S));h[f[J]]=F}p.ba=h;p.ab=new Uint32Array(y.indices);f=y.position.length/u/3;F=(J=z(n,"a_normal")&&y.normal.length?!0:!1)&&z(n,"a_tangent")&&y.tangent.length?!0:!1;H=k.texture_slots[0];H=J&&k.texture_slots.length&&z(n,"a_tangent")&&"ORCO"==H.texture_coords&&H.use_map_normal?!0:!1;0<a.b4w_shape_keys.length&&(t=!0);for(h=0;h<f;h++){k=g(y,n,u,J,F,H,h,a.name);if(t)if(e={},e.name=a.b4w_shape_keys[h].name,p.Oa.push(e),0!=h){e.pd=
k;e.wr=a.b4w_shape_keys[h].value;continue}else e.pd=g(y,n,u,J,F,H,h,a.name),e.wr=1;p.N.push(k)}if(1<f&&!t){a=p.N[0];var k={},G;for(G in a)k[G]=new Float32Array(a[G]);p.N.push(k)}z(n,"a_polyindex")&&(x(p,1,!0),p.ba.a_polyindex=D(p));n=y.boundings;y=n.bounding_ellipsoid_axes;n={R:{max_x:n.bounding_box.max_x,max_y:n.bounding_box.max_y,max_z:n.bounding_box.max_z,min_x:n.bounding_box.min_x,min_y:n.bounding_box.min_y,min_z:n.bounding_box.min_z},Ha:d.rn([y[0],0,0],[0,y[1],0],[0,0,y[2]],n.bounding_ellipsoid_center,
[0,0,0,1]),I:null,na:null};p.kd=n;return p}function g(a,d,b,e,h,f,g,y){var u={},k=new Float32Array(3*b),t=new Float32Array(e?3*b:0),q=new Float32Array(h||f?4*b:0),m=g*b*3;k.set(a.position.subarray(m,m+3*b),0);e&&(m=g*b*3,t.set(a.normal.subarray(m,m+3*b),0));if(h)m=g*b*4,q.set(a.tangent.subarray(m,m+4*b),0);else if(f)for(a=q,v.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+y+'". Please add a UV-map.'),y=0;y<b;y++)d=R,e=K,d[0]=t[3*y],d[1]=t[3*y+
1],d[2]=t[3*y+2],p.cross(d,c.lf,e),0==p.length(e)&&p.cross(d,c.Ke,e),p.normalize(e,e),a[4*y]=e[0],a[4*y+1]=e[1],a[4*y+2]=e[2],a[4*y+3]=1;else if(e&&z(d,"a_tangent"))for(q=new Float32Array(4*b),b=0;b<q.length;b++)q[b]=1;u.a_position=k;u.a_normal=t;u.a_tangent=q;return u}function z(a,c){return-1<a.indexOf(c)?!0:!1}function A(c,d,b,e,h,f,g,y){for(var u=!0,k=0;k<d;k++){var p=c[k*e+b];if(-1!==p){var t=h[k];-1!==t&&(f[k]=p,g[k]=t,u=!1)}}if(u)return y;N(f,g,a.Hu,!1);for(k=c=0;4>k;k++)c+=f[k];if(.01>c)return y;
for(k=0;4>k;k++)f[k]/=c;if(.01>Math.abs(f[0]-1))y[0]=g[0]+1;else for(k=0;4>k;k++)y[k]=g[k]+f[k];return y}function J(a,d){if(0==d)return 0;var b=a.length,e=b/d;e!=Math.floor(e)&&c.l("Array size mismatch during geometry calculation: array length="+b+", base length="+d);return e}function N(c,d,b,e){for(var h=c.length,f=h,g=!1,y=e?-1:1;1<f||g;){1<f&&(f=Math.floor(f/1.247330950103979));for(var g=!1,u=0;f+u<h;u++)if(b==a.Hu?0>y*(c[u]-c[u+f]):c[u]<c[u+f]&&e)g=c[u],c[u]=c[u+f],c[u+f]=g,g=d[u],d[u]=d[u+f],
d[u+f]=g,g=!0}}function F(a,c,d){var b=[],e=[];p.subtract(c,a,b);p.subtract(d,a,e);p.normalize(b,b);p.normalize(e,e);return Math.acos(p.dot(b,e))}function G(a,c,d){c||(c=[]);d=d?a.N[0].a_normal:a.N[0].a_position;if(e(a)){a=a.ab;for(var b=a.length/3,h=0;h<b;h++){var f=new Float32Array(9),g=a[3*h];f[0]=d[3*g];f[1]=d[3*g+1];f[2]=d[3*g+2];g=a[3*h+1];f[3]=d[3*g];f[4]=d[3*g+1];f[5]=d[3*g+2];g=a[3*h+2];f[6]=d[3*g];f[7]=d[3*g+1];f[8]=d[3*g+2];c[h]=f}}else for(h=0;h<d.length;h++)f=new Float32Array(9),f[0]=
d[9*h],f[1]=d[9*h+1],f[2]=d[9*h+2],f[3]=d[9*h+3],f[4]=d[9*h+4],f[5]=d[9*h+5],f[6]=d[9*h+6],f[7]=d[9*h+7],f[8]=d[9*h+8],c[h]=f;return c}function D(a){for(var c=new Float32Array(a.wa),d=0;d<a.wa;d++)c[d]=d%3;return c}function H(a,c,d){var b=p.dist(a,c);a=p.dist(a,d);c=p.dist(c,d);d=(b+a+c)/2;return d*(d-b)*(d-a)*(d-c)}function I(a,c,d,b,e){d-=c;for(var h=0;h<d;h+=b)h%b==e&&vec3.normalize(a.subarray(h+c-e,h+c+1),a.subarray(h+c-e,h+c+1))}var d=l("__boundings"),h=l("__extensions"),v=l("__print"),M=l("__tsr"),
c=l("__util"),p=l("__vec3"),R=new Float32Array(3),K=new Float32Array(3),t=new Float32Array(3),y=new Float32Array(24);a.xp=10;a.Zz=20;a.wp=30;a.VI=40;a.WI=50;a.Hu=0;a.yK=1;a.Em=a.xp;var u=null;a.xe=function(a){u=a};a.JX=function(a){var c=_buffers[a];u.deleteBuffer(c.Zg);u.deleteBuffer(c.Hi);delete _buffers[a]};a.fT=function(a,c,n,h){b(a)&&x(a);var f=a.ab,g=a.wa,y=a.N,k={},p;for(p in a.ba)p in h&&!h[p].vj||(k[p]=a.ba[p]);h={Aj:null,sd:null,Ww:0,count:0,ed:{},mode:0,fp:0,Hq:0,BC:0,Hi:null,Zg:null,ur:null,
Oa:null,Oh:!0};0<a.Oa.length&&m(a,y[0]);if(f.length)if(p=f.length,65536>=g)var t=new Uint16Array(f),v=u.UNSIGNED_SHORT;else t=new Uint32Array(f),v=u.UNSIGNED_INT;else p=g,t=null;var q=0,K=y.length,z;for(z in y[0])var l=y[0][z],q=q+l.length*K;for(z in k)l=k[z],q+=l.length;z=new Float32Array(q);var q=0,K={},A;for(A in k){var E=k[A];if(l=E.length)z.set(E,q),K[A]={QW:A,jh:J(E,g),offset:q,frames:1,length:l},q+=l}k=y.length;for(A in y[0])if(E=y[0][A],l=E.length,E=J(E,g),l){K[A]={jh:E,offset:q,frames:k,
length:l};1<k&&(K[A+"_next"]={jh:E,offset:q+l,frames:k,length:l});for(var R=0;R<k;R++)E=y[R][A],z.set(E,q),q+=l}h.count=p;h.Aj=t;h.sd=z;h.Ww=v;h.ed=K;r(h,n);w(h);c&&e(a)&&(h.ur={JQ:new Float32Array(f.length),KQ:new Float32Array(f.length),ON:new Float32Array(f.length/3),SI:new Float32Array(3),IL:d.VL(a.kd.R)});h.Oa=a.Oa;return h};a.dT=m;a.TP=b;a.SP=e;a.Zs=x;a.JT=function(a,c,d){r(a,c);a.count=d.length;a.Aj=d;a.Ww=d instanceof Uint16Array?u.UNSIGNED_SHORT:u.UNSIGNED_INT};a.IT=function(a,d){var b=a.sd,
e=a.ed,h=e.a_p_data;h?(3!=h.jh&&c.l('invalid num_comp for "a_p_data"'),b.set(d,h.offset)):(b=b.length,h=new Float32Array(b+d.length),h.set(a.sd),h.set(d,b),a.sd=h,e.a_p_data={jh:3,offset:b});w(a)};a.fY=B;a.Y_=function(a){a.fp=u.STATIC_DRAW};a.BQ=function(a){a.fp=u.DYNAMIC_DRAW};a.iI=w;a.DM=function(a){a.Zg&&u.deleteBuffer(a.Zg);a.Hi&&u.deleteBuffer(a.Hi)};a.wE=function(a,c){return a.submeshes[c].base_length?!1:!0};a.bz=function(a,c){for(var d=0;d<a.N.length;d++){var b=a.N[d].a_position;M.tm(b,c,b,
0);b=a.N[d].a_normal;0<b.length&&M.aI(b,c,b,0);b=a.N[d].a_tangent;0<b.length&&M.bI(b,c,b,0)}(d=a.ba.au_center_pos)&&d.length&&M.tm(d,c,d,0);return a};a.cT=function(a,d){var b=a.ba.au_center_pos;if(b&&b.length){var e=new Float32Array(b);M.tm(e,d,e,0);for(var h=0;h<a.N.length;h++)for(var f=0;f<e.length;f++)a.N[h].a_position[f]+=e[f]-b[f];b.set(e)}else c.l('Attribute "au_center_pos" is missing in particle submesh')};a.bT=function(a,c){var d=a.wa,b;for(b in c){var e=c[b].length;a.ba[b]=new Float32Array(e*
d);for(var h=0;h<d;h++)for(var f=0;f<e;f++)a.ba[b][h*e+f]=c[b][f]}};a.eT=f;a.AQ=function(a,b,e,f){if(!a.wa)return c.Cc("EMPTY");var g=e.length;65536<a.wa*g&&!h.xD()&&x(a,g);var u=a.ab,k=a.wa,p=a.ba,t=a.N,v;for(v in b){var q=b[v].length,K=q*k;p[v]=new Float32Array(K);for(var m=0;m<k;m++)for(K=0;K<q;K++)p[v][m*q+K]=b[v][K]}b=c.Cc("CLONE_"+g+"_SUBMESHES");b.wa=k*g;b.ab=new Uint32Array(u.length*g);v=b.kd;q=d.bc();d.Mi();for(var z=[],m=0;m<g;m++)for(q=u.length*m,v=k*m,K=0;K<u.length;K++)b.ab[q+K]=u[K]+
v;for(var r in p)for(u=p[r],K=u.length*g,q=J(u,k),b.ba[r]=new Float32Array(K),m=0;m<g;m++)v=k*q*m,b.ba[r].set(u,v);for(r in t[0])for(m=0;m<t.length;m++)for(u=t[m][r],K=u.length*g,q=J(u,k),b.N[m]=b.N[m]||{},b.N[m][r]=new Float32Array(K),K=0;K<g;K++)switch(p=e[K],v=k*q*K,r){case "a_position":M.tm(u,p,b.N[m][r],v);break;case "a_normal":M.aI(u,p,b.N[m][r],v);break;case "a_tangent":M.bI(u,p,b.N[m][r],v);break;default:c.l("Wrong attribute name: "+r)}v=b.kd;q=d.bc();z=[];for(m=0;m<g;m++)for(q=d.Hg(a.kd.R,
e[m],q),d.Nn(v.R,q),q=d.Hg(q,f.g.i,q),d.Nn(v.I,q),d.On(q,y),K=0;K<y.length;K++)z.push(y[K]);v.na=d.Aq(z,!0);v.Ha=d.kv(v.na,f.g.i);return b};a.NC=q;a.hO=function(a){var d=a.wa,b=a.N[0].a_position,e=new Float32Array(12*d),h=new Float32Array(8*d);a=new Uint32Array(4*a.ab.length);for(var f=new Float32Array(4*d),g=0;g<d;g++){e[12*g]=b[3*g];e[12*g+1]=b[3*g+1];e[12*g+2]=b[3*g+2];e[12*g+3]=b[3*g];e[12*g+4]=b[3*g+1];e[12*g+5]=b[3*g+2];e[12*g+6]=b[3*g];e[12*g+7]=b[3*g+1];e[12*g+8]=b[3*g+2];e[12*g+9]=b[3*g];
e[12*g+10]=b[3*g+1];e[12*g+11]=b[3*g+2];h[8*g]=-.5;h[8*g+1]=-.5;h[8*g+2]=-.5;h[8*g+3]=.5;h[8*g+4]=.5;h[8*g+5]=.5;h[8*g+6]=.5;h[8*g+7]=-.5;a[6*g]=4*g+2;a[6*g+1]=4*g+1;a[6*g+2]=4*g;a[6*g+3]=4*g+2;a[6*g+4]=4*g;a[6*g+5]=4*g+3;var y=Math.random();f[4*g]=y;f[4*g+1]=y;f[4*g+2]=y;f[4*g+3]=y}b=c.Cc("HALO");b.N=[];b.N[0]={};b.wa=4*d;b.N[0].a_position=e;b.ba.a_halo_bb_vertex=h;b.ba.a_random_vals=f;b.ab=a;return b};a.vP=z;a.OC=function(a,b,e,h){for(var g=[],y=0;y<a.submeshes.length;y++){var u=q(a,y,b,null,e,
null);if(u.wa){var k=u.kd;h&&(k.I=d.Hg(k.R,h.i),k.na=d.Jk(k.Ha,h.i));g.push(u)}}return 0==g.length?c.Cc("EMPTY"):1==g.length?g[0]:f(g)};a.HT=function(a,c,d){for(var b=a.Aj,e=B(a,"a_position"),h=a.ur,f=h.JQ,g=h.KQ,h=h.ON,y=b,k=y.length/3,p=0;p<k;p++){var v=y[3*p],t=y[3*p+1],q=y[3*p+2],K=e[3*v+1],m=e[3*v+2],z=e[3*t+1],r=e[3*t+2],S=e[3*q+1],l=e[3*q+2];f[3*p]=(e[3*v]+e[3*t]+e[3*q])/3;f[3*p+1]=(K+z+S)/3;f[3*p+2]=(m+r+l)/3}M.tm(f,c,g);c=g.length/3;for(e=0;e<c;e++)f=g[3*e]-d[0],y=g[3*e+1]-d[1],k=g[3*e+2]-
d[2],h[e]=f*f+y*y+k*k;d=b;b=h.length;if(!(2>b))for(g=b,e=!1;1<g||e;)for(1<g&&(g=Math.floor(g/1.247330950103979)),e=!1,c=0;g+c<b;c++)0>h[c]-h[c+g]&&(e=h[c],h[c]=h[c+g],h[c+g]=e,e=d,f=c,y=c+g,k=e[3*f],p=e[3*f+1],v=e[3*f+2],e[3*f]=e[3*y],e[3*f+1]=e[3*y+1],e[3*f+2]=e[3*y+2],e[3*y]=k,e[3*y+1]=p,e[3*y+2]=v,e=!0);b=d;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,a.Zg);u.bufferData(u.ELEMENT_ARRAY_BUFFER,b,u.DYNAMIC_DRAW)};a.rH=N;a.WL=function(a,c,d){for(var b=c.length/3,e=a.length/3,h=[],f=Array(3),g=Array(3),y=Array(3),
u=0;u<e;u++){for(var k=a[3*u],v=a[3*u+1],t=a[3*u+2],q=0;3>q;q++)f[q]=c[3*k+q],g[q]=c[3*v+q],y[q]=c[3*t+q];if(d)var q=F(f,g,y),K=F(g,y,f),m=Math.PI-q-K;else m=K=q=1;var z=h,r;r=f;var S=y,l=[],A=[],w=[];p.subtract(g,r,l);p.subtract(S,r,A);p.cross(l,A,w);p.normalize(w,w);r=w;for(S=0;3>S;S++)l=3*v+S,A=3*t+S,z[3*k+S]=q*r[S],z[l]=K*r[S],z[A]=m*r[S]}if(d)for(var R in d)for(u=d[R],a=0;3>a;a++){c=3*u[0]+a;for(e=1;e<u.length;e++)f=3*u[e]+a,h[c]+=h[f];for(e=1;e<u.length;e++)f=3*u[e]+a,h[f]=h[c]}for(u=0;u<b;u++){d=
u;R=h;a=new Float32Array(3);for(c=0;3>c;c++)e=3*d+c,a[c]=R[e];p.normalize(a,a);for(c=0;3>c;c++)e=3*d+c,R[e]=a[c]}return h};a.YL=function(a,c,d){for(var b={},e=c.length/3,h=0;h<e;h++){var f=String(c[3*h])+String(c[3*h+1])+String(c[3*h+2]);b[f]=[]}e=a.length;for(h=0;h<e;h++)c=a[h],f=String(d[3*c])+String(d[3*c+1])+String(d[3*c+2]),f in b&&b[f].push(c);return b};a.zw=function(a,d,b,e){var h=G(a,null,!1);if(b)var f=G(a,null,!0);var g=h.length,y=new Float32Array(g),u=R,k=K;for(a=0;a<g;a++){var p=h[a];
u.set(p.subarray(0,3));k.set(p.subarray(3,6));t.set(p.subarray(6));y[a]=Math.sqrt(H(u,k,t))}u=new Float32Array(g);u[0]=y[0];for(a=1;a<g;a++)u[a]=u[a-1]+y[a];g=u[y.length-1];y=[];for(a=0;a<d;a++){var k=g*c.ef(e),k=c.jq(u,k,0,u.length-1),p=b?f[k]:h[k],k=a,v=p,q=e,p=void 0,p=new Float32Array(3),m=v[0],z=v[1],r=v[2],l=v[3],A=v[4],S=v[5],w=v[6],M=v[7],B=v[8],v=c.ef(q),q=c.ef(q);1<v+q&&(v=1-v,q=1-q);var I=1-v-q,z=I*z+v*A+q*M,r=I*r+v*S+q*B;p[0]=I*m+v*l+q*w;p[1]=z;p[2]=r;y[k]=p}return y};a.gY=G;a.Sq=D;a.w2=
H;a.EG=function(a,c,d){a=a.N[0].a_position;for(var b=0;b<a.length;b+=3)a[b]=(a[b]-d[0])*c[0]+d[0],a[b+1]=(a[b+1]-d[1])*c[1]+d[1],a[b+2]=(a[b+2]-d[2])*c[2]+d[2]};a.rL=function(a,c,d){var b=a.A[0].X;a=a.g.ui;for(var e=1;e<a.length;e++)a[e].name==c&&(a[e].value=d);for(e=0;e<b.length;e++)if(!b[e].eg&&b[e].Qf&&!b[e].jj){d=b[e].oa.ed;c=b[e].oa.sd;u.bindBuffer(u.ARRAY_BUFFER,b[e].oa.Hi);var h=d.a_position,f=b[e],g=c,y=a;if(h){for(var k=h.offset,h=h.length+k,p=f.oa.Oa[0].pd.a_position,v=k;v<h;v++)g[v]=p[v-
k];for(v=1;v<f.oa.Oa.length;v++){var p=f.oa.Oa[v].pd.a_position,t=y[v].value;if(t)for(var q=k;q<h;q++)g[q]+=t*p[q-k]}u.bufferSubData(u.ARRAY_BUFFER,4*k,g.subarray(k))}h=d.a_normal;f=b[e];g=c;y=a;if(h){k=h.offset;h=h.length+k;p=f.oa.Oa[0].pd.a_normal;for(v=k;v<h;v++)g[v]=p[v-k];for(v=1;v<f.oa.Oa.length;v++)if(p=f.oa.Oa[v].pd.a_normal,t=y[v].value)for(q=k;q<h;q++)g[q]+=t*p[q-k];I(g,k,h,3,2);u.bufferSubData(u.ARRAY_BUFFER,4*k,g.subarray(k))}y=d.a_tangent;d=b[e];f=a;if(y){g=y.offset;y=y.length+g;h=d.oa.Oa[0].pd.a_tangent;
for(k=g;k<y;k++)c[k]=h[k-g];for(k=1;k<d.oa.Oa.length;k++)if(h=d.oa.Oa[k].pd.a_tangent,v=f[k].value)for(p=g;p<y;p++)c[p]+=v*h[p-g];I(c,g,y,4,3);u.bufferSubData(u.ARRAY_BUFFER,4*g,c.subarray(g))}}};a.uv=function(a){return a.g.Qf};a.JZ=function(a){var c=[];if(a.g)for(var d=1;d<a.g.ui.length;d++)c.push(a.g.ui[d].name);return c};a.IZ=function(a,c){if(a.g)for(var d=1;d<a.g.ui.length;d++)if(c==a.g.ui[d].name)return a.g.ui[d].value;return 0};a.yP=function(a,c){var d=a.g.ui;if(d)for(var b=1;b<d.length;b++)if(d[b].name==
c)return!0;return!1};a.uE=function(a){return a&&a.g&&a.g.ag?!0:!1};a.QX=function(c,d,b){var e=c.oa;if(e){for(var h=b?d.length/3/2:d.length/3-1,f=new Float32Array(12*h),g=new Float32Array(12*h),y=new Uint16Array(6*h),u=0;u<h;u++){if(b)var k=6*u,p=6*u+3;else k=3*u,p=3*(u+1);var v=d[k],t=d[k+1],k=d[k+2],q=d[p],K=d[p+1],p=d[p+2],m=q-v,z=K-t,r=p-k;f[12*u]=v;f[12*u+1]=t;f[12*u+2]=k;g[12*u]=m;g[12*u+1]=z;g[12*u+2]=r;f[12*u+3]=q;f[12*u+4]=K;f[12*u+5]=p;g[12*u+3]=-m;g[12*u+4]=-z;g[12*u+5]=-r;f[12*u+6]=v;f[12*
u+7]=t;f[12*u+8]=k;g[12*u+6]=-m;g[12*u+7]=-z;g[12*u+8]=-r;f[12*u+9]=q;f[12*u+10]=K;f[12*u+11]=p;g[12*u+9]=m;g[12*u+10]=z;g[12*u+11]=r;y[6*u]=4*u;y[6*u+1]=4*u+1;y[6*u+2]=4*u+2;y[6*u+3]=4*u;y[6*u+4]=4*u+3;y[6*u+5]=4*u+1}b=0;for(var S in e.ed)d=e.ed[S],b+=f.length/3*d.jh;e.sd=new Float32Array(b);b=e.sd;a.JT(e,c.Sh,y);c=0;for(S in e.ed)switch(d=e.ed[S],S){case "a_position":b.set(f,c);d.offset=c;d.length=f.length;c+=d.length;break;case "a_direction":b.set(g,c);d.offset=c;d.length=g.length;c+=d.length;
break;default:d.offset=c,d.length=f.length/3*d.jh,y=new Float32Array(d.length),b.set(y,c),c+=d.length}w(e)}}};b4w.module.__graph=function(a,l){function m(a,c,d){d||(d=null);b(a,c)?K.l("Graph already has node with given ID"):a.K.push(c,d)}function b(a,c){for(var d=a.K,b=0;b<d.length;b+=2)if(d[b]==c)return!0;return!1}function e(a,c,d,e){e||(e=null);b(a,c)&&b(a,d)?a.Aa.push(c,d,e):K.l("Wrong node IDs")}function x(a,c){b(a,c)||K.l("Node not found");for(var d=a.K,e=0;e<d.length;e+=2)d[e]==c&&(d.splice(e,2),e-=2)}function k(a,c,d,b){M(a,c,d)||K.l("Edge not found");a=a.Aa;for(var e=0,h=0;h<a.length;h+=3)if(a[h]==
c&&a[h+1]==d){if(-1==b)a.splice(h,3);else{if(b==e){a.splice(h,3);break}e++}h-=3}}function B(a){a=a.K;for(var c=-1,d=0;d<a.length;d+=2)c=Math.max(c,a[d]);return++c}function r(a,c){for(var d=a.K,b=0;b<d.length;b+=2)if(d[b+1]==c)return d[b];return-1}function w(a){var c=[],b={};f(a,b);for(var e=a.K,h=0;h<e.length;h+=2)0==d(a,e[h])&&q(a,e[h],b,c);return{K:c,Aa:a.Aa.slice(0)}}function f(a,c){for(var d=a.K,b=0;b<d.length;b+=2)c[d[b]]=!1}function q(a,c,d,b){if(!d[c]){d[c]=!0;for(var e=0;e<I(a,c);e++)q(a,
h(a,c,e),d,b);b.unshift(c,H(a,c))}}function g(a,c,b,e){if(!b[c]){b[c]=!0;if(10==e||30==e)for(var n=0;n<I(a,c);n++){var f=h(a,c,n);g(a,f,b,e)}if(20==e||30==e)for(n=0;n<d(a,c);n++)f=v(a,c,n),g(a,f,b,e)}}function z(a){for(var c=a.Aa,d=0;d<c.length;d+=3){var e=c[d+1];b(a,c[d])&&b(a,e)||(c.splice(d,3),d-=3)}}function A(a){for(var c=[],d=a.K,b=0;b<d.length;b+=2){var e=d[b];I(a,e)||c.push(e)}return c}function J(a){var c=a.K;a=a.Aa;for(var d=[],b=[],e=[],h=0;h<c.length;h++)e[c[2*h]]=h,d.push(h,c[2*h+1]);
for(h=0;h<a.length;h+=3)b.push(e[a[h]],e[a[h+1]],a[h+2]);return{K:d,Aa:b}}function N(a,c,b){if(b.Zf==b.hi){for(var e=0,n=0;e<b.hi;e++)-1!=b.Mg[e]&&(a[n]=e,c[n]=b.Mg[e],n++);return!0}if(b.hi>b.Fl||b.zi>b.Ai||b.om>b.qm||b.nm>b.pm)return!1;for(var n=e=-1,f=!1;!f&&F(b,t,e,n);)if(e=t[0],n=t[1],G(b,e,n)){var g;g=b;f={};f.Un=g.Un;f.Vn=g.Vn;f.Gx=g.Gx;f.Oq=g.Oq;f.hi=g.hi;f.Fl=g.Fl;f.ii=g.ii;f.Zf=f.Xr=g.Zf;f.nm=g.nm;f.om=g.om;f.zi=g.zi;f.pm=g.pm;f.qm=g.qm;f.Ai=g.Ai;f.Pm=-1;f.Mg=g.Mg;f.hj=g.hj;f.Bj=g.Bj;f.Cj=
g.Cj;f.Uj=g.Uj;f.Vj=g.Vj;f.Ns=g.Ns;g.Ns[0]+=1;var f=g=f,k=e,p=n,q=f.Un,K=f.Vn,m=f.hi,z=f.Fl,r=f.Mg,l=f.hj,A=f.Bj,w=f.Cj,R=f.Uj,E=f.Vj;D(k<m);D(p<z);D(f.Zf<m);D(f.Zf<z);m=++f.Zf;f.Pm=k;A[k]||(A[k]=m,f.nm++,R[k]&&f.zi++);R[k]||(R[k]=m,f.om++,A[k]&&f.zi++);w[p]||(w[p]=m,f.pm++,E[p]&&f.Ai++);E[p]||(E[p]=m,f.qm++,w[p]&&f.Ai++);r[k]=p;l[p]=k;for(r=0;r<d(q,k);r++)l=v(q,k,r),A[l]||(A[l]=m,f.nm++,R[l]&&f.zi++);for(r=0;r<I(q,k);r++)l=h(q,k,r),R[l]||(R[l]=m,f.om++,A[l]&&f.zi++);for(r=0;r<d(K,p);r++)l=v(K,p,
r),w[l]||(w[l]=m,f.pm++,E[l]&&f.Ai++);for(r=0;r<I(K,p);r++)l=h(K,p,r),E[l]||(E[l]=m,f.qm++,w[l]&&f.Ai++);f=N(a,c,g);D(1>=g.Zf-g.Xr);D(-1!=g.Pm);l=g.Un;k=g.Vn;p=g.Zf;q=g.Pm;K=g.Mg;A=g.hj;m=g.Bj;w=g.Cj;z=g.Uj;R=g.Vj;if(g.Xr<p){m[q]==p&&(m[q]=0);for(E=0;E<d(l,q);E++)r=v(l,q,E),m[r]==p&&(m[r]=0);z[q]==p&&(z[q]=0);for(E=0;E<I(l,q);E++)r=h(l,q,E),z[r]==p&&(z[r]=0);l=K[q];w[l]==p&&(w[l]=0);for(E=0;E<d(k,l);E++)r=v(k,l,E),w[r]==p&&(w[r]=0);R[l]==p&&(R[l]=0);for(E=0;E<I(k,l);E++)r=h(k,l,E),R[r]==p&&(R[r]=
0);K[q]=-1;A[l]=-1;g.Zf=g.Xr;g.Pm=-1}}return f}function F(a,c,d,b){-1==d&&(d=0);-1==b?b=0:b++;var e=a.zi,h=a.Ai,f=a.om,g=a.qm,k=a.nm,p=a.pm,v=a.Zf,t=a.hi,q=a.Fl,K=a.Mg,m=a.hj,r=a.Bj,z=a.Cj,l=a.Uj,A=a.Vj;if(e>v&&h>v)for(;d<t&&(-1!=K[d]||0==l[d]||0==r[d]);)d++,b=0;else if(f>v&&g>v)for(;d<t&&(-1!=K[d]||0==l[d]);)d++,b=0;else if(k>v&&p>v)for(;d<t&&(-1!=K[d]||0==r[d]);)d++,b=0;else if(0==d&&0!=a.ii){for(r=0;r<t&&-1!=K[d=a.ii[r]];)r++;r==t&&(d=t)}else for(;d<t&&-1!=K[d];)d++,b=0;if(e>v&&h>v)for(;b<q&&(-1!=
m[b]||0==A[b]||0==z[b]);)b++;else if(f>v&&g>v)for(;b<q&&(-1!=m[b]||0==A[b]);)b++;else if(k>v&&p>v)for(;b<q&&(-1!=m[b]||0==z[b]);)b++;else for(;b<q&&-1!=m[b];)b++;return d<t&&b<q?(c[0]=d,c[1]=b,!0):!1}function G(a,b,e){var f=a.Un,n=a.Vn,g=a.Fl,k=a.Mg,p=a.hj,t=a.Bj,q=a.Cj,K=a.Uj,m=a.Vj;D(b<a.hi);D(e<g);D(-1==k[b]);D(-1==p[e]);if(!(0,a.Gx)(H(f,b),H(n,e)))return!1;for(var r=g=0,z=0,l=0,A=0,w=0,R=0;R<I(f,b);R++){var E=h(f,b,R);if(-1!=k[E]){var B=k[E];if(!M(n,e,B)||!c(a.Oq,f,b,E,n,e,B))return!1}else t[E]&&
z++,K[E]&&g++,t[E]||K[E]||A++}for(R=0;R<d(f,b);R++)if(E=v(f,b,R),-1!=k[E]){if(B=k[E],!M(n,B,e)||!c(a.Oq,f,E,b,n,B,e))return!1}else t[E]&&z++,K[E]&&g++,t[E]||K[E]||A++;for(R=0;R<I(n,e);R++)if(B=h(n,e,R),-1!=p[B]){if(E=p[B],!M(f,b,E))return!1}else q[B]&&l++,m[B]&&r++,q[B]||m[B]||w++;for(R=0;R<d(n,e);R++)if(B=v(n,e,R),-1!=p[B]){if(E=p[B],!M(f,E,b))return!1}else q[B]&&l++,m[B]&&r++,q[B]||m[B]||w++;return z<=l&&g<=r&&A<=w}function D(a){a||K.l("Assertion failed")}function H(a,c){for(var d=a.K,b=0;b<d.length;b+=
2)if(d[b]==c)return d[b+1];return null}function I(a,c){for(var d=a.Aa,b=0,e=0;e<d.length;e+=3)d[e]==c&&b++;return b}function d(a,c){for(var d=a.Aa,b=0,e=0;e<d.length;e+=3)d[e+1]==c&&b++;return b}function h(a,c,d){a=a.Aa;for(var b=0,e=0;e<a.length;e+=3)if(a[e]==c){if(b==d)return a[e+1];b++}return-1}function v(a,c,d){a=a.Aa;for(var b=0,e=0;e<a.length;e+=3)if(a[e+1]==c){if(b==d)return a[e];b++}return-1}function M(a,c,d){a=a.Aa;for(var b=0;b<a.length;b+=3)if(a[b]==c&&a[b+1]==d)return!0;return!1}function c(a,
c,d,b,e,h,f){for(var g=p(c,d,b),k=p(e,h,f),v=0;v<g;v++){for(var t=!1,q=0;q<k;q++)if(a(R(c,d,b,v),R(e,h,f,q))){t=!0;break}if(!t)return!1}return!0}function p(a,c,d){var b=0;a=a.Aa;for(var e=0;e<a.length;e+=3)a[e]==c&&a[e+1]==d&&b++;return b}function R(a,c,d,b){a=a.Aa;for(var e=0,h=0;h<a.length;h+=3)if(a[h]==c&&a[h+1]==d){if(e==b)return a[h+2];e++}return null}l("__print");var K=l("__util"),t=[-1,-1];a.Au=-1;a.fV=10;a.tp=20;a.kW=30;a.create=function(){for(var a=arguments,c=[],d=[],b=0;b<a.length;b++){var e=
a[b];switch(e.length){case 2:c.push(e[0],e[1]);break;case 3:d.push(e[0],e[1],e[2]);break;default:K.l("Wrong graph constructor params")}}return{K:c,Aa:d}};a.clone=function(a,c,d){if(c)for(var b=Array(a.K.length),e=0;e<a.K.length;e+=2)b[e]=a.K[e],b[e+1]=c(a.K[e+1]);else b=K.ia(a.K);if(d)for(c=Array(a.Aa.length),e=0;e<a.Aa.length;e+=3)c[e]=a.Aa[e],c[e+1]=a.Aa[e+1],c[e+2]=d(a.Aa[e+2]);else c=K.ia(a.Aa);return a={K:b,Aa:c}};a.DX=function(a,c){for(var d=[],b=[],e=0;e<a.length;e++)d.push(a[e][0],a[e][1]);
for(e=0;e<c.length;e++)b.push(c[e][0],c[e][1],c[e][2]);return{K:d,Aa:b}};a.Ck=m;a.h_=b;a.Wc=e;a.Kf=x;a.ni=k;a.ts=function(a,c,d,b){M(a,c,d)||K.l("Edge not found");a=a.Aa;for(var e=0;e<a.length;e+=3)if(a[e]==c&&a[e+1]==d&&a[e+2][0]==b[0]&&a[e+2][1]==b[1]){a.splice(e,3);break}};a.C=function(a,c){if(-1==r(a,c)){var d=B(a);m(a,d,c);return d}K.l("Non-unique attribute")};a.FR=function(a,c,d,b,e){a=a.Aa;for(var h=0;h<a.length;h+=3)a[h]==c&&a[h+1]==d&&a[h+2]==b&&(a[h+2]=e)};a.iL=function(a,c,d){var b;d=d||
[];b=b||[];for(var h={},f=0;f<a.K.length;f+=2){var g=a.K[f],k=a.K[f+1],p=B(c);m(c,p,k);h[g]=p}for(f=0;f<a.Aa.length;f+=3)k=h[a.Aa[f]],p=h[a.Aa[f+1]],g=a.Aa[f+2],e(c,k,p,g);for(f=0;f<d.length;f+=3)k=h[d[f]],a=d[f+1],g=d[f+2],e(c,k,a,g);for(f=0;f<b.length;f+=3)d=b[f],p=h[b[f+1]],g=b[f+2],e(c,d,p,g)};a.Wn=B;a.Gf=r;a.m=function(a,c,d,b){c=r(a,c);d=r(a,d);-1!=c&&-1!=d?e(a,c,d,b):K.l("Attributes not found")};a.ma=function(a,c){for(var d=a.K,b=0;b<d.length&&!c(d[b],d[b+1]);b+=2);};a.Pf=function(a,c){for(var d=
a.Aa,b=0;b<d.length&&!c(d[b],d[b+1],d[b+2]);b+=3);};a.xg=function(a,c,d){for(var b=a.Aa,e=0;e<b.length;e+=3)if(b[e+1]==c){var h=b[e];if(d(h,H(a,h),b[e+2]))break}};a.Ci=function(a,c,d){for(var b=a.Aa,e=0;e<b.length;e+=3)if(b[e]==c){var h=b[e+1];if(d(h,H(a,h),b[e+2]))break}};a.pz=w;a.rT=function(a){a=w(a).K;for(var c=[],d=0;d<a.length;d+=2)c.push(a[d+1]);return c};a.E_=function(){};a.Ys=function(a,c,d){b(a,c)||K.l("No such node");var e={};f(a,e);g(a,c,e,d);c=[];for(var h in e)e[h]&&(h=Number(h),c.push(h,
H(a,h)));a={K:c,Aa:a.Aa.slice(0)};z(a);return a};a.wv=z;a.lP=function(a){for(var c=[],b=a.K,e=0;e<b.length;e+=2){var h=b[e];d(a,h)||c.push(h)}return c};a.$n=A;a.match=function(a,c,d,b){var e={};e.Un=J(a);e.Vn=J(c);e.Gx=d||function(a,c){return a==c};e.Oq=b||function(a,c){return a==c};b=a.K.length/2;var h=c.K.length/2;e.hi=b;e.Fl=h;e.ii=0;e.Zf=e.Xr=0;e.zi=e.nm=e.om=0;e.Ai=e.pm=e.qm=0;e.Pm=-1;e.Mg=Array(b);e.hj=Array(h);e.Bj=Array(b);e.Cj=Array(h);e.Uj=Array(b);e.Vj=Array(h);e.Ns=[1];for(d=0;d<b;d++)e.Mg[d]=
-1,e.Bj[d]=0,e.Uj[d]=0;for(d=0;d<h;d++)e.hj[d]=-1,e.Cj[d]=0,e.Vj[d]=0;h=Array(b);b=Array(b);if(N(h,b,e)){for(d=0;d<h.length;d++)h[d]=a.K[2*h[d]],b[d]=c.K[2*b[d]];return[h,b]}return null};a.hP=function(a,c){for(var d=a.K,b=1;b<d.length;b+=2)if(d[b]==c)return d[b-1];return null};a.Ra=H;a.ng=I;a.sr=d;a.fg=h;a.wj=v;a.SY=p;a.me=R;a.replace=function(a,c,d){for(var b=a.Aa,e=B(a),h=0;h<c.length;h++){var f=c[h];x(a,f);for(var g=0;g<b.length;g+=3)b[g]==f&&(b[g]=e),b[g+1]==f&&(b[g+1]=e),b[g]==b[g+1]&&(b.splice(g,
3),g-=3)}m(a,e,d)};a.uR=function(a,c,d,b,e){M(a,c,d)||K.l("Edge not found");a=a.Aa;for(var h=0;h<a.length;h+=3)a[h]==c&&a[h+1]==d&&(a[h]=b,a[h+1]=e)};a.aO=function(a,c){function d(a,c){if(-1!=g.indexOf(a)){var b=g.slice(g.indexOf(a));if(-1!=e[b[b.length-1]].indexOf(b[0])){p.push([a,b[b.length-1]]);return}}g.push(a);for(b=0;b<c.length;b++)c[b]in e&&d(c[b],e[c[b]])}c||(c=A(a)[0]);var b=a.Aa;if(b.length&&-1!=b.indexOf(c)){for(var e={},h=0,f=0;f<b.length;f+=3)b[f+1]in e?e[b[f+1]].push(b[f]):e[b[f+1]]=
[b[f]],h++;var g=[],p=[];d(c,e[c]);for(f=0;f<p.length;f++)for(var v=h=0;v<b.length;v+=3)p[f][1]==b[v+1]&&p[f][0]==b[v]&&k(a,b[v],b[v+1],h),h++}};a.CN=function(a,c,d){var b=a.K;a=a.Aa;var e;e="digraph debug {\n    node [shape=box];\n";for(var h=0;h<b.length;h+=2){var f=b[h],g=b[h+1],g=c?c(f,g):String(f);e+="    ";e+=String(f)+' [label="'+g.replace(/\"/g,'\\"')+'"];\n'}for(h=0;h<a.length;h+=3)c=a[h],b=a[h+1],g=a[h+2],e+="    ",e+=String(c)+" -> "+String(b),d&&(e+=' [label="'+d(c,b,g)+'"]'),e+=";\n";
return e+="}"}};b4w.module.__nodemat=function(a,l){function m(a,c,d,e,h){var f=xa.o(),f=k(c,h,f.uuid);if(f in za)return za[f];var n={Pa:null,id:f,TB:!0};if("SHADOW"!=h&&"COLOR_ID"!=h){c=Q.create();for(var u=a.nodes,y=0;y<u.length;y++)if(null==K(c,u[y],0,e,h))return za[f]=null,n;if(d&&-1==p(a,c,"GROUP_OUTPUT","group"))return n;y=va(c);u=d?a.links:a.links.slice();if(!ga(c,u,y))return n;if(d)return n.Pa=c,n;for(y=0;y<u.length;y++){d=u[y];for(var t=z(d.from_node,c),C=z(d.to_node,c),S=0;S<t.length;S++)for(var l=0;l<C.length;l++){var L=
t[S],E=C[l],R=Q.Ra(c,L),X=Q.Ra(c,E);if(!ea(c,L,E,R,X,d))return za[f]=null,n}}g(c);a="GLOW"==h?p(a,c,"B4W_GLOW_OUTPUT","material",!0):p(a,c,"OUTPUT","material",!1,!0);-1==a&&(c=r(),a=0);A(c);a=Q.Ys(c,a,Q.tp);b(a,e);w(a);N(a);v(a);q(a,e,h);ha(a)}else e=m(a,c,d,e,"MAIN"),e=Q.clone(e.Pa,function(a){var c=da.hn(a);c.L=da.ia(a.L);c.Sa=da.ia(a.Sa);return c}),a=p(a,e,"OUTPUT","material",!1,!0),B(e,a),a=Q.Ys(e,a,Q.tp),w(a);n.Pa=a;return za[f]=n}function b(a,c){var d=[];Q.ma(a,function(a,c){"MATERIAL"!=c.type&&
"MATERIAL_EXT"!=c.type||d.push({SQ:a,node:c})});for(var b=0;b<d.length;++b){var h=d[b].SQ,f=d[b].node,n=Q.Wn(a);Q.Ck(a,n,f.data.EQ);var g=Q.Wn(a);Q.Ck(a,g,f.data.FQ);Q.Wc(a,n,g,[4,2]);for(var k={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},p=Q.sr(a,h),u=[],y=[],v=[],t={},q=0;q<p;q++){var K=Q.wj(a,h,q);K in t||(t[K]=0);var m=Q.me(a,K,h,t[K]++);u.push([K,h,m]);var C=k[m[1]];if(C)switch(C[0]){case "MATERIAL_END":y.push([K,g,[m[0],C[1]]]);
break;case "LIGHTING_APPLY":v.push([K,[m[0],C[1]]])}else y.push([K,n,m])}e(a,f.data.value,n,g,v,c);for(q=0;q<u.length;q++)Q.ts(a,u[q][0],u[q][1],u[q][2]);for(q=0;q<y.length;q++)Q.Wc(a,y[q][0],y[q][1],y[q][2]);f=Q.ng(a,h);n=[];k=[];p={};for(q=0;q<f;q++)u=Q.fg(a,h,q),u in p||(p[u]=0),m=Q.me(a,h,u,p[u]++),n.push([h,u,m]),k.push([g,u,m]);for(q=0;q<n.length;q++)Q.ts(a,n[q][0],n[q][1],n[q][2]);for(q=0;q<k.length;q++)Q.Wc(a,k[q][0],k[q][1],k[q][2]);Q.Kf(a,h)}}function e(a,c,d,b,e,h){var f={name:"LIGHTING_AMBIENT",
type:"LIGHTING_AMBIENT"},n=K(a,f,0,h,null),g=n;x(a,d,n,"E");x(a,d,n,"A");x(a,d,n,"D");n=xa.o();n=ua.Gb(n,"LAMP",ua.oc);if(!c.Fe)for(var k,p,u=0;u<n.length;u++){var y=n[u].$b,f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};k=K(a,f,0,h,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};p=K(a,f,0,h,null);x(a,g,p,"color");x(a,g,p,"specular");x(a,k,p,"ldir");x(a,d,p,"normal");x(a,d,p,"D");x(a,d,p,"S");x(a,k,p,"lcolorint");x(a,d,k,"shadow_factor");g="COOKTORR"==c.dm?"SPECULAR_PHONG":"SPECULAR_"+c.dm;f=
{name:g,type:g};f=K(a,f,0,h,null);x(a,k,f,"ldir");x(a,k,f,"lfac");x(a,d,f,"normal");x(a,f,p,"sfactor");"SPECULAR_PHONG"!=g&&"SPECULAR_BLINN"!=g||x(a,k,f,"norm_fac");x(a,d,f,"sp_params");g="HEMI"==y.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+c.Cn;f={name:g,type:g};f=K(a,f,0,h,null);x(a,k,f,"ldir");x(a,k,f,"lfac");x(a,d,f,"normal");x(a,k,f,"norm_fac");x(a,f,p,"lfactor");"DIFFUSE_LAMBERT"!=g&&x(a,d,f,"dif_params");for(k=0;k<e.length;k++)Q.Wc(a,e[k][0],p,e[k][1]);g=p}x(a,g,b,"color");x(a,g,b,"specular")}function x(a,
c,d,b){for(var e=Q.Ra(a,c),h=Q.Ra(a,d),f,n=0;n<h.L.length;n++)if(b==h.L[n].identifier){f=n;break}for(var g,n=0;n<e.Sa.length;n++)if(b==e.Sa[n].identifier){g=n;break}void 0!=f&&void 0!=g&&Q.Wc(a,c,d,[g,f])}function k(a,c,d){switch(c){case "GLOW":return a+d+"11";case "COLOR_ID":case "SHADOW":return a+d+"00";default:return a+d+"10"}}function B(a,c){Q.Pf(a,function(d,b,e){var h=Q.Ra(a,b);b==c&&"Color"==h.L[e[1]].identifier&&Q.ts(a,d,b,e)})}function r(){var a=Q.create(),c={data:null,Nb:[],Fa:[],L:[{Ya:new Float32Array([0,
0,0]),identifier:"Color",Yb:!1,name:"Color"},{Ya:1,identifier:"Alpha",Yb:!1,name:"Alpha"}],Sa:[],type:"OUTPUT",Ji:[]};Q.Ck(a,0,c);return a}function w(a){Q.ma(a,function(c,d){for(var b=d.L,e=d.Sa,h=0;h<b.length;h++)f(a,b[h],c,h,1);for(h=0;h<e.length;h++)f(a,e[h],c,h,0)})}function f(a,c,d,b,e){if(c.Yb){var h=!0;Q.Pf(a,function(a,c,f){if(!e&&a==d&&f[0]==b||e&&c==d&&f[1]==b)h=!1});h&&(c.Yb=!1)}}function q(a,c,d){var b=[];Q.Pf(a,function(e,h,f){var n=Q.Ra(a,e),g=Q.Ra(a,h),n=da.di(n.Sa[f[0]].Ya),g=da.di(g.L[f[1]].Ya);
if(n!=g){var k,p={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},u={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};n&&!g?k=R("vector_to_scalar","B4W_VECTOSCAL",[p],[u]):!n&&g&&(k=R("scalar_to_vector","B4W_SCALTOVEC",[u],[p]));K(a,k,0,c,d);b.push([e,h,a.K[a.K.length-2],f])}});for(var e=0;e<b.length;++e)Q.ts(a,b[e][0],b[e][1],b[e][3]),Q.Wc(a,b[e][0],b[e][2],[b[e][3][0],0]),Q.Wc(a,b[e][2],b[e][1],[0,b[e][3][1]])}function g(a){var c=[];Q.ma(a,function(d,b){switch(b.type){case "B4W_TRANSLUCENCY":Q.Pf(a,
function(a,e,h){a==d&&"Translucency"==b.Sa[h[0]].name&&c.push(a,e,[h[0]+1,h[1]+1])})}});for(var d=0;d<c.length;d+=3)Q.Wc(a,c[d],c[d+1],c[d+2])}function z(a,c){var d=[];Q.ma(c,function(c,b){b.name==a.name&&d.push(c)});if(d.length)return d;da.l("Node not found")}function A(a){var c=[];Q.ma(a,function(a,d){"B4W_PARALLAX"!=d.type&&"REROUTE"!=d.type||c.push(a,d)});for(var d=0;d<c.length;d+=2){var b=c[d],e=c[d+1];if("B4W_PARALLAX"==e.type){var h=J(a,b);if(-1!=h){var f=Q.wj(a,h,0);Q.ni(a,h,b,-1);-1!=f&&
Q.ni(a,f,h,-1);b=Q.Ra(a,h);e.data=b.data;e.Fa[0]=b.Fa[0];Q.Kf(a,h)}e.L.splice(1,1)}else if("REROUTE"==e.type){for(var e=Q.wj(a,b,0),n=Q.ng(a,b),h=[],f=[],g=[],k=0;k<n;k++){var p=Q.fg(a,b,k),u=f.indexOf(p);-1!=u?g[u]+=1:(f.push(p),g.push(1),h.push(b,p))}if(-1!=e)for(n=Q.me(a,e,b,0)[0],k=0;k<f.length;k++)for(p=0;p<g[k];p++)u=Q.me(a,b,f[k],p)[1],Q.Wc(a,e,f[k],[n,u]);for(k=0;k<h.length;k+=2)Q.ni(a,h[k],h[k+1],-1)}}}function J(a,c){for(var d=a.Aa,b=0;b<d.length;b+=3)if(d[b+1]==c&&1==d[b+2][1])return d[b];
return-1}function N(a){G(a);I(a);F(a)}function F(a){var c=[],d="",b="",e={};Q.ma(a,function(a,h){if("GEOMETRY_UV"==h.type||"UVMAP"==h.type||"TEX_COORD_UV"==h.type){c.push(a,h);var f=h.data.value;d?d==f||b||(b=f,e[b]=0):(d=f,e[d]=0);e[f]++}});for(var f in e)if(2>e[f]){for(var n=0;n<c.length;n+=2)c[n+1].data.value==f&&c.splice(n,2);delete e[f];d==f&&(d=b,b="");b==f&&(b="")}if(!(3>c.length)){var n={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},g={default_value:[0,0,0],identifier:"UV_cycles",
is_linked:!1,name:"UV_cycles"};f=R("merged_uv","UV_MERGED",[],[n,g]);f.uv_layer=d;K(a,f,0,"",void 0);var k=a.K[a.K.length-2];f=a.K[a.K.length-1];if(b){g=R("merged_uv","UV_MERGED",[],[n,g]);g.uv_layer=b;K(a,g,0,"",void 0);var p=a.K[a.K.length-2],g=a.K[a.K.length-1]}else g=null;for(var u=-1,y=null,n=0;n<c.length;n+=2){var v=c[n],t=c[n+1];h(t,c[1])?(u=k,y=f):g&&(u=p,y=g);for(var q=[],m=Q.ng(a,v),C={},S=0;S<m;S++){var r=Q.fg(a,v,S);r in C||(C[r]=0);var z=Q.me(a,v,r,C[r]++);q.push(v,r,z);z=z.splice(0,
z.length);switch(t.type){case "GEOMETRY_UV":z[0]=0;y.Sa[0].Yb=!0;break;case "UVMAP":case "TEX_COORD_UV":z[0]=1,y.Sa[1].Yb=!0}Q.Wc(a,u,r,z)}for(var S=0;S<q.length;S+=3)Q.ni(a,q[S],q[S+1],0);Q.Kf(a,v)}}}function G(a){var c=[];Q.ma(a,function(a,d){"GEOMETRY_VC"!=d.type&&"GEOMETRY_NO"!=d.type&&"GEOMETRY_FB"!=d.type&&"GEOMETRY_VW"!=d.type&&"GEOMETRY_GL"!=d.type&&"GEOMETRY_LO"!=d.type&&"GEOMETRY_OR"!=d.type||c.push(a,d)});for(var b=[],e=0;e<c.length;e+=2){for(var h=c[e],f=c[e+1],n=!0,g=0;g<b.length;g++){var k=
b[g];if(d(f,k.Zd)){n=[];g=Q.ng(a,h);for(y=0;y<g;y++){var p=Q.fg(a,h,y),u=Q.me(a,h,p,0);n.push(h,p,u);Q.Wc(a,k.id,p,u)}for(var y=0;y<n.length;y+=3)Q.ni(a,n[y],n[y+1],0);Q.Kf(a,h);n=!1;break}}n&&(k={id:h,Zd:f},b.push(k))}}function D(a){for(var c={},d=0;d<a.K.length;d+=2){var b=a.K[d];c[b]={Um:{},GE:!1}}for(d=0;d<a.Aa.length;d+=3)c[a.Aa[d+1]].Um[a.Aa[d]]=!0;for(b in c)H(b,c);for(b in c)c[b]=Object.keys(c[b].Um).map(function(a){return parseInt(a)});return c}function H(a,c){var d=c[a];if(!d.GE){var b=
da.ia(d),e;for(e in d.Um){H(e,c);var d=c[e],h;for(h in d.Um)b.Um[h]=!0}b.GE=!0;c[a]=b}}function I(a){var c=[];Q.ma(a,function(a,d){"TEXTURE_COLOR"!=d.type&&"TEXTURE_NORMAL"!=d.type||c.push(a,d)});if(c.length){for(var b=D(a),e=[],h=0;h<c.length;h+=2){for(var f=c[h],n=c[h+1],g=!0,k=0;k<e.length;k++){var p=e[k];if(!(3<=p.Al.length||!d(n,p.Zd)||-1<b[f].indexOf(p.id)||-1<b[p.id].indexOf(f))){for(var u=!1,y=0;y<p.Al.length;y++){var v=p.Al[y].id;if(-1<b[f].indexOf(v)||-1<b[v].indexOf(f)){u=!0;break}}if(!u){for(var k=
[],v=Q.sr(a,f),t={},y=0;y<v;y++)u=Q.wj(a,f,y),u in t||(t[u]=0),g=Q.me(a,u,f,t[u]++),k.push(u,f,g);for(var v=[],t=Q.ng(a,f),q={},y=0;y<t;y++)u=Q.fg(a,f,y),u in q||(q[u]=0),g=Q.me(a,f,u,q[u]++),v.push(f,u,g);g=k.concat(v);for(y=0;y<g.length;y+=3)Q.ni(a,g[y],g[y+1],0);Q.Kf(a,f);y={id:f,Zd:n,UN:k,VN:v};p.Al.push(y);g=!1;break}}}g&&(p={id:f,Zd:n,Al:[]},e.push(p))}for(h=0;h<e.length;h++){p=e[h];b=p.Al.length;for(k=0;k<b;k++){n=p.Al[k];y=n.Zd;f=n.UN;n=n.VN;p.Zd.L[k+1].Yb=y.L[0].Yb;p.Zd.L[k+1].Ya=y.L[0].Ya;
p.Zd.Sa[2*(k+1)].Yb=y.Sa[0].Yb;p.Zd.Sa[2*(k+1)].Ya=y.Sa[0].Ya;p.Zd.Sa[2*(k+1)+1].Yb=y.Sa[1].Yb;p.Zd.Sa[2*(k+1)+1].Ya=y.Sa[1].Ya;for(y=0;y<f.length;y+=3)u=f[y],g=f[y+2],g[1]+=k+1,Q.Wc(a,u,p.id,g);for(y=0;y<n.length;y+=3)u=n[y+1],g=n[y+2],g[0]+=2*(k+1),Q.Wc(a,p.id,u,g);p.Zd.Nb.push(["USE_uv"+(k+2),1])}Q.Kf(a,p.id);Q.Ck(a,p.id,p.Zd)}}}function d(a,c){if(a.type!==c.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==c.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.uuid==c.data.value.uuid;default:return!1}}function h(a,c){var d=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=d.indexOf(a.type)&&-1!=d.indexOf(c.type)?a.data.value==c.data.value:!1}function v(a){var d=[],b=[];Q.ma(a,function(a,c){"GEOMETRY_VC"==c.type&&d.push(a,c);"GEOMETRY_VW"==c.type&&b.push(a,c)});M(a,d);c(a,b)}function M(a,c){for(var d=0;d<c.length;d+=2){for(var b=c[d],e=c[d+1],h=!1,f=[],n=[],g=[[],[],[]],k=Q.ng(a,b),p=0;p<k;p++){var u=
Q.fg(a,b,p);if("SEPRGB"!=Q.Ra(a,u).type){h=!1;break}f.push(b,u);for(var y={},v=Q.ng(a,u),h=0;h<v;h++){var t=Q.fg(a,u,h);t in y||(y[t]=0);var q=Q.me(a,u,t,y[t]++);f.push(u,t);g[q[0]].push(b,t,q)}n.push(u);h=!0}if(h){for(p=b=k=0;p<g.length;p++)g[p].length&&(k++,b|=1<<2-p);if(k){e.type+=k;e.Sa=[];for(p=0;p<g.length;p++)if(g[p].length)for(e.Sa.push({Ya:0,identifier:"RGB"[p],Yb:!0,name:"RGB"[p]}),h=0;h<g[p].length;h+=3)g[p][h+2][0]=da.Po(b,p);for(p=0;p<f.length;p+=2)Q.ni(a,f[p],f[p+1],0);for(p=0;p<n.length;p++)Q.Kf(a,
n[p]);for(p=0;p<g.length;p++)for(h=0;h<g[p].length;h+=3)Q.Wc(a,g[p][h],g[p][h+1],g[p][h+2])}}}}function c(a,c){for(var d=0;d<c.length;d+=2){for(var b=c[d],e=!0,h=[],f=Q.ng(a,b),n=0;n<f;n++){var g=Q.fg(a,b,n);if("B4W_REFLECT"==Q.Ra(a,g).type){var k=Q.me(a,b,g,0),p=Q.me(a,b,g,1);k&&1==k[1]||p&&1==p[1]?e=!1:h.push(b,g)}else e=!1}for(n=0;n<h.length;n+=2)f=a,k=h[n],g=h[n+1],p=Q.Ra(f,g),p.type+="_WORLD",Q.ni(f,k,g,0),p.L.splice(0,1),k=Q.wj(f,g,0),k!=Q.Au&&(Q.me(f,k,g,0)[1]=0);e&&Q.Kf(a,b)}}function p(a,
c,d,b,e,h){a=a.nodes;for(var f=null,n=0;n<a.length;n++){var g=a[n];e?"GROUP"==g.type&&g.node_tree_name==d&&(f=g):g.type==d&&(f=g)}return f?z(f,c)[0]:(h||sa.error('No "'+d+'" node in node '+b),-1)}function R(a,c,d,b){return{name:a,type:c,inputs:d,outputs:b}}function K(a,c,d,b,e){var h=c.name,f=c.type,g=[],k=[],p=[],u=[],v=null,q=[];switch(f){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":k=
ba(c);p=aa(c);sa.warn(f+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":k=ba(c);p=aa(c);break;case "UVMAP":var m=c.uv_layer;m||(f="EMPTY_UV");if("EMPTY_UV"!=f){var v=C("param_"+f+"_a"),S=C("param_"+f+"_v");g.push(fa(v));g.push(fa(S));u.push(fa(S));v={name:v,value:m}}p=aa(c);break;case "UV_MERGED":v=C("param_UV_MERGED_a");S=C("param_UV_MERGED_v");g.push(fa(v));g.push(fa(S));p.push(Y(c,"UV_geom"));p.push(Y(c,"UV_cycles"));u.push(fa(S));v={name:v,value:c.uv_layer};
break;case "CAMERA":k=[];p=aa(c);break;case "COMBRGB":case "COMBHSV":k=ba(c);p=aa(c);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==f?(ja(c,0,0)&&q.push(["READ_R",1]),ja(c,1,0)&&q.push(["READ_G",1]),ja(c,2,0)&&q.push(["READ_B",1]),ja(c,3,0)&&q.push(["READ_A",1])):(ja(c,0,-1)&&q.push(["READ_R",1]),ja(c,1,-1)&&q.push(["READ_G",1]),ja(c,2,-1)&&q.push(["READ_B",1]));k=ba(c);p=aa(c);v={value:c};break;case "PARTICLE_INFO":k=ba(c);p=aa(c);for(S=0;S<c.outputs.length;S++){var r=c.outputs[S],z=r.identifier,
l=fa("v_param_PART_INFO_"+z.replace(" ",""));if(r.is_linked)switch(z){case "Size":q.push(["PART_INFO_SIZE",U.H(1)]);break;case "Age":q.push(["PART_INFO_AGE",U.H(1)]);break;case "Lifetime":q.push(["PART_INFO_LT",U.H(1)]);break;case "Location":q.push(["PART_INFO_LOC",U.H(1)]);break;case "Index":v=m=fa("a_param_PART_INFO_"+r.identifier.replace(" ",""));q.push(["PART_INFO_IND",U.H(1)]);break;case "Velocity":q.push(["PART_INFO_VEL",U.H(1)]);break;case "Angular Velocity":q.push(["PART_INFO_A_VEL",U.H(1)])}"Age"!=
z&&"Lifetime"!=z&&"Size"!=z&&(g.push(l),u.push(l))}m&&g.push(m);break;case "GEOMETRY":if(!L(c))return!0;f=n(c,d);if(!f)return sa.error("Geometry output is not supported"),null;switch(f){case "GEOMETRY_UV":(m=c.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(v=C("param_GEOMETRY_UV_a"),S=C("param_GEOMETRY_UV_v"),g.push(fa(v)),g.push(fa(S)),u.push(fa(S)),v={name:v,value:m});p.push(Y(c,"UV"));break;case "GEOMETRY_VC":(m=c.color_layer)||(f="EMPTY_VC");"EMPTY_VC"!=f&&(v=C("param_GEOMETRY_VC_a"),S=C("param_GEOMETRY_VC_v"),
g.push(fa(v)),g.push(fa(S)),u.push(fa(S)),v={name:v,value:m});p.push(Y(c,"Vertex Color"));break;case "GEOMETRY_NO":p.push(Y(c,"Normal"));break;case "GEOMETRY_FB":p.push(Y(c,"Front/Back"));break;case "GEOMETRY_VW":p.push(Y(c,"View"));break;case "GEOMETRY_GL":p.push(Y(c,"Global"));break;case "GEOMETRY_LO":p.push(Y(c,"Local"));break;case "GEOMETRY_OR":m=C("param_GEOMETRY_OR_v"),g.push(fa(m)),p.push(Y(c,"Orco")),u.push(fa(m))}break;case "TEX_COORD":if(!L(c))return!0;f=T(c,d);if(!f)return sa.error("Texture coordinate output is not supported"),
null;switch(f){case "TEX_COORD_UV":(m=c.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(v=C("param_TEX_COORD_UV_a"),S=C("param_TEX_COORD_UV_v"),g.push(fa(v)),g.push(fa(S)),u.push(fa(S)),v={name:v,value:c.uv_layer});p.push(Y(c,"UV"));break;case "TEX_COORD_NO":p.push(Y(c,"Normal"));break;case "TEX_COORD_GE":m=C("param_TEX_COORD_GE_v");g.push(fa(m));p.push(Y(c,"Generated"));u.push(fa(m));break;case "TEX_COORD_OB":p.push(Y(c,"Object"));sa.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');
break;case "TEX_COORD_CA":p.push(Y(c,"Camera"));break;case "TEX_COORD_WI":p.push(Y(c,"Window"));sa.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":p.push(Y(c,"Reflection")),sa.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;case "GROUP":m=c.node_tree_name;switch(m){case "B4W_LINEAR_TO_SRGB":if(!t(c,[1],[1])){v=y(c,b,e);break}f="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!t(c,
[1],[1])){v=y(c,b,e);break}f="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!t(c,[1],[1])){v=y(c,b,e);break}f="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!t(c,[1,1],[1])){v=y(c,b,e);break}f="B4W_REFLECT";break;case "B4W_REFRACTION":if(!t(c,[1,0],[1])){v=y(c,b,e);break}f="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!t(c,[1,1,0,0,0],[1])){v=y(c,b,e);break}f="B4W_PARALLAX";S=C("temp_texture");u.push(fa(S));break;case "B4W_CLAMP":if(!t(c,[1],[1])){v=y(c,b,e);break}f="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!t(c,
[0,0,0,0,0],[0])){v=y(c,b,e);break}f="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!t(c,[],[0])){v=y(c,b,e);break}f="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!t(c,[0,0,0],[0])){v=y(c,b,e);break}f="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":f="B4W_GLOW_OUTPUT";break;default:v=y(c,b,e)}k=ba(c);p=aa(c);"B4W_TRANSLUCENCY"==m&&(m=W("TranslucencyParams","TranslucencyParams",[0,0,0,0]),m.Yb=p[0].Yb,p.push(m));break;case "LAMP":v=c.lamp;if(!v)return sa.error("There is no lamp in node: "+c.name),null;p.push(Y(c,
"Color"));p.push(Y(c,"Light Vector"));p.push(Y(c,"Distance"));p.push(Y(c,"Visibility Factor"));v.uuid in ma?q.push(["LAMP_INDEX",String(ma[v.uuid])]):(ma[v.uuid]=Ja,q.push(["LAMP_INDEX",String(Ja++)]));v=ma;break;case "LIGHTING_AMBIENT":k=[W("E","E",[0,0,0],!0),W("A","A",[0,0,0],!0),W("D","D",[0,0,0],!0)];p=[W("color","color",[0,0,0],!0),W("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":p=[W("E","E",[0,0,0],!0),W("A","A",[0,0,0],!0),W("D","D",[0,0,0],!0),W("S","S",[0,0,0],!0),W("normal",
"normal",[0,0,0],!0),W("dif_params","dif_params",[0,0],!0),W("sp_params","sp_params",[0,0],!0),W("shadow_factor","shadow_factor",0,!0),W("translucency_color","translucency_color",0,!0),W("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":k=[W("color","color",[0,0,0],!0),W("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":k=[W("shadow_factor","shadow_factor",0,!0)];p=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("lcolorint","lcolorint",[0,0,
0],!0),W("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":k=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("normal","normal",[0,0,0],!0),W("norm_fac","norm_fac",0,!0)];p=[W("lfactor","lfactor",0,!0)];break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":k=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("normal","normal",[0,0,0],!0),W("norm_fac","norm_fac",0,!0),W("dif_params","dif_params",[0,0],!0)];p=[W("lfactor","lfactor",
0,!0)];break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":k=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("normal","normal",[0,0,0],!0),W("norm_fac","norm_fac",0,!0),W("sp_params","sp_params",[0,0],!0)];p=[W("sfactor","sfactor",0,!0)];break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":k=[W("ldir","ldir",[0,0,0],!0),W("lfac","lfac",[0,0],!0),W("normal","normal",[0,0,0],!0),W("sp_params","sp_params",[0,0],!0)];p=[W("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":k=[W("color","color",
[0,0,0,0],!0),W("specular","specular",[0,0,0],!0),W("lfactor","lfactor",0,!0),W("sfactor","sfactor",0,!0),W("ldir","ldir",[0,0,0],!0),W("normal","normal",[0,0,0],!0),W("translucency_params","translucency_params",[0,0,0,0],!0),W("D","D",[0,0,0],!0),W("S","S",[0,0,0],!0),W("lcolorint","lcolorint",[0,0,0],!0),W("translucency_color","translucency_color",0,!0)];p=[W("color","color",[0,0,0,0],!0),W("specular","specular",[0,0,0],!0)];break;case "NORMAL":k=ba(c);p=aa(c);m=Y(c,"Normal");u.push(fa(C("param_NORMAL_Normal"),
m.Ya,3));break;case "MAPPING":m=c.vector_type;f="MAPPING";k.push(V(c,"Vector"));p.push(Y(c,"Vector"));var S=c.rotation,r=c.scale,z=c.translation,l=Ba.create(),A=da.cO(S);"TEXTURE"==m&&(r[0]=r[0]||1,r[1]=r[1]||1,r[2]=r[2]||1);var E=new Float32Array([r[0],0,0,0,r[1],0,0,0,r[2]]);Ba.multiply(A,E,l);l=da.DQ(l,ta.create());switch(m){case "POINT":l[12]=z[0];l[13]=z[1];l[14]=z[2];break;case "TEXTURE":l[12]=z[0];l[13]=z[1];l[14]=z[2];l=ta.invert(l,l);break;case "NORMAL":ta.invert(l,l),ta.transpose(l,l)}switch(m){case "NORMAL":q.push(["MAPPING_IS_NORMAL",
1]);case "TEXTURE":q.push(["MAPPING_TRS_MATRIX",U.H(l,16)]);break;case "POINT":0!==P.length(S)?q.push(["MAPPING_TRS_MATRIX",U.H(l,16)]):(0!==P.length(r)&&q.push(["MAPPING_SCALE",U.H(r,3)]),0!==P.length(z)&&q.push(["MAPPING_TRANSLATION",U.H(z,3)]));break;case "VECTOR":0!==P.length(S)?q.push(["MAPPING_TRS_MATRIX",U.H(l,16)]):0!==P.length(r)&&q.push(["MAPPING_SCALE",U.H(r,3)])}c.use_min&&q.push(["MAPPING_MIN_CLIP",U.H(c.min,3)]);c.use_max&&q.push(["MAPPING_MAX_CLIP",U.H(c.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":v=
[];m=[];S=[];r=[W("E","E",[0,0,0],!0),W("A","A",[0,0,0],!0),W("D","D",[0,0,0],!0),W("S","S",[0,0,0],!0),W("normal","normal",[0,0,0],!0),W("dif_params","dif_params",[0,0],!0),W("sp_params","sp_params",[0,0],!0),W("shadow_factor","shadow_factor",0,!0)];z=[W("color","color",[0,0,0],!0),W("specular","specular",[0,0,0],!0),W("normal","normal",[0,0,0],!0)];l=[Y(c,"Color"),Y(c,"Alpha"),Y(c,"Normal")];A=[];E=V(c,"Color");E.Ya.splice(3);S.push(E);k.push(E);E=V(c,"Spec");E.Ya.splice(3);S.push(E);k.push(E);
(E=V(c,"DiffuseIntensity"))||(E=V(c,"Refl"));E.Ya=c.diffuse_intensity;S.push(E);k.push(E);var w=V(c,"Normal");w.Ya.splice(3);S.push(w);k.push(w);"MATERIAL_EXT"==f?((E=V(c,"Emit"))||(E=W("Emit","Emit",0)),S.push(E),k.push(E),(E=V(c,"Translucency"))?(E.Ya=0,E.name="Translucency",E.identifier="Translucency"):E=W("Translucency","Translucency",0),k.push(E),(E=V(c,"Translucency"))?(E.Ya=[0,0,0,0],E.name="TranslucencyParams",E.identifier="TranslucencyParams"):E=W("TranslucencyParams","TranslucencyParams",
[0,0,0,0]),k.push(E),p=V(c,"Reflectivity"),E=V(c,"Ray Mirror"),p?(E=p,p="Reflectivity"):E?p="Ray Mirror":(E=p,p="Reflectivity"),E||(E=W(p,p,0)),k.push(E),z.push(E),(E=V(c,"SpecTra"))||(E=W("SpecTra","SpecTra",0)),k.push(E),z.push(E),(E=V(c,"Alpha"))||(E=W("Alpha","Alpha",c.alpha)),k.push(E),z.push(E),l.push(Y(c,"Diffuse")),l.push(Y(c,"Spec")),v.push(["MATERIAL_EXT",1]),m.push(["MATERIAL_EXT",1])):(S.push(W("emit_intensity","emit_intensity",0)),z.push(W("reflect_factor","reflect_factor",0)),z.push(W("specular_alpha",
"specular_alpha",0)),z.push(W("alpha_in","alpha_in",0)),l.push(W("diffuse_out","diffuse_out",0)),l.push(W("spec_out","spec_out",0)),v.push(["MATERIAL_EXT",0]),m.push(["MATERIAL_EXT",0]));A.push(fa(C("param_MATERIAL_alpha"),c.alpha));A.push(fa(C("param_MATERIAL_spec_alpha"),c.specular_alpha));p=l;w.Yb&&v.push(["USE_MATERIAL_NORMAL",1]);c.use_diffuse&&(v.push(["USE_MATERIAL_DIFFUSE",1]),m.push(["USE_MATERIAL_DIFFUSE",1]));c.use_specular&&m.push(["USE_MATERIAL_SPECULAR",1]);var E=[],R=0;switch(c.specular_shader){case "COOKTORR":case "PHONG":w=
c.specular_hardness;break;case "WARDISO":w=c.specular_slope;break;case "TOON":w=c.specular_toon_size;R=c.specular_toon_smooth;break;case "BLINN":w=c.specular_ior;R=c.specular_hardness;break;default:sa.error("unsupported specular shader: "+c.specular_shader+' (material "'+c.material_name+'")'),w=c.specular_hardness}var X,M;switch(c.diffuse_shader){case "LAMBERT":M=X=0;break;case "OREN_NAYAR":X=c.roughness;M=0;break;case "FRESNEL":X=c.diffuse_fresnel;M=c.diffuse_fresnel_factor;break;case "MINNAERT":X=
c.darkness;M=0;break;case "TOON":X=c.diffuse_toon_size;M=c.diffuse_toon_smooth;break;default:sa.error("unsupported diffuse shader: "+c.diffuse_shader+' (material "'+c.material_name+'")'),M=X=0}E.push(fa(C("param_MATERIAL_diffuse"),[X,M],2));E.push(fa(C("param_MATERIAL_spec"),[c.specular_intensity,w,R],3));v.push(["SHADELESS_MAT",c.use_shadeless?1:0]);w={name:c.name,value:{dm:c.specular_shader,Cn:c.diffuse_shader,Fe:c.use_shadeless}};v={name:c.name,value:{dm:c.specular_shader,Cn:c.diffuse_shader,Fe:c.use_shadeless},
EQ:{name:"material_begin",type:"MATERIAL_BEGIN",L:S,Sa:r,Fa:E,data:w,Nb:v,Ji:[]},FQ:{name:"material_end",type:"MATERIAL_END",L:z,Sa:l,Fa:A,data:w,Nb:m,Ji:[]}};break;case "MATH":switch(c.operation){case "ADD":f="MATH_ADD";break;case "SUBTRACT":f="MATH_SUBTRACT";break;case "MULTIPLY":f="MATH_MULTIPLY";break;case "DIVIDE":f="MATH_DIVIDE";break;case "SINE":f="MATH_SINE";break;case "COSINE":f="MATH_COSINE";break;case "TANGENT":f="MATH_TANGENT";break;case "ARCSINE":f="MATH_ARCSINE";break;case "ARCCOSINE":f=
"MATH_ARCCOSINE";break;case "ARCTANGENT":f="MATH_ARCTANGENT";break;case "POWER":f="MATH_POWER";break;case "LOGARITHM":f="MATH_LOGARITHM";break;case "MINIMUM":f="MATH_MINIMUM";break;case "MAXIMUM":f="MATH_MAXIMUM";break;case "ROUND":f="MATH_ROUND";break;case "LESS_THAN":f="MATH_LESS_THAN";break;case "GREATER_THAN":f="MATH_GREATER_THAN";break;case "MODULO":f="MATH_MODULO";break;case "ABSOLUTE":f="MATH_ABSOLUTE";break;default:return sa.error("Unsupported MATH operation: "+c.operation),null}q.push(["MATH_USE_CLAMP",
Number(c.use_clamp)]);k=ba(c);p=aa(c);break;case "MIX_RGB":switch(c.blend_type){case "MIX":f="MIX_RGB_MIX";break;case "ADD":f="MIX_RGB_ADD";break;case "MULTIPLY":f="MIX_RGB_MULTIPLY";break;case "SUBTRACT":f="MIX_RGB_SUBTRACT";break;case "SCREEN":f="MIX_RGB_SCREEN";break;case "DIVIDE":f="MIX_RGB_DIVIDE";break;case "DIFFERENCE":f="MIX_RGB_DIFFERENCE";break;case "DARKEN":f="MIX_RGB_DARKEN";break;case "LIGHTEN":f="MIX_RGB_LIGHTEN";break;case "OVERLAY":f="MIX_RGB_OVERLAY";break;case "DODGE":f="MIX_RGB_DODGE";
break;case "BURN":f="MIX_RGB_BURN";break;case "HUE":f="MIX_RGB_HUE";break;case "SATURATION":f="MIX_RGB_SATURATION";break;case "VALUE":f="MIX_RGB_VALUE";break;case "COLOR":f="MIX_RGB_COLOR";break;case "SOFT_LIGHT":f="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":f="MIX_RGB_LINEAR_LIGHT";break;default:return sa.error("Unsupported MIX_RGB blend type: "+c.blend_type),null}q.push(["MIX_RGB_USE_CLAMP",Number(c.use_clamp)]);k=ba(c);p=aa(c);break;case "OUTPUT":k=ba(c);p=[];break;case "RGB":m=b+"%join%"+c.name;
m={name:"-1",value:m};u.push(m);p.push(Y(c,"Color"));break;case "SEPRGB":case "SEPHSV":k=ba(c);p=aa(c);break;case "TEXTURE":f=O(c);if("TEXTURE_EMPTY"==f)p.push(Y(c,"Color")),p.push(Y(c,"Normal")),p.push(Y(c,"Value"));else if("TEXTURE_ENVIRONMENT"==f)k.push(V(c,"Vector")),p.push(Y(c,"Color")),p.push(Y(c,"Value"));else{if("TEXTURE_NORMAL"==f&&"ENVIRONMENT_MAP"==c.texture.type)return sa.error("Wrong output for ENVIRONMENT_MAP texture: "+c.name),null;for(v=0;4>v;++v)v?(E=W("Vector"+v,"Vector"+v,[0,0,
0]),"TEXTURE_COLOR"==f&&(S=W("Color"+v,"Color"+v,[0,0,0]),r=W("Value"+v,"Value"+v,0)),"TEXTURE_NORMAL"==f&&(S=W("Normal"+v,"Normal"+v,[0,0,0]),r=W("Value"+v,"Value"+v,0))):(E=V(c,"Vector"),"TEXTURE_COLOR"==f&&(S=Y(c,"Color"),r=Y(c,"Value")),"TEXTURE_NORMAL"==f&&(S=Y(c,"Normal"),r=Y(c,"Value"))),k.push(E),p.push(S),p.push(r)}S=C("param_TEXTURE_texture");u.push(fa(S));v={name:S,value:c.texture};break;case "VALTORGB":k=ba(c);p=aa(c);v={value:c};m=c.color_ramp.interpolation;"CONSTANT"!=m&&"LINEAR"!=m&&
sa.warn("Color Ramp node is not fully supported.");break;case "VALUE":f="VALUE";m=b+"%join%"+c.name;m={name:"-1",value:m};u.push(m);p.push(Y(c,"Value"));break;case "VECT_MATH":switch(c.operation){case "ADD":f="VECT_MATH_ADD";break;case "SUBTRACT":f="VECT_MATH_SUBTRACT";break;case "AVERAGE":f="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":f="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":f="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":f="VECT_MATH_NORMALIZE";break;default:return sa.error("Unsupported VECT_MATH operation: "+
c.operation),null}k=ba(c);p=aa(c);break;case "VECT_TRANSFORM":switch(c.vector_type){case "POINT":q.push(["VECTOR_TYPE",U.H(0)]);break;case "VECTOR":q.push(["VECTOR_TYPE",U.H(1)]);break;case "NORMAL":q.push(["VECTOR_TYPE",U.H(2)]);break;default:return sa.error("Unsupported VECT_TRANSFORM vector_type: "+c.vector_type),null}k=c.convert_from;p=c.convert_to;if("WORLD"==k)if("WORLD"==p)k=0;else if("OBJECT"==p)k=1;else if("CAMERA"==p)k=2;else return sa.error("Unsupported VECT_TRANSFORM convert_to: "+c.convert_to),
null;else if("OBJECT"==k)if("WORLD"==p)k=3;else if("OBJECT"==p)k=4;else if("CAMERA"==p)k=5;else return sa.error("Unsupported VECT_TRANSFORM convert_to: "+c.convert_to),null;else if("CAMERA"==k)if("WORLD"==p)k=6;else if("OBJECT"==p)k=7;else if("CAMERA"==p)k=8;else return sa.error("Unsupported VECT_TRANSFORM convert_to: "+c.convert_to),null;else return sa.error("Unsupported VECT_TRANSFORM convert_from: "+c.convert_from),null;q.push(["CONVERT_TYPE",U.H(k)]);k=ba(c);p=aa(c);break;default:k=ba(c),p=aa(c)}f=
{name:h,type:f,Ji:g,L:k,Sa:p,Fa:u,data:v,Nb:q};h=Q.Wn(a);Q.Ck(a,Q.Wn(a),f);if(!(f="GEOMETRY"!=c.type&&"TEX_COORD"!=c.type)){a:{f=c.outputs;for(u=g=0;u<f.length;u++)if(f[u].is_linked&&g++>d){f=!0;break a}f=!1}f=!f}return f||null!=K(a,c,++d,b,e)?h:null}function t(a,c,d){for(var b=a.inputs,e=a.outputs,h=a.node_tree_name,f=0;f<c.length;f++){var n=b[f],g=c[f];if(!n||n.default_value instanceof Array!=g)return sa.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',h,'".Processing as general node group.'),
!1}for(f=0;f<d.length;f++)if(c=e[f],b=d[f],!c||c.default_value instanceof Array!=b)return sa.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',h,'".Processing as general node group.'),!1;return!0}function y(a,c,d){var b=a.node_group.node_tree,e={},h;for(h in b)if("links"==h||"nodes"==h){e[h]=[];for(var f=0;f<b[h].length;f++){e[h][f]={};for(var n in b[h][f])if("links"==h){e[h][f][n]={};for(var g in b[h][f][n])e[h][f][n][g]=u(b[h][f][n][g])}else e[h][f][n]=u(b[h][f][n])}}else e[h]=
u(b[h]);b=a.node_tree_name;if("B4W_REPLACE"==b||"B4W_LEVELS_OF_QUALITY"==b)h=R("Group input","GROUP_INPUT",[],a.inputs),f=R("Group output","GROUP_OUTPUT",a.outputs,[]),n=null,n="B4W_REPLACE"==b||"B4W_LEVELS_OF_QUALITY"==b&&(Da.quality==Z.Ri||Da.rw)?{from_node:h,from_socket:h.outputs[1],to_node:f,to_socket:f.inputs[0]}:{from_node:h,from_socket:h.outputs[0],to_node:f,to_socket:f.inputs[0]},e.nodes=[h,f],e.links=[n];b=a.name;h=e.nodes;f=e.links;for(n=0;n<h.length;n++)h[n].name=ia(h[n].type,b,h[n].name);
for(n=0;n<f.length;n++)f[n].from_node.name=ia(f[n].from_node.type,b,f[n].from_node.name),f[n].to_node.name=ia(f[n].to_node.type,b,f[n].to_node.name);return{QQ:m(e,a.node_group.uuid,!0,c,d).Pa,RQ:e.links}}function u(a){var c=typeof a;return"string"!=c&&"number"!=c&&"boolean"!=c&&a?da.hn(a):a}function C(a){ca[a]||(ca[a]=0);var c=a+"_"+ca[a],c=c.replace(/ /g,"_").replace(/\//g,"_");ca[a]++;return c}function L(a){a=a.outputs;for(var c=0;c<a.length;c++)if(a[c].is_linked)return!0;return!1}function n(a,
c){for(var d=a.outputs,b=0,e=0;e<d.length;e++){var h=d[e];if(h.is_linked&&!(b++<c))switch(h.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function T(a,c){for(var d=a.outputs,b=0,e=0;e<d.length;e++){var h=d[e];if(h.is_linked&&!(b++<c))switch(h.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function O(a){if(!a.texture)return"TEXTURE_EMPTY";for(var c=a.outputs,d=!1,b=!1,e=!1,h=0;h<c.length;h++){var f=c[h];if(f.is_linked)switch(f.identifier){case "Color":d=!0;break;case "Normal":b=!0;break;case "Value":e=!0;break;default:da.l("Unknown texture output")}}if(d)return b&&
sa.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(b)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function V(a,c){for(var d=a.inputs,b=0;b<d.length;b++){var e=d[b];if(e.identifier==c)return la(e)}return null}function Y(a,c){for(var d=a.outputs,b=0;b<d.length;b++){var e=d[b];if(e.identifier==c)return la(e)}return null}function la(a){var c=
a.name,d=a.identifier,b=a.is_linked;a=a.default_value;a=da.di(a)?a.slice(0):a;return{name:c,identifier:d,Yb:b,Ya:a}}function W(a,c,d,b){return{name:a,identifier:c,Yb:b||!1,Ya:d}}function ba(a){for(var c=[],d=0;d<a.inputs.length;d++){var b=la(a.inputs[d]);b.Ya.length&&b.Ya.splice(3);c.push(b)}return c}function aa(a){for(var c=[],d=0;d<a.outputs.length;d++){var b=la(a.outputs[d]);c.push(b)}return c}function fa(a,c,d){c=null===c||void 0===c?null:U.H(c,d);return{name:a,value:c}}function ea(a,c,d,b,e,
h){var f=[],n=h.from_socket.identifier;h=h.to_socket.identifier;var g=b.Sa;for(b=0;b<g.length;b++)if(g[b].identifier==n){f.push(b);break}e=e.L;for(b=0;b<e.length;b++)if(e[b].identifier==h){f.push(b);break}2==f.length&&Q.Wc(a,c,d,f);return!0}function ia(a,c,d){return"GROUP_INPUT"==a?c+"*GI*"+d:"GROUP_OUTPUT"==a?c+"*GO*"+d:c+"%join%"+d}function va(a){var c=[];Q.ma(a,function(a,d){"GROUP"==d.type&&c.push(d)});return c}function ga(a,c,d){for(var b=0;b<d.length;b++){var e=d[b].data.QQ,h=d[b].data.RQ;if(!e)return!1;
Q.ma(e,function(c,d){Q.Ck(a,Q.Wn(a),d)});for(e=0;e<h.length;e++)c.push(h[e]);Ca(d[b],c,a)}return!0}function E(a,c,d,b,e,h){switch(a.type){case "GROUP":a.name==c&&b.push(d);break;case "GROUP_INPUT":a.name.indexOf(c+"*GI*")||e.push(d);break;case "GROUP_OUTPUT":a.name.indexOf(c+"*GO*")||h.push(d)}}function ka(a,c,d){for(var b=[],e=0;e<d.length;e++){for(var h=d[e],f=null,n=0;n<c.length;n++)if(h.from_socket.identifier==c[n].to_socket.identifier){f=c[n];break}f?(h.from_node=f.from_node,h.from_socket=f.from_socket):
b.push(h)}for(e=0;e<c.length;e++)a.splice(a.indexOf(c[e]),1);return b}function S(a,c){if(c.length)for(var d=c[0].from_node.name,b=0;b<a.length;b++)a[b].from_node.name==d&&c.push(a[b])}function X(a,c,d,b){for(var e=0;e<b.length;e++){for(var h=b[e],f,n=0;n<d.L.length;n++)if(h.from_socket.identifier==d.L[n].identifier){f=d.L[n].Ya;break}for(var n=h,g=c,k=f,p=z(n.to_node,g),u=0;u<p.length;u++)for(var y=Q.Ra(g,p[u]),v=0;v<y.L.length;v++){var t=y.L[v];if(t.identifier==n.to_socket.identifier){y=t.Ya instanceof
Object?0:1;if((k instanceof Object?0:1)==y)t.Ya=k;else switch(y){case 0:t=t.Ya;t[0]=t[1]=t[2]=k;break;case 1:t.Ya=(k[0]+k[1]+k[2])/3}break}}h=a.indexOf(h);-1!=h&&a.splice(h,1)}}function Ca(a,c,d){for(var b=a.name,e=[],h=[],f=[],n=[],g=0;g<c.length;g++){var k=c[g];E(k.from_node,b,k,e,f,n);E(k.to_node,b,k,h,f,n)}h=ka(c,h,f);e=ka(c,n,e);S(c,h);X(c,d,a,h);if(e.length){var p;Q.ma(d,function(a,c){"GROUP_OUTPUT"!=c.type||c.name.indexOf(b+"*GO*")||(p=c)});X(c,d,p,e)}}function ha(a){var c=[],d=[];Q.ma(a,function(a,
b){switch(b.type){case "VALTORGB":c.push(b);break;case "CURVE_VEC":case "CURVE_RGB":d.push(b)}});var b=0,e=a=null,h=c.length+d.length;if(c.length){a=pa.RM(c,pa.UI);for(var f=0;f<c.length;f++)c[f].Nb.push(["NODE_TEX_ROW",U.H((b+.5)/h)]),b++}if(d.length)for(e=pa.uN(d,pa.Xz),f=0;f<d.length;f++)d[f].Nb.push(["NODE_TEX_ROW",U.H((b+.5)/h)]),b++;f=null;a&&e?(f=new Uint8Array(a.length+e.length),f.set(a),f.set(e,a.length)):f=a?a:e;a=f?pa.hD(f,pa.Xz):null;for(f=0;f<c.length;f++)c[f].data.Ja=a;for(f=0;f<d.length;f++)d[f].data.Ja=
a}function ja(a,c,d){a=a.curve_mapping.curves_data[c];return 2==a.length&&a[0][0]<d+.01&&a[0][1]<d+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var Z=l("__config");l("__debug");var Q=l("__graph"),Ba=l("__mat3"),ta=l("__mat4"),ua=l("__objects"),sa=l("__print"),U=l("__shaders"),xa=l("__scenes"),da=l("__util"),P=l("__vec3"),pa=l("__textures"),ca={},za={},Aa={},ma={},Ja=0;new Float32Array(4);var Da=Z.v;a.nW=0;a.IK=1;a.HK=2;a.GK=3;a.mW=4;a.FK=5;a.EK=6;a.DK=7;a.lW=8;a.JD=function(a){return za[a]};a.EM=function(a){delete za[a]};
a.IM=m;a.Lv=function(a,c,d){var b=xa.o();a=k(a,"MAIN",b.uuid);if(a in Aa)return Aa[a];var b=Q.create(),h={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},f=K(b,h,0,c,null),h={name:"LIGHTING_END",type:"LIGHTING_END"},h=K(b,h,0,c,null);e(b,d,f,h,[[f,[8,10]],[f,[9,6]]],c);w(b);return Aa[a]=b};a.wq=function(a){var c=[],d={};ca={};var b=Q.pz(a);Q.ma(b,function(a,b){var e;e=[];for(var h=[],f=[],n=[],g=[],k=[],p=0;p<b.L.length;p++){var u=b.L[p];if(u.Yb)e.push(null),h.push(null);else{e.push(C("in_"+b.type+"_"+
u.identifier));var y=U.H(u.Ya,0);Da.iH&&(0<=b.type.indexOf("MIX_RGB_")&&("Color1"==u.identifier||"Color2"==u.identifier||"Fac"==u.identifier)||0<=b.type.indexOf("MATH_")&&("Value"==u.identifier||"Value_001"==u.identifier)||0<=b.type.indexOf("VECT_MATH_")&&"Vector_001"==u.identifier||0<=b.type.indexOf("LIGHTING_APPLY")||0<=b.type.indexOf("MATERIAL_END")||0<=b.type.indexOf("MATERIAL_BEGIN"))&&(u=y,u=u.replace(/(,)/g,"$1 "),u=u.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1ZERO_VALUE_NODES$3"),u=u.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,
"$1UNITY_VALUE_NODES$3"),y=u=u.replace(/\s+/g,""));h.push(y)}}for(p=0;p<b.Sa.length;p++)u=b.Sa[p],u.Yb?f.push(null):f.push(C("out_"+b.type+"_"+u.identifier));for(p=0;p<b.Fa.length;p++)u=b.Fa[p],n.push(u.name),g.push(u.value);for(p=0;p<b.Ji.length;p++)k.push(b.Ji[p].name);e={id:b.type,L:e,Zw:h,Sa:f,Fa:n,cs:g,Ji:k,Nb:JSON.parse(JSON.stringify(b.Nb))};c.push(e);d[a]=e});Q.Pf(b,function(a,c,e){var h=Q.Ra(b,a);Q.Ra(b,c);var f=h.Sa[e[0]];a=d[a].Sa;c=d[c].L;h=a[e[0]]||C("out_"+h.type+"_"+f.identifier);a[e[0]]=
h;c[e[1]]=h});return c};a.NB=function(a){if(a.node_tree)for(var c=0;c<a.node_tree.nodes.length;c++){var d=a.node_tree.nodes[c];if("GROUP"==d.type&&"B4W_GLOW_OUTPUT"==d.node_tree_name)return!0}return!1};a.ha=function(){for(var a in za)delete za[a];for(a in Aa)delete Aa[a];for(var c in ma)delete ma[c];Ja=0}};b4w.module.__debug=function(a,l){function m(a){a=a.split("\n");for(var d=0;d<a.length;d++)a[d]=d+1+" "+a[d];return a=a.join("\n")}function b(){var a=w.Hw();if(a){var d=a.createQueryEXT();a.beginQueryEXT(a.TIME_ELAPSED_EXT,d)}else d=performance.now();return d}function e(){var c=d;return c&&c.debug_view_mode==a.Fm}function x(a,d){var b=w.Hw(),e=0;if(b){b.endQueryEXT(b.TIME_ELAPSED_EXT);for(var h=0;h<a.length;h++){var f=a[h],g=b.getQueryObjectEXT(f,b.QUERY_RESULT_AVAILABLE_EXT),k=F.getParameter(b.GPU_DISJOINT_EXT);
g&&!k&&(e=b.getQueryObjectEXT(f,b.QUERY_RESULT_EXT)/1E6,d&&(e=z.mc(e,d,1,10)),a.splice(h,1),h--)}}else e=performance.now()-a.pop(),d&&(e=z.mc(e,d,1,10));return e}function k(a,d){typeof a!=typeof d&&z.l("Structure assertion failed: incompatible types");if(null!==a&&null!==d&&"object"==typeof a){for(var b in a)b in d||z.l("Structure assertion failed: missing key in the first object: "+b);for(b in d)b in a||z.l("Structure assertion failed: missing key in the second object: "+b),typeof a[b]!=typeof d[b]&&
z.l("Structure assertion failed: incompatible types for key "+b)}}var B=l("__compat"),r=l("__config"),w=l("__extensions"),f=l("__print"),q=l("__textures"),g=l("__time"),z=l("__util"),A=l("__graph"),J=r.v,N={},F=null,G={},D=[],H=-1,I=-1,d=null,h=null,v=!1;a.zp=0;a.Kt=1;a.Ap=2;a.Jt=3;a.yp=4;a.It=5;a.Ht=6;a.Fm=7;a.xe=function(a){var d="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),b;for(b in d){var e=d[b];e in a&&(N[a[e]]=e)}F=
a};a.WR=function(a){d=a};a.QY=function(){return d};a.tv=function(a){if(J.gl_debug){var d=F.getError();d!=F.NO_ERROR&&(d in N?z.l("GL Error: "+d+", gl."+N[d]+" ("+a+")"):z.l("Unknown GL error: "+d+" ("+a+")"))}};a.jM=function(){if(J.gl_debug||J.MB)switch(F.checkFramebufferStatus(F.FRAMEBUFFER)){case F.FRAMEBUFFER_COMPLETE:break;case F.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case F.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");
break;case F.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case F.FRAMEBUFFER_UNSUPPORTED:f.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case F.gV:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:f.error("FRAMEBUFFER CHECK FAILED")}};a.nM=function(){if(-1!=H)return H;F.bindFramebuffer(F.FRAMEBUFFER,F.createFramebuffer());var a=q.un("DEBUG",q.xk);q.resize(a,1,1);F.framebufferTexture2D(F.FRAMEBUFFER,
F.DEPTH_ATTACHMENT,a.ac,a.hb,0);F.checkFramebufferStatus(F.FRAMEBUFFER)!=F.FRAMEBUFFER_COMPLETE?(H=!0,f.warn("depth-only issue was found")):H=!1;F.bindFramebuffer(F.FRAMEBUFFER,null);return H};a.tM=function(){if(-1!=I)return I;F.bindRenderbuffer(F.RENDERBUFFER,F.createRenderbuffer());F.renderbufferStorageMultisample(F.RENDERBUFFER,J.uc,F.RGBA8,1,1);var a=F.getRenderbufferParameter(F.RENDERBUFFER,F.RENDERBUFFER_SAMPLES);a!=J.uc?(I=!0,f.warn("multisample issue was found: requested "+J.uc+", got "+a),
F.getError()==F.INVALID_OPERATION&&f.warn("the error from multisample issue detected, ignoring")):I=!1;F.bindRenderbuffer(F.RENDERBUFFER,null);return I};a.qM=function(){return B.vv("Firefox")&&F.getError()==F.OUT_OF_MEMORY?(f.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.uM=function(a,d,b){if(J.gl_debug&&!F.getShaderParameter(a,F.COMPILE_STATUS)){var e=J.cB&&w.Fw();e&&(b=e.getTranslatedShaderSource(a));b=m(b);f.error("shader compilation failed:\n"+b+"\n"+F.getShaderInfoLog(a)+" ("+d+
")");z.l("Engine failed: see above for error messages")}};a.vM=function(a,d,b,e,h,g){if(J.gl_debug&&!F.getProgramParameter(a,F.LINK_STATUS)){var k=J.cB&&w.Fw();k&&(h=k.getTranslatedShaderSource(b),g=k.getTranslatedShaderSource(e));h=m(h);g=m(g);f.error("shader linking failed:\n"+h+"\n\n\n"+g+"\n"+F.getProgramInfoLog(a)+" ("+d+")");z.l("Engine failed: see above for error messages")}};a.iy=function(a){if(J.show_hud_debug_info||"PERFORMANCE"==a.type)a.hw||a.Qk.push(b())};a.CR=function(a){"MAIN"==a.type&&
e()&&a.Qk.push(b())};a.jy=function(a){if((J.show_hud_debug_info||"PERFORMANCE"==a.type)&&!a.hw){var d=x(a.Qk,a.tf);d&&(a.tf=d)}};a.DR=function(a){if("MAIN"==a.type&&e()){var d=x(a.Qk,a.tf);d&&(a.tf=d)}};a.KE=e;a.pR=function(a){var d=x(a.Qk,a.tf);d&&(a.tf=d)};a.dY=function(a){G[a]=a in G?G[a]+1:1};a.update=function(){for(var a in G)f.log(a,G[a]),G[a]=0};a.Tq=function(){for(var a=[performance.now()],d=0;d<arguments.length;d++){var b=arguments[d];if(z.di(b))for(var e=0;e<b.length;e++)a.push(b[e]);else a.push(arguments[d])}D.push(a)};
a.yF=function(){for(var a=1,d=0;d<D.length;d++){var b=D[d];b[1]==arguments[0]&&a++}b=[a];for(d=0;d<arguments.length;d++)if(a=arguments[d],z.di(a))for(var e=0;e<a.length;e++)b.push(a[e]);else b.push(arguments[d]);D.push(b)};var M=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.dG=function(a){a||(a=1);for(var d=0,b={},e=Math.max(0,performance.now()-1E3*a),h=0;h<D.length;h++){var g=D[h];a=g[0];if(!(a<e)){var k=String(g[1]);b[k]||(b[k]=M[d++%M.length]);a=["%c"+
(a/1E3).toFixed(6),b[k],k];for(k=2;k<g.length;k++)a.push(g[k]);f.log.apply(this,a)}}D.splice(0)};a.Tx=function(a){a||(a=1);for(var d={},b=Math.max(0,performance.now()-1E3*a),e=0;e<D.length;e++){var h=D[e];a=h[0];if(!(a<b))for(var g=2;g<h.length;g++){var k=String(h[1]);3<h.length&&(k+="_"+String(g-2));d[k]||(d[k]=k+"\n");d[k]+=String(a)+" "+h[g]+"\n"}}a="";for(k in d)a+=d[k]+"\n\n";f.log(a);D.splice(0)};a.dX=function(a){function d(a){return-1<b.indexOf(a)?!0:!1}var b=navigator.userAgent.toLowerCase();
switch(a.toLowerCase()){case "chrome":return d("mozilla")&&d("applewebkit")&&d("chrome");case "firefox":return d("mozilla")&&d("gecko")&&d("firefox");case "msie":return d("mozilla")&&d("trident")&&d("msie");case "opera":return d("opera")&&d("presto");case "safari":return d("mozilla")&&d("applewebkit")&&d("safari")&&!d("chrome");default:return!1}};a.LB=function(a){if(z.di(a)){for(var d=0;d<a.length;d++)if(!isFinite(a[d]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.LW=function(a,d){a.constructor!=
d&&z.l("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+d+">")};a.NW=k;a.OW=function(a){v?k(a,h):v=!0;h=a};a.PC=function(a,d,b,e,h){(a=a||null)||z.l("Stage load callback is undefined");d=d||5E3;b=b||0;e=e||100;100<e&&z.l("Max percentage must be less than 100");0>b&&z.l("Min percentage must be greater than 0");b>e&&z.l("Max percentage must be greater than min percentage");var f=g.Bk(b,e,d,function(d){d=d.toFixed();a(d);100==d&&(g.qq(f),h&&h())})};a.d0=function(a){return A.CN(a,
function(a,c){var d=c.type+"("+c.name+")",b=c.L,d=d+"\n\nINPUTS:";if(b.length)for(var e=0;e<b.length;e++)d+="\n"+b[e].identifier+": ",d=b[e].Yb?d+"linked":d+b[e].Ya;else d+="\n---";b=c.Sa;d+="\n\nOUTPUTS:";if(b.length)for(e=0;e<b.length;e++)d+="\n"+b[e].identifier+": ",d=b[e].Yb?d+("linked(default "+b[e].Ya+")"):d+"not used";else d+="\n---";e="";switch(c.type){case "GEOMETRY_UV":e="\nuv_layer: "+c.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":e="\ntexture: "+c.data.value.name+"\n("+
c.data.value.w_.cg+")"}""==e&&(e="\n---");return d=d+"\n\nDATA:"+e},function(d,b,e){d=A.Ra(a,d);b=A.Ra(a,b);return d.Sa[e[0]].identifier+"\n==>\n"+b.L[e[1]].identifier})};a.ha=function(){d=null}};b4w.module.__compat=function(a,l){function m(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function b(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function e(){return!window.ActiveXObject&&"ActiveXObject"in window}var x=l("__config"),k=l("__debug"),B=l("__extensions"),
r=l("__print"),w="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.sA=256;var f=x.Zi,q=x.v,g=x.context,z=x.Vl,A=x.P,J=x.r;a.LN=function(a){a.getError()==a.INVALID_ENUM&&r.warn("Possible Tegra invalid enum issue detected, ignoring")};a.gS=function(l){q.pF=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS);q.Rb=l.getParameter(l.MAX_TEXTURE_SIZE);
q.fi=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE);q.ld?(q.uc=Math.min(q.uc,l.getParameter(l.MAX_SAMPLES)),m("Firefox")&&(r.warn("Firefox and WebGL 2 detected, applying framebuffer hack"),q.MB=!0)):q.uc=1;m("Firefox")&&"NONE"!==q.stereo&&(r.warn("Firefox and Stereo rendering detected, disable texture reusage"),q.RC=!0);q.ld&&k.tM()&&(q.uc=1);var F=Boolean(B.XO());m("Firefox/28.0")&&(m("Linux")||m("Macintosh"))&&(r.warn("Firefox 28 detected, applying depth hack"),F=!1);m("Windows Phone")||(m("iPad")||
m("iPhone")?(r.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound."),g.alpha||(q.background_color[3]=1),q.yI=!0,q.smaa=!1,q.Rd=!1,q.precision="highp",q.Yw=!0,z.xn=256):m("Mac OS X")&&m("Safari")&&!m("Chrome")&&(r.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),q.DG=!0,A.pB=!0,A.SB=!0));
m("Windows")&&(m("Chrome/40")||m("Firefox/33")||m("Firefox/34")||m("Firefox/35")||m("Firefox/36"))&&(r.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),q.yv=!0);m("Chrome")&&!b()&&x.EE()&&(r.warn('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),q.RB=!0);m("Mac OS X")&&(q.Lr=!0,r.warn("OS X detected, applying shadows hack."));b()&&(r.warn("Mobile detected, applying various hacks for video textures."),
q.Af=!0,m("iPad")||m("iPhone")||m("Windows Phone")||(r.warn("Mobile (not iOS) detected, disable playback rate for video textures."),A.IC=!0));(m("Firefox/35.0")||m("Firefox/36.0"))&&m("Windows")&&(r.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),q.QC=!0);if(m("iPhone")||e()||m("Edge"))r.warn("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),q.To=!0;10>l.getParameter(l.MAX_VARYING_VECTORS)&&(r.warn("Not enough varyings, disable shadows on blend objects"),
q.ew=!0);m("Windows Phone")&&(r.warn("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),q.debug_view=!1,q.precision="highp",q.Yg=!1,q.Rd=!1,q.smaa=!1,q.Yl=!1,q.Ko=!1,q.gd=!1,q.iG=!1);if(m("UCBrowser")||m("Firefox")&&q.Af)r.warn("Mobile Firefox or UCBrowser detected, disable workers."),J.jp=!1;var G=B.QD();if(G){var D=l.getParameter(G.UNMASKED_VENDOR_WEBGL),G=l.getParameter(G.UNMASKED_RENDERER_WEBGL),H=/\b4\d{2}\b/;m("Macintosh")&&-1<
G.indexOf("Intel HD Graphics 3000")&&(r.warn("OS X / Intel HD 3000 detected, applying depth hack"),F=!1);-1<D.indexOf("ARM")&&H.test(G)&&(r.warn("ARM Mali-400 series detected, applying depth and frames blending hacks"),F=!1,f.aD=!0);-1<D.indexOf("ARM")&&-1<G.indexOf("Mali-T604")&&(r.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),q.precision="highp",q.Yl=!1);-1<D.indexOf("ARM")&&-1<G.indexOf("Mali-T760")&&(r.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),
q.precision="highp",q.Rd=!1,q.Nu=!0);-1<D.indexOf("Qualcomm")&&-1<G.indexOf("Adreno")&&(r.warn("Qualcomm Adreno detected, applying shader constants hack."),q.iH=!0,-1<G.indexOf("305")&&(r.warn('Qualcomm Adreno305 detected, set "highp" precision.'),q.precision="highp"),-1<G.indexOf("330")&&(r.warn('Qualcomm Adreno330 detected, set "highp" precision.'),q.precision="highp"),-1<G.indexOf("420")&&(r.warn("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
q.Rb=4096,q.fi=4096));-1<D.indexOf("NVIDIA")&&-1<G.indexOf("Tegra 3")&&(r.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),q.rw=!0);m("Windows")&&m("Chrome")&&!m("Edge")&&(G.match(/NVIDIA GeForce 8..0/)||G.match(/NVIDIA GeForce 9..0/)||G.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(r.warn("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),q.fi=a.sA,q.yG=!0);D="";for(H=0;H<w.length;H++)if(-1<
G.indexOf(w[H])){D=w[H];break}D&&(r.warn("Architecture "+D+" detected. Blending between frames and shadows on blend objects will be disabled."),q.Nu=!0,q.ew=!0)}0==l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(r.warn("Vertex textures are not allowed. Disabling vertex textures"),q.Yp=!1);F||(q.Qn=!1,q.Jc=!1,q.water_dynamic=!1,q.vi=!1,q.Os=!1,q.smaa=!1);q.qI=Boolean(B.SD());q.Lq=F;if(l.getShaderPrecisionFormat)var I=l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT);l.getShaderPrecisionFormat&&
0!==I.precision||(q.precision="mediump");e()&&(r.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),z.xn=512);if(e()&&m("Touch")||m("Edge"))r.warn("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),q.qr=!0;128>=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS)&&(r.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),q.rw=!0);m("Chrome")&&!m("Edge")&&r.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called.");
if(m("Chrome")&&!m("Edge")||m("Firefox"))q.fw=!0;b()&&m("Firefox")&&(r.log("Mobile firefox detected. Applying autoplay media hack."),q.yx=!0);m("Edge")&&(r.warn("Microsoft Edge detected, set up new minimal texture size."),q.Hn=!0);m("SamsungBrowser")&&(r.warn("Default Android browser detected, setting max cubemap size to 1024, setting max texture size to 1024."),q.Rb=1024,q.fi=1024)};a.vv=m;a.cw=b;a.oL=function(){m("Firefox/35.0")&&m("Windows")&&(r.warn("Windows/Firefox 35 detected, forcing context's alpha"),
x.context.alpha=!0)};a.no=e};b4w.module.__textures=function(a,l){function m(){return{name:"",type:0,source:"",Vy:"",width:0,height:0,Dv:1,Xp:!0,hk:1024,Kn:!1,ce:null,ac:0,hb:null,Ge:null,oo:!1,Bh:-1,Ba:null,El:0,Wg:0,pa:0,ub:0,bl:0,lg:!1,ph:1,Qc:null,uy:0,ty:0,dk:-1,vy:!1,Wl:-1,rt:!1,iU:!1,jk:!1,nt:!1,repeat:!0,Oh:!0}}function b(c,d,b,h){var f=c.type,g=new Uint8Array([204,204,204,255]),k=m();switch(f){case "DATA_TEX2D":case "IMAGE":var p=E.createTexture(),u=E.TEXTURE_2D;E.bindTexture(u,p);E.texImage2D(u,0,E.RGBA,1,1,0,E.RGBA,
E.UNSIGNED_BYTE,g);c.image&&"MOVIE"==c.image.source&&(k.oo=!0,k.pa=c.frame_start,k.ub=c.frame_offset,k.bl=c.frame_duration,k.iU=c.use_auto_refresh,k.jk=c.use_cyclic,k.El=c.movie_length,k.nt=c.b4w_nla_video,0!=k.ub&&n.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":p=E.createTexture();u=E.TEXTURE_2D;E.bindTexture(u,p);if("NONE"==c.b4w_source_type)return null;if("SCENE"==c.b4w_source_type)if(c.b4w_source_id&&(b=
O.Mc("name",c.b4w_source_id,b)))k.hk=c.b4w_source_size,b.Le=b.Le||[],b.Le.push(c),E.texImage2D(u,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,g);else return null;break;case "ENVIRONMENT_MAP":p=E.createTexture();u=E.TEXTURE_CUBE_MAP;E.bindTexture(u,p);b="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var v=0;6>v;v++)E.texImage2D(E["TEXTURE_CUBE_MAP_"+b[v]],0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,g);break;case "BLEND":return null;case "NODE_TEX":p=E.createTexture();u=E.TEXTURE_2D;
E.bindTexture(u,p);E.texImage2D(u,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,g);break;default:return n.error('texture "'+c.name+'" has unsupported type "'+f+'"'),null}"NONE"==f&&(!c.b4w_enable_canvas_mipmapping||"CANVAS"!=c.b4w_source_type)||"DATA_TEX2D"==f||"IMAGE"==f&&"MOVIE"==c.image.source||"NODE_TEX"==f?E.texParameteri(u,E.TEXTURE_MIN_FILTER,E.LINEAR):E.texParameteri(u,E.TEXTURE_MIN_FILTER,ka[ba.rm]);E.texParameteri(u,E.TEXTURE_MAG_FILTER,E.LINEAR);g=u;b=c.b4w_anisotropic_filtering;"DEFAULT"===b&&
(b=d);"OFF"!==b&&ba.Zp&&(d=L.RO())&&(b=parseFloat(b.split("x")[0]),E.texParameterf(g,d.TEXTURE_MAX_ANISOTROPY_EXT,b));"REPEAT"!=c.extension||c.b4w_shore_dist_map?(k.repeat=!1,E.texParameteri(u,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE),E.texParameteri(u,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE)):(E.texParameteri(u,E.TEXTURE_WRAP_S,E.REPEAT),E.texParameteri(u,E.TEXTURE_WRAP_T,E.REPEAT));k.type=a.Ti;k.width=1;k.height=1;k.hb=p;k.ac=u;"CANVAS"==c.b4w_source_type&&"NONE"==f?(f=c.b4w_source_id,p=c.b4w_source_size,k.Kn=
c.b4w_enable_canvas_mipmapping,k.Vy=f,k.source="CANVAS",u=document.createElement("canvas"),u.width=p,u.height=p,k.ce=u.getContext("2d"),h in va||(va[h]={}),va[h][f]=k,e(k)):"SCENE"==c.b4w_source_type&&"NONE"==f?(k.Vy=c.b4w_source_id,k.source="SCENE"):(k.source=f,E.generateMipmap(u),E.bindTexture(u,null));k.name=c.name;return c.j=k}function e(a){"CANVAS"!=a.source&&O.l("Wrong texture");var c=a.ac;E.bindTexture(c,a.hb);var d=A(a),b=J(a),e=N(a),h=a.ce.canvas;E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);E.texImage2D(c,
0,b,d,e,h);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!1);a.Kn&&E.generateMipmap(c);E.bindTexture(c,null);a.width=h.width;a.height=h.height}function x(a){var c=a.ac;E.bindTexture(c,a.hb);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Ba.length?a.lg?r(a,a.Ba,a.width*a.ph,a.height*a.ph,!1):E.texImage2D(c,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,a.Ba):E.texImage2D(c,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,a.Ba);E.bindTexture(c,null)}function k(a){var c=a.ac;E.bindTexture(c,a.hb);E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);
a.lg?r(a,a.Qc[a.dk],a.width*a.ph,a.height*a.ph,!1):E.texImage2D(c,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,a.Qc[a.dk]);E.bindTexture(c,null)}function B(){fa||(fa=document.createElement("canvas"));return fa}function r(a,c,d,b,e){e||(f(E.TEXTURE_2D),E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,c));E.bindTexture(E.TEXTURE_2D,null);V.RN(a,d,b,ia,ea)}function w(a,c,d,b){for(var e=0;6>e;e++){var h=b[e],f=B();f.width=d;f.height=d;var n=f.getContext("2d");"POSITIVE_Y"==h[0]||"NEGATIVE_Y"==h[0]?(n.translate(0,
d),n.scale(1,-1)):(n.translate(d,0),n.scale(-1,1));n.drawImage(a,h[1]*c,h[2]*c,c,c,0,0,d,d);E.texImage2D(E["TEXTURE_CUBE_MAP_"+h[0]],0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,f)}}function f(a){ia||(ia=E.createFramebuffer());E.bindTexture(a,null);ea||(ea=E.createTexture());E.bindTexture(a,ea);E.texParameteri(a,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(a,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);E.texParameteri(a,E.TEXTURE_MAG_FILTER,E.LINEAR);E.texParameteri(a,E.TEXTURE_MIN_FILTER,E.LINEAR)}function q(a,c,d,
b,e){var h=a.source,k=a.hb,p=a.ac,v=1,y=1;E.bindTexture(p,k);if(4==c.length){var q=!0;c=new Uint8Array([255*c[0],255*c[1],255*c[2],255*c[3]])}if("IMAGE"==h)if(q)E.texImage2D(p,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,c),a.width=1,a.height=1;else if(d){y=u.hE(c);q=O.en(y.width)||O.en(y.height);if(y.width>ba.Rb||y.height>ba.Rb){n.error('Texture "'+b+'" has unsupported size: '+y.width+"x"+y.height+". Max available: "+ba.Rb+"x"+ba.Rb+".");return}v=y.width;y=y.height;q&&(a.lg=!0,f(p),v=z(v*a.ph),y=z(y*a.ph));
u.eU(E,L.SD(),c,!0);a.lg&&(r(a,null,v,y,!0),E.bindTexture(p,k),E.generateMipmap(p));a.width=v;a.height=y;a.Dv=u.VO(c)}else{E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0);a.oo?ba.To?(v=c[0].width,y=c[0].height):(v=c.videoWidth,y=c.videoHeight):(v=c.width,y=c.height);a.width=v;a.height=y;if(v>ba.Rb||v>ba.Rb)n.warn('Texture "'+b+'" has unsupported size: '+v+"x"+y+". Max available: "+ba.Rb+"x"+ba.Rb+". Reduced image size will be used."),a.ph=Math.min(ba.Rb/v,ba.Rb/y),a.lg=!0;a.oo&&(ba.To?(e in ga||(ga[e]={}),
ga[e][a.name]=a,a.Qc=c,a.uy=c.length,a.Wg=a.ty*a.El/c.length,c=c[0]):(e in ga||(ga[e]={}),ga[e][a.name]=a,a.Ba=c,a.Ba.loop=a.jk,a.Wg=c.duration?a.El/c.duration:T.Ec(),aa.IC||(c.playbackRate=T.Ec()/a.Wg,aa.SB&&2<c.playbackRate&&(c.playbackRate=2)),g(a)));v=z(a.width*a.ph);y=z(a.height*a.ph);a.lg?(b=B(),k=b.getContext("2d"),b.width=v,b.height=y,k.drawImage(c,0,0,a.width,a.height,0,0,v,y),E.texImage2D(p,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,b)):O.en(a.width)||O.en(a.height)?(r(a,c,v,y,!1),a.lg=!0):E.texImage2D(p,
0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,c);k=a.hb;E.bindTexture(p,k);a.oo||E.generateMipmap(p);E.bindTexture(p,null);a.width=v;a.height=y}else if("ENVIRONMENT_MAP"==h)if(v=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],q){for(b=0;6>b;b++)E.texImage2D(E["TEXTURE_CUBE_MAP_"+v[b][0]],0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,c);a.width=3;a.height=2}else{E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!1);if(c.width%3||c.height%2){n.error('Cubemap texture "'+
b+'" has unsupported size: '+c.width+"x"+c.height+". The width must be multiple of three and the height - multiple of two.");return}y=c.width/3;if(y>ba.fi)n.warn('Cubemap texture "'+b+'" has unsupported size: '+c.width+"x"+c.height+". Max available: "+3*ba.fi+"x"+2*ba.fi+". Reduced image size will be used."),b=z(ba.fi/y*y),a.lg=!0;else if(b=z(y),3*b>ba.Rb||2*b>ba.Rb)a.lg=!0;if(a.lg||ba.yG)w(c,y,b,v);else{q=c;k=b;f(E.TEXTURE_2D);E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,q);E.bindTexture(E.TEXTURE_2D,
null);for(q=0;6>q;q++)E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,E.RGBA,k,k,0,E.RGBA,E.UNSIGNED_BYTE,null);E.bindTexture(a.ac,null);E.bindFramebuffer(E.FRAMEBUFFER,ia);for(q=0;6>q;q++)V.QN(a,E.TEXTURE_CUBE_MAP_POSITIVE_X+q,k,y,ea,q);E.bindFramebuffer(E.FRAMEBUFFER,null);E.bindTexture(a.ac,a.hb);E.texParameteri(a.ac,E.TEXTURE_MIN_FILTER,ka[ba.rm]);E.texParameteri(a.ac,E.TEXTURE_MAG_FILTER,E.LINEAR)}C.qM()&&(n.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),w(c,
y,t.sA,v));a.width=3*b;a.height=2*b;E.generateMipmap(p)}else if("DATA_TEX2D"==h||"NODE_TEX"==h)E.texImage2D(p,0,E.RGBA,c.width,c.height,0,E.RGBA,E.UNSIGNED_BYTE,c.data),a.width=c.width,a.height=c.height;E.bindTexture(p,null)}function g(a){a.Ba.n0=function(){x(a)}}function z(a){return O.en(a)?O.S(Math.pow(2,parseInt(a).toString(2).length),2,ba.Rb):a}function A(c){var d;switch(c.type){case a.Ti:d=E.RGBA;break;case a.Up:d=E.RGB;break;case a.Nm:d=E.RGBA;break;case a.Om:d=E.RGB;break;case a.xk:d=E.DEPTH_COMPONENT;
break;default:O.l("Wrong texture type")}return d}function J(c){var d;switch(c.type){case a.Ti:d=ba.ld?E.RGBA8:E.RGBA;break;case a.Up:d=ba.ld?E.RGB8:E.RGB;break;case a.Nm:d=ba.ld?E.RGBA8:E.RGBA;break;case a.Om:d=ba.ld?E.RGB8:E.RGB;break;case a.xk:d=ba.ld?E.DEPTH_COMPONENT24:E.DEPTH_COMPONENT;break;default:O.l("Wrong texture type")}return d}function N(c){var d;switch(c.type){case a.Ti:d=E.UNSIGNED_BYTE;break;case a.Up:d=E.UNSIGNED_BYTE;break;case a.Nm:d=E.FLOAT;break;case a.Om:d=E.FLOAT;break;case a.xk:d=
E.UNSIGNED_INT;break;default:O.l("Wrong texture type")}return d}function F(a){return a&&a.name&&a.Ge?!0:!1}function G(a,c,d){var e=null;switch(a){case "SSAO_TEXTURE":e={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};b(e,null,c,0);e.image={filepath:null};break;case "NODE_TEX":e={name:d,type:"NODE_TEX",extension:"CLIP",b4w_anisotropic_filtering:"OFF"},b(e,null,c,0),e.image={filepath:null}}return e}function D(a,c){if(c in ga&&a in ga[c]){var d=ga[c][a];
d.Ba?d.Ba.play():d.Qc&&(d.vy=!0);return!0}return!1}function H(a,c){if(c in ga&&a in ga[c]){var d=ga[c][a];d.Ba?d.Ba.pause():d.Qc&&(d.vy=!1);return!0}return!1}function I(a,c){if(c in ga&&a in ga[c]){var d=ga[c][a];d.Ba?d.Ba.currentTime=d.ub/d.Wg:d.Qc&&(d.dk=h(d,d.ub),k(d));return!0}return!1}function d(a){return a.Ba?!a.Ba.paused:a.Qc?a.vy:!1}function h(a,c){return Math.round(c*a.uy/a.El)}function v(a,c){if(Y.Ea(a))return M(a,c);for(var d=a.rF,b=0;b<d.length;b++){var e=M(d[b],c);if(e)return e}return null}
function M(a,c){for(var d=null,b=a.A,e=0;e<b.length;e++)for(var h=b[e].X,f=0;f<h.length;f++)for(var n=h[f],g=0;g<n.fa.length;g++)if(n.fa[g].name==c){d=n.fa[g];break}return d}function c(a,c,d){var b=a.elements;a=a.interpolation;for(var e=0;e<c;e++){var h=e/(c-1),f=p(b,h,!0),n=R(b,h,!0);if(f&&n)if("CONSTANT"==a)d.push.apply(d,f.color);else{var g=d,k=f,u=n;k==u?g.push.apply(g,k.color):(g.push(la.Jr(u.color[0],u.position,k.color[0],k.position,h)),g.push(la.Jr(u.color[1],u.position,k.color[1],k.position,
h)),g.push(la.Jr(u.color[2],u.position,k.color[2],k.position,h)),g.push(la.Jr(u.color[3],u.position,k.color[3],k.position,h)))}n&&!f&&d.push.apply(d,n.color);f&&!n&&d.push.apply(d,f.color)}}function p(a,c,d){for(var b=null,e=0;e<a.length;e++){var h=d?c-a[e].position:c-a[e][1][0];0<=h&&(b?h<=(d?c-b.position:c-a[e][1][0])&&(b=a[e]):b=a[e])}return b}function R(a,c,d){for(var b=null,e=0;e<a.length;e++){var h=d?a[e].position-c:a[e][1][0]-c;0<=h&&(b?h<=(d?b.position-c:b[1][0]-c)&&(b=a[e]):b=a[e])}return b}
function K(a,c){var d=a.texture,b=d.j,d=d.image;b&&c&&d&&q(b,c,d.Xd,d.filepath);return b}var t=l("__compat"),y=l("__config"),u=l("__dds"),C=l("__debug"),L=l("__extensions"),n=l("__print"),T=l("__time"),O=l("__util"),V=l("__renderer"),Y=l("__obj_util"),la=l("__curve"),W=l("__vec3"),ba=y.v,aa=y.P,fa=null,ea=null,ia=null;a.of=0;a.F=0;a.CK=0;a.AK=0;a.BK=0;a.zK=0;a.Ti=10;a.Up=20;a.Nm=30;a.Om=40;a.xk=50;a.Sp=60;a.Qp=70;a.Tp=80;a.Rp=90;a.Xz=128;a.UI=128;a.AA=128;var va={},ga={},E=null,ka;a.xe=function(c){ka=
[c.NEAREST_MIPMAP_NEAREST,c.NEAREST_MIPMAP_LINEAR,c.LINEAR_MIPMAP_NEAREST,c.LINEAR_MIPMAP_LINEAR];a.of=c.NEAREST;a.F=c.LINEAR;a.CK=c.NEAREST_MIPMAP_NEAREST;a.AK=c.LINEAR_MIPMAP_NEAREST;a.BK=c.NEAREST_MIPMAP_LINEAR;a.zK=c.LINEAR_MIPMAP_LINEAR;E=c};a.JY=function(a,c){return c in va&&a in va[c]?va[c][a].ce:null};a.G2=function(a,c){return c in va&&a in va[c]?(e(va[c][a]),!0):!1};a.un=function(c,d){var b=m();b.name=c;b.type=d;b.source="NONE";if(d==a.Sp||d==a.Qp||d==a.Tp||d==a.Rp)b.Ge=E.createRenderbuffer();
else{var e=E.TEXTURE_2D,h=E.createTexture();E.bindTexture(e,h);E.texParameteri(e,E.TEXTURE_MAG_FILTER,E.LINEAR);E.texParameteri(e,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(e,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(e,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);E.bindTexture(e,null);b.ac=e;b.hb=h}return b};a.TM=function(c){var d=E.createTexture(),b=E.TEXTURE_CUBE_MAP;E.bindTexture(b,d);E.texParameteri(b,E.TEXTURE_MAG_FILTER,E.LINEAR);E.texParameteri(b,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(b,
E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(b,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);for(var e="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),h=0;6>h;h++)E.texImage2D(E[e[h]],0,E.RGBA,c,c,0,E.RGBA,E.UNSIGNED_BYTE,null);E.bindTexture(b,null);b=m();b.name="CUBEMAP";b.type=a.Ti;b.source="NONE";b.width=3*c;b.height=2*c;b.Dv=1;b.hb=d;b.ac=E.TEXTURE_CUBE_MAP;return b};a.Ay=
function(a,c,d){if(!F(a)){var b=a.ac;E.bindTexture(b,a.hb);c&&E.texParameteri(b,E.TEXTURE_MIN_FILTER,c);d&&E.texParameteri(b,E.TEXTURE_MAG_FILTER,d);E.bindTexture(b,null)}};a.YY=function(c){if(F(c))return{min:a.of,yQ:a.of};var d=c.ac;E.bindTexture(d,c.hb);c=E.getTexParameter(d,E.TEXTURE_MIN_FILTER);var b=E.getTexParameter(d,E.TEXTURE_MAG_FILTER);E.bindTexture(d,null);return{min:c,yQ:b}};a.resize=function(c,d,b){d=Math.max(d,ba.Hn?2:1);b=Math.max(b,ba.Hn?2:1);if(c.width!=d||c.height!=b){switch(c.type){case a.Sp:E.bindRenderbuffer(E.RENDERBUFFER,
c.Ge);E.renderbufferStorage(E.RENDERBUFFER,E.RGB565,d,b);E.bindRenderbuffer(E.RENDERBUFFER,null);break;case a.Qp:E.bindRenderbuffer(E.RENDERBUFFER,c.Ge);E.renderbufferStorage(E.RENDERBUFFER,E.DEPTH_COMPONENT16,d,b);E.bindRenderbuffer(E.RENDERBUFFER,null);break;case a.Tp:E.bindRenderbuffer(E.RENDERBUFFER,c.Ge);E.renderbufferStorageMultisample(E.RENDERBUFFER,ba.uc,E.RGBA8,d,b);E.bindRenderbuffer(E.RENDERBUFFER,null);break;case a.Rp:E.bindRenderbuffer(E.RENDERBUFFER,c.Ge);E.renderbufferStorageMultisample(E.RENDERBUFFER,
ba.uc,E.DEPTH_COMPONENT24,d,b);E.bindRenderbuffer(E.RENDERBUFFER,null);break;default:var e=c.ac;E.bindTexture(e,c.hb);var h=A(c),f=J(c),g=N(c);E.texImage2D(e,0,f,d,b,0,h,g,null);E.bindTexture(e,null)}d>ba.Rb||b>ba.Rb?n.error('Slink texture "'+c.name+'" has unsupported size: '+d+"x"+b+". Max available: "+ba.Rb+"x"+ba.Rb+"."):(c.width=d,c.height=b)}};a.sN=b;a.oI=x;a.nI=k;a.lt=q;a.IN=function(a){E.deleteTexture(a)};a.sl=function(a){return a&&a.name&&(a.hb||a.Ge)?!0:!1};a.pl=F;a.G_=function(c){return c.type==
a.Nm||c.type==a.Om?!0:!1};a.oP=function(c){var d=0;switch(c.type){case a.Ti:case a.Up:d=4;break;case a.Nm:case a.Om:d=16;break;case a.xk:d=3;break;case a.Sp:case a.Qp:d=2;break;case a.Tp:d=4*ba.uc;break;case a.Rp:d=3*ba.uc}return d};a.NO=G;a.ha=function(){if(!ba.To)for(var a in ga)for(var c in ga[a])ga[a][c].Ba.pause(),ga[a][c].Ba.src="",ga[a][c].Ba.load();va={};ga={}};a.pause=function(){for(var a in ga)for(var c in ga[a]){var b=ga[a][c];d(b)&&(H(c,a),b.rt=!0)}};a.reset=function(){for(var a in ga)for(var c in ga[a])I(c,
a),ga[a][c].rt=!1};a.play=function(a){for(var c in ga)for(var d in ga[c]){var b=ga[c][d];if(!a||b.rt)D(d,c),b.rt=!1}};a.O2=function(a,c){return c in ga&&a in ga[c]?ga[c][a].nt:!1};a.aG=D;a.Qx=H;a.xG=I;a.dS=function(a,c,d){d in ga&&a in ga[d]&&(a=ga[d][a],a.Ba?a.Ba.currentTime=c/a.Wg:a.Qc&&(a.dk=c,k(a)))};a.DI=d;a.EI=function(a){return a.Ba||a.Qc?a.Ba?2<=a.Ba.readyState:!0:0};a.AI=function(a){return a.Ba||a.Qc?a.Ba?Math.round(a.Ba.currentTime*a.Wg):a.dk:0};a.CI=function(a){return a.Ba||a.Qc?a.Ba?a.ub:
h(a,a.ub):0};a.BU=function(a){if(!a.Ba&&!a.Qc)return 0;var c=Math.min(a.bl,a.El-a.ub);return a.Ba?a.ub+c:h(a,a.ub+c)};a.ys=function(a,c){return Math.round(c*a.ty*(T.Ec()/a.Wg))};a.BI=function(a){return Math.min(a.bl,a.El-a.ub)};a.AU=h;a.KY=function(a,c){var d=v(a,c);return d&&"CANVAS"==d.source?d.ce:null};a.H2=function(a,c){var d=v(a,c);return d&&"CANVAS"==d.source?(e(d),!0):!1};a.KS=function(a){for(var c={},d=0;d<a.length;d++){for(var b=a[d].fa,h=[],f=0;f<b.length;f++){var n=b[f];if("CANVAS"==n.source)if(n.name in
c)n=c[n.name];else{var g=b[f],n=m();n.name=g.name;n.source="CANVAS";n.width=g.width;n.height=g.height;n.Kn=g.Kn;n.type=g.type;g=document.createElement("canvas");g.width=n.width;g.height=n.height;n.ce=g.getContext("2d");n.ac=E.TEXTURE_2D;n.hb=E.createTexture();E.bindTexture(E.TEXTURE_2D,n.hb);n.Kn?E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,ka[ba.rm]):E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR);E.bindTexture(E.TEXTURE_2D,
null);g=n;g.ce.drawImage(b[f].ce.canvas,0,0);e(g);c[n.name]=n}h.push(n)}a[d].fa=h}};a.RM=function(a,d){for(var b=[],e=0;e<a.length;e++)c(a[e].data.value.color_ramp,d,b);return new Uint8Array(b.map(function(a){return O.S(255*a,0,255)}))};a.TL=c;a.uN=function(a,c){for(var d=new Float32Array(3),b=new Float32Array(3),e=[],h=0;h<a.length;h++){for(var f=a[h].data.value,n=[],g=f.curve_mapping.curves_data,k=f.curve_mapping.curve_extend,u=f.curve_mapping.curves_handle_types,f=0;f<g.length;f++){for(var y=k[f],
v=g[f],t=[],q=u[f],m=0;m<v.length;m++)t.push([new Float32Array(3),new Float32Array(v[m].concat(0)),new Float32Array(3)]);la.nv(t[0],null,t[1],q[0],q[0]);for(m=1;m<t.length-1;m++)la.nv(t[m],t[m-1],t[m+1],q[m],q[m]);la.nv(t[t.length-1],t[t.length-2],null,q[t.length-1],q[t.length-1]);if(2<t.length){if("AUTO"==q[0]){W.subtract(t[0][2],t[0][1],d);m=W.length(d);W.copy(t[1][0],b);b[0]<t[0][1][0]&&(b[0]=t[0][1][0]);W.subtract(b,t[0][1],b);var C=W.length(b);1E-8<C&&(W.scale(b,m/C,b),W.add(t[0][1],b,t[0][2]),
W.subtract(t[0][1],b,t[0][0]))}v=t.length-1;"AUTO"==q[0]&&(W.subtract(t[v][0],t[v][1],d),m=W.length(d),W.copy(t[v-1][2],b),b[0]>t[v][1][0]&&(b[0]=t[v][1][0]),W.subtract(b,t[v][1],b),C=W.length(b),1E-8<C&&(W.scale(b,m/C,b),W.add(t[v][1],b,t[v][0]),W.subtract(t[v][1],b,t[v][2])))}for(v=0;v<t.length-1;v++)la.LM(t[v][1],t[v][2],t[v+1][0],t[v+1][1]);v=[];3>=g.length?(m=Math.round(-c/2),q=Math.round(c/2)):(m=0,q=c);for(;m<q;m++){var C=m/(q-1),K=p(t,C,!1),r=R(t,C,!1);K&&r?v.push(la.sB(C,K[1],K[2],r[0],r[1],
.001)):r&&!K?"EXTRAPOLATED"==y?(C=r[1][0]==r[2][0]?r[1][1]:la.eF(C,r[1],r[2]),v.push(C)):v.push(r[1][1]):K&&!r&&("EXTRAPOLATED"==y?(C=K[0][0]==K[1][0]?K[1][1]:la.eF(C,K[0],K[1]),v.push(C)):v.push(K[1][1]))}n.push(v)}e.push(n)}d=[];for(m=0;m<e.length;m++)for(n=e[m],f=0;f<n[0].length;f++)3>=n.length?(b=O.S(127.5*(n[0][f]+1),0,255),h=O.S(127.5*(n[1][f]+1),0,255),g=O.S(127.5*(n[2][f]+1),0,255),v=255):(b=O.S(255*n[0][f],0,255),h=O.S(255*n[1][f],0,255),g=O.S(255*n[2][f],0,255),v=O.S(255*n[3][f],0,255)),
d.push(b,h,g,v);return new Uint8Array(d)};a.ZW=function(a,c,d){return(a=v(a,c))?(q(a,d,!1,d.src,0),!0):!1};a.Dc=K;a.hD=function(a,c){var d={texture:G("NODE_TEX",null)};return K(d,{width:c,height:a.length/(4*c),data:a})}};b4w.module.__dds=function(a,l){function m(a,b,e,f){var k=new Uint16Array(4),m=new Uint16Array(e*f),r=0,l=0,w=0,H=l=r=0,B=0,d=0,h=0,v=e/4;f/=4;for(var M=0;M<f;M++)for(var c=0;c<v;c++)w=b+4*(M*v+c),k[0]=a[w],k[1]=a[w+1],r=k[0]&31,l=k[0]&2016,H=k[0]&63488,B=k[1]&31,d=k[1]&2016,h=k[1]&63488,k[2]=5*r+3*B>>3|5*l+3*d>>3&2016|5*H+3*h>>3&63488,k[3]=5*B+3*r>>3|5*d+3*l>>3&2016|5*h+3*H>>3&63488,r=a[w+2],l=4*M*e+4*c,m[l]=k[r&3],m[l+1]=k[r>>2&3],m[l+2]=k[r>>4&3],m[l+3]=k[r>>6&3],l+=e,m[l]=k[r>>8&3],m[l+1]=k[r>>
10&3],m[l+2]=k[r>>12&3],m[l+3]=k[r>>14],r=a[w+3],l+=e,m[l]=k[r&3],m[l+1]=k[r>>2&3],m[l+2]=k[r>>4&3],m[l+3]=k[r>>6&3],l+=e,m[l]=k[r>>8&3],m[l+1]=k[r>>10&3],m[l+2]=k[r>>12&3],m[l+3]=k[r>>14];return m}function b(a,b,e,l){var x=new Int32Array(e,0,31),N,F,G,D,H,I;if(542327876!=x[0])return B.error("Invalid magic number in DDS header"),0;if(!x[20]&4)return B.error("Unsupported format, must contain a FourCC code"),0;N=x[21];switch(N){case r:F=8;G=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case w:F=16;G=
b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case f:F=16;G=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return B.error("Unsupported FourCC code:",k(N)),null}I=1;x[2]&131072&&!1!==l&&(I=Math.max(1,x[7]));D=x[4];H=x[3];x=x[1]+4;if(b)for(N=0;N<I;++N)l=Math.max(4,D)/4*Math.max(4,H)/4*F,b=new Uint8Array(e,x,l),a.compressedTexImage2D(a.TEXTURE_2D,N,G,D,H,0,b),x+=l,D=Math.max(.5*D,1),H=Math.max(.5*H,1);else if(N==r)Math.max(4,D),Math.max(4,H),b=new Uint16Array(e),e=m(b,x/2,D,H),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,D,H,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,e),l&&a.generateMipmap(a.TEXTURE_2D);else return B.error("No manual decoder for",k(N),"and no native support"),0;return I}function e(a,e,f,k,m,r){var l=new XMLHttpRequest;l.open("GET",f,!0);l.responseType="arraybuffer";l.onload=function(){if(200==l.status){a.bindTexture(a.TEXTURE_2D,k);var f=b(a,e,l.response,m);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<f?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}r&&
r(k)};l.send(null);return k}function x(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function k(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var B=l("__print"),r=x("DXT1"),w=x("DXT3"),f=x("DXT5");a.UX=m;a.eU=b;a.hE=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.VO=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case r:b=6;break;case w:case f:b=4;break;default:B.error("Unsupported FourCC code:",k(a))}return b};
a.V_=e;a.U_=function(a,b,f,k){var m=a.createTexture();e(a,b,f,m,!0,k);return m}};b4w.module.__time=function(a,l){function m(){return-1!==b.Zi.Wq?b.Zi.Wq:f}var b=l("__config");l("__print");var e=0,x=0,k=[],B=0,r=0,w=[],f=-1;a.cH=function(a){e=a;x=performance.now();for(a=0;a<k.length;a++){var b=k[a];e>b.mw&&(k.splice(a,1),a--,b.callback())}for(a=0;a<w.length;a++){var b=w[a],f=1-(b.mw-e)/b.duration,f=Math.min(f,1);b.callback(b.from+f*(b.to-b.from));1==f&&(w.splice(a,1),a--)}};a.ao=function(){return e};a.dH=function(a,b){var f;B++;f=B;k.push({id:f,callback:a,mw:e+(performance.now()-
x+b)/1E3});return f};a.sq=function(a){for(var b=0;b<k.length;b++)if(k[b].id==a){k.splice(b,1);break}};a.qq=function(a){for(var b=w.length;b--;)if(w[b].id==a){w.splice(b,1);break}};a.Bk=function(a,b,f,k){f/=1E3;var m;r++;m=r;w.push({id:m,callback:k,from:a,to:b,mw:e+f,duration:f});k(a);return m};a.reset=function(){x=e=0;k.length=0;r=B=w.length=0};a.Ec=m;a.eS=function(a){f=a};a.Zn=function(a){return a*m()}};b4w.module.__renderer=function(a,l){function m(a){for(var b=a.k,g=a.D,c=0;c<g.length;c++){var p=g[c];if(p.ec){var m=p.mg,p=p.G;f.CR(p);f.KE()&&"DEBUG_VIEW"==p.type&&(p.Zv=z.mc(B.EL(p.Iq),p.Zv,1,15));var q=a,t=b,y=m,u=p,C=u.rb;D.useProgram(C.Tl);for(var m=u.oa,r=u.eq,n=C.cI,l=n.length;l--;){var A=n[l];A.ww(D,A.Kj,q,y,u,t)}if(C.Tr&&!C.Fx){C.Do.length||k(C);n=C.Do;for(l=n.length;l--;)A=n[l],A.ww(D,A.Kj,q,y,u,t);C.Tr=!1}D.depthMask(u.Ka);u.Db?D.enable(D.CULL_FACE):D.disable(D.CULL_FACE);t=u.fa;for(u=
0;u<t.length;u++)l=t[u],D.activeTexture(D.TEXTURE0+u),D.bindTexture(l.ac,l.hb);if("SKY"==q.type){t=q;C=C.ik;u=t.k.Wb.hb;l=t.ij;for(A=0;6>A;A++)if(n=x(A),d.yv?(D.bindTexture(D.TEXTURE_CUBE_MAP,u),D.texImage2D(n,0,D.RGBA,1,1,0,D.RGBA,D.UNSIGNED_BYTE,G)):(D.uniformMatrix4fv(C.u_cube_view_matrix,!1,l[A]),D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,n,u,0),e(m,r,y.Az)),t.Rr&&3!=A){var n=t,w=A,H=I;d.yv?H.set(G):(D.readPixels(191,191,1,1,D.RGBA,D.UNSIGNED_BYTE,H),255!=H[0]&&255!=H[1]&&255!=H[2]||
D.readPixels(191,220,1,1,D.RGBA,D.UNSIGNED_BYTE,H));var J=H[0],F=H[1],H=H[2],J=J/255,F=F/255,H=H/255;2===w?(n.fe[3]=J,n.fe[7]=F,n.fe[11]=H):2>w?(n.fe[4*w]=J,n.fe[4*w+1]=F,n.fe[4*w+2]=H):(n.fe[4*(w-2)]=J,n.fe[4*(w-2)+1]=F,n.fe[4*(w-2)+2]=H)}q.yn+=6}else e(m,r,y.Az),q.yn++;f.DR(p);f.KE()&&"MAIN"==p.type&&B.FL(p.id,p.tf)}}}function b(a){if(a){var b=(a.Xa?D.COLOR_BUFFER_BIT:0)|(a.Za?D.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=F;break;case "SHADOW_CAST":a=A;break;case "SHADOW_RECEIVE":a=
J;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=N;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=F;break;default:a=d.background_color}}else b=D.COLOR_BUFFER_BIT|D.DEPTH_BUFFER_BIT,a=d.background_color;D.colorMask(!0,!0,!0,!0);D.depthMask(!0);D.clearColor(a[0],a[1],a[2],a[3]);D.clear(b)}function e(a,d,b){D.bindBuffer(D.ARRAY_BUFFER,a.Hi);for(var c=0;c<d.length;c++){var e=d[c];D.enableVertexAttribArray(e.Kj);D.vertexAttribPointer(e.Kj,
e.jh,D.FLOAT,!1,0,e.DL+e.uO*b)}a.Zg?(D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,a.Zg),D.drawElements(a.mode,a.count,a.Ww,0)):D.drawArrays(a.mode,0,a.count);for(c=0;c<d.length;c++)e=d[c],D.disableVertexAttribArray(e.Kj)}function x(a){switch(a){case 0:return D.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return D.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return D.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return D.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return D.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return D.TEXTURE_CUBE_MAP_NEGATIVE_Z}}
function k(a){var d=a.ik,b=[],c=[],e={},f;for(f in d){var k=!1;switch(f){case "u_proj_matrix":var t=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.Bb)},k=!0;break;case "u_view_matrix":t=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.nb)};k=!0;break;case "u_view_tsr":case "u_view_tsr_frag":t=function(a,c,d,b,e,h){h.kc?a.uniformMatrix3fv(c,!1,h.cy):a.uniformMatrix3fv(c,!1,h.jf)};k=!0;break;case "u_view_zup_tsr":t=function(a,c,d,b,e,h){h.kc?a.uniformMatrix3fv(c,!1,h.dy):a.uniformMatrix3fv(c,!1,h.Ez)};
k=!0;break;case "u_view_zup_tsr_inverse":t=function(a,c,d,b,e,h){h.kc?a.uniformMatrix3fv(c,!1,h.rG):a.uniformMatrix3fv(c,!1,h.FI)};k=!0;break;case "u_shadow_cast_billboard_view_tsr":t=function(a,c,d,b,e,h){a.uniformMatrix3fv(c,!1,h.Ny)};k=!0;break;case "u_view_proj_prev":t=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.oR)};k=!0;break;case "u_view_proj_matrix":t=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.Rf)};k=!0;break;case "u_view_proj_inverse":t=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,
!1,h.GI)};k=!0;break;case "u_sky_vp_inverse":t=function(a,c,d,b,e,h){a.uniformMatrix4fv(c,!1,h.tg)};k=!0;break;case "u_camera_eye":case "u_camera_eye_frag":t=function(a,c,d,b,e,h){a.uniform3fv(c,g.Xh(h.i,H))};k=!0;break;case "u_camera_quat":t=function(a,c,d,b,e,h){a.uniform4fv(c,g.B(h.i))};k=!0;break;case "u_view_max_depth":t=function(a,c,d,b,e,h){a.uniform1f(c,h.far)};k=!0;break;case "u_camera_range":t=function(a,c,d,b,e,h){a.uniform2f(c,h.near,h.far)};break;case "u_csm_center_dists":t=function(a,
c,d,b,e,h){a.uniform4fv(c,h.tC)};break;case "u_cam_water_depth":t=function(a,c,d){a.uniform1f(c,d.pv)};k=!0;break;case "u_waves_height":t=function(a,c,d){a.uniform1f(c,d.Hz)};break;case "u_waves_length":t=function(a,c,d){a.uniform1f(c,d.Iz)};break;case "u_fog_color_density":t=function(a,c,d){a.uniform4fv(c,d.od)};break;case "u_fog_params":t=function(a,c,d){a.uniform4fv(c,d.Te)};break;case "u_underwater_fog_color_density":t=function(a,c,d){a.uniform4fv(c,d.Sf)};break;case "u_bloom_key":t=function(a,
c,d){a.uniform1f(c,d.bloom_key)};break;case "u_bloom_edge_lum":t=function(a,c,d){a.uniform1f(c,d.bloom_edge_lum)};break;case "u_time":t=function(a,c,d){a.uniform1f(c,d.time)};k=!0;break;case "u_wind":t=function(a,c,d){a.uniform3fv(c,d.Ch)};k=!0;break;case "u_sky_tex_dvar":t=function(a,c,d){a.uniform1f(c,d.nH)};break;case "u_sky_tex_fac":t=function(a,c,d){a.uniform4fv(c,d.oH)};break;case "u_sky_tex_color":t=function(a,c,d){a.uniform3fv(c,d.mH)};break;case "u_horizon_color":t=function(a,c,d){a.uniform3fv(c,
d.ne)};break;case "u_zenith_color":t=function(a,c,d){a.uniform3fv(c,d.Je)};break;case "u_environment_energy":t=function(a,c,d){a.uniform1f(c,d.Tg)};break;case "u_sky_color":t=function(a,c,d){a.uniform3fv(c,d.am)};break;case "u_rayleigh_brightness":t=function(a,c,d){a.uniform1f(c,d.rayleigh_brightness)};break;case "u_mie_brightness":t=function(a,c,d){a.uniform1f(c,d.mie_brightness)};break;case "u_spot_brightness":t=function(a,c,d){a.uniform1f(c,d.spot_brightness)};break;case "u_scatter_strength":t=
function(a,c,d){a.uniform1f(c,d.scatter_strength)};break;case "u_rayleigh_strength":t=function(a,c,d){a.uniform1f(c,d.rayleigh_strength)};break;case "u_mie_strength":t=function(a,c,d){a.uniform1f(c,d.mie_strength)};break;case "u_rayleigh_collection_power":t=function(a,c,d){a.uniform1f(c,d.rayleigh_collection_power)};break;case "u_mie_collection_power":t=function(a,c,d){a.uniform1f(c,d.mie_collection_power)};break;case "u_mie_distribution":t=function(a,c,d){a.uniform1f(c,d.mie_distribution)};break;
case "u_light_positions":t=function(a,c,d){a.uniform3fv(c,d.Ir)};break;case "u_light_directions":t=function(a,c,d){a.uniform3fv(c,d.mx)};break;case "u_light_color_intensities":t=function(a,c,d){a.uniform3fv(c,d.Hr)};break;case "u_light_factors":t=function(a,c,d){a.uniform4fv(c,d.nx)};break;case "u_sun_quaternion":t=function(a,c,d){a.uniform4fv(c,d.FH)};break;case "u_sun_intensity":t=function(a,c,d){a.uniform3fv(c,d.EH)};break;case "u_sun_direction":t=function(a,c,d){a.uniform3fv(c,d.dz)};break;case "u_height":t=
function(a,c,d,b,e,h){a.uniform1f(c,h.height)};k=!0;break;case "u_model_tsr":t=function(a,c,d,b){a.uniformMatrix3fv(c,!1,b.i)};k=!0;break;case "u_model_zup_tsr":t=function(a,c,d,b){a.uniformMatrix3fv(c,!1,b.Nz)};k=!0;break;case "u_model_zup_tsr_inverse":t=function(a,c,d,b){a.uniformMatrix3fv(c,!1,b.QI)};k=!0;break;case "u_transb":t=function(a,c,d,b){a.uniform4fv(c,b.Td)};k=!0;break;case "u_transa":t=function(a,c,d,b){a.uniform4fv(c,b.Ee)};k=!0;break;case "u_arm_rel_trans":t=function(a,c,d,b){a.uniform4fv(c,
b.Xu)};k=!0;break;case "u_arm_rel_quat":t=function(a,c,d,b){a.uniform4fv(c,b.Wu)};k=!0;break;case "u_quat":t=function(a,c,d,b){a.uniform4fv(c,g.B(b.i))};k=!0;break;case "u_quatsb":t=function(a,c,d,b){a.uniform4fv(c,b.Kd)};k=!0;break;case "u_quatsa":t=function(a,c,d,b){a.uniform4fv(c,b.te)};k=!0;break;case "u_frame_factor":t=function(a,c,d,b){a.uniform1f(c,b.Ue)};k=!0;break;case "au_center_pos":t=function(){};k=!0;break;case "au_wind_bending_amp":t=function(a,c,d,b){a.uniform1f(c,b.Ag)};k=!0;break;
case "au_wind_bending_freq":t=function(a,c,d,b){a.uniform1f(c,b.Dh)};k=!0;break;case "au_detail_bending_freq":t=function(a,c,d,b){a.uniform1f(c,b.Qg)};k=!0;break;case "au_detail_bending_amp":t=function(a,c,d,b){a.uniform1f(c,b.Pg)};k=!0;break;case "au_branch_bending_amp":t=function(a,c,d,b){a.uniform1f(c,b.Ig)};k=!0;break;case "u_node_values":t=function(a,c,d,b,e){a.uniform1fv(c,e.Qj)};k=!0;break;case "u_node_rgbs":t=function(a,c,d,b,e){a.uniform3fv(c,e.qe)};k=!0;break;case "u_diffuse_color":t=function(a,
c,d,b,e){a.uniform4fv(c,e.uf)};k=!0;break;case "u_diffuse_intensity":t=function(a,c,d,b,e){a.uniform1f(c,e.Bn)};k=!0;break;case "u_diffuse_params":t=function(a,c,d,b,e){a.uniform2fv(c,e.ie)};k=!0;break;case "u_emit":t=function(a,c,d,b,e){a.uniform1f(c,e.Wk)};k=!0;break;case "u_ambient":t=function(a,c,d,b,e){a.uniform1f(c,e.Ak)};k=!0;break;case "u_specular_color":t=function(a,c,d,b,e){a.uniform3fv(c,e.Yo)};k=!0;break;case "u_specular_alpha":t=function(a,c,d,b,e){a.uniform1f(c,e.Wy)};k=!0;break;case "u_specular_params":t=
function(a,c,d,b,e){a.uniform3fv(c,e.cm)};k=!0;break;case "u_reflect_factor":t=function(a,c,d,b,e){a.uniform1f(c,e.ss)};k=!0;break;case "u_mirror_factor":t=function(a,c,d,b,e){a.uniform1f(c,e.xx)};k=!0;break;case "u_grass_map_dim":t=function(a,c,d,b,e){a.uniform3fv(c,e.Cd)};k=!0;break;case "u_grass_size":t=function(a,c,d,b,e){a.uniform1f(c,e.Pw)};k=!0;break;case "u_scale_threshold":t=function(a,c,d,b,e){a.uniform1f(c,e.jE)};k=!0;break;case "u_cube_fog":t=function(a,c,d,b,e){a.uniformMatrix4fv(c,!1,
e.fe)};break;case "u_jitter_amp":t=function(a,c,d,b,e){a.uniform1f(c,e.RE)};k=!0;break;case "u_jitter_freq":t=function(a,c,d,b,e){a.uniform1f(c,e.SE)};k=!0;break;case "u_debug_view_mode":t=function(a,c,d){a.uniform1i(c,d.debug_view_mode)};break;case "u_debug_colors_seed":t=function(a,c,d){a.uniform1f(c,d.debug_colors_seed)};break;case "u_debug_render_time_threshold":t=function(a,c,d){a.uniform1f(c,d.zC)};break;case "u_wireframe_edge_color":t=function(a,c,d,b,e){a.uniform3fv(c,e.wireframe_edge_color)};
break;case "u_cluster_id":t=function(a,c,d,b,e){a.uniform1f(c,e.jn)};k=!0;break;case "u_batch_debug_id_color":t=function(a,c,d,b,e){a.uniform1f(c,e.yC)};k=!0;break;case "u_batch_debug_main_render_time":t=function(a,c,d,b,e){a.uniform1f(c,e.Zv)};k=!0;break;case "u_subpixel_jitter":t=function(a,c,d){a.uniform2fv(c,d.WP)};k=!0;break;case "u_subsample_indices":t=function(a,c,d){a.uniform4fv(c,d.XP)};k=!0;break;case "u_refr_bump":t=function(a,c,d,b,e){a.uniform1f(c,e.tG)};k=!0;break;case "u_line_width":t=
function(a,c,d,b,e){a.uniform1f(c,e.dF)};k=!0;break;case "u_lamp_light_positions":t=function(a,c,d,b,e){a.uniform3fv(c,e.ix)};break;case "u_lamp_light_directions":t=function(a,c,d,b,e){a.uniform3fv(c,e.gx)};break;case "u_lamp_light_color_intensities":t=function(a,c,d,b,e){a.uniform3fv(c,e.fx)};break;case "u_lamp_light_factors":t=function(a,c,d,b,e){a.uniform4fv(c,e.hx)};break;case "u_halo_size":t=function(a,c,d,b,e){a.uniform1f(c,e.qE)};k=!0;break;case "u_halo_hardness":t=function(a,c,d,b,e){a.uniform1f(c,
e.nE)};k=!0;break;case "u_halo_rings_color":t=function(a,c,d,b,e){a.uniform3fv(c,e.pE)};k=!0;break;case "u_halo_lines_color":t=function(a,c,d,b,e){a.uniform3fv(c,e.oE)};k=!0;break;case "u_halo_stars_blend":t=function(a,c,d,b,e){a.uniform1f(c,e.rE)};k=!0;break;case "u_halo_stars_height":t=function(a,c,d,b,e){a.uniform1f(c,e.sE)};k=!0;break;case "u_fresnel_params":t=function(a,c,d,b,e){a.uniform4fv(c,e.sj)};k=!0;break;case "u_texture_scale":t=function(a,c,d,b,e){a.uniform3fv(c,e.Bi)};k=!0;break;case "u_parallax_scale":t=
function(a,c,d,b,e){a.uniform1f(c,e.bs)};k=!0;break;case "u_color_id":t=function(a,c,d,b){a.uniform3fv(c,b.vq)};k=!0;break;case "u_line_points":t=function(a,c,d,b,e){a.uniform3fv(c,e.R_)};k=!0;break;case "u_diffuse_color_factor":t=function(a,c,d,b,e){a.uniform1f(c,e.An)};k=!0;break;case "u_alpha_factor":t=function(a,c,d,b,e){a.uniform1f(c,e.Qm)};k=!0;break;case "u_specular_color_factor":t=function(a,c,d,b,e){a.uniform1f(c,e.Vs)};k=!0;break;case "u_normal_factor":t=function(a,c,d,b,e){a.uniform1f(c,
e.GF)};k=!0;break;case "u_normalmap0_scale":t=function(a,c,d,b,e){a.uniform2fv(c,e.Rj[0])};k=!0;break;case "u_normalmap1_scale":t=function(a,c,d,b,e){a.uniform2fv(c,e.Rj[1])};k=!0;break;case "u_normalmap2_scale":t=function(a,c,d,b,e){a.uniform2fv(c,e.Rj[2])};k=!0;break;case "u_normalmap3_scale":t=function(a,c,d,b,e){a.uniform2fv(c,e.Rj[3])};k=!0;break;case "u_foam_factor":t=function(a,c,d,b,e){a.uniform1f(c,e.Vq)};k=!0;break;case "u_foam_uv_freq":t=function(a,c,d,b,e){a.uniform2fv(c,e.TC)};k=!0;break;
case "u_foam_mag":t=function(a,c,d,b,e){a.uniform2fv(c,e.SC)};k=!0;break;case "u_foam_scale":t=function(a,c,d,b,e){a.uniform2fv(c,e.qw)};k=!0;break;case "u_water_norm_uv_velocity":t=function(a,c,d,b,e){a.uniform1f(c,e.tt)};k=!0;break;case "u_shallow_water_col":t=function(a,c,d,b,e){a.uniform3fv(c,e.Ls)};k=!0;break;case "u_shore_water_col":t=function(a,c,d,b,e){a.uniform3fv(c,e.Ps)};k=!0;break;case "u_water_shallow_col_fac":t=function(a,c,d,b,e){a.uniform1f(c,e.Ms)};k=!0;break;case "u_water_shore_col_fac":t=
function(a,c,d,b,e){a.uniform1f(c,e.Qs)};k=!0;break;case "u_p_length":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.PH)};k=!0;break;case "u_p_cyclic":t=function(a,c,d,b,e){a.uniform1i(c,e.Qa.nd)};k=!0;break;case "u_p_max_lifetime":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.cF)};k=!0;break;case "u_p_fade_in":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.pj)};k=!0;break;case "u_p_fade_out":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.ke)};k=!0;break;case "u_p_size":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.size)};k=
!0;break;case "u_p_alpha_start":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.eB)};k=!0;break;case "u_p_alpha_end":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.dB)};k=!0;break;case "u_p_nfactor":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.Ex)};k=!0;break;case "u_p_gravity":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.kE)};k=!0;break;case "u_p_mass":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.kg)};k=!0;break;case "u_p_color_ramp":t=function(a,c,d,b,e){a.uniform4fv(c,e.Qa.YB)};k=!0;break;case "u_p_wind_fac":t=function(a,
c,d,b,e){a.uniform1f(c,e.Qa.MI)};k=!0;break;case "u_texel_size":t=function(a,c,d){a.uniform2fv(c,d.mz)};k=!0;break;case "u_p_time":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.time)};k=!0;break;case "u_p_tilt":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.NH)};k=!0;break;case "u_p_tilt_rand":t=function(a,c,d,b,e){a.uniform1f(c,e.Qa.OH)};k=!0;break;case "u_position":t=function(a,c,d,b,e){a.uniform3fv(c,e.Ql)};k=!0;break;case "u_va_frame_factor":t=function(a,c,d,b){a.uniform1f(c,b.tI)};k=!0;break;case "u_normal_offset":t=
function(a,c,d){a.uniform1f(c,d.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":t=function(a,c,d,b,e,h){a.uniform4fv(c,h.gs)};break;case "u_v_light_ts":t=function(a,c,d){a.uniform4fv(c,d.qt)};k=!0;break;case "u_v_light_r":t=function(a,c,d){a.uniform4fv(c,d.pt)};k=!0;break;case "u_v_light_tsr":t=function(a,c,d){a.uniformMatrix3fv(c,!1,d.zz)};k=!0;break;case "u_p_light_matrix0":t=function(a,c,d){a.uniformMatrix4fv(c,!1,d.Wj[0])};k=!0;break;case "u_p_light_matrix1":t=function(a,c,d){a.uniformMatrix4fv(c,
!1,d.Wj[1])};k=!0;break;case "u_p_light_matrix2":t=function(a,c,d){a.uniformMatrix4fv(c,!1,d.Wj[2])};k=!0;break;case "u_p_light_matrix3":t=function(a,c,d){a.uniformMatrix4fv(c,!1,d.Wj[3])};k=!0;break;case "u_motion_blur_exp":t=function(a,c,d){a.uniform1f(c,d.sF)};k=!0;break;case "u_motion_blur_decay_threshold":t=function(a,c,d){a.uniform1f(c,d.mb_decay_threshold)};k=!0;break;case "u_refl_plane":t=function(a,c,d,b){a.uniform4fv(c,b.kc)};k=!0;break;case "u_radial_blur_step":t=function(a,c,d){a.uniform1f(c,
d.rs)};break;case "u_god_rays_intensity":t=function(a,c,d){a.uniform1f(c,d.god_rays_intensity)};break;case "u_ssao_radius_increase":t=function(a,c,d){a.uniform1f(c,d.hm)};break;case "u_ssao_blur_discard_value":t=function(a,c,d){a.uniform1f(c,d.ssao_blur_discard_value)};k=!0;break;case "u_ssao_influence":t=function(a,c,d){a.uniform1f(c,d.gm)};break;case "u_ssao_dist_factor":t=function(a,c,d){a.uniform1f(c,d.fm)};break;case "u_dof_dist":t=function(a,c,d,b,e,h){h.dof_on?a.uniform1f(c,h.dof_distance):
a.uniform1f(c,0)};k=!0;break;case "u_dof_front":t=function(a,c,d,b,e,h){a.uniform1f(c,h.dof_front)};k=!0;break;case "u_dof_rear":t=function(a,c,d,b,e,h){a.uniform1f(c,h.dof_rear)};k=!0;break;case "u_outline_intensity":t=function(a,c,d,b){a.uniform1f(c,b.lh)};k=!0;break;case "u_outline_color":t=function(a,c,d){a.uniform3fv(c,d.kh)};break;case "u_draw_outline":t=function(a,c,d){a.uniform1f(c,d.jw)};k=!0;break;case "u_glow_mask_small_coeff":t=function(a,c,d){a.uniform1f(c,d.small_glow_mask_coeff)};k=
!0;break;case "u_glow_mask_large_coeff":t=function(a,c,d){a.uniform1f(c,d.large_glow_mask_coeff)};k=!0;break;case "u_brightness":t=function(a,c,d){a.uniform1f(c,d.brightness)};break;case "u_contrast":t=function(a,c,d){a.uniform1f(c,d.contrast)};break;case "u_exposure":t=function(a,c,d){a.uniform1f(c,d.exposure)};break;case "u_saturation":t=function(a,c,d){a.uniform1f(c,d.saturation)};break;case "u_enable_hmd_stereo":t=function(a,c,d){a.uniform1i(c,d.enable_hmd_stereo)};break;case "u_distortion_params":t=
function(a,c,d){a.uniform4fv(c,d.lj)};break;case "u_chromatic_aberration_coefs":t=function(a,c,d){a.uniform4fv(c,d.chromatic_aberration_coefs)};break;default:t=null}t&&(t={name:f,ww:t,Kj:d[f]},k?b.push(t):(c.push(t),e[f]=t))}a.cI=b;c.length?(a.Do=c,a.Rx=e):a.Fx=!0}var B=l("__batch"),r=l("__camera"),w=l("__config"),f=l("__debug"),q=l("__textures"),g=l("__tsr"),z=l("__util"),A=[1,1,1,1],J=[1,1,1,1],N=[0,0,0,1],F=[0,0,0,0],G=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,
.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var D=null,H=new Float32Array(3),I=new Uint8Array(4);new Float32Array(9);new Float32Array(8);var d=w.v;a.xe=function(a){var b=d.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);D=a};a.Vk=function(a){if(a.ec)if("RESOLVE"==a.type){f.iy(a);var e=a.k;D.bindFramebuffer(D.READ_FRAMEBUFFER,
e.uw);D.bindFramebuffer(D.DRAW_FRAMEBUFFER,e.Ve);var k=0;e.Wb&&(k|=D.COLOR_BUFFER_BIT);e.he&&(k|=D.DEPTH_BUFFER_BIT);D.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,k,D.NEAREST);f.jy(a);f.tv("draw resolve")}else if("COPY"==a.type)f.iy(a),e=a.k,D.bindFramebuffer(D.FRAMEBUFFER,e.uw),D.bindTexture(D.TEXTURE_2D,e.Wb.hb),D.copyTexSubImage2D(D.TEXTURE_2D,0,0,0,0,0,e.width,e.height,0),f.jy(a),f.tv("draw copy");else{f.iy(a);e=a.k;D.bindFramebuffer(D.FRAMEBUFFER,e.Ve);a.Yu&&(k=e.Wb,D.framebufferTexture2D(D.FRAMEBUFFER,
D.COLOR_ATTACHMENT0,k.ac,k.hb,0));D.viewport(0,0,e.width,e.height);"MAIN_CUBE_REFLECT"!=a.type&&"MAIN_CUBE_REFLECT_BLEND"!=a.type&&b(a);a.eb?D.enable(D.BLEND):D.disable(D.BLEND);a.Zc?D.enable(D.DEPTH_TEST):D.disable(D.DEPTH_TEST);switch(a.type){case "SHADOW_CAST":D.enable(D.POLYGON_OFFSET_FILL);D.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);D.cullFace(D.BACK);break;case "MAIN_PLANE_REFLECT":case "MAIN_PLANE_REFLECT_BLEND":D.disable(D.POLYGON_OFFSET_FILL);D.cullFace(D.FRONT);
break;case "DEBUG_VIEW":D.enable(D.POLYGON_OFFSET_FILL);D.polygonOffset(-4,-4);D.cullFace(D.BACK);break;case "MAIN_GLOW":if(1<d.uc){D.enable(D.POLYGON_OFFSET_FILL);D.polygonOffset(-2,-2);break}default:D.disable(D.POLYGON_OFFSET_FILL),D.cullFace(D.BACK)}if("MAIN_CUBE_REFLECT"==a.type||"MAIN_CUBE_REFLECT_BLEND"==a.type)for(var e=a.k,k=e.Wb.hb,c=0;6>c;c++){var p=x(c);e.nb=a.ij[c];g.Xg(e.nb,e.jf);r.mv(e);D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,p,k,0);b(a);for(var p=a.D,q=0;q<p.length;q++)p[q].ec=
p[q].iw[c];m(a)}else m(a);f.jy(a);f.tv("draw subscene: "+a.type);D.bindFramebuffer(D.FRAMEBUFFER,null)}};a.clear=function(a){D.bindFramebuffer(D.FRAMEBUFFER,a.k.Ve);b(a)};a.wL=function(a){var d=a.eq;d.length=0;var b=a.oa;a=a.rb;b&&a||z.l("Incomplete batch");b=b.ed;a=a.attributes;for(var c in a){var e=b[c];d.push({Kj:a[c],DL:4*e.offset,uO:1<e.frames?4*e.length:0,jh:e.jh})}};a.AL=k;a.nB=function(a){var d=a.rb,b=a.fa;a=a.Sc;D.useProgram(d.Tl);for(var c=0;c<b.length;c++)D.uniform1i(d.ik[a[c]],c)};a.by=
function(a,d,b,c,e,f){c||(c=1);e||(e=1);f||(f=new Uint8Array(4*c*e));f.length!=4*c*e&&z.l("read_pixels(): Wrong storage");D.bindFramebuffer(D.FRAMEBUFFER,a);D.readPixels(d,b,c,e,D.RGBA,D.UNSIGNED_BYTE,f);D.bindFramebuffer(D.FRAMEBUFFER,null);return f};a.ET=function(a){var d=a.rb;d.Fx||(D.useProgram(d.Tl),d.Do.length||k(d),d=d.Rx.u_cube_fog,d.ww(D,d.Kj,null,null,a,null))};a.BR=function(a,d){var b=D.createFramebuffer();D.bindFramebuffer(D.FRAMEBUFFER,b);if(q.pl(a)){var c=a.Ge;D.framebufferRenderbuffer(D.FRAMEBUFFER,
D.COLOR_ATTACHMENT0,D.RENDERBUFFER,c)}else if(q.sl(a)){var e=a,c=e.hb,e=e.ac==D.TEXTURE_CUBE_MAP?D.TEXTURE_CUBE_MAP_NEGATIVE_Z:e.ac;D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,e,c,0)}q.pl(d)?(c=d.Ge,D.framebufferRenderbuffer(D.FRAMEBUFFER,D.DEPTH_ATTACHMENT,D.RENDERBUFFER,c)):q.sl(d)&&(e=d,c=e.hb,e=e.ac,D.framebufferTexture2D(D.FRAMEBUFFER,D.DEPTH_ATTACHMENT,e,c,0));f.jM();D.bindFramebuffer(D.FRAMEBUFFER,null);return b};a.AR=function(a,d,b,c,e){null==a?(D.bindFramebuffer(D.FRAMEBUFFER,
a),D.viewport(0,0,c,e),D.clear(D.COLOR_BUFFER_BIT|D.DEPTH_BUFFER_BIT)):(q.pl(d)?D.deleteRenderbuffer(d.Ge):q.sl(d)&&D.deleteTexture(d.hb),q.pl(b)?D.deleteRenderbuffer(b.Ge):q.sl(b)&&D.deleteTexture(b.hb),D.deleteFramebuffer(a))};a.x_=function(){};a.QN=function(a,d,b,c,f,g){a=a.hb;D.viewport(0,0,b,b);D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,d,a,0);d=B.Nv("FLIP_CUBEMAP_COORDS");a=d.rb;D.activeTexture(D.TEXTURE0);D.bindTexture(D.TEXTURE_2D,f);var k=f=0;b!=c&&(f=1/(6*c),k=1/(4*c));D.uniform1i(a.ik.u_tex_number,
g);D.uniform2fv(a.ik.u_delta,[f,k]);D.useProgram(a.Tl);e(d.oa,d.eq,0);D.bindTexture(D.TEXTURE_2D,null)};a.RN=function(a,d,b,c,f){D.bindFramebuffer(D.FRAMEBUFFER,c);c=a.hb;a=a.ac;D.bindTexture(a,c);D.viewport(0,0,d,b);D.texImage2D(a,0,D.RGBA,d,b,0,D.RGBA,D.UNSIGNED_BYTE,null);D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,a,c,0);d=B.Nv("NONE");b=d.rb;D.bindTexture(a,null);D.activeTexture(D.TEXTURE0);D.bindTexture(a,f);D.useProgram(b.Tl);e(d.oa,d.eq,0);D.bindFramebuffer(D.FRAMEBUFFER,null);
D.bindTexture(a,null)};a.ha=function(){}};b4w.module.__camera=function(a,l){function m(a,c,d,b,e){ha.lc(a,c);d&&F(a,c,d);H(a,b);I(a,e)}function b(a,d,b,e,h,f,g,n){var k=a.g;ha.lc(a,d);k.pivot.set(b);F(a,d,b);H(a,e);I(a,h);M(a,f);c(a,g);k.use_panning=n}function e(a,c,b,e,h,f,g,n){var k=a.g;ha.lc(a,c);k.wb.set(b);F(a,c,b);v(a,e);d(a,h);p(a,f);R(a,g);k.Ln=n}function x(a,c,d){var b=a.g,e=ja.q(b.i),h=ja.B(b.i),b=ca;b.set(Z.wc);b[3]=0;a=q(a,ua)[1];h=Z.Cb(h,Z.md,U);E.XG(Ja,e);E.Hy(Ja,h);if(!Z.ox(b,-c,Ja,d)||Math.abs(a)<ta)S.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
d[0]=e[0],d[1]=0,d[2]=e[2];return d}function k(c){for(var d=c.g,b=0;b<c.A.length;b++){var e=c.A[b].U[0];if(e.type==a.Wd)switch(d.lb){case a.bb:var h=ja.q(d.i);d.ll=Q.dist(h,d.pivot);d.ml=e.top;break;case a.yc:h=ja.q(d.i),d.ll=Q.dist(h,d.wb),d.ml=e.top}}}function B(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function r(c){switch(c){case "STATIC":return a.Vf;
case "TARGET":return a.bb;case "EYE":return a.xc;case "HOVER":return a.yc;default:Z.l("Unknown move style")}}function w(c){var d={type:c,name:"",M1:1,width:0,height:0,Ve:null,uw:null,Wb:null,he:null,ib:0,Bd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,Dd:Ba.create(),i:new Float32Array(9),nb:new Float32Array(16),Bb:new Float32Array(16),Rf:new Float32Array(16),GI:new Float32Array(16),oR:new Float32Array(16),tg:new Float32Array(16),jf:ja.$f(),Ez:ja.$f(),FI:ja.$f(),cy:ja.$f(),dy:ja.$f(),rG:ja.$f(),Ny:ja.$f(),
dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,je:null,dof_on:!1,iF:new Float32Array(3),cl:B(),mm:0,gf:0,kc:null,vn:null,Qv:null,tC:new Float32Array(4),gs:new Float32Array(4)};d.Dd[0]=d.Dd[2]=45;d.Dd[1]=d.Dd[3]=55;if(c==a.Ac)return d;switch(c){case a.Vc:z(d,40,.1,1E3);break;case a.Wd:z(d,2.5,.1,1E3);break;case a.Dg:break;case a.Gh:break;case a.Ui:break;case a.cc:case a.pc:case a.wd:case a.xd:Z.l("Stereo camera may only be created from perspective one");break;default:Z.l("Unknown camera type")}return d}
function f(c,d,b){c.type!=a.cc&&c.type!=a.pc&&c.type!=a.wd&&c.type!=a.xd&&Z.l("set_stereo_params(): wrong camera type");if(c.type==a.cc||c.type==a.pc)c.mm=d;c.gf=b;T(c,c.ib);if(Ca.za()&&(d=Ca.o(),c=d.j.Rc))for(d=ka.aa(Ca.fl(d),d).U,b=0;b<d.length;b++)W(d[b],c)}function q(a,c){return g(ja.B(a.g.i),c)}function g(a,c){var d=Z.Cb(a,Z.wc,U),b=Z.Cb(a,Z.lf,xa),e=-Math.asin(d[1]/Q.length(d)),d=Math.abs(e)>Math.PI/4?Q.scale(b,-Z.sign(e),da):Q.scale(d,-Z.sign(b[1]),da),h=Math.atan(Math.abs(d[0]/d[2]));0<b[1]&&
(e=Z.sign(e)*Math.PI-e);b=h;0>d[2]&&(b=Math.PI-b);0>d[0]&&(b=2*Math.PI-b);c[0]=b;c[1]=e;return c}function z(c,d,b,e,h){switch(c.type){case a.Vc:case a.cc:case a.pc:c.Bd=d;c.ib=1;break;case a.Wd:c.top=d;c.ib=1;break;case a.Dg:delete c.Bd;c.Bd=d;c.ib=h/d;break;case a.Gh:c.top=d;c.ib=h/d;break;case a.wd:case a.xd:break;default:S.error("set_frustum(): Unsupported camera type: "+c.type)}c.near=b;c.far=e}function A(c,d){var b=ga.fromRotationTranslation(ja.B(d.g.i),ja.q(d.g.i),Aa);ga.rotateX(b,-Math.PI/
2,b);ga.invert(b,c.nb);if(Ca.za())var b=Ca.o(),e=Ca.qa(b,"STEREO");if(c.type==a.cc||e&&e.enable_hmd_stereo&&c.type==a.wd)c.nb[12]+=c.gf/2;else if(c.type==a.pc||e&&e.enable_hmd_stereo&&c.type==a.xd)c.nb[12]-=c.gf/2;if(c.kc){ja.Xg(c.nb,c.cy);ja.SH(c.cy,c.dy);ja.invert(c.dy,c.rG);var b=c.kc[0],e=c.kc[1],h=c.kc[2],f=c.kc[3],g=Aa;g[0]=1-2*b*b;g[1]=-2*b*e;g[2]=-2*b*h;g[3]=0;g[4]=-2*b*e;g[5]=1-2*e*e;g[6]=-2*e*h;g[7]=0;g[8]=-2*b*h;g[9]=-2*e*h;g[10]=1-2*h*h;g[11]=0;g[12]=-2*b*f;g[13]=-2*e*f;g[14]=-2*h*f;g[15]=
1;ga.multiply(c.nb,g,c.nb);T(c,c.ib,!0);b=ca;e=Aa;ga.invert(c.nb,e);ga.transpose(e,e);Ba.transformMat4(c.kc,e,b);e=za;e[0]=(Z.sign(b[0])+c.Bb[8])/c.Bb[0];e[1]=(Z.sign(b[1])+c.Bb[9])/c.Bb[5];e[2]=-1;e[3]=(1+c.Bb[10])/c.Bb[14];Ba.scale(b,2/(b[0]*e[0]+b[1]*e[1]+b[2]*e[2]+b[3]*e[3]),b);c.Bb[2]=b[0];c.Bb[6]=b[1];c.Bb[10]=b[2]+1;c.Bb[14]=b[3]}ja.Xg(c.nb,c.jf);ja.SH(c.jf,c.Ez);ja.invert(c.Ez,c.FI);V(c);O(c);ja.copy(d.g.i,c.i)}function J(c,d,b,e){ga.lookAt(d,b,e,c.nb);b=Ca.o();b=Ca.qa(b,"STEREO");Ca.za()&&
(b=Ca.o(),b=Ca.qa(b,"STEREO"));if(c.type==a.cc||b&&b.enable_hmd_stereo&&c.type==a.wd)c.nb[12]+=c.gf/2;else if(c.type==a.pc||b&&b.enable_hmd_stereo&&c.type==a.xd)c.nb[12]-=c.gf/2;ja.Xg(c.nb,c.jf);V(c);O(c);ja.ff(d,c.i)}function N(a,c,d){d=Q.subtract(d,c,U);Q.length(d)&&(Q.normalize(d,d),d=Z.CG(Z.md,d,P),ha.sg(a,d));ha.lc(a,c)}function F(a,c,d){var b=a.g,e=0<Z.Cb(ja.B(a.g.i),Z.lf,U)[1];N(a,c,d);e?(c=Q.copy(b.hf,U),Q.negate(c,c),ia.Rh(a,c,!0)):ia.Rh(a,b.hf,!0)}function G(a,c){var d=a.g,b=c.U;b||Z.l("Wrong object");
for(var e=c.kH,h=0;h<e.length;h++){var f=e[h];Q.copy(ja.q(d.i),f.iF)}for(h=0;h<b.length;h++)if(f=b[h],A(f,a),Z.Rq(f.Rf,f.cl),f.je&&f.dof_on){var e=ja.q(d.i),g=ha.yf(f.je,U),e=Q.dist(e,g);f.dof_distance=e}}function D(c){var d=c.g;d.lb==a.bb&&(d.$s=0<Z.Cb(ja.B(c.g.i),Z.lf,U)[1])}function H(c,d){var b=c.g;if(d){b.$a=b.$a||{};b.$a.left=d.left;b.$a.right=d.right;b.$a.vl=d.left;b.$a.Ul=d.right;b.$a.camera_space=Boolean(d.camera_space);var e=c.g;!(b=e.$a)||e.lb!=a.xc&&e.lb!=a.bb||(e=q(c,ua),b.camera_space?
(b.left+=e[0],b.right+=e[0]):(b.vl-=e[0],b.Ul-=e[0]),b.left=Z.Eg(b.left),b.right=Z.Eg(b.right),b.vl=Z.Eg(b.vl),b.Ul=Z.Eg(b.Ul))}else b.$a=null}function I(a,c){var d=a.g;c?(d.va=d.va||{},d.va.down=c.down,d.va.up=c.up,d.va.Uk=c.down,d.va.um=c.up,d.va.camera_space=Boolean(c.camera_space),h(a)):d.va=null}function d(a,c){var d=a.g;if(!c){var b=q(a,ua);c={down:b[1],up:b[1]}}d.va=d.va||{};d.va.down=c.down;d.va.up=c.up;h(a);d.fb&&d.va&&n(a)}function h(c){var d=c.g,b=d.va;if(b)switch(d.lb){case a.xc:case a.bb:c=
q(c,ua);b.camera_space?(b.up+=c[1],b.down+=c[1]):(b.um-=c[1],b.Uk-=c[1]);b.up=Z.qf(b.up,-Math.PI,Math.PI);b.down=Z.qf(b.down,-Math.PI,Math.PI);b.um=Z.qf(b.um,-Math.PI,Math.PI);b.Uk=Z.qf(b.Uk,-Math.PI,Math.PI);break;case a.yc:b.up=Z.qf(b.up,-Math.PI,Math.PI),b.down=Z.qf(b.down,-Math.PI,Math.PI),b.up=Z.S(b.up,-Math.PI/2,0),b.down=Z.S(b.down,-Math.PI/2,0)}}function v(a,c){var d=a.g;if(!c){var b=ha.Jl(a,d.wb);c={min:b,max:b}}d.fb=d.fb||{};d.fb.min=c.min;d.fb.max=c.max;d.fb&&d.va&&n(a)}function M(a,c){var d=
a.g;c?(d.fb=d.fb||{},d.fb.min=c.min,d.fb.max=c.max):d.fb=null}function c(a,c){var d=a.g;c?(d.cf=d.cf||{},d.cf.min_y=c.min_y,d.cf.max_y=c.max_y):d.cf=null}function p(a,c){var d=a.g;c?(d.Kc=d.Kc||{},d.Kc.min=c.min,d.Kc.max=c.max):d.Kc=null}function R(a,c){var d=a.g;c?(d.Lc=d.Lc||{},d.Lc.min=c.min,d.Lc.max=c.max):d.Lc=null}function K(c){var d=c.g;if(ka.ka(c))for(var b=c.A,e=0;e<b.length;e++){var h=b[e].U;if(h[0].type===a.Wd){switch(d.lb){case a.bb:var f=ja.q(d.i),f=Q.dist(f,d.pivot),f=f/d.ll*d.ml;break;
case a.yc:f=ja.q(d.i);f=Q.distance(f,d.wb);f=f/d.ll*d.ml;break;default:f=h[0].top}for(var g=0;g<h.length;g++){var n=h[g];n.top=f;T(n,n.ib)}G(c,b[e])}}}function t(c){var d=c.g,b=d.lb;if(b===a.bb||b===a.xc){if(d.$a){var e=d.$a.left,h=d.$a.right,f=q(c,ua);(f=b==a.bb?Z.ej(f[0],e,h):Z.ej(f[0],h,e))&&(b==a.bb?u(c,f,0):y(c,f,0))}d.va&&(e=d.va.down,h=d.va.up,f=q(c,ua),(f=b==a.bb?Z.ej(f[1],h,e):Z.ej(f[1],e,h))&&(b==a.bb?u(c,0,f):y(c,0,f)));if(b===a.bb&&d.fb){var f=c.g,e=ja.q(f.i),h=Q.subtract(e,f.pivot,U),
g=Q.length(h);g>f.fb.max?(Q.scale(h,f.fb.max/g,h),Q.add(f.pivot,h,e)):g<f.fb.min&&(g=Z.Cb(ja.B(f.i),Z.md,xa),Q.scale(g,100*f.fb.min,g),Q.add(h,g,h),Q.scale(h,-f.fb.min/Q.length(h),h),Q.add(f.pivot,h,e))}}b===a.bb&&d.cf&&(d=c.g,f=d.pivot[1],e=Z.S(d.pivot[1],d.cf.min_y,d.cf.max_y),e!=f&&(f=Q.set(0,e-f,0,U),Q.add(d.pivot,f,d.pivot),d=ja.q(d.i),Q.add(d,f,d)));b===a.yc&&(b=c.g,b.Kc&&(f=Z.S(b.wb[0],b.Kc.min,b.Kc.max)-b.wb[0],b.wb[0]+=f,d=ja.q(b.i),d[0]+=f),b.Lc&&(f=Z.S(b.wb[2],b.Lc.min,b.Lc.max)-b.wb[2],
b.wb[2]+=f,d=ja.q(b.i),d[2]+=f),b=c.g,d=q(c,ua)[1],(b=Z.ej(d,b.va.up,b.va.down))&&C(c,0,b))}function y(a,c,d,b,e){var h=a.g,f=c,g=d;if(b||e)a=q(a,sa),b&&(f=c-a[0]),e&&(g=d-a[1]);if(f||g)c=X.identity(P),f&&(f=X.setAxisAngle(h.hf,f,pa),X.multiply(c,f,c)),h=ja.B(h.i),g&&(f=Z.Cb(h,Z.Ke,U),g=X.setAxisAngle(f,g,pa),X.normalize(g,g),X.multiply(c,g,c)),X.multiply(c,h,h)}function u(a,c,d,b,e){var h=a.g,f=c,g=d;if(b||e){var n=q(a,sa);b&&(f=c-n[0]);e&&(g=d-n[1])}L(a,a.g.pivot,f,g);a=q(a,sa);a=Z.qf(a[1],-Math.PI,
Math.PI);h.$s=Math.abs(a)>Math.PI/2}function C(a,c,d,b,e){var h=a.g,f=c,g=d;if(b||e){var k=q(a,sa);b&&(f=c-k[0]);e&&(g=d-k[1])}h.Ln||(f=0);L(a,h.wb,f,g);g&&n(a)}function L(a,c,d,b){var e=a.g;if(d||b){var h=X.identity(P);d&&(d=X.setAxisAngle(Z.wc,d,pa),X.multiply(h,d,h));la(a);a=ja.B(e.i);b&&(d=Z.Cb(a,Z.Ke,U),b=X.setAxisAngle(d,b,pa),X.normalize(b,b),X.multiply(h,b,h));e=ja.q(e.i);Z.KR(e,c,h,e);X.multiply(h,a,a)}}function n(a){var c=a.g,d=q(a,ua)[1],b=a.g;a=b.va;b=b.fb;a.down-a.up?(d=(a.down-d)/(a.down-
a.up),d=Math.max(d,0)):d=0;d=d*(b.max-b.min)+b.min;a=ja.q(c.i);b=Z.Cb(ja.B(c.i),Z.md,U);Q.normalize(b,b);Q.scale(b,d,b);Q.subtract(c.wb,b,a)}function T(c,d,b){switch(c.type){case a.Vc:d||Z.l("No aspect ratio"),c.ib=d;case a.Dg:ga.perspective(Z.jb(c.Bd),c.ib,c.near,c.far,c.Bb);break;case a.Wd:d||Z.l("No aspect ratio"),c.ib=d;case a.Gh:d=c.top*c.ib;ga.ortho(-d,d,-c.top,c.top,c.near,c.far,c.Bb);break;case a.Ui:ga.ortho(c.left,c.right,c.bottom,c.top,c.near,c.far,c.Bb);break;case a.cc:case a.pc:d||Z.l("No aspect ratio");
c.ib=d;var e=Math.tan(c.Bd*Math.PI/360);d=c.near*e;var h=c.ib*c.mm*e;c.type==a.cc?(e=h-c.gf/2,h+=c.gf/2):(e=h+c.gf/2,h-=c.gf/2);e=-(c.near/c.mm*e);h*=c.near/c.mm;ga.frustum(e,h,-d,d,c.near,c.far,c.Bb);c.left=e;c.right=h;break;case a.wd:case a.xd:if(Ca.za())if(e=Ca.o(),(e=Ca.qa(e,"STEREO"))&&e.enable_hmd_stereo){d=Math.tan(Z.jb(c.Dd[0]));var e=Math.tan(Z.jb(c.Dd[1])),h=Math.tan(Z.jb(c.Dd[2])),f=Math.tan(Z.jb(c.Dd[3]));c.top=c.near*d;c.right=c.near*e;c.bottom=-c.near*h;c.left=-c.near*f;ga.frustum(c.left,
c.right,c.bottom,c.top,c.near,c.far,c.Bb)}else d||(d=c.ib),ga.perspective(Z.jb(c.Bd),d,c.near,c.far,c.Bb);break;case a.Ac:return;default:Z.l("Wrong camera type: "+c.type)}b||(V(c),O(c))}function O(a){ga.copy(a.nb,a.tg);a.tg[12]=0;a.tg[13]=0;a.tg[14]=0;a.tg[15]=1;ga.multiply(a.Bb,a.tg,a.tg);ga.invert(a.tg,a.tg)}function V(a){ga.copy(a.nb,a.Rf);ga.multiply(a.Bb,a.Rf,a.Rf);ga.invert(a.Rf,a.GI)}function Y(c,d,b,e,h){e||(e=new Float32Array(24));d||(d=c.near);b||(b=c.far);var f,g,n,k,p,v,t,m;switch(c.type){case a.Ac:Z.l("Extraction from NONE camera is not possible");
break;case a.Vc:case a.Dg:f=d*Math.tan(c.Bd*Math.PI/360);k=-f;g=f*c.ib;n=-g;p=b/d*f;m=-p;v=p*c.ib;t=-v;break;case a.Wd:case a.Gh:n=c.top*c.ib;f=p=c.top;g=v=n;k=m=-c.top;n=t=-n;break;case a.Ui:f=p=c.top;g=v=c.right;k=m=c.bottom;n=t=c.left;break;case a.cc:case a.pc:p=d/c.near;f=d*Math.tan(c.Bd*Math.PI/360);k=-f;g=c.right*p;n=c.left*p;t=b/d;p=f*t;m=-p;v=g*t;t*=n;break;case a.wd:case a.xd:p=d/c.near;f=c.top*p;k=c.bottom*p;g=c.right*p;n=c.left*p;t=b/d;p=f*t;m=k*t;v=g*t;t*=n;break;default:Z.l("Wrong camera type: "+
c.type)}e[0]=n;e[1]=k;e[2]=-d;e[3]=g;e[4]=k;e[5]=-d;e[6]=g;e[7]=f;e[8]=-d;e[9]=n;e[10]=f;e[11]=-d;e[12]=t;e[13]=m;e[14]=-b;e[15]=t;e[16]=p;e[17]=-b;e[18]=v;e[19]=p;e[20]=-b;e[21]=v;e[22]=m;e[23]=-b;h&&(d=Aa,ga.invert(c.nb,d),Z.Rl(e,d,e,0));return e}function la(c){return ka.ka(c)&&c.g&&c.g.lb==a.yc}function W(a,c){if(c.enable_csm){var d=c.csm_num;if(!a.vn){var b=c.csm_num;a.vn=Array(b);for(var e=0;e<b;e++)a.vn[e]=new Float32Array(3);a.Qv=new Float32Array(b)}for(b=0;b<d;b++){var e=0==b?a.near:ba(c,
a,b-1),h=ba(c,a,b),e=Y(a,e,h,ma),e=ea.cP(e);a.vn[b].set(e.O);a.Qv[b]=e.mb;a.tC[b]=Q.length(e.O);a.gs[b]=aa(c.first_cascade_blur_radius,c.last_cascade_blur_radius,d,b)}}else a.gs[0]=c.first_cascade_blur_radius}function ba(a,c,d){var b=a.csm_num,e=Z.S(a.csm_first_cascade_border,c.near,c.far);a=Z.S(a.csm_last_cascade_border,c.near,c.far);return Z.S(aa(e,a,b,d),c.near,c.far)}function aa(a,c,d,b){switch(b){case 0:break;case d-1:a=c;break;default:a=0==a?0:a*Math.pow(c/a,b/(d-1))}return a}function fa(a,
c){c||(c=new Float32Array(3));Q.copy(ja.q(a.g.i),c);return c}var ea=l("__boundings");l("__config");var ia=l("__constraints"),va=l("__container"),ga=l("__mat4"),E=l("__math"),ka=l("__obj_util"),S=l("__print"),X=l("__quat"),Ca=l("__scenes"),ha=l("__transform"),ja=l("__tsr"),Z=l("__util"),Q=l("__vec3"),Ba=l("__vec4");a.Ac=10;a.Vc=20;a.Wd=30;a.Dg=40;a.Gh=50;a.Ui=60;a.cc=70;a.pc=80;a.wd=90;a.xd=100;a.Vf=0;a.bb=2;a.xc=3;a.yc=4;var ta=Z.jb(.5),ua=new Float32Array(2),sa=new Float32Array(2),U=new Float32Array(3),
xa=new Float32Array(3),da=new Float32Array(3),P=new Float32Array(4),pa=new Float32Array(4),ca=new Float32Array(4),za=new Float32Array(4),Aa=new Float32Array(16),ma=new Float32Array(24),Ja=new Float32Array(6);a.bM=function(c,d){var h=d.g,f=c.data;switch(f.type){case "PERSP":var g=w(a.Vc);if(f.angle_y)var n=Z.Ld(f.angle_y);z(g,n,f.clip_start,f.clip_end);break;case "ORTHO":g=w(a.Wd),z(g,f.ortho_scale/2,f.clip_start,f.clip_end)}g.name=d.name;n=d.A;n[0].U.push(g);for(var p=1;p<n.length;p++){var v=Z.ia(g);
n[p].U.push(v)}h.yT=!1;h.lb=r(f.b4w_move_style);h.dof_distance=f.dof_distance;g=f.dof_object;h.je=g?g.ya:null;h.dof_front=f.b4w_dof_front;h.dof_rear=f.b4w_dof_rear;h.dof_power=f.b4w_dof_power;h.lp=f.b4w_trans_velocity;h.kp=f.b4w_rot_velocity;h.mp=f.b4w_zoom_velocity;g=d.g.lb;n=c.data;p=null;g!=a.bb&&g!=a.xc||!n.b4w_use_horizontal_clamping||(p={left:n.b4w_rotation_left_limit,right:n.b4w_rotation_right_limit,camera_space:"LOCAL"==n.b4w_horizontal_clamping_type},g==a.xc&&(p.left*=-1,p.right*=-1));g=
p;n=d.g.lb;p=c.data;v=null;n!=a.bb&&n!=a.xc||!p.b4w_use_vertical_clamping?n==a.yc&&p.b4w_use_zooming&&(p.b4w_hover_angle_min<=p.b4w_hover_angle_max?(v={down:p.b4w_hover_angle_min,up:p.b4w_hover_angle_max},v.down*=-1,v.up*=-1):S.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(v={down:p.b4w_rotation_down_limit,up:p.b4w_rotation_up_limit,camera_space:"LOCAL"==p.b4w_vertical_clamping_type},n==a.bb&&(v.down*=-1,v.up*=-1));var n=v,p=d.g.lb,v=c.data,q=null;p==a.bb&&v.b4w_use_target_distance_limits&&
v.b4w_distance_min<=v.b4w_distance_max?q={min:v.b4w_distance_min,max:v.b4w_distance_max}:p===a.yc&&v.b4w_use_zooming&&(v.b4w_distance_min<=v.b4w_distance_max?q={min:v.b4w_distance_min,max:v.b4w_distance_max}:S.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));p=q;v=c.data;q=null;d.g.lb==a.yc&&v.b4w_use_horizontal_clamping&&v.b4w_horizontal_translation_min<=v.b4w_horizontal_translation_max&&(q={min:v.b4w_horizontal_translation_min,max:v.b4w_horizontal_translation_max});
var v=q,u=c.data,q=null;d.g.lb==a.yc&&u.b4w_use_vertical_clamping&&u.b4w_vertical_translation_min<=u.b4w_vertical_translation_max&&(q={min:u.b4w_vertical_translation_min,max:u.b4w_vertical_translation_max},u=-q.min,q.min=-q.max,q.max=u);var u=c.data,y=null;d.g.lb==a.bb&&u.b4w_use_pivot_limits&&(y={min_y:u.b4w_pivot_z_min,max_y:u.b4w_pivot_z_max});u=y;switch(h.lb){case a.xc:h=ja.q(d.g.i);m(d,h,null,g,n);break;case a.bb:h=ja.q(d.g.i);b(d,h,f.b4w_target,g,n,p,u,f.b4w_use_panning);break;case a.yc:h=ja.q(d.g.i),
g=x(d,c.data.b4w_hover_zero_level,xa),e(d,h,g,p,n,v,q,f.b4w_enable_hover_hor_rotation)}t(d);k(d)};a.DS=m;a.FS=b;a.ES=e;a.ho=k;a.WM=B;a.a0=r;a.rc=w;a.aX=function(a,c){switch(c){case "COLOR":case "CUBEMAP":return Boolean(a.Wb);case "DEPTH":return Boolean(a.he);case "SCREEN":return!Boolean(a.Wb)&&!Boolean(a.he);default:Z.l("Wrong attachment type: "+c)}};a.As=function(a,c,d){switch(c){case "COLOR":case "CUBEMAP":a.Wb=d;break;case "DEPTH":a.he=d;break;case "SCREEN":a.Wb=null;a.he=null;break;default:Z.l("Wrong attachment type: "+
c)}};a.FY=function(a,c){switch(c){case "COLOR":case "CUBEMAP":return a.Wb;case "DEPTH":return a.he;case "SCREEN":return null;default:Z.l("Wrong attachment type: "+c)}};a.Mr=function(c,d){(c.type!=a.Vc||d!=a.cc&&d!=a.pc&&d!=a.wd&&d!=a.xd)&&Z.l("make_stereo(): wrong camera type");c.type=d;f(c,6,.065)};a.rS=f;a.hl=q;a.sD=g;a.Zq=function(a,c){q(a,c);c[0]=Z.Eg(c[0]+Math.PI);c[1]*=-1;return c};a.Ds=z;a.fS=function(c,d,b,e,h,f,g){switch(c.type){case a.Ui:c.left=d;c.right=b;c.bottom=e;c.top=h;c.near=f;c.far=
g;break;default:S.error("set_frustum_asymmetric(): Unsupported camera type: "+c.type)}};a.Wh=function(a){return a.g.lb};a.zS=A;a.H1=J;a.My=function(a,c,d){var b=U;b[0]=0;b[1]=-1;b[2]=0;Q.transformQuat(b,d,b);b[0]+=c[0];b[1]+=c[1];b[2]+=c[2];var e=xa;e[0]=0;e[1]=0;e[2]=-1;Q.transformQuat(e,d,e);J(a,c,b,e)};a.Gs=N;a.mS=F;a.LT=G;a.KT=function(c){var d=c.g;t(c);K(c);switch(d.lb){case a.bb:var b=ja.q(d.i);ia.LR(b,ja.B(d.i),d.pivot);for(var e=0;e<c.A.length;e++)for(var h=c.A[e].U,g=0;g<h.length;g++){var n=
h[g];n.type!=a.cc&&n.type!=a.pc||f(n,Q.dist(b,d.pivot),n.gf)}ia.Rh(c,d.hf);break;case a.xc:c.zb||ia.Rh(c,d.hf)}D(c)};a.wz=D;a.TG=H;a.eH=I;a.pr=d;a.or=v;a.YR=M;a.oS=c;a.hS=p;a.yS=R;a.UT=K;a.Qo=y;a.us=u;a.Ro=C;a.H_=function(c){switch(c.type){case a.Vc:case a.Wd:case a.cc:case a.pc:return!0;default:return!1}};a.kD=function(c){switch(c.type){case a.Vc:case a.Dg:case a.cc:case a.pc:return Z.jb(c.Bd);default:return S.error("get_angular_diameter(): Unsupported camera type: "+c.type),0}};a.si=T;a.mv=O;a.BB=
V;a.gO=Y;a.xL=function(a){a=a.g;var c=ea.bc();c.min_x=-1;c.max_x=1;c.min_y=-1;c.max_y=1;c.min_z=-1;c.max_z=1;a.R=c;var d=ea.Bq(1,[0,0,0]);a.Pe=d;a.$u=ea.dC(1,c);a.bv=ea.fC(1,c);a.av=ea.eC(1,c)};a.rl=function(c){return ka.ka(c)&&c.g&&c.g.lb==a.Vf};a.sa=function(c){return ka.ka(c)&&c.g&&c.g.lb==a.bb};a.Hb=function(c){return ka.ka(c)&&c.g&&c.g.lb==a.xc};a.Ia=la;a.Cr=function(c){return ka.ka(c)&&c.g&&c.A[0].U[0].type==a.Wd};a.vz=W;a.yN=ba;a.Wx=function(c,d,b){c=c.A[0].U[0];switch(c.type){case a.Vc:case a.Dg:case a.Wd:case a.Gh:case a.cc:case a.pc:case a.wd:case a.xd:var e=
ca;e.set(d);e[3]=1;Ba.transformMat4(e,c.Rf,e);d=-e[1]/e[3];b[0]=(e[0]/e[3]+1)/2*c.width;b[1]=(d+1)/2*c.height;va.CU(b[0],b[1],b,c);2<b.length&&(b[2]=(e[2]/Math.abs(e[3])+1)/2);return b;default:return S.error("Non-compatible camera"),b}};a.$O=function(a){return a.A[0].U[0]};a.il=function(c,d){switch(c.type){case a.Vc:case a.Dg:case a.cc:case a.pc:var b=Math.tan(Z.jb(c.Bd)/2);switch(d){case "LEFT":return-b*c.ib;case "RIGHT":return b*c.ib;case "TOP":return b;case "BOTTOM":return-b}break;case a.Wd:case a.Gh:switch(d){case "LEFT":return-c.top*
c.ib;case "RIGHT":return c.top*c.ib;case "TOP":return c.top;case "BOTTOM":return-c.top}break;case a.Ui:switch(d){case "LEFT":return c.left;case "RIGHT":return c.right;case "TOP":return c.top;case "BOTTOM":return c.bottom}break;case a.wd:case a.xd:switch(d){case "LEFT":return Math.tan(Z.jb(c.Dd[3]));case "RIGHT":return Math.tan(Z.jb(c.Dd[1]));case "TOP":return Math.tan(Z.jb(c.Dd[0]));case "BOTTOM":return Math.tan(Z.jb(c.Dd[2]))}break;default:Z.l("Unknown camera type")}};a.UP=function(c){switch(c.type){case a.Wd:case a.Gh:case a.Ui:return!0;
default:return!1}};a.aP=function(c,d){switch(c.type){case a.Vc:case a.Dg:case a.cc:case a.pc:var b=Z.jb(c.Bd);return d?b*c.ib:b;default:return 0}};a.Vo=function(a,c,d){a=a.g;ja.ff(c,a.i);Q.copy(d,a.pivot)};a.Fs=function(a,c){var d=a.g,b=Q.subtract(c,d.wb,U),b=Q.add(b,ja.q(d.i),b);ha.lc(a,b);Q.copy(c,d.wb)};a.sS=function(a,c){var d=a.g,b=Q.subtract(c,d.pivot,U),b=Q.add(b,ja.q(d.i),b);ha.lc(a,b);Q.copy(c,d.pivot)};a.zD=fa;a.Ey=function(c,d){c.g.lb=d;c.g.$a=null;c.g.va=null;c.g.fb=null;c.g.Kc=null;c.g.Lc=
null;k(c);switch(d){case a.yc:var b=ja.q(c.g.i),h=x(c,0,xa);e(c,b,h,null,null,null,null,c.g.Ln);break;case a.bb:b=fa(c,U),h=Z.Cb(ja.B(c.g.i),Z.md,xa),h=Q.scaleAndAdd(b,h,10,h),Q.copy(h,c.g.pivot)}};a.vt=function(a){a=a.g;a.lb=0;Q.set(0,0,0,a.pivot);Q.set(0,0,0,a.wb);a.$s=!1;a.use_panning=!1;a.$a=null;a.va=null;a.fb=null;a.Kc=null;a.Lc=null;a.cf=null;a.Ln=!0};a.zy=function(a,c){for(var d=0;d<a.length;d++){var b=a[d];70!=b.type&&80!=b.type&&90!=b.type&&100!=b.type||f(b,b.mm,c)}};a.Dy=function(a,c,d){var b=
Ca.o();a=ka.aa(a,b).U;for(b=0;b<a.length;b++){var e=a[b];if(90==e.type||100==e.type)90==e.type&&Ba.copy(c,e.Dd),100==e.type&&Ba.copy(d,e.Dd),e.kc||T(e),V(e),O(e)}}};b4w.module.__constraints=function(a,l){function m(a){var c={};c.type=a;return c}function b(a,c){a.zb&&a.zb.ua&&e(a.zb.ua,a);if(c.ua){var d=c.ua;-1==d.zd.indexOf(a)?d.zd.push(a):J.l("Descendant object override is forbidden")}a.zb=c}function e(a,c){var d=a.zd.indexOf(c);-1!=d?a.zd.splice(d,1):J.l("No descendant object")}function x(a,d,b){switch(d.type){case 1:var e=A.B(a.g.i),g=d.ua.g.i;b=A.B(d.ua.g.i);d.hd?(z.copy(d.hd,e),z.multiply(b,e,e)):z.copy(b,e);var k=A.Fc(d.offset,g,D);A.ff(k,a.g.i);A.ve(d.So*
A.Pc(d.ua.g.i),a.g.i);break;case 9:k=A.q(a.g.i);e=A.B(a.g.i);g=d.ua.g.i;b=A.B(d.ua.g.i);z.multiply(z.invert(d.Xj,d.Xj),e,e);z.multiply(b,e,e);A.Fc(d.offset,g,k);z.copy(b,d.Xj);break;case 10:k=A.q(a.g.i);e=A.B(a.g.i);g=d.ua.g.i;b=A.B(d.ua.g.i);z.multiply(z.invert(d.Xj,d.Xj),e,e);z.multiply(b,e,e);A.Fc(d.offset,g,k);z.copy(b,d.Xj);k=A.B(a.g.i);e=z.multiply(A.B(d.ua.g.i),d.hd,h);e=f.sD(e,F);k=f.sD(k,G);f.Qo(a,J.ej(k[0],e[0]+d.BM,e[0]+d.AM),J.ej(k[1],e[1]+d.zM,e[1]+d.CM));break;case 13:var k=A.q(a.g.i),
e=A.B(a.g.i),g=d.ua.g.i,m=A.q(g),n=d.QS,l=D,O=h;A.Fc(d.offset,g,l);J.bm(l,k,b,n,k);g=D;N.sub(m,k,g);N.normalize(g,g);var H=e,k=v,m=k.subarray(0,3),l=k.subarray(3,6),x=k.subarray(6,9);N.copy(g,l);N.negate(l,l);N.normalize(l,l);Boolean(.999999<Math.abs(N.dot(g,J.wc)))?(g=q.fromQuat(z.normalize(H,O),M),N.copy(g.subarray(0,3),m)):N.cross(J.wc,l,m);N.normalize(m,m);N.cross(m,l,x);N.normalize(x,x);z.fromMat3(k,O);z.normalize(O,O);J.qH(O,e,b,.16*n,e);break;case 2:e=A.B(a.g.i);b=c;w.Yq(d.ua,d.cj,!0,b);A.multiply(d.ua.g.i,
b,b);e[0]=b[4];e[1]=b[5];e[2]=b[6];e[3]=b[7];d.hd&&(z.copy(d.hd,e),z.multiply(e,d.hd,e));A.ve(d.So*b[3],a.g.i);k=A.q(a.g.i);A.Fc(d.offset,b,k);break;case 3:k=A.q(a.g.i);e=A.B(a.g.i);b=A.q(d.ua.g.i);B(k,e,b);break;case 4:k=A.q(a.g.i);e=A.B(a.g.i);b=d.target;B(k,e,b);break;case 5:k=A.q(a.g.i);e=A.B(a.g.i);b=A.q(d.ua.g.i);B(k,e,b);e=N.dist(k,b);if(e=e>d.vf?e-d.vf:e<d.Dn?e-d.Dn:0)N.sub(b,k,D),N.normalize(D,D),N.scale(D,e,D),N.add(k,D,k);break;case 6:k=A.q(a.g.i);e=A.B(a.g.i);b=d.target;B(k,e,b);e=N.dist(k,
b);if(e=e>d.vf?e-d.vf:e<d.Dn?e-d.Dn:0)N.sub(b,k,D),N.normalize(D,D),N.scale(D,e,D),N.add(k,D,k);break;case 7:g=d.ua.g.i;k=A.q(a.g.i);A.Fc(d.offset,g,k);break;case 8:m=A.q(d.ua.g.i);k=A.q(a.g.i);N.add(m,d.offset,k);break;case 14:e=A.B(a.g.i);g=d.ua.g.i;b=A.B(d.ua.g.i);d.hd?(z.copy(d.hd,e),z.multiply(b,e,e)):z.copy(b,e);k=A.q(a.g.i);A.Fc(d.offset,g,k);break;case 11:A.multiply(d.ua.g.i,d.ht,a.g.i);break;case 12:k=d.ht;b=c;w.Yq(d.ua,d.cj,!0,b);A.multiply(d.ua.g.i,b,b);A.multiply(b,k,a.g.i);break;case 15:e=
d.ua,b=f.$O(e),k=A.q(a.g.i),g=f.il(b,"LEFT"),m=f.il(b,"RIGHT"),n=f.il(b,"TOP"),O=f.il(b,"BOTTOM"),l="heights"==d.hor_units?n-O:m-g,d.bF?(g=f.il(b,"LEFT"),k[0]=g+l*d.kx):(m=f.il(b,"RIGHT"),k[0]=m-l*d.kx),g="heights"==d.vert_units?n-O:m-g,k[2]=d.TH?-(n-g*d.oz):-(O+g*d.oz),f.UP(b)?k[1]=-d.distance:(k[1]=-1,N.normalize(k,k),N.scale(k,d.distance/Math.abs(k[1]),k)),A.Tc(k,e.g.i,k),N.add(A.q(e.g.i),k,k),k=A.B(a.g.i),e=A.B(e.g.i),d.hd?(z.copy(d.hd,k),z.multiply(e,k,k)):z.copy(e,k)}"CAMERA"==a.g.type&&(k=
a.g.hf,10==d.type&&(b=A.B(d.ua.g.i),k=N.transformQuat(k,b,p)),f.wz(a),r(a,k))}function k(a,d){switch(d.type){case 1:var b=d.target.g.i,e=c;A.invert(a.g.i,e);A.multiply(e,b,e);w.TR(a,d.cj,e)}a.Dx=!0}function B(a,c,b){var e=D;J.Cb(c,J.md,e);N.normalize(e,e);var h=H;N.subtract(b,a,h);N.normalize(h,h);a=J.CG(e,h,d);z.multiply(a,c,c);z.normalize(c,c)}function r(a,c,d){var b=a.g,e=A.B(b.i),g=J.Cb(e,J.wc,D);N.normalize(g,g);if(.999999<Math.abs(N.dot(c,g)))g=z.identity(h);else{var k=N.cross(c,g,H);N.normalize(k,
k);b.lb==f.bb?b.$s&&N.negate(k,k):(b=J.Cb(e,J.lf,I),0<N.dot(b,c)&&N.negate(k,k));b=J.Cb(e,J.Ke,I);N.normalize(b,b);var n=J.S(N.dot(b,k),-1,1),g=-.999999>=n?z.setAxisAngle(g,Math.acos(n),h):z.rotationTo(b,k,h);z.normalize(g,g)}z.multiply(g,e,e);d&&(d=J.Cb(e,J.Oi,D),0>N.dot(c,d)&&z.rotateY(e,Math.PI,e));f.wz(a)}var w=l("__armature"),f=l("__camera"),q=l("__mat3"),g=l("__print"),z=l("__quat"),A=l("__tsr"),J=l("__util"),N=l("__vec3");a.ZU=1;a.YU=2;a.cV=3;a.dV=4;a.TU=5;a.UU=6;a.$U=7;a.SU=8;a.XU=9;a.WU=
10;a.QU=11;a.RU=12;a.VU=13;a.aV=14;a.bV=15;a.NU=1;var F=new Float32Array(2),G=new Float32Array(2),D=new Float32Array(3),H=new Float32Array(3),I=new Float32Array(3),d=new Float32Array(4),h=new Float32Array(4),v=new Float32Array(9),M=new Float32Array(9),c=A.create(),p=new Float32Array(3);a.fB=function(a,c,d,e,h){var f=m(1);f.ua=c;f.offset=new Float32Array(d);f.hd=e?new Float32Array(e):null;f.So=h;b(a,f);x(a,f,0)};a.dL=function(a,c,d,e,h,f){var g=m(2);g.ua=c;g.cj=d;g.offset=new Float32Array(e);g.hd=
h?new Float32Array(h):null;g.So=f;b(a,g);x(a,g,0)};a.bL=function(a,c,d,e){var h=m(9),f=A.B(a.g.i),g=A.B(c.g.i);h.ua=c;h.offset=new Float32Array(d);h.Xj=new Float32Array(g);e&&(z.copy(e,f),z.multiply(g,f,f));b(a,h);x(a,h,0)};a.aL=function(a,c,d,e,h,f,g,n){var k=m(10),p=A.B(a.g.i),v=A.B(c.g.i);k.ua=c;k.offset=new Float32Array(d);k.Xj=new Float32Array(v);k.AM=J.Eg(h);k.BM=J.Eg(f);k.CM=J.qf(g,-Math.PI,Math.PI);k.zM=J.qf(n,-Math.PI,Math.PI);e?(k.hd=new Float32Array(e),z.copy(e,p),z.multiply(v,p,p)):k.hd=
z.create();b(a,k);x(a,k,0)};a.$K=function(a,c,d,e){var h=m(13);h.ua=c;h.offset=new Float32Array(d);h.QS=e;b(a,h);x(a,h,0)};a.hL=function(a,c,d,e){var h=m(14);h.ua=c;h.offset=new Float32Array(d);h.So=1;h.hd=e?new Float32Array(e):null;b(a,h);x(a,h,0)};a.D0=e;a.kL=function(a,c){var d=m(3);d.ua=c;b(a,d);x(a,d,0)};a.lL=function(a,c){var d=m(4);d.target=new Float32Array(c);b(a,d);x(a,d,0)};a.WK=function(a,c,d,e){var h=m(5);h.ua=c;h.Dn=d;h.vf=e;b(a,h);x(a,h,0)};a.XK=function(a,c,d,e){var h=m(6);h.target=
new Float32Array(c);h.Dn=d;h.vf=e;b(a,h);x(a,h,0)};a.gL=function(a,c){var d=m(7);d.ua=c;d.offset=new Float32Array([0,.5,0]);b(a,d);x(a,d,0)};a.VK=function(a,c,d){var e=m(8);e.ua=c;e.offset=new Float32Array(d);b(a,e);x(a,e,0)};a.TK=function(a,c,d){var e=m(11);e.ua=c;e.ht=new Float32Array(d);b(a,e);x(a,e,0)};a.UK=function(a,c,d,e){var h=m(12);h.ua=c;h.cj=d;h.ht=new Float32Array(e);b(a,h);x(a,h,0)};a.Tu=function(a,c,d){var e=m(15);e.ua=c;if(J.Bf(d.left))e.bF=!0,e.kx=d.left;else if(J.Bf(d.right))e.bF=
!1,e.kx=d.right;else{g.error("append_stiff_viewport: Wrong positioning params");return}if(J.Bf(d.top))e.TH=!0,e.oz=d.top;else if(J.Bf(d.bottom))e.TH=!1,e.oz=d.bottom;else{g.error("append_stiff_viewport: Wrong positioning params");return}J.Bf(d.distance)?(e.distance=d.distance,e.hd=J.Bf(d.rotation)?new Float32Array(d.rotation):null,e.hor_units=J.Bf(d.hor_units)?d.hor_units:"widths",e.vert_units=J.Bf(d.vert_units)?d.vert_units:"heights",b(a,e),x(a,e,0)):g.error("append_stiff_viewport: Wrong positioning params")};
a.MT=function(a,c){a.zb&&x(a,a.zb,c)};a.eL=function(a,c,d,b,e){var h=m(1);h.cj=d;h.target=c;h.offset=new Float32Array(b);h.hd=e?new Float32Array(e):null;h.So=1;c=h.target;d=h.cj;b=a.g.Oe[d];e=c.Ev;for(var f=0;f<e;f++){var g=e[f];if(g[0]==a&&g[1]==d){e.splice(f,1);break}}c.Ev.push([a,d]);b.zb=h;k(a,h)};a.FT=function(a,c){var d=a.g.Oe[c];d.zb&&k(a,d.zb)};a.LR=B;a.Rh=r;a.mM=function(a){return a.zb?!0:!1};a.remove=function(a){a.zb.ua&&e(a.zb.ua,a);a.zb=null};a.MZ=function(a){return a.zb?a.zb.type:null};
a.Ye=function(a){a=a.zb;return!a||11!=a.type&&12!=a.type?!1:!0};a.ar=function(a){if((a=a.zb)&&11==a.type)return a.ua.g.i;if(a&&12==a.type){var d=c;w.Yq(a.ua,a.cj,!0,d);A.multiply(a.ua.g.i,d,d);return d}return null};a.We=function(a){a=a.zb;return!a||11!=a.type&&12!=a.type?null:a.ht}};b4w.module.__armature=function(a,l){function m(a){a=a.g;for(var b=a.Rs,e=a.qF,f=0;f<b.length;f++){for(var g=b[f],k=e[f],m=0;m<k.length;m+=2)for(var q=k[m],d=k[m+1],h=0;4>h;h++)g.Kd[q+h]=a.Kd[d+h],g.te[q+h]=a.te[d+h],g.Td[q+h]=a.Td[d+h],g.Ee[q+h]=a.Ee[d+h];g.Ue=a.Ue}}function b(a,e,g,k){var m=a.dI,q=a.Di,l=a.gt,r=a.WF;r?(r=r.gt,e?x.multiply(r,m,l):(e=f,x.invert(r,e),x.multiply(e,l,m))):e?x.copy(m,l):x.copy(l,m);m=w;x.invert(q,m);x.multiply(l,m,m);q=a.Mh;g[4*q]=m[0];g[4*q+1]=m[1];g[4*q+2]=m[2];g[4*
q+3]=m[3];k[4*q]=m[4];k[4*q+1]=m[5];k[4*q+2]=m[6];k[4*q+3]=m[7];a=a.GC;for(q=0;q<a.length;q++)l=a[q],l.zb||b(l,!0,g,k)}var e=l("__util"),x=l("__tsr"),k=l("__quat"),B=l("__mat4"),r=l("__vec3"),w=x.create(),f=x.create(),q=new Float32Array(4),g=new Float32Array(4),z=new Float32Array(4);a.Fi=function(a,b){for(var f=a.data.bones,g=a.pose.bones,k={},m=0;m<g.length;m++){var q=g[m],l=q.bone,d=l.name,h=k[d]={Mh:0,zI:-1,WF:null,GC:[],oq:[],zb:null,sz:x.create(),dI:x.create(),Di:x.create(),gt:x.create(),et:x.create(),
tz:x.create(),ft:!1,JH:new Float32Array(3)},d=new Float32Array(l.matrix_local),v=new Float32Array(16);B.invert(d,v);var q=new Float32Array(q.matrix_basis),z=h.JH;r.subtract(l.tail_local,l.head_local,z);e.xU(z,v,z);x.Xg(d,h.Di);x.Xg(q,h.et);x.copy(h.Di,h.gt)}for(m=0;m<f.length;m++){d=f[m].name;q=e.Mc("name",d,g);h=k[d];l=q.parent_recursive;h.oq.push(h);for(v=0;v<l.length;v++)q=l[v],q=q.name,q=k[q],h.oq.push(q);l.length?(q=l[0],q=q.name,q=k[q],h.WF=q,x.invert(q.Di,w),x.multiply(w,h.Di,h.sz),q.GC.push(h)):
x.copy(h.Di,h.sz);h.Mh=m;h.name=d;x.multiply(h.sz,h.et,h.dI)}b.g.Oe=k};a.Yq=function(a,b,e,m){var l=a.g,r=l.Ue;b=l.Oe[b];var B=b.Mh;a=b.Di;var I=l.Td,d=l.Ee,h=l.Kd,l=l.te,v=I[4*B+1],M=I[4*B+2],c=I[4*B+3],p=d[4*B+1],R=d[4*B+2],K=d[4*B+3];q[0]=(1-r)*I[4*B]+r*d[4*B];q[1]=(1-r)*v+r*p;q[2]=(1-r)*M+r*R;q[3]=(1-r)*c+r*K;g[0]=h[4*B];g[1]=h[4*B+1];g[2]=h[4*B+2];g[3]=h[4*B+3];z[0]=l[4*B];z[1]=l[4*B+1];z[2]=l[4*B+2];z[3]=l[4*B+3];k.slerp(g,z,r,g);r=w;x.uS(q,r);x.ti(g,r);e?(e=f,x.translate(a,b.JH,e),x.multiply(r,
e,r)):x.multiply(r,a,r);x.copy(r,m)};a.TR=function(a,e,f){var g=a.g;e=g.Oe[e];var k=g.Td,q=g.Kd;x.copy(f,e.gt);b(e,!1,k,q);g.Ue=0;m(a)};a.aU=m;a.GT=b;a.iM=function(a,b){return b in a.g.Oe}};b4w.module.__container=function(a,l){var m,b,e,x,k;function B(a,c){m=a;b=c}function r(){var a=d.getBoundingClientRect();B(a.left,a.top)}function w(){return I.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function f(b,e,f){if(!b||!e){b=a.Dt;e=a.Ct;var g=v;g.style.width=a.Dt+"px";g.style.height=a.Ct+"px"}var g=d,k=h;!1!==f&&(g.style.width=b+"px",g.style.height=e+"px",k&&(k.style.width=b+"px",k.style.height=e+"px"));k&&(k.width=b,k.height=e,A.dp());f=Math.floor(b*I.canvas_resolution_factor);e=Math.floor(e*
I.canvas_resolution_factor);w()&&(f*=window.devicePixelRatio,e*=window.devicePixelRatio);if(k=F.xj())k=k.j,f=Math.floor(f*k.Nd),e=Math.floor(e*k.Nd);g.width=f;g.height=e;if(f>c.drawingBufferWidth||e>c.drawingBufferHeight)N.warn("Canvas size exceeds platform limits, downscaling"),k=Math.min(c.drawingBufferWidth/f,c.drawingBufferHeight/e),f*=k,e*=k,g.width=f,g.height=e;F.hH(f,e,f/b);F.za()&&D.p(F.o().Hh);z.QT(g.width,g.height);z.ig()&&(q.update(),F.update(G.ao(),0),q.pI())}var q=l("__anchors"),g=l("__config"),
z=l("__data"),A=l("__hud"),J=l("__input"),N=l("__print"),F=l("__scenes"),G=l("__time"),D=l("__transform"),H=l("__util"),I=g.v,d=null,h=null,v=null,M=!1;x=e=0;k=1;m=b=0;var c=null;a.Dt=320;a.Ct=240;a.xe=function(a){c=a};a.$q=function(){return d};a.tD=function(){return h};a.le=function(){return v};a.zf=function(a,c){a&&a.parentNode?(d=a,h=c,v=a.parentNode):H.l("canvas container is not available")};a.xr=function(a,c){c=c||"LAST";switch(c){case "FIRST":v.insertBefore(a,v.firstElementChild);break;case "JUST_BEFORE_CANVAS":v.insertBefore(a,
d);break;case "JUST_AFTER_CANVAS":d.nextElementSibling?v.insertBefore(a,d.nextElementSibling):v.appendChild(a,d);break;case "LAST":v.appendChild(a,d);break;default:N.error(c+" invalid stack order")}};a.dE=function(){return e};a.cE=function(){return x};a.IG=B;a.eI=r;a.GS=function(a,c,d){e=a;x=c;k=d;r()};a.sw=function(){M=!0};a.tq=function(a,c,d){d||(d=new Float32Array(2));var e=d;M&&(r(),M=!1);e[0]=a-m;a=d;M&&(r(),M=!1);a[1]=c-b;return d};a.an=function(a,c,d,b){d||(d=new Float32Array(2));d[0]=a*k;
d[1]=c*k;b&&(a=b.width/e,d[0]*=a,d[1]*=a);return d};a.CU=function(a,c,d,b){d||(d=new Float32Array(2));d[0]=a/k;d[1]=c/k;b&&(a=b.width/e,d[0]/=a,d[1]/=a)};a.FE=function(c){return c&&c.parentNode?c.parentNode==v?!0:a.FE(c.parentNode):!1};a.RP=w;a.qO=function(a){var c=document.getElementsByTagName("script");a=H.vo(a);for(var d=0;d<c.length;d++)if(c[d].src==a)return c[d];return null};a.resize=f;a.oi=function(a){var c=v,b=d,e=c.clientWidth,c=c.clientHeight;if(a||e!=b.clientWidth||c!=b.clientHeight)(a=
"HMD"===I.stereo&&J.gE())&&a.isPresenting||f(e,c,!0)}};b4w.module.__anchors=function(a,l){function m(){h=!0;z.le().addEventListener("mouseup",function(){function a(){return"visible"==e.style.visibility&&!p&&!m}if(!v&&!I){var c=d;if(c)if("visible"==c.lastElementChild.style.visibility)b(),d=null;else if(1==c.style.opacity){var e=c.lastElementChild,h=e.firstElementChild,f=h.innerHTML;e.style.visibility="visible";var g=Math.min(parseInt(e.style.width)||200,B(f)-24),k=r(f,g),p=!1,m=!1,f=c.offsetWidth-24,c=c.offsetHeight-16;k==c&&(e.style.height=k+"px");g!=
f?(v=p=!0,G.Bk(f,g,200,function(c){c==g&&(p=!1,m||(v=!1),a&&(h.style.visibility="visible"));e.style.width=c+"px"})):p=!1;k!=c?(v=m=!0,G.Bk(c,k,200,function(c){c==k&&(m=!1,p||(v=!1),a&&(h.style.visibility="visible"));e.style.height=c+"px"})):m=!1}}})}function b(){var a=d.lastElementChild;a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function e(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function x(a){a.style.cssText+=
"background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}function k(a,c,h){var f=document.createElement("div"),g=document.createElement("span");h&&(f.style.width=
h+"px");x(f);e(g);g.innerHTML=a;f.style.visibility="hidden";g.style.visibility="hidden";f.appendChild(g);c.appendChild(f);c.addEventListener("mousedown",function(){v||c==d||1!=c.style.opacity||I||(d&&"visible"==d.lastElementChild.style.visibility&&b(),d=c)})}function B(a){var c=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;e(d);x(c);c.appendChild(d);document.body.appendChild(c);a=c.offsetWidth+1;document.body.removeChild(c);return a}function r(a,c){var d=document.createElement("div"),
b=document.createElement("span");b.innerHTML=a;e(b);x(d);d.style.width=c+"px";d.style.display="inline-block";d.appendChild(b);document.body.appendChild(d);b=d.offsetHeight-16;document.body.removeChild(d);return b}function w(){for(var a=0,c=0;c<H.length;c++)H[c].Rk&&a++;M=new Float32Array(3*a)}function f(a,c){return c.depth-a.depth}var q=l("__batch"),g=l("__camera"),z=l("__container"),A=l("__objects"),J=l("__print"),N=l("__renderer"),F=l("__scenes"),G=l("__time"),D=l("__tsr"),H=[],I=!1,d=null,h=!1,
v=!1,M=new Float32Array(0),c=new Uint8Array(16),p=new Float32Array(2),R=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<H.length;c++)if(H[c].Ca==a){c=!0;break a}c=!1}if(!c){c=a.anchor.Rk&&Boolean(F.qa(F.xj(),"ANCHOR_VISIBILITY"));c={type:a.anchor.type,Ca:a,x:0,y:0,depth:0,$i:"out",Rk:c,element:null,Dl:null,RK:a.anchor.HQ,$p:0,Ru:0,Pq:a.anchor.Pq};switch(c.type){case "ANNOTATION":var d=c.RK,b=document.createElement("div"),f=document.createElement("span"),g="",n=a.name,p=z.le();a=A.yj(a);
b.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;padding:            8px 12px;position:           absolute;";b.style.visibility="hidden";p.appendChild(b);a&&(g=a.description||g,n=a.title||n);f.innerHTML=n;f.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
e(f);b.appendChild(f);g&&k(g,b,d);c.element=b;c.$p=c.element.offsetHeight;c.Ru=c.element.offsetWidth;break;case "ELEMENT":c.element=document.getElementById(a.anchor.Pq),c.element?(c.$p=c.element.offsetHeight,c.Ru=c.element.offsetWidth):(J.warn("Anchor HTML element was not found, making it generic"),c.type="GENERIC")}H.push(c);w();h||m()}};a.remove=function(a){for(var c=0;c<H.length;c++){var d=H[c];if(d.Ca==a){"ANNOTATION"==d.type&&(a=d,z.le().removeChild(a.element));H.splice(c,1);w();break}}};a.update=
function(){for(var a=0,c=H.length;c--;){var b=H[c];b.Rk&&M.set(D.q(b.Ca.g.i),3*a++);var e,h=b,k=R;e=F.fl(F.xj());e=k=g.Wx(e,D.q(h.Ca.g.i),k);h=e[0];k=e[1];e=e[2];if(h!=b.x||k!=b.y||e!=b.depth){switch(b.type){case "ANNOTATION":var n=b.element;n.style.left=Math.floor(h)+"px";n.style.top=Math.floor(k-b.$p)+"px";break;case "ELEMENT":var n=b.element,p=n.getBoundingClientRect();n.style.cssText+="left:"+Math.floor(h-p.width/2)+"px;top:"+Math.floor(k-p.height/2)+"px;"}b.x=h;b.y=k;b.depth=e;b.Dl&&b.Dl(h,k,
b.$i,b.Ca,n)}}H.sort(f);for(c=0;c<H.length;c++)b=H[c],"GENERIC"!=b.type&&(b.element.style.zIndex=d==b.element?H.length:c);0<a&&(a=F.qa(F.xj(),"ANCHOR_VISIBILITY").D[0].G,q.zT(a,M))};a.pI=function(){for(var a=z.le(),d=H.length;d--;){var b=H[d],e=b.Ca,h=b.x,f=b.y,g=b.depth,g=0>h||0>f||0>g||1<g||F.dx(e)||h>=a.clientWidth||f>=a.clientHeight?"out":"visible";if(b.Rk&&"out"!=g){var g=b,k=F.qa(F.xj(),"ANCHOR_VISIBILITY").k,v=z.an(g.x,g.y,p,k);N.by(k.Ve,v[0],k.height-v[1],2,2,c);g=1020==c[0]+c[4]+c[8]+c[12]?
"visible":"out"==g.$i||0==c[0]+c[4]+c[8]+c[12]?"covered":g.$i}if(g!=b.$i){switch(b.type){case "ANNOTATION":case "ELEMENT":var m=b.element;if(!m)break;"out"==g?(m.style.visibility="hidden",m.children.length&&(m.children[0].style.visibility="hidden")):"visible"==g?(m.style.visibility="visible",m.children.length&&(m.children[0].style.visibility="visible"),m.style.opacity=1):(m.style.visibility="visible",m.style.opacity=.1,m.children.length&&(m.children[0].style.visibility="visible"),"ANNOTATION"==b.type&&
1<m.children.length&&(k=m.children[1],k.style.visibility="hidden",k.children.length&&(k.children[0].style.visibility="hidden")))}b.$i=g;b.Dl&&b.Dl(h,f,b.$i,e,m)}}};a.PW=function(a,c){for(var d=0;d<H.length;d++)H[d].Ca==a&&(H[d].Dl=c)};a.LX=function(a){for(var c=0;c<H.length;c++)H[c].Ca==a&&(H[c].Dl=null)};a.ha=function(){for(var a=0;a<H.length;a++){var c=H[a];"ANNOTATION"==c.type&&z.le().removeChild(c.element)}H.length=0};a.MP=function(a){for(var c=0;c<H.length;c++)if(H[c].Ca==a)return!0;return!1};
a.TY=function(a){for(var c=0;c<H.length;c++)if(H[c].Ca==a)return H[c].Pq;return!1};a.pause=function(){I=!0};a.oh=function(){I=!1};a.aR=function(a,c){for(var d=-1,b=0;b<H.length;b++){var e;if(e="visible"==H[b].$i){var h=H[b];e=Math.round(h.Ru);var f=Math.round(h.$p),g=h.x,h=h.y;e=a>=g&&a<=g+e&&c<h&&c>=h-f?!0:!1}if(e)if(0>d)var k=H[b].depth,d=b;else H[b].depth<k&&(d=b,k=H[b].depth)}return 0>d?null:H[d].Ca}};b4w.module.__objects=function(a,l){function m(a){var c=a.A;a=a.g;for(var d=0;d<c.length;d++){var b=c[d].Ta;b.j.outline&&a.lh&&R.HR(b)}}function b(a){a.g.lh=0;a=fa.indexOf(a);-1!=a&&fa.splice(a,1)}function e(a){if(a.Yk)for(var c=a.A,d=0;d<c.length;d++)R.hI(c[d].Ta,a)}function x(a,c){for(var b=a.A,e=c.A,h=0;h<b.length;h++){for(var f=!1,g=0;g<e.length;g++)if(b[h].Ta==e[g].Ta){f=!0;break}f||k(c,b[h].Ta)&&d.Tm(c,b[h].Ta)}}function k(a,c){return!c.VA&&"SPEAKER"==a.type||!c.LK&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function B(a,c){if(a.dg_parent&&a.dg_parent.Ku||a.parent&&a.parent.Ku)return!0;switch(a.type){case "MESH":var d=a.b4w_do_not_batch,b=a.b4w_collision,e=a.b4w_vehicle,f=a.b4w_floating,k=a.b4w_character,n=h.xP(a),p=H.yB(a),v=0<a.data.b4w_shape_keys.length,m=a.b4w_dynamic_geometry;if(!(d=g.zB(a,c)||d||b||e||v||f||n||k||p||m))a:{d=a.data;for(b=0;b<d.materials.length;b++){e=d.materials[b];if(!(f=e.b4w_lens_flares))b:{if(e=e.node_tree)for(e=e.nodes,f=0;f<e.length;f++)if(k=e[f],"VECT_TRANSFORM"==
k.type&&(n=k.convert_from,p=k.convert_to,!(!k.Sa[0].Yb||"WORLD"==n&&"CAMERA"==p||"CAMERA"==n&&"WORLD"==p||"OBJECT"==n&&"OBJECT"==p))){f=!0;break b}f=!1}if(f){d=!0;break a}}d=!1}return d;case "EMPTY":return d=H.yB(a),b=a.b4w_do_not_batch,e=Boolean(a.b4w_anchor),g.zB(a,c)||d||b||e;default:return!0}}function r(a,c){var d=a.animation_data,b=a.data?a.data.animation_data:null;d&&d.action&&(d=d.action,(d.j.type==g.Cu||d.j.type==g.Bu&&"ARMATURE"==c.type||d.j.type==g.FJ&&"LAMP"==c.type||d.j.type==g.EJ&&"WORLD"==
c.type)&&c.pf.push(d));b&&b.action&&("SPEAKER"==c.type||"LAMP"==c.type)&&c.pf.push(b.action);"MESH"==c.type&&c.pf.push.apply(c.pf,g.TO(a))}function w(a,c,d){c=Y[c]||[];for(var b=[],e=0;e<c.length;e++){var h=c[e];if(h.g.Ad==d||-1==d)for(var f=h.A,g=0;g<f.length;g++)f[g].Ta==a&&b.push(h)}return b}function f(a,c,b,e){for(var h=null,f=0;f<c.length;f++){var g=c[f];if((b?g.Tj:g.name)==a&&(g.g.Ad==e||-1==e)&&(h=g,!d.xf(h)))break}return h}function q(a){Y.ALL.push(a);Y[a.type]||(Y[a.type]=[]);Y[a.type].push(a);
var c=a.g.se;if(null!=c)for(var d=0;d<aa.length;d++){var b=aa[d];b.g.se==c&&b.Lo.push(a)}}var g=l("__animation"),z=l("__batch"),A=l("__boundings"),J=l("__camera"),N=l("__config"),F=l("__constraints"),G=l("__geometry"),D=l("__lights"),H=l("__nla"),I=l("__nodemat"),d=l("__obj_util"),h=l("__particles"),v=l("__physics"),M=l("__print"),c=l("__primitives"),p=l("__quat"),R=l("__scenes"),K=l("__sfx"),t=l("__transform"),y=l("__textures"),u=l("__tsr"),C=l("__util"),L=l("__vec3"),n=l("__armature"),T=l("__anchors"),
O=N.v,V=N.ic;a.Yz=-1;var Y={ALL:[]},la=new Float32Array(24),W=0,ba=0,aa=[],fa=[],ea=new Float32Array(3),ia=new Float32Array(4);a.Mt=0;a.Lt=1;a.Ic=2;a.oc=-1;a.update=function(a){for(var c=Y.ARMATURE,d=0;d<fa.length;d++){var e=fa[d],h=e,f=a,g=0,k=h.PF;0==k.at&&(k.at=f);f-=k.at;if(k.ey&&f/k.re>=k.ey)b(h);else{f%=k.re;if(f<k.Nx)switch(k=f/(k.Nx/5),f=Math.floor(k),f){case 0:g=(k-f)/2;break;case 1:g=(k-f)/2+.5;break;case 2:g=1;break;case 3:g=1-(k-f)/2;break;case 4:g=.5-(k-f)/2}h.g.lh=g}e.g.lh&&m(e)}if(c)for(d=
0;d<c.length;d++)a=c[d],a.Dx&&(t.p(a),a.Dx=!1)};a.WG=function(a,c){a.g.lh=c;m(a)};a.Fk=function(a,c,d,b){var e=a.PF;e.at=0;e.Nx=c;e.re=d;e.ey=b;-1==fa.indexOf(a)&&fa.push(a)};a.rq=b;a.Fi=function(a,c){c.Gi=a.uuid;c.dj=!0;r(a,c);a.Ku=c.Ea=B(a,c);a.MK=!0;c.Ed=a.b4w_vehicle;c.Ze=a.b4w_character;c.Gj=a.b4w_floating;c.kk=a.b4w_collision;c.pb=a.b4w_collision_id;c.zq=a.b4w_correct_bounding_offset;var b=a.game;c.If={hs:b.physics_type,ip:b.use_ghost,sI:b.use_sleep,kg:b.mass,wI:b.velocity_min,vI:b.velocity_max,
Wv:b.damping,py:b.rotation_damping,rQ:b.lock_location_x,sQ:b.lock_location_y,tQ:b.lock_location_z,uQ:b.lock_rotation_x,vQ:b.lock_rotation_y,wQ:b.lock_rotation_z,mn:b.collision_margin,kn:b.collision_group,nn:b.collision_mask,xz:b.use_collision_bounds,uq:b.collision_bounds_type,gp:b.use_collision_compound};if(b=a.b4w_vehicle_settings)c.Vd={name:b.name,Id:b.part,iT:b.suspension_rest_length,ez:b.suspension_compression,gz:b.suspension_stiffness,fz:b.suspension_damping,Lz:b.wheel_friction,ny:b.roll_influence,
vx:b.max_suspension_travel_cm,Rn:b.force_max,Zm:b.brake_max,jm:b.steering_max,zl:b.max_speed_angle,zn:b.delta_tach_angle,Zo:b.speed_ratio,ap:b.steering_ratio,jo:b.inverse_control,qj:b.floating_factor,qk:b.water_lin_damp,rk:b.water_rot_damp,GH:b.synchronize_position};if(b=a.b4w_floating_settings)c.Zk={name:b.name,Id:b.part,qj:b.floating_factor,qk:b.water_lin_damp,rk:b.water_rot_damp,GH:b.synchronize_position};if(b=a.b4w_character_settings)c.KB={FU:b.walk_speed,MR:b.run_speed,aT:b.step_height,ZP:b.jump_strength,
HU:b.waterline};for(b=0;b<a.constraints.length;b++){var e=a.constraints[b];"RIGID_BODY_JOINT"==e.type&&c.Sx.push({target:e.target.ya,cR:e.pivot_type,dR:e.pivot_x,eR:e.pivot_y,fR:e.pivot_z,$d:e.axis_x,ae:e.axis_y,be:e.axis_z,kU:e.use_limit_x,lU:e.use_limit_y,mU:e.use_limit_z,fU:e.use_angular_limit_x,gU:e.use_angular_limit_y,hU:e.use_angular_limit_z,iQ:e.limit_max_x,jQ:e.limit_max_y,kQ:e.limit_max_z,lQ:e.limit_min_x,mQ:e.limit_min_y,nQ:e.limit_min_z,cQ:e.limit_angle_max_x,dQ:e.limit_angle_max_y,eQ:e.limit_angle_max_z,
fQ:e.limit_angle_min_x,gQ:e.limit_angle_min_y,hQ:e.limit_angle_min_z})}b=c.g=d.Pk("MESH"===c.type?c.Ea?"DYNAMIC":"STATIC":c.type);a.parent?(c.parent=a.parent.ya,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(c.Bo=a.parent_bone),a.pinverse_tsr&&(c.ls=u.create(),u.copy(a.pinverse_tsr,c.ls))):a.dg_parent&&(c.parent=a.dg_parent.ya,c.li=!0);var e=a.location,h=a.scale[0];C.Yx(a.rotation_quaternion,ia);t.lc(c,e);t.sg(c,ia);t.ve(c,h);c.hp=a.b4w_use_default_animation;c.Xi=g.Ou(a.b4w_anim_behavior);a.b4w_object_tags&&
(c.Or={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});a.b4w_viewport_alignment&&(c.st={OK:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":n.Fi(a,c);e=b.Oe;h=g.XL(e);a.b4w_animation_mixing?(b.Kd=new Float32Array(h.Wa),b.te=new Float32Array(h.Wa),b.Td=new Float32Array(h.trans),b.Ee=new Float32Array(h.trans)):(b.Kd=h.Wa,b.te=h.Wa,b.Td=h.trans,b.Ee=h.trans);for(var f in e){var k=
e[f];1==k.oq.length&&n.GT(k,!0,h.trans,h.Wa)}b.Ux=h;b.Ue=0;b.Yi=a.b4w_animation_mixing;break;case "MESH":b.Sk=a.b4w_do_not_render;b.Gk=z.GL(a.data.b4w_bounding_box);b.qi=V.outlining_overview_mode||a.b4w_selectable;b.Zr=a.b4w_selectable;b.ic=V.outlining_overview_mode||a.b4w_outlining;b.Yr=a.b4w_outlining;b.QF=V.outlining_overview_mode||a.b4w_outline_on_select;b.rf=a.b4w_billboard;b.ev=a.b4w_pres_glob_orientation;b.Xm="BASIC";b.Wm="SPHERICAL"==a.b4w_billboard_geometry;f=b.Ll;f.Ml=a.b4w_outline_settings.outline_duration;
f.Nl=a.b4w_outline_settings.outline_period;f.Ol=a.b4w_outline_settings.outline_relapses;b.qi&&(b.vq=C.eD(W),W++);for(f=0;f<a.data.b4w_vertex_anim.length;f++)e=a.data.b4w_vertex_anim[f],c.Gc.push({name:e.name,pa:e.frame_start,La:e.frame_end,SW:e.averaging,TW:e.averaging_interval,PK:e.allow_nla});c.g.Gc=c.Gc.length?!0:!1;"MESH"!=a.type&&C.l("Wrong object type: "+a.name);f=c.g;if(a.data.b4w_shape_keys.length)for(f.Qf=!0,e=0;e<a.data.b4w_shape_keys.length;e++)h={},h.value=a.data.b4w_shape_keys[e].value,
h.name=a.data.b4w_shape_keys[e].name,f.ui.push(h);else f.Qf=!1;b.ye=a.b4w_shadow_cast;b.Qd=a.b4w_shadow_receive;b.Pd=a.b4w_shadow_cast_only&&b.ye;b.rd=a.b4w_reflexible;b.fd=a.b4w_reflexible_only&&b.rd;b.Md=a.b4w_reflective;b.qg=a.b4w_reflection_type;b.Jg=a.b4w_caustics;b.Ie=a.b4w_wind_bending;b.op=a.b4w_wind_bending_angle;f=z.IU(a.b4w_wind_bending_angle,b.Gk,a.scale[0]);b.Ag=f;b.Dh=a.b4w_wind_bending_freq;b.Qg=a.b4w_detail_bending_freq;b.Pg=a.b4w_detail_bending_amp;b.Ig=a.b4w_branch_bending_amp;b.zj=
!1;b.dh=a.b4w_main_bend_stiffness_col;f=a.b4w_detail_bend_colors;b.ad={};b.ad.aF=f.leaves_stiffness_col;b.ad.$E=f.leaves_phase_col;b.ad.RF=f.overall_stiffness_col;b.mj=a.b4w_do_not_cull;b.Mq=a.b4w_disable_fogging;b.ag=a.b4w_dynamic_geometry;"MESH"!==a.type&&C.l("Wrong object");f=a.data.materials[0];b.Tn=f.physics.friction;b.In=f.physics.elasticity;b.uo=0;b.ei=-1;b.xl=a.b4w_lod_transition;b.Gr=!0;break;case "LINE":b.mj=!0;b.R=A.bc();b.Pe=A.Mi();b.Ha=A.kf();b.I=A.bc();b.Yc=A.Mi();b.na=A.kf();break;
case "CAMERA":J.bM(a,c);J.xL(c);break;case "LAMP":D.$P(a,c);break;case "SPEAKER":c.P=K.kN();b=!1;for(f=0;f<c.A.length;f++)if(c.A[f].Ta.b4w_enable_audio){b=!0;break}b&&K.Fi(a,c);break;case "EMPTY":b.R=A.bc(),f=A.Mi(),b.Pe=f,a.field&&(c.Yk={type:a.field.type,BH:a.field.strength}),a.b4w_anchor&&(c.anchor={type:a.b4w_anchor.type,Rk:a.b4w_anchor.detect_visibility,Pq:a.b4w_anchor.element_id,HQ:a.b4w_anchor.max_width})}q(c)};a.dU=function(a,c){c.Gi=a.uuid;c.dj=!0;r(a,c);a.Ku=c.Ea=B(a,c);a.MK=!0;c.g=d.Pk(c.type);
c.hp=a.b4w_use_default_animation;c.Xi=g.Ou(a.b4w_anim_behavior);q(c)};a.ST=function(a,c){var b=c.g;if(c.parent){!c.li&&c.If.gp&&c.parent.If.gp&&(c.kk=!1);for(var e=!1,h=0;h<c.A.length;h++)if(c.A[h].Ta.Kb){e=!0;break}if(h=e)h=c.If,h=c.Ed||c.Gj||v.Ze(c)||c.kk&&!h.ip&&0<h.kg&&("DYNAMIC"==h.hs||"RIGID_BODY"==h.hs);if(h)h=c.li?u.copy(b.i,u.create()):b.i,u.multiply(c.parent.g.i,h,b.i),t.lc(c,u.q(b.i)),t.ve(c,u.Pc(b.i)),t.sg(c,u.B(b.i));else if(c.li||!c.Bo)if(h=u.copy(b.i,u.create()),c.st&&"CAMERA"==c.parent.type){h=
{distance:c.st.distance,rotation:u.B(h)};switch(c.st.OK){case "TOP_LEFT":h.top=0;h.left=0;break;case "TOP":h.top=0;h.left=.5;break;case "TOP_RIGHT":h.top=0;h.right=0;break;case "LEFT":h.top=.5;h.left=0;break;case "CENTER":h.top=.5;h.left=.5;break;case "RIGHT":h.top=.5;h.right=0;break;case "BOTTOM_LEFT":h.bottom=0;h.left=0;break;case "BOTTOM":h.bottom=0;h.left=.5;break;case "BOTTOM_RIGHT":h.bottom=0,h.right=0}F.Tu(c,c.parent,h)}else F.TK(c,c.parent,h);else h=u.copy(b.i,u.create()),F.UK(c,c.parent,
c.Bo,h)}if("ARMATURE"==c.type)for(e=a.pose.bones,h=0;h<e.length;h++){var f=e[h],k=f.constraints;if(k)for(var n=0;n<k.length;n++){var m=k[n];"COPY_TRANSFORMS"!=m.type||m.subtarget||m.mute||F.eL(c,m.target.ya,f.name,C.IA,C.Fu)}}if("MESH"==c.type)var l=g.qD(a);if(l){k=l.ya;h=k.g.Ux;e=c.g;f=a.data;c.dq=k;f=f.vertex_groups;if(f.length){var k=k.g.Oe,n=0,m={},r;for(r in k){var z=C.Mc("name",r,f);z&&(m[r]={zI:z.index,Mh:k[r].Mh,$v:n++})}e.Ik=m;r=n;f=g.GD();e.eh=r;r>2*f?(e.ql=!1,M.error('too many bones for "'+
a.name+'" / '+e.eh+" bones (max "+f+" with blending, "+2*f+" without blending). Skinning will be disabled.")):e.ql=!0}r=g.iO(h.trans,h.Wa,b.Ik);l.b4w_animation_mixing?(b.Kd=new Float32Array(r.Wa),b.te=new Float32Array(r.Wa),b.Td=new Float32Array(r.trans),b.Ee=new Float32Array(r.trans)):(b.Kd=r.Wa,b.te=r.Wa,b.Td=r.trans,b.Ee=r.trans);b.Xu=new Float32Array(4);b.Wu=p.create();b.Ux=r;b.Ue=0}if(b.Md)if(b=c.g,"CUBE"==b.qg)b.Qe=ba++;else if("PLANE"==b.qg){a:{l=a.constraints;for(r=0;r<l.length;r++)if(h=l[r],
"LOCKED_TRACK"==h.type&&"REFLECTION PLANE"==h.name){if(h.target.ya){l=h.target.ya;break a}M.warn('Reflection plane target "'+h.target.name+'" for object: "'+c.name+"\" is not present on the scene. Using object's Z-axis.")}l=null}l||(l=C.cp("%reflection%"),l=d.tn(l,"EMPTY"),r=d.Pk("EMPTY"),l.g=r,x(c,l),F.fB(l,c,[0,0,0],null,1),q(l));r=null;for(h=0;h<aa.length;h++)if(aa[h]==l){r=h;break}null==r&&(r=aa.length,aa.push(l));l.g.se=r;b.se=r;l.Lo.push(c)}};a.NT=e;a.AX=x;a.lM=k;a.TT=function(a){for(var c=
0;c<a.length;c++){var d=a[c];!d.g||"DYNAMIC"!=d.g.type&&"CAMERA"!=d.g.type||t.p(d);d.hp&&g.MF(d)&&(g.cq(d),d.W.length&&g.play(d,null,g.Km))}};a.yj=function(a){return C.ia(a.Or)};a.ha=function(){ba=W=0;aa.length=0;fa.length=0;Y={ALL:[]}};a.copy=function(a,c,b){var e=c,h=d.xf(a);c=h?d.fD(h.name,c):c;if(f(c,Y.ALL,!1,-1)){for(var h=1,g;;){g="."+(3>String(h).length?("000"+String(h)).slice(-3):String(h));if(!f(c+g,Y.ALL,!1,-1))break;h++}M.error('Object "'+c+'" already exists. Name was replaced by "'+c+
g+'".');e+=g;c+=g}e=d.tn(c,a.type,e);e.dj=a.dj;e.Ea=a.Ea;e.mo=a.mo;e.hp=a.hp;e.g=d.Lk(a.g);e.Or=d.Lk(a.Or);x(a,e);e.zk=d.Fv(a.zk);e.parent=d.Fv(a.parent);e.li=a.li;e.Bo=a.Bo;e.Gc=d.Fv(a.Gc);e.Xi=a.Xi;!a.r||a.Ed||a.Ze||a.Gj||(e.kk=a.kk,e.r=null);e.pb=a.pb;e.zq=a.zq;e.If=d.Lk(a.If);c=[];for(h=0;h<a.A.length;h++){var k=e.A[h];g=a.A[h].X;if(b){for(var k=k.X,n=0;n<g.length;n++)if(!g[n].eg){var p=d.Lk(g[n]);k.push(p);c.push(g[n].oa)}for(n=0;n<g.length;n++)if(g[n].eg){p=d.Lk(g[n]);k.push(p);for(var v=0;v<
c.length;v++)c[v]==g[n].oa&&(p.oa=k[v].oa)}for(n=0;n<k.length;n++)k[n].oa&&G.iI(k[n].oa),k[n].Kl=e.Gi,z.BT(k[n],z.ZL(e.g));y.KS(k)}else k.X=d.KM(g)}d.qy(e,!1);q(e);e.g.HE=!0;e.g.IE=b;e.g.vq=C.eD(W);W++;return e};a.uz=function(a){for(var d=a.g,b=a.A[0].X,e,h,f,g,k,n,p,v,m,q,l,r,u=[],y=0;y<b.length;y++){var w=b[y];if("MAIN"==w.type){var C=b[0].oa.sd,M=b[0].oa.ed.a_position.offset;e=g=C[M];h=k=C[M+1];f=n=C[M+2]}}for(y=0;y<b.length;y++)if(w=b[y],w.oa&&w.na&&w.I){var C=w.oa.sd,M=w.oa.ed.a_position.offset,
L=w.oa.ed.a_position.length+M;p=q=C[M];v=l=C[M+1];m=r=C[M+2];for(var K=M;K<L;K+=3){var M=C[K],B=C[K+1],aa=C[K+2];p=Math.max(M,p);v=Math.max(B,v);m=Math.max(aa,m);q=Math.min(M,q);l=Math.min(B,l);r=Math.min(aa,r)}w.R.max_x=p.toFixed(3);w.R.max_y=v.toFixed(3);w.R.max_z=m.toFixed(3);w.R.min_x=q.toFixed(3);w.R.min_y=l.toFixed(3);w.R.min_z=r.toFixed(3);A.Hg(w.R,d.i,w.I);A.On(w.I,la);for(C=u.length=0;C<la.length;C++)u.push(la[C]);w.na=A.Aq(u,!0);w.Ha=A.kv(w.na,d.i);"MAIN"==w.type&&(e=Math.max(p,e),h=Math.max(v,
h),f=Math.max(m,f),g=Math.min(q,g),k=Math.min(l,k),n=Math.min(r,n))}p={max_x:parseFloat(e.toFixed(3)),max_y:parseFloat(h.toFixed(3)),max_z:parseFloat(f.toFixed(3)),min_x:parseFloat(g.toFixed(3)),min_y:parseFloat(k.toFixed(3)),min_z:parseFloat(n.toFixed(3))};l=e-g;m=h-k;v=f-n;g=.5*(e+g);q=.5*(h+k);r=.5*(f+n);var x=g,H=r;k=Math.max(l,Math.max(m,v))/2;n=Math.max(l,v)/2;var I=[g/(l?l:1),q/(m?m:1),r/(v?v:1)],u=.5;if(d.rf)M=Math.max(Math.abs(p.max_x),Math.abs(p.min_x)),B=Math.max(Math.abs(p.max_y),Math.abs(p.min_y)),
aa=Math.max(Math.abs(p.max_z),Math.abs(p.min_z)),f=Math.sqrt(M*M+B*B+aa*aa),y=Math.sqrt(M*M+B*B),p.max_x=p.max_y=p.max_z=f,p.min_x=p.min_y=p.min_z=-f,n=y,k=f,M=new Float32Array([0,0,0]),e=new Float32Array([k,k,k]),f=new Float32Array([0,0,0]);else{for(y=0;y<b.length;y++)if(w=b[y],"MAIN"==w.type)for(C=w.oa.sd,L=b[y].oa.ed,M=L.a_position.offset,L=L.a_position.length+M,K=M;K<L;K+=3){var M=C[K],B=C[K+1],aa=C[K+2],T=Math.sqrt((g-M)*(g-M)+(q-B)*(q-B)+(r-aa)*(r-aa));if(T>k){var w=g-k*(M-g)/T,D=q-k*(B-q)/
T,T=r-k*(aa-r)/T;g=(w+M)/2;q=(D+B)/2;r=(T+aa)/2;k=Math.sqrt((g-M)*(g-M)+(q-B)*(q-B)+(r-aa)*(r-aa))}D=Math.sqrt((x-M)*(x-M)+(H-aa)*(H-aa));D>n&&(w=x-n*(M-x)/D,T=H-n*(aa-H)/D,x=(w+M)/2,H=(T+aa)/2,n=Math.sqrt((x-M)*(x-M)+(H-aa)*(H-aa)));M/=l?l:1;B/=m?m:1;aa/=v?v:1;T=Math.sqrt((I[0]-M)*(I[0]-M)+(I[1]-B)*(I[1]-B)+(I[2]-aa)*(I[2]-aa));T>u&&(w=I[0]-u*(M-I[0])/T,D=I[1]-u*(B-I[1])/T,T=I[2]-u*(aa-I[2])/T,I[0]=(w+M)/2,I[1]=(D+B)/2,I[2]=(T+aa)/2,u=Math.sqrt((I[0]-M)*(I[0]-M)+(I[1]-B)*(I[1]-B)+(I[2]-aa)*(I[2]-
aa)))}y=l?l*I[0]:e;h=m?m*I[1]:h;f=v?v*I[2]:f;e=u*l;C=u*m;L=u*v;M=new Float32Array([g,q,r]);e=new Float32Array([e,C,L]);f=new Float32Array([y,h,f]);n=parseFloat(n.toFixed(3))}d.R=p;z.lS(d,n,n,p);p=A.Bq(k,M);d.Pe=p;p=A.rn([e[0],0,0],[0,e[1],0],[0,0,e[2]],f);d.Ha=p;t.p(a);if(O.debug_view)for(y=0;y<b.length;y++)if("DEBUG_VIEW"===b[y].type&&b[y].jj){a=c.yw(1,p.O);G.EG(a,[p.$d[0],p.ae[1],p.be[2]],p.O);G.Zs(a,1,!0);a.ba.a_polyindex=G.Sq(a);z.AT(b[y],a);break}};a.Gb=w;a.kP=function(a,c){for(var d=Y.ALL||
[],b=[],e=0;e<d.length;e++){var h=d[e];if((h.g.Ad==c||-1==c)&&h.dj)for(var f=h.A,g=0;g<f.length;g++)f[g].Ta==a&&b.push(h)}return b};a.Vh=function(a){var c=Y.ALL;if(-1==a)return c;for(var d=[],b=0;b<c.length;b++){var e=c[b];e.g.Ad==a&&d.push(e)}return d};a.SS=function(a){var c=w(a,"LAMP",-1);if(c.length==a.j.f0){for(var b=[],e=0;e<c.length;e++){var h=c[e],h=d.aa(h,a);b[h.Ij]=e}for(e=0;e<b.length-1;e++)for(h=e+1;h<b.length;h++){var f=c[b[e]].$b,g=c[b[h]].$b;if(g.vm&&g.lk&&(!f.vm||!f.lk)||!f.vm&&(g.vm||
!f.lk&&g.lk))f=b[e],b[e]=b[h],b[h]=f}for(e=0;e<b.length;e++)h=c[b[e]],d.aa(h,a).Ij=e,R.jI(c[b[e]],a)}};a.F2=function(a){for(var c=w(a,"LAMP",-1),b=w(a,"MESH",-1),e=0;e<b.length;e++)for(var h=d.aa(b[e],a).X,f=0;f<h.length;f++){var g=h[f];"MAIN"==g.type&&(z.CT(g,c,a),z.Uc(g))}};a.Wr=function(a,c,d,b,e){for(var h=0;h<a.A.length;h++)for(var f=a.A[h].X,g=0;g<f.length;g++){for(var k=f[g],n=0;n<k.fa.length;n++)k.fa[n].Oh=c;k.oa.Oh=d;k.rb.Oh=b;""!==k.Gl&&(k=I.JD(k.Gl))&&(k.TB=e)}};a.er=function(){for(var a=
[],c=Y.MESH,d=0;d<c.length;d++){var b=c[d];b.g.qi&&b.dj&&a.push(b)}return a};a.ND=function(){for(var a=[],c=Y.MESH,d=0;d<c.length;d++){var b=c[d];b.g.ic&&b.dj&&a.push(b)}return a};a.gc=function(c,b,e,h){var g=null,k=Y.ALL;switch(c){case a.Mt:g=f(b,k,!0,e);break;case a.Lt:a:{for(c=0;c<k.length;c++)if(g=k[c],g.Tj==e&&(g.g.Ad==h||-1==h)){var n=d.xf(g);if(n&&n.Tj==b)break a}g=null}break;case a.Ic:a:{for(h=0;h<k.length;h++){c=k[h];for(var g=b.length-1,n=c,p=!0;0<=g&&p;)p=n&&n.Tj==b[g]&&(n.g.Ad==e||-1==
e),n&&(n=d.xf(n)),g--;if(p&&!n){g=c;break a}}g=null}}return g};a.hr=function(a,c){return f("%meta_world%"+a,Y.WORLD,!0,c)};a.ks=function(c,d){var b=R.xj();if(!b)return M.error("No active scene"),null;var e=T.aR(c,d);if(e)return e;e=R.bR(b,c,d);if(!e)return null;for(var b=w(b,"MESH",-1),h=0;h<b.length;h++){var f=b[h].g,g=f.vq;if(g&&3>Math.abs(255*g[0]-e[0])&&3>Math.abs(255*g[1]-e[1])&&3>Math.abs(255*g[2]-e[2]))return f.ic&&f.QF&&(V.outlining_overview_mode?a.Fk(b[h],V.Ml,V.Nl,V.Ol):(e=f.Ll,a.Fk(b[h],
e.Ml,e.Nl,e.Ol))),b[h]}return null};a.gH=function(a,c){for(var d=w(a,"EMPTY",-1),b=0;b<d.length;b++){var h=d[b];if(h.Yk&&"WIND"===h.Yk.type)var f=h}if(!f)return M.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=C.jb(c.wind_dir),L.set(Math.sin(d),0,Math.cos(d),ea),C.dw(ea,C.wc,ia),t.sg(f,ia));"number"==typeof c.wind_strength&&(f.Yk.BH=c.wind_strength);e(f)};a.No=function(a){F.mM(a)&&F.remove(a);var c=Y.ALL,d=Y[a.type],b=c.indexOf(a);a=d.indexOf(a);-1!=b&&c.splice(b,1);-1!=
a&&d.splice(a,1)};a.TQ=q;a.UQ=function(a){return Y[a.type]&&-1<Y[a.type].indexOf(a)}};b4w.module.__lights=function(a,l){function m(a){x.scale(a.color,a.Sg,a.on)}l("__print");var b=l("__tsr"),e=l("__util"),x=l("__vec3"),k=new Float32Array(3);new Float32Array(3);a.$P=function(a,l){var w=a.data,f=l.$b={name:"",type:w.type,bG:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),on:new Float32Array(3),GN:0,em:0,Ws:0,gn:.1,fn:30,jD:!1,BF:!1,SN:!1,vm:!0,lk:!0,Sg:1,distance:25,nY:"INVERSE_SQUARE"};f.name=l.name;f.vm=w.use_diffuse;f.lk=w.use_specular;var q=e.Cb(b.B(l.g.i),
e.wc,k);x.normalize(q,q);f.direction.set(q);f.color[0]=w.color[0];f.color[1]=w.color[1];f.color[2]=w.color[2];f.Sg=f.GN=w.energy;m(f);f.distance=w.distance;f.gn=w.clip_start;f.fn=w.clip_end;if("POINT"===f.type||"SPOT"===f.type)f.distance=w.distance;"SPOT"===f.type?(f.Ws=w.spot_blend,f.em=w.spot_size):"POINT"===f.type&&(f.em=Math.PI/2);f.jD=w.b4w_generate_shadows;f.SN=w.b4w_dynamic_intensity};a.jS=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];m(a)};a.g1=function(a,b){a.Ws=b};a.f1=function(a,
b){a.distance=b};a.h1=function(a,b){a.em=b};a.kS=function(a,b){a.Sg=b;m(a)};a.PT=function(a){var k=a.$b;if(k){e.Cb(b.B(a.g.i),e.wc,k.direction);x.normalize(k.direction,k.direction);if("SUN"==k.type){a=Math.acos(x.dot(k.bG,e.Iu));var m=Math.acos(x.dot(k.direction,e.Iu));k.BF=Math.floor(a/.025)!=Math.floor(m/.025)?!0:!1}x.copy(k.direction,k.bG)}}};b4w.module.__nla=function(a,l){function m(){return{type:"CLIP",pa:0,La:0,qh:!1,paused:!1,Me:"",Rm:"",Lb:0,Ih:0,Vi:0,MC:0,LC:0,rI:!1,scale:1,repeat:1,ZA:0}}function b(a,e){if(a.animation_data){var f=a.animation_data.nla_tracks;if(f)for(var g=0;g<f.length;g++)e.push(f[g])}f=a.nodes;for(g=0;g<f.length;g++){var c=f[g];c.node_group&&(c=c.node_group.node_tree)&&b(c,e)}}function e(a,b){var e=Math.round(a)-b.pa;b.jk&&(e%=b.bl,0>e&&(e+=b.bl));return b.ub+e}function x(a,b){var e=(b-I)*G.Ec()+a.ub;e>a.pa?(e-=
a.pa,a.nd&&(e%=a.La-a.pa+1),e+=a.pa):e=a.pa;return e}function k(a,b){a=D.S(a,b.pa,b.La);var e=a==b.La?b.ZA:b.Ih+(a-b.pa)/b.scale%(b.Vi-b.Ih);b.rI&&(e=b.Vi-e+b.Ih);return e}function B(a,b){for(var e=[],f=0;f<a.length;f++){var c=a[f].strips;if(c)for(var g=0;g<c.length;g++){var k=c[g],q=m();q.type=k.type;q.pa=k.frame_start;q.La=k.frame_end;q.Lb=b;q.Ih=k.action_frame_start;q.Vi=k.action_frame_end;q.rI=k.use_reverse;q.scale=k.scale;q.repeat=k.repeat;k.action&&(q.Me=k.action.name,q.Rm=k.action.uuid);e.push(q)}}return e}
function r(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function w(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var e=a[b],f=e.node_tree;if(e=e.use_nodes&&f)a:{if(f.animation_data&&(e=f.animation_data.nla_tracks)&&e.length){e=!0;break a}f=f.nodes;for(e=0;e<f.length;e++);e=!1}if(e)return!0}return!1}function f(a,b){var e=J.o();if(e.ga){var f=x(e.ga,b);e.ga.ub-=f-a;e.ga.$k=!0}}
var q=l("__animation");l("__config");var g=l("__objects"),z=l("__obj_util"),A=l("__print"),J=l("__scenes"),N=l("__sfx"),F=l("__textures"),G=l("__time"),D=l("__util"),H=[],I=-1;a.Fi=function(a,e){var f;f=null;for(var g=e.A.length-1;0<=g;g--){var c=e.A[g];if(c.Ta.b4w_use_nla&&(f=c,c.Ta.VA))break}if(f){f.LF=!0;var k=0;if((g=a.animation_data)&&g.nla_tracks.length){var l=g.nla_tracks;if(z.$g(e)||z.ka(e)||z.hc(e)||z.Ej(e)||z.nl(e)||z.Hj(e)||z.qo(e))l=B(l,k),l.length&&(e.af=e.af.concat(l),k++)}r(a)&&(l=
a.data.animation_data.nla_tracks,l=B(l,k),l.length&&(e.af=e.af.concat(l),k++));if(z.hc(e))for(c=a.data.materials,g=0;g<c.length;g++){var w=c[g];if(w.use_nodes&&w.node_tree&&(l=[],b(w.node_tree,l),l=B(l,k),l.length)){for(var w=k,t=l,y=q.PO(),u=[],A=0,L=0;L<t.length;L++){var n=t[L];""!=n.Rm?n=D.Mc("uuid",n.Rm,y):(n=n.Me,n=D.Mc("name",n,y)||D.Mc("name",n+"_B4W_BAKED",y));if(n){var n=n.fcurves,x=[],O;for(O in n)x.push(O);u.push(x)}}for(L=0;L<u.length;L++){y=!1;for(n=0;n<L;n++)if(D.uL(u[L],u[n])){t[L].Lb=
t[n].Lb;y=!0;break}y||(t[L].Lb=k+A++)}k=w+A;e.af=e.af.concat(l)}}if(!z.qo(e)){for(g=0;g<a.particle_systems.length;g++)c=a.particle_systems[g],O=c.settings,"EMITTER"==O.type&&O.b4w_allow_nla&&(O=m(),O.type="CLIP",O.pa=f.Ta.frame_start,O.La=f.Ta.frame_end+1,O.Me=c.name,O.Lb=k,O.Ih=O.pa,O.Vi=O.La,e.af.push(O),k++);c=k+1;for(g=0;g<e.Gc.length;g++)l=e.Gc[g],l.PK&&(k=c,O=m(),O.type="CLIP",O.pa=f.Ta.frame_start,O.La=f.Ta.frame_end+1,O.Me=l.name,O.Lb=k,O.Ih=O.pa,O.Vi=O.La,e.af.push(O))}}};a.YT=function(a,
b,e){a.ga||(a.ga={pa:a.frame_start,La:a.frame_end,ub:0,so:-1,Go:a.frame_end,Ho:a.frame_start,wm:null,nd:b,qb:[],fa:[],FG:a.name,ci:!1,$k:!1,my:!0},H.push(a.ga));b=a.ga;for(var f=g.kP(a,e),c=0;c<f.length;c++){var k=f[c];if(k.af.length){for(var q=0;q<k.A.length;q++){var l=k.A[q];l.Ta==a&&l.LF&&b.qb.push(k)}for(var q=k.af,l=b,t=k.name,r=0;r<q.length;r++){var u=q[r];l.pa>u.La||l.La<u.pa?(A.warn("NLA: Strip is out of scene range: "+(t+" ["+u.pa+":"+u.La+"]")),q.splice(r,1),r--):u.Me||"CLIP"!=u.type||(A.warn('NLA: no action in strip for object "'+
t+'".'),q.splice(r,1),r--)}k=k.af;q=b;for(l=0;l<k.length;l++){for(var t=k[l],r=q.pa,u=q.La+1,z=0;z<k.length;z++){var w=k[z];t.Lb==w.Lb&&(w.La<=t.pa&&(r=t.pa),w.pa>=t.La&&(u=Math.min(u,w.pa)))}t.MC=r;t.LC=u;t.ZA=0===t.repeat%1?t.Vi:t.Ih+t.repeat%1*(t.Vi-t.Ih)}}}a=a.j.Am;for(c=0;c<a.length;c++)f=a[c].j,f.nt&&(f.Ba||f.Qc)&&f.Bh==e&&(k=m(),k.type="VIDEO",f.jk?(k.pa=0,k.La=b.La):(k.pa=D.S(f.pa,0,b.La),k.La=D.S(f.pa+f.bl,0,b.La)),k.Me=a[c].name,b.fa.push(f))};a.start=function(){I=0};a.nP=function(){return I};
a.fZ=function(a){return a.ga?a.ga.ub:null};a.c1=function(a,b){return a.ga?(a.ga.ub=b,!0):!1};a.update=function(a,b){if(!(0>I)){0==I&&(I=a);for(var g=0;g<H.length;g++){var m=H[g];m.ci&&(m.ub-=G.Ec()*b);var c=x(m,a);if((!m.ci||m.$k)&&c>=m.Go)if(m.nd){var c=m,p=a;c.wm&&c.wm();f(c.Ho,p);c.my=!0;c=x(c,p)}else{var p=m,l=c;p.ci=!0;p.ub-=l-p.Go;p.wm&&p.wm()}if(!m.ci||m.$k){for(var p=m,l=c,r=0;r<p.qb.length;r++){for(var t=p.qb[r],z=t.af,u=0;u<z.length;u++){var w=z[u];"SOUND"==w.type&&l<p.so-1E-6&&(w.qh=!1)}for(u=
0;u<z.length;u++)switch(w=z[u],w.type){case "CLIP":if(w.MC<=l&&l<w.LC&&!w.qh){var A=t,n=w;""!=n.Rm?q.nL(A,n.Rm,n.Lb):q.apply(A,n.Me,n.Lb);q.Uo(A,q.wt,n.Lb);var B=k(n.pa,n);q.Xl(A,B,n.Lb);for(A=0;A<z.length;A++)z[A]!=w&&z[A].Lb==w.Lb&&(z[A].qh=!1);w.qh=!0}w.qh&&(A=t,n=k(l,w),1E-6<Math.abs(n-q.vD(A,w.Lb))&&q.Xl(A,n,w.Lb));break;case "SOUND":(l<p.so-1E-6||p.so<w.pa)&&w.pa<=l&&l<w.La&&!w.qh&&(A=t,B=w,n=(B.pa-l)/G.Ec(),B=(B.La-B.pa)/G.Ec(),N.play(A,n,B),w.qh=!0),p.so<w.La&&w.La<=l&&w.qh&&(w.qh=!1)}}p=
a;l=m;r=c;for(t=0;t<l.fa.length;t++)if(z=l.fa[t],z.Ba||z.Qc){u=F.AI(z);w=z;A=D.S(e(r,w),w.ub,w.ub+F.BI(w)-1);w.Qc&&(A=F.AU(w,A),A==w.uy&&A--);w=A;A=F.CI(z);B=n=!1;if(l.$k||l.my)B=!0;if(!l.ci){var O;O=e(r,z);O=z.ub<=O&&O<=z.ub+F.BI(z);var J=F.DI(z);z.jk&&w==A&&(B=!0);J||u==w||(B=!0);O&&!J?F.aG(z.name,z.Bh):O&&J?n=!0:!O&&J&&(z.Ba&&u<w?n=!0:F.Qx(z.name,z.Bh))}B?(F.dS(z.name,w,z.Bh),z.Qc&&(z.Wl=F.ys(z,p))):n&&F.EI(z)&&(z.Ba?F.oI(z):(u=F.ys(z,p),u!=z.Wl&&(z.dk=w,F.nI(z)),z.Wl=u))}m.so=c}m.$k=!1;m.my=!1}}};
a.ha=function(){H.length=0;I=-1};a.yB=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||r(a)||w(a)?!0:!1};a.Xl=f;a.Zn=function(a){var b=J.o();return b.ga?x(b.ga,a):-1};a.zH=function(){var a=J.o();a.ga&&(a.ga.ci=!0);for(var a=a.ga.fa,b=0;b<a.length;b++){var e=a[b];F.Qx(e.name,e.Bh)}};a.iR=function(){var a=J.o();a.ga&&(a.ga.ci=!1,a.ga.wm=null)};a.gZ=function(){var a=J.o();return a.ga?a.ga.pa:-1};a.DD=function(){var a=J.o();return a.ga?a.ga.La:-1};a.bi=function(){var a=J.o();return a.ga?
!a.ga.ci:!1};a.hX=function(){var a=J.o();return a.ga?a.b4w_use_nla:!1};a.gX=function(){var a=J.o();return a.ga?0<a.b4w_logic_nodes.length:!1};a.u1=function(a,b){var e=J.o();if(e.ga)e.ga.Ho=a,e.ga.Go=b;else return!1};a.Iy=function(a){var b=J.o();b.ga&&(b.ga.Go=a)};a.pS=function(a){var b=J.o();b.ga&&(b.ga.Ho=a)};a.J0=function(){var a=J.o();if(a.ga)a=a.ga,a.Ho=a.pa,a.Go=a.La;else return!1};a.X0=function(a){var b=J.o();if(b.ga)b.ga.nd=a;else return!1};a.oX=function(){var a=J.o();a.ga&&(a.ga.wm=null)};
a.UG=function(a){var b=J.o().ga;b&&(b.ub=-(a-I)*G.Ec()+b.Ho,b.$k=!0)};a.DD=function(){var a=J.o().ga;return a?a.La:null}};b4w.module.__scenes=function(a,l){function m(a){for(var c=0;c<a.length;c++){var d=a[c];if(!d.Le||!d.Le.length)return d}return null}function b(){Pb||Ha.l("No active scene available");return Pb}function e(a,c,d){if(!qa.Lq||!x(a,c,d))return null;d=a.b4w_shadow_settings;var b={};d.csm_resolution>qa.Rb?(b.csm_resolution=qa.Rb,fb.error("Shadow map texture has unsupported size. Changed to "+qa.Rb+".")):b.csm_resolution=d.csm_resolution;a=ra.fr(c,qa.Rd&&a.b4w_enable_ssao);b.self_shadow_polygon_offset=d.self_shadow_polygon_offset;
b.self_shadow_normal_offset=d.self_shadow_normal_offset;b.enable_csm=d.b4w_enable_csm&&1==a.length;b.Cf=[];b.vH=[];b.PN=[];b.gn=[];b.fn=[];for(c=0;c<a.length;c++)b.Cf.push(a[c].$b.type),b.vH.push(a[c].$b.em),b.PN.push(a[c].$b.distance),b.gn.push(a[c].$b.gn),b.fn.push(a[c].$b.fn),"SPOT"!=b.Cf[c]&&"POINT"!=b.Cf[c]||!b.enable_csm||(fb.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),b.enable_csm=!1);b.enable_csm?(b.csm_num=d.csm_num,b.csm_first_cascade_border=d.csm_first_cascade_border,
b.first_cascade_blur_radius=d.first_cascade_blur_radius,b.csm_last_cascade_border=d.csm_last_cascade_border,b.last_cascade_blur_radius=d.last_cascade_blur_radius,b.fade_last_cascade=d.fade_last_cascade,b.blend_between_cascades=d.blend_between_cascades):(b.csm_num=1,b.csm_first_cascade_border=d.csm_first_cascade_border,b.first_cascade_blur_radius=d.first_cascade_blur_radius,b.csm_last_cascade_border=d.csm_last_cascade_border,b.last_cascade_blur_radius=d.last_cascade_blur_radius,b.fade_last_cascade=
!1,b.blend_between_cascades=!1);return b}function x(a,c,d){if(0!=c.length&&qa.Yl)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var b=!1,e=!1;a=qa.Rd&&a.b4w_enable_ssao;if(0==c.length&&!a)return!1;for(c=0;c<d.length;c++){var f=d[c];f.b4w_shadow_cast&&(b=!0);f.b4w_shadow_receive&&(e=!0);if((a||b)&&e)return!0}return!1}function k(a){for(var c=0;c<a.length;c++)if("SUN"==a[c].$b.type)return!0;return!1}function B(a){if(!qa.vi)return!1;a=E(a);for(var c=0;c<a.length;c++){var d=
a[c];if(d.b4w_water&&d.b4w_water_shore_smoothing)return!0}return!1}function r(a){for(var c=0;c<a.length;c++)for(var d=a[c].particle_systems,b=0;b<d.length;b++)if(ra.OB(a[c],d[b].settings))return!0;return!1}function w(a){for(var c=E(a),d=[],b=0;b<c.length;b++){var e=c[b];if(e.b4w_water){for(var f={},h=0;h<a.length;h++)for(var g=a[h],k=g.data.materials,n=0;n<k.length;n++)k[n]==e&&(f.Ki=g.location[1]);f.od=e.b4w_water_fog_color.slice(0);f.od.push(e.b4w_water_fog_density);e.b4w_water_dynamic?(f.Gn=!0,
f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,f.dst_min_fac=e.b4w_water_dst_min_fac,
f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.Gn=!1,f.waves_height=0,f.waves_length=0);f.Jg=e.b4w_water_enable_caust;f.dM=e.b4w_water_caust_scale;f.cM=e.b4w_water_caust_brightness;f.eM=new Float32Array([.3,.7]);f.wi=null;e=e.texture_slots;for(h=0;h<e.length;h++)g=e[h].texture,!0===g.b4w_shore_dist_map&&"FILE"==g.image.source&&(f.wi=g.image,f.Qy=g.image.size[0],f.ux=g.b4w_max_shore_dist,g=g.b4w_shore_boundings,f.Zl=[(g[0]+g[1])/2,(g[2]+g[3])/2],f.$l=[g[0]-g[1],g[2]-g[3]]);d.push(f)}}if(0<d.length){f=
d[0];if(!f.Gn)for(b=0;b<d.length;b++)d[b].Gn&&(f=d[b]);return f}return null}function f(a){function c(a){if(a){a=a.nodes;for(var b=0;b<a.length;b++){var e=a[b];"GROUP"==e.type&&e.node_group&&c(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(d.gd=!0)}}}var d={gd:!1};a=E(a);for(var b=0;b<a.length;b++){var e=a[b];e.b4w_refractive&&(d.gd=!0);e.node_tree&&c(e.node_tree)}return d}function q(a,c,d){if(qa.Ko)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;a=
[];for(var b=0,e=!1,f=0;f<c.length;f++){var h=c[f];h.g.Md&&"CUBE"==h.g.qg&&b++;if(h.Lo.length){for(var g=null,k=0;k<a.length;k++)if(a[k]==h){g=k;break}null==g&&a.push(h)}}for(f=0;f<d.length;f++){a:if(c=d[f],c.b4w_reflexible){c=c.data.materials;for(h=0;h<c.length;h++)if(g=c[h].game_settings.alpha_blend,"OPAQUE"!=g&&"CLIP"!=g){c=!0;break a}c=!1}else c=void 0;c&&(e=!0)}return{sG:a,IF:b,Ng:[],Sv:[],og:[],ms:[],tE:e}}function g(a,c){var d=a.b4w_sky_settings,b={};b.zR=d.render_sky;b.procedural_skydome=
d.procedural_skydome&&c;b.use_as_environment_lighting=d.use_as_environment_lighting;b.am=d.color;b.rayleigh_brightness=d.rayleigh_brightness;b.mie_brightness=d.mie_brightness;b.spot_brightness=d.spot_brightness;b.scatter_strength=d.scatter_strength;b.rayleigh_strength=d.rayleigh_strength;b.mie_strength=d.mie_strength;b.rayleigh_collection_power=d.rayleigh_collection_power;b.mie_collection_power=d.mie_collection_power;b.mie_distribution=d.mie_distribution;b.rd=d.reflexible;b.fd=d.reflexible_only;!c&&
d.procedural_skydome&&fb.warn("There is no sun on the scene. Procedural sky won't be rendered");return b}function z(a){var c={};a=a.b4w_ssao_settings;c.radius_increase=a.radius_increase;c.zP=a.hemisphere;c.NL=a.blur_depth;c.xB=a.blur_discard_value;c.influence=a.influence;c.dist_factor=a.dist_factor;c.NR=a.samples;return c}function A(a){if(!(qa.kq&&a.b4w_enable_bloom&&a.j.wh))return null;var c={};a=a.b4w_bloom_settings;c.blur=a.blur;c.TN=a.edge_lum;c.key=a.key;return c}function J(a){var c={};a=a.b4w_motion_blur_settings;
c.mb_decay_threshold=a.motion_blur_decay_threshold;c.mb_factor=a.motion_blur_factor;return c}function N(a){var c={};a=a.b4w_color_correction_settings;c.brightness=a.brightness;c.contrast=a.contrast;c.exposure=a.exposure;c.saturation=a.saturation;return c}function F(a){var c={};a=a.b4w_god_rays_settings;c.$w=a.intensity;c.yl=a.max_ray_length;c.lm=a.steps_per_pass;return c}function G(a){var c={};c.kh=a.b4w_outline_color;c.yo=a.b4w_outline_factor;return c}function D(a){var c={};a=a.b4w_glow_settings;
c.small_glow_mask_coeff=a.small_glow_mask_coeff;c.large_glow_mask_coeff=a.large_glow_mask_coeff;c.small_glow_mask_width=a.small_glow_mask_width;c.large_glow_mask_width=a.large_glow_mask_width;return c}function H(a,c){var d=a.light_settings,b={};b.Tg=d.environment_energy;b.yz=d.use_environment_light;b.kw=d.environment_color;b.ne=a.horizon_color.slice(0);b.Je=a.zenith_color.slice(0);b.tU=a.use_sky_paper;b.sU=a.use_sky_blend;b.uU=a.use_sky_real;b.pH=null;b.Ty=null;b.lw=null;if(b.yz&&"SKY_TEXTURE"==b.kw&&
(!c.procedural_skydome||!c.use_as_environment_lighting)){for(var d=null,e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_environment_lighting){d=a.texture_slots[e];break}d?b.lw=d:(fb.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),b.yz=!1)}for(e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_skydome){d=a.texture_slots[e];b.pH=d;b.Ty={KL:d.blend_factor,
CP:d.horizon_factor,LU:d.zenith_up_factor,KU:d.zenith_down_factor,color:d.color,Ya:d.default_value,invert:d.invert,rU:d.use_rgb_to_intensity,LL:d.blend_type,nU:d.use_map_blend,oU:d.use_map_horizon,qU:d.use_map_zenith_up,pU:d.use_map_zenith_down};break}return b}function I(a){var c=a.fog_settings,d={};d.jU=c.use_fog;d.$w=c.intensity;d.depth=c.depth;d.start=c.start;d.height=c.height;d.lO=c.falloff;d.color=c.use_custom_color?c.color.slice(0):a.horizon_color.slice(0);a=d.color;d.od=new Float32Array([a[0],
a[1],a[2],1/d.depth]);d.Te=new Float32Array([d.$w,d.depth,d.start,d.height]);return d}function d(a,c){if(!qa.Jc)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var d=!1,b=!1,e=0;e<c.length;e++){for(var f=c[e],h=f.data.materials,g=0;g<h.length;g++)h[g].b4w_terrain&&(d=!0);f=f.particle_systems;for(g=0;g<f.length;g++)h=f[g].settings,"HAIR"==h.type&&h.b4w_dynamic_grass&&(b=!0);if(d&&b)return!0}return!1}function h(a,c){if(tb.outlining_overview_mode)return!0;if(qa.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var d=0;d<c.length;d++)if(c[d].ya.g.qi)return!0;return!1}else return!1}function v(a,c){if(tb.outlining_overview_mode)return!0;if(qa.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var d=0;d<c.length;d++)if(c[d].ya.g.ic)return!0;return!1}else return!1}function M(a,c){if(qa.Yg)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var d=0;d<c.length;d++)for(var b=c[d].data.materials,
e=0;e<b.length;e++)if(Ma.NB(b[e]))return!0;return!1}else return!1}function c(a,c){if(qa.gd)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return c.gd}else return!1}function p(a){for(var c=0;c<a.length;c++)for(var d=a[c].data.materials,b=0;b<d.length;b++){var e=d[b],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function R(a,c){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var d=
0;d<c.length;d++){var b=c[d].ya;if(b.anchor&&b.anchor.Rk)return!0}return!1}}function K(a,c,d){var b=ma.Gf(a,c);ma.xg(a,b,function(a,c,b){if(b.Ub){switch(b.from){case "COLOR":case "CUBEMAP":var e=c.k.Wb;break;case "DEPTH":e=c.k.he;break;case "SCREEN":e=null;break;case "MAIN_CUBE_REFLECT":return;default:Ha.l("Wrong slink")}switch(b.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:e||Ha.l("Connection of SCREEN is forbidden"),e.Ge&&Ha.l("Batch texture can't use renderbuffer"),oa.QB(d.rb,b.to)&&da.Ek(d,e,b.to)}}});for(a=0;a<c.Ga.length;a++){var b=c.Ga[a],e=c.vg[a];switch(b.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:e.Ge&&Ha.l("Batch texture can't use renderbuffer"),oa.QB(d.rb,b.to)&&da.Ek(d,e,b.to)}}}function t(a,c){return{ec:!0,iw:[!0,!0,!0,!0,!0,!0],mg:a,G:c}}function y(a,c,d,b,e,
f){function h(a,c){return a==c?0:a>c?1:-1}for(var g=c.g,k=ra.aa(c,e).X,n=0;n<k.length;n++){var p=k[n];p.Pd||p.fd||"MAIN"!=p.type&&"NODES_GLOW"!=p.type&&"PARTICLES"!=p.type&&"LINE"!=p.type||!("OPAQUE"==p.sb&&"OPAQUE"==b||"BLEND"==p.sb&&"BLEND"==b||"XRAY"==p.sb&&"XRAY"==b||"NODES_GLOW"==p.type&&"GLOW"==b)||(f||(u(p,a,c,d,b,e),da.Uc(p),C(p)),a.D.push(t(g,p)),K(d,a,p),L(p))}a.D.sort(function(a,c){return a.G&&c.G?-h(a.G.eb,c.G.eb)||-h(a.G.Wi,c.G.Wi)||h(a.G.Sj,c.G.Sj):0})}function u(a,c,d,b,e,f){var h=
d.g,g=f.j,k=ra.aa(d,f),p="NO_SHADOWS";d=S(f,["SHADOW_CAST"]);if(d.length&&a.Qd){switch(e){case "OPAQUE":p="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":p="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":p="NO_SHADOWS";break;case "SHADOW":p="SHADOW_MASK_GENERATION";break;default:Ha.l("Wrong subscene type")}for(var v=0;v<d.length;v++)da.mB(a,f.j.Rc)}d=a.Tb;oa.V(d,"SHADOW_USAGE",p);a.Jc&&(v=na.Ob(b,"GRASS_MAP"))&&n(a,v,h);if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.eo){e=c.Vr;
oa.V(d,"NUM_LIGHTS",e);oa.V(d,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1);oa.V(d,"REFLECTION_PASS",0);oa.V(d,"SSAO_ONLY",0);oa.V(d,"INVERT_FRONTFACING",0);(e=g.nc)&&c.Sf?oa.V(d,"WATER_EFFECTS",1):oa.V(d,"WATER_EFFECTS",0);if(e&&c.Jg&&h.Jg){oa.V(d,"CAUSTICS",1);if(v=g.Rc){h=v.Cf;for(v=p=0;v<h.length;v++)"SUN"==h[v]&&(p=v);oa.V(d,"SUN_NUM",p)}oa.V(d,"CAUST_SCALE",oa.H(c.DB));oa.V(d,"CAUST_SPEED",oa.H(c.EB,2));oa.V(d,"CAUST_BRIGHT",oa.H(c.CB))}else oa.V(d,"CAUSTICS",0);e&&(oa.V(d,"WAVES_HEIGHT",oa.H(e.waves_height)),
oa.V(d,"WAVES_LENGTH",oa.H(e.waves_length)),oa.V(d,"WATER_LEVEL",oa.H(e.Ki)));c=k.Ng;k=k.og;if(-1!==a.Sc.indexOf("u_mirrormap"))oa.V(d,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Md&&c)c=c.k.Wb,da.Ek(a,c,"u_cube_reflection"),oa.V(d,"REFLECTION_TYPE","REFL_CUBE");else if(a.Md&&k)for(v=0;v<k.length;v++)c=k[v].k.Wb,da.Ek(a,c,"u_plane_reflection"),oa.V(d,"REFLECTION_TYPE","REFL_PLANE");else oa.V(d,"REFLECTION_TYPE","REFL_NONE");(k=na.Ob(b,"SKY"))?a.eG?(c=k.k.Wb,da.Ek(a,c,"u_sky")):(a.fe=k.fe,oa.V(d,
"PROCEDURAL_FOG",1)):oa.V(d,"PROCEDURAL_FOG",0);c=g.Mz;c.yz&&(oa.V(d,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==c.kw?(c=c.lw?Za.Dc(c.lw,!1):k.k.Wb,oa.V(d,"SKY_TEXTURE",1),da.Ek(a,c,"u_sky_texture")):"SKY_COLOR"==c.kw&&oa.V(d,"SKY_COLOR",1));c=g.OI;c.jU&&(oa.V(d,"USE_FOG",1),oa.V(d,"FOG_TYPE",c.lO));a.Mo&&a.eb?(qa.Lq&&oa.V(d,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.eo||"NODES_GLOW"==a.type?(oa.V(d,"REFRACTIVE",1),g.gd?oa.V(d,"USE_REFRACTION",1):oa.V(d,"USE_REFRACTION",0)):g.gd?oa.V(d,"REFRACTIVE",
1):oa.V(d,"REFRACTIVE",0),(g.lF.gd||g.gd)&&oa.V(d,"HAS_REFRACT_TEXTURE",1)):(oa.V(d,"REFRACTIVE",0),oa.V(d,"USE_REFRACTION",0),oa.V(d,"USE_REFRACTION_CORRECTION",0));a.pk&&(qa.vi&&a.Gz&&na.Ob(b,"DEPTH_PACK")?oa.V(d,"SHORE_SMOOTHING",1):oa.V(d,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?oa.V(d,"DYNAMIC",1):oa.V(d,"DYNAMIC",0));"PARTICLES"==a.type&&(oa.V(d,"SIZE_RAMP_LENGTH",a.Qa.N1),oa.V(d,"COLOR_RAMP_LENGTH",a.Qa.ZB));if(!a.eg)for(a=a.fa,b=0;b<a.length;b++)if(c=a[b],"SCENE"==c.source)for(g=
0;g<Qa.length;g++)for(d=Qa[g],k=Qa[g].Le,e=0;e<k.length;e++)k[e].j==c&&ma.m(sb,d,f,null)}}function C(a){var c=a.rb.attributes,d=a.oa.ed,b;for(b in c)d[b]||Ha.l('missing data for "'+b+'" attribute');if("MAIN"==a.type||"NODES_GLOW"==a.type)if(c=oa.pP(a.rb.Fz),10<c&&("MAIN"==a.type&&fb.warn("Varying limit exceeded for main shader - "+c+', materials: "'+a.Df.join(", ")+'"'),"MAIN"==a.type&&a.eo||"NODES_GLOW"==a.type))b=d=0,a.mk&&(d=Ha.Yn(a.mk)),a.Hc&&(b=Ha.Yn(a.Hc)),fb.warn("Varying limit exceeded for node shader - "+
c+", uv: "+d+", vc: "+b+', materials: "'+a.Df.join(", ")+'"')}function L(a){8<a.fa.length&&fb.warn(a.type,"too many textures used - "+a.fa.length+' (max 8), materials "'+a.Df.join(", ")+'"')}function n(a,c,d){a.Cd=c.Cd;var b=c.Cd[0],e=c.Cd[1],f=c.Cd[2];d=d.R;d=Math.max(d.max_x-d.min_x,d.max_z-d.min_z);f=0==f?d:Math.max(f,d);c.Cd[2]=f;c=c.k;pa.Ds(c,f/2,-e,-b,f/2);pa.si(c);b=a.Pw||0;b=0==b?d:Math.max(b,d);a.Pw=b}function T(a,c,d,b,e,f){for(var h=c.g,g=ra.aa(c,e).X,k=0;k<g.length;k++){var n=g[k];if(("MAIN"==
n.type||"PARTICLES"==n.type||"LINE"==n.type)&&"REFLECT"==n.sb&&n.eb==b){if("MAIN_PLANE_REFLECT"==a.type||"MAIN_PLANE_REFLECT_BLEND"==a.type){var p;a:{var v=e.j.pg.og;for(p=0;p<v.length;p++)for(var m=0;m<v[p].length;m++)if(v[p][m]==a)break a;v=e.j.pg.ms;for(p=0;p<v.length;p++)for(m=0;m<v[p].length;m++)if(v[p][m]==a)break a;p=null}if(p==h.se)continue}else if(p=xa(e,a),p==h.Qe)continue;f||(u(n,a,c,d,"REFLECT",e),p=n.Tb,oa.V(p,"WATER_EFFECTS",0),oa.V(p,"REFLECTION_PASS",1),oa.V(p,"TEXTURE_NORM",0),"MAIN_PLANE_REFLECT"==
a.type&&oa.V(p,"INVERT_FRONTFACING",1),da.Uc(n),C(n));a.D.push(t(h,n))}}}function O(a){va(a);var c=X(a,"MAIN_OPAQUE"),d=!0,b=a.j.Rc;ma.ma(a.j.Pa,function(e,f){"SHADOW_CAST"===f.type&&(Y(f,a,c.k,f.D,b,d),d=!1)})}function V(a){ma.ma(a.j.Pa,function(a,c){"OUTLINE"===c.type&&(c.jw=1)})}function Y(a,c,d,b,e,f){if(0!=b.length){var h=a.k,g=Fa.Xh(d.i,Rb);Fa.ff(g,h.i);Fa.copy(d.jf,h.Ny);if("SUN"===e.Cf[a.Mf]||"HEMI"===e.Cf[a.Mf]){g=rb;P.bc(g);for(var k=0;k<b.length;k++){var n=b[k].mg;0==k?P.yq(n.I,g):P.Nn(g,
n.I)}b=P.On(g,Fb);Ha.Rl(b,h.nb,b);if(e.enable_csm){c=jb.copy(d.vn[a.Pv],Rb);e=Ka.invert(d.nb,mc);Ha.Rl(c,e,c);Ha.Rl(c,h.nb,c);a=d.Qv[a.Pv];if(f)for(nc=0,Mb=-Infinity,f=2;f<b.length;f+=3)nc=Math.min(nc,b[f]),Mb=Math.max(Mb,b[f]);f=rb;f.max_x=c[0]+a;f.max_y=c[1]+a;f.max_z=Mb;f.min_x=c[0]-a;f.min_y=c[1]-a;f.min_z=nc}else{d=f=rb;e=Oc;e.set(b);b=Xb/9;g=Ka.identity(mc);Ka.rotate(g,b,Ha.Oi,g);for(var n=k=-1,p=0;10>p;p++){var v=P.HL(e,Sb),m=(v.max_x-v.min_x)*(v.max_y-v.min_y);if(-1==k||m<k)k=m,n=p,P.yq(v,
d);Ha.Rl(e,g,e)}d=n*b;0<d&&(b=Ka.identity(mc),Ka.rotate(b,d,Ha.Oi,b),Ka.multiply(b,h.nb,h.nb),Fa.Xg(h.nb,h.jf));d=f.max_x-f.min_x;b=f.max_y-f.min_y;d&&b&&(e=Math.abs(d-b)/2,2<d/b?(f.max_y+=e,f.min_y-=e):2<b/d&&(f.max_x+=e,f.min_x-=e));f.max_x+=.005;f.max_y+=.005;f.max_z+=.005;f.min_x-=.005;f.min_y-=.005;f.min_z-=.005;la(a,c.j.Pa)}pa.fS(h,f.min_x,f.max_x,f.min_y,f.max_y,-f.max_z,-f.min_z);pa.si(h);Ha.Rq(h.Rf,h.cl)}else"SPOT"!==e.Cf[a.Mf]&&"POINT"!==e.Cf[a.Mf]||pa.si(h,h.ib)}}function la(a,c){for(var d=
a.k,b=na.iP(c,a),e=0;e<b.length;e++){var f=b[e];if("MAIN_OPAQUE"==f.type||"SHADOW_RECEIVE"==f.type||"MAIN_BLEND"==f.type||"MAIN_XRAY"==f.type)if(qa.Lr)f.zz.set(d.jf,9*a.Mf);else{var h=Fa.q(d.jf),g=Fa.B(d.jf);Sa.set(h[0],h[1],h[2],Fa.Pc(d.jf),Tc);f.qt.set(Tc,4*a.Mf);f.pt.set(g,4*a.Mf)}}}function W(a,c,d,b,e){for(var f=c.g,h=ra.aa(c,b).X,g=0;g<h.length;g++){var k=h[g];"COLOR_ID"==k.type&&("COLOR_PICKING"==a.type&&"COLOR_ID"==k.sb||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==k.sb)&&(e||(u(k,a,c,d,
"COLOR_ID",b),da.Od(k,"USE_OUTLINE",0),da.Uc(k),C(k)),a.D.push(t(f,k)))}}function ba(a,c,d,b,e){b||(e.Jc&&(b=na.Ob(d,"GRASS_MAP"))&&n(e,b,c),da.Uc(e),C(e));a.D.push(t(c,e));K(d,a,e);L(e)}function aa(a,c){fa(a,c);for(var d=0;d<a.zd.length;d++)a.zd[d].parent==a&&aa(a.zd[d],c)}function fa(a,c){a.g.zj=c;if(ra.nl(a))for(var d=0;d<a.A.length;d++)for(var b=a.A[d],e=S(b.Ta,xb),f=0;f<e.length;f++)ia(a,b,e[f])}function ea(a,c){for(var d=S(c,xb),b=a.$b,e=a.g,f=ra.aa(a,c),h=f.Ij,g=Fa.q(e.i),e=Fa.B(e.i),k=0;k<
d.length;k++){var n=d[k];n.Ir.set(g,3*h);n.mx.set(b.direction,3*h);n.Hr.set(b.on,3*h);switch(b.type){case "SUN":n.FH.set(e);n.EH=b.on;"SKY"===n.type?(n.Rr=b.BF,jb.copy(b.direction,n.dz),ga(c,n)):jb.copy(b.direction,n.dz);break;case "HEMI":case "POINT":case "SPOT":break;default:fb.error("Unknown light type: "+b.type+'".')}ia(a,f,n);for(var p=0;p<n.D.length;p++){var v=n.D[p].G;v.ul&&da.iS(v,a)}}d=X(c,"MAIN_OPAQUE").k;f=f.Oy;b=c.j.Rc;for(k=0;k<f.length;k++)n=f[k],pa.My(n.k,g,e),Y(n,c,d,n.D,b,!0),la(n,
c.j.Pa)}function ia(a,c,d){var b=a.g;a=a.$b;c=c.Ij;var e=Ic;e[0]=a.vm&&!b.zj?1:0;e[1]=a.lk&&!b.zj?1:0;d.nx.set(e,2*c);d.ra=!0}function va(a){var c=Ga.Gb(a,"LAMP",Ga.oc),c=ra.fr(c,qa.Rd&&a.b4w_enable_ssao);if(c.length)for(var d=0;d<c.length;d++)for(var b=c[d],e=b.g,f=Fa.Xh(e.i,Rb),e=Fa.Lw(e.i,Dc),h=0;h<b.A.length;h++){var g=b.A[h],k=g.Oy;if(g.Ta==a)for(g=0;g<k.length;g++)pa.My(k[g].k,f,e)}}function ga(a,c){Ea.os(c);Eb.Vk(c);if(c.Rr)for(var d=S(a,Oa),b=0;b<d.length;b++)for(var e=d[b].D,f=0;f<e.length;f++){var h=
e[f];h.ec&&(h=h.G,da.hM(h)&&Eb.ET(h))}}function E(a){for(var c=[],d=0;d<a.length;d++)for(var b=a[d].data,e=0;e<b.materials.length;e++){var f=b.materials[e];-1==c.indexOf(f)&&c.push(f)}return c}function ka(a,c,d){for(var b=a.j,e=ra.aa(a.Hh,a).U,f=0;f<e.length;f++){var h=e[f];pa.si(h,c/d);b.Rc&&pa.vz(h,b.Rc)}b.Rc&&(b.Sr=!0,X(a,"SHADOW_RECEIVE").ra=!0,X(a,"MAIN_BLEND").ra=!0);var g=b.Pa;na.wT(g,function(b,e,f){if(b.dp){var h=b.ek*c,k=b.fk*d;if(e)for(e=0;e<f.Ga.length;e++)f.Ga[e]==b&&Za.resize(b.Ja,h,
k);else switch(Za.sl(b.Ja)&&Za.resize(b.Ja,h,k),b=f.k,b.width=h,b.height=k,f.type){case "DOF":Ca(a,{dof_power:f.k.dof_power,dof_on:f.k.dof_on});break;case "GLOW_COMBINE":ja(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case "BLOOM":ha(a,{bloom_blur:f.bloom_blur});break;case "OUTLINE":f=na.tb(g,f,"POSTPROCESSING");h=na.tb(g,f,"POSTPROCESSING");k=na.tb(g,h,"POSTPROCESSING");b=na.tb(g,k,"POSTPROCESSING");na.we(f,1/c,1/d);na.we(h,1/c,1/d);na.we(k,
1/c,1/d);na.we(b,1/c,1/d);break;default:na.we(f,1/c,1/d)}}})}function S(a,c){for(var d=[],b=0;b<c.length;b++){var e=c[b];ma.ma(a.j.Pa,function(a,c){c.type==e&&d.push(c)})}return d}function X(a,c){return na.Ob(a.j.Pa,c)}function Ca(a,c){var d=X(a,"DOF");if(!d)return fb.error("DOF is not enabled on the scene. Check camera settings"),0;var b=a.j.Pa;"boolean"==typeof c.dof_on&&(d.k.dof_on=c.dof_on);"number"==typeof c.dof_distance&&(d.k.dof_distance=c.dof_distance);"number"==typeof c.dof_front&&(d.k.dof_front=
c.dof_front);"number"==typeof c.dof_rear&&(d.k.dof_rear=c.dof_rear);if("number"==typeof c.dof_power){d.k.dof_power=c.dof_power;var e=na.tb(b,d,"POSTPROCESSING"),b=na.tb(b,e,"POSTPROCESSING");na.jd(e,d.k.dof_power);na.we(e,1/d.k.width,1/d.k.height);na.jd(b,d.k.dof_power);na.we(b,1/d.k.width,1/d.k.height)}}function ha(a,c){var d=X(a,"LUMINANCE_TRUNCED"),b=X(a,"BLOOM");if(!d||!b)return fb.error("Bloom is not enabled on the scene"),0;"number"==typeof c.bloom_key&&(d.bloom_key=c.bloom_key,d.ra=!0);"number"==
typeof c.bloom_edge_lum&&(d.bloom_edge_lum=c.bloom_edge_lum,d.ra=!0);if("number"==typeof c.bloom_blur){var e=a.j.Pa,d=na.tb(e,b,"BLOOM_BLUR"),e=na.tb(e,d,"BLOOM_BLUR");b.bloom_blur=c.bloom_blur;na.jd(d,c.bloom_blur);na.we(d,1/b.k.width,1/b.k.height);na.jd(e,c.bloom_blur);na.we(e,1/b.k.width,1/b.k.height)}}function ja(a,c){var d=X(a,"GLOW_COMBINE");if(!d)return fb.error("Glow is not enabled on the scene"),null;for(var b=a.j.Pa,e=na.gP(b,d),f=0;f<e.length;++f){var h=e[f];if("POSTPROCESSING"===h.type&&
"GLOW_MASK_LARGE"===h.sb)var g=h;if("POSTPROCESSING"===h.type&&"GLOW_MASK_SMALL"===h.sb)var k=h}e=na.tb(b,g,"POSTPROCESSING");b=na.tb(b,k,"POSTPROCESSING");"number"==typeof c.small_glow_mask_coeff&&(d.small_glow_mask_coeff=c.small_glow_mask_coeff,d.ra=!0);"number"==typeof c.large_glow_mask_coeff&&(d.large_glow_mask_coeff=c.large_glow_mask_coeff,d.ra=!0);"number"==typeof c.small_glow_mask_width&&(d.small_glow_mask_width=c.small_glow_mask_width,na.jd(k,c.small_glow_mask_width),na.we(k,1/d.k.width,1/
d.k.height),k.ra=!0,na.jd(b,c.small_glow_mask_width),na.we(b,1/d.k.width,1/d.k.height),b.ra=!0);"number"==typeof c.large_glow_mask_width&&(d.large_glow_mask_width=c.large_glow_mask_width,na.jd(g,c.large_glow_mask_width),na.we(g,1/d.k.width,1/d.k.height),g.ra=!0,na.jd(e,c.large_glow_mask_width),na.we(e,1/d.k.width,1/d.k.height),e.ra=!0)}function Z(a,c,d){var b=a.j,e=b.nc;if(!e.Gn)return e.Ki;var f=e.waves_height,h=e.waves_length,g=e.Ki,k=jb.length(b.Ch);a=X(a,"MAIN_OPAQUE").time;k&&(a*=k);var n=Ic;
n[0]=20/h*(c-.25*a);n[1]=20/h*(d-.25*a);k=Ha.FB(n);n[0]=17/h*(d+.1*a);n[1]=17/h*(c+.1*a);var n=Ha.FB(n),k=k+n-1,p=e.dst_noise_scale0,n=e.dst_noise_scale1,v=e.dst_noise_freq0,m=e.dst_noise_freq1,q=Ic;q[0]=p*(c+v*a);q[1]=p*(d+v*a);p=Ha.Uy(q);q[0]=n*(d-m*a);q[1]=n*(c-m*a);n=Ha.Uy(q);n*=f*p;if(e.wi)if(m=(c-e.Zl[0])/e.$l[0],q=(e.Zl[1]+d)/e.$l[1],m+=.5,q+=.5,1<m||0>m||1<q||0>q)e=n;else{var b=Ha.nD(b.Py,e.Qy,m,q),q=e.dir_freq,l=e.dir_noise_scale,t=e.dir_noise_freq,p=e.dir_min_noise_fac,m=e.dst_min_fac,v=
h/e.ux/Math.PI;d=[l/h*(c+t*a),l/h*(d+t*a)];c=Math.sqrt(b);e=f*Math.max(b,e.dir_min_shore_fac)*Math.sin(c/v+q*a)*Math.max(Ha.Uy(d),p);f=Math.max(c,m);e=e*(1-f)+n*f;k*=b}else e=n;return g+(e+.05*k)}function Q(a,c){a.lo&&"POSTPROCESSING"==a.type&&c.ec!=a.ec&&(a.ec=c.ec);c.ec||"OUTLINE"!=a.type||(a.jw=0)}function Ba(a,c,d,b){var e=ma.Ra(a,c);pa.As(e.k,d,b);e.Yu=!0;ma.Ci(a,c,function(c,e,f){f.Ub&&f.from==d&&na.xM(f)&&ta(a,c,f.to,b)});ma.xg(a,c,function(c,e,f){f.Ub&&f.from==d&&f.from==f.to&&Ba(a,c,d,b)})}
function ta(a,c,d,b){a=ma.Ra(a,c).D;for(c=0;c<a.length;c++)da.GR(a[c].G,b,d)}function ua(a){var c=X(a,"GRASS_MAP");if(c){var d=c.k,b=a.Hh.g;a=Fa.q(b.i);var e=Rb;e[0]=0;e[1]=-c.Cd[2]/2;e[2]=0;c=Fa.B(b.i);jb.transformQuat(e,c,e);e[0]+=a[0];e[1]=0;e[2]+=a[2];c=Dc;c[0]=0;c[1]=0;c[2]=0;c[3]=1;pa.My(d,e,c)}}function sa(a,c){ma.ma(a,function(d,b){if("MOTION_BLUR"==b.type){b.Ga[0]&&b.vg[0]||Ha.l("Wrong MOTION_BLUR subscene");var e=b.Ga[0],f=b.vg[0];b.vg[0]=b.k.Wb;ma.Ci(a,d,function(c,d,b){b.Ub&&ta(a,c,b.to,
f)});Ba(a,d,e.from,f);ta(a,d,e.to,b.vg[0]);b.sF=Math.exp(-c/b.mb_factor)}})}function U(a){return a.j.Ch}function xa(a,c){if(!a.j.pg)return null;for(var d=a.j.pg.Ng,b=0;b<d.length;b++)if(d[b]==c)return b;d=a.j.pg.Sv;for(b=0;b<d.length;b++)if(d[b]==c)return b;return null}var da=l("__batch"),P=l("__boundings"),pa=l("__camera"),ca=l("__config"),za=l("__container"),Aa=l("__debug");l("__geometry");var ma=l("__graph"),Ja=l("__hud");l("__lights");var Da=l("__input"),Ka=l("__mat4"),Ma=l("__nodemat"),Ga=l("__objects"),
ra=l("__obj_util"),ib=l("__physics"),Ea=l("__prerender"),wa=l("__primitives"),fb=l("__print"),Eb=l("__renderer"),na=l("__scenegraph"),cc=l("__sfx"),oa=l("__shaders"),Za=l("__textures"),Fa=l("__tsr"),Ha=l("__util"),jb=l("__vec3"),Sa=l("__vec4"),qa=ca.v,tb=ca.ic,eb=ca.Vl,uc="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND COLOR_PICKING COLOR_PICKING_XRAY SHADOW_RECEIVE OUTLINE_MASK DEBUG_VIEW".split(" ");
a.iW=uc;var xb="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND LUMINANCE_TRUNCED SHADOW_RECEIVE SHADOW_CAST COLOR_PICKING COLOR_PICKING_XRAY OUTLINE_MASK".split(" "),Oa="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND".split(" "),Qb="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND COLOR_PICKING COLOR_PICKING_XRAY SHADOW_RECEIVE GOD_RAYS OUTLINE_MASK DEBUG_VIEW".split(" "),
Yb="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND".split(" "),tc=null,Pb=null,Qa=[],sb=null,Xb=Math.PI/2,Ic=new Float32Array(2),Rb=new Float32Array(3),Dc=new Float32Array(4),Tc=new Float32Array(4),mc=new Float32Array(16),Fb=new Float32Array(24),Oc=new Float32Array(24),rb=P.bc(),Sb=P.bc(),nc=0,Mb=-Infinity;a.FX=function(){return{}};a.zs=function(a){Pb=a;cc.SR(a)};a.nR=function(a,c){var d=a.j,b=na.iN(d.Pa);if(a==c){ka(a,
za.dE(),za.cE());for(var e=0;e<b.length;e++)a.j.ak.push(b[e])}else for(e=a.Le[0],ka(a,e.j.hk,e.j.hk),e=0;e<b.length;e++)c.j.ak.push(b[e]);b=S(a,Qb);for(e=0;e<b.length;e++)b[e].Ch.set(d.Ch);for(e=0;e<d.ak.length;e++)"SHADOW_CAST"==d.ak[e].type&&Eb.Vk(d.ak[e])};a.xj=function(){tc||(tc=m(Qa));return tc};a.Uq=m;a.o=b;a.za=function(){return Pb?!0:!1};a.fl=function(a){return a.Hh};a.Xn=function(){return Qa};a.PD=function(){if(1==Qa.length)return Qa;for(var a=0;a<Qa.length;a++){var c=Qa[a].j.Pa;ma.ma(c,
function(c,d){for(var b=0;b<d.D.length;b++){for(var e=d.D[b].G.fa,f=null,h=0;h<e.length;h++)if("SCENE"==e[h].source&&e[h].Vy==Qa[a].name&&"COPY"!=d.type){fb.error('Texture-scene loop detected. A scene is rendered to texture "'+e[h].name+'" yet this texture belongs to the same scene.');ma.Gf(sb,Qa[a]);f=d.D[b].G;break}f&&(f.fa=[],f.Sc=[],da.DT(f,null),da.Uc(f))}})}for(var d=[],a=0;a<Qa.length;a++)if(c=Qa[a],!c.Le.length){c=ma.Gf(sb,c);ma.aO(sb,c);c=ma.Ys(sb,c,ma.tp);c=ma.pz(c);ma.ma(c,function(a,c){d.push(c)});
break}return d};a.YK=function(a,b,n,m,l){a.Le=a.Le||[];a.ga=null;var t=a.j,u=ra.aa(a.Hh,a),y=a.Hh.g;t.Am=[];var C=a.world;t.aQ=n.length;t.wh=k(n);t.Ts=g(C,t.wh);t.Mz=H(C,t.Ts);t.OI=I(C);if(C=!a.Le.length)a:{if("HMD"==qa.stereo){if(u.U[0].type!=pa.Vc){fb.warn("Head-mounted display stereo is disabled for the non-perspective camera");qa.stereo="NONE";C=!1;break a}if(!Da.rv(Da.td)){fb.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");qa.stereo="NONE";C=!1;break a}}C=
"HMD"==qa.stereo}t.fo=C;if(C=!a.Le.length)u.U[0].type!=pa.Vc&&"ANAGLYPH"==qa.stereo?(fb.warn("Anaglyph stereo is disabled for the non-perspective camera"),qa.stereo="NONE",C=!1):C="ANAGLYPH"==qa.stereo;t.anaglyph_use=C;t.QK=!t.fo&&!t.anaglyph_use&&R(a,l);t.pg=q(a,b,m);t.ML=A(a);t.IQ=J(a);t.fM=N(a);t.sP=F(a);t.WQ=G(a);t.Zh=D(a);t.Tk=qa.Tk&&(0<y.dof_distance||y.je);t.Mj=qa.Mj&&a.b4w_enable_motion_blur;t.Kk=qa.Kk&&a.b4w_enable_color_correction;t.antialiasing=qa.antialiasing&&1==qa.uc&&"NONE"!=a.b4w_antialiasing_quality;
t.Rd=qa.Rd&&a.b4w_enable_ssao;t.kl=qa.kl&&a.b4w_enable_god_rays&&t.wh;t.JN=qa.Lq;t.ir=a.b4w_glow_settings.render_glow_over_blend;t.$S=z(a);l=f(m);t.lF=l;t.gd=c(a,l);t.Rc=e(a,n,m);t.nc=w(m);t.Eh=p(m);t.PS=r(m);t.vi=B(m);t.Jc=d(a,m);t.HM=!t.fo&&!t.anaglyph_use&&h(a,m);t.outline=v(a,m);t.Yg=M(a,m);switch(a.b4w_reflection_quality){case "LOW":t.Og=eb.uC;t.Yj=eb.YF;break;case "MEDIUM":t.Og=eb.AN;t.Yj=eb.hR;break;case "HIGH":t.Og=eb.zN;t.Yj=eb.gR;break;default:t.Og=eb.uC,t.Yj=eb.YF}if(za.RP())fb.log("%cENABLE HIDPI MODE",
"color: #00a"),t.WA="AA_QUALITY_LOW",t.Nd=1,qa.uc=1;else if(1<qa.uc)fb.log("%cENABLE MSAA RENDERING: "+qa.uc+"x","color: #00a"),t.Nd=1;else{t.WA="AA_QUALITY_"+a.b4w_antialiasing_quality;switch(a.b4w_antialiasing_quality){case "LOW":t.antialiasing&&(t.Nd=1);break;case "MEDIUM":qa.quality==ca.Ri||qa.quality==ca.Qi?t.Nd=1:qa.quality==ca.vk&&(t.Nd=1.33);break;case "HIGH":qa.quality==ca.Ri?t.Nd=1:qa.quality==ca.Qi?t.Nd=1.33:qa.quality==ca.vk&&(t.Nd=2);break;case "NONE":qa.quality==ca.Ri||qa.quality==ca.Qi?
t.Nd=1:qa.quality==ca.vk&&(t.Nd=2)}qa.quality==ca.Eu&&(t.Nd=1)}n=a.Le.sort(function(a,c){return c.j.hk-a.j.hk});t.Pa=na.hN(t,u,y,n);t.ak=[];t.Sr=!1;t.Bx=!1;t.Cx=!1;t.Ch=new Float32Array(3);Qa.push(a);sb||(sb=ma.create());ma.C(sb,a);for(t=0;t<b.length;t++)ra.qy(b[t],!0,a);a=za.le();za.resize(a.clientWidth,a.clientHeight,!0)};a.ZK=function(a,c,d){for(var b=0;b<c.length;b++)c[b].j&&c[b].j.oo&&(c[b].j.Bh=d,a.j.Am.push(c[b]))};a.Jw=function(a){return a.j.Pa};a.gD=function(a){ma.ma(a,function(c,d){var b=
null;switch(d.type){case "POSTPROCESSING":b=da.Nv(d.ns);break;case "SSAO":b=da.pN(d);break;case "SSAO_BLUR":b=da.qN(d);break;case "DEPTH_PACK":b=da.UM();break;case "GOD_RAYS":na.tb(a,d,"RESOLVE")||na.tb(a,d,"DEBUG_VIEW")||na.tb(a,d,"MAIN_BLEND")||na.tb(a,d,"GOD_RAYS");b=da.YM(d.TF,d.pk,d.lm);break;case "GOD_RAYS_COMBINE":na.tb(a,d,"RESOLVE")||na.tb(a,d,"DEBUG_VIEW")||na.tb(a,d,"MAIN_BLEND");na.tb(a,d,"GOD_RAYS");b=da.ZM();break;case "MOTION_BLUR":b=da.cN();break;case "DOF":var b=da.VM(),e=na.tb(a,
d,"POSTPROCESSING"),f=na.tb(a,e,"POSTPROCESSING");na.jd(e,d.k.dof_power);na.jd(f,d.k.dof_power);break;case "OUTLINE":var b=da.dN(),e=na.tb(a,d,"POSTPROCESSING"),f=na.tb(a,e,"POSTPROCESSING"),h=na.tb(a,f,"POSTPROCESSING"),g=na.tb(a,h,"POSTPROCESSING");na.jd(f,d.fv);na.jd(e,d.fv);na.jd(g,d.ow*d.yo);na.jd(h,d.ow*d.yo);break;case "GLOW_COMBINE":b=da.XM();break;case "COMPOSITING":b=da.SM();break;case "ANTIALIASING":b=da.NM(d);break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":b=
da.nN(d.type);break;case "STEREO":b=da.rN(d.sb);break;case "SKY":b=da.gN();break;case "LUMINANCE":b=da.$M();break;case "AVERAGE_LUMINANCE":b=da.OM();break;case "LUMINANCE_TRUNCED":b=da.aN();break;case "BLOOM_BLUR":b=da.PM();break;case "BLOOM":b=na.tb(a,d,"BLOOM_BLUR");e=na.tb(a,b,"BLOOM_BLUR");na.jd(b,d.bloom_blur);na.jd(e,d.bloom_blur);b=da.QM();break;case "VELOCITY":b=da.vN();break;case "ANCHOR_VISIBILITY":b=da.MM();break;case "PERFORMANCE":b=da.eN()}b&&(e=t(ra.Pk("NONE"),b),C(b),d.D.push(e),K(a,
d,b),L(b))})};a.Dk=function(a,c,d){switch(c.type){case "MESH":case "LINE":case "WORLD":var b=a.j.Pa,e=c.g;!na.Ob(b,"SHADOW_CAST")&&e.Qd&&(e.Qd=!1);e=S(a,uc);d&&c.kk&&ib.Dk(c,a);for(var f=0;f<e.length;f++){var h=e[f],g=c,k=b,p=a,v=d;switch(h.type){case "MAIN_OPAQUE":y(h,g,k,"OPAQUE",p,v);break;case "MAIN_BLEND":y(h,g,k,"BLEND",p,v);break;case "MAIN_XRAY":y(h,g,k,"XRAY",p,v);break;case "MAIN_GLOW":y(h,g,k,"GLOW",p,v);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":T(h,g,k,!1,p,v);break;case "MAIN_PLANE_REFLECT_BLEND":case "MAIN_CUBE_REFLECT_BLEND":T(h,
g,k,!0,p,v);break;case "SHADOW_RECEIVE":for(var m=ra.aa(g,p).X,q=0;q<m.length;q++){var l=m[q];"SHADOW"==l.type&&"RECEIVE"==l.sb&&(v||(u(l,h,g,k,"SHADOW",p),da.Uc(l),C(l)),h.D.push(t(g.g,l)),K(k,h,l),L(l))}break;case "SHADOW_CAST":for(var m=!1,q=g.g,g=ra.aa(g,p).X,l=na.Ob(k,"GRASS_MAP"),r=0;r<g.length;r++){var z=g[r];if("SHADOW"==z.type&&"CAST"==z.sb){m=!0;if(!v){var w=h.Vr;da.Od(z,"NUM_LIGHTS",w);da.Od(z,"NUM_LFACTORS",0==w%2?w/2:Math.floor(w/2)+1);oa.V(z.Tb,"SHADOW_USAGE","SHADOW_CASTING");z.Jc&&
l&&n(z,l,q);da.Od(z,"SHADOW_TEX_RES",oa.H(p.j.Rc.csm_resolution));da.Uc(z);C(z)}h.D.push(t(q,z))}}m&&(g=p.j.Rc,v=na.Ob(k,"MAIN_OPAQUE"),Y(h,p,v.k,h.D,g,!0));break;case "COLOR_PICKING":W(h,g,k,p,v);break;case "COLOR_PICKING_XRAY":W(h,g,k,p,v);break;case "OUTLINE_MASK":m=g.g;q=ra.aa(g,p).X;for(l=0;l<q.length;l++)r=q[l],"COLOR_ID"==r.type&&"OUTLINE"==r.sb&&(v||(u(r,h,g,k,"COLOR_ID",p),da.Od(r,"USE_OUTLINE",1),da.Uc(r),C(r)),h.D.push(t(m,r)));break;case "GRASS_MAP":k=g.g;g=ra.aa(g,p).X;for(p=0;p<g.length;p++)m=
g[p],"GRASS_MAP"==m.type&&(v||(da.Uc(m),C(m)),h.D.push(t(k,m)),m=h.k,z=k.I,q=h.Cd[0],l=h.Cd[1],r=h.Cd[2],0==q&&0==l?(q=z.min_y,l=z.max_y):(q=Math.min(q,z.min_y),l=Math.max(l,z.max_y)),z=1E-4*(l-q),q-=z,l+=z,h.Cd[0]=q,h.Cd[1]=l,pa.Ds(m,r/2,-l,-q,r/2),pa.si(m));break;case "DEBUG_VIEW":for(m=g.g,g=ra.aa(g,p).X,p=0;p<g.length;p++)q=g[p],"DEBUG_VIEW"==q.type&&ba(h,m,k,v,q)}}break;case "LAMP":ea(c,a),Ga.SS(a)}ra.qy(c,!0,a)};a.ry=function(a){a.j.Sr=!0};a.$T=function(a,c){ma.ma(c,function(c,d){"SHADOW_CAST"===
d.type&&(Fa.ff(Fa.q(a.i),d.k.i),Fa.copy(a.jf,d.k.Ny))})};a.J2=la;a.WO=function(a,c){for(var d=a.j.Rc,b=new Float32Array(d.csm_num),e=0;e<d.csm_num;e++)b[e]=pa.yN(d,c,e);return b};a.tW=ba;a.HB=aa;a.dn=fa;a.dx=function(a){return a.g.zj};a.yR=function(a){for(var c=0;c<a.A.length;c++)for(var d=S(a.A[c].Ta,uc),c=0;c<d.length;c++)for(var b=d[c].D,e=b.length-1;0<=e;e--){var f=b[e];f.mg==a.g&&(f.G&&da.UB(f.G),b.splice(e,1))}};a.OT=function(a,c){for(var d=a.$b,b=ra.aa(a,c).Ij,e=S(c,xb),f=0;f<e.length;f++){var h=
e[f];h.Hr.set(d.on,3*b);h.ra=!0}};a.jI=ea;a.ha=function(){for(var a=0;a<Qa.length;a++){var c=Qa[a];ma.ma(c.j.Pa,function(a,c){if("SINK"!=c.type){var d=c.k;Eb.AR(d.Ve,d.Wb,d.he,d.width,d.height);for(var d=c.D,b=0;b<d.length;b++){var e=d[b].G;e&&da.UB(e)}}});c.j.Pa=[];c.j.ak=[]}Pb=tc=null;Qa.length=0;sb=null};a.jF=function(a,c,d){a=pa.gO(a,a.near,a.far,null,!0);var b=wa.GO(a);a=ra.Pk("DYNAMIC");a.I=a.R={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Yc=a.Pe=P.JL();var e=a.Yc.mb;
a.na=a.Ha=P.rn([e,0,0],[0,e,0],[0,0,e],a.Yc.O);d=da.lN(b,d);c.D.push(t(a,d))};a.FZ=function(a){return[a.frame_start,a.frame_end]};a.hH=function(a,c,d){za.GS(a,c,d);Pb&&ka(Pb,a,c)};a.I1=ka;a.DH=S;a.qa=X;a.yD=function(a){a=X(a,"MAIN_OPAQUE");var c=a.ne,d=a.Je,b=[],e=[];b[0]=c[0];b[1]=c[1];b[2]=c[2];e[0]=d[0];e[1]=d[1];e[2]=d[2];return[a.Tg,b,e]};a.yy=function(a,c,d,b){a=S(a,xb);for(var e=0;e<a.length;e++){var f=a[e];f.ne.set(d);f.Je.set(b);f.Tg=c;f.ra=!0}};a.WD=function(a){if(a=X(a,"SKY")){var c={};
c.color=Array(3);jb.copy(a.am,c.color);c.procedural_skydome=a.procedural_skydome;c.use_as_environment_lighting=a.use_as_environment_lighting;c.rayleigh_brightness=a.rayleigh_brightness;c.mie_brightness=a.mie_brightness;c.spot_brightness=a.spot_brightness;c.scatter_strength=a.scatter_strength;c.rayleigh_strength=a.rayleigh_strength;c.mie_strength=a.mie_strength;c.rayleigh_collection_power=a.rayleigh_collection_power;c.mie_collection_power=a.mie_collection_power;c.mie_distribution=a.mie_distribution;
return c}return null};a.ZG=function(a,c){var d=X(a,"SKY");d&&("number"==typeof c.procedural_skydome&&(d.procedural_skydome=c.procedural_skydome),"number"==typeof c.use_as_environment_lighting&&(d.use_as_environment_lighting=c.use_as_environment_lighting),"object"==typeof c.color&&d.am.set(c.color),"number"==typeof c.rayleigh_brightness&&(d.rayleigh_brightness=c.rayleigh_brightness),"number"==typeof c.mie_brightness&&(d.mie_brightness=c.mie_brightness),"number"==typeof c.spot_brightness&&(d.spot_brightness=
c.spot_brightness),"number"==typeof c.scatter_strength&&(d.scatter_strength=c.scatter_strength),"number"==typeof c.rayleigh_strength&&(d.rayleigh_strength=c.rayleigh_strength),"number"==typeof c.mie_strength&&(d.mie_strength=c.mie_strength),"number"==typeof c.rayleigh_collection_power&&(d.rayleigh_collection_power=c.rayleigh_collection_power),"number"==typeof c.mie_collection_power&&(d.mie_collection_power=c.mie_collection_power),"number"==typeof c.mie_distribution&&(d.mie_distribution=c.mie_distribution),
d.ra=!0,d.Rr=!0,ga(a,d))};a.dZ=function(a){return S(a,Oa)[0].Te[0]};a.bZ=function(a){return S(a,Oa)[0].Te[1]};a.eZ=function(a){return S(a,Oa)[0].Te[2]};a.cZ=function(a){return S(a,Oa)[0].Te[3]};a.aS=function(a,c){for(var d=S(a,Oa),b=0;b<d.length;b++){var e=d[b];e.Te[0]=c;e.ra=!0}};a.ZR=function(a,c){for(var d=S(a,Oa),b=0;b<d.length;b++){var e=d[b];e.Te[1]=c;e.ra=!0}};a.bS=function(a,c){for(var d=S(a,Oa),b=0;b<d.length;b++){var e=d[b];e.Te[2]=c;e.ra=!0}};a.$R=function(a,c){for(var d=S(a,Oa),b=0;b<
d.length;b++){var e=d[b];e.Te[3]=c;e.ra=!0}};a.CD=function(a,c){var d=c||[],b=S(a,Oa)[0].od;d[0]=b[0];d[1]=b[1];d[2]=b[2];d[3]=b[3];return d};a.Cy=function(a,c){for(var d=S(a,Oa),b=0;b<d.length;b++){var e=d[b];e.od.set(c);e.ra=!0}};a.YD=function(a){var c=X(a,"SSAO");a=X(a,"SSAO_BLUR");if(!c)return null;var d=c.D[0].G,b={};b.ssao_quality=da.Ew(d,"SSAO_QUALITY")[1];b.ssao_hemisphere=c.ssao_hemisphere;b.ssao_blur_depth=a.ssao_blur_depth;b.xB=a.ssao_blur_discard_value;b.radius_increase=c.hm;b.influence=
c.gm;b.dist_factor=c.fm;b.ssao_only=c.ssao_only;b.ssao_white=da.Ew(d,"SSAO_WHITE")[1];return b};a.aH=function(a,c){var d=X(a,"SSAO"),b=X(a,"SSAO_BLUR");if(!d)return fb.error("SSAO is not enabled on the scene"),0;if("string"==typeof c.ssao_quality){var e=d.D[0].G;da.Od(e,"SSAO_QUALITY",c.ssao_quality);da.Uc(e,!0)}"number"==typeof c.ssao_hemisphere&&(e=d.D[0].G,da.Od(e,"SSAO_HEMISPHERE",c.ssao_hemisphere),da.Uc(e,!0));"number"==typeof c.ssao_blur_depth&&(e=b.D[0].G,da.Od(e,"SSAO_BLUR_DEPTH",c.ssao_blur_depth),
da.Uc(e,!0));"number"==typeof c.ssao_blur_discard_value&&(b.ssao_blur_discard_value=c.ssao_blur_discard_value);"number"==typeof c.hm&&(d.hm=c.hm);"number"==typeof c.gm&&(d.gm=c.gm);"number"==typeof c.fm&&(d.fm=c.fm);if("number"==typeof c.ssao_only){d=X(a,"MAIN_OPAQUE");d.ssao_only=c.ssao_only;for(var f=0;f<d.D.length;f++)e=d.D[f].G,da.Od(e,"SSAO_ONLY",c.ssao_only),da.Uc(e,!0)}"number"==typeof c.ssao_white&&(e=d.D[0].G,da.Od(e,"SSAO_WHITE",c.ssao_white),da.Uc(e,!0));d.ra=!0;b.ra=!0};a.wD=function(a){a=
X(a,"DOF");if(!a)return null;var c={};c.dof_distance=a.k.dof_distance;c.dof_front=a.k.dof_front;c.dof_rear=a.k.dof_rear;c.dof_power=a.k.dof_power;c.je=a.k.je;return c};a.PG=Ca;a.FD=function(a){var c=S(a,["GOD_RAYS"]);a=X(a,"GOD_RAYS_COMBINE");if(!c||!a)return null;var d={};d.god_rays_max_ray_length=c[0].yl;d.god_rays_intensity=a.god_rays_intensity;d.god_rays_steps=da.Ew(c[0].D[0].G,"STEPS_PER_PASS")[1];return d};a.RG=function(a,c){var d=S(a,["GOD_RAYS"]),b=X(a,"GOD_RAYS_COMBINE");if(!d||!b)return fb.error("God Rays are not enabled on the scene"),
0;"number"==typeof c.god_rays_intensity&&(b.god_rays_intensity=c.god_rays_intensity);if("number"==typeof c.god_rays_max_ray_length)for(var e=c.god_rays_max_ray_length,f=0;f<d.length;f++)d[f].yl=e,d[f].rs=e/d[f].lm/(f+1),d[f].ra=!0;if("number"==typeof c.god_rays_steps)for(var h=oa.H(c.god_rays_steps,1),e=d[0].yl,f=0;f<d.length;f++){d[f].lm=h;d[f].rs=e/h/(f+1);d[f].ra=!0;var g=d[f].D[0].G;da.Od(g,"STEPS_PER_PASS",h);da.Uc(g,!0)}b.ra=!0};a.pD=function(a){var c=X(a,"LUMINANCE_TRUNCED");a=X(a,"BLOOM");
if(!c||!a)return null;var d={};d.bloom_key=c.bloom_key;d.bloom_edge_lum=c.bloom_edge_lum;d.bloom_blur=a.bloom_blur;return d};a.HG=ha;a.ED=function(a){a=X(a,"GLOW_COMBINE");if(!a)return null;var c={};c.small_glow_mask_coeff=a.small_glow_mask_coeff;c.large_glow_mask_coeff=a.large_glow_mask_coeff;c.small_glow_mask_width=a.small_glow_mask_width;c.large_glow_mask_width=a.large_glow_mask_width;return c};a.QG=ja;a.iE=function(a){var c=U(a);a=jb.length(c);if(0==a)return null;var c=Ha.Ld(Math.atan2(c[0],c[2])),
d={};d.wind_dir=c;d.wind_strength=a;return d};a.PR=function(a){a.j.Bx=!0};a.fE=Z;a.eE=function(a,c){var d=a.j.nc,b=X(a,"MAIN_OPAQUE");b&&d&&(c.waves_height=d.waves_height,c.waves_length=d.waves_length,b.Sf&&(c.water_fog_density=b.Sf[3],d=c.water_fog_color=[],d[0]=b.Sf[0],d[1]=b.Sf[1],d[2]=b.Sf[2]))};a.fH=function(a,c){var d=a.j.nc;if(!d)return fb.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof c.dst_noise_scale0&&(d.dst_noise_scale0=c.dst_noise_scale0);"number"==
typeof c.dst_noise_scale1&&(d.dst_noise_scale1=c.dst_noise_scale1);"number"==typeof c.dst_noise_freq0&&(d.dst_noise_freq0=c.dst_noise_freq0);"number"==typeof c.dst_noise_freq1&&(d.dst_noise_freq1=c.dst_noise_freq1);"number"==typeof c.dir_min_shore_fac&&(d.dir_min_shore_fac=c.dir_min_shore_fac);"number"==typeof c.dir_freq&&(d.dir_freq=c.dir_freq);"number"==typeof c.dir_noise_scale&&(d.dir_noise_scale=c.dir_noise_scale);"number"==typeof c.dir_noise_freq&&(d.dir_noise_freq=c.dir_noise_freq);"number"==
typeof c.dir_min_noise_fac&&(d.dir_min_noise_fac=c.dir_min_noise_fac);"number"==typeof c.dst_min_fac&&(d.dst_min_fac=c.dst_min_fac);"number"==typeof c.waves_hor_fac&&(d.waves_hor_fac=c.waves_hor_fac);"number"==typeof c.water_dynamic&&(d.Gn=c.water_dynamic);for(var b=S(a,Yb),e=0;e<b.length;e++){var f=b[e];"number"==typeof c.water_fog_density&&d.od&&(f.Sf[3]=c.water_fog_density);"object"==typeof c.water_fog_color&&d.od&&f.Sf.set(c.water_fog_color);"number"==typeof c.waves_height&&(f.Hz=c.waves_height);
"number"==typeof c.waves_length&&(f.Iz=c.waves_length);f.ra=!0}};a.VD=function(a,c,d){var b=a.j.nc;if(!b.wi)return 100;var e=b.ux;a=b.Ki;var f=(c[0]-b.Zl[0])/b.$l[0],h=(b.Zl[1]+c[2])/b.$l[1],f=f+.5,h=h+.5;if(1<f||0>f||1<h||0>h)c=1;else return b=e*Ha.nD(Pb.j.Py,b.Qy,f,h),c=(a-c[1])*d,c=Math.sqrt(b*b+c*c)};a.update=function(a,c){for(var d=b().Hh.g,e=0;e<Qa.length;e++){var f=Qa[e],h=f.j.Pa,g=f.j;if(g.nc)var k=Fa.q(d.i),n=k[1]-Z(f,k[0],k[2]);for(k=0;k<g.Am.length;k++){var p=g.Am[k].j,v=p.Ba,m=p.Qc;if(!(f.b4w_use_nla&&
p.nt||!v&&!m)&&Za.DI(p)){var q=Za.AI(p),l=Za.CI(p);v&&qa.Af&&(l-=5);var t=Za.BU(p);q>=t&&p.jk||q<l?(Za.xG(p.name,p.Bh),m&&(p.Wl=Za.ys(p,a))):q>=t&&!p.jk?Za.Qx(p.name,p.Bh):Za.EI(p)&&(v?Za.oI(p):(v=Za.ys(p,a),v!=p.Wl&&(Za.nI(p),p.dk++),p.Wl=v))}}ma.ma(h,function(c,d){-1<Qb.indexOf(d.type)&&(d.time=a);g.nc&&(d.pv=n)})}for(e=0;e<Qa.length;e++)if(f=Qa[e],g=f.j,h=g.Pa,d=g.ak,d.length)for(g.Sr&&(O(f),g.Sr=!1),g.Bx&&(ua(f),g.Bx=!1),g.Cx&&(V(f),g.Cx=!1),g.Mj&&sa(h,c),f=na.Ob(h,"OUTLINE_MASK"),k=0;k<d.length;k++)h=
d[k],Ea.os(h),f&&Q(h,f),Eb.Vk(h);qa.show_hud_debug_info&&Ja.LS(Qa,c)};a.HR=function(a){a.j.Cx=!0};a.Bw=function(a){var c=[];ma.ma(a.j.Pa,function(a,d){c.push(d)});return c};a.rD=function(){var a=X(Pb,"MAIN_BLEND"),c=Pb;return a||c.j.nc?a.pv:null};a.mI=function(a){ma.ma(a.j.Pa,function(a,c){c.ra=!0})};a.VR=function(a,c){a.debug_view_mode=c;a.ec=c!=Aa.zp;a.eb=c==Aa.Ap;a.ra=!0;for(var d=b(),e=0;e<Yb.length;e++){var f=X(d,Yb[e]);f&&(f.hw=c==Aa.Fm)}};a.UR=function(a,c){a.debug_colors_seed=c;a.ra=!0};a.qS=
function(a,c){a.zC=c;a.ra=!0};a.BS=function(a,c){for(var d=0;d<a.D.length;d++)a.D[d].G.wireframe_edge_color=c,a.ra=!0};a.hI=function(a,c){var d=c.Yk,b=a.j.Ch;if(d&&"WIND"==d.type&&b){Ha.Cb(Fa.B(c.g.i),Ha.wc,b);jb.normalize(b,b);jb.scale(b,d.BH,b);for(var d=S(a,Qb),e=0;e<d.length;e++)d[e].Ch.set(b);return!0}return!1};a.bR=function(a,c,d){var b=X(a,"COLOR_PICKING");if(b)return c=za.an(c,d,Ic,b.k),Ea.os(b),Eb.Vk(b),(a=X(a,"COLOR_PICKING_XRAY"))?(Ea.os(a),Eb.Vk(a),b=a.k):b=b.k,c[1]=b.height-c[1],Eb.by(b.Ve,
c[0],c[1]);fb.error("Object Selection is not available on the scene");return null};a.VG=function(a){var c=b();if(c=X(c,"OUTLINE"))c.kh.set(a),c.ra=!0};a.$Z=U;a.yj=function(a){var c={title:"",description:""};a.b4w_tags&&(c.title=a.b4w_tags.title,c.description=a.b4w_tags.description);return c};a.gI=function(a,c){var d=Rb;jb.negate(c,d);for(var b=0;6>b;b++){var e=a.ij[b],f=a.wn[b],h=a.k;Ka.translate(Ha.$I[b],d,e);Ka.multiply(h.Bb,e,h.Rf);Ha.Rq(h.Rf,f)}};a.kI=function(a,c,d){Ha.tT(c,d,Ha.wc,a.k.kc)};
a.zL=function(a,c,d){var b=a.j.Rc,e=a.j.pg;d=ra.fr(d,qa.Rd&&a.b4w_enable_ssao);if(e)for(var f=0;f<c.length;f++){var h=c[f],g=ra.aa(h,a);if(null!=h.g.se){var k=e.og,n=e.ms,h=h.g.se;n.length?g.og=n[h]:k.length&&(g.og=k[h])}else null!=h.g.Qe&&(k=e.Ng,n=e.Sv,h=h.g.Qe,n.length?g.Ng=n[h]:k.length&&(g.Ng=k[h]))}for(f=0;f<d.length;f++)if(g=ra.aa(d[f],a),b)for(c=S(a,["SHADOW_CAST"]),e=0;e<c.length;e++)f==c[e].Mf&&g.Oy.push(c[e])};a.kF=function(a,c){return a.timeline_markers[c]};a.Es=function(a){var c=b();
if(c=X(c,"STEREO"))a.distortion_coefs&&(c.lj[0]=a.distortion_coefs[0],c.lj[1]=a.distortion_coefs[1],c.ra=!0),a.chromatic_aberration_coefs&&(c.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],c.ra=!0),a.base_line_factor&&(c.lj[2]=a.base_line_factor,c.ra=!0),a.inter_lens_factor&&(c.lj[3]=a.inter_lens_factor,
c.ra=!0),a.enable_hmd_stereo&&(c.enable_hmd_stereo=a.enable_hmd_stereo,c.ra=!0)};a.zF=function(c,d){for(var b=Qa,e=0;e<b.length;e++)na.NQ(a.Jw(b[e]),c,d)}};b4w.module.__hud=function(a,l){function m(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function b(a){e(' SCENE "'+a.name+'"');e(" Active        Subscene       Lamps      Size   RenderCalls  Time");if(a.j){var b=0,f=0,k=0;r.ma(a.j.Pa,function(a,g){if("SINK"!=g.type){var m=g.type,q=Math.round(g.k.width)+"x"+Math.round(g.k.height),l=g.D.length,r=g.yn;if("MAIN_CUBE_REFLECT"==g.type||"MAIN_CUBE_REFLECT_BLEND"==g.type)l*=6;var d=g.ec,h=d?g.tf:0;g.cd||(g.tf=0);
e(d?" (\u2713)":" (\u2715)",m,g.Vr,q,r,"of",l,"  ",h.toFixed(3));g.yn=0;d&&(b+=l,f+=r,k+=h)}});return[b,f,k]}e("No INFO")}function e(){for(var a=80+20*q[0],b=arguments[0],e=1;e<arguments.length;e++){for(var k="",m=0;m<w[e]-String(arguments[e]).length;m++)k+=" ";b+=k+arguments[e]}q[0]++;f.fillText(b,30,a)}function x(a,b,e){b*=a.Eb;e.x=a.x+b;e.y=a.y;e.Eb=a.Eb-2*b;e.vb=a.vb}function k(a){return a.x+a.Eb/2}function B(a){var b=f,e={x:0,y:0,Eb:0,vb:0},k=b.canvas.width,b=b.canvas.height;e.x=0;e.y=0;e.Eb=
k;e.vb=b;x(e,.01,e);k=.02*e.vb;e.x=e.x;e.y+=k;e.Eb=e.Eb;e.vb-=2*k;k=e.Eb/8;e.x+=k*a;e.y=e.y;e.Eb=k;e.vb=e.vb;x(e,.02,e);return e}var r=l("__graph");l("__print");var w=[5,24,7,10,4,3,6],f=null,q=[0,0];a.zf=function(a){a=a.getContext("2d");m(a);return f=a};a.dp=function(){f&&m(f)};a.reset=function(){var a=f;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),q[0]=0,q[1]=0)};a.LS=function(a,k){var m=f;if(m){m.textAlign="left";
m.fillStyle="rgba(0,255,0,255)";e(" FPS",(1/k).toFixed(2));q[0]++;for(var l=m=0,r=0,w=0;w<a.length;w++){var B=b(a[w]),m=m+B[0],l=l+B[1],r=r+B[2];q[0]++}e(" -----------------------------------------------");e("    ","TOTAL ACTIVE","","",l,"of",m,"  ",r.toFixed(3))}};a.print=function(){var a=f;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",e.apply(Math,arguments))};a.v0=function(a,b,e,m,q,l,r){var w=f;if(w){b=B(b);var x=b.vb/5;b.x=b.x;b.y+=4*x;b.Eb=b.Eb;b.vb=x;w.textAlign="center";w.fillStyle=
"#00FF00";f.fillText(a,k(b),b.y-10);w.strokeStyle="#00FF00";w.lineWidth=.5;w.beginPath();w.moveTo(b.x,b.y);w.lineTo(b.x+b.Eb,b.y);w.lineTo(b.x+b.Eb,b.y+b.vb);w.lineTo(b.x,b.y+b.vb);w.closePath();w.stroke();if(!l&&!r)for(l=1E6,r=-1E6,a=0;a<e.length;a++)l=Math.min(l,e[a]),r=Math.max(r,e[a]);w.textAlign="right";f.fillText(String(l),b.x-10,b.y+b.vb);f.fillText(String(r),b.x-10,b.y);w.textAlign="center";f.fillText(String(m),b.x,b.y+b.vb+15);f.fillText(String(q),b.x+b.Eb,b.y+b.vb+15);w.strokeStyle="#FF0000";
w.lineWidth=1.5;w.beginPath();m=b.Eb/(e.length-1);r=b.vb/(r-l);for(a=0;a<e.length;a++)q=b.x+m*a,x=b.y+b.vb-(e[a]-l)*r,0==a?w.moveTo(q,x):w.lineTo(q,x);w.stroke()}};a.RX=function(a,b,e,m,q,l,r){var w=f;if(w)for(w.textAlign="center",w.fillStyle="#00FF00",w.font="bold 12px Courier",e=B(e),f.fillText(b?"["+a+"]":a,k(e),e.y),0<=l&&f.fillText(l?"[M]":"[ ]",k(e)-15,e.y+30),0<=r&&f.fillText(r?"[S]":"[ ]",k(e)+15,e.y+30),a={x:0,y:0,Eb:0,vb:0},b=0;b<m.length;b++){l=m[b];var x="VOLUME"==l[0];if(x){r=e.y+350;
var I=e.Eb,d=a;d.x=e.x;d.y=r;d.Eb=I;d.vb=250}else{r=e.y+10+50*b;var I=e.Eb,d=e.vb,h=a;h.x=e.x;h.y=r;h.Eb=I;h.vb=d}r=w;var I=a,h=b==q,v=l[0],d=l[1],M=l[2],c=l[3],p=(c-M)/l[4],p=1>p?Math.floor(1/p-1E-5).toFixed(0).length:0;l=l[5]?Math.log(d/M)/Math.log(c/M):(d-M)/(c-M);r.textAlign="center";h?r.fillText("["+v+"]",k(I),I.y):r.fillText(v,k(I),I.y);r.strokeStyle="#00FF00";r.lineWidth=x?3:1;x?(r.textAlign="right",r.fillText(c.toFixed(p),k(I)-10,I.y+15),r.textAlign="right",r.fillText(M.toFixed(p),k(I)-10,
I.y+I.vb-15)):(r.textAlign="right",r.fillText(M.toFixed(p),I.x+28,I.y+15),r.textAlign="left",r.fillText(c.toFixed(p),I.x+I.Eb-28,I.y+15));r.beginPath();if(x){var R=I.y+15+(I.vb-30)*(1-l);r.moveTo(k(I),I.y+15);r.lineTo(k(I),I.y+I.vb-15);r.moveTo(k(I)-5,I.y+15);r.lineTo(k(I)+5,I.y+15);r.moveTo(k(I)-5,I.y+I.vb-15);r.lineTo(k(I)+5,I.y+I.vb-15);r.moveTo(k(I)-5,R);r.lineTo(k(I)+5,R)}else{var K=I.x+30+(I.Eb-60)*l;r.moveTo(I.x+30,I.y+15);r.lineTo(I.x+I.Eb-30,I.y+15);r.moveTo(I.x+30,I.y+15-5);r.lineTo(I.x+
30,I.y+15+5);r.moveTo(I.x+I.Eb-30,I.y+15-5);r.lineTo(I.x+I.Eb-30,I.y+15+5);r.moveTo(K,I.y+15-5);r.lineTo(K,I.y+15+5)}r.stroke();"EQ_Q"==v?(l=Math.log(1+1/(2*d*d)+Math.sqrt((2+1/(d*d))*(2+1/(d*d))/4-1))/Math.log(2),x?(r.textAlign="left",r.fillText(d.toFixed(p),k(I)+10,R),r.textAlign="left",r.fillText("("+l.toFixed(p+1)+")",k(I)+10,R+10)):(r.textAlign="right",r.fillText(d.toFixed(p),K,I.y+30),r.textAlign="left",r.fillText("("+l.toFixed(p+1)+")",K,I.y+30))):x?(r.textAlign="left",r.fillText(d.toFixed(p),
k(I)+10,R)):(r.textAlign="center",r.fillText(d.toFixed(p),K,I.y+30))}}};b4w.module.__input=function(a,l){function m(a){var c=u.cw();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||c)&&(10!=a||c&&window.DeviceOrientationEvent)?!0:!1}function b(a,c){if(!m(a))return null;var d={type:a,Jf:!1,bf:[],Hf:[],fh:[],gh:[],hh:[],ih:[],ro:[],VE:[],ah:[],Ah:[],zh:[],yh:[],element:c,mh:!0,yb:[],Qr:new Float32Array(2),MQ:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Bm:null,zg:null,He:null,orientation:T.create(),position:V.create(),
Ug:new Float32Array(4),Vg:new Float32Array(4),Dj:0,Kh:0,pi:0,Cm:0,$h:0,Lh:0,tj:[],Uh:[0,0,0,0,0,0,0,0,0,0,0,0],cD:[0,0,0,0,0,0,0,0,0,0,0,0],Xq:[]};d.Ug[0]=d.Ug[1]=d.Ug[2]=d.Ug[3]=45;d.Vg[0]=d.Vg[1]=d.Vg[2]=d.Vg[3]=45;30==a||40==a||50==a?(d.Jf=Boolean(c),50==a?document.addEventListener("touchstart",function(){}):40==a&&(d.mh=!1)):10==a?d.Jf=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!la.Af?k(d,W.webvr):(x(d),d.Jf=!0));return d}function e(c,d){10==c||20==c?d=window:d||(d=C.le());for(var e=
0;e<ka.length;e++)if(ka[e].type==c&&ka[e].element==d)return ka[e];e=b(c,d);60!=c&&70!=c&&80!=c&&90!=c||e.Xq.push(a.Vt,a.Wt,a.gu,a.nu,a.ou,a.pu,a.Fp,a.Gp,a.qu,a.ru,a.Xt,a.Yt,a.Zt,a.$t,a.au,a.bu,a.cu,a.du,a.eu,a.fu,a.hu,a.iu,a.ju,a.ku,a.lu,a.mu,a.Bp,a.Cp,a.Dp,a.Ep,a.Pt,a.Qt,a.Rt,a.St,a.Tt,a.Ut,a.Nt,a.Ot);e&&ka.push(e);return e}function x(a){var c=W.nonwebvr;a.Cm=c.Cm;a.$h=c.$h;a.Lh=c.Lh;k(a,c);a.Dj=c.Dj;a.Kh=c.Kh;a.pi=c.pi;r(a)}function k(a,c){a.distortion_coefs[0]=c.distortion_coefs[0];a.distortion_coefs[1]=
c.distortion_coefs[1];a.chromatic_aberration_coefs[0]=c.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=c.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=c.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=c.chromatic_aberration_coefs[3]}function B(a,c){var d=c*c;return c*(1+a[0]*d+a[1]*d*d)}function r(a){var c=a.Kh-a.Lh,d=a.$h-c,b=a.distortion_coefs,c=O.Ld(Math.atan(B(b,c/a.pi))),e=O.Ld(Math.atan(B(b,d/a.pi))),f=O.Ld(Math.atan(B(b,d/a.pi))),d=O.Ld(Math.atan(B(b,
d/a.pi)));e&&(a.Ug[0]=a.Vg[0]=Math.min(e,60));f&&(a.Ug[1]=a.Vg[3]=Math.min(f,60));c&&(a.Ug[2]=a.Vg[2]=Math.min(c,60));d&&(a.Ug[3]=a.Vg[1]=Math.min(d,60))}function w(a,c){var d=c.filter(function(a){return a instanceof HMDVRDevice}),b=null;d.length&&(b=d[0]);d=null;b&&(d=c.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==b.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.Bm=b;a.zg=d}function f(a,c,d){switch(a.type){case 20:var b=a.He||a.Bm;b?(c=b.getEyeParameters(c),
c=c.fieldOfView||c.currentFieldOfView,a=a.distortion_coefs,b=B(a,Math.tan(O.jb(c.downDegrees))),O.Ld(Math.atan(b)),b=B(a,Math.tan(O.jb(c.upDegrees))),O.Ld(Math.atan(b)),b=B(a,Math.tan(O.jb(c.leftDegrees))),O.Ld(Math.atan(b)),a=B(a,Math.tan(O.jb(c.rightDegrees))),O.Ld(Math.atan(a)),d[0]=c.upDegrees,d[1]=c.rightDegrees,d[2]=c.downDegrees,d[3]=c.leftDegrees):(c="left"==c?a.Ug:a.Vg,Y.copy(c,d));break;default:n.error("fov is undefined for device: ",a.type)}return d}function q(a,c){switch(c){case 0:return navigator.getVRDisplays?
3:navigator.getVRDevices?la.Af?1:0:2;case 23:var d=a.He||a.Bm;if(d){var b=d.getEyeParameters("left"),d=d.getEyeParameters("right");return a.He?d.offset[0]-b.offset[0]:d.eyeTranslation.x-b.eyeTranslation.x}return a.Dj}}function g(a,c){if(a.He){var d=a.He,b=d.capabilities,d=d.getPose();b.hasOrientation&&d.orientation&&(a.orientation[0]=d.orientation[0],a.orientation[1]=d.orientation[1],a.orientation[2]=d.orientation[2],a.orientation[3]=d.orientation[3]);b.hasPosition&&d.position&&(a.position[0]=d.position[0],
a.position[1]=d.position[1],a.position[2]=d.position[2])}else 1<c-ea&&(ea=c,navigator.getVRDisplays?a.He||navigator.getVRDisplays().then(function(c){0<c.length&&(a.He=c[0],a.Jf=!0)},function(){n.fc("WebVR displays are not found.");a.Jf=!1}):navigator.getVRDevices?a.Bm||ia||navigator.getVRDevices().then(function(c){w(a,c);c.length&&(a.Jf=!0);ia=!0},function(){n.fc("WebVR devices are not found.");a.Jf=!1;ia=!0}):la.Af||n.fc("HMD isn't supported."))}function z(a,c){if(a){for(var d=0;d<a.buttons.length;d++)c.tj[d]=
a.buttons[d].pressed;if(a.axes&&12>=a.axes.length)for(d=0;d<a.axes.length;d++)c.Uh[d]=a.axes[d]}}function A(a){for(var c=0;c<a.tj;c++)a.tj[c]=!1;for(c=0;c<a.Uh.length;c++)a.cD[c]=a.Uh[c],a.Uh[c]=0}function J(a,c){var d=a.indexOf(c);0<=d&&(a[d]=null)}function N(a){return null===a}function F(a,b,e,f){switch(b){case 120:e&&J(a.bf,e);if(f||a.Hf.every(N)&&a.bf.every(N))a.bf.length=0,a.Hf.length=0,b=a.yb.indexOf(131),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("deviceorientation",D,!1));break;
case 130:e&&J(a.Hf,e);if(f||a.Hf.every(N)&&a.bf.every(N))a.bf.length=0,a.Hf.length=0,b=a.yb.indexOf(131),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("deviceorientation",D,!1));break;case 40:e&&J(a.fh,e);if(f||a.fh.every(N))a.fh.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("mousedown",d,!1));break;case 30:e&&J(a.gh,e);if(f||a.gh.every(N))a.gh.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("mousemove",I,!1));break;case 50:e&&
J(a.hh,e);if(f||a.hh.every(N)){a.hh.length=0;b=a.yb.indexOf(b);0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("mouseout",h,!1),a.element.removeEventListener("mouseup",v,!1));break}break;case 60:e&&J(a.ih,e);if(f||a.ih.every(N))a.ih.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("wheel",M,!1));break;case 80:e&&J(a.ro,e);if(f||a.ro.every(N))a.ro.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("keydown",c,!1));break;case 70:e&&
J(a.ah,e);if(f||a.ah.every(N))a.ah.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("keyup",p,!1));break;case 90:e&&J(a.Ah,e);if(f||a.Ah.every(N))a.Ah.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("touchstart",R,!1));break;case 100:e&&J(a.zh,e);if(f||a.zh.every(N))a.zh.length=0,b=a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("touchmove",K,!1));break;case 110:if(e&&J(a.yh,e),f||a.yh.every(N))a.yh.length=0,b=
a.yb.indexOf(b),0<=b&&(a.yb.splice(b,1),a.element.removeEventListener("touchend",t,!1))}}function G(a,c){O.Mx(a,O.Ju,c);var d="orientation"in window?O.jb(window.orientation):"orientation"in window.screen?O.jb(window.screen.orientation.angle):0,d=T.setAxisAngle(O.lf,-d,aa);T.multiply(c,d,c);d=T.setAxisAngle(O.Ke,-Math.PI/2,aa);T.multiply(d,c,c);d=T.setAxisAngle(O.Ke,Math.PI/2,aa);T.multiply(c,d,c);return c}function D(a){var c=fa;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=
O.jb(a.alpha),c[1]=O.jb(a.beta),c[2]=O.jb(a.gamma));a=e(10,a.currentTarget);for(var d=0;d<a.Hf.length;d++){var b=a.Hf[d];b&&(V.copy(c,ga),b(ga))}if(a.bf.length)for(c=G(c,ba),d=0;d<a.bf.length;d++)if(b=a.bf[d])T.copy(c,E),b(E);for(d=0;d<a.bf.length;d++)a.bf[d]||a.bf.splice(d,1);for(d=0;d<a.Hf.length;d++)a.Hf[d]||a.Hf.splice(d,1)}function H(a,c){switch(a.type){case 30:a.Qr[0]=c.clientX,a.Qr[1]=c.clientY,a.MQ=c.which}}function I(a){var c=e(30,a.currentTarget);H(c,a);for(var d=0;d<c.gh.length;d++){var b=
c.gh[d];b&&(va[0]=a.clientX,va[1]=a.clientY,b(va))}c.mh&&a.preventDefault();for(d=0;d<c.gh.length;d++)c.gh[d]||c.gh.splice(d,1)}function d(a){var c=e(30,a.currentTarget);H(c,a);for(var d=0;d<c.fh.length;d++){var b=c.fh[d];b&&b(a.which)}c.mh&&a.preventDefault();for(d=0;d<c.fh.length;d++)c.fh[d]||c.fh.splice(d,1)}function h(a){C.FE(a.relatedTarget)||v(a)}function v(a){var c=e(30,a.currentTarget);H(c,a);for(var d=0;d<c.hh.length;d++){var b=c.hh[d];b&&b(a.which)}c.mh&&a.preventDefault();for(d=0;d<c.hh.length;d++)c.hh[d]||
c.hh.splice(d,1)}function M(a){for(var c=e(30,a.currentTarget),d=0;d<c.ih.length;d++){var b=c.ih[d];b&&b(-a.deltaY)}c.mh&&a.preventDefault();for(d=0;d<c.ih.length;d++)c.ih[d]||c.ih.splice(d,1)}function c(a){for(var c=e(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.VE:c.ro,b=0;b<d.length;b++){var f=d[b];f?f(a.keyCode):d.splice(b--,1)}c.mh&&a.preventDefault()}function p(a){for(var c=e(40,a.currentTarget),d=0;d<c.ah.length;d++){var b=c.ah[d];b&&b(a.keyCode)}c.mh&&a.preventDefault();for(d=0;d<
c.ah.length;d++)c.ah[d]||c.ah.splice(d,1)}function R(a){for(var c=e(50,a.currentTarget),d=0;d<c.Ah.length;d++){var b=c.Ah[d];b&&b(a.targetTouches)}for(d=0;d<c.Ah.length;d++)c.Ah[d]||c.Ah.splice(d,1)}function K(a){for(var c=e(50,a.currentTarget),d=0;d<c.zh.length;d++){var b=c.zh[d];b&&b(a.targetTouches)}c.mh&&a.preventDefault();for(d=0;d<c.zh.length;d++)c.zh[d]||c.zh.splice(d,1)}function t(a){for(var c=e(50,a.currentTarget),d=0;d<c.yh.length;d++){var b=c.yh[d];b&&b(a.targetTouches)}for(d=0;d<c.yh.length;d++)c.yh[d]||
c.yh.splice(d,1)}function y(a){switch(a){case 0:a=60;break;case 1:a=70;break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}var u=l("__compat"),C=l("__container"),L=l("__config"),n=l("__print"),T=l("__quat"),O=l("__util"),V=l("__vec3"),Y=l("__vec4"),la=L.v,W=L.BP;a.Uf=10;a.td=20;a.Oc=30;a.Dm=40;a.nf=50;a.vp=60;a.Et=70;a.Ft=80;a.Gt=90;a.aA=0;a.bA=1;a.$z=2;a.zu=3;a.Kp=0;a.Ip=10;a.Jp=20;a.YI=21;a.ZI=22;a.vu=23;a.uu=24;a.su=25;a.xu=26;a.yu=27;a.wu=28;a.tu=29;a.Fh=30;a.Pi=40;a.Im=50;a.Jm=60;
a.Hm=70;a.Gm=80;a.dA=81;a.Si=90;a.Mm=100;a.Lm=110;a.Hp=120;a.uk=130;a.Vt=0;a.Wt=1;a.gu=2;a.nu=3;a.ou=4;a.pu=5;a.Fp=6;a.Gp=7;a.qu=8;a.ru=9;a.Xt=10;a.Yt=11;a.Zt=12;a.$t=13;a.au=14;a.bu=15;a.cu=16;a.du=17;a.eu=18;a.fu=19;a.hu=20;a.iu=21;a.ju=22;a.ku=23;a.lu=24;a.mu=25;a.Bp=26;a.Cp=27;a.Dp=28;a.Ep=29;a.Pt=30;a.Qt=31;a.Rt=32;a.St=33;a.Tt=34;a.Ut=35;a.Nt=36;a.Ot=37;var ba=T.create(),aa=T.create(),fa=V.create(),ea=-Infinity,ia=!1,va=new Float32Array(2);V.create();var ga=V.create(),E=T.create(),ka=[];a.rv=
m;a.da=e;a.hz=function(a,c){a.mh=c};a.ky=function(a){switch(a.type){case 20:if(a.Jf)if(a.He)a.He.resetPose();else if(a.zg)for(var c=0;c<a.zg.length;c++)a.zg[c].resetSensor();break;default:n.error("reset_device() is undefined for device: ",a.type)}};a.Yh=function(a,c,d){switch(c){case 10:a:switch(a.type){case 20:V.copy(O.Fu,d);if(a.He)d[0]=a.orientation[0],d[1]=a.orientation[1],d[2]=a.orientation[2],d[3]=a.orientation[3];else if(a.zg)for(c=0;c<a.zg.length;c++){var b=a.zg[c],b=b.getState&&b.getState()||
b.getImmediateState&&b.getImmediateState();b.orientation&&(d[0]=b.orientation.x,d[1]=b.orientation.y,d[2]=b.orientation.z,d[3]=b.orientation.w)}T.normalize(d,d);a=T.setAxisAngle(O.Ke,Math.PI/2,ba);T.multiply(d,a,d);break a;default:n.error("orientation_quat is undefined for device: ",a.type)}return d;case 20:a:switch(a.type){case 20:V.copy(O.Iu,d);if(a.He)d[0]=a.position[0],d[1]=a.position[1],d[2]=a.position[2];else if(a.zg)for(c=0;c<a.zg.length;c++)b=a.zg[c],b=b.getState&&b.getState()||b.getImmediateState&&
b.getImmediateState(),b.position&&(d[0]=b.position.x,d[1]=b.position.y,d[2]=b.position.z);break a;default:n.error("position is undefined for device: ",a.type)}return d;case 21:return f(a,"left",d);case 22:return f(a,"right",d);case 30:return d[0]=a.Qr[0],d[1]=a.Qr[1],d}};a.gr=q;a.xy=function(a,c,d){switch(a.type){case 20:if(3===q(a,0))break;switch(c){case 24:a.distortion_coefs[0]=d[0];a.distortion_coefs[1]=d[1];break;case 23:a.Dj=d;r(a);break;case 25:a.Kh=d;r(a);break;case 26:a.pi=d;r(a);break;case 27:a.Cm=
d;r(a);break;case 28:a.$h=d;r(a);break;case 29:a.Lh=d,r(a)}break;case 60:case 70:case 80:case 90:a.Xq[c]=d}};a.eP=function(a,c){return c<a.tj.length?a.tj[a.Xq[c]]:!1};a.dP=function(a,c){return c-26<a.Uh.length?a.Uh[a.Xq[c]-26]:0};a.update=function(a){for(var c=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],d=0;d<ka.length;d++){var b=ka[d];switch(b.type){case 60:A(b);z(c[0],b);break;case 70:A(b);z(c[1],b);break;case 80:A(b);z(c[2],b);break;
case 90:A(b);z(c[3],b);break;case 20:g(b,a)}}};a.Xc=function(a,b,e){switch(b){case 120:a.bf.push(e);b=131;break;case 130:a.Hf.push(e);b=131;break;case 40:a.fh.push(e);break;case 30:a.gh.push(e);break;case 50:a.hh.push(e);break;case 60:a.ih.push(e);break;case 80:a.ro.push(e);break;case 81:a.VE.push(e);b=80;break;case 70:a.ah.push(e);break;case 90:a.Ah.push(e);break;case 100:a.zh.push(e);break;case 110:a.yh.push(e)}if(-1==a.yb.indexOf(b)&&(a.yb.push(b),a.Jf))switch(b){case 40:a.element.addEventListener("mousedown",
d,!1);break;case 30:a.element.addEventListener("mousemove",I,!1);break;case 50:a.element!=window&&a.element.addEventListener("mouseout",v,!1);a.element.addEventListener("mouseup",v,!1);break;case 60:a.element.addEventListener("wheel",M,!1);break;case 80:a.element.addEventListener("keydown",c,!1);break;case 70:a.element.addEventListener("keyup",p,!1);break;case 90:a.element.addEventListener("touchstart",R,!1);break;case 100:a.element.addEventListener("touchmove",K,!1);break;case 110:a.element.addEventListener("touchend",
t,!1);break;case 131:a.element.addEventListener("deviceorientation",D,!1)}};a.$c=function(a,c,d){F(a,c,d,!1)};a.uP=G;a.ha=function(){for(var a=0;a<ka.length;a++)for(var c=ka[a],d=0;d<c.yb.length;d++)F(c,c.yb[d],null,!0);ka.length=0};a.OD=function(a){a=e(y(a));for(var c=0;c<a.tj.length;c++)if(a.tj[c])return c;return-1};a.HD=function(a){a=e(y(a));for(var c=0;c<a.Uh.length;c++)if(a.cD[c]-a.Uh[c])return c+26;return-1};a.BD=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],c=0;c<a.length;c++)if(a[c])return c;return 0};a.gE=function(){var a=e(20);return a&&a.He}};b4w.module.__physics=function(a,l){function m(a,c){for(var d=a.zd,b=0;b<d.length;b++)d[b].If.gp&&c.push(d[b]),m(d[b],c)}function b(a,c,d){for(var b=a.Kb.D,e=0;e<b.length;e++)for(var f=b[e].r,h=0;h<f.yd.length;h++){var g=f.yd[h];"ANY"!=g.pb&&d!=g.pb||H(g,a,c)}}function e(a,c,d){if(u.yr(a))switch(c){case u.iJ:var b=x(a);b.Kb.NI=!0;u.M(a,u.eK,Date.now()-performance.now(),ba.Ef,ba.lv?aa.ZC:0);break;case u.jJ:L.rx("URANIUM:",d.slice(1));break;case u.eJ:L.error(d);break;case u.fJ:y.Tq.apply(this,d.slice(1));
break;case u.oJ:var e=k(d.J);if(e){a=d.trans;b=d.quat;c=d.jg;var f=d.Wf,e=e.r;e.Gq=d.time;V.rh(a,1,b,e.Uv);la.copy(c,e.jg);la.copy(f,e.Wf)}break;case u.lJ:(a=k(d.sv))&&V.rh(d.trans,1,d.quat,a.n.Fo[d.Xx]);break;case u.gJ:if(b=k(d[1]))a=d[4],b=b.Se.lq[d[2]],O.lc(b,d[3]),O.sg(b,a),O.p(b);break;case u.pJ:if(e=k(d[1]))e.n.speed=d[2];break;case u.aJ:b=x(a);B(b,d.aj,d.bj,d.result,null,null,0);break;case u.cJ:b=x(a);B(b,d.aj,d.bj,d.result,d.gj,d.coll_norm,d.coll_dist);break;case u.bJ:if(e=k(d[1]))a=e.r,a.fj&&
a.fj(d[2]);break;case u.cA:case u.mJ:b=x(a);if(a=b.Kb.mi[d.id])if(b=k(d.Hk),c==u.cA)c=a.callback,c(a.id,d.hit_fract,b,d.hit_time);else{c=d.hit_fract;var f=d.hit_time,e=d.hit_pos,g=a.callback;e?g(a.id,c,b,f,e,d.hit_norm):g(a.id,c,b,f)}break;case u.nJ:h(id);break;case u.kJ:a=ia.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(d[2]-d[1]).toFixed(3)+" ms, IN "+(performance.now()-d[2]).toFixed(3)+" ms, ALL "+(performance.now()-d[1]).toFixed(3)+" ms");break;case u.hJ:ea=d[1];break;case u.dJ:a=ia.indexOf(a);
console.log("Worker: #"+String(a));console.log(d[1]);break;default:L.error("Wrong message: "+c)}}function x(a){for(var c=0;c<ia.length;c++)if(ia[c]==a)return va[c]}function k(a){return ga[a]||null}function B(a,c,d,b,e,f,h){a=a.Kb.D;for(var g=0;g<a.length;g++)for(var n=a[g].r,p=0;p<n.yd.length;p++){for(var v=n.yd[p],m=v.ki,q=!1,l=0;l<m.length;l++){var t=m[l];if(t[0]===c&&t[1]===d){v.zo[l]=b;q=!0;break}}q&&(m=r(v),e&&v.gv!=c&&(q=e,l=f,t=h,q[0]+=l[0]*t,q[1]+=l[1]*t,q[2]+=l[2]*t,l[0]*=-1,l[1]*=-1,l[2]*=
-1),v.callback(m,m?v.gv==c?k(d):k(c):null,e,f,h))}}function r(a){a=a.zo;for(var c=!1,d=0;d<a.length;d++)c=c||a[d];return c}function w(){S.body++;return S.body}function f(a){var c=ka.indexOf(a);return-1==c?(ka.push(a),ka.length-1):c}function q(a,c){return{J:a,type:c,kg:0,zr:!1,xi:!0,Ed:!1,Ze:!1,PP:!1,xq:null,pb:"",ln:0,xX:{},yd:[],fj:null,Gq:0,Uv:new Float32Array([0,0,0,1,0,0,0,1]),jg:new Float32Array(3),Wf:new Float32Array(3),nq:new Float32Array(3),$m:new Float32Array(4)}}function g(a,c){switch(a){case "BOX":var d=
c.R;break;case "CYLINDER":d=c.bv;break;case "CONE":d=c.av;break;case "SPHERE":d=c.Pe;break;case "CAPSULE":d=c.$u}return d}function z(a){if(!a)return null;var c={};"number"===typeof a.min_x&&(c.min_x=a.min_x);"number"===typeof a.min_y&&(c.min_y=a.min_y);"number"===typeof a.min_z&&(c.min_z=a.min_z);"number"===typeof a.max_x&&(c.max_x=a.max_x);"number"===typeof a.max_y&&(c.max_y=a.max_y);"number"===typeof a.max_z&&(c.max_z=a.max_z);"object"===typeof a.O&&(c.center=a.O);"number"===typeof a.mb&&(c.radius=
a.mb);"number"===typeof a.height&&(c.height=a.height);return c}function A(a,c,d,b,e){var f=V.q(a.g.i),h=V.invert(c.g.i,ha),g=new Float32Array(3);V.Fc(f,h,g);switch(c.n.type){case 10:c=c.Vd;a=a.g.R;u.M(e,u.IJ,d,g,c.iT,c.ny,(a.max_y-a.min_y)/2,b);break;case 20:u.M(e,u.HJ,d,g,a.f2)}}function J(a){return a.r&&a.r.xq}function N(a,c,d,b,e,f,h,g,k,n){var p;S.zb++;p=S.zb.toString(16);var v=c.r.J;u.M(F(v),u.PJ,p,a,g,v,d,b,e.r.J,f,h,k,n);c.r.xq=p}function F(a){for(var c=0;c<va.length;c++)for(var d=va[c].Kb.D,
b=0;b<d.length;b++)if(d[b].r.J==a)return ia[c];return null}function G(a){var c=a.r;if(c=c?0===c.kg?!0:!0===c.zr?!0:!1===c.xi?!0:"RIGID_BODY"!==c.type&&"DYNAMIC"!==c.type?!0:!1:!1)var c=V.q(a.g.i),d=V.B(a.g.i),c=c[0]!=a.r.nq[0]||c[1]!=a.r.nq[1]||c[2]!=a.r.nq[2]||d[0]!=a.r.$m[0]||d[1]!=a.r.$m[1]||d[2]!=a.r.$m[2]||d[3]!=a.r.$m[3];if(c){var c=a.r,b=a.g,d=V.q(b.i),b=V.B(b.i);la.copy(d,c.nq);n.copy(b,c.$m);var e=u.ID(u.Mp);e.J=c.J;e.trans=d;"DYNAMIC"==c.type?n.identity(e.quat):e.quat=b;u.M(F(c.J),u.Mp)}a=
a.zd;for(c=0;c<a.length;c++)G(a[c])}function D(a,c,d,b,e){e=e||new Float32Array(3);a=V.B(a.g.i);e[0]=c;e[1]=d;e[2]=b;la.transformQuat(e,a,e)}function H(a,c,d){var b=a.ki,e=a.zo,f=a.gv,h=[],g=a.pb;h||Y.l("At least one destination required");for(var k=0;k<c.Kb.D.length;k++){var n=c.Kb.D[k];if("ANY"==g||n.r.pb==g)n=n.r.J,h&&-1==h.indexOf(n)&&h.push(n)}for(c=0;c<h.length;c++)g=h[c],f<g&&!I(b,f,g)?(b.push([f,g]),e.push(!1)):f>g&&!I(b,g,f)&&(b.push([g,f]),e.push(!1));u.M(d,u.GJ,f);u.M(d,u.OJ,b,a.Yf)}function I(a,
c,d){for(var b=0;b<a.length;b++)if(a[b][0]==c&&a[b][1]==d)return!0;return!1}function d(a){a.r&&a.r.fj&&(a=a.r,u.M(F(a.J),u.aK,a.J),a.fj=null)}function h(a){var c=M(a),d=v(a).Kb;d.mi[a]&&(delete d.mi[a],d.ay.splice(d.ay.indexOf,1),u.M(c,u.jK,a))}function v(a){for(var c=0;c<va.length;c++){var d=va[c];if(d.Kb.mi[a])return d}return null}function M(a){for(var c=0;c<va.length;c++)if(va[c].Kb.mi[a])return ia[c];return null}function c(a,c,d){if(c.km){a=a.r.J;var b=c.Xk*c.Rn,e=c.Ym*c.Zm,f=-c.im*c.jm*2*Math.PI/
c.ap;c.jo&&(f*=-1);switch(c.type){case 10:u.M(d,u.wK,a,b,e,f);break;case 20:u.M(d,u.vK,a,b,e,f)}}}function p(a){return a.Ed&&"CHASSIS"==a.Vd.Id}function R(a){return a.Ed&&"HULL"==a.Vd.Id}function K(a){return a.Gj&&"MAIN_BODY"==a.Zk.Id}var t=l("__config"),y=l("__debug"),u=l("__ipc"),C=l("__obj_util"),L=l("__print"),n=l("__quat"),T=l("__scenes"),O=l("__transform"),V=l("__tsr"),Y=l("__util"),la=l("__vec3"),W=l("__version"),ba=t.r,aa=t.v,fa=t.Ne,ea=0,ia=[],va=[],ga={},E=[],ka=["ANY"],S={body:0,zb:0,pG:0},
X=new Float32Array(3);new Float32Array(4);var Ca=new Float32Array(4);new Float32Array(16);var ha=V.create(),ja=V.create();a.KP=function(a){a.Kb={NI:!1,D:[],mi:{},ay:[]};var c=ba.ep;fa.prevent_caching&&(c+=W.timestamp());L.log("%cLOAD PHYSICS","color: #0a0",ba.jp?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+ba.Ef);L.log("%cPHYSICS PATH","color: #0a0",c);var d=u.wN(c,!ba.jp);u.BL(d,e);ia.push(d);va.push(a);ba.ping&&setInterval(function(){u.M(d,u.gK,performance.now())},1E3)};a.yM=
function(a){return a.Kb?a.Kb.NI:!0};a.ha=function(){for(var a=0;a<ia.length;a++)u.terminate(ia[a]);ia.length=0;va.length=0;ga={};E.length=0;ka.length=0;for(var c in S)S[c]=0};a.Dk=function(a,d){a.g||Y.l("No object render: "+a.name);var e;a:{for(var h=0;h<va.length;h++)if(va[h]==d){e=ia[h];break a}e=void 0}var k=[];a.If.gp&&m(a,k);var v=d.Kb.D;if(p(a)||R(a)||a.Ze||K(a)||a.kk){var l,t=a,r=e,y=t.g,M=t.If,B=M.hs,aa=w();if("CAMERA"==t.type)var x=M.xz?M.uq:"BOX",O=g(x,y),I=y.Tn,H=y.In,I=.5,H=0;else if("EMPTY"==
t.type)x="EMPTY",O=null,H=I=0;else{var x=M.xz?M.uq:"BOX",O=g(x,y),T=V.Pc(y.i);if(1!=T){var D=O;switch(x){case "BOX":D.min_x*=T;D.max_x*=T;D.min_y*=T;D.max_y*=T;D.min_z*=T;D.max_z*=T;break;case "CYLINDER":case "CONE":case "CAPSULE":D.height*=T;D.mb*=T;break;case "SPHERE":D.mb*=T}}I=y.Tn;H=y.In}var F=V.q(y.i),G=V.B(y.i),ea=M.ip,fa=M.sI,wa=M.kg,S=M.wI,W=M.vI,ba=M.Wv,la=M.py,X=t.pb,ka=f(X),Fa=M.mn,Ha=M.kn,jb=M.nn,Sa=y.Pe.mb,qa=z(O),tb=t.zq,eb;var uc=x;if(k.length){var xb=[],Oa={};Oa.quat=new Float32Array([0,
0,0,1]);Oa.trans=new Float32Array(3);Oa.worker_bounding=qa;Oa.bounding_type=uc;xb.push(Oa);var Qb=V.invert(y.i,ha);n.invert(V.B(y.i),Ca);for(var Yb=0;Yb<k.length;Yb++){var tc={},Pb=k[Yb],Qa=Pb.If.uq,sb=new Float32Array(4),Xb=new Float32Array(3),Ic=V.B(Pb.g.i);V.Fc(V.q(Pb.g.i),Qb,Xb);n.multiply(Ca,Ic,sb);tc.trans=Xb;tc.quat=sb;tc.bounding_type=Qa;tc.worker_bounding=z(g(Qa,Pb.g));xb.push(tc)}eb=xb}else eb=[];u.M(r,u.LJ,aa,F,G,B,ea,fa,wa,S,W,ba,la,ka,Fa,Ha,jb,x,qa,Sa,I,H,eb,tb);ga[aa]=t;E.push(t);var Rb=
q(aa,"BOUNDING");Rb.type=B;Rb.kg=wa;Rb.zr=ea;Rb.pb=X;Rb.ln=ka;l=Rb;a.r=l;var Dc={G:null,r:l};v.push(Dc);b(d,e,l.pb)}else for(var Tc=C.aa(a,d).X,mc=0;mc<Tc.length;mc++){var Fb=Tc[mc],Oc;if(Oc="PHYSICS"==Fb.type){var rb;a:{for(var Sb=d.Kb.D,nc=0;nc<Sb.length;nc++){var Mb=Sb[nc].G;if(Mb&&Mb.id==Fb.id){rb=!0;break a}}rb=!1}Oc=!rb}if(Oc)if(Fb.Ae.wa)if(Fb.pk&&d.j.nc){var mb=Fb,Ra=d,Ia=e,Ec=Ra.j.nc;u.M(Ia,u.UJ,Ec.Ki);if(mb.GU){var Ta={};Ta.dst_noise_scale0=mb.dst_noise_scale0;Ta.dst_noise_scale1=mb.dst_noise_scale1;
Ta.dst_noise_freq0=mb.dst_noise_freq0;Ta.dst_noise_freq1=mb.dst_noise_freq1;Ta.dir_min_shore_fac=mb.dir_min_shore_fac;Ta.dir_freq=mb.dir_freq;Ta.dir_noise_scale=mb.dir_noise_scale;Ta.dir_noise_freq=mb.dir_noise_freq;Ta.dir_min_noise_fac=mb.dir_min_noise_fac;Ta.dst_min_fac=mb.dst_min_fac;Ta.waves_hor_fac=mb.waves_hor_fac;var Fc=Ec.waves_height,vc=Ec.waves_length;Ec.wi?u.M(Ia,u.xA,Ta,Ec.$l[0],Ec.$l[1],Ec.Zl[0],Ec.Zl[1],Ec.ux,Fc,vc,Ec.Qy,Ra.j.Py):u.M(Ia,u.xA,Ta,0,0,0,0,0,Fc,vc,0,null)}}else{var Wa;if(Fb.ip){var Gb=
a,nd=Fb,dc=e,ed=w(),Pc=nd.Ae,od=Pc.N[0].a_position,ub=Pc.ab||null,Bc=nd.pb,Cc=f(Bc);u.M(dc,u.RJ,ed,od,ub,V.q(Gb.g.i),Cc,nd.mn,nd.kn,nd.nn);var Uc=q(ed,"STATIC_MESH");Uc.zr=!0;Uc.pb=Bc;Uc.ln=Cc;Wa=Uc}else{var ec=a,Jc=Fb,vd=e,pd=w(),qd=Jc.Ae,fd=qd.N[0].a_position,wd=qd.ab||null,xd=V.q(ec.g.i),gb=Jc.Tn,rd=Jc.In,vb=Jc.pb,Hb=f(vb);u.M(vd,u.TJ,pd,fd,wd,xd,gb,rd,Hb,Jc.mn,Jc.kn,Jc.nn);var oc=q(pd,"STATIC_MESH");oc.pb=vb;oc.ln=Hb;Wa=oc}l=Wa;a.r=l;Dc={G:Fb,r:l};v.push(Dc);b(d,e,l.pb)}else L.error("Object "+
a.name+" has collision material with no assigned vertices")}if(p(a)||R(a)){var Ua=a,yb=e,Ib=Ua.r.J;p(Ua)?(Ua.n.type=10,u.M(yb,u.MJ,Ib,Ua.n.ez,Ua.n.gz,Ua.n.fz,Ua.n.Lz,Ua.n.vx)):R(Ua)&&(Ua.n.type=20,u.M(yb,u.KJ,Ib,Ua.n.qj,Ua.n.qk,Ua.n.rk));if(Ua.n.$j){var zb=Ua.n.$j;switch(Ua.n.type){case 10:A(zb[1],Ua,Ib,!0,yb);A(zb[0],Ua,Ib,!0,yb);A(zb[3],Ua,Ib,!1,yb);A(zb[2],Ua,Ib,!1,yb);break;case 20:for(var Jb=0;Jb<zb.length;Jb++)A(zb[Jb],Ua,Ib,!1,yb)}}c(a,a.n,e)}else if(a.Ze){var Kb=e,pc=a.g,Zb=a.r,qc=pc.R.max_y-
pc.R.min_y,nb=Zb.J,pb=a.KB,La=pb.FU,cb=pb.MR,ic=pb.aT,hb=pb.ZP,wc=pb.HU,Ab=Y.NN(a);u.M(Kb,u.NJ,nb,Ab,qc,La,cb,ic,hb,wc);Zb.Ze=!0}else if(K(a)){var Va=a,Tb=e,fc=Va.r.J;u.M(Tb,u.QJ,fc,Va.Se.qj,Va.Se.qk,Va.Se.rk);if(Va.Se.lq)for(var Gc=Va.Se.lq,ob=0;ob<Gc.length;ob++){var $a=Gc[ob],$b=V.q($a.g.i),ya=V.invert(Va.g.i,ha),Nb=new Float32Array(3);V.Fc($b,ya,Nb);u.M(Tb,u.JJ,fc,Nb,$a.OL)}Va.r.PP=!0}for(mc=0;mc<E.length;mc++)if(a=E[mc],a.r){var db=a;if(!J(db))for(var gc=0;gc<db.Sx.length;gc++){var Na=db.Sx[gc],
kb=Na.target,Bb=Na.cR;if(kb.r){var ac=new Float32Array([Na.dR,Na.eR,Na.fR]),Pa,Xa=new Float32Array([Na.$d,Na.ae,Na.be]);Pa=Y.Th(Xa,new Float32Array(4));var wb=V.identity(ha),wb=V.ff(ac,wb),wb=V.ti(Pa,wb),Ya=V.multiply(db.g.i,wb,ha),rc=V.invert(kb.g.i,ja),Ub=V.multiply(rc,Ya,rc),ab=Na,bb={};bb.use_limit_x=ab.kU;bb.use_limit_y=ab.lU;bb.use_limit_z=ab.mU;bb.use_angular_limit_x=ab.fU;bb.use_angular_limit_y=ab.gU;bb.use_angular_limit_z=ab.hU;bb.limit_max_x=ab.iQ;bb.limit_min_x=ab.lQ;bb.limit_max_y=ab.jQ;
bb.limit_min_y=ab.mQ;bb.limit_max_z=ab.kQ;bb.limit_min_z=ab.nQ;bb.limit_angle_max_x=ab.cQ;bb.limit_angle_min_x=ab.fQ;bb.limit_angle_max_y=ab.dQ;bb.limit_angle_min_y=ab.gQ;bb.limit_angle_max_z=ab.eQ;bb.limit_angle_min_z=ab.hQ;N(Bb,db,ac,Pa,kb,V.q(Ub),V.B(Ub),bb,null,null)}}}};a.oO=k;a.update=function(a,c){for(var d=0;d<ia.length;d++){var b=ia[d],e=a;b&&u.LE(b)&&u.M(b,u.xK,e,c);for(var f=0;f<E.length;f++){var h=E[f],g=h.r;if(g.xi&&g.Gq){var k=u.LE(b)?e-g.Gq:performance.now()/1E3-g.Gq,k=Math.min(k,10/
ba.Ef),k=k-1/ba.Ef;aa.PQ&&(k=0);var p=ha;V.LP(g.Uv,k,g.jg,g.Wf,ha);O.sh(h,p);O.p(h);G(h);if(h.n)for(var g=h,k=g.n.$j,p=g.g.i,v=ha,m=0;m<k.length;m++){var q=k[m];V.multiply(p,g.n.Fo[m],v);O.sh(q,v);O.p(q)}h.n&&h.n.km&&(v=h,k=v.n,g=k.km)&&(m=v.n.xH,V.multiply(v.g.i,v.n.yH,g.g.i),p=X,V.Tc(m,v.g.i,p),v=Ca,n.setAxisAngle(p,-k.im*k.jm*2*Math.PI,v),k=V.B(g.g.i),n.multiply(v,k,k),O.p(g));h.n&&h.n.Yy&&(v=h,k=v.n,g=k.Yy)&&(m=v.n.tH,V.multiply(v.g.i,v.n.uH,g.g.i),p=X,V.Tc(m,v.g.i,p),v=Ca,m=Math.abs(k.speed)*
k.Zo,m>k.zl&&(m=k.zl),n.setAxisAngle(p,-m,v),k=V.B(g.g.i),n.multiply(v,k,k),n.normalize(k,k),O.p(g));h.n&&h.n.iz&&(p=h,g=p.n,h=g.iz)&&(v=p.n.HH,V.multiply(p.g.i,p.n.IH,h.g.i),k=X,V.Tc(v,p.g.i,k),p=Ca,n.setAxisAngle(k,-Math.abs(g.Xk)*g.zn,p),g=V.B(h.g.i),n.multiply(p,g,g),n.normalize(g,g),O.p(h))}}u.kR(b);b=va[d];(e=b.j.nc)&&0<e.waves_height&&(b=T.qa(b,"MAIN_OPAQUE"),e=la.length(b.Ch),u.M(ia[d],u.uK,b.time*e))}};a.OO=function(){return va[0]};a.pause=function(){for(var a=0;a<ia.length;a++)u.M(ia[a],
u.fK)};a.oh=function(){for(var a=0;a<ia.length;a++)u.M(ia[a],u.kK)};a.KC=function(a){(a=a.r)||Y.l("No object physics");if(!a.xi){var c=a.J,d=F(c);a.xi=!0;u.M(d,u.dK,c)}};a.gw=function(a){(a=a.r)||Y.l("No object physics");if(a.xi){var c=a.J,d=F(c);a.xi=!1;u.M(d,u.cK,c)}};a.vs=function(a){return Boolean(a.Kb)};a.ea=function(a){return Boolean(a.r)};a.vE=function(a){return(a=a.r)&&a.xi&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.kg&&0==a.zr?!0:!1};a.Uw=function(a){return(a=a.r)&&a.xi?!0:!1};a.SG=
function(a,c){var d=a.r.J;u.M(F(d),u.tK,d,c)};a.wP=J;a.gB=N;a.VB=function(a){a=a.r;u.M(F(body_a),u.iK,a.xq);a.xq=null};a.hG=function(c,d,b,e,f,h){d=V.rh(d,1,b,ha);f=V.rh(f,1,h,ja);V.invert(d,d);V.multiply(f,d,d);O.bo(e,f);V.multiply(f,d,d);O.sh(c,d);O.p(c);a.Is(c,V.q(c.g.i),V.B(c.g.i))};a.Is=function(a,c,d){var b=a.r;V.rh(V.q(a.g.i),1,V.B(a.g.i),b.Uv);a=u.ID(u.Mp);a.J=b.J;a.trans=c;a.quat=d;u.M(F(b.J),u.Mp)};a.u=G;a.kB=function(a,c,d,b){D(a,c,d,b,X);a=a.r.J;c=Math.abs(0);d=Math.abs(0);b=Math.abs(0);
var e=Math.abs(X[0]),f=Math.abs(X[1]),h=Math.abs(X[2]);X[0]=e?X[0]/e*Math.max(e,c):0;X[1]=f?X[1]/f*Math.max(f,d):0;X[2]=h?X[2]/h*Math.max(h,b):0;u.M(F(a),u.zA,a,X[0],X[1],X[2])};a.lB=function(a,c,d,b){a=a.r.J;u.M(F(a),u.zA,a,c,d,b)};a.Vu=function(a,c,d,b,e){e?(X[0]=c,X[1]=d,X[2]=b):D(a,c,d,b,X);a=a.r.J;u.M(F(a),u.VJ,a,X[0],X[1],X[2])};a.jB=function(a,c,d,b){D(a,c,d,b,X);a=a.r.J;u.M(F(a),u.XJ,a,X[0],X[1],X[2])};a.wy=function(a,c,d){a=a.r.J;u.M(F(a),u.nK,a,c,d)};a.Bs=function(a,c){var d=a.r.J;u.M(F(d),
u.oK,d,c)};a.NG=function(a,c){var d=a.r.J;u.M(F(d),u.sK,d,c)};a.MG=function(a,c){var d=a.r.J;u.M(F(d),u.qK,d,c)};a.JG=function(a,c){var d=a.r.J;u.M(F(d),u.lK,d,c)};a.IB=function(a){a=a.r.J;u.M(F(a),u.ZJ,a)};a.JB=function(a,c,d){a=a.r.J;u.M(F(a),u.$J,a,c,d)};a.Cs=function(a,c,d){a=a.r.J;u.M(F(a),u.pK,a,c,d)};a.KG=function(a,c){var d=a.r.J;u.M(F(d),u.mK,d,c)};a.LG=function(a,c){var d=a.r.J;u.M(F(d),u.rK,d,c)};a.Su=function(a,c,d,b){var e=a.r,f=e.J;c=c||"ANY";for(var h=0;h<e.yd.length;h++)if(a=e.yd[h],
a.pb==c&&a.callback==d)return;a={gv:f,Yf:b||!1,pb:c,callback:d,ki:[],zo:[]};e.yd.push(a);c=F(f);H(a,x(c),c)};a.fy=function(a,c,d){a=a.r;for(var b=F(a.J),e=x(b),f=0;f<a.yd.length;f++){var h=a.yd[f];if(h.pb==c&&h.callback==d){if(r(h)){var g=la.set(0,0,0,X);h.callback(!1,null,g,g,0)}a.yd.splice(f,1);f--;for(var g=b,h=h.ki,k=e.Kb.D,n=0;n<k.length;n++)for(var p=k[n].r,v=0;v<p.yd.length;v++)for(var m=p.yd[v],q=0;q<m.ki.length;q++)for(var l=m.ki[q],t=0;t<h.length;t++){var z=h[t];l[0]==z[0]&&l[1]==z[1]&&
(h.splice(t,1),t--)}h.length&&u.M(g,u.yA,h)}}};a.Uu=function(a,c){a.r&&a.r.fj&&d(a);var b=a.r;u.M(F(b.J),u.WJ,b.J);b.fj=c};a.xv=d;a.bq=function(a,c,d,b,e,h,g,k,n){var p;S.pG++;p=S.pG;b=b||"ANY";a={id:p,J:a?a.r.J:0,from:new Float32Array(c),to:new Float32Array(d),pb:b,ln:f(b),rB:h,SL:g,Yf:k,rr:n,callback:e};c=F(a.J)||ia[0];d=x(c).Kb;p=a.id;d.mi[p]=a;d.ay.push(a);u.M(c,u.SJ,a.id,a.J,a.from,a.to,a.ln,a.rB,a.SL,a.Yf,a.rr);return p};a.gy=h;a.GB=function(a,c,d){var b=M(a),e=v(a).Kb.mi[a];e&&!e.rB&&(e.from.set(c),
e.to.set(d),u.M(b,u.YJ,a,c,d))};a.NE=function(a){return v(a).Kb.mi[a]?!0:!1};a.ym=function(a,d){var b=a.n;b.Xk=d;c(a,b,F(a.r.J))};a.xm=function(a,d){var b=a.n;b.im=d;c(a,b,F(a.r.J))};a.Bz=function(a,d){var b=a.n;b.Ym=d;c(a,b,F(a.r.J))};a.Fd=p;a.Gd=R;a.OP=function(a){if(!a.Ed)return!1;a=a.Vd.Id;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.NP=function(a){return a.Ed?"BOB"==a.Vd.Id?!0:!1:!1};a.QP=function(a){return a.Gj?"BOB"==a.Zk.Id?!0:!1:
!1};a.PE=function(a){return a.Ed&&"STEERING_WHEEL"==a.Vd.Id?!0:!1};a.OE=function(a){return a.Ed&&"SPEEDOMETER"==a.Vd.Id?!0:!1};a.QE=function(a){return a.Ed&&"TACHOMETER"==a.Vd.Id?!0:!1};a.bE=function(a){return a.n.speed};a.JU=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.Ze=function(a){return a.Ze};a.I_=K;a.bP=function(){return ea};a.EN=function(){for(var a=0;a<ia.length;a++)u.M(ia[a],u.bK)};
a.No=function(a){if("BOUNDING"==a.r.type){var c=E.indexOf(a);-1==c&&L.error("Object "+a.name+" doesn't have bounding physics");delete ga[b];E.splice(c,1)}for(var b=a.r.J,c=F(b),e=x(c),f=b,h=e.Kb.D,g=[],k=0;k<h.length;k++)for(var n=h[k].r,p=0;p<n.yd.length;p++)for(var v=n.yd[p],m=0;m<v.ki.length;m++){var q=v.ki[m],l=v.zo[m];if(q[0]==f||q[1]==f)v.ki.splice(m,1),v.zo.splice(m,1),m--,l&&!r(v)&&(l=la.set(0,0,0,X),v.callback(!1,null,l,l,0)),g.push(q)}g.length&&u.M(c,u.yA,g);a.r&&a.r.fj&&d(a);a=e.Kb.D;for(e=
0;e<a.length;e++)a[e].r.J==b&&(a.splice(e,1),e--);u.M(c,u.hK,b)}};b4w.module.__ipc=function(a,l){function m(a,b,e){for(var f=0;f<z.length;f+=2)z[f+1]==a&&(g[f+Number(!b)]=e)}function b(a){for(var b=0;b<a.length;b++){var e=a[b],f=0,c;for(c in e){var g=e[c];switch(g.constructor){case Float32Array:f+=g.length;break;case Number:f+=1}}--f;e.len=f}}var e=!0;a.iJ=0;var x=a.aJ=1,k=a.cJ=2;a.bJ=3;a.eJ=4;a.fJ=5;a.gJ=6;a.jJ=7;var B=a.lJ=8,r=a.cA=9,w=a.mJ=10;a.nJ=11;var f=a.oJ=12;a.pJ=13;a.kJ=14;a.hJ=15;a.dJ=16;a.eK=100;a.GJ=101;a.HJ=102;a.IJ=103;a.JJ=104;a.LJ=105;a.KJ=106;
a.MJ=107;a.NJ=108;a.OJ=109;a.PJ=110;a.QJ=111;a.RJ=112;a.TJ=113;a.UJ=114;a.hK=115;a.VJ=116;a.WJ=117;a.XJ=118;a.ZJ=119;a.$J=120;a.aK=121;a.cK=122;a.dK=123;a.fK=124;a.SJ=125;a.jK=126;a.YJ=127;a.yA=128;a.iK=129;a.kK=130;a.lK=131;a.mK=132;a.nK=133;a.oK=134;a.pK=135;a.qK=136;a.rK=137;a.sK=138;a.tK=139;a.zA=140;var q=a.Mp=141;a.uK=142;a.xA=143;a.vK=144;a.wK=145;a.gK=146;a.bK=147;a.xK=148;var g=b4w.worker_listeners,z=b4w.worker_namespaces,A={pe:f,J:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
jg:new Float32Array(3),Wf:new Float32Array(3),len:0},J={pe:B,sv:0,Xx:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},N={pe:r,id:0,Hk:0,hit_fract:0,hit_time:0,len:0},F={pe:w,id:0,Hk:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},G={pe:x,aj:0,bj:0,result:0,len:0},D={pe:k,aj:0,bj:0,result:0,gj:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},H={pe:q,J:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},I=[A,J,N,F,G,D,H];
a.wN=function(a,b){var f={Br:a?!0:!1,Li:null,Xf:[],Re:""};if(b)if(f.Li={addEventListener:function(a,c){"message"!=a&&panic("Wrong web worker event");m(f.Re,f.Br,c)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");m(f.Re,f.Br,null)},postMessage:function(a){var c;a:{for(c=0;c<z.length;c+=2)if(z[c+1]==f.Re){c=g[c+Number(!!f.Br)];break a}c=null}c({data:a})},terminate:function(){for(var a=0;a<z.length;a+=2)if(z[a+1]==f.Re){g.splice(a,2);z.splice(a,2);break}}},f.Br){var k=
l("__util"),c=l("__container"),p=b4w.get_namespace(l),k=k.cp(p+"_worker");z.push(p);z.push(k);g.push(null);g.push(null);f.Re=k;(c=c.qO(a))?e?c.addEventListener("load",function(){b4w.require("__bindings",f.Re)},!1):(b4w.ha("__bindings",f.Re),b4w.ha("__ipc",f.Re),b4w.require("__bindings",f.Re)):(c=document.createElement("script"),c.src=a,c.defer="defer",c.async="async",c.addEventListener("load",function(){e=!1;b4w.require("__bindings",f.Re)},!1),document.head.appendChild(c))}else f.Re=b4w.get_namespace(l);
else f.Li=a?new Worker(a):self;return f};a.BL=function(a,e){function g(b){if(b.constructor==ArrayBuffer)b=new Float32Array(b);else if(b[0].constructor==ArrayBuffer){for(var c=0;c<b.length;c++)g(b[c]);return}c=b[0]|0;switch(c){case f:var p=A;p.J=b[1]|0;p.time=b[2];p.trans[0]=b[3];p.trans[1]=b[4];p.trans[2]=b[5];p.quat[0]=b[6];p.quat[1]=b[7];p.quat[2]=b[8];p.quat[3]=b[9];p.jg[0]=b[10];p.jg[1]=b[11];p.jg[2]=b[12];p.Wf[0]=b[13];p.Wf[1]=b[14];p.Wf[2]=b[15];break;case B:p=J;p.sv=b[1]|0;p.Xx=b[2]|0;p.trans[0]=
b[3];p.trans[1]=b[4];p.trans[2]=b[5];p.quat[0]=b[6];p.quat[1]=b[7];p.quat[2]=b[8];p.quat[3]=b[9];break;case r:p=N;p.id=b[1]|0;p.Hk=b[2]|0;p.hit_fract=b[3];p.hit_time=b[4];break;case w:p=F;p.id=b[1]|0;p.Hk=b[2]|0;p.hit_fract=b[3];p.hit_time=b[4];p.hit_pos[0]=b[5];p.hit_pos[1]=b[6];p.hit_pos[2]=b[7];p.hit_norm[0]=b[8];p.hit_norm[1]=b[9];p.hit_norm[2]=b[10];break;case x:p=G;p.aj=b[1]|0;p.bj=b[2]|0;p.result=!!b[3];break;case k:p=D;p.aj=b[1]|0;p.bj=b[2]|0;p.result=!!b[3];p.gj[0]=b[4];p.gj[1]=b[5];p.gj[2]=
b[6];p.coll_norm[0]=b[7];p.coll_norm[1]=b[8];p.coll_norm[2]=b[9];p.coll_dist=b[10];break;case q:p=H;p.J=b[1]|0;p.trans[0]=b[2];p.trans[1]=b[3];p.trans[2]=b[4];p.quat[0]=b[5];p.quat[1]=b[6];p.quat[2]=b[7];p.quat[3]=b[8];break;default:p=b}e(a,c,p)}b(I);a.Li.addEventListener("message",function(a){g(a.data)},!1)};a.ha=function(){};a.M=function(a,b){if(a)switch(b){case f:var e=A,g=new Float32Array(e.len);g[0]=e.pe;g[1]=e.J;g[2]=e.time;g[3]=e.trans[0];g[4]=e.trans[1];g[5]=e.trans[2];g[6]=e.quat[0];g[7]=
e.quat[1];g[8]=e.quat[2];g[9]=e.quat[3];g[10]=e.jg[0];g[11]=e.jg[1];g[12]=e.jg[2];g[13]=e.Wf[0];g[14]=e.Wf[1];g[15]=e.Wf[2];a.Xf.push(g.buffer);break;case B:e=J;g=new Float32Array(e.len);g[0]=e.pe;g[1]=e.sv;g[2]=e.Xx;g[3]=e.trans[0];g[4]=e.trans[1];g[5]=e.trans[2];g[6]=e.quat[0];g[7]=e.quat[1];g[8]=e.quat[2];g[9]=e.quat[3];a.Xf.push(g.buffer);break;case r:e=N;g=new Float32Array(e.len);g[0]=e.pe;g[1]=e.id;g[2]=e.Hk;g[3]=e.hit_fract;g[4]=e.hit_time;a.Xf.push(g.buffer);break;case w:e=F;g=new Float32Array(e.len);
g[0]=e.pe;g[1]=e.id;g[2]=e.Hk;g[3]=e.hit_fract;g[4]=e.hit_time;g[5]=e.hit_pos[0];g[6]=e.hit_pos[1];g[7]=e.hit_pos[2];g[8]=e.hit_norm[0];g[9]=e.hit_norm[1];g[10]=e.hit_norm[2];a.Xf.push(g.buffer);break;case x:e=G;g=new Float32Array(e.len);g[0]=e.pe;g[1]=e.aj;g[2]=e.bj;g[3]=e.result;a.Xf.push(g.buffer);break;case k:e=D;g=new Float32Array(e.len);g[0]=e.pe;g[1]=e.aj;g[2]=e.bj;g[3]=e.result;g[4]=e.gj[0];g[5]=e.gj[1];g[6]=e.gj[2];g[7]=e.coll_norm[0];g[8]=e.coll_norm[1];g[9]=e.coll_norm[2];g[10]=e.coll_dist;
a.Xf.push(g.buffer);break;case q:e=H;g=new Float32Array(e.len);g[0]=e.pe;g[1]=e.J;g[2]=e.trans[0];g[3]=e.trans[1];g[4]=e.trans[2];g[5]=e.quat[0];g[6]=e.quat[1];g[7]=e.quat[2];g[8]=e.quat[3];a.Xf.push(g.buffer);break;default:g=[];for(e=1;e<arguments.length;e++)g.push(arguments[e]);a.Li.postMessage(g)}};a.kR=function(a){a&&a.Xf.length&&(a.Li.postMessage(a.Xf),a.Xf.length=0)};a.ID=function(a){switch(a){case f:return A;case B:return J;case r:return N;case w:return F;case x:return G;case k:return D;case q:return H;
default:return null}};a.terminate=function(a){a.Li.terminate();a.Li=null};a.yr=function(a){return!!a.Li};a.LE=function(a){return!!a.Re}};b4w.module.__transform=function(a,l){function m(a,d){f.Ye(a)?J.ff(d,f.We(a)):J.ff(d,a.g.i)}function b(a,d){var b=a.g;if(f.Ye(a)){J.ti(d,b.i);var e=f.ar(a),e=J.invert(e,h);J.multiply(e,b.i,f.We(a))}else J.ti(d,b.i)}function e(a,d){f.Ye(a)?J.ti(d,f.We(a)):J.ti(d,a.g.i)}function x(a,d){f.Ye(a)?J.copy(d,f.We(a)):J.copy(d,a.g.i)}function k(a,d){f.Ye(a)?J.copy(f.We(a),d):J.copy(a.g.i,d);return d}function B(a){var b=a.g,e=a.A,k=a.type;"CAMERA"==k&&w.wz(a);f.MT(a,M);"CAMERA"==k&&w.KT(a);var m=J.Xh(b.i,I),
v=J.Lw(b.i,d);b.R&&b.I&&(r.Hg(b.R,b.i,b.I),r.iv(b.Pe,b.i,b.Yc),r.Jk(b.Ha,b.i,b.na));for(var l=0;l<a.A.length;l++)for(var C=a.A[l].X,L=0;L<C.length;L++){var n=C[L];r.Hg(n.R,b.i,n.I);r.Jk(n.Ha,b.i,n.na)}switch(k){case "SPEAKER":A.US(a,M);break;case "CAMERA":for(l=0;l<e.length;l++)w.LT(a,e[l]);break;case "MESH":J.qT(a.g.i,a.g.Nz);a.AF&&J.invert(a.g.Nz,a.g.QI);if(C=a.dq)J.invert(C.g.i,h),J.multiply(h,b.i,h),H.set(h[0],h[1],h[2],h[3],b.Xu),g.set(h[4],h[5],h[6],h[7],b.Wu);b.tw=!0;break;case "LAMP":q.PT(a)}for(l=
0;l<e.length;l++)if(L=e[l],L.yr){C=L.Ta;n=C.j;switch(k){case "LAMP":z.jI(a,C);break;case "CAMERA":z.PR(C);if(n.Rc){n.Rc.enable_csm&&z.ry(C);var x=F.aa(a,C).U[0];z.$T(x,n.Pa)}z.o()==C&&A.pQ(C,m,v,M);break;case "MESH":b.R&&b.I&&(b.ye&&z.ry(C),n=L.Ng,null!=b.Qe&&n&&z.gI(n,m));break;case "EMPTY":N.NT(a)}n=L.og;x=a.Lo;if(x.length)for(L=0;L<n.length;L++){var O=n[L].k;z.kI(n[L],m,v);F.lI(x,O.kc);w.zS(O,z.fl(C));G.Rq(O.Rf,O.cl)}}b=a.zd;for(l=0;l<b.length;l++)B(b[l]);a=a.Ev;for(l=0;l<a.length;l++)b=a[l],C=
b[0],f.FT(C,b[1])}var r=l("__boundings"),w=l("__camera"),f=l("__constraints"),q=l("__lights"),g=l("__quat"),z=l("__scenes"),A=l("__sfx"),J=l("__tsr"),N=l("__objects"),F=l("__obj_util"),G=l("__util"),D=l("__vec3"),H=l("__vec4"),I=new Float32Array(3),d=new Float32Array(4);new Float32Array(9);var h=J.create(),v=J.create(),M=0;a.HA=0;a.wk=1;a.update=function(a){M=a};a.lc=function(a,d){var b=a.g;if(f.Ye(a)){J.ff(d,b.i);var e=f.ar(a),e=J.invert(e,h);J.multiply(e,b.i,f.We(a))}else J.ff(d,b.i)};a.Js=m;a.yf=
function(a,d){D.copy(J.q(a.g.i),d);return d};a.aE=function(a,d){f.Ye(a)?D.copy(J.q(f.We(a)),d):D.copy(J.q(a.g.i),d);return d};a.sg=b;a.Hs=e;a.jl=function(a,d){g.copy(J.B(a.g.i),d);return d};a.RD=function(a,d){f.Ye(a)?g.copy(J.B(f.We(a)),d):g.copy(J.B(a.g.i),d);return d};a.Jy=function(a,e){var f=G.Th(e,d);b(a,f)};a.Ky=function(a,b){var f=G.Th(b,d);e(a,f)};a.ve=function(a,d){var b=a.g;if(f.Ye(a)){var b=f.We(a),e=J.Pc(f.ar(a));J.ve(d/e,b)}else J.ve(d,b.i)};a.Ly=function(a,d){var b=a.g;f.Ye(a)?J.ve(d,
f.We(a)):J.ve(d,b.i)};a.Pc=function(a){return J.Pc(a.g.i)};a.TD=function(a){return f.Ye(a)?J.Pc(f.We(a)):J.Pc(a.g.i)};a.sh=function(a,d){J.copy(d,a.g.i);if(f.Ye(a)){var b=f.ar(a),b=J.invert(b,h);J.multiply(b,a.g.i,f.We(a))}};a.Ks=x;a.bo=function(a,d){return J.copy(a.g.i,d)};a.co=k;a.cr=function(a){var d=a.g;a=d.Gk;var b=J.Pc(d.i),d=b*(a.max_x-a.min_x),e=b*(a.max_y-a.min_y);a=b*(a.max_z-a.min_z);return.5*Math.sqrt(d*d+e*e+a*a)};a.br=function(a,d,b){b||(b=new Float32Array(3));d?(a=a.g,D.copy(a.Yc.O,
b)):(a=a.g,d=a.Gk,b[0]=(d.max_x+d.min_x)/2,b[1]=(d.max_y+d.min_y)/2,b[2]=(d.max_z+d.min_z)/2,J.Fc(b,a.i,b));return b};a.Ff=function(a,d,b,e){var f=k(a,h),g=I;g[0]=d;g[1]=b;g[2]=e;J.Fc(g,f,g);m(a,g)};a.oy=function(a,d){var b=k(a,h),e=J.ti(d,J.identity(v));J.multiply(b,e,e);x(a,e)};a.p=B;a.distance=function(a,d){return D.dist(J.q(a.g.i),J.q(d.g.i))};a.Jl=function(a,d){return D.dist(J.q(a.g.i),d)};a.MD=function(a){return{max_x:a.g.I.max_x,min_x:a.g.I.min_x,max_y:a.g.I.max_y,min_y:a.g.I.min_y,max_z:a.g.I.max_z,
min_z:a.g.I.min_z}}};b4w.module.__sfx=function(a,l){function m(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var c=new a}catch(d){return F.error('Unable to initialize AudioContext: "'+d+'". The audio is disabled.'),null}if(c.createGain)return c;F.warn("deprecated WebAudio implementation");return null}F.warn("WebAudio is not supported");return null}function b(a,c,d){var b=a.P;if("NONE"!=b.behavior){var f=b.loop,h=b.pitch;if(b.src&&(f||0<=d)){b.Zu=Math.floor(5E4*Math.random());var g=K.currentTime+c,g=
Math.max(0,g);b.ze=g;b.state=20;e(a);"POSITIONAL"==b.behavior||"BACKGROUND_SOUND"==b.behavior?(c=K.createBufferSource(),c.buffer=b.src,c.playbackRate.value=h,H.Bf(c.onended)&&(c.onended=function(){b.state=50}),f?(b.vc&&b.vc.disconnect(),c.loop=!0,c.start(g),b.duration=0):(f=c.buffer?c.buffer.duration:0,d>f?(f=g+d+b.ke,c.loop=!0,c.start(g),c.stop(f),b.duration=d):(c.loop=!1,c.start(g),b.duration=f)),c.connect(b.Jd),b.vc=c,k(b),B(b)):"BACKGROUND_MUSIC"==b.behavior&&(G.sq(b.cv),G.sq(b.dv),d=function(){var c=
a.P,d=c.src;d&&(d.volume=1,d.loop=c.loop,c.vc=c.vc||K.createMediaElementSource(d),c.vc.connect(c.Jd),20==c.state&&(d.currentTime&&(d.currentTime=0),d.play()))},0==c?d():b.cv=G.dH(d,1E3*c),b.duration=f?0:J(a));r(b,g)}}}function e(a){var c=a.P;if(!c.Jd){var d=D.q(a.g.i);a=D.B(a.g.i);if(h.Pr){var b=K.createBiquadFilter();b.type="peaking"}else b=null;var e=K.createGain();switch(c.behavior){case "POSITIONAL":var f=K.createPanner();"string"!=typeof f.panningModel?(f.panningModel=f.EQUALPOWER,f.distanceModel=
f.INVERSE_DISTANCE):(f.panningModel="equalpower",f.distanceModel="inverse");f.setPosition(d[0],d[1],d[2]);I.copy(d,c.jx);d=v;H.Cb(a,H.md,d);f.setOrientation(d[0],d[1],d[2]);I.copy(d,c.direction);f.refDistance=c.En;f.maxDistance=c.vf;f.rolloffFactor=c.Vm;f.coneInnerAngle=c.$B;f.coneOuterAngle=c.aC;f.coneOuterGain=c.bC;var g=K.createGain();g.gain.value=A(c);b?(f.connect(b),b.connect(g)):f.connect(g);g.connect(e);c.Jd=f;if(c.ok){var k=K.createGain();e.connect(k);k.connect(K?t.Va.Jd:null)}else k=null,
e.connect(K?t.Va.Jd:null);break;case "BACKGROUND_SOUND":f=null;g=K.createGain();g.gain.value=A(c);b?(c.Jd=b,b.connect(g)):c.Jd=g;g.connect(e);c.ok?(k=K.createGain(),e.connect(k),k.connect(K?t.Va.Jd:null)):(k=null,e.connect(K?t.Va.Jd:null));break;case "BACKGROUND_MUSIC":k=f=null,g=K.createGain(),g.gain.value=A(c),b?(c.Jd=b,b.connect(g)):c.Jd=g,g.connect(e),e.connect(K?t.Va.Jd:null)}c.Ao=f;c.dg=b;c.el=g;c.oj=e;c.nG=k}}function x(a){var c=a.P,d=c.duration,c=c.EC+c.FC*Math.random();b(a,c,d)}function k(a){a.ok&&
a.nG.gain.cancelScheduledValues(a.ze);a.Pl&&a.vc.playbackRate.cancelScheduledValues(a.ze);a.np=a.ze}function B(a){if(a.ok||a.Pl){var c=a.nG,d=a.vc,b=d.buffer?d.buffer.duration:0;if(b){var e=a.ze;u[0]=a.Zu;for(var f=0;5>f;){var h=a.pitch+a.Pl*H.ef(u);if(e>=a.np){if(a.ok){var g=1-H.S(a.ok,0,1)*Math.random();c.gain.setValueAtTime(g,e)}a.Pl&&d.playbackRate.setValueAtTime(h,e);f++}e+=b/h}a.np=e-.001}}}function r(a,c){if(a.pj||a.ke){var d=a.oj;d.gain.cancelScheduledValues(c);a.pj?(d.gain.setValueAtTime(0,
c),d.gain.linearRampToValueAtTime(1,c+a.pj)):d.gain.setValueAtTime(1,c);a.ke&&!a.loop&&(d.gain.setValueAtTime(1,c+a.duration),d.gain.linearRampToValueAtTime(0,c+a.duration+a.ke))}}function w(a){"SPEAKER"!=a.type&&H.l("Wrong object type");var c=a.P;if(50==c.state)c.state=30;else if(20==c.state||40==c.state){var d=c.oj,b=K.currentTime;c.ke&&(d.gain.setValueAtTime(d.gain.value,b),d.gain.linearRampToValueAtTime(0,b+c.ke));"BACKGROUND_MUSIC"==c.behavior?c.src&&(G.sq(c.cv),G.sq(c.dv),c.dv=G.dH(function(){var c=
a.P.src;c&&(c.currentTime&&(c.currentTime=0),c.pause())},1E3*c.ke)):(d=c.vc,c.duration<d.buffer.duration?c.ke&&20==c.state?d.stop(b+c.ke):20==c.state&&(d.stop(0),d.disconnect()):d.disconnect(),c.ze=0,c.Px=0,c.jv=0);c.state=30}}function f(a){a=a.P;if(20==a.state){var c=K.currentTime;a.Px=c;if("BACKGROUND_MUSIC"==a.behavior){var d=a.src;d&&d.pause()}else{if(c>a.ze){u[0]=a.Zu;for(var b=a.vc.buffer.duration,e=a.ze;e<c;)d=a.pitch+a.Pl*H.ef(u),e+=b/d;d*=b/d-(e-c)}else d=0;a.jv=d;a.vc.stop(0);a.vc.disconnect();
k(a)}a.state=40}}function q(a){var c=a.P;if(40==c.state){var d=K.currentTime;c.ze+=d-c.Px;"BACKGROUND_MUSIC"==c.behavior?c.src.play():(g(a),c.np=d,a=c.vc,H.Bf(a.onended)&&(a.onended=function(){c.state=50}),a.start(c.ze,c.jv),B(c));r(c,c.ze);c.state=20}}function g(a){a=a.P;var c=K.createBufferSource();c.loop=a.vc.loop;c.buffer=a.vc.buffer;c.playbackRate.value=a.vc.playbackRate.value;a.Ao?c.connect(a.Ao):c.connect(a.el);a.vc=c}function z(a){a=a.P;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=
a.state?!1:!0}function A(a){return a.muted?0:a.volume}function J(a){a=a.P;return(a=a.src)?a.duration:0}var N=l("__config"),F=l("__print"),G=l("__time"),D=l("__tsr"),H=l("__util"),I=l("__vec3"),d=N.v,h=N.P;a.Tz=10;a.xt=20;a.Sz=30;var v=new Float32Array(3),M=new Float32Array(3),c=new Float32Array(3),p=[],R=[],K=null,t=null,y=[],u=[1],C=null;a.kN=function(){return{Gi:-1,cg:"",behavior:"NONE",kj:!1,muted:!1,volume:1,pitch:1,Vm:1,En:1,vf:1E4,$B:360,aC:360,bC:1,nd:!1,loop:!1,EC:0,FC:0,ok:0,Pl:0,pj:0,ke:0,
ze:0,Px:0,jv:0,duration:0,np:0,Zu:1,src:null,state:10,jx:new Float32Array(3),direction:new Float32Array(3),Xy:new Float32Array(3),cv:-1,dv:-1,nj:0}};a.zf=function(){var a=document.createElement("audio"),c=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(p.push("ogg"),p.push("ogv"),p.push("oga")),""!=a.canPlayType("audio/mpeg")&&p.push("mp3"),""!=a.canPlayType("audio/mp4")&&(p.push("mp4"),p.push("m4v"),p.push("m4a")),""!=a.canPlayType("audio/webm")&&p.push("webm"));
c.canPlayType&&(""!=c.canPlayType("video/ogg")&&(R.push("ogv"),R.push("ogg"),R.push("oga")),""!=c.canPlayType("video/mp4")&&(R.push("m4v"),R.push("mp4")),""!=c.canPlayType("video/webm")&&R.push("webm"),""!=c.canPlayType("video/mpeg")&&R.push("mp3"));(K=h.Jz?m():null)&&F.log("%cINIT WEBAUDIO: "+K.sampleRate+"Hz","color: #00a")};a.oB=function(a){var c={Jj:new Float32Array(3),fF:new Float32Array(3),wl:new Float32Array(3)};a.Va=c;if(K){var b=K.createGain(),e=K.createGain();c.el=b;c.oj=e;b.connect(e);
e.connect(K.destination);if(a.b4w_enable_dynamic_compressor){var e=K.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;e.threshold.value=f.threshold;e.knee.value=f.knee;e.ratio.value=f.ratio;e.attack.value=f.attack;e.release.value=f.release;e.connect(b);c.qn=e;c.Jd=e}else c.qn=null,c.Jd=b;b=K.listener;c.kj=d.fw;c.kj||(b.dopplerFactor=a.audio_doppler_factor,b.speedOfSound=a.audio_doppler_speed);c.muted=!1;c.volume=1;c.nj=0}};a.SR=function(a){t=a};a.KN=function(a){a||(a="ogg");return-1<
p.indexOf(a)?a:-1<p.indexOf("m4a")?"m4a":-1<p.indexOf("oga")?"oga":""};a.MN=function(a){a||(a="webm");return-1<R.indexOf(a)?a:-1<R.indexOf("m4v")?"m4v":-1<R.indexOf("webm")?"webm":""};a.Fi=function(a,c){var b=a.data,e=c.P;e.Gi=a.data.sound.uuid;e.cg=a.data.sound.filepath;switch(b.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":e.behavior=K?b.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var f;K?(window.MediaElementAudioSourceNode?f=!0:(F.warn("MediaElementAudioSourceNode not found"),f=
!1),f=f&&!d.RB?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):f="NONE";e.behavior=f;break;default:H.l("Wrong speaker behavior")}b.sound||(e.behavior="NONE");e.kj=b.b4w_disable_doppler||d.fw;e.muted=b.muted;e.volume=b.volume;e.pitch=b.pitch;e.Vm=b.attenuation;e.En=b.distance_reference;e.vf=b.distance_max||1E4;e.$B=b.cone_angle_inner;e.aC=b.cone_angle_outer;e.bC=b.cone_volume_outer;e.nd=b.b4w_cyclic_play;e.loop=b.b4w_loop;e.EC=b.b4w_delay;e.FC=b.b4w_delay_random;e.ok=b.b4w_volume_random;e.Pl=b.b4w_pitch_random;
e.pj=b.b4w_fade_in;e.ke=b.b4w_fade_out;y.push(c)};a.sH=function(c){"SPEAKER"!=c.type&&H.l("Wrong object type");switch(c.P.behavior){case "POSITIONAL":return a.xt;case "BACKGROUND_SOUND":return a.xt;case "BACKGROUND_MUSIC":return a.Sz;case "NONE":return a.Tz;default:H.l("Wrong speaker behavior")}};a.bU=function(a,c){var d=a.P;switch(d.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":d.src=c;break;case "NONE":break;default:H.l("Wrong speaker behavior")}};a.$F=function(){var a=
K.createBufferSource();a.buffer=K.createBuffer(1,22050,22050);a.connect(K.destination);a.start(0)};a.FN=function(a,c,d){K?K.decodeAudioData(a,c,d):d()};a.TS=function(a){w(a);a.P=null;y.splice(y.indexOf(a),1)};a.ha=function(){for(var a=0;a<y.length;a++){var c=y[a].P;"BACKGROUND_MUSIC"==c.behavior?(c=c.src)&&c.pause():c.vc&&c.vc.disconnect()}t&&t.Va&&(a=t.Va,a.Jj[0]=0,a.Jj[1]=0,a.Jj[2]=0,a.wl[0]=0,a.wl[1]=0,a.wl[2]=0);t=null;y.splice(0);C=null};a.update=function(a){if(K&&0!=y.length){for(var c=0;c<
y.length;c++){var d=y[c],b=d.P,e=b.vc,f=K.currentTime;!b.loop&&20==b.state&&b.duration&&b.ze+b.duration<f&&("BACKGROUND_MUSIC"==b.behavior||e&&!H.Bf(e.onended))&&(b.state=50);b.nd&&50==b.state&&x(d);20==b.state&&3>b.np-f&&B(b)}C&&C.th.length&&(-1==C.Ub||a>C.bB+C.JC[C.Ub])&&(c=C,-1<c.Ub&&w(c.th[c.Ub]),-1==c.Ub&&c.random?d=Math.round(Math.random()*(c.th.length-1)):c.random?(d=1+Math.round(Math.random()*(c.th.length-2)),d=(c.Ub+d)%c.th.length):d=(c.Ub+1)%c.th.length,x(c.th[d]),c.Ub=d,c.bB=a)}};a.play=
b;a.ZF=x;a.stop=w;a.VP=function(a){return 20==a.P.state};a.P1=f;a.S1=q;a.jR=function(a,c){var d=a.P;d.pitch=c;!z(a)||"POSITIONAL"!=d.behavior&&"BACKGROUND_SOUND"!=d.behavior||(d.vc.playbackRate.value=c,k(d),B(d))};a.BZ=function(a){return a.P.pitch};a.nd=function(a,c){a.P.nd=Boolean(c)};a.JE=function(a){return a.P.nd};a.pQ=function(a,d,b,e){if(K&&a.Va){var f=v;f[0]=0;f[1]=-1;f[2]=0;I.transformQuat(f,b,f);M[0]=0;M[1]=0;M[2]=-1;I.transformQuat(M,b,M);b=K.listener;b.setPosition(d[0],d[1],d[2]);b.setOrientation(f[0],
f[1],f[2],M[0],M[1],M[2]);I.copy(f,a.Va.fF);!a.Va.kj&&e&&(c[0]=(d[0]-a.Va.Jj[0])/e,c[1]=(d[1]-a.Va.Jj[1])/e,c[2]=(d[2]-a.Va.Jj[2])/e,H.bm(c,a.Va.wl,e,.3,c),b.setVelocity(c[0],c[1],c[2]),I.copy(c,a.Va.wl));I.copy(d,a.Va.Jj)}};a.S_=function(a,c){if(K&&t.Va&&!t.Va.kj){var d=v;c?I.copy(c,d):I.copy(t.Va.fF,d);I.scale(d,a,d);K.listener.setVelocity(d[0],d[1],d[2]);I.copy(d,t.Va.wl)}};a.US=function(a,c){var d=a.P;if(z(a)&&"POSITIONAL"==d.behavior){var b=D.q(a.g.i),e=D.B(a.g.i),f=d.Ao;f.setPosition(b[0],b[1],
b[2]);var h=v;H.Cb(e,H.md,h);f.setOrientation(h[0],h[1],h[2]);e=d.jx;!d.kj&&c&&(M[0]=(b[0]-e[0])/c,M[1]=(b[1]-e[1])/c,M[2]=(b[2]-e[2])/c,H.bm(M,d.Xy,c,.3,M),f.setVelocity(M[0],M[1],M[2]),I.copy(M,d.Xy));I.copy(b,e)}};a.Q1=function(a,c,d){var b=a.P;if(z(a)&&"POSITIONAL"==b.behavior&&!b.kj){var e=v;d?I.copy(d,e):I.copy(b.direction,e);I.scale(e,c,e);b.Ao.setVelocity(e[0],e[1],e[2]);I.copy(e,b.Xy);I.copy(D.q(a.g.i),b.jx)}};a.Nw=function(a){return a.P.behavior};a.$W=function(){for(var a=0;a<y.length;a++)if(z(y[a]))return!0;
return!1};a.i1=function(a){var c=t.Va;c&&(c.volume=a,K&&(c.el.gain.value=A(c)))};a.lZ=function(){var a=t.Va;return a?a.volume:0};a.AS=function(a,c){var d=a.P;d.volume=c;z(a)&&(d.el.gain.value=A(d))};a.YZ=function(a){return a.P.volume};a.Nj=function(a,c){a.P.muted=Boolean(c);z(a)&&(a.P.el.gain.value=A(a.P))};a.M_=function(a){return a.P.muted};a.b0=function(a){var c=t.Va;c&&(c.muted=Boolean(a),K&&(c.el.gain.value=A(c)))};a.L_=function(){var a=t.Va;return a?a.muted:!1};a.mP=function(){return y};a.pause=
function(){for(var a=0;a<y.length;a++)f(y[a])};a.oh=function(){for(var a=0;a<y.length;a++)q(y[a])};a.V0=function(a,c){if(a.Va&&a.Va.qn){var d=a.Va.qn;d.threshold.value=c.threshold;d.knee.value=c.knee;d.ratio.value=c.ratio;d.attack.value=c.attack;d.release.value=c.release}};a.NY=function(a){if(!a.Va||!a.Va.qn)return null;a=a.Va.qn;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.SX=function(a,c,d){if(z(a)){a=a.P;var b=a.oj,e=
K.currentTime;b.gain.setValueAtTime(b.gain.value,e);b.gain.linearRampToValueAtTime(c,e+d);a.nj=d}};a.x2=function(a){if(z(a)){a=a.P;var c=a.oj,d=K.currentTime;c.gain.setValueAtTime(c.gain.value,d);c.gain.linearRampToValueAtTime(1,d+a.nj);a.nj=0}};a.TX=function(a,c){if(K){var d=t.Va,b=d.oj,e=K.currentTime;b.gain.setValueAtTime(b.gain.value,e);b.gain.linearRampToValueAtTime(a,e+c);d.nj=c}};a.y2=function(){if(K){var a=t.Va,c=a.oj,d=K.currentTime;c.gain.setValueAtTime(c.gain.value,d);c.gain.linearRampToValueAtTime(1,
d+a.nj);a.nj=0}};a.IW=function(a,c,d){C={Ub:-1,bB:0,random:d,th:[],JC:[]};for(d=0;d<a.length;d++){var b=a[d],e=J(b);0==e?F.warn("Ignoring speaker with zero duration: "+b.name):(w(b),b.P.nd=!1,C.th.push(b),C.JC.push(e+c))}};a.RY=J;a.tX=function(){if(C)for(var a=C.th,c=0;c<a.length;c++)w(a[c]);C=null};a.EZ=function(a){return(a=a.P)&&"POSITIONAL"==a.behavior?{dist_ref:a.En,dist_max:a.vf,attenuation:a.Vm}:null};a.t1=function(a,c){var d=a.P;if(d&&"POSITIONAL"==d.behavior){d.En=c.dist_ref;d.vf=c.dist_max;
d.Vm=c.attenuation;var b=d.Ao;b&&(b.refDistance=d.En,b.maxDistance=d.vf,b.rolloffFactor=d.Vm)}};a.a1=function(a,c){var d=a.P;d&&d.dg&&(d.dg.frequency.value=c.freq,d.dg.Q.value=c.Q,d.dg.gain.value=c.gain)};a.XY=function(a){return(a=a.P)&&a.dg?{freq:a.dg.frequency.value,Q:a.dg.Q.value,gain:a.dg.gain.value}:null};a.WY=function(a,c,d,b){a=a.P;if(!a||!a.dg)return null;a.dg.getFrequencyResponse(c,d,b)}};"object"==typeof module&&module.nw&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function l(){var a=m,b=a.getDate(),b=10>b?"0"+String(b):String(b),k=a.getMonth()+1,k=10>k?"0"+String(k):String(k),l=String(a.getFullYear()),r=a.getHours(),r=10>r?"0"+String(r):String(r),w=a.getMinutes(),w=10>w?"0"+String(w):String(w),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return b+"."+k+"."+l+" "+r+":"+w+":"+a}var m=new Date(2016,6,22,9,48,0),b=[16,6];a.version=function(){return b};a.Cz=function(){for(var a="",m=0;m<b.length;m++)a=1==m?a+(10>b[m]?"0"+b[m]:
b[m]):a+b[m],m!=b.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.xC=function(){return m};a.Xv=l;a.timestamp=function(){var a=l(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.nw&&b4w.module.__version(exports);b4w.module.__prerender=function(a,l){function m(a,b){var e=a.mg,g=a.G;e.Er=!1;if(e.zj)return!1;var k=b.k,m="SHADOW_CAST"==b.type?k.iF:r.Xh(k.i,A),q=e.Yc.O,d=e.ei,m=Math.sqrt((q[0]-m[0])*(q[0]-m[0])+(q[1]-m[1])*(q[1]-m[1])+(q[2]-m[2])*(q[2]-m[2]));if(!(m<e.uo?0:d==f.Yz||m<d+e.xl*e.Yc.mb))return!1;e.Er=!0;(d="OUTLINE_MASK"==b.type&&!Boolean(e.lh))||(e.mj?d=!1:(e=g.na,d=w.XN(e.O,k.cl,e.$d,e.ae,e.be)));return d?!1:"DEBUG_VIEW"==b.type?b.debug_view_mode==x.yp?a.G.jj:!a.G.jj:!0}function b(a){var b=a.Qa;
if(b&&b.OQ){a=a.oa;k.BQ(a);var e=a.sd,f=a.ed,g=f.a_normal;e.set(b.Vx,f.a_position.offset);e.set(b.Ix,g.offset);k.iI(a)}}var e=l("__config"),x=l("__debug"),k=l("__geometry"),B=l("__renderer"),r=l("__tsr"),w=l("__util"),f=l("__objects"),q=l("__vec3"),g=e.v,z="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_PLANE_REFLECT_BLEND MAIN_CUBE_REFLECT_BLEND MAIN_GLOW SHADOW_CAST SHADOW_RECEIVE OUTLINE_MASK DEBUG_VIEW COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" "),A=new Float32Array(3);
a.os=function(a){if(-1<z.indexOf(a.type)){for(var e=!1,f=a.D,l=0;l<f.length;l++){var w=f[l],x=w.G;if("MAIN_CUBE_REFLECT"==a.type||"MAIN_CUBE_REFLECT_BLEND"==a.type)for(var I=0;6>I;I++)a.k.cl=a.wn[I],w.iw[I]=m(w,a),w.iw[I]&&(e=!0,b(x));else w.ec=m(w,a),w.ec&&(e=!0,b(x));a.ra&&(x.rb.Tr=!0)}a.ra=!1;switch(a.type){case "DEBUG_VIEW":break;default:"MAIN_OPAQUE"===a.type||"SHADOW_RECEIVE"===a.type||"MAIN_GLOW"===a.type||"MAIN_PLANE_REFLECT"===a.type||"MAIN_CUBE_REFLECT"===a.type||e?a.ec=!0:(a.ec&&B.clear(a),
a.ec=!1)}}else if(a.ra){f=a.D;for(l=0;l<f.length;l++)a.ra&&(f[l].G.rb.Tr=!0);a.ra=!1}if("MAIN_BLEND"==a.type&&g.alpha_sort&&a.D)for(e=r.Xh(a.k.i,A),f=0;f<a.D.length;f++)if(w=a.D[f],w.ec){l=w.mg;if((w=w.G)&&w.Tf){w=w.oa;if(!w)continue;var x=w.ur,I=q.dist(e,x.SI),d=g.alpha_sort_threshold*Math.min(x.IL,1);if(!(I>d||l.tw))continue;k.HT(w,l.i,e);q.copy(e,x.SI)}l.tw=!1}}};b4w.module.__primitives=function(a,l){function m(a,b,e,k){for(var m=[],l=[],w=[],B=[],x=2*e/(a-1),D=2*k/(b-1),H=0;H<a;H++)for(var I=-e+H*x,d=0;d<b;d++)if(l.push(I,0,-k+d*D),w.push(0,1,0),B.push(H/(a-1),d/(b-1)),H&&d){var h=H*b+d,v=h-1,M=(H-1)*b+d,c=M-1;m.push(h,v,M);m.push(v,c,M)}a=r.sf();a.a_position=new Float32Array(l);a.a_normal=new Float32Array(w);w=r.Cc("GRID_PLANE");w.N[0]=a;w.ba.a_texcoord=new Float32Array(B);w.ab=new Uint32Array(m);w.wa=l.length/3;return w}function b(a){var b=a.length;b%4&&
r.l("Wrong array");for(var e=[],k=[],m=0;m<b;m+=4){var l=a[m+1],w=a[m+2],B=a[m+3];x(a[m],k);x(l,k);x(w,k);x(B,k);e.push(m,m+1,m+2);e.push(m,m+2,m+3)}a=r.sf();a.a_position=new Float32Array(k);b=r.Cc("FROM_QUADS");b.N[0]=a;b.ab=new Uint32Array(e);b.wa=k.length/3;return b}function e(a,b){var e=3*b;return[a[e],a[e+1],a[e+2]]}function x(a,b){b.push(a[0],a[1],a[2])}var k=l("__config"),B=l("__geometry");l("__print");var r=l("__util"),w=k.v;a.JO=function(){var a=r.Cc("LINE"),b=r.sf();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.N[0]=b;a.ab=new Uint32Array(1);a.wa=1;return a};a.DY=function(a,b){var e=m(2,2,a,b);e.name="PLANE";return e};a.CY=m;a.MO=function(a,b,e){function k(a,c){return 1==a%2&&(0==c||c==F-1)||1==c%2&&(0==a||a==x-1)?!0:!1}var m=e/=Math.pow(2,a-1),l=e,x=b+1,F=b+1;b=[];e=[];for(var G=[],D=[],H=0,I=0,d=-1,h=[],v=0;v<a;v++){for(var M=2*m/(x-1),c=2*l/(F-1),p=[],R=[],K=0,t=0;t<x;t++){for(var y=-m+t*M,u=[],C=0;C<F;C++){var L=-l+C*c;if(y>-H&&y<H&&L>-I&&L<I)u.push(-1),K++;else{for(var n=
null,T=0;T<h.length;T+=3)if(y==h[T]&&L==h[T+1]){n=h[T+2];break}T=null!==n?n:d+1;k(t,C)?(u.push(-2),K++):(null==n&&(0==C||C==F-1||0==t||t==x-1?(n=v==a-1?M:2*M,p.push(y,L,T)):n=M,e.push(y,n,L),D.push(0,1,0),G.push(1,0,0),d++),u.push(T));if(t&&C)if(1==t)if(k(t-1,C)){if(1<C){var L=T-1,n=R[t-1][C+1],O=n-1;b.push(T,L,O)}else n=R[t-1][C+1],O=n-1;b.push(T,O,n)}else k(t,C)||(L=T-1,n=R[t-1][C],b.push(T,L,n));else if(t==x-1){if(!k(t,C))if(C==F-1)L=T-1,n=R[t-1][C-1],O=R[t-2][C],b.push(T,L,n),b.push(T,n,O);else{var L=
T-1,n=R[t-1][C],O=n-1,V=n+1;b.push(T,L,O);b.push(T,O,n);b.push(T,n,V);2==C&&(V=R[t-2][C-2],b.push(L,V,O))}}else 1==C?k(t,C-1)?(L=R[t-1][C],n=R[t-1][C-1],b.push(T,n,L)):(L=u[C-1],n=R[t-1][C],O=R[t-2][C-1],b.push(T,L,n),b.push(L,O,n)):C==F-1?k(t,C)||(L=u[C-1],n=R[t-1][C-1],O=R[t-2][C],b.push(T,L,n),b.push(T,n,O)):-1!=R[t-1][C]&&-1!=R[t-1][C-1]&&-1!=u[C-1]?(L=u[C-1],n=R[t-1][C],O=R[t-1][C-1],b.push(T,L,n),b.push(L,O,n),C==F-2&&k(t,C+1)&&(V=R[t-1][C+1],b.push(T,n,V))):C==F-2&&k(t,C+1)&&(n=R[t-1][C],V=
R[t-1][C+1],b.push(T,n,V))}}R.push(u)}h=p;H=m;I=l;m*=2;l*=2}if(2E4>H)for(a=-(2*H)/(x-1),e.push(-2E4,a,-2E4),e.push(-2E4,a,2E4),e.push(-H,a,-I),e.push(-H,a,I),e.push(2E4,a,-2E4),e.push(2E4,a,2E4),e.push(H,a,-I),e.push(H,a,I),T=d+1,b.push(T+3,T+2,T+1,T+2,T+0,T+1,T+6,T+4,T+2,T+4,T+0,T+2,T+5,T+7,T+1,T+7,T+3,T+1,T+5,T+4,T+7,T+7,T+4,T+6),t=0;8>t;t++)D.push(0,1,0),G.push(1,0,0);a=r.sf();a.a_position=new Float32Array(e);a.a_tangent=new Float32Array(G);a.a_normal=new Float32Array(D);m=r.Cc("multigrid_plane");
m.N[0]=a;m.ab=new Uint32Array(b);m.wa=e.length/3;w.LI&&(B.Zs(m,1,!0),a.a_polyindex=B.Sq(m));return m};a.BY=function(a){var b=a.length;b%3&&r.l("Wrong array");for(var e=[],k=[],m=0;m<b;m+=3){var l=a[m+1],w=a[m+2];x(a[m],k);x(l,k);x(w,k);e.push(m,m+1,m+2)}a=r.sf();a.a_position=new Float32Array(k);b=r.Cc("FROM_TRIANGLES");b.N[0]=a;b.ab=new Uint32Array(e);b.wa=k.length/3;return b};a.AY=b;a.GO=function(a){a=r.yU(a);var e=[];e.push(a[0],a[1],a[2],a[3]);e.push(a[0],a[3],a[5],a[4]);e.push(a[3],a[2],a[6],
a[5]);e.push(a[1],a[7],a[6],a[2]);e.push(a[0],a[4],a[7],a[1]);e.push(a[4],a[5],a[6],a[7]);a=b(e);a.name="FRUSTUM";return a};a.tc=function(){var a=r.Cc("FULLSCREEN_TRI"),b=r.sf();b.a_position=new Float32Array([0,0,1,0,0,1]);a.N[0]=b;a.ab=new Uint32Array([0,1,2]);a.wa=3;return a};a.HO=function(){var a=r.Cc("FULLSCREEN_QUAD"),b=r.sf();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.N[0]=b;a.ab=new Uint32Array([0,2,1,1,2,3]);a.wa=4;return a};a.CO=function(){var a=r.Cc("BILLBOARD"),b=r.sf();b.a_bb_vertex=
new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.N[0]=b;a.ab=new Uint32Array([0,2,1,0,3,2]);a.wa=4;return a};a.DO=function(){var a=r.Cc("CUBEMAP_BOARD"),b=r.sf();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.N[0]=b;a.ab=new Uint32Array([0,2,1,0,3,2]);a.wa=4;return a};a.yw=function(a,b){var g=r.Cc("UV_SPHERE"),k,m,l=[],w=[],F=[];for(m=0;8>=m;m++)for(k=0;16>=k;k++){var G=k/16,D=m/8;w.push(-a*Math.cos(2*G*Math.PI)*Math.sin(D*Math.PI)+b[0],a*Math.cos(D*Math.PI)+b[1],a*Math.sin(2*G*Math.PI)*
Math.sin(D*Math.PI)+b[2])}for(m=G=0;8>m;m++)for(k=0;16>k;k++){var D=e(w,17*m+k+1),H=e(w,17*m+k),I=e(w,17*(m+1)+k),d=e(w,17*(m+1)+k+1);Math.abs(D[1])==a+b[1]?(x(D,l),x(I,l),x(d,l),F.push(G,G+1,G+2),G+=3):Math.abs(I[1])==a+b[1]?(x(D,l),x(H,l),x(I,l),F.push(G,G+1,G+2),G+=3):(x(D,l),x(H,l),x(I,l),x(d,l),F.push(G,G+1,G+2),F.push(G,G+2,G+3),G+=4)}k={};k.a_position=l;w=B.YL(F,w,l);k.a_normal=B.WL(F,l,w);k.a_tangent=[];g.ba.a_influence=[];g.ba.a_color=[];g.ba.a_texcoord=[];g.N[0]=k;g.ab=F;g.wa=l.length/3;
return g};a.iD=function(a){var b=r.Cc("INDEX"),e=r.sf();e.a_index=new Float32Array(a);for(var k=0;k<a;k++)e.a_index[k]=k;b.N[0]=e;b.ab=new Uint16Array(0);b.wa=a;return b}};b4w.module.__scenegraph=function(a,l){function m(a){var c=a.je;a.je=null;var d=za.ia(a);d.je=c;a.je=c;d.Ve=null;d.Wb=null;d.he=null;return d}function b(a,c){var d=[];P.Pf(a,function(c,b,e){-1<d.indexOf(e)?P.FR(a,c,b,e,M(e)):d.push(e)});P.ma(a,function(a,b){for(var e=0;e<b.Ga.length;e++){var f=b.Ga[e];c||"MAIN_PLANE_REFLECT"!=b.type&&"MAIN_CUBE_REFLECT"!=b.type&&"MAIN_XRAY"!=b.type||(f.Ud=!0);-1<d.indexOf(f)?b.Ga[e]=M(f):d.push(f)}})}function e(a,c){P.ma(a,function(d,b){"ANTIALIASING"==b.type&&P.xg(a,
d,function(a,c){if("MOTION_BLUR"==c.type)for(var d=0;d<c.Ga.length;d++){var b=c.Ga[d];b.Na=ca.F;b.Ma=ca.F}});c||P.xg(a,d,function(a,c,d){"DEPTH"==d.from&&(d.Ud=!0)})});P.ma(a,function(c){var d={};x(a,c,d);for(var b in d){c=d[b];for(var e=c[0],f=0;f<c.length;f++)if(c[f].Na==ca.F){e=c[f];break}for(var h=c[0],f=0;f<c.length;f++)if(c[f].Ma==ca.F){h=c[f];break}for(var g=c[0],f=0;f<c.length;f++)if(!c[f].Ud){g=c[f];break}for(f=0;f<c.length;f++)c[f].Na=e.Na,c[f].Ma=h.Ma,c[f].Ud=g.Ud}})}function x(a,c,d){P.xg(a,
c,function(c,b,e){e.Ub&&e.from==e.to&&(d[e.from]=d[e.from]||[],-1==d[e.from].indexOf(e)&&d[e.from].push(e),x(a,c,d))});P.Ci(a,c,function(a,c,b){b.Ub&&(d[b.from]=d[b.from]||[],-1==d[b.from].indexOf(b)&&d[b.from].push(b))});c=P.Ra(a,c);if("MOTION_BLUR"==c.type)for(var b=0;b<c.Ga.length;b++){var e=c.Ga[b];d[e.from].push(e)}}function k(a){var c=["MOTION_BLUR","SMAA_RESOLVE","SMAA_NEIGHBORHOOD_BLENDING","MAIN_PLANE_REFLECT","MAIN_CUBE_REFLECT"],d=P.pz(a),b=[];P.ma(d,function(a,e){for(var h=0;h<e.Ga.length;h++){var g=
e.Ga[h];-1<c.indexOf(e.type)&&(g.jt=!0);var k=q(b,g,B(g));g.Ja=k;e.vg[h]=k}for(h=0;h<e.vg.length;h++)k=e.vg[h],f(b,k);P.Ci(d,a,function(f,h,g){-1<c.indexOf(e.type)&&(g.jt=!0);g.Ja||((f=r(d,a,g.from))&&g.Ub&&!g.Ja?w(b,f):f=q(b,g,B(g)),g.Ja=f)});P.xg(d,a,function(a,c,d){f(b,d.Ja)});P.Ci(d,a,function(a,c,d){d.Ja&&"NONE"==d.to&&f(b,d.Ja)})})}function B(a){a=za.Ph(a);delete a.to;delete a.Ub;delete a.Ja;return JSON.stringify(a)}function r(a,c,d){var b=null;P.xg(a,c,function(a,c,e){if(e.Ub&&e.from==e.to&&
e.from==d&&e.Ja)return b=e.Ja,!0});P.Ci(a,c,function(a,c,e){if(e.Ub&&e.from==d&&e.Ja)return b=e.Ja,!0});return b}function w(a,c){for(var d=0;d<a.length;d++){var b=a[d];b.lz===c&&b.Jo++}}function f(a,c){for(var d=0;d<a.length;d++){var b=a[d];b.lz===c&&b.Jo&&b.Jo--}}function q(a,c,d){if(c.Co)return w(a,c.Co.Ja),c.Co.Ja;if(c.jt)return g(c);for(var b=null,e=0;e<a.length;e++){var f=a[e];if(f.id==d&&0===f.Jo){b=f;break}}if(b&&!ma.RC)return b.Jo++,b.lz;c=g(c);a.push({id:d,Jo:1,lz:c});return c}function g(a){var c=
a.ek*a.size,d=a.fk*a.size;switch(a.from){case "COLOR":if(a.Ud){var b=ca.un("COLOR_RB",a.gi?ca.Tp:ca.Sp);ca.resize(b,c,d)}else b=ca.un("COLOR",ca.Ti),ca.resize(b,c,d),ca.Ay(b,a.Na,a.Ma);return b;case "DEPTH":return a.Ud?(b=ca.un("DEPTH_RB",a.gi?ca.Rp:ca.Qp),ca.resize(b,c,d)):(b=ca.un("DEPTH_TEX",ca.xk),ca.resize(b,c,d),ca.Ay(b,a.Na,a.Ma)),b;case "CUBEMAP":return b=ca.TM(c);case "SCREEN":case "NONE":return null;default:za.l("Wrong slink param: "+a.from)}}function z(a,c){var d=!1;P.Pf(a,function(b,e,
f){if(f&&(b=P.Ra(a,b),e=P.Ra(a,e),c(f,!1,b,e)))return d=!0});d||P.ma(a,function(a,d){for(var b=0;b<d.Ga.length;b++)if(c(d.Ga[b],!0,d,null))return!0})}function A(a){P.ma(a,function(c,d){if("SINK"!=d.type){var b=d.k;P.Ci(a,c,function(a,c,d){d.Ub&&d.Ja&&(U.As(b,d.from,d.Ja),d.from==d.to&&c.k&&U.As(c.k,d.from,d.Ja))});for(var e=0;e<d.Ga.length;e++){var f=d.Ga[e];f.Ub&&f.from==f.to&&U.As(b,f.from,d.vg[e])}!b.Wb&&!b.he||b.Ve||(b.Ve=pa.BR(b.Wb,b.he))}});P.ma(a,function(c,d){if("RESOLVE"==d.type||"COPY"==
d.type){var b=Ba(a,d);d.k.uw=b[0].k.Ve}})}function J(a){var c=null,d=0;P.ma(a,function(a,b){if(b.type==Aa.hT){if(d==Aa.gT)return c=b,!0;d++}});return c}function N(a,c){var d=P.Gf(a,c),b=p("NONE"),e=P.C(a,b),f=P.$n(a)[0];P.Pf(a,function(c,d){d==f&&P.uR(a,c,f,c,e)});var h=F(c,a);P.Pf(a,function(e,f,g){if(e==d){if(h){e=y();P.C(a,e);f=v("COLOR","RESOLVE",1,1,1,!0);f.gi=!0;f.Ud=!0;var k=v("DEPTH","RESOLVE",1,1,1,!0);k.gi=!0;k.Ud=!0;P.m(a,c,e,f);P.m(a,c,e,k);c=e}P.m(a,c,b,v(Aa.NS,"u_color",g.size,g.ek,
g.fk,g.dp));return!0}});P.Wc(a,e,f,v("SCREEN","NONE",.5,.5,.5,!0))}function F(a,c){var d=!1,b=P.Gf(c,a);P.ng(c,b)&&(d=P.fg(c,b,0),b=P.me(c,b,d,0),"COLOR"==b.from&&"COLOR"==b.to||"DEPTH"==b.from&&"DEPTH"==b.to?(b=P.Ra(c,d),d=F(b,c)):d="RESOLVE"==b.to);return d}function G(a,c,d,b){for(var e=d.U,f=c.fo,g=c.pg.og,k=c.pg.ms,n=P.Ys(a,P.hP(a,b),P.tp),p=[],m=[],l=[],n=P.clone(n,function(c){var b;if(-1<Ka.indexOf(c.type))m.push(c),b=c;else{b=h(c);if("MAIN_PLANE_REFLECT"==b.type)for(var n=0;n<g.length;n++)if(g[n][0]==
c){g[n]=[c,b];b.k.kc=c.k.kc;d.U.push(b.k);break}if("MAIN_PLANE_REFLECT_BLEND"==c.type)for(n=0;n<g.length;n++){if(k[n][0]==c){k[n]=[c,b];b.k=g[n][1].k;break}}else-1<e.indexOf(c.k)&&(f?(U.Mr(c.k,U.wd),U.Mr(b.k,U.xd)):(U.Mr(c.k,U.cc),U.Mr(b.k,U.pc)),e.push(b.k));var v=P.Gf(a,c);P.xg(a,v,function(a,c,d){-1<Ka.indexOf(c.type)&&p.push([c,b,d])});for(n=0;n<c.Ga.length;n++)b.Ga[n].Co=c.Ga[n];c=!0;for(n=0;n<P.sr(a,v);n++){var q=P.wj(a,v,n),q=P.Ra(a,q);-1==Ka.indexOf(q.type)&&(c=!1)}c&&l.push(b)}return b},
function(a){var c=M(a,!0);c.Co=a;return c}),q=0;q<m.length;q++)P.Kf(n,P.Gf(n,m[q]));P.wv(n);c=ka(f);var q=P.C(a,c),t=E();P.C(a,t);var r=v("COLOR","COPY",1,1,1,!0);P.m(a,b,t,r);var u=v("COLOR","u_sampler_left",1,1,1,!0);u.jt=!0;u.Na=ca.F;u.Ma=ca.F;P.m(a,t,c,u);b.Zb||(b=E(),P.C(n,b),u=v("COLOR","COPY",1,1,1,!0),u.Co=r,r=P.$n(n)[0],r=P.Ra(n,r),P.m(n,r,b,u));b=v("COLOR","u_sampler_right",1,1,1,!0);b.Na=ca.F;b.Ma=ca.F;P.iL(n,a,[P.$n(n)[0],q,b]);for(q=0;q<p.length;q++)P.m(a,p[q][0],p[q][1],p[q][2]);n=v("SCREEN",
"NONE",0,0,0,!1);for(q=0;q<l.length;q++)P.m(a,t,l[q],n);f&&D(a,.5,1);return c}function D(a,c,d){var b=[];P.ma(a,function(c,d){if(-1==Ka.indexOf(d.type)&&d.Ga.length&&Z(a,d,"STEREO"))for(var e=0;e<d.Ga.length;e++){var f=d.Ga[e];-1==b.indexOf(f)&&b.push(f)}});P.Pf(a,function(c,d,e){c=P.Ra(a,c);d=P.Ra(a,d);-1==Ka.indexOf(c.type)&&Z(a,d,"STEREO")&&-1==b.indexOf(e)&&b.push(e)});for(var e=0;e<b.length;e++)b[e].ek*=c,b[e].fk*=d}function H(a,c){a.Vr=c;a.mx=new Float32Array(3*c);a.Ir=new Float32Array(3*c);
a.Hr=new Float32Array(3*c);a.nx=new Float32Array(0==c%2?2*c:2*c+2)}function I(a,c,b,e){var f=d("SHADOW_CAST");f.Pv=a;f.self_shadow_polygon_offset=b.self_shadow_polygon_offset;f.Mf=c;switch(b.Cf[c]){case "SPOT":case "POINT":f.k=U.rc(U.Vc);a=za.Ld(b.vH[c]);U.Ds(f.k,a,b.gn[c],b.fn[c]);break;default:f.k=U.rc(U.Ui)}H(f,e);return f}function d(a){a={type:a,sb:"",eb:!1,TF:!1,Yu:!1,Rr:!1,yn:0,tf:0,Qk:[],debug_view_mode:0,debug_colors_seed:0,zC:1,hw:!1,time:0,k:null,ij:null,wn:[],D:[],Ga:[],vg:[],Ch:new Float32Array(3),
Cd:new Float32Array(3),od:new Float32Array(4),Te:new Float32Array(4),fe:new Float32Array(16),nH:0,Tg:0,Vr:0,mx:null,Ir:null,Hr:null,nx:null,ne:new Float32Array(3),Je:new Float32Array(3),oH:new Float32Array(4),EH:new Float32Array([0,0,0]),dz:new Float32Array(3),FH:new Float32Array(4),mH:new Float32Array(3),yo:0,jw:0,lo:!1,kh:new Float32Array(3),pk:0,pv:0,Sf:null,Hz:0,Iz:0,Ki:0,Jg:!1,DB:0,EB:new Float32Array(2),CB:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,
spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,am:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,hm:0,gm:0,fm:0,wH:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,yl:0,rs:0,lm:0,Pv:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,qt:null,pt:null,zz:null,Wj:null,Zb:!1,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,fv:0,
ow:0,mb_decay_threshold:0,mb_factor:0,sF:0,ns:"",WP:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,mz:new Float32Array(2),Jb:new Float32Array(2),lj:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,Mf:0,ec:!0,cd:!0,Xa:!0,Za:!0,Zc:!0,ra:!0,xh:1};a.Jb[0]=1;a.Jb[1]=1;a.lj[2]=.5;a.lj[3]=.5;return a}function h(a){var c=a.k;a.k=null;var d=za.ia(a);a.k=c;d.k=m(c);return d}function v(a,c,d,b,e,f){return{from:a,
to:c,size:d,ek:b,fk:e,dp:f,Ub:!0,Ja:null,gi:!1,Ud:!1,Na:ca.of,Ma:ca.of,jt:!1}}function M(a,c){if(c){var d=a.Ja;a.Ja=null}a.Ja&&za.l("Failed to clone slink with attached texture");var b=za.Ph(a);c&&(a.Ja=d,b.Ja=d);return b}function c(){var a=d("GRASS_MAP");a.k=U.rc(U.Gh);return a}function p(a){var c=d("POSTPROCESSING");c.Xa=!1;c.Za=!1;c.Zc=!1;c.Zb=!0;c.k=U.rc(U.Ac);c.ns=a;switch(a){case "NONE":c.Jb[0]=1;c.Jb[1]=1;break;case "GRAYSCALE":c.Jb[0]=1;c.Jb[1]=1;break;case "X_BLUR":c.Jb[0]=1;c.Jb[1]=0;break;
case "Y_BLUR":c.Jb[0]=0;c.Jb[1]=1;break;case "X_GLOW_BLUR":c.Jb[0]=1;c.Jb[1]=0;break;case "Y_GLOW_BLUR":c.Jb[0]=0;c.Jb[1]=1;break;case "X_EXTEND":c.Jb[0]=1;c.Jb[1]=0;break;case "Y_EXTEND":c.Jb[0]=0;c.Jb[1]=1;break;default:za.l("Wrong postprocessing effect: "+a)}return c}function R(a){var c=d("BLOOM_BLUR");c.Xa=!1;c.Za=!1;c.Zc=!1;c.k=U.rc(U.Ac);c.ns=a;c.Zb=!0;switch(a){case "X_BLUR":c.Jb[0]=1;c.Jb[1]=0;break;case "Y_BLUR":c.Jb[0]=0;c.Jb[1]=1;break;default:za.l("Wrong postprocessing effect for bloom blur: "+
a)}return c}function K(a,c){var b=d("GLOW_COMBINE");b.Xa=!1;b.Za=!1;b.Zc=!1;b.small_glow_mask_coeff=c.Zh.small_glow_mask_coeff;b.large_glow_mask_coeff=c.Zh.large_glow_mask_coeff;b.small_glow_mask_width=c.Zh.small_glow_mask_width;b.large_glow_mask_width=c.Zh.large_glow_mask_width;b.k=a;b.Zb=!0;return b}function t(a,c,b,e,f,h,g,k,n){var p=d("MAIN_"+a);"OPAQUE"===a?(p.Xa=!0,p.Za=b,p.eb=!1):"BLEND"===a?(p.Xa=!1,p.Za=!1,p.eb=!0):"XRAY"===a?(p.Xa=!1,p.Za=!0,p.eb=!0):"PLANE_REFLECT"===a||"CUBE_REFLECT"===
a?(p.Xa=!0,p.Za=!0,p.eb=!1):"PLANE_REFLECT_BLEND"===a||"CUBE_REFLECT_BLEND"===a?(p.Xa=!1,p.Za=!1,p.eb=!0):"GLOW"===a?(p.Xa=!0,p.Za=!1,p.eb=!0):za.l("wrong main subscene type");p.eb&&k&&(p.self_shadow_normal_offset=k.self_shadow_normal_offset);p.k=c;if(a=g.Ty)p.oH.set([a.KL,a.CP,a.LU,a.KU]),p.mH.set(a.color),p.nH=a.Ya;p.ne.set(g.ne);p.Je.set(g.Je);p.Tg=g.Tg;p.od=h.od;p.Te=h.Te;e&&(p.nc=e,e.od&&(p.Sf=new Float32Array(e.od)),p.Hz=e.waves_height,p.Iz=e.waves_length,p.Ki=e.Ki,e.Jg&&n&&(p.Jg=!0,p.DB=e.dM,
p.CB=e.cM,p.EB.set(e.eM)));H(p,f);return p}function y(){var a=d("RESOLVE");a.Zb=!0;a.k=U.rc(U.Ac);return a}function u(a,c,b){var e=d("COLOR_PICKING");c&&(e.type+="_XRAY",e.Xa=!1,e.Za=!0);e.cd=!1;e.k=a;H(e,b);return e}function C(a){var c=d("DEBUG_VIEW");c.ec=!1;c.Xa=!1;c.Za=!1;c.k=a;return c}function L(a){var c=d("ANCHOR_VISIBILITY");c.Xa=!0;c.Za=!1;c.k=a;return c}function n(a,c){var b=d("SHADOW_RECEIVE");b.k=a;H(b,c);return b}function T(a){var c=d("DEPTH_PACK");c.Xa=!1;c.Za=!1;c.k=a;c.Zb=!0;return c}
function O(a,c,b){var e=d("SSAO");e.Xa=!1;e.Za=!1;e.Zc=!1;e.k=a;e.od=c.od;e.Sf=new Float32Array(c.od);e.hm=b.radius_increase;e.ssao_hemisphere=b.zP;e.gm=b.influence;e.fm=b.dist_factor;e.wH=b.NR;e.Zb=!0;return e}function V(a,c){var b=d("SSAO_BLUR");b.Xa=!1;b.Za=!1;b.Zc=!1;b.k=a;b.ssao_blur_depth=c.NL;b.ssao_blur_discard_value=c.xB;b.Zb=!0;return b}function Y(a){var c=d("ANTIALIASING");c.Xa=!1;c.Za=!1;c.Zc=!1;c.xh=1/a.Nd;c.BO=a.WA;c.k=U.rc(U.Ac);c.Zb=!0;return c}function la(a,c){var b=d(a);b.Xa="SMAA_BLENDING_WEIGHT_CALCULATION"==
a||"SMAA_EDGE_DETECTION"==a?!0:!1;b.Za=!1;b.Zc=!1;b.xh=1/c.Nd;b.k=U.rc(U.Ac);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(b.XP=new Float32Array(4));b.Zb=!0;return b}function W(a,c,b,e){var f=d("COMPOSITING");f.Xa=!1;f.Za=!1;f.Zc=!1;f.k=U.rc(U.Ac);f.brightness=a;f.contrast=c;f.exposure=b;f.saturation=e;f.Zb=!0;return f}function ba(a,c){var b=d("MOTION_BLUR");b.Xa=!1;b.Za=!1;b.Zc=!1;b.k=U.rc(U.Ac);b.Yu=!0;b.mb_decay_threshold=a;b.mb_factor=c;b.Zb=!0;return b}function aa(a){var c=d("DOF");c.Xa=!1;c.Za=!1;
c.Zc=!1;c.k=a;c.xh=c.k.dof_power;c.Zb=!0;return c}function fa(a,c){var b=d("OUTLINE_MASK");b.Zc=!1;b.k=a;H(b,c);return b}function ea(a){var c=d("OUTLINE");Ja.outlining_overview_mode?c.kh.set(Ja.kh):c.kh.set(a.kh);c.yo=a.yo;c.ow=5;c.fv=3;c.Zc=!1;c.k=U.rc(U.Ac);c.Zb=!0;return c}function ia(a,c,b,e,f,h,g){var k=d("GOD_RAYS");k.Xa=!1;k.Za=!1;k.Zc=!1;k.ne=new Float32Array([1,1,1]);k.Je=new Float32Array([1,1,1]);k.Tg=1;k.TF=e;k.pk=c;k.rs=f;k.yl=b;k.lm=g;k.k=a;H(k,h);return k}function va(a,c){var b=d("GOD_RAYS_COMBINE");
b.Xa=!1;b.Za=!1;b.Zc=!1;b.k=U.rc(U.Ac);b.god_rays_intensity=a;H(b,c);b.Zb=!0;return b}function ga(a,c){var b=d("SKY");b.cd=!1;b.Xa=!1;b.Za=!1;b.Zc=!1;var e=U.rc(U.Ac);e.width=Da.xn;e.height=Da.xn;b.k=e;b.ij=za.EO();H(b,a);b.ne=new Float32Array([1,1,1]);b.Je=new Float32Array([1,1,1]);b.Tg=1;b.am.set(c.am);b.procedural_skydome=c.procedural_skydome;b.use_as_environment_lighting=c.use_as_environment_lighting;b.rayleigh_brightness=c.rayleigh_brightness;b.mie_brightness=c.mie_brightness;b.spot_brightness=
c.spot_brightness;b.scatter_strength=c.scatter_strength;b.rayleigh_strength=c.rayleigh_strength;b.mie_strength=c.mie_strength;b.rayleigh_collection_power=c.rayleigh_collection_power;b.mie_collection_power=c.mie_collection_power;b.mie_distribution=c.mie_distribution;return b}function E(){var a=d("COPY");a.Xa=!1;a.Za=!1;a.k=U.rc(U.Ac);a.Zb=!0;return a}function ka(a){var c=d("STEREO");c.Xa=!1;c.Za=!1;c.sb=a?"HMD":"ANAGLYPH";c.k=U.rc(U.Ac);c.Zb=!0;return c}function S(){var a=d("LUMINANCE");a.Xa=!1;a.Za=
!1;a.k=U.rc(U.Ac);a.Zb=!0;return a}function X(){var a=d("AVERAGE_LUMINANCE");a.Xa=!1;a.Za=!1;a.k=U.rc(U.Ac);a.Zb=!0;return a}function Ca(a,c,b,e){var f=d("LUMINANCE_TRUNCED");f.Xa=!1;f.Za=!1;f.bloom_key=a;f.bloom_edge_lum=c;f.k=e;H(f,b);f.Zb=!0;return f}function ha(a){var c=d("BLOOM");c.Xa=!1;c.Za=!1;c.k=U.rc(U.Ac);c.bloom_blur=a;c.Zb=!0;return c}function ja(){var a=d("SINK");a.cd=!1;return a}function Z(a,c,b){if(c.type===b)return!0;c=ta(a,c);for(var d=0;d<c.length;d++)if(Z(a,c[d],b))return!0;return!1}
function Q(a,c,b){if(c.type===b)return!0;c=Ba(a,c);for(var d=0;d<c.length;d++)if(Q(a,c[d],b))return!0;return!1}function Ba(a,c){var b=P.Gf(a,c);b==P.Au&&za.l("Subscene not in graph");for(var d=[],e=P.sr(a,b),f=0;f<e;f++){var h=P.wj(a,b,f);h!=b&&d.push(P.Ra(a,h))}return d}function ta(a,c){var b=P.Gf(a,c);b==P.Au&&za.l("Subscene not in graph");for(var d=[],e=P.ng(a,b),f=0;f<e;f++){var h=P.fg(a,b,f);h!=b&&d.push(P.Ra(a,h))}return d}function ua(a){var c=[],b=[];z(a,function(a){a.Ja&&-1==c.indexOf(a.Ja)&&
(c.push(a.Ja),b.push(a.Ja,c.length-1))});return b}function sa(a,c){var b;b=""+(a.from+"\\n");b+="NONE"!=a.to?a.to+"\\n":"";b+="(";if(a.dp){var d=a.ek,e=a.fk;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(e)!=e&&(e=e.toFixed(2));b+=(1==d?"":d)+"Sx"+((1==e?"":e)+"S")}else d=a.ek,e=a.fk,b+=a.size*d+"x"+a.size*e;if("SCREEN"!=a.from){b+=" ";if(a.Ud)b+="RR";else{var d=a.Na,e=a.Ma,f="";d==ca.F?f+="L":d==ca.of&&(f+="N");e==ca.F?f+="L":e==ca.of&&(f+="N");b+=f}for(d=0;d<c.length;d+=2)c[d]==a.Ja&&(b+=" "+c[d+
1])}return b+")\\n"}var U=l("__camera"),xa=l("__config"),da=l("__debug"),P=l("__graph"),pa=l("__renderer");l("__scenes");var ca=l("__textures"),za=l("__util"),Aa=xa.Jq,ma=xa.v,Ja=xa.ic,Da=xa.Vl,Ka=["GRASS_MAP","SHADOW_CAST","MAIN_CUBE_REFLECT","MAIN_CUBE_REFLECT_BLEND"];a.xM=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.wT=z;a.hN=function(a,d,f,h){function g(c){var b=m(Ra);d.U.push(b);
b=t(c,b,!1,Q,F,sb,Qa,Xb,a.wh);P.C(l,b);"XRAY"==c?(P.m(l,q[0],b,v("COLOR","COLOR",1,1,1,!0)),b.Ga.push(v("DEPTH","DEPTH",1,1,1,!0))):(c=Sb&&"RESOLVE"==q[0].type?vb:q[0],P.m(l,c,b,Mb),P.m(l,c,b,nc));ub&&(P.m(l,ub,b,Bc),P.m(l,ub,b,Cc));for(c=0;c<w.length;c++)P.m(l,w[c],b,z[c]);Zb&&P.m(l,Zb,b,qc);if(B.length){var e=B.length;for(c=0;c<e;c++)P.m(l,B[c],b,x[c])}if(H.length)for(c=0;c<H.length;c++)P.m(l,H[c],b,D[c]);Jb&&P.m(l,Jb,b,Kb);return b}var l=P.create(),q=[],r=[],w=[],z=[],B=[],x=[],H=[],D=[],F=a.aQ,
Q=a.nc,Z=a.vi,ka=a.PS,pa=a.Rd,sa=a.kl,ua=a.pg,xa=a.lF,Qb=a.ML,Yb=a.Mj,tc=a.Kk,Pb=a.antialiasing,Qa=a.Mz,sb=a.OI,Xb=a.Rc,Ic=a.IQ,Rb=a.fM,Dc=a.sP,Tc=a.WQ,mc=a.Tk,Fb=a.JN,Oc=a.gd,rb=Boolean(h.length),Sb=1<ma.uc,nc=v("COLOR","COLOR",1,1,1,!0),Mb=v("DEPTH","DEPTH",1,1,1,!0);if(Sb){M(Mb);var mb=M(Mb);nc.gi=!0;nc.Ud=!0;Mb.gi=!0;Mb.Ud=!0}var Ra=d.U[0];if(Xb){U.vz(Ra,Xb);for(var Ia=0;Ia<Xb.Cf.length;Ia++)for(var Ja=Xb.csm_num,Ta=0;Ta<Ja;Ta++){var Fc=I(Ta,Ia,Xb,F);P.C(l,Fc);w.push(Fc);var vc=Xb.csm_resolution,
Wa=Fc.k;d.kH.push(Wa);Wa.width=vc;Wa.height=vc;Fc.Xa=!1;z.push(v("DEPTH","u_shadow_map"+(0<Ia?Ia:Ta),vc,1,1,!1));(da.nM()||ma.QC)&&Fc.Ga.push(v("COLOR","COLOR",vc,1,1,!1))}}if(ua&&ua.IF&&!rb)for(Ta=0;Ta<ua.IF;Ta++){Wa=U.rc(U.Vc);Wa.width=a.Og;Wa.height=a.Og;U.Ds(Wa,90,.1,100);U.si(Wa,Wa.ib);var Gb=t("CUBE_REFLECT",Wa,!1,Q,F,sb,Qa,null,a.wh);Gb.ij=za.IO();for(Ia=0;6>Ia;Ia++)Gb.wn.push(U.WM());P.C(l,Gb);var Ka=v("CUBEMAP","u_cube_reflection",a.Og,1,1,!1);Ka.Na=ca.F;Ka.Ma=ca.F;D.push(Ka);if(ua.tE){var dc=
t("CUBE_REFLECT_BLEND",Wa,!1,Q,F,sb,Qa,null,a.wh);dc.ij=Gb.ij;dc.wn=Gb.wn;P.C(l,dc);var ed=v("DEPTH","DEPTH",a.Og,1,1,!1),Pc=v("COLOR","COLOR",a.Og,1,1,!1);P.m(l,Gb,dc,ed);P.m(l,Gb,dc,Pc);H.push(dc);ua.Sv.push(dc)}else{var od=v("DEPTH","DEPTH",a.Og,1,1,!1);Gb.Ga.push(od);H.push(Gb)}ua.Ng.push(Gb)}if(ua&&0<ua.sG.length&&!rb)for(Ia=0;Ia<ua.sG.length;Ia++)Wa=m(Ra),Wa.kc=new Float32Array(4),d.U.push(Wa),Gb=t("PLANE_REFLECT",Wa,!1,Q,F,sb,Qa,null,a.wh),P.C(l,Gb),Ka=v("COLOR","u_plane_reflection",a.Yj,1,
1,!0),Ka.Na=ca.F,Ka.Ma=ca.F,x.push(Ka),ua.tE?(dc=t("PLANE_REFLECT_BLEND",Wa,!1,Q,F,sb,Qa,null,a.wh),P.C(l,dc),ed=v("DEPTH","DEPTH",a.Yj,1,1,!0),Pc=v("COLOR","COLOR",a.Yj,1,1,!0),Pc.Na=ca.of,Pc.Ma=ca.of,P.m(l,Gb,dc,ed),P.m(l,Gb,dc,Pc),ua.ms.push([dc]),B.push(dc)):(od=v("DEPTH","DEPTH",a.Yj,1,1,!0),Gb.Ga.push(od),B.push(Gb)),ua.og.push([Gb]);if(a.Jc){var ub=c();P.C(l,ub);vc=Da.jr;ub.k.width=vc;ub.k.height=vc;var Bc=v("DEPTH","u_grass_map_depth",vc,1,1,!1);Bc.Na=ca.F;Bc.Ma=ca.F;var Cc=v("COLOR","u_grass_map_color",
vc,1,1,!1);Cc.Na=ca.F;Cc.Ma=ca.F}else Cc=Bc=ub=null;if(Fb&&Xb){var Uc=m(Ra);d.U.push(Uc);var ec=n(Uc,F);P.C(l,ec);ec.self_shadow_normal_offset=Xb.self_shadow_normal_offset;for(Ta=0;Ta<w.length;Ta++)Fc=w[Ta],P.m(l,Fc,ec,z[Ta]);var Jc=v("COLOR","u_color",1,1,1,!0),vd=v("DEPTH","u_depth",1,1,1,!0);if(pa){var pd=m(Ra);d.U.push(pd);var qd=a.$S,fd=O(pd,sb,qd);P.C(l,fd);var wd=v("COLOR","u_ssao_mask",1,1,1,!0);P.m(l,ec,fd,Jc);P.m(l,ec,fd,vd);var xd=m(Ra);d.U.push(xd);var gb=V(xd,qd);P.C(l,gb);var rd=v("COLOR",
"u_shadow_mask",1,1,1,!0);P.m(l,fd,gb,wd);P.m(l,ec,gb,vd)}Sb?ec.Ga.push(v("DEPTH","DEPTH",1,1,1,!0)):ec.Ga.push(Mb);ub&&(P.m(l,ub,ec,Bc),P.m(l,ub,ec,Cc))}else ec=null;var vb=t("OPAQUE",Ra,!0,Q,F,sb,Qa,null,a.wh);P.C(l,vb);if(Sb){var Hb=y();P.C(l,Hb);r.push(Hb);var oc=v("COLOR","RESOLVE",1,1,1,!0);oc.gi=!0;oc.Ud=!0;var Ua=v("DEPTH","RESOLVE",1,1,1,!0);Ua.gi=!0;Ua.Ud=!0;P.m(l,vb,Hb,oc);P.m(l,vb,Hb,Ua)}else r.push(vb);ec&&(wd?P.m(l,gb,vb,rd):Xb?P.m(l,ec,vb,v("COLOR","u_shadow_mask",1,1,1,!0)):za.l("Internal error"));
ub&&(P.m(l,ub,vb,Bc),P.m(l,ub,vb,Cc));if(B.length)for(var yb=B.length,Ia=0;Ia<yb;Ia++)P.m(l,B[Ia],vb,x[Ia]);if(H.length)for(Ia=0;Ia<H.length;Ia++)P.m(l,H[Ia],vb,D[Ia]);q=r;r=[];if(!rb&&a.HM){Wa=m(Ra);d.U.push(Wa);var Ib=u(Wa,!1,F);P.C(l,Ib);if(a.Eh){Wa=m(Ra);d.U.push(Wa);var zb=u(Wa,!0,F);P.C(l,zb);P.m(l,Ib,zb,v("COLOR","COLOR",1,1,1,!0));P.m(l,Ib,zb,v("DEPTH","DEPTH",1,1,1,!0))}}else Ib=null;if(!xa.gd&&!Oc||rb)Jb=null;else{if(Sb)Jb=Hb;else{var Jb=E();P.C(l,Jb);P.m(l,q[0],Jb,v("COLOR","COPY",1,1,
1,!0))}var Kb=v("COLOR","u_refractmap",1,1,1,!0)}if(Fb&&(Oc||Z||ka)){var pc=m(Ra);d.U.push(pc);var Zb=T(pc);P.C(l,Zb);P.m(l,Sb?Hb:vb,Zb,v("DEPTH","u_depth",1,1,1,!0));var qc=v("COLOR","u_scene_depth",1,1,1,!0);qc.Na=ca.of;qc.Ma=ca.of}else Zb=null;if(a.ir){var nb=g("BLEND");r.push(nb);q=r;r=[]}if(a.Yg){var pb=m(Ra);d.U.push(pb);var La=t("GLOW",pb,!1,Q,F,sb,Qa);P.C(l,La);Zb&&P.m(l,Zb,La,qc);Jb&&P.m(l,Jb,La,Kb);ub&&(P.m(l,ub,La,Bc),P.m(l,ub,La,Cc));if(B.length)for(yb=B.length,Ia=0;Ia<yb;Ia++)P.m(l,B[Ia],
La,x[Ia]);if(H.length)for(Ia=0;Ia<H.length;Ia++)P.m(l,H[Ia],La,D[Ia]);P.m(l,Sb?Hb:vb,La,Sb?mb:Mb);var cb=p("X_GLOW_BLUR");cb.sb="GLOW_MASK_SMALL";cb.xh=a.Zh.small_glow_mask_width;var ic=v("COLOR","u_color",1,1,1,!0);ic.Na=ca.F;ic.Ma=ca.F;P.C(l,cb);P.m(l,La,cb,ic);var hb=p("Y_GLOW_BLUR");hb.sb="GLOW_MASK_SMALL";hb.xh=a.Zh.small_glow_mask_width;var wc=v("COLOR","u_color",1,.5,.5,!0);wc.Na=ca.F;wc.Ma=ca.F;P.C(l,hb);P.m(l,cb,hb,wc);var Ab=p("X_GLOW_BLUR");Ab.sb="GLOW_MASK_LARGE";Ab.xh=a.Zh.large_glow_mask_width;
var Va=v("COLOR","u_color",1,.5,.5,!0);Va.Na=ca.F;Va.Ma=ca.F;P.C(l,Ab);P.m(l,hb,Ab,Va);var Tb=p("Y_GLOW_BLUR");Tb.sb="GLOW_MASK_LARGE";Tb.xh=a.Zh.large_glow_mask_width;var fc=v("COLOR","u_color",1,.25,.25,!0);fc.Na=ca.F;fc.Ma=ca.F;P.C(l,Tb);P.m(l,Ab,Tb,fc);var Gc=m(Ra);d.U.push(Gc);var ob=K(Gc,a);P.C(l,ob);var $a=v("COLOR","u_src_color",1,1,1,!0);if(a.ir)if(Sb){var $b=y();P.C(l,$b);P.m(l,nb,$b,oc);P.m(l,nb,$b,Ua);P.m(l,$b,ob,$a)}else P.m(l,nb,ob,$a);else P.m(l,Sb?Hb:vb,ob,$a);P.m(l,a.ir?nb:vb,ob,
Mb);var ya=v("COLOR","u_glow_mask_small",1,.5,.5,!0);ya.Na=ca.F;ya.Ma=ca.F;P.m(l,hb,ob,ya);var Nb=v("COLOR","u_glow_mask_large",1,.25,.25,!0);Nb.Na=ca.F;Nb.Ma=ca.F;P.m(l,Tb,ob,Nb);q=[ob];r=[]}a.ir||(nb=g("BLEND"),r.push(nb),q=r,r=[]);if(ma.debug_view){Wa=m(Ra);d.U.push(Wa);var db=C(Wa);r.push(db);P.C(l,db);P.m(l,q[0],db,nc);P.m(l,q[0],db,Mb);ub&&(P.m(l,ub,db,Bc),P.m(l,ub,db,Cc));da.WR(db);q=r;r=[]}if(Sb){var gc=y();P.C(l,gc);r.push(gc);P.m(l,q[0],gc,oc);P.m(l,q[0],gc,Ua);q=r;r=[]}var Na=q.slice(0);
if(!rb&&a.QK){Wa=m(Ra);d.U.push(Wa);var kb=L(Wa);P.C(l,kb);P.m(l,q[0],kb,Sb?mb:Mb)}if(sa&&Fb&&!rb){var Bb=Dc.yl,ac=Dc.$w,Pa=Dc.lm,Xa=q[0],wb=Q?!0:!1,Ya=v("DEPTH","u_input",1,1,1,!0);Ya.Na=ca.F;Ya.Ma=ca.F;var rc=v("COLOR","u_input",1,.25,.25,!0);rc.Na=ca.F;rc.Ma=ca.F;var Ub=Bb/Pa,ab=m(Ra);d.U.push(ab);var bb=ia(ab,wb,Bb,!0,Ub,F,Pa);P.C(l,bb);P.m(l,Xa,bb,Ya);var Ub=Bb/Pa*.5,lb=m(Ra);d.U.push(lb);var qb=ia(lb,wb,Bb,!1,Ub,F,Pa);P.C(l,qb);P.m(l,bb,qb,rc);var Ub=Bb/Pa*.25,Cb=m(Ra);d.U.push(Cb);var gd=ia(Cb,
wb,Bb,!1,Ub,F,Pa);P.C(l,gd);P.m(l,qb,gd,rc);var Ob=va(ac,F);r.push(Ob);P.C(l,Ob);P.m(l,Xa,Ob,v("COLOR","u_main",1,1,1,!0));P.m(l,gd,Ob,v("COLOR","u_god_rays",1,1,1,!0));q=r;r=[]}if(Qb&&!rb){var Xa=q[0],Kc=S();P.C(l,Kc);P.m(l,Xa,Kc,v("COLOR","u_input",1,1,1,!0));var xc=X();P.C(l,xc);xc.k.width=ma.Hn?2:1;xc.k.height=ma.Hn?2:1;var Vb=v("COLOR","u_input",1,.25,.25,!0);Vb.Na=ca.F;Vb.Ma=ca.F;var jc=v("COLOR","u_luminance",1,.25,.25,!0);jc.Na=ca.F;jc.Ma=ca.F;P.m(l,Kc,xc,Vb);var Vc=Qb.key,kc=Qb.TN,sc=m(Ra);
d.U.push(sc);var yc=Ca(Vc,kc,F,sc);P.C(l,yc);P.m(l,Xa,yc,v("COLOR","u_main",1,1,1,!0));P.m(l,Kc,yc,jc);P.m(l,xc,yc,v("COLOR","u_average_lum",1,1,1,!1));var bc=v("COLOR","u_color",1,.25,.25,!0);bc.Na=ca.F;bc.Ma=ca.F;cb=R("X_BLUR");P.C(l,cb);P.m(l,yc,cb,bc);hb=R("Y_BLUR");P.C(l,hb);P.m(l,cb,hb,bc);var Hc=ha(Qb.blur);P.C(l,Hc);var Wb=v("COLOR","u_bloom",1,.25,.25,!0);Wb.Na=ca.F;Wb.Ma=ca.F;P.m(l,hb,Hc,Wb);P.m(l,Xa,Hc,v("COLOR","u_main",1,1,1,!0));r.push(Hc);q=r;r=[]}if(mc&&Fb&&!rb){var Xa=q[0],hc=m(Ra);
d.U.push(hc);bc=v("COLOR","u_color",1,1,1,!0);bc.Na=ca.F;bc.Ma=ca.F;var lc=p("X_BLUR");P.C(l,lc);P.m(l,Xa,lc,bc);var Db=p("Y_BLUR");P.C(l,Db);P.m(l,lc,Db,bc);var yd=Na[0],Lc=aa(hc);hc.dof_distance=f.dof_distance;hc.je=f.je;hc.dof_front=f.dof_front;hc.dof_rear=f.dof_rear;hc.dof_power=f.dof_power;hc.dof_on=!0;r.push(Lc);P.C(l,Lc);P.m(l,Xa,Lc,v("COLOR","u_sharp",1,1,1,!0));P.m(l,Db,Lc,v("COLOR","u_blurred",1,1,1,!0));P.m(l,yd,Lc,v("DEPTH","u_depth",1,1,1,!0));q=r;r=[]}if(a.Eh){var Wc=g("XRAY");r.push(Wc);
q=r;r=[]}if(Yb&&!rb){var Xc=q[0],Yc=ba(Ic.mb_decay_threshold,Ic.mb_factor);r.push(Yc);P.C(l,Yc);P.m(l,Xc,Yc,v("COLOR","u_mb_tex_curr",1,1,1,!0));Yc.Ga.push(v("COLOR","u_mb_tex_accum",1,1,1,!0));q=r;r=[]}if(!rb&&a.outline){var Xa=q[0],hd=m(Ra);d.U.push(hd);var jd=fa(hd,F);P.C(l,jd);var Qc=p("X_EXTEND"),Lb=v("COLOR","u_color",1,1,1,!0),zd=v("COLOR","u_outline_mask",1,1,1,!0);Qc.lo=!0;P.C(l,Qc);P.m(l,jd,Qc,Lb);var zc=v("COLOR","u_color",1,.5,.5,!0);zc.Na=ca.F;zc.Ma=ca.F;var Zc=p("Y_EXTEND");Zc.lo=!0;
P.C(l,Zc);P.m(l,Qc,Zc,zc);lc=p("X_BLUR");lc.lo=!0;P.C(l,lc);P.m(l,Zc,lc,zc);var $c=v("COLOR","u_color",1,.25,.25,!0);$c.Na=ca.F;$c.Ma=ca.F;var ad=v("COLOR","u_outline_mask_blurred",1,.25,.25,!0);ad.Na=ca.F;ad.Ma=ca.F;Db=p("Y_BLUR");Db.lo=!0;P.C(l,Db);P.m(l,lc,Db,$c);var Ac=ea(Tc);P.C(l,Ac);P.m(l,Xa,Ac,v("COLOR","u_outline_src",1,1,1,!0));P.m(l,jd,Ac,zd);P.m(l,Db,Ac,ad);r.push(Ac);q=r;r=[]}b(l,Fb);if((a.anaglyph_use||a.fo)&&!rb){var Ad=G(l,a,d,q[0]);r.push(Ad);q=r;r=[]}if(tc&&!rb){var Xa=q[0],kd=W(Rb.brightness,
Rb.contrast,Rb.exposure,Rb.saturation);P.C(l,kd);P.m(l,Xa,kd,v("COLOR","u_color",1,1,1,!0));r.push(kd);q=r;r=[]}if(Pb){Xa=q[0];if(ma.smaa){var Mc=v("COLOR","u_color",1,1,1,!0);Mc.Na=ca.F;Mc.Ma=ca.F;var ld=la("SMAA_EDGE_DETECTION",a);P.C(l,ld);P.m(l,Xa,ld,Mc);var Nc=la("SMAA_BLENDING_WEIGHT_CALCULATION",a);P.C(l,Nc);P.m(l,ld,Nc,Mc);var bd=v("COLOR","u_search_tex",1,1,1,!1),md=v("COLOR","u_area_tex",1,1,1,!1);bd.Na=ca.F;bd.Ma=ca.F;md.Na=ca.F;md.Ma=ca.F;Nc.Ga.push(bd);Nc.Ga.push(md);var Rc=la("SMAA_NEIGHBORHOOD_BLENDING",
a);P.C(l,Rc);P.m(l,Xa,Rc,Mc);var cd=v("COLOR","u_blend",1,1,1,!0);cd.Na=ca.F;cd.Ma=ca.F;P.m(l,Nc,Rc,cd);r.push(Rc)}else{var dd=Y(a);P.C(l,dd);var sd=v("COLOR","u_color",1,1,1,!0);sd.Na=ca.F;sd.Ma=ca.F;P.m(l,Xa,dd,sd);r.push(dd)}q=r;r=[]}var Nd=P.Gf(l,q[0]);if("MOTION_BLUR"==q[0].type||"RESOLVE"==q[0].type)var Cd=!0;else Cd=!1,P.xg(l,Nd,function(a,c,b){if(b.from==b.to)return Cd=!0});if(Cd){var Dd=p("NONE");P.C(l,Dd);P.m(l,q[0],Dd,v("COLOR","u_color",1,1,1,!0));r.push(Dd);q=r;r=[]}r.push(q[0]);Ib&&
(zb?r.push(zb):r.push(Ib));kb&&r.push(kb);if(!rb&&a.Ts.procedural_skydome){var Id=ga(F,a.Ts);P.C(l,Id);r.push(Id)}var Sc=ja();P.C(l,Sc);for(Ta=0;Ta<r.length;Ta++){var td=r[Ta];switch(td.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":P.m(l,td,Sc,v("COLOR","NONE",1,1,1,!0));P.m(l,td,Sc,v("DEPTH","NONE",1,1,1,!0));break;case "SKY":P.m(l,td,Sc,v("CUBEMAP","u_sky",Da.xn,1,1,!1));break;case "ANCHOR_VISIBILITY":P.m(l,td,Sc,v("COLOR","NONE",1,1,1,!0));break;default:if(rb){var Jd=h[0].j,ud=v("COLOR",
"OFFSCREEN",1,1,1,!0);ud.Ja=Jd;P.m(l,r[Ta],Sc,ud);for(Ia=1;Ia<h.length;Ia++){var Kd=h[Ia].j,Ed=p("NONE");P.C(l,Ed);P.m(l,r[Ta],Ed,v("COLOR","SCALE",1,1,1,!0));var Ld=Kd.hk/Jd.hk,ud=v("COLOR","OFFSCREEN",1,Ld,Ld,!0);ud.Ja=Kd;P.m(l,Ed,Sc,ud)}}else P.m(l,r[Ta],Sc,v("SCREEN","NONE",1,1,1,!0))}}Hb&&!ta(l,Hb).length&&(P.Kf(l,P.Gf(l,Hb)),P.wv(l));b(l,Fb);e(l,Fb);if(Aa.enabled){var Md=J(l);Md&&N(l,Md)}k(l);A(l);Xb&&P.ma(l,function(a,c){if("SHADOW_RECEIVE"==c.type||"MAIN_BLEND"==c.type||"MAIN_XRAY"==c.type){for(var b=
0,d=Ba(l,c),e=0,f=0;f<d.length;f++){var h=d[f];"SHADOW_CAST"==h.type&&(e++,c.Wj=c.Wj||[],c.Wj[0<h.Mf?h.Mf:b]=h.k.Bb,b++)}c.qt&&c.pt||(ma.Lr?c.zz=new Float32Array(9*e):(c.qt=new Float32Array(4*e),c.pt=new Float32Array(4*e)))}});return l};a.NQ=D;a.A_=d;a.we=function(a,c,b){var d=a.xh;a.mz[0]=c*a.Jb[0]*d;a.mz[1]=b*a.Jb[1]*d};a.jd=function(a,c){a.xh=c};a.fN=function(){var a=P.create(),c=d("PERFORMANCE");subs.Zb=!0;var b=U.rc(U.Ac);b.width=1024;b.height=1024;c.k=b;P.C(a,c);b=ja();P.C(a,b);P.m(a,c,b,v("COLOR",
"NONE",1024,1,1,!1));k(a);A(a);return a};a.pO=function(a){var c=null;P.ma(a,function(a,b){return b.k&&null===b.k.Ve?(c=b,!0):!1});return c};a.tb=function(a,c,b){a=Ba(a,c);for(c=0;c<a.length;c++)if(a[c].type===b)return a[c];return null};a.g_=Z;a.j_=Q;a.gP=Ba;a.iP=ta;a.Ob=function(a,c){var b=null;P.ma(a,function(a,d){return d.type==c?(b=d,!0):!1});return b};a.BN=function(a){var c="digraph scenegraph {\n",c=c+"    ",c=c+'size="11.7,16.5";\n',c=c+"    ",c=c+'ratio="fill";\n',c=c+"    ",c=c+'node [shape=box margin="0.25,0.055"];\n',
b=ua(a);P.ma(a,function(a,d){var e=c+="    ",f="",f=d.type.replace(/_/g," ");"POSTPROCESSING"==d.type&&(f+=" ("+d.ns.replace(/_/g," ")+")");if(d.k){for(var f=f+"\\n",h=0;h<b.length;h+=2){var g=d.k.Wb;b[h]==g&&(f=ca.pl(g)?f+("CR"+b[h+1]+" "):f+("C"+b[h+1]+" "))}for(h=0;h<b.length;h+=2)g=d.k.he,b[h]==g&&(f=ca.pl(g)?f+("DR"+b[h+1]):f+("D"+b[h+1]))}d.Ga.length&&(f+="\\n-----\\n");for(h=0;h<d.Ga.length;h++)f+=sa(d.Ga[h],b);h="SINK"==d.type?"dotted":d.cd?"solid":"dashed";c=e+(String(a)+' [label="'+f+'" color="black" style="'+
(h+",bold")+'"];\n')});P.Pf(a,function(a,d,e){c+="    ";c+=String(a)+" -> "+String(d)+' [label="'+sa(e,b)+'" style="'+(e.Ub?"solid":"dotted")+'"];\n'});return c+="}"};a.iN=function(a){a=P.rT(a);for(var c=[],b=0;b<a.length;b++){var d=a[b];d.cd&&c.push(d)}return c}};b4w.module.__shaders=function(a,l){function m(a,d,e){var f=a.Rg;"string"==typeof e&&(a=b(a,e))&&(e=a[1]);for(a=0;a<f.length;a++)if(f[a][0]==d){f[a][1]=e;return}f.push([d,e])}function b(a,b){for(var d=a.Rg,e=0;e<d.length;e++)if(d[e][0]==b)return d[e];return!1}function e(a,b){var d=a+b;if(H[d])return H[d];if(I){var e=I[b];if(!e)return null;e=l("__gpp_parser").p0.parse(e)}else if(e=l("shader_texts")[b],!e)return null;return H[d]=e}function x(a,b,d){function f(b){b=b.b;for(var d=0;d<b.length;d++){var n=
b[d];switch(n.type){case "condition":a:for(var n=n.b,p=0;p<n.length;p++){var A=n[p];switch(A.type){case "if":case "elif":if(h(A.d)){f(A.group);break a}break;case "else":f(A.group);break a;case "ifdef":A.name in q&&f(A.group);break;case "ifndef":A.name in q||f(A.group)}}break;case "include":n=e(G.shaders_dir,G.JS+n.file);f(n);break;case "var":case "export":case "import":break;case "define":p=n.name;q[p]=n.a;n.Fa&&(r[p]=n.Fa);break;case "error":F.l("Shader error: #error "+n.a.join(" "));break;case "line":break;
case "pragma":v.push("#pragma "+n.name+" "+n.a.join(" "));break;case "undef":n=n.name;delete q[n];delete r[n];break;case "warning":N.warn("Shader warning: #warning "+n.a.join(" "));break;case "extension":n=k(n.a,q,r,!1);v.push("#extension "+n.join(" "));break;case "#":break;case "node":w[n.name]=n;break;case "nodes_global":n=l;for(p=0;p<n.length;p++){var A=n[p],H=w[A.id];if(H)for(var E=0,M=0;M<H.h.length;M++){var D=H.h[M];if("node_param"==D.type){var J;if("PARTICLE_INFO"==A.id&&D.c)if(1==q.PARTICLE_BATCH)switch(J=
!1,E){case 0:J=g(A.Nb,"PART_INFO_IND")||g(A.Nb,"PART_INFO_AGE")||g(A.Nb,"PART_INFO_LT")||g(A.Nb,"PART_INFO_SIZE");break;case 1:J=g(A.Nb,"PART_INFO_LOC");break;case 2:J=g(A.Nb,"PART_INFO_VEL");break;case 3:J=g(A.Nb,"PART_INFO_A_VEL");break;case 4:J=g(A.Nb,"PART_INFO_IND")}else J=!1;else J=!0;J&&(D=D.qualifier.join(" ")+" ","vert"==a?D+=A.Ji[E]:"frag"==a&&(D+=A.Fa[E],null!==A.cs[E]&&(D+=" = "+A.cs[E])),D+=";",v.push(D));E++}}}break;case "nodes_main":n=l;for(p=0;p<n.length;p++)if(A=n[p],H=w[A.id]){E=
{};M={};for(D=0;D<A.Nb.length;D++)M[A.Nb[D][0]]=[A.Nb[D][1]];I=x=B=0;D=A;J=H.h;for(var R=E,Y=M,ja=0;ja<J.length;ja++){var Z=J[ja];switch(Z.type){case "node_in":var Q=D.L[B];if(null!==D.Zw[B]){if(("MATERIAL_BEGIN"==D.id&&3===B||!Y.MATERIAL_EXT&&("MATERIAL_BEGIN"==D.id&&4===B||"MATERIAL_END"==D.id&&3===B||"MATERIAL_END"==D.id&&4===B||"MATERIAL_END"==D.id&&5===B)||"TEXTURE_COLOR"==D.id||"TEXTURE_NORMAL"==D.id)&&Z.c){R[Z.name]=D.Zw[B];B++;continue}var Ba=Z.qualifier.join(" ")+" ",Ba=Ba+Q,Ba=Ba+(" = "+
D.Zw[B]),Ba=Ba+";";v.push(Ba)}R[Z.name]=Q;B++;break;case "node_out":Q=D.Sa[x];if(!Z.c||-1<z.indexOf(Q))Ba=Z.qualifier.join(" ")+" ",Ba+=Q,Ba+=";",v.push(Ba),R[Z.name]=Q;-1<z.indexOf(Q)&&(Y["USE_OUT_"+Z.name]=[1]);x++;break;case "node_param":"vert"==a?Q=D.Ji[I]:"frag"==a&&(Q=D.Fa[I]),R[Z.name]=Q,I++}}v.push("{");m(A,H.f,E,M);v.push("}")}break;case "textline":n=k(n.a,q,r,!1);v.push(n.join(" "));break;default:F.l("Unknown element type: "+n.type)}}}function h(a,c){var b;b=k(a,q,r,!0,c);for(var d=[],e=
0;e<b.length;e++)if(b[e]instanceof Object)switch(b[e].type){case "conditional_expr":var f=d.pop(),g=d.pop();d.pop()?d.push(g):d.push(f);break;case "logical_or_expr":f=d.pop();for(g=0;g<b[e].e-1;g++)n=d.pop(),f=f||n;d.push(f);break;case "logical_and_expr":f=d.pop();for(g=0;g<b[e].e-1;g++)n=d.pop(),f=f&&n;d.push(f);break;case "logical_bitor_expr":f=d.pop();for(g=0;g<b[e].e-1;g++)f|=d.pop();d.push(f);break;case "logical_bitxor_expr":f=d.pop();for(g=0;g<b[e].e-1;g++)f^=d.pop();d.push(f);break;case "logical_bitand_expr":f=
d.pop();for(g=0;g<b[e].e-1;g++)f&=d.pop();d.push(f);break;case "equal_expr":f=d.pop();g=d.pop();d.push(g==f);break;case "non_equal_expr":f=d.pop();g=d.pop();d.push(g!=f);break;case "le_expr":f=d.pop();g=d.pop();d.push(g<=f);break;case "ge_expr":f=d.pop();g=d.pop();d.push(g>=f);break;case "l_expr":f=d.pop();g=d.pop();d.push(g<f);break;case "g_expr":f=d.pop();g=d.pop();d.push(g>f);break;case "left_shift_expr":g=d.pop();f=d.pop();d.push(g<<f);break;case "right_shift_expr":g=d.pop();f=d.pop();d.push(g>>
f);break;case "add_expr":g=d.pop();f=d.pop();d.push(g+f);break;case "sub_expr":g=d.pop();f=d.pop();d.push(g-f);break;case "mul_expr":g=d.pop();f=d.pop();d.push(g*f);break;case "div_expr":g=d.pop();f=d.pop();d.push(g/f);break;case "mod_expr":g=d.pop();f=d.pop();d.push(g%f);break;case "pre_inc_expr":case "post_inc_expr":n=d.pop();d.push(++n);break;case "pre_dec_expr":case "post_dec_expr":n=d.pop();d.push(--n);break;case "positive_expr":n=d.pop();d.push(+n);break;case "negative_expr":n=d.pop();d.push(-n);
break;case "one_compl_expr":n=d.pop();d.push(~n);break;case "logic_negative_expr":n=d.pop();d.push(!n);break;default:F.l("Unknown operation type: "+b[e].type)}else{var n=b[e];/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(n)?d.push(0):d.push(parseFloat(b[e]))}1==d.length?b=d[0]:(F.l("Incorrect expression: "+b.join(" ")),b=void 0);return b}function m(a,c,b,d){for(var e=0;e<c.length;e++){var f=c[e];switch(f.type){case "node_condition":a:for(var g=a,f=f.b,n=b,p=d,l=0;l<f.length;l++){var u=f[l];switch(u.type){case "node_if":case "node_elif":if(h(u.d,
p)){m(g,u.f,n,p);break a}break;case "node_else":m(g,u.f,n,p);break a;case "node_ifdef":(u.name in q||u.name in p)&&m(g,u.f,n,p);break;case "node_ifndef":u.name in q||u.name in p||m(g,u.f,n,p)}}break;case "textline":g=[];for(n=0;n<f.a.length;n++)p=f.a[n],p in b?g.push(b[p]):g.push(p);g=k(g,q,r,!0,d);v.push(g.join(" "))}}}var l=d.Pj;d=d.Rg||[];for(var v=[],q={},n=0;n<d.length;n++)q[d[n][0]]=[d[n][1]];for(n=0;n<l.length;n++)q["USE_NODE_"+l[n].id]=[1];var r={},w={},z=[];for(n in l)for(var A in l[n].L)z.push(l[n].L[A]);
f(b);var B=0,x=0,I=0;return v.join("\n")}function k(a,b,d,e,f){var h=[];B(a,b,d,e,h,f);return h}function B(a,b,d,e,f,h){for(var g=0;g<a.length;g++){var k=a[g];k in b||h&&k in h?(k=h&&h[k]||b[k],0==k.length&&e?f.push(0):B(k,b,d,e,f,h)):f.push(k)}}function r(a,b,d,e){e=a.createShader(e);a.shaderSource(e,d);a.compileShader(e);J.uM(e,b,d);return e}function w(a){v.deleteProgram(a.Tl);v.deleteShader(a.Fz);v.deleteShader(a.bD);delete D[a.IS]}function f(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return q(a);
case 2:return"vec2("+q(a[0])+","+q(a[1])+")";case 3:return"vec3("+q(a[0])+","+q(a[1])+","+q(a[2])+")";case 4:return"vec4("+q(a[0])+","+q(a[1])+","+q(a[2])+","+q(a[3])+")";case 9:return"mat3("+q(a[0])+","+q(a[1])+","+q(a[2])+","+q(a[3])+","+q(a[4])+","+q(a[5])+","+q(a[6])+","+q(a[7])+","+q(a[8])+")";case 16:return"mat4("+q(a[0])+","+q(a[1])+","+q(a[2])+","+q(a[3])+","+q(a[4])+","+q(a[5])+","+q(a[6])+","+q(a[7])+","+q(a[8])+","+q(a[9])+","+q(a[10])+","+q(a[11])+","+q(a[12])+","+q(a[13])+","+q(a[14])+
","+q(a[15])+")";default:F.l("Wrong glsl value dimension")}}function q(a){return a%1?String(a):String(a)+".0"}function g(a,b){for(var d=0;d<a.length;d++)if(a[d][0]==b)return!0;return!1}var z=l("__assets"),A=l("__config"),J=l("__debug"),N=l("__print"),F=l("__util"),G=A.qd,D={},H={},I=null,d="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std_enums.glsl include/to_world.glslv include/wind_bending.glslv".split(" "),
h=[],v=null,M=!1;a.xe=function(a){v=a};a.V=m;a.YO=b;a.F_=function(a,b){for(var d=a.Rg,e=0;e<d.length;e++)if(d[e][0]==b&&1==d[e][1])return!0;return!1};a.XR=function(a){a.Rg=[];for(var b="ALPHA ALPHA_CLIP ANAGLYPH BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEBUG_VIEW_SPECIAL_SKYDOME DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT USE_FOG WEBGL2 WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS NUM_CAST_LAMPS SUN_NUM MAC_OS_SHADOW_HACK USE_COLOR_RAMP HALO_PARTICLES PARTICLE_BATCH HAS_REFRACT_TEXTURE".split(" "),
d=0;d<b.length;d++){var e=b[d],h;switch(e){case "ALPHA":case "ALPHA_CLIP":case "ANAGLYPH":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEBUG_VIEW_SPECIAL_SKYDOME":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "USE_FOG":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":case "NUM_CAST_LAMPS":case "SUN_NUM":case "MAC_OS_SHADOW_HACK":case "USE_COLOR_RAMP":case "HALO_PARTICLES":case "PARTICLE_BATCH":case "HAS_REFRACT_TEXTURE":h=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":h=1;break;case "WEBGL2":h=A.v.ld|0;break;case "EPSILON":h="highp"==A.v.precision?1E-6:1E-4;break;case "SHADOW_TEX_RES":h=f(2048);break;case "AA_METHOD":h="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":h="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":h="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":h=
"POST_EFFECT_NONE";break;case "SHADOW_USAGE":h="NO_SHADOWS";break;case "SSAO_QUALITY":h="SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":h="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":h="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":h=A.v.precision;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":h="u_va_frame_factor";break;default:N.error("Unknown directive ("+a.zm+", "+a.al+"): "+e)}m(a,e,h)}};a.XZ=function(a){return a.zm};a.aZ=function(a){return a.al};a.y_=function(a,d){for(var e=d.Rg,f=0;f<
e.length;f++){var h=e[f][0],g=e[f][1];b(a,h)&&m(a,h,g)}};a.UO=function(a){var b=JSON.stringify(a),d=D[b];if(d)return d;var f=a.al,d=e(G.shaders_dir,a.zm),f=e(G.shaders_dir,f);if(!d||!f)return null;var h=x("vert",d,a),g=x("frag",f,a),d=v,k=r(d,b,h,d.VERTEX_SHADER),m=r(d,b,g,d.FRAGMENT_SHADER),f=d.createProgram();d.attachShader(f,k);d.attachShader(f,m);d.linkProgram(f);d.validateProgram(f);d.getProgramParameter(f,d.VALIDATE_STATUS)==d.eV&&N.error("shader program is not valid",b);J.vM(f,b,k,m,h,g);a=
{Fz:k,bD:m,Tl:f,attributes:{},ik:{},Do:[],Rx:{},Tr:!0,Fx:!1,cI:[],Tb:F.Ph(a),IS:b,Oh:!0};g=d.getProgramParameter(f,d.ACTIVE_ATTRIBUTES);for(h=0;h<g;h++)k=d.getActiveAttrib(f,h).name,a.attributes[k]=d.getAttribLocation(f,k);g=d.getProgramParameter(f,d.ACTIVE_UNIFORMS);for(h=0;h<g;h++)k=d.getActiveUniform(f,h).name.split("[0]").join(""),a.ik[k]=d.getUniformLocation(f,k);return D[b]=d=a};a.qQ=function(){M=!1;if(b4w.module_check("shader_texts"))M=!0;else{for(var a=[],b=z.yt,e=0;e<d.length;e++){var f=
F.vo(G.shaders_dir+d[e]);a.push({id:d[e],type:b,url:f})}b=function(a,c){I||(I={});I[c]=a};a.length?z.cd(a,b,function(){M=!0}):N.error("Shaders have not been found.")}};a.wM=function(){return M};a.HX=function(){return h};a.uD=function(){return D};a.ha=function(){for(var a in D)w(D[a]);for(var b in H)delete H[b];for(var d in h)delete h[d]};a.FM=w;a.IX=function(a){var b=a.Rg;N.log("Shader: "+a.zm+" "+a.al+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)N.log("  "+b[a][0],b[a][1])};a.H=
f;a.QB=function(a,b){return b in a.ik?!0:!1};a.pP=function(a){return(v.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__assets=function(a,l){function m(){return J.EE()?l(J.qd.mq).data:null}function b(){var a={Vp:null,NK:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var d=b.length,e=new Int8Array(d),f=0;f<d;f++)e[f]=b.charCodeAt(f);return e.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,d){a.Vp=d;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=m();b&&a.Vp in b&&(a.status=200,b[a.Vp]&&(a.response=a.NK(b[a.Vp])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function e(c){for(var b=0,e=0;e<c.length;e++){var h=c[e];20===h.state&&b++;if(b>=d.GQ)break;if(10===h.state)switch(h.state=20,b++,h.type){case a.pp:x(h,"arraybuffer");break;case a.tk:x(h,"json");break;case a.yt:x(h,"text");break;case a.Uz:k(h);break;case a.qp:B(h);break;case a.Vz:r(h);break;case a.sp:w(h);break;
case a.rp:f(h);break;default:D.l("Wrong asset type: "+h.type)}}}function x(c,d){var e=m(),f=e&&c.url in e?new b:new XMLHttpRequest,e=null;if("GET"==c.rg)f.open("GET",c.url,!0);else if("POST"==c.rg)switch(f.open("POST",c.url,!0),c.Sl){case a.Rz:e="text/plain";break;case a.Qz:e="application/json"}if(c.ji)for(var h in c.ji)"Content-Type"==h?e=c.ji[h]:f.setRequestHeader(h,c.ji[h]);e&&f.setRequestHeader("Content-Type",e);"text"==d?(f.overrideMimeType("text/plain"),f.responseType="text"):"json"==d?(f.overrideMimeType("application/json"),
f.responseType="text"):f.responseType=d;f.onreadystatechange=function(){if(40!=c.state&&4==f.readyState){if(200==f.status||0==f.status){var a=f.response;if(a){if("json"==d&&"string"==typeof a)try{a=JSON.parse(a,c.YP)}catch(b){F.error(b+" (parsing JSON "+c.url+")");c.qc(null,c.id,c.type,c.url,c.Ib);return}c.qc(a,c.id,c.type,c.url,c.Ib)}else F.error("empty responce when trying to get "+c.url),c.qc(null,c.id,c.type,c.url,c.Ib)}else F.error(f.status+" when trying to get "+c.url),c.qc(null,c.id,c.type,
c.url,c.Ib);c.state=30}};f.addEventListener("progress",function(a){a.lengthComputable&&c.gG(a.loaded/a.total)},!1);f.send(c.Zj)}function k(a){"GET"!=a.rg&&D.l("Unsupported request type for audio buffer");var d=m(),e=d&&a.url in d?new b:new XMLHttpRequest;e.open("GET",a.url,!0);e.responseType="arraybuffer";e.onreadystatechange=function(){if(40!=a.state&&4==e.readyState)if(200==e.status||0==e.status){var b=e.response;b?G.FN(b,function(b){a.qc(b,a.id,a.type,a.url,a.Ib);a.state=30},function(){a.qc(null,
a.id,a.type,a.url,a.Ib);F.error("failed to decode "+a.url);a.state=30}):(a.qc(null,a.id,a.type,a.url,a.Ib),F.error("empty responce when trying to get "+a.url),a.state=30)}else a.qc(null,a.id,a.type,a.url,a.Ib),F.error(e.status+" when trying to get "+a.url),a.state=30};e.send(a.Zj)}function B(a){"GET"!=a.rg&&D.l("Unsupported request type for image element");var b=document.createElement("img");I.allow_cors&&(b.crossOrigin="Anonymous");b.onload=function(){40!=a.state&&(a.qc(b,a.id,a.type,a.url,a.Ib),
a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.qc(null,a.id,a.type,a.url,a.Ib),F.error("could not load image: "+a.url),a.state=30)},!1);var d=m();if(d&&a.url in d)if(d[a.url]){var e=g(a.url);b.src="data:"+e+";base64,"+d[a.url]}else N.no()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),b.dispatchEvent(d);else b.src=a.url}function r(a){"GET"!=a.rg&&D.l("Unsupported request type for audio element");var b=document.createElement("audio");
I.allow_cors&&(b.crossOrigin="Anonymous");b.addEventListener("loadeddata",function(){40!=a.state&&(a.qc(b,a.id,a.type,a.url,a.Ib),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.qc(null,a.id,a.type,a.url,a.Ib),F.error("could not load sound: "+a.url),a.state=30)},!1);b.addEventListener("stalled",function(){40!=a.state&&(a.qc(null,a.id,a.type,a.url,a.Ib),F.error("could not load sound: "+a.url),a.state=30)},!1);var d=m();if(d&&a.url in d)if(d[a.url]){var e=z(a.url);b.src="data:"+
e+";base64,"+d[a.url];40!=a.state&&(a.qc(b,a.id,a.type,a.url,a.Ib),a.state=30)}else N.no()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),b.dispatchEvent(d);else b.src=a.url,I.Af&&b.load();I.yx&&(b.autoplay=!0,b.pause());setTimeout(function(){b.RS=1},5E3)}function w(a){function b(){40!=a.state&&(a.qc(null,a.id,a.type,a.url),F.error("could not load video: "+a.url,a.Ib),a.state=30)}"GET"!=a.rg&&D.l("Unsupported request type for video element");
var d=document.createElement("video");d.muted=!0;if(I.allow_cors||I.Af)d.crossOrigin="Anonymous";d.addEventListener("loadeddata",function(){d.removeEventListener("error",b,!1);40!=a.state&&(a.qc(d,a.id,a.type,a.url,a.Ib),a.state=30)},!1);d.addEventListener("error",b,!1);var e=m();if(e&&a.url in e)if(e[a.url]){var f=A(a.url);d.src="data:"+f+";base64,"+e[a.url];40!=a.state&&d.addEventListener("loadeddata",function(){a.qc(d,a.id,a.type,a.url,a.Ib);a.state=30},!1)}else N.no()?(e=document.createEvent("CustomEvent"),
e.initCustomEvent("error",!1,!1,null)):e=new CustomEvent("error"),d.dispatchEvent(e);else d.src=a.url,I.Af&&d.load();I.yx&&(d.autoplay=!0,d.pause());setTimeout(function(){d.RS=1},1E4)}function f(c){function d(a){c.qc(a,c.id,c.type,c.url,c.Ib);c.state=30}"GET"!=c.rg&&D.l("Unsupported request type for seq video element");var e=m(),f=e&&c.url in e?new b:new XMLHttpRequest;if(null==c.Sl&&null==c.Zj)f.open("GET",c.url,!0);else switch(f.open("POST",c.url,!0),c.Sl){case a.Rz:f.setRequestHeader("Content-type",
"text/plain");break;case a.Qz:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=c.state&&4==f.readyState)if(200==f.status||0==f.status){var a=f.response;a?q(a,d):(c.qc(null,c.id,c.type,c.url,c.Ib),F.error("empty responce when trying to get "+c.url),c.state=30)}else c.qc(null,c.id,c.type,c.url,c.Ib),F.error(f.status+" when trying to get "+c.url),c.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&c.gG(a.loaded/
a.total)},!1);f.send(c.Zj)}function q(a,b){for(var d=new Int32Array(a),e=new Int8Array(a),f=d[3],h={images:[],wB:[],Wg:d[4]},g=20,k=0;k<f;k++){var m=d[g/4],n=new Blob([e.subarray(g+4,g+4+m)],{type:"image/jpg"}),l=document.createElement("img");l.src=window.URL.createObjectURL(n);h.images.push(l);h.wB.push(n);g+=m+8-m%4}l.onload=function(){for(var a=0;a<h.images.length;a++)window.URL.revokeObjectURL(h.images[a].src);delete h.wB;b(h)}}function g(a){var b="image";switch(D.Iw(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function z(a){var b="audio";switch(D.Iw(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function A(a){var b="video";switch(D.Iw(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var J=l("__config"),N=l("__compat"),F=l("__print"),G=l("__sfx"),D=l("__util"),H=l("__version"),I=J.v,d=J.Ne;a.pp=10;a.tk=
20;a.yt=30;a.Uz=40;a.qp=50;a.Vz=60;a.sp=70;a.rp=80;a.Qz=a.tk;a.Rz=a.yt;var h=[],v=0,M={};a.$o=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.LZ=function(a){if(M[a])return M[a];var b=d.prevent_caching?a+H.timestamp():a,e=new XMLHttpRequest;e.overrideMimeType("text/plain");e.open("GET",b,!1);e.send(null);if(200==e.status||0==e.status){b=e.responseText;if(b.length)return M[a]=b;D.l("Error XHR: responce is empty, GET "+a)}else D.l("Error XHR: "+
e.status+", GET "+a)};a.ha=function(){for(var a=0;a<h.length;a++)h[a].state=40;h=[];v=0;M={}};a.cd=function(a,b,f,g,k){for(var l=0;l<a.length;l++){var q=a[l],q={id:q.id,type:q.type,url:q.url,rg:q.rg?q.rg:"GET",Sl:q.Sl?q.Sl:null,ji:q.ji?q.ji:null,Zj:q.Zj?q.Zj:null,Ib:q.Ib?q.Ib:null,state:10,qc:b||function(){},UF:f||function(){},gG:g||function(){},YP:k||null,VF:v};if(d.prevent_caching){var r=m();r&&q.url in r||(q.url+=H.timestamp())}h.push(q)}e(h);v++};a.update=function(){e(h);for(var a=h,b=0,d=!0,
f=0;f<a.length;f++){var g=a[f];g.VF===a[b].VF?30!==g.state&&(d=!1):(d&&(a[f-1].UF(),d=f-b,a.splice(b,d),f-=d),b=f,d=30===a[f].state?!0:!1);f===a.length-1&&d&&(a[f].UF(),a.splice(b))}};a.rM=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a?!0:!1}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",b:[{type:"var",name:"ANCHOR_NUM",a:["0"]},{type:"include",file:"math.glslv"},{type:"textline",a:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; void main ( ) { gl_Position = u_view_proj_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",
name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",
a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"std_enums.glsl"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"color_util.glslf"},
{type:"include",file:"math.glslv"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],
group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_OUTLINE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_color_id",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",b:[{type:"if",d:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_OUTLINE"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",
"ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bC ; varying vec4 bD ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"varying vec4 bI ; varying vec4 bJ ; varying vec4 bK ; varying vec4 bL ; uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform sampler2D u_shadow_map0 ; uniform sampler2D u_shadow_map1 ; uniform sampler2D u_shadow_map2 ; uniform sampler2D u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",a:"void main ( ) { mat4 qT , qU , qV , qW , qX ; float qY , qZ ; vec4 q_ ; vec3 ra , rb , rc , rd ;".split(" ")},
{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:"ra = u_camera_eye_frag - bC ; ra = normalize ( ra ) ; qT = mat4 ( 0.0 ) ; qU = mat4 ( 0.0 ) ; qV = mat4 ( 0.0 ) ; qW = mat4 ( 0.0 ) ; qX = mat4 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"qT = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:"qU = O ( u_view_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"qV = O ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:"qW = O ( u_model_zup_tsr ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"qX = O ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"textline",a:"qS ( ra , qT , qU , qV , qW , qX , rb , rc , rd , q_ , qY ) ; qY = qY ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"qY = ( texture2D ( u_sampler , bM ) ) . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"qZ = u_alpha_factor * qY ; qZ += ( 1.0 - step ( 0.0 , qZ ) ) ; qY = mix ( qZ , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"qY = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( qY < 0.5 ) discard ; qY = 1.0 ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["USE_OUTLINE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["color_id.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},
{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3",
"a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},
{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",
d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],
group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",
d:["BILLBOARD","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform",
"PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bC ; varying vec4 bD ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",
b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec4 tB ; float tC , tD , tE ; vec3 tF , tG , tH , tI , tJ , tK ; mat4 tL , tM , tN ; tL = O ( u_view_tsr ) ; tF = a_position ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["tG","=","a_normal",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tH = vec3 ( a_tangent ) ; tI = a_tangent [ 3 ] * cross ( tG , tH ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"tH = vec3 ( 0.0 ) ; tI = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tG = vec3 ( 0.0 ) ; tH = vec3 ( 0.0 ) ; tI = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"tF = mix ( tF , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"tG = mix ( tG , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tJ = vec3 ( a_tangent ) ; tK = a_tangent_next [ 3 ] * cross ( a_normal_next , tJ ) ; tH = mix ( tH , tJ , u_va_frame_factor ) ; tI = mix ( tI , tK , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sH ( tF , tH , tI , tG ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["tI","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tI = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tM = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",
b:[{type:"textline",a:"tH = ( tM * vec4 ( tI , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tN = rA ( u_camera_eye , tH , tL , tM ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tN = ru ( u_camera_eye , tH , tL ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tN = tN * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , tH ) ;".split(" ")}]}}]},{type:"textline",a:"c tO = rH ( tF - tI , tI , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tN ) ; tO . b = tH ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c tO = rH ( tF , tI , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tM ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tv ( tO . a , tO . b , tG ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["tG","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tG = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tv ( tO . a , tO . b , tG ) ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"bM = rK ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bC = tO . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"bE = tO . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"tC = ( dot ( cross ( tO . e , tO . c ) , tO . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( tO . c , tC ) ;".split(" ")}]}}]},{type:"textline",a:"bD = tL * vec4 ( tO . a , 1.0 ) ; tB = u_proj_matrix * bD ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:"tB . xy += u_subpixel_jitter * tB . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tC = tB . x ; tD = tB . y ; tE = tB . w ; bG . x = ( tC + tE ) / 2.0 ; bG . y = ( tD + tE ) / 2.0 ; bG . z = tE ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - bD . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["tA","(",")",";"]}]}}]},{type:"textline",a:"gl_Position = u_proj_matrix * tL * vec4 ( tO . a , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={type:"group",b:[{type:"define",name:"DV_NONE",a:["0"]},{type:"define",name:"DV_OPAQUE_WIREFRAME",a:["1"]},{type:"define",name:"DV_TRANSPARENT_WIREFRAME",a:["2"]},{type:"define",
name:"DV_FRONT_BACK_VIEW",a:["3"]},{type:"define",name:"DV_DEBUG_SPHERES",a:["4"]},{type:"define",name:"DV_CLUSTERS_VIEW",a:["5"]},{type:"define",name:"DV_BATCHES_VIEW",a:["6"]},{type:"define",name:"DV_RENDER_TIME",a:["7"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},
{type:"textline",a:"varying vec3 tB ; const float tC = 1.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"const vec3 tD = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"const vec3 tD = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"const vec3 tE = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 tF = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 tG = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 tH = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 tI = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"float tL ( ) { vec3 tJ ; float tK ; tK = 1.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["WIREFRAME_QUALITY",0,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"tJ = sign ( tB - vec3 ( 0.02 * tC ) ) ; if ( tJ . x < 0.0 || tJ . y < 0.0 || tJ . z < 0.0 ) tK = 0.0 ;".split(" ")}]}},{type:"elif",d:["WIREFRAME_QUALITY",1,{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"extension",a:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",a:"tJ = fwidth ( tB ) ; tJ = smoothstep ( vec3 ( 0.0 ) , tJ * tC , tB ) ; tK = min ( min ( tJ . x , tJ . y ) , tJ . z ) ; tK = clamp ( tK , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["return","tK",";","}"]}]}}]},{type:"textline",a:"void main ( ) { float tM , tN , tO , tP ; vec3 tQ , tR ; tQ = vec3 ( 0.0 ) ; tM = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",b:[{type:"textline",
a:"tR = sign ( tB - vec3 ( 0.02 * tC ) ) ; if ( tR . x < 0.0 || tR . y < 0.0 || tR . z < 0.0 ) { tQ = tD ; tM = 1.0 ; } else discard ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { tN = tL ( ) ; tQ = vec3 ( mix ( u_wireframe_edge_color , tG , tN ) ) ; tM = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { tN = tL ( ) ; tQ = u_wireframe_edge_color ; tM = mix ( 1.0 , 0.0 , tN ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { tN = tL ( ) ; if ( gl_FrontFacing ) tQ = mix ( u_wireframe_edge_color , tE , tN ) ; else tQ = mix ( u_wireframe_edge_color , tF , tN ) ; tM = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { tN = u_cluster_id + u_debug_colors_seed + 2.0 ; tQ = vec3 ( fract ( tN * 19.73 ) , fract ( tN * 6.34 ) , fract ( tN * 1.56 ) ) ; tM = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { tN = u_batch_debug_id_color + u_debug_colors_seed ; tQ = vec3 ( fract ( tN * 19.73 ) , fract ( tN * 6.34 ) , fract ( tN * 1.56 ) ) ; tM = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { ; if ( u_debug_render_time_threshold > 0.0 ) tN = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else tN = 1.0 ; tO = clamp ( 2.0 * tN , 0.0 , 1.0 ) ; tP = clamp ( 2.0 * tN - 1.0 , 0.0 , 1.0 ) ; tN = tN ; tQ = mix ( tH , tI , vec3 ( tO , tP , tN ) ) ; tM = 1.0 ; }".split(" ")}]}}]},
{type:"textline",a:["bu","(","tQ",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"textline",a:"bx ( tQ , tM ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( tQ , tM ) ; }".split(" ")}]};a["debug_view.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],
group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",
";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{type:"textline",a:["varying","vec3","tB",";"]},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec3 uh , ui , uj , uk , ul ; mat4 um , un , uo ; if ( a_polyindex == 0.0 ) tB = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) tB = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) tB = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEBUG_VIEW_SPECIAL_SKYDOME"],group:{type:"group",b:[{type:"textline",a:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"um = O ( u_view_tsr ) ; un = O ( u_model_tsr ) ; uh = a_position ; ui = a_normal ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",b:[{type:"textline",a:"c up = rH ( uh , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , un ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"uh = mix ( uh , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uj = vec3 ( 0.0 ) ; uk = vec3 ( 0.0 ) ; sH ( uh , uj , uk , ui ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",
b:[{type:"textline",a:["uk","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uk = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"c up = ug ( uh , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , uk , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , um ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"uj = ( un * vec4 ( uk , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uo = rA ( u_camera_eye , uj , um , un ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uo = ru ( u_camera_eye , uj , um ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"ul = ( un * vec4 ( uk , 1.0 ) ) . xyz ; uo = uo * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ul ) ;".split(" ")}]}}]},{type:"textline",a:"c up = rH ( uh - uk , uk , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , uo ) ; up . b = uj ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c up = rH ( uh , uk , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , un ) ;".split(" ")}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"tv ( up . a , up . b , ui ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"gl_Position = u_proj_matrix * um * vec4 ( up . a , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["grass_map.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",
b:[{type:"textline",a:["varying","vec4","uh",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["varying","float","uh",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","uh",";"]}]}}]}]}}]},{type:"textline",a:["void","main","(",")","{"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",b:[{type:"textline",a:["gl_FragColor","=","uh",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( uh , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 , uh ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",
a:["}"]}]};a["grass_map.glslv"]={type:"group",b:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_grass_size",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",b:[{type:"if",
d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","uh",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["varying","float","uh",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","uh",";"]}]}}]}]}}]},{type:"textline",a:"void main ( ) { vec4 ui ; vec3 uj ; mat4 uk , ul , um ; uk = O ( u_view_tsr ) ; ul = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"uj = ( ul * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; um = ru ( u_camera_eye , uj , uk ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"um = um * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"c un = rH ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , um ) ; un . b = uj ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c un = rH ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ul ) ;".split(" ")}]}}]},
{type:"textline",a:"ui = u_proj_matrix * uk * vec4 ( un . a , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",b:[{type:"textline",a:"uh = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uh","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",b:[{type:"textline",a:["uh","=","a_grass_color",";"]}]}}]}]}}]},{type:"textline",a:["gl_Position","=","ui",";","}"]}]};a["halo.glslf"]={type:"group",b:[{type:"var",name:"NUM_LINES",a:["0"]},{type:"var",name:"NUM_RINGS",a:["0"]},{type:"var",name:"NUM_STARS",a:["0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 ui ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying float uj ;".split(" ")},
{type:"include",file:"color_util.glslf"},{type:"include",file:"halo_color.glslf"},{type:"textline",a:"void main ( ) { float uV ; vec3 uW ; vec4 uX ; uX = uU ( ) ; uW = uX . rgb ; uV = uX . a ; bu ( uW ) ; bx ( uW , uV ) ; gl_FragColor = vec4 ( uW , uV ) ; }".split(" ")}]};a["halo.glslv"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; attribute float a_random_vals ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; varying vec2 bM ; varying float uj ;".split(" ")},
{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","ui",";"]}]}}]},
{type:"textline",a:"void main ( ) { vec4 uV , uW ; vec3 uX ; mat4 uY , uZ , u_ ; uY = O ( u_view_tsr ) ; uZ = O ( u_model_tsr ) ; uX = ( uZ * vec4 ( a_position , 1.0 ) ) . xyz ; bM = a_halo_bb_vertex * 2.0 ; uj = a_random_vals ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"uZ = qZ ( uX , uY ) ; u_ = uY ; u_ [ 3 ] [ 0 ] = 0.0 ; u_ [ 3 ] [ 1 ] = 0.0 ; u_ [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"uZ = qZ ( uX , uY ) ;".split(" ")}]}}]},{type:"textline",a:"uV = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; uV = uZ * uV ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"uW = u_proj_matrix * u_ * uV ; uW . z = 0.99999 * uW . w ;".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["ui","=","uV",
";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uW = u_proj_matrix * uY * uV ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","uW",";","}"]}]};a["line.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform vec4 u_diffuse_color ; void main ( ) { float uV ; vec3 uW ; uW = u_diffuse_color . xyz ; uV = u_diffuse_color . a ; bu ( uW ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],
group:{type:"group",b:[{type:"textline",a:"bx ( uW , uV ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( uW , uV ) ; }".split(" ")}]};a["line.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ;".split(" ")},
{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"void main ( ) { mat2 uV ; float uW ; vec2 uX , uY ; vec4 uZ ; mat4 u_ , va ; u_ = O ( u_view_tsr ) ; va = O ( u_model_tsr ) ; c vb = rH ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , va ) ; uZ = u_proj_matrix * u_ * vec4 ( vb . a , 1.0 ) ; uZ . xyz /= uZ . w ; uX = ( u_proj_matrix * u_ * vec4 ( vb . e , 0.0 ) ) . xy ; uW = M_PI / 2.0 ; uV = mat2 ( cos ( uW ) , sin ( uW ) , - sin ( uW ) , cos ( uW ) ) ; uX = uV * normalize ( uX ) ; uY = ( u_line_width / u_height ) * vec2 ( u_proj_matrix [ 0 ] [ 0 ] / u_proj_matrix [ 1 ] [ 1 ] , 1.0 ) ; gl_Position = vec4 ( uZ . xy + uX . xy * uY / 2.0 , uZ . z , 1.0 ) ; gl_Position *= uZ . w ; }".split(" ")}]};
a["main.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"PARALLAX_STEPS",a:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",
name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",
";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],
group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],
group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:4}],
group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D",
"u_nodes_texture",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",
{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"nodes.glslf"},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec2 vB ; mat4 vC , vD , vE , vF , vG ; vec4 vH ; vec3 vI , vJ , vK , vL , vM ; float vN , vO , vP ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",
e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vN = length ( bD ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"vO = bC . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["vI","=","u_sun_intensity",";"]}]}}]},{type:"textline",a:"vJ = normalize ( u_camera_eye_frag - bC ) ; vC = mat4 ( 0.0 ) ; vD = mat4 ( 0.0 ) ; vE = mat4 ( 0.0 ) ; vF = mat4 ( 0.0 ) ; vG = mat4 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vC = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:"vD = O ( u_view_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"vE = O ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],
group:{type:"group",b:[{type:"textline",a:"vF = O ( u_model_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"vG = O ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"textline",a:"qS ( vJ , vC , vD , vE , vF , vG , vK , vL , vM , vH , vP ) ; vK = vK ; vP = vP ; vM = vM ; vH = vH ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WETTABLE"],group:{type:"group",b:[{type:"textline",a:"vK = max ( vK - sqrt ( 0.01 * - min ( vO , 0.0 ) ) , 0.5 * vK ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"textline",a:"bp ( vK , vO , u_time , vH , vM , u_sun_direction , vI , u_sun_quaternion , bC , vN ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( vP < 0.5 ) discard ; vP = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["vP","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"vA ( vK , length ( bD ) , vJ , vO ) ;".split(" ")}]}},{type:"else",
group:{type:"group",b:[{type:"textline",a:"vA ( vK , length ( bD ) , vJ , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vB = texture2DProj ( u_shadow_mask , bG ) . rg ; vO = vB . g ; vK = vec3 ( vO ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","vK",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",
e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( vK , vP ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( vK , vP ) ; }".split(" ")}]};a["main.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"NUM_CAST_LAMPS",a:["0"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},
{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:7}],group:{type:"group",b:[{type:"textline",a:["attribute",
"vec3","a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER",
"vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:"uniform mat4 u_view_matrix ; uniform mat3 u_view_tsr ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr",";"]}]}}]},{type:"textline",a:["uniform","mat4","u_proj_matrix",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"BILLBOARD","DYNAMIC_GRASS",{type:"logical_or_expr",e:3}],
group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],
group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_normal_offset",";"]},{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},
{type:"textline",a:["uniform","mat4","u_p_light_matrix0",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",
e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:7}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE",
"SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",
a:["varying","vec3","vB",";"]},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","vC",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",
b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2},
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec4 vP , vQ ; float vR ; vec3 vS , vT , vU , vV , vW , vX , vY ; mat4 vZ , v_ , wa , wb ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["vZ","=","u_view_matrix",";"]},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",
b:[{type:"textline",a:"v_ = O ( u_view_tsr ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vZ = O ( u_view_tsr ) ;".split(" ")}]}}]},{type:"textline",a:"wa = O ( u_model_tsr ) ; vS = a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"NODES",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:6}],group:{type:"group",
b:[{type:"textline",a:["vT","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vT = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vU = vec3 ( a_tangent ) ; vV = a_tangent [ 3 ] * cross ( vT , vU ) ;".split(" ")}]}},{type:"elif",
d:["NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vW = ( wa * vec4 ( a_position , 1.0 ) ) . xyz ; vX = normalize ( ( wa * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vW = vW - u_camera_eye ; vV = cross ( vW , vX ) ; vU = cross ( vX , vV ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vU = vec3 ( 0.0 ) ; vV = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"vS = mix ( vS , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"vT = mix ( vT , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],
group:{type:"group",b:[{type:"textline",a:"vX = vec3 ( a_tangent ) ; vW = a_tangent_next [ 3 ] * cross ( a_normal_next , vX ) ; vU = mix ( vU , vX , u_va_frame_factor ) ; vV = mix ( vV , vW , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sH ( vS , vU , vV , vT ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",
a:["vW","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vW = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"c wc = ug ( vS , vU , vV , vT , vW , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , vZ ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",
a:"vX = ( wa * vec4 ( vW , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"wb = rA ( u_camera_eye , vX , vZ , wa ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"wb = ru ( u_camera_eye , vX , vZ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"vY = ( wa * vec4 ( vW , 1.0 ) ) . xyz ; wb = wb * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vY ) ;".split(" ")}]}}]},{type:"textline",a:"c wc = rH ( vS - vW , vW , vU , vV , vT , wb ) ; wc . b = vX ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"c wc = rH ( vS , vW , vU , vV , vT , wa ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"vR = ( dot ( cross ( wc . e , wc . c ) , wc . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( wc . c , vR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"tv ( wc . a , wc . b , vT ) ;".split(" ")}]}}]},{type:"textline",a:"bC = wc . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"bE = wc . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"vB = u_camera_eye - wc . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"bM = rK ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],
group:{type:"group",b:[{type:"textline",a:"vC = wc . f ;".split(" ")}]}},{type:"elif",d:["VERTEX_COLOR"],group:{type:"group",b:[{type:"textline",a:["vC","=","a_color",";"]}]}}]}]}}]},{type:"textline",a:"vP = vZ * vec4 ( wc . a , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:"vQ = v_ * vec4 ( wc . a , 1.0 ) ; bD = vQ ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["bD","=","vP",";"]}]}}]}]}}]},{type:"textline",a:"vQ = u_proj_matrix * vP ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",
a:"vQ . xy += u_subpixel_jitter * vQ . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"bG = L ( vQ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vO ( wc . a , wc . e ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - vP . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:["tA","(",")",";"]}]}}]},{type:"textline",a:["gl_Position","=","vQ",";","}"]}]};a["main_stack.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",
a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"PARALLAX_STEPS",a:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",
a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"},
{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",
a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],
group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_colormap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC","ALPHA_AS_SPEC",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK"],
group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_normal_factor",
";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",b:[{type:"textline",a:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",a:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","PARALLAX",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_parallax_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_refr_bump",";"]}]}}]},{type:"textline",a:"varying vec3 bC ; varying vec3 bE ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",
{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"textline",a:["varying","vec3","vB",";"]},{type:"condition",
b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","vC",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",
1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4",
"bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",
b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"lighting_nodes.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",
file:"fog.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec4 xU , xV , xW , xX ; mat4 xY ; mat3 xZ ; vec2 x_ , ya , yb , yc ; vec3 yd , ye , yf , yg , yh , yi , yj , yk , yl ; float ym , yn , yo , yp , yq ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"ym = length ( bD ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"yn = bC . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",
b:[{type:"textline",a:["yd","=","u_sun_intensity",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:["x_","=","bM",";"]}]}}]},{type:"textline",a:"ye = normalize ( bE ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!","gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"ye = ye ; else ye = - ye ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:"yf = cross ( ye , bF . xyz ) * bF . w ; xZ = mat3 ( bF . xyz , yf , ye ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFRACTIVE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xY = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"ya = normalize ( xY * vec4 ( bE , 0.0 ) ) . st ; ya = ya * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( ym < PARALLAX_LOD_DIST ) { yo = clamp ( 0.5 * ( PARALLAX_LOD_DIST - ym ) , 0.0 , 1.0 ) ; yo = u_parallax_scale * yo ; yf = normalize ( vB * xZ ) ; yp = 1.0 / PARALLAX_STEPS ; yb = yf . xy * yo / ( PARALLAX_STEPS * yf . z ) ; yo = 1.0 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["yc","=","ya",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["yc","=","x_",";"]}]}}]},{type:"textline",a:"yq = texture2D ( u_normalmap0 , yc ) . a ; for ( float yr = 1.0 ; yr <= PARALLAX_STEPS ; yr ++ ) { if ( yq < yo ) { yo -= yp ; yc -= yb ; yq = texture2D ( u_normalmap0 , yc ) . a ; } } yb = yc + yb ; yp = texture2D ( u_normalmap0 , yb ) . a - ( yo + yp ) ; yo = yq - yo ; yp = yo / ( yo - yp ) ; yc = yp * yb + ( 1.0 - yp ) * yc ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"x_ += yc - ya ;".split(" ")}]}}]},{type:"textline",a:["ya","=","yc",";"]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"ya += yc - x_ ;".split(" ")}]}}]},{type:"textline",a:["x_","=","yc",";"]}]}}]},
{type:"textline",a:["}"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",b:[{type:"textline",a:[";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xU = texture2D ( u_normalmap0 , ya ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xU = texture2D ( u_normalmap0 , x_ ) ;".split(" ")}]}}]},{type:"textline",a:"yf = xU . rgb - 0.5 ; yf = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , yf , u_normal_factor ) ; yf = xZ * yf ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["yf","=","ye",";"]}]}}]},{type:"textline",a:"yf = normalize ( yf ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"ya = normalize ( xY * vec4 ( yf , 0.0 ) ) . st ; ya = ya * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:"ye = normalize ( vB ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"yg = vC ; br ( yg ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xU = vec4 ( yg , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["xU","=","u_diffuse_color",";"]}]}}]},{type:"textline",a:["yp","=","1.0",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"xV = texture2D ( u_colormap0 , ya ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xV = texture2D ( u_colormap0 , x_ ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",b:[{type:"textline",a:"br ( xV . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",b:[{type:"textline",a:[";"]},
{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xW = texture2D ( u_colormap1 , ya ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xW = texture2D ( u_colormap1 , x_ ) ;".split(" ")}]}}]},{type:"textline",a:"br ( xW . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"xX = texture2D ( u_stencil0 , ya ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"xX = texture2D ( u_stencil0 , x_ ) ;".split(" ")}]}}]},{type:"textline",a:"xV = mix ( xV , xW , xX . r ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xU . rgb = mix ( xU . rgb , xV . rgb , u_diffuse_color_factor ) ; yo = u_alpha_factor * xV . a ; yo += ( 1.0 - step ( 0.0 , yo ) ) ; xU . a = mix ( yo , 1.0 , u_diffuse_color . a ) ; yp = xV . a ;".split(" ")}]}},
{type:"elif",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"xU . rgb *= mix ( vec3 ( 1.0 ) , xV . rgb , u_diffuse_color_factor ) ; xU . a = xV . a ; yp = xV . a ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS"],group:{type:"group",b:[{type:"textline",a:"yg = xU . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"yh = u_diffuse_intensity * xU . rgb ; yi = u_environment_energy * dS ( yf ) ; yi = u_ambient * yi ; xV = du ( yh ) ; yj = u_emit * xU . rgb ; yk = u_specular_color ;".split(" ")},
{type:"condition",b:[{type:"if",d:["TEXTURE_SPEC"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["ALPHA_AS_SPEC"],group:{type:"group",b:[{type:"textline",a:"yl = vec3 ( yp ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"yl = texture2D ( u_specmap0 , ya ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"yl = texture2D ( u_specmap0 , x_ ) . rgb ;".split(" ")}]}}]},
{type:"textline",a:"br ( yl . rgb ) ; yk = mix ( yk , yl , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",a:"yp = u_specular_params [ 0 ] ; x_ = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; yk = yp * yk ; xT ( yj , yi , yh , yk , bC , yf , ye , x_ , u_diffuse_params , xV , 0.0 , vec4 ( 0.0 ) , yg , yl ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},
{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",b:[{type:"textline",a:"dP ( yg , ye , yf , u_reflect_factor , xY ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dP ( yg , ye , yf , u_reflect_factor , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",
b:[{type:"textline",a:"dP ( yg , ye , yf , 0.0 , xY ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dP ( yg , ye , yf , 0.0 , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["yg","+=","yl",";"]}]}}]},{type:"textline",a:"yp = xU . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WETTABLE"],group:{type:"group",b:[{type:"textline",a:"yg = max ( yg - sqrt ( 0.01 * - min ( yn , 0.0 ) ) , 0.5 * yg ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"textline",a:"bp ( yg , yn , u_time , xV , yf , u_sun_direction , yd , u_sun_quaternion , bC , ym ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( yp < 0.5 ) discard ; yp = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"yo = max ( max ( yl . r , yl . g ) , yl . b ) * u_specular_alpha ; yp = xU . a * ( 1.0 - yo ) + yo ;".split(" ")}]}}]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["yp","=","1.0",
";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"x_ = - ( xY * vec4 ( yf , 0.0 ) ) . xy ; yg = mix ( ef ( bG , x_ * u_refr_bump ) , yg , yp ) ; yp = 1.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"vA ( yg , ym , ye , yn ) ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:"vA ( yg , ym , ye , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:["bu","(","yg",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( yg , yp ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( yg , yp ) ; }".split(" ")}]};a["particle_system.glslf"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},
{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","NODES",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",a:["0"]},{type:"var",name:"SOFT_STRENGTH",a:["1.0"]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform",
"mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR",
"USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:7}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"textline",a:["varying","vec3","bE",";"]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"particles_nodes.glslf"},{type:"textline",a:"void main ( ) { mat4 Kv , Kw , Kx , Ky , Kz ; float KA , KB , KC ; vec4 KD ; vec3 KE , KF , KG , KH ; KE = normalize ( u_camera_eye_frag - bC ) ; Kv = mat4 ( 0.0 ) ; Kw = mat4 ( 0.0 ) ; Kx = mat4 ( 0.0 ) ; Ky = mat4 ( 0.0 ) ; Kz = mat4 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Kv = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:"Kw = O ( u_view_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"Kx = O ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:"Ky = O ( u_model_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"Kz = O ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"textline",a:"Ku ( KE , Kv , Kw , Kx , Ky , Kz , KF , KG , KH , KD , KA ) ; KF = KF ; KA = KA ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",
b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( KA < 0.5 ) discard ; KA = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["KA","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"vA ( KF , length ( bD ) , KE , 1.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"KB = - bD . z / u_view_max_depth ; KD = texture2DProj ( u_scene_depth , bG ) ; KC = Z ( KD ) ; KB = KC - KB ; KB = u_view_max_depth / SOFT_STRENGTH * KB ; KA = KA * min ( KB , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:["bu","(","KF",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( KF , KA ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( KF , KA ) ; }".split(" ")}]};a["particle_system.glslv"]={type:"group",b:[{type:"var",name:"BILLBOARD_ALIGN",a:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",a:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",a:["0"]},{type:"define",
name:"BILLBOARD_ALIGN_VIEW",a:["1"]},{type:"define",name:"BILLBOARD_ALIGN_XY",a:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",a:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",a:["4"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute vec3 a_p_data ; attribute vec4 a_p_vels ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["attribute","vec4","a_tangent",";"]}]}}]},{type:"textline",a:["attribute","vec2","a_p_bb_vertex",";"]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",a:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_view_matrix",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr",";"]}]}}]},{type:"textline",a:"uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",b:[{type:"if",d:["WORLD_SPACE",{type:"logic_negative_expr",e:1},"NODES","HALO_PARTICLES",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_COLOR_RAMP"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["varying","float","Kv",";"]}]}}]},
{type:"textline",a:["varying","vec3","vC",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:8}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec2","bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","vB",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","float","uj",";"]}]}}]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"particles.glslv"},
{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"particles_nodes.glslv"}]}}]},{type:"textline",a:"float Li ( vec2 Lg , vec2 Lh ) { return ( atan ( Lh . y , Lh . x ) - atan ( Lg . y , Lg . x ) ) ; } void main ( ) { vec3 Lj , Lk ; vec4 Ll , Lm , Ln ; float Lo , Lp , Lq ; mat4 Lr , Ls ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_PASS"],group:{type:"group",b:[{type:"textline",a:["Lr","=","u_view_matrix",";"]}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Lr = O ( u_view_tsr ) ;".split(" ")}]}}]},{type:"textline",a:"Kw Lt ; Lt = KY ( ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { Lo = Lt . e ; Ls = qZ ( Lt . b , Lr ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { Lo = Lt . e ; Ls = w ( ) ; Ls [ 3 ] = vec4 ( Lt . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { Lo = Lt . e ; Ls = A ( radians ( 90.0 ) ) ; Ls [ 3 ] = vec4 ( Lt . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { Lo = Li ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + Lt . e ; Ls = y ( radians ( - 90.0 ) ) ; Ls [ 3 ] = vec4 ( Lt . b , 1.0 ) ; } Ll = vec4 ( a_p_bb_vertex * 2.0 * Lt . a * u_p_size , 0.0 , 1.0 ) ; Lp = a_p_data [ 2 ] ; Lq = u_p_tilt * u_p_tilt_rand * ( 2.0 * Lp - 1.0 ) ; Lq = ( Lq + u_p_tilt ) * M_PI ; Ll = Ls * C ( Lq + Lo ) * Ll ; Lm = Lr * Ll ; Ln = u_proj_matrix * Lm ;".split(" ")},
{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["uj","=","Lp",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lj = vec3 ( a_tangent ) ; Lk = a_tangent [ 3 ] * cross ( a_normal , Lj ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Lj = vec3 ( 0.0 ) ; Lk = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"c Lu = rH ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Lj , Lk , vec3 ( 0.0 ) , Ls * C ( Lo ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lo = ( dot ( cross ( a_normal , Lu . c ) , Lu . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( Lu . c , Lo ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["bE","=","a_normal",";"]}]}}]},{type:"textline",a:"Lf ( Lt . b , Lt . f , Lt . g , Lt . h , Lt . a , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],
group:{type:"group",b:[{type:"textline",a:"bM = a_p_bb_vertex + 0.5 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"bM = a_p_bb_vertex * 2.0 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Kv = Lt . c ;".split(" ")}]}}]},{type:"textline",a:"vC = Lt . d ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"Lo = Ln . x ; Lp = Ln . y ; Lq = Ln . w ; bG . x = ( Lo + Lq ) / 2.0 ; bG . y = ( Lp + Lq ) / 2.0 ; bG . z = Lq ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["bD","=","Lm",";"]}]}}]},{type:"textline",a:"gl_Position = Ln ; bC = Ll . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vB = u_camera_eye - Ll . xyz ;".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["particle_system_stack.glslf"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"var",name:"NUM_VALUES",a:["0"]},
{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","NODES",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",a:["0"]},{type:"var",name:"SOFT_STRENGTH",a:["1.0"]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",
{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"textline",a:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",
a:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{type:"textline",a:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:8}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",
b:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:["varying","float","Kv",";"]}]}}]},{type:"textline",a:["varying","vec3","vC",";"]}]}}]},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["varying","vec3","vB",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"NODES",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:["varying","float","uj",";"]},{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","ui",";"]}]}}]}]}}]},
{type:"include",file:"lighting_nodes.glslf"},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"environment.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"include",file:"halo_color.glslf"}]}}]},{type:"textline",a:"void main ( ) { vec2 Lg ; float Lh , Li , Lj ; vec4 Lk , Ll ; vec3 Lm , Ln , Lo , Lp , Lq , Lr , Ls , Lt ;".split(" ")},
{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1},"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lm = normalize ( vB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["HALO_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"Lk = uU ( ) ; Ln = Lk . rgb * vC ; Lh = 0.9 * length ( bM ) ; Lh = smoothstep ( u_p_alpha_start , u_p_alpha_end , Lh ) ; Lh = Lk . a * ( 1.0 - Lh ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["Lk","=","u_diffuse_color",";"]},{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"Ll = texture2D ( u_sampler , bM ) ; br ( Ll . rgb ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lk . rgb = mix ( Lk . rgb , Ll . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lk . rgb *= mix ( vec3 ( 1.0 ) , Ll . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",a:"Lk . a = Ll . a ;".split(" ")}]}}]},{type:"textline",a:"Lk . rgb *= vC ;".split(" ")},{type:"condition",b:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Lo = u_diffuse_intensity * Lk . rgb ; Lp = u_emit * Lk . rgb ; Lq = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logic_negative_expr",e:1},"SKY_COLOR",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"Lr = u_environment_energy * dS ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lr = u_environment_energy * dS ( Lq ) ;".split(" ")}]}}]},{type:"textline",a:"Lr = u_ambient * Lr ; Li = u_specular_params [ 0 ] ; Lg = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; Ls = Li * u_specular_color ; xT ( Lp , Lr , Lo , Ls , bC , Lq , Lm , Lg , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , Ln , Lt ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Ln = Lk . rgb ;".split(" ")}]}}]},{type:"textline",a:"Lh = Lk . a * Kv ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",b:[{type:"textline",a:"if ( Lh < 0.5 ) discard ; Lh = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Lh","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"vA ( Ln , length ( bD ) , Lm , 1.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",b:[{type:"textline",a:"Li = - bD . z / u_view_max_depth ; Lk = texture2DProj ( u_scene_depth , bG ) ; Lj = Z ( Lk ) ; Li = Lj - Li ; Li = u_view_max_depth / SOFT_STRENGTH * Li ; Lh = Lh * min ( Li , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","Ln",")",";"]},{type:"condition",b:[{type:"if",d:["ALPHA","ALPHA_CLIP",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bx ( Ln , Lh ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( Ln , Lh ) ; }".split(" ")}]};a["procedural_skydome.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 Lg ; const float Lh = 0.99 ; const float Li = 1.8 ; const int Lj = 8 ; float Lp ( vec3 Lk , vec3 Ll ) { float Lm , Ln , Lo ; Lm = dot ( Ll , Ll ) ; Ln = 2.0 * dot ( Ll , Lk ) ; Lo = dot ( Lk , Lk ) - 1.0 ; Lm = Ln * Ln - 4.0 * Lm * Lo ; Lm = sqrt ( Lm ) ; Lm = ( - Ln - Lm ) / 2.0 ; Lm = Lo / Lm ; return Lm ; } float Lw ( float Lq , float Lr ) { float Ls , Lt , Lu , Lv ; Ls = 3.0 * ( 1.0 - Lr * Lr ) ; Lt = 2.0 * ( 2.0 + Lr * Lr ) ; Lu = 1.0 + Lq * Lq ; Lv = pow ( 1.0 + Lr * Lr - 2.0 * Lr * Lq , 1.5 ) ; Lv = max ( Lv , 0.00001 ) ; return ( Ls / Lt ) * ( Lu / Lv ) ; } float LC ( vec3 Lx , vec3 Ly , float Lz ) { vec3 LA ; float LB ; LB = dot ( Ly , - Lx ) ; if ( LB < 0.0 ) { return 1.0 ; } LA = Lx + LB * Ly ; if ( length ( LA ) < Lz ) { return 0.0 ; } else if ( length ( LA ) >= Lz ) { LA = normalize ( LA ) * Lz - Lx ; LB = acos ( dot ( normalize ( LA ) , Ly ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( LB * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 LG ( float LD , vec3 LE , float LF ) { return LE - LE * pow ( u_sky_color , vec3 ( LF / LD ) ) ; } void main ( ) { float LH , LI , LJ , LK , LL , LM , LN , LO , LP ; vec3 LQ , LR , LS , LT , LU , LV , LW ; LQ = normalize ( Lg ) ; LR = u_sun_direction ; LH = dot ( LQ , LR ) ; LI = Lw ( LH , - 0.01 ) * u_rayleigh_brightness * LR . y ; LJ = Lw ( LH - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - LR . y ) ; LH = smoothstep ( 0.0 , 100.0 , Lw ( LH , 0.9995 ) ) * u_spot_brightness ; LS = vec3 ( 0.0 , Lh , 0.0 ) ; LK = Lp ( LS , LQ ) ; LL = LK / float ( Lj ) ; LM = LC ( LS , LQ , Lh - 0.3 ) ; LT = vec3 ( 0.0 , 0.0 , 0.0 ) ; LU = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int LX = 0 ; LX < Lj ; LX ++ ) { LN = LL * float ( LX ) ; LV = LS + LQ * LN ; LO = LC ( LV , LR , Lh - 0.2 ) ; LP = Lp ( LV , LR ) ; LW = LG ( LP , vec3 ( Li ) , u_scatter_strength ) * LO ; LT += LG ( sqrt ( LN ) , u_sky_color * LW , u_rayleigh_strength ) ; LU += LG ( LN , LW , u_mie_strength ) ; } LT = LT * LM * pow ( LK , u_rayleigh_collection_power ) / float ( Lj ) ; LU = ( LU * LM * pow ( LK , u_mie_collection_power ) ) / float ( Lj ) ; LT = vec3 ( LH * LU + LJ * LU + LI * LT ) ; bu ( LT ) ; gl_FragColor = vec4 ( LT , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 Lg ; void main ( ) { vec4 Lh , Li ; Lh = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; Li = u_cube_view_matrix * Lh ; Lg = Li . xyz ; gl_Position = Lh ; }".split(" ")}]};a["shadow.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",a:["0"]},{type:"var",name:"NUM_VALUES",
a:["0"]},{type:"var",name:"NUM_RGBS",a:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",
a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"condition",
b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1},"NODES","ALPHA",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"include",file:"procedural.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"pack.glslf"},{type:"condition",b:[{type:"if",d:["CAUSTICS"],group:{type:"group",b:[{type:"include",file:"caustics.glslf"}]}}]},
{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],
group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",
d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"textline",a:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",b:[{type:"textline",a:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},
{type:"textline",a:["uniform","vec4","u_diffuse_color",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",b:[{type:"if",d:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",
e:1},"NODES","ALPHA",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["USE_REFRACTION"],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",a:"void main ( ) { mat4 Lh , Li , Lj , Lk , Ll ; float Lm , Ln ; vec4 Lo ; vec3 Lp , Lq , Lr , Ls ;".split(" ")},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NODES"],group:{type:"group",b:[{type:"textline",a:"Lp = u_camera_eye_frag - bC ; Lp = normalize ( Lp ) ; Lh = mat4 ( 0.0 ) ; Li = mat4 ( 0.0 ) ; Lj = mat4 ( 0.0 ) ; Lk = mat4 ( 0.0 ) ; Ll = mat4 ( 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_GEOMETRY_VW",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lh = O ( u_view_tsr_frag ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX"],group:{type:"group",b:[{type:"textline",a:"Li = O ( u_view_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_VIEW_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"Lj = O ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX"],group:{type:"group",b:[{type:"textline",a:"Lk = O ( u_model_zup_tsr ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_ZUP_MODEL_MATRIX_INVERSE"],group:{type:"group",b:[{type:"textline",a:"Ll = O ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{type:"textline",a:"qS ( Lp , Lh , Li , Lj , Lk , Ll , Lq , Lr , Ls , Lo , Lm ) ; Lm = Lm ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],
group:{type:"group",b:[{type:"textline",a:"Lm = ( texture2D ( u_colormap0 , bM ) ) . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Ln = u_alpha_factor * Lm ; Ln += ( 1.0 - step ( 0.0 , Ln ) ) ; Lm = mix ( Ln , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lm = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",
a:"if ( Lm < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","NO_SHADOWS",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = dr ( bD . z ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor . a *= clamp ( bF . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:["}"]}]};a["shadow.glslv"]={type:"group",b:[{type:"var",name:"AU_QUALIFIER",a:["uniform"]},{type:"var",name:"MAX_BONES",a:["0"]},{type:"var",name:"NUM_CAST_LAMPS",a:["0"]},{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",
a:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND",
"DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_bending_col_main",";"]},{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_position_next",";"]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["attribute","vec3","a_normal_next",";"]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1},
"TEXTURE_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3","u_model_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",
a:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform",
"mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",a:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1},"TEXTURE_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","float","u_normal_offset",";"]},{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{type:"textline",a:["uniform","mat4","u_p_light_matrix0",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1",
"NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bC",";"]},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bF",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bD",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bI",";"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bJ",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bK",";"]}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","bL",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]}]}}]},{type:"include",file:"dynamic_grass.glslv"},
{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",a:"void main ( ) { vec2 Lh ; vec4 Li , Lj ; float Lk ; vec3 Ll , Lm , Ln , Lo , Lp , Lq ; mat4 Lr , Ls , Lt , Lu ; Lr = O ( u_view_tsr ) ; Ll = a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:["Lm","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lm = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",
a:"Ln = vec3 ( a_tangent ) ; Lo = a_tangent [ 3 ] * cross ( Lm , Ln ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ln = vec3 ( 0.0 ) ; Lo = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",b:[{type:"textline",a:"Ll = mix ( Ll , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"Lm = mix ( Lm , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"Lp = vec3 ( a_tangent ) ; Lq = a_tangent_next [ 3 ] * cross ( a_normal_next , Lp ) ; Ln = mix ( Ln , Lp , u_va_frame_factor ) ; Lo = mix ( Lo , Lq , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"textline",a:"sH ( Ll , Ln , Lo , Lm ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["Lo","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lo = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",
a:"c Lv = ug ( Ll , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Lm , Lo , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , Lr ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Ls = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"Ln = ( Ls * vec4 ( Lo , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",b:[{type:"if",d:["HAIR_BILLBOARD",{type:"logic_negative_expr",
e:1},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lt = O ( u_shadow_cast_billboard_view_tsr ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Lt","=","Lr",";"]}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lu = rA ( u_camera_eye , Ln , Lt , Ls ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Lu = ru ( u_camera_eye , Ln , Lt ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lu = Lu * rm ( u_wind , u_time , u_jitter_amp , u_jitter_freq , Ln ) ;".split(" ")}]}}]},{type:"textline",a:"c Lv = rH ( Ll - Lo , Lo , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Lm , Lu ) ; Lv . b = Ln ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"c Lv = rH ( Ll , Lo , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Lm , Ls ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["Lm","=","a_normal",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Lm = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:"tv ( Lv . a , Lv . b , Lm ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bC = Lv . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"bE = Lv . e ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",
a:"Lk = ( dot ( cross ( Lv . e , Lv . c ) , Lv . d ) < 0.0 ) ? - 1.0 : 1.0 ; bF = vec4 ( Lv . c , Lk ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"Li = Lr * vec4 ( Lv . a , 1.0 ) ; Lj = u_proj_matrix * Li ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",b:[{type:"textline",a:"Lj . xy += u_subpixel_jitter * Lj . w ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bG = L ( Lj ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bH = - Li . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["tA","(",")",";"]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["TEXTURE_COLOR"],group:{type:"group",b:[{type:"textline",a:"bM = rK ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vO ( Lv . a , Lv . e ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["bD","=","Li",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Lh = ( u_proj_matrix * Lr [ 3 ] ) . xy ; Lk = SHADOW_TEX_RES / 2.0 ; Lh = floor ( Lh * Lk + 0.5 ) / Lk - Lh ; Lj . xy += Lh ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","Lj",";","}"]}]};a["special_lens_flares.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},
{type:"textline",a:"uniform sampler2D u_sampler ; varying vec2 bM ; void main ( ) { vec4 Lh ; Lh = texture2D ( u_sampler , bM ) ; bu ( Lh . rgb ) ; bx ( Lh . rgb , Lh . a ) ; gl_FragColor = Lh ; }".split(" ")}]};a["special_lens_flares.glslv"]={type:"group",b:[{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"define",name:"LIGHT_INDEX",a:["0"]},{type:"include",file:"math.glslv"},{type:"textline",a:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 bM ; void main ( ) { vec2 Lh ; float Li ; vec4 Lj ; vec3 Lk ; mat4 Ll ; Ll = O ( u_view_tsr ) ; bM = a_texcoord ; Lk = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; Lj = u_proj_matrix * Ll * vec4 ( Lk , 0.0 ) ; Lj . x /= Lj . w ; Lj . y /= Lj . w ; Lj += 99999.0 * step ( Lj . z , 0.0 ) ; Lj += 100.0 * ( step ( 1.0 , abs ( Lj . x ) ) + step ( 1.0 , abs ( Lj . y ) ) ) ; Lj . x = - a_lf_dist * Lj . x ; Lj . y = - a_lf_dist * Lj . y ; Li = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; Lh = vec2 ( a_lf_bb_vertex . x / Li , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float Lm = 1.9 ; Lh *= ( 1.0 + Lm * length ( Lj . xy ) ) ; } gl_Position = vec4 ( Lj . xy + Lh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",b:[{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"define",name:"INV_PI",a:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",b:[{type:"if",d:["WO_SKYTEX","PROCEDURAL_SKYDOME",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX",
{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"blending.glslf"},{type:"textline",a:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 Nl ( vec3 Ng , vec3 Nh , float Ni , float Nj ) { float Nk ; Nk = Ni * Nj ;".split(" ")},{type:"condition",b:[{type:"if",d:["BLENDTYPE","MIX",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lv ( Nh , Ng , Nk ) ;".split(" ")}]}},
{type:"elif",d:["BLENDTYPE","ADD",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lz ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SUBTRACT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LD ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LI ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SCREEN",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"return LN ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","OVERLAY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LS ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LW ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIVIDE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"return L_ ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DARKEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Md ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LIGHTEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mh ( Ng , Nh , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","HUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mn ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",
d:["BLENDTYPE","SATURATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mt ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","VALUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mz ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","COLOR",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MF ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SOFT_LIGHT",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"return MK ( Nh , Ng , Nk ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MO ( Nh , Ng , Nk ) ;".split(" ")}]}}]},{type:"textline",a:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Nt ( float Nm , float Nn , float No , float Np ) { float Nq ; vec3 Nr , Ns ; Nr = vec3 ( Nm ) , Ns = vec3 ( Nn ) ; Nq = No * Np ;".split(" ")},{type:"condition",b:[{type:"if",d:["BLENDTYPE","MIX",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lv ( Ns , Nr , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","ADD",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Lz ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SUBTRACT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LD ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"return MU ( Nm , Nn , Nq , Np ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SCREEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return M_ ( Nm , Nn , Nq , Np ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","OVERLAY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Nf ( Nm , Nn , Nq , Np ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return LW ( Nr , Ns , Nq ) . x ;".split(" ")}]}},
{type:"elif",d:["BLENDTYPE","DIVIDE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return L_ ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DARKEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Md ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LIGHTEN",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return Mh ( Nr , Ns , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SOFT_LIGHT",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MK ( Ns , Nr , Nq ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return MO ( Ns , Nr , Nq ) . x ;".split(" ")}]}}]},{type:"textline",a:["return","0.0",";","}"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"REFLECTION_PASS",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{type:"textline",a:["varying","vec3","Lg",";"]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",
e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:"void main ( ) { vec4 Nu ; float Nv , Nw , Nx ; vec3 Ny , Nz , NA , NB , NC ; Nz = normalize ( Lg ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME"],group:{type:"group",b:[{type:"textline",a:"Ny = textureCube ( u_sky , Nz ) . rgb ;".split(" ")}]}},{type:"elif",d:["WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"Ny = u_horizon_color ; bu ( Ny ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:[";"]},{type:"condition",b:[{type:"if",d:["WO_SKYPAPER"],group:{type:"group",b:[{type:"textline",a:"NA = vec3 ( bM , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NA = vec3 ( Lg . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:["Nv","=","0.0",";"]},{type:"condition",b:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["WO_SKYPAPER"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",b:[{type:"textline",a:"Nv = abs ( bM . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nv = ( bM . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nw = acos ( Nz . y ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",b:[{type:"textline",a:"Nv = abs ( Nw * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Nv = 1.0 - Nw * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",a:"NB = u_horizon_color ; NC = u_zenith_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYTEX"],group:{type:"group",b:[{type:"textline",a:"Nw = 1.0 ; Nu = textureCube ( u_sky , Nz ) ; br ( Nu . rgb ) ; Nw = Nu . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT"],group:{type:"group",b:[{type:"textline",a:"Nw = bB ( Nu ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["MTEX_NEGATIVE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Nu = vec4 ( vec3 ( 1.0 ) - Nu . rgb , Nu . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nw = 1.0 - Nw ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["MTEX_RGBTOINT"],group:{type:"group",b:[{type:"textline",a:"Nu = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nw = Nu . a ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_HORIZ"],group:{type:"group",b:[{type:"textline",a:"NB = Nl ( Nu . rgb , NB , Nw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:["Nx","=","0.0",";"]},{type:"condition",b:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",b:[{type:"textline",a:"if ( dot ( NA , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP"],group:{type:"group",b:[{type:"textline",a:"Nx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:[";"]}]}}]},{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["WOMAP_ZENDOWN"],group:{type:"group",b:[{type:"textline",
a:"else Nx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WOMAP_ZENUP"],group:{type:"group",b:[{type:"textline",a:"Nx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",d:["WOMAP_ZENDOWN"],group:{type:"group",b:[{type:"textline",a:"Nx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",a:"if ( Nx != 0.0 ) NC = Nl ( Nu . rgb , NC , Nw , Nx ) ;".split(" ")}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WOMAP_BLEND"],
group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MTEX_RGBTOINT",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Nw = dot ( Nu . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",a:"Nv = Nt ( u_sky_tex_dvar , Nv , Nw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",b:[{type:"textline",a:"Ny = mix ( NB , NC , Nv ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:["Ny","=","NB",";"]}]}}]},{type:"textline",a:["bu","(","Ny",")",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"bu ( NB ) ; bu ( NC ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",b:[{type:"textline",a:"Ny = mix ( NB , NC , Nv ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Ny","=","NB",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"REFLECTION_PASS",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"br ( Ny ) ; Nv = WATER_LEVEL - u_camera_eye_frag . y ; NB = vec3 ( 0.0 ) ; NB = mix ( u_underwater_fog_color_density . rgb , NB , min ( - Nz . y , 1.0 ) ) ; NB *= min ( 1.0 - min ( 0.03 * Nv , 0.8 ) , 1.0 ) ; Nv = clamp ( sign ( 0.01 * Nv - Nz . y ) , 0.0 , 1.0 ) ; Ny = mix ( Ny , NB , Nv ) ; bu ( Ny ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( Ny , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 Lg ;".split(" ")},{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"textline",a:"void main ( ) { vec4 Ng , Nh ; Ng = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; Nh = u_sky_vp_inverse * Ng ; Lg = Nh . xyz ;".split(" ")},
{type:"condition",b:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bM = a_position . xy ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","Ng",";","}"]}]};a["special_water.glslf"]={type:"group",b:[{type:"var",name:"ABSORB",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"SSS_STRENGTH",a:["6.0"]},{type:"var",name:"SSS_WIDTH",
a:["0.0"]},{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NUM_LFACTORS",a:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",a:["0.001"]},{type:"define",name:"REFR_BUMP",a:["0.0005"]},{type:"textline",a:["uniform","float","u_time",";"]},{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",a:["uniform","float","u_environment_energy",";"]},{type:"condition",b:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",a:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],
group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:["uniform","vec4","u_fog_params",
";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_plane_reflection",";"]}]}},
{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",a:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2",
"u_normalmap2_scale",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:"const float Ng = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",a:"varying vec3 vB ; varying vec3 bC ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bF ; varying vec3 Nh ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","Ni",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","Nj",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",
e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","tB",";"]}]}}]},{type:"include",
file:"environment.glslf"},{type:"condition",b:[{type:"if",d:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"include",file:"refraction.glslf"}]}}]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",a:"vec3 Nv ( in vec2 Nk , in vec3 Nl , in vec3 Nm , in vec3 Nn , out float No ) { float Np , Nq , Nr ; vec2 Ns ; vec3 Nt , Nu ; No = 0.0 ; Nt = reflect ( - Nm , Nl ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Ns = Nk . xy + Nl . xz * REFL_BUMP / bH ; No = u_reflect_factor ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nu = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:"Nu = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",a:"} else { Nu = texture2D ( u_plane_reflection , Ns ) . rgb ; br ( Nu ) ; }".split(" ")}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"No = u_mirror_factor ; Nu = Nn * textureCube ( u_mirrormap , Nt ) . rgb ; br ( Nu ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"No = u_reflect_factor ; Nu = Nn * vec3 ( 0.3 , 0.5 , 1.0 ) ; br ( Nu ) ;".split(" ")}]}}]},
{type:"textline",a:"Nt = normalize ( Nt + Nm ) ; Np = 1.0 - dot ( Nm , Nt ) ; Nq = u_fresnel_params [ 3 ] ; Nr = u_fresnel_params [ 2 ] ; Nr = Nq + ( 1.0 - Nq ) * pow ( Np , Nr ) ; No = min ( No * Nr , 1.0 ) ; return Nu ; }".split(" ")},{type:"include",file:"lighting_nodes.glslf"},{type:"textline",a:"void main ( ) { vec4 Nw ; vec2 Nx , Ny , Nz ; float NA , NB , NC , ND , NE ; vec3 NF , NG , NH , NI , NJ , NK , NL , NM , NN ; mat3 NO ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",
0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NO = mat3 ( bF , Nh , bE ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NF = normalize ( bE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NF = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","FOAM",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NA = bC . y - WATER_LEVEL ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"Nx = vec2 ( Ni . x , - Ni . z ) + 0.5 ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Nx = vec2 ( bC . x , - bC . z ) + 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:["Nx","=","bM",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NG = vec3 ( 0.0 ) ; NH = texture2D ( u_normalmap0 , Nx * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; NG += NH ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"NI = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NORM_FOAM0"],
group:{type:"group",b:[{type:"textline",a:["NI","+=","NH",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NH = texture2D ( u_normalmap0 , Nx * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; NG += NH ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM1"],group:{type:"group",b:[{type:"textline",
a:["NI","+=","NH",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NH = texture2D ( u_normalmap0 , Nx * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; NG += NH ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM2"],group:{type:"group",b:[{type:"textline",a:["NI","+=","NH",";"]}]}}]}]}}]}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NH = texture2D ( u_normalmap0 , Nx * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; NG += NH ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NORM_FOAM3"],group:{type:"group",b:[{type:"textline",a:["NI","+=","NH",";"]}]}}]}]}}]}]}}]},{type:"condition",b:[{type:"if",
d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"NI = NO * NI ; if ( ! f ( NI , vec3 ( 0.0 ) ) ) NI = normalize ( NI ) ; NI = mix ( NF , NI , 0.2 ) ; NI = normalize ( NI ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NF = mix ( NF , normalize ( NO * NG ) , 0.3 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"NF = mix ( NF , normalize ( NO * NG ) , 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:"NF = normalize ( NF ) ;".split(" ")}]}}]},{type:"textline",a:"NG = normalize ( vB ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Ny = bG . xy / bG . z ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"Nz = Ny + NF . xz * u_refr_bump / bH ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:"NB = u_diffuse_color . a ; Nw = texture2DProj ( u_scene_depth , bG ) ; NC = Z ( Nw ) ; ND = max ( NC - bH , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"NC = dY ( NC , Nz , Ny ) ; NC = max ( NC - bH , 0.0 ) ; NC = u_view_max_depth / ABSORB * NC ; NC = min ( NB * NC , 1.0 ) ; NB = min ( 15.0 * NB * u_view_max_depth * ND , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"NE = u_view_max_depth / ABSORB * ND ; if ( u_cam_water_depth > 0.0 ) NB = min ( NB * NE , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NB = u_diffuse_color . a ;".split(" ")},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:["NC","=","NB",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"if ( u_cam_water_depth < 0.0 ) NC = 0.0 ; NH = texture2D ( u_refractmap , Nz ) . rgb ; br ( NH ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"NE = pow ( min ( Nj . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; NJ = mix ( u_shallow_water_col , u_diffuse_color . rgb , NE ) ; NE = pow ( min ( Nj . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; NJ = mix ( u_shore_water_col , NJ , NE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NJ = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",
b:[{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",b:[{type:"textline",a:"ND = max ( 1.0 - u_view_max_depth * ND , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"ND = 1.0 - NB ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NA = max ( NA / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"NK = normalize ( vec3 ( Nj . r , 0.0 , Nj . g ) ) ; NK = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , NK , 0.8 ) ) ; NE = 1.25 * max ( dot ( NI , NK ) - 0.2 , 0.0 ) ; NE += max ( dot ( NI , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; ND += NE * ( 1.0 - Nj . b ) ; NA *= ( 1.0 - 0.95 * pow ( Nj . b , 0.1 ) ) ;".split(" ")}]}}]},
{type:"textline",a:"ND += NA ; ND = min ( u_foam_factor * ND , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"Nw = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + Nx * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",a:"NA = u_specular_params [ 0 ] ; Nx = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; NI = NA * u_specular_color ; NK = u_environment_energy * dS ( NF ) ; NK = u_ambient * NK ; NK = NK + u_sun_intensity ;".split(" ")},{type:"condition",b:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NL = Nv ( Ny , NF , NG , NK , NA ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NL = Nv ( vec2 ( 0.0 ) , NF , NG , NK , NA ) ;".split(" ")}]}}]},{type:"textline",a:"NJ = u_diffuse_intensity * NJ ; xT ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , NJ , NI , bC , NF , NG , Nx , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , NM , NN ) ;".split(" ")},{type:"condition",b:[{type:"if",
d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NE = max ( dot ( u_sun_direction , - bE ) + SSS_WIDTH , 0.0 ) * max ( dot ( - NG , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; NE = clamp ( SSS_STRENGTH * NE , 0.0 , 1.0 ) ; NM = mix ( NM , u_shallow_water_col , NE ) ; NM = mix ( NM , u_shore_water_col , NE ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"textline",a:"NM = mix ( NH , NM , NC ) ;".split(" ")}]}}]},
{type:"textline",a:"NM = mix ( NM , NL , NA ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:"NA = mix ( Nw . g , Nw . r , max ( 4.0 * ( ND - 0.75 ) , 0.0 ) ) ; NA = mix ( Nw . b , NA , max ( 2.0 * ND - 1.0 , 0.0 ) ) ; NA = mix ( 0.0 , NA , ND ) ; NM = mix ( NM , NK , NA ) ;".split(" ")}]}}]},{type:"textline",a:["NM","+=","NN",";"]},{type:"condition",b:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",
a:"ND = bH * u_view_max_depth ; NC = 1.0 ; if ( u_cam_water_depth > 1.0 ) NC = 2.0 ; vA ( NM , ND , NG , NC ) ;".split(" ")}]}}]},{type:"textline",a:["bu","(","NM",")",";"]},{type:"condition",b:[{type:"if",d:["REFRACTIVE",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"NB = max ( NB , NN . r ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOAM"],group:{type:"group",b:[{type:"textline",a:["NB","+=","NA",";"]}]}}]}]}},{type:"elif",d:["SHORE_SMOOTHING",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:["NB","=","1.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["ALPHA"],group:{type:"group",b:[{type:"textline",a:"bx ( NM , NB ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME",1,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"extension",a:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",a:"NN = fwidth ( tB ) ; NN = smoothstep ( vec3 ( 0.0 ) , NN * Ng , tB ) ; NA = min ( min ( NN . x , NN . y ) , NN . z ) ; NA = clamp ( NA , 0.0 , 1.0 ) ; NM = mix ( u_wireframe_edge_color , NM , NA ) ; NB = mix ( 1.0 , NB , NA ) ;".split(" ")}]}},
{type:"elif",d:["DEBUG_WIREFRAME",2,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"NN = sign ( tB - vec3 ( 0.02 * Ng ) ) ; NA = 1.0 ; if ( NN . x < 0.0 || NN . y < 0.0 || NN . z < 0.0 ) NA = 0.0 ; NM = mix ( u_wireframe_edge_color , NM , NA ) ; NB = mix ( 1.0 , NB , NA ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = vec4 ( NM , NB ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",b:[{type:"var",name:"DIR_MIN_SHR_FAC",a:["0.0"]},{type:"var",name:"DIR_FREQ",a:["0.0"]},
{type:"var",name:"DIR_NOISE_SCALE",a:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",a:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",a:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",a:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",a:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",a:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",a:["0.0"]},{type:"var",name:"DST_MIN_FAC",a:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",a:["0.0"]},{type:"var",name:"PRECISION",a:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",a:["0.0"]},
{type:"var",name:"SHORE_MAP_SIZE_X",a:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",a:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",a:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",a:["0.0"]},{type:"var",name:"WATER_LEVEL",a:["0.0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"var",name:"WAVES_LENGTH",a:["0.0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},
{type:"textline",a:["attribute","vec3","a_position",";"]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"DYNAMIC",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"attribute vec3 a_normal ; attribute vec3 a_tangent ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["GENERATED_MESH",{type:"logic_negative_expr",e:1},"NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["attribute","float","a_polyindex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",b:[{type:"textline",a:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["uniform","mat3",
"u_model_tsr",";"]}]}}]},{type:"textline",a:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],
group:{type:"group",b:[{type:"textline",a:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",a:"varying vec3 vB ; varying vec3 bC ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","bM",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"varying vec3 bF ; varying vec3 Nh ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","bE",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",
e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","Ni",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","Nj",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:["varying",
"vec3","bG",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:["varying","float","bH",";"]}]}}]},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:["varying","vec3","tB",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",
a:"vec3 No ( in vec2 Ng ) { float Nk ; vec4 Nl ; vec2 Nm ; Nm = 0.5 + vec2 ( ( Ng . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( Ng . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; Nl = texture2D ( u_shore_dist_map , Nm ) ; const vec2 Nn = vec2 ( 1.0 / 255.0 , 1.0 ) ; Nk = dot ( Nl . ba , Nn ) ; Nm = normalize ( Nl . rg * 2.0 - 1.0 ) ; return vec3 ( Nm , Nk ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"define",name:"M_PI",a:["3.14159265359"]},
{type:"define",name:"SMALL_WAVES_FAC",a:["0.3"]},{type:"textline",a:"void NA ( inout vec3 Np , in float Nq , in vec3 Nr ) { vec2 Ns , Nt , Nu ; float Nv , Nw , Nx , Ny , Nz ; Nv = aU ( DST_NOISE_SCALE_0 * ( Np . xz + DST_NOISE_FREQ_0 * Nq ) ) * aU ( DST_NOISE_SCALE_1 * ( Np . zx - DST_NOISE_FREQ_1 * Nq ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Nw = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; Nx = Nr . b ; Ny = sqrt ( Nx ) ; Nw = max ( Nx , DIR_MIN_SHR_FAC ) * sin ( Ny / Nw + DIR_FREQ * Nq ) ; Nz = max ( aU ( DIR_NOISE_SCALE * ( Np . xz + DIR_NOISE_FREQ * Nq ) ) , DIR_MIN_NOISE_FAC ) ; Nw *= Nz ; Ny = WAVES_HEIGHT * mix ( Nw , Nv , max ( Ny , DST_MIN_FAC ) ) ; Ns = Nr . rg ; Nw = WAVES_HOR_FAC * Nw * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - Nx ) , 0.0 ) ; Ns = Nw * Ns ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"Ny = WAVES_HEIGHT * Nv ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"Nt = 2.0 * ( Np . xz - 0.1 * Nq ) ; Nu = 1.3 * ( Np . zx + 0.03 * Nq ) ; Nv = ay ( 0.5 * ( Nt + Nu ) ) . x - 0.5 ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Np . xz += Ns ; Nv *= Nx ;".split(" ")}]}}]},{type:"textline",a:"Ny += SMALL_WAVES_FAC * Nv ;".split(" ")}]}}]},
{type:"textline",a:"Np . y += Ny ; }".split(" ")}]}}]},{type:"textline",a:"void main ( ) { vec4 NB , NC ; vec2 ND ; float NE , NF , NG ; vec3 NH , NI , NJ , NK , NL ; mat4 NM , NN ; NM = O ( u_view_tsr ) ; NN = O ( u_model_tsr ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",b:[{type:"textline",a:"if ( a_polyindex == 0.0 ) tB = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) tB = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) tB = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"NH = a_position ; NE = abs ( NH . y ) ; ND = u_camera_eye . xz - mod ( u_camera_eye . xz , NE ) ; NH . y = WATER_LEVEL ; NH . xz += ND ; NH = NH ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["bM","=","a_texcoord",";"]}]}}]},{type:"textline",a:"c NO = rH ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , NN ) ; NH = NO . a ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"Nj = No ( NH . xz ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DYNAMIC"],group:{type:"group",b:[{type:"textline",a:"NF = length ( u_wind ) ; NG = u_time ; NG *= NF ;".split(" ")},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"NE = NE ; NI = NH + vec3 ( NE , 0.0 , 0.0 ) ; NJ = NH + vec3 ( 0.0 , 0.0 , NE ) ;".split(" ")},{type:"condition",b:[{type:"if",
d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["Ni","=","NH",";"]}]}}]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"NI = NH + vec3 ( 0.05 , 0.0 , 0.0 ) ; NJ = NH + vec3 ( 0.0 , 0.0 , 0.05 ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",b:[{type:"textline",a:"NK = No ( NI . xz ) ; NL = No ( NJ . xz ) ; NA ( NI , NG , NK ) ; NA ( NJ , NG , NL ) ; NA ( NH , NG , Nj ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"NA ( NI , NG , vec3 ( 0.0 ) ) ; NA ( NJ , NG , vec3 ( 0.0 ) ) ; NA ( NH , NG , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",b:[{type:"textline",a:"if ( a_position . y < 0.0 ) { NH . y = WATER_LEVEL - 1.0 ; NI . y = NH . y ; NJ . y = NH . y ; }".split(" ")}]}}]},{type:"textline",a:"NI = normalize ( NI - NH ) ; NJ = normalize ( NJ - NH ) ; bE = normalize ( cross ( NJ , NI ) ) ; NG = dot ( bE , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; NG = clamp ( 0.8 - NG , 0.0 , 1.0 ) ; bE = mix ( bE , vec3 ( 0.0 , 1.0 , 0.0 ) , NG ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["DYNAMIC",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"NJ = a_tangent ; bE = a_normal ;".split(" ")}]}}]},{type:"textline",a:"bF = NJ ; Nh = cross ( bE , bF ) ;".split(" ")}]}}]},{type:"textline",a:"bC = NH ; vB = u_camera_eye - NH ; NB = NM * vec4 ( NH , 1.0 ) ; NC = u_proj_matrix * NB ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING",
"REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"NG = NC . x ; NE = NC . y ; NF = NC . w ; bG . x = ( NG + NF ) / 2.0 ; bG . y = ( NE + NF ) / 2.0 ; bG . z = NF ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",
a:"bH = - NB . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",a:["gl_Position","=","NC",";","}"]}]};a["postprocessing/antialiasing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"define",name:"AA_METHOD_FXAA_LIGHT",a:["1"]},{type:"define",name:"AA_METHOD_FXAA_QUALITY",a:["2"]},{type:"define",name:"AA_QUALITY_LOW",
a:["0"]},{type:"define",name:"AA_QUALITY_MEDIUM",a:["1"]},{type:"define",name:"AA_QUALITY_HIGH",a:["2"]},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_REDUCE_MIN",a:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",a:["(","1.0","/","8.0",")"]},{type:"define",name:"FXAA_SPAN_MAX",a:["8.0"]},{type:"textline",a:"vec4 Nm ( float Ng , float Nk ) { vec2 Nl ; Nl = bM + vec2 ( Ng , Nk ) * u_texel_size ; return texture2D ( u_color , Nl ) ; } vec4 Nz ( ) { vec2 Nn ; float No , Np , Nq , Nr , Ns , Nt ; vec4 Nu , Nv , Nw , Nx , Ny ; Nu = Nm ( - 1.0 , - 1.0 ) ; Nv = Nm ( 1.0 , - 1.0 ) ; Nw = Nm ( - 1.0 , 1.0 ) ; Nx = Nm ( 1.0 , 1.0 ) ; Ny = Nm ( 0.0 , 0.0 ) ; No = bB ( Ny ) ; Np = bB ( Nu ) ; Nq = bB ( Nv ) ; Nr = bB ( Nw ) ; Ns = bB ( Nx ) ; Nt = min ( No , min ( min ( Np , Nq ) , min ( Nr , Ns ) ) ) ; No = max ( No , max ( max ( Np , Nq ) , max ( Nr , Ns ) ) ) ; Nn . x = - ( ( Np + Nq ) - ( Nr + Ns ) ) ; Nn . y = ( ( Np + Nr ) - ( Nq + Ns ) ) ; Ns = max ( ( Np + Nq + Nr + Ns ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; Ns = 1.0 / ( min ( abs ( Nn . x ) , abs ( Nn . y ) ) + Ns ) ; Nn = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , Nn * Ns ) ) * u_texel_size ; Nx = 0.5 * ( texture2D ( u_color , bM + Nn * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , bM + Nn * ( 2.0 / 3.0 - 0.5 ) ) ) ; Nw = Nx * 0.5 + 0.25 * ( texture2D ( u_color , bM + Nn * - 0.5 ) + texture2D ( u_color , bM + Nn * 0.5 ) ) ; Ns = bB ( Nw ) ; if ( ( Ns < Nt ) || ( Ns > No ) ) return Nx ; else return Nw ; }".split(" ")}]}},
{type:"elif",d:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_GREEN_AS_LUMA",a:["1"]},{type:"define",name:"FXAA_BLEND4WEB",a:["1"]},{type:"include",file:"fxaa.glslf"},{type:"condition",b:[{type:"if",d:["AA_QUALITY","AA_QUALITY_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["39"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["1.00"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",
a:["0.063"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0312"]}]}},{type:"elif",d:["AA_QUALITY","AA_QUALITY_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["20"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["0.65"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",a:["0.166"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0625"]}]}},{type:"elif",d:["AA_QUALITY","AA_QUALITY_LOW",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["12"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",a:["0.50"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",a:["0.166"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",a:["0.0833"]}]}}]}]}}]},{type:"textline",a:"void main ( ) { vec2 Oq ;".split(" ")},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = Nz ( ) ;".split(" ")}]}},{type:"elif",d:["AA_METHOD",
"AA_METHOD_FXAA_QUALITY",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Oq = u_texel_size ; gl_FragColor = Op ( bM , u_color , Oq , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 bM ; void main ( ) { vec4 Ng ; vec2 Nk , Nl ; Nk = vec2 ( 0.0 , 0.0 ) ; Nl = u_texel_size ; Ng = texture2D ( u_color , bM ) ; gl_FragColor = Ng * 0.0875447373698 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0858112354248 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0808139781061 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0731235112908 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0635705267419 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0530985673112 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0426125984122 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0328565115809 ; Nk += Nl ; gl_FragColor += texture2D ( u_color , bM + Nk ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , bM - Nk ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * Ng , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 bM ; void main ( ) { vec4 Ng , Nk ; Ng = texture2D ( u_main , bM ) ; Nk = texture2D ( u_bloom , bM ) ; Ng = Ng ; Ng += Nk ; gl_FragColor = vec4 ( Ng . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},
{type:"define",name:"PI_4",a:["0.785398163"]},{type:"textline",a:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 bM ; void main ( ) { float Ng ; vec3 Nk ; vec4 Nl ; Nl = texture2D ( u_color , bM ) ; Nk = Nl . rgb ; if ( u_brightness < 0.0 ) Nk = Nk * ( 1.0 + u_brightness ) ; else Nk = Nk + ( ( 1.0 - Nk ) * u_brightness ) ; Nk = ( Nk - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; Nk *= u_exposure ; Ng = bB ( vec4 ( Nk , 0.0 ) ) ; Nk = mix ( vec3 ( Ng ) , Nk , u_saturation ) ; gl_FragColor = vec4 ( Nk , Nl . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",a:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 bM ; void main ( ) { gl_FragColor = V ( clamp ( Ow ( u_depth , bM , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",a:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 bM ; void main ( ) { float Ng , Nk ; vec4 Nl , Nm ; Nl = texture2D ( u_sharp , bM ) ; if ( u_dof_dist > 0.0 ) { Ng = Ow ( u_depth , bM , u_camera_range ) ; Ng *= u_view_max_depth ; if ( Ng < u_dof_dist ) Nk = ( u_dof_dist - Ng ) / u_dof_front ; else Nk = ( Ng - u_dof_dist ) / u_dof_rear ; Nk = clamp ( Nk , 0.0 , 1.0 ) ; Nm = texture2D ( u_blurred , bM ) ; gl_FragColor = mix ( Nl , Nm , Nk ) ; } else gl_FragColor = Nl ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 bM ; void main ( ) { float Ng ; vec4 Nk , Nl , Nm ; Nk = texture2D ( u_src_color , bM ) ; Nl = texture2D ( u_glow_mask_small , bM ) ; Nm = texture2D ( u_glow_mask_large , bM ) ; gl_FragColor = Nk ; if ( Nm . a != 0.0 ) { Ng = u_glow_mask_large_coeff * Nm . a ; Ng = clamp ( Ng , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , Nm . rgb / Nm . a , Ng ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , Ng ) ; } if ( Nl . a != 0.0 ) { Ng = u_glow_mask_small_coeff * Nl . a ; Ng = clamp ( Ng , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , Nl . rgb / Nl . a , Ng ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , Ng ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",a:["0.0"]},{type:"textline",a:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"textline",a:["uniform","vec2","u_camera_range",";"]},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"varying float Ox ; varying vec2 Oy ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying vec4 Oz ; void main ( ) { vec4 OA ; int OB ; float OC , OD , OE , OF ; vec2 OG , OH , OI ; OG = ( Oz . xy - bM ) ; OC = length ( OG ) ; OG = u_radial_blur_step * OG / OC ; OD = OC / u_radial_blur_step ; OG *= min ( OD , STEPS_PER_PASS ) / STEPS_PER_PASS ; OD = max ( OD , STEPS_PER_PASS ) ; OH = bM ; OE = 0.0 ; const int OJ = int ( STEPS_PER_PASS ) ; OB = int ( OD + 0.5 ) ; for ( int OK = 0 ; OK < OJ ; OK += 1 ) { if ( OK <= OB ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"textline",a:"OD = Ow ( u_input , OH , u_camera_range ) ; OE += max ( ( 1.0 - pow ( OC , 0.3 ) ) * step ( 0.9 , OD ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"OA = texture2D ( u_input , OH ) ; OE += Z ( OA ) ;".split(" ")}]}}]},{type:"textline",a:"} OH += OG ; }".split(" ")},{type:"condition",b:[{type:"if",d:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"OI = bM + Oy ; OF = ay ( vec2 ( 2.5 * ( OI . x ) , 2.5 * ( OI . y ) + 1.0 * u_time ) ) . x + 0.75 * ay ( vec2 ( 5.0 * ( OI . x ) - 0.66 * u_time , 5.0 * ( OI . y ) + 0.66 * u_time ) ) . x + 0.5 * aU ( vec2 ( 7.5 * ( OI . x ) + 0.33 * u_time , 7.5 * ( OI . y ) - 0.33 * u_time ) ) ; OF *= clamp ( 1.2 - sqrt ( 0.2 * OC ) , 0.0 , 1.0 ) * Ox ; OE = max ( OF , OE ) ;".split(" ")}]}}]},{type:"textline",a:"gl_FragColor = V ( OE / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]=
{type:"group",b:[{type:"include",file:"math.glslv"},{type:"textline",a:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",b:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float Ox ; varying vec2 Oy ;".split(" ")}]}}]}]}}]},{type:"textline",a:"varying vec2 bM ; varying vec4 Oz ; void main ( ) { float Ng , Nk ; vec3 Nl ; bM = a_bb_vertex + 0.5 ; Nl = normalize ( u_sun_direction ) ; Oz = u_view_proj_matrix * vec4 ( Nl , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( u_cam_water_depth < 0.0 ) { Ox = 1.0 ; Nl = vec3 ( 0.0 , 1.0 , 0.0 ) ; Nl = i ( u_camera_quat , Nl ) ; Nl = normalize ( Nl ) ; Ng = dot ( Nl , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; Nk = atan ( Nl . x , Nl . z ) ; Oy = vec2 ( - Nk , acos ( Ng ) ) ; } else { Ox = 0.0 ; }".split(" ")}]}}]},{type:"textline",a:"Oz . xy = 0.5 * ( Oz . xy / Oz . w + 1.0 ) ; Oz += 99999.0 * step ( Oz . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/god_rays_combine.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 bM ; void main ( ) { float Ng ; vec3 Nk ; vec4 Nl ; Nl = texture2D ( u_main , bM ) ; Nk = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; br ( Nl . rgb ) ; Ng = Z ( texture2D ( u_god_rays , bM ) ) ; Nk = Nl . rgb + u_god_rays_intensity * vec3 ( Ng ) * Nk ; bu ( Nk ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SAFARI_CANVAS_ALPHA_HACK"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( Nk , max ( 0.01 , Nl . a ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( Nk , Nl . a ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/luminance.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_input ; varying vec2 bM ; void main ( ) { float Ng ; vec4 Nk ; Nk = texture2D ( u_input , bM ) ; Ng = dot ( Nk . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( Ng ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_input ; void main ( ) { float Ng , Nk , Nl , Nm ; Nk = 0.0 ; Nl = 0.025 ; Nm = 0.025 ; for ( int Nn = 0 ; Nn < 20 ; Nn += 1 ) { Nm = 0.025 ; for ( int No = 0 ; No < 20 ; No += 1 ) { Ng = max ( texture2D ( u_input , vec2 ( Nl , Nm ) ) . r , 0.01 ) ; Nk += log ( Ng ) ; Nm += 0.05 ; } Nl += 0.05 ; } Nk = exp ( Nk / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( Nk ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 bM ; varying float OA ; void main ( ) { vec4 OB ; float OC , OD ; OC = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; OD = texture2D ( u_luminance , bM ) . r ; OB = texture2D ( u_main , bM ) ; OC = OD / OC ; OD = u_bloom_edge_lum ; gl_FragColor = OB * max ( OC - OD , 0.0 ) * OA ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 bM ; varying float OA ; const vec3 Ng = vec3 ( 0.0 , 1.0 , 0.0 ) ; void Nr ( in vec4 Nk , in vec3 Nl , out vec3 Nm ) { float Nn , No , Np , Nq ; Nn = Nk . w * Nl . x + Nk . y * Nl . z - Nk . z * Nl . y ; No = Nk . w * Nl . y + Nk . z * Nl . x - Nk . x * Nl . z ; Np = Nk . w * Nl . z + Nk . x * Nl . y - Nk . y * Nl . x ; Nq = - Nk . x * Nl . x - Nk . y * Nl . y - Nk . z * Nl . z ; Nm . x = Nn * Nk . w - Nq * Nk . x - No * Nk . z + Np * Nk . y ; Nm . y = No * Nk . w - Nq * Nk . y - Np * Nk . x + Nn * Nk . z ; Nm . z = Np * Nk . w - Nq * Nk . z - Nn * Nk . y + No * Nk . x ; } void main ( ) { vec3 Ns ; bM = 2.0 * a_position ; Nr ( u_camera_quat , Ng , Ns ) ; OA = dot ( - Ns , u_sun_direction ) * u_bloom_key ; OA *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 bM ; float Ng = 0.0042 ; void main ( ) { vec4 Nk , Nl , Nm , Nn ; Nk = texture2D ( u_mb_tex_curr , bM ) ; Nl = texture2D ( u_mb_tex_accum , bM ) ; if ( length ( Nk - Nl ) > u_motion_blur_decay_threshold ) { Nm = ( 1.0 - u_motion_blur_exp ) * Nk + u_motion_blur_exp * Nl ; Nm = Nm - Nl ; Nn = Nk - Nl ; Nm = min ( max ( abs ( Nm ) , vec4 ( Ng ) ) , abs ( Nn ) ) * sign ( Nm ) ; gl_FragColor = Nl + Nm ; } else { gl_FragColor = Nk ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 bM ; void main ( ) { vec3 Ng ; float Nk ; vec4 Nl , Nm , Nn ; Nl = texture2D ( u_outline_src , bM ) ; gl_FragColor = Nl ; if ( u_draw_outline != 0.0 ) { Nm = texture2D ( u_outline_mask , bM ) ; Nn = texture2D ( u_outline_mask_blurred , bM ) ; Nk = Nn . a - Nm . a ; if ( Nk != 0.0 ) { Nk = smoothstep ( 0.0 , 1.0 , Nn . a ) ; if ( Nm . a == 0.0 ) { Ng = u_outline_color ; bu ( Ng ) ; Nm = vec4 ( clamp ( Ng , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( Nl , Nm , Nk ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"textline",a:"uniform sampler2D u_color ; varying vec2 bM ; void main ( ) { vec4 Ng ; Ng = vec4 ( 0.0 ) ; for ( int Nk = 0 ; Nk < 100 ; Nk ++ ) Ng += 0.001 * texture2D ( u_color , bM + vec2 ( 0.001 * vec2 ( Nk ) ) ) ; gl_FragColor = Ng ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",
a:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",a:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",a:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",a:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",a:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",a:["6"]},{type:"define",name:"FLIP_CUBEMAP_COORDS",a:["7"]},{type:"textline",a:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{type:"condition",b:[{type:"if",d:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{type:"textline",a:"varying vec2 bM ; void main ( ) { float Ng , Nk , Nl , Nm ; vec2 Nn , No ; vec4 Np ;".split(" ")},{type:"condition",b:[{type:"if",d:["POST_EFFECT","POST_EFFECT_NONE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = texture2D ( u_color , bM ) ;".split(" ")}]}},{type:"elif",d:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"Np = texture2D ( u_color , bM ) ; gl_FragColor . rgb = vec3 ( ( Np . r + Np . g + Np . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_BLUR",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_BLUR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nn = vec2 ( 0.0 , 0.0 ) ; No = u_texel_size ; Np = texture2D ( u_color , bM ) ; gl_FragColor = Np * 0.2270270270 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * 0.1945945946 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * 0.1945945946 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * 0.1216216216 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * 0.1216216216 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * 0.0540540541 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * 0.0540540541 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * 0.0162162162 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * 0.0162162162 ;".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_GLOW_BLUR",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nn = vec2 ( 0.0 , 0.0 ) ; No = u_texel_size ; Np = texture2D ( u_color , bM ) ; gl_FragColor = Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.152507 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.141763 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.141763 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.113861 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.113861 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.079019 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.079019 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.047383 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.047383 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.024549 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.024549 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.01099 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.01099 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.00425 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.00425 ; Nn += No ; Np = texture2D ( u_color , bM + Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.00142 ; Np = texture2D ( u_color , bM - Nn ) ; gl_FragColor += Np * ( 1.0 - step ( 0.0 , - Np . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_EXTEND",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_EXTEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"No = u_texel_size ; Np = texture2D ( u_color , bM ) ; gl_FragColor = Np ; if ( Np . a == 0.0 ) { Np = texture2D ( u_color , bM + No ) ; if ( Np . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , Np . a ) ; else { Np = texture2D ( u_color , bM - No ) ; if ( Np . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , Np . a ) ; } }".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Ng = u_delta [ 0 ] ; Nk = u_delta [ 1 ] ; Nl = 1.0 / 3.0 ; Nm = 0.5 ; No = vec2 ( Nl , Nm ) ; if ( u_tex_number == 0 ) { Nn = bM * No + vec2 ( 2.0 * Nl , 0.0 ) ; Nn [ 0 ] = min ( Nn [ 0 ] , 1.0 - Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 0.5 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( 5.0 * Nl - Nn [ 0 ] , Nn [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { Nn = bM * No ; Nn [ 0 ] = max ( Nn [ 0 ] , Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 0.5 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( Nl - Nn [ 0 ] , Nn [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { Nn = bM * No + vec2 ( Nl , Nm ) ; Nn [ 0 ] = max ( Nn [ 0 ] , Nl + Ng ) ; Nn [ 0 ] = min ( Nn [ 0 ] , 2.0 * Nl - Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 1.0 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( Nn [ 0 ] , 3.0 * Nm - Nn [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { Nn = bM * No + vec2 ( 0.0 , Nm ) ; Nn [ 0 ] = min ( Nn [ 0 ] , Nl - Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 1.0 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( Nn [ 0 ] , 3.0 * Nm - Nn [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { Nn = bM * No + vec2 ( Nl , 0.0 ) ; Nn [ 0 ] = max ( Nn [ 0 ] , Nl + Ng ) ; Nn [ 0 ] = min ( Nn [ 0 ] , 2.0 * Nl - Ng ) ; Nn [ 1 ] = min ( Nn [ 1 ] , 0.5 - Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( 1.0 - Nn [ 0 ] , Nn [ 1 ] ) ) ; } else { No = bM * No + vec2 ( 2.0 * Nl , Nm ) ; No [ 0 ] = min ( No [ 0 ] , 1.0 - Ng ) ; No [ 1 ] = max ( No [ 1 ] , 0.5 + Nk ) ; gl_FragColor = texture2D ( u_color , vec2 ( 5.0 * Nl - No [ 0 ] , No [ 1 ] ) ) ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",b:[{type:"textline",a:"attribute vec2 a_position ; varying vec2 bM ; void main ( ) { bM = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",a:["1"]},{type:"define",
name:"SMAA_EDGE_DETECTION",a:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",a:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",a:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",a:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",a:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",a:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",a:["4"]},{type:"textline",a:["uniform","sampler2D","u_color",";"]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",e:2},"SMAA_PREDICATION",{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",a:"uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","OB",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"varying vec4 OC ; varying vec4 OD ; varying vec4 OE ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","OF",";"]}]}}]},{type:"condition",
b:[{type:"if",d:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",a:["1"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",
a:["1"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",a:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
a:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_THRESHOLD",a:["0.1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",a:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",
group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",a:["8"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",b:[{type:"define",name:"SMAA_CORNER_ROUNDING",a:["25"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",b:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",a:["2.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",b:[{type:"define",
name:"SMAA_PREDICATION",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",a:["0.01"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_SCALE",a:["2.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",b:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",a:["0.4"]}]}}]},
{type:"condition",b:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",b:[{type:"define",name:"SMAA_REPROJECTION",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",b:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",a:["30.0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",a:["16"]},
{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",a:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",a:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",a:["(","1.0","/","7.0",")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",a:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",a:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",a:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec3 OL ( vec2 OG , sampler2D OH ) { float OI , OJ , OK ; OI = texture2D ( OH , OG ) . r ; OJ = texture2D ( OH , OC . xy ) . r ; OK = texture2D ( OH , OC . zw ) . r ; return vec3 ( OI , OJ , OK ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec2 OQ ( vec2 OM , sampler2D ON ) { vec2 OO ; vec3 OP ; OP = OL ( OM , ON ) ; OO = abs ( OP . xx - OP . yz ) ; OO = step ( SMAA_PREDICATION_THRESHOLD , OO ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * OO ) ; }".split(" ")}]}}]},
{type:"textline",a:"void OU ( bvec2 OR , inout vec2 OS , vec2 OT ) { if ( OR . x ) OS . x = OT . x ; if ( OR . y ) OS . y = OT . y ; } void OU ( bvec4 OV , inout vec4 OW , vec4 OX ) { OU ( OV . xy , OW . xy , OX . xy ) ; OU ( OV . zw , OW . zw , OX . zw ) ; } vec2 OZ ( vec2 OY ) { return sign ( OY ) * floor ( abs ( OY ) + .5 ) ; } vec4 OZ ( vec4 O_ ) { return sign ( O_ ) * floor ( abs ( O_ ) + .5 ) ; }".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:"vec2 Pm ( vec2 Pa , sampler2D Pb".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","Pc"]}]}}]},{type:"textline",a:") { vec4 Pd ; float Pe , Pf , Pg , Ph , Pi ; vec3 Pj ; vec2 Pk , Pl ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",b:[{type:"textline",a:"Pk = OQ ( Pa , Pc ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",
a:"Pk = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{type:"textline",a:"Pj = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; Pe = dot ( texture2D ( Pb , Pa ) . rgb , Pj ) ; Pf = dot ( texture2D ( Pb , OC . xy ) . rgb , Pj ) ; Pg = dot ( texture2D ( Pb , OC . zw ) . rgb , Pj ) ; Pd . xy = abs ( Pe - vec2 ( Pf , Pg ) ) ; Pk = step ( Pk , Pd . xy ) ; if ( dot ( Pk , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; Ph = dot ( texture2D ( Pb , OD . xy ) . rgb , Pj ) ; Pi = dot ( texture2D ( Pb , OD . zw ) . rgb , Pj ) ; Pd . zw = abs ( Pe - vec2 ( Ph , Pi ) ) ; Pl = max ( Pd . xy , Pd . zw ) ; Pi = dot ( texture2D ( Pb , OE . xy ) . rgb , Pj ) ; Ph = dot ( texture2D ( Pb , OE . zw ) . rgb , Pj ) ; Pd . zw = abs ( vec2 ( Pf , Pg ) - vec2 ( Pi , Ph ) ) ; Pl = max ( Pl . xy , Pd . zw ) ; Ph = max ( Pl . x , Pl . y ) ; Pk . xy *= step ( Ph , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * Pd . xy ) ; return Pk ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"vec2 Po ( vec2 Pn ) { Pn . r = Pn . r * abs ( 5.0 * Pn . r - 5.0 * 0.75 ) ; return OZ ( Pn ) ; } vec4 Po ( vec4 Pp ) { Pp . rb = Pp . rb * abs ( 5.0 * Pp . rb - 5.0 * 0.75 ) ; return OZ ( Pp ) ; } vec2 Px ( sampler2D Pq , vec2 Pr , vec2 Ps , out vec2 Pt ) { vec3 Pu ; vec4 Pv ; Pv = vec4 ( Pr , - 1.0 , 1.0 ) ; Pu = vec3 ( u_texel_size , 1.0 ) ; for ( int Pw = 0 ; Pw < SMAA_MAX_SEARCH_STEPS_DIAG ; Pw ++ ) { if ( Pv . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Pv . w > 0.9 ) { Pv . xyz += Pu * vec3 ( Ps , 1.0 ) ; Pt = texture2D ( Pq , Pv . xy , 0.0 ) . rg ; Pv . w = dot ( Pt , vec2 ( 0.5 , 0.5 ) ) ; } } return Pv . zw ; } vec2 PF ( sampler2D Py , vec2 Pz , vec2 PA , out vec2 PB ) { vec3 PC ; vec4 PD ; PD = vec4 ( Pz , - 1.0 , 1.0 ) ; PD . x += 0.25 * u_texel_size . x ; PC = vec3 ( u_texel_size , 1.0 ) ; for ( int PE = 0 ; PE < SMAA_MAX_SEARCH_STEPS_DIAG ; PE ++ ) { if ( PD . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && PD . w > 0.9 ) { PD . xyz = PC * vec3 ( PA , 1.0 ) + PD . xyz ; PB = texture2D ( Py , PD . xy , 0.0 ) . rg ; PB = Po ( PB ) ; PD . w = dot ( PB , vec2 ( 0.5 , 0.5 ) ) ; } } return PD . zw ; } vec2 PL ( sampler2D PG , vec2 PH , vec2 PI , float PJ ) { vec2 PK ; PK = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * PI + PH ; PK = SMAA_AREATEX_PIXEL_SIZE * PK + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; PK . x += 0.5 ; PK . y += SMAA_AREATEX_SUBTEX_SIZE * PJ ; return texture2D ( PG , PK , 0.0 ) . rg ; } vec2 PX ( sampler2D PM , sampler2D PN , vec2 PO , vec2 PP , vec4 PQ ) { vec4 PR , PS , PT ; vec2 PU , PV , PW ; PU = vec2 ( 0.0 , 0.0 ) ; if ( PP . r > 0.0 ) { PR . xz = Px ( PM , PO , vec2 ( - 1.0 , 1.0 ) , PV ) ; PR . x += float ( PV . y > 0.9 ) ; } else PR . xz = vec2 ( 0.0 , 0.0 ) ; PR . yw = Px ( PM , PO , vec2 ( 1.0 , - 1.0 ) , PV ) ; if ( PR . x + PR . y > 2.0 ) { PS = vec4 ( - PR . x + 0.25 , PR . x , PR . y , - PR . y - 0.25 ) * u_texel_size . xyxy + PO . xyxy ; PT . xy = texture2D ( PM , PS . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; PT . zw = texture2D ( PM , PS . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; PT . yxwz = Po ( PT . xyzw ) ; PW = vec2 ( 2.0 , 2.0 ) * PT . xz + PT . yw ; OU ( bvec2 ( step ( 0.9 , PR . zw ) ) , PW , vec2 ( 0.0 , 0.0 ) ) ; PU += PL ( PN , PR . xy , PW , PQ . z ) ; } PR . xz = PF ( PM , PO , vec2 ( - 1 , - 1 ) , PV ) ; if ( texture2D ( PM , PO + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { PR . yw = PF ( PM , PO , vec2 ( 1 , 1 ) , PV ) ; PR . y += float ( PV . y > 0.9 ) ; } else PR . yw = vec2 ( 0.0 , 0.0 ) ; if ( PR . x + PR . y > 2.0 ) { PT = vec4 ( - PR . x , - PR . x , PR . y , PR . y ) * u_texel_size . xyxy + PO . xyxy ; PS . x = texture2D ( PM , PT . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; PS . y = texture2D ( PM , PT . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; PS . zw = texture2D ( PM , PT . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; PV = vec2 ( 2.0 , 2.0 ) * PS . xz + PS . yw ; OU ( bvec2 ( step ( 0.9 , PR . zw ) ) , PV , vec2 ( 0 , 0 ) ) ; PU += PL ( PN , PR . xy , PV , PQ . w ) . gr ; } return PU ; }".split(" ")}]}}]},
{type:"textline",a:"float Qc ( sampler2D PY , vec2 PZ , float P_ ) { vec2 Qa , Qb ; Qa = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; Qb = SMAA_SEARCHTEX_SIZE * vec2 ( P_ , 1.0 ) ; Qa += vec2 ( - 1.0 , 1.0 ) ; Qb += vec2 ( 0.5 , - 0.5 ) ; Qa *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; Qb *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( PY , Qa * PZ + Qb , 0.0 ) . r ; } float Qk ( sampler2D Qd , sampler2D Qe , vec2 Qf , float Qg ) { float Qh ; vec2 Qi ; Qi = vec2 ( 0.0 , 1.0 ) ; for ( int Qj = 0 ; Qj < SMAA_MAX_SEARCH_STEPS ; Qj ++ ) { if ( Qf . x > Qg && Qi . g > 0.8281 && Qi . r == 0.0 ) { Qi = texture2D ( Qd , Qf , 0.0 ) . rg ; Qf = - vec2 ( 2.0 , 0.0 ) * u_texel_size + Qf ; } } Qh = - ( 255.0 / 127.0 ) * Qc ( Qe , Qi , 0.0 ) + 3.25 ; return u_texel_size . x * Qh + Qf . x ; } float Qs ( sampler2D Ql , sampler2D Qm , vec2 Qn , float Qo ) { float Qp ; vec2 Qq ; Qq = vec2 ( 0.0 , 1.0 ) ; for ( int Qr = 0 ; Qr < SMAA_MAX_SEARCH_STEPS ; Qr ++ ) { if ( Qn . x < Qo && Qq . g > 0.8281 && Qq . r == 0.0 ) { Qq = texture2D ( Ql , Qn , 0.0 ) . rg ; Qn = vec2 ( 2.0 , 0.0 ) * u_texel_size + Qn ; } } Qp = - ( 255.0 / 127.0 ) * Qc ( Qm , Qq , 0.5 ) + 3.25 ; return - u_texel_size . x * Qp + Qn . x ; } float QA ( sampler2D Qt , sampler2D Qu , vec2 Qv , float Qw ) { float Qx ; vec2 Qy ; Qy = vec2 ( 1.0 , 0.0 ) ; for ( int Qz = 0 ; Qz < SMAA_MAX_SEARCH_STEPS ; Qz ++ ) { if ( Qv . y > Qw && Qy . r > 0.8281 && Qy . g == 0.0 ) { Qy = texture2D ( Qt , Qv , 0.0 ) . rg ; Qv = - vec2 ( 0.0 , 2.0 ) * u_texel_size + Qv ; } } Qx = - ( 255.0 / 127.0 ) * Qc ( Qu , Qy . gr , 0.0 ) + 3.25 ; return u_texel_size . y * Qx + Qv . y ; } float QI ( sampler2D QB , sampler2D QC , vec2 QD , float QE ) { float QF ; vec2 QG ; QG = vec2 ( 1.0 , 0.0 ) ; for ( int QH = 0 ; QH < SMAA_MAX_SEARCH_STEPS ; QH ++ ) { if ( QD . y < QE && QG . r > 0.8281 && QG . g == 0.0 ) { QG = texture2D ( QB , QD , 0.0 ) . rg ; QD = vec2 ( 0.0 , 2.0 ) * u_texel_size + QD ; } } QF = - ( 255.0 / 127.0 ) * Qc ( QC , QG . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * QF + QD . y ; } vec2 QP ( sampler2D QJ , vec2 QK , float QL , float QM , float QN ) { vec2 QO ; QO = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * OZ ( 4.0 * vec2 ( QL , QM ) ) + QK ; QO = SMAA_AREATEX_PIXEL_SIZE * QO + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; QO . y = SMAA_AREATEX_SUBTEX_SIZE * QN + QO . y ; return texture2D ( QJ , QO , 0.0 ) . rg ; } void QW ( sampler2D QQ , inout vec2 QR , vec4 QS , vec2 QT ) { vec2 QU , QV ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"QU = step ( QT . xy , QT . yx ) ; QV = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * QU ; QV /= QU . x + QU . y ; QU = vec2 ( 1.0 , 1.0 ) ; QU . x -= QV . x * texture2D ( QQ , QS . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; QU . x -= QV . y * texture2D ( QQ , QS . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; QU . y -= QV . x * texture2D ( QQ , QS . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; QU . y -= QV . y * texture2D ( QQ , QS . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; QR *= clamp ( QU , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:"} void Rc ( sampler2D QX , inout vec2 QY , vec4 QZ , vec2 Q_ ) { vec2 Ra , Rb ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"Ra = step ( Q_ . xy , Q_ . yx ) ; Rb = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * Ra ; Rb /= Ra . x + Ra . y ; Ra = vec2 ( 1.0 , 1.0 ) ; Ra . x -= Rb . x * texture2D ( QX , QZ . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; Ra . x -= Rb . y * texture2D ( QX , QZ . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; Ra . y -= Rb . x * texture2D ( QX , QZ . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; Ra . y -= Rb . y * texture2D ( QX , QZ . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; QY *= clamp ( Ra , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 Rq ( vec2 Rd , vec2 Re , sampler2D Rf , sampler2D Rg , sampler2D Rh , vec4 Ri ) { float Rj , Rk ; vec3 Rl ; vec2 Rm , Rn , Ro ; vec4 Rp ; Rp = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; Rm = texture2D ( Rf , Rd ) . rg ; if ( Rm . g > 0.0 ) {".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"Rp . rg = PX ( Rf , Rg , Rd , Rm , Ri ) ; if ( Rp . r == - Rp . g ) {".split(" ")}]}}]},{type:"textline",a:"; Rl . x = Qk ( Rf , Rh , OC . xy , OE . x ) ; Rl . y = OD . y ; Rn . x = Rl . x ; Rj = texture2D ( Rf , Rl . xy , 0.0 ) . r ; Rl . z = Qs ( Rf , Rh , OC . zw , OE . y ) ; Rn . y = Rl . z ; Rn = abs ( OZ ( Rn / u_texel_size . xx - Re . xx ) ) ; Ro = sqrt ( Rn ) ; Rk = texture2D ( Rf , Rl . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; Rp . rg = QP ( Rg , Ro , Rj , Rk , Ri . y ) ; Rl . y = Rd . y ; QW ( Rf , Rp . rg , Rl . xyzy , Rn ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"} else Rm . r = 0.0 ;".split(" ")}]}}]},{type:"textline",a:"} if ( Rm . r > 0.0 ) { ; Rl . y = QA ( Rf , Rh , OD . xy , OE . z ) ; Rl . x = OC . x ; Rm . x = Rl . y ; Rk = texture2D ( Rf , Rl . xy , 0.0 ) . g ; Rl . z = QI ( Rf , Rh , OD . zw , OE . w ) ; Rm . y = Rl . z ; Rm = abs ( OZ ( Rm / u_texel_size . yy - Re . yy ) ) ; Rn = sqrt ( Rm ) ; Rj = texture2D ( Rf , Rl . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; Rp . ba = QP ( Rg , Rn , Rk , Rj , Ri . x ) ; Rl . x = Rd . x ; Rc ( Rf , Rp . ba , Rl . xyxz , Rm ) ; } return Rp ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 RC ( vec2 Rr , sampler2D Rs , sampler2D Rt".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","Ru"]}]}}]},{type:"textline",a:") { bool Rv ; vec2 Rw , Rx , Ry ; vec4 Rz , RA , RB ; Rz . x = texture2D ( Rt , OB . xy ) . a ; Rz . y = texture2D ( Rt , OB . zw ) . g ; Rz . wz = texture2D ( Rt , Rr ) . xz ; if ( dot ( Rz , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { RA = texture2D ( Rs , Rr , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"RB = texture2D ( Ru , bM ) ; Rw = 2.0 * ag ( RB ) - 1.0 ; RA . a = sqrt ( 2.0 * length ( Rw ) ) ;".split(" ")}]}}]},{type:"textline",a:"return RA ; } else { Rv = max ( Rz . x , Rz . z ) > max ( Rz . y , Rz . w ) ; RA = vec4 ( 0.0 , Rz . y , 0.0 , Rz . w ) ; Rw = Rz . yw ; OU ( bvec4 ( Rv , Rv , Rv , Rv ) , RA , vec4 ( Rz . x , 0.0 , Rz . z , 0.0 ) ) ; OU ( bvec2 ( Rv , Rv ) , Rw , Rz . xz ) ; Rw /= dot ( Rw , vec2 ( 1.0 , 1.0 ) ) ; RA = RA * vec4 ( u_texel_size , - u_texel_size ) + Rr . xyxy ; Rz = Rw . x * texture2D ( Rs , RA . xy , 0.0 ) ; Rz += Rw . y * texture2D ( Rs , RA . zw , 0.0 ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"RB = texture2D ( Ru , RA . xy ) ; Rx = 2.0 * ag ( RB ) - 1.0 ; Ry = Rw . x * Rx ; RB = texture2D ( Ru , RA . zw ) ; Rx = 2.0 * ag ( RB ) - 1.0 ; Ry += Rw . y * Rx ; Rz . a = sqrt ( 2.0 * length ( Ry ) ) ;".split(" ")}]}}]},{type:"textline",a:["return","Rz",";","}","}"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"vec4 RM ( vec2 RD , sampler2D RE , sampler2D RF".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","sampler2D","RG"]}]}}]},{type:"textline",a:") { float RH ; vec2 RI ; vec4 RJ , RK , RL ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:"RJ = texture2D ( RG , bM ) ; RI = 2.0 * ag ( RJ ) - 1.0 ; RJ = texture2D ( RE , RD ) ; RK = texture2D ( RF , RD - RI ) ; RH = abs ( RJ . a * RJ . a - RK . a * RK . a ) / 2.0 ; RH = 0.5 * clamp ( 1.0 - sqrt ( RH ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; RL = mix ( RJ , RK , RH ) ; RL . a = 1.0 ; return RL ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"RJ = texture2D ( RE , RD ) ; RK = texture2D ( RF , RD ) ; return mix ( RJ , RK , 0.5 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:"void main ( ) { vec4 RN ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"RN = vec4 ( Pm ( bM , u_color".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",
b:[{type:"textline",a:[",","u_predication_tex"]}]}}]},{type:"textline",a:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"RN = Rq ( bM , OF , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"RN = RC ( bM , u_color , u_blend".split(" ")},
{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","u_velocity_tex"]}]}}]},{type:"textline",a:[")",";"]}]}},{type:"elif",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"RN = vec4 ( RM ( bM , u_color , u_color_prev".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",b:[{type:"textline",a:[",","u_velocity_tex"]}]}}]},{type:"textline",a:[")",")",";"]}]}},{type:"else",
group:{type:"group",b:[{type:"textline",a:"RN = texture2D ( u_color , bM ) ;".split(" ")}]}}]},{type:"textline",a:["gl_FragColor","=","RN",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",b:[{type:"define",name:"SMAA_EDGE_DETECTION",a:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",a:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",a:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",a:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",a:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",
a:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",a:["4"]},{type:"textline",a:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec4","OB",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"varying vec4 OC ; varying vec4 OD ; varying vec4 OE ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec2","OF",";"]}]}}]},{type:"condition",b:[{type:"if",d:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["4"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["8"]}]}},{type:"elif",d:["AA_METHOD",
"AA_METHOD_SMAA_HIGH",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["32"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",b:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",a:["16"]}]}}]},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void Nk ( vec2 Ng ) { OC = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + Ng . xyxy ; OD = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + Ng . xyxy ; OE = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + Ng . xyxy ; }".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void Nn ( vec2 Nl , out vec2 Nm ) { Nm = Nl / u_texel_size ; OC = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + Nl . xyxy ; OD = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + Nl . xyxy ; OE = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( OC . xz , OD . yw ) ; }".split(" ")}]}},
{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void Np ( vec2 No ) { OB = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + No . xyxy ; }".split(" ")}]}}]},{type:"textline",a:"void main ( ) { bM = 2.0 * a_position ;".split(" ")},{type:"condition",b:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["Nk","(","bM",")",";"]}]}},{type:"elif",d:["SMAA_PASS",
"SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Nn ( bM , OF ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["Np","(","bM",")",";"]}]}}]},{type:"textline",a:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",
a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",a:["1"]},{type:"define",name:"SSAO_QUALITY_16",a:["2"]},{type:"define",name:"SSAO_QUALITY_24",a:["3"]},{type:"define",name:"SSAO_QUALITY_32",a:["4"]},{type:"textline",a:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 bM ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float Nk ( in vec2 Ng ) { return Ow ( u_depth , Ng , u_camera_range ) ; } void main ( ) { float Nl , Nm , Nn , No , Np , Nq ; vec3 Nr , Ns , Nt , Nu ; Nr = texture2D ( u_color , bM ) . rgb ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SSAO_WHITE"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( Nr , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",a:"Ns = normalize ( 2.0 * texture2D ( u_ssao_special_tex , bM * 0.25 / u_texel_size ) . rgb - 1.0 ) ; Nl = Nk ( bM ) ; Nm = Nl * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_QUALITY","SSAO_QUALITY_8",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Nv = 8.0 ; const int Nw = 1 ;".split(" ")}]}},
{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_16",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Nv = 16.0 ; const int Nw = 2 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_24",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Nv = 24.0 ; const int Nw = 3 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_32",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float Nv = 32.0 ; const int Nw = 4 ;".split(" ")}]}}]},
{type:"textline",a:"Nn = u_ssao_radius_increase * 0.001 ; const float Nx = 1.0 + 2.4 / Nv ; No = 0.0 ; for ( int Ny = 0 ; Ny < Nw ; Ny ++ ) for ( int Nz = - 1 ; Nz <= 1 ; Nz += 2 ) for ( int OG = - 1 ; OG <= 1 ; OG += 2 ) for ( int OH = - 1 ; OH <= 1 ; OH += 2 ) { Nt = reflect ( normalize ( vec3 ( Nz , OG , OH ) ) , Ns ) * ( Nn *= Nx ) ; Nu = vec3 ( bM , Nm ) ; Nu += vec3 ( Nt . xy , Nt . z * Nm * 2.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",
a:"Nu . z -= 1.4 * ( Nu . z - Nm ) * step ( Nm , Nu . z ) ;".split(" ")}]}}]},{type:"textline",a:"Np = Nk ( Nu . xy ) * ( u_camera_range . y - u_camera_range . x ) ; Nq = clamp ( ( Nm - Np ) / Np , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",a:"No += mix ( 1.0 , Nq , step ( Np , Nu . z ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"No += mix ( step ( Nu . z , Np ) , 0.5 , Nq ) ;".split(" ")}]}}]},
{type:"textline",a:"} No = No / Nv ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",b:[{type:"textline",a:"No = clamp ( No * No + 0.6 * No , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"No = clamp ( No * No + No , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"Nl = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * Nl ) ; No = mix ( 1.0 , No , Nl ) ; gl_FragColor = vec4 ( Nr , No ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]=
{type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",a:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float Nk ( in vec2 Ng ) { return Ow ( u_depth , Ng , u_camera_range ) ; }".split(" ")}]}}]},
{type:"textline",a:"void main ( ) { vec2 Nl , Nm ; float Nn , No , Np , Nq , Nr , Ns , Nt ; Nn = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"No = Nk ( bM ) ; Np = 0.0 ; Nq = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{type:"textline",a:"Nl = vec2 ( - 2.0 ) ; for ( int Nu = 0 ; Nu < 4 ; ++ Nu ) { for ( int Nv = 0 ; Nv < 4 ; ++ Nv ) { Nm = ( Nl + vec2 ( float ( Nu ) , float ( Nv ) ) ) * u_texel_size ; Nr = texture2D ( u_ssao_mask , bM + Nm ) . a ;".split(" ")},
{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"Ns = Nk ( bM + Nm ) ; Nt = 1.0 - clamp ( abs ( Ns - No ) * Nq , 0.0 , 1.0 ) ; Nn += Nr * Nt ; Np += Nt ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["Nn","+=","Nr",";"]}]}}]},{type:"textline",a:["}","}"]},{type:"condition",b:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , bM ) . rgb , Nn / Np ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , bM ) . rgb , Nn / 16.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["postprocessing/stereo.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",a:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 bM ;".split(" ")},{type:"condition",b:[{type:"if",d:["ANAGLYPH",{type:"logic_negative_expr",
e:1}],group:{type:"group",b:[{type:"textline",a:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void Nt ( vec2 Ng , vec2 Nk , float Nl , sampler2D Nm ) { vec4 Nn ; float No ; vec2 Np , Nq , Nr , Ns ; Np = ( Ng - Nk ) * 2.0 ; Np /= Nl ; No = Np . x * Np . x + Np . y * Np . y ; Np = Np * ( 1.0 + u_distortion_params [ 0 ] * No + u_distortion_params [ 1 ] * No * No ) ; Np = Np * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { Nq = Np * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + No * u_chromatic_aberration_coefs [ 1 ] ) + Nk ; Nr = Np + Nk ; Ns = Np * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + No * u_chromatic_aberration_coefs [ 3 ] ) + Nk ; if ( clamp ( Ns , 0.0 , 1.0 ) != Ns ) { gl_FragColor = vec4 ( 0.0 ) ; } else { Nn = texture2D ( Nm , Nr ) ; gl_FragColor [ 0 ] = texture2D ( Nm , Nq ) . x ; gl_FragColor [ 1 ] = Nn . y ; gl_FragColor [ 2 ] = texture2D ( Nm , Ns ) . z ; gl_FragColor [ 3 ] = Nn . w ; } } else { Np = Np * Nl + Nk ; if ( clamp ( Np , 0.0 , 1.0 ) != Np ) { gl_FragColor = vec4 ( 0.0 ) ; } else { gl_FragColor = texture2D ( Nm , Np ) ; } } }".split(" ")}]}}]},
{type:"textline",a:"void main ( ) { float Nu ; vec2 Nv , Nw ; mat3 Nx , Ny ; vec3 Nz , OG ; vec4 OH , OI ;".split(" ")},{type:"condition",b:[{type:"if",d:["ANAGLYPH"],group:{type:"group",b:[{type:"textline",a:"OH = texture2D ( u_sampler_left , bM ) ; OI = texture2D ( u_sampler_right , bM ) ; Nz = vec3 ( OH [ 0 ] , OH [ 1 ] , OH [ 2 ] ) ; br ( Nz ) ; OG = vec3 ( OI [ 0 ] , OI [ 1 ] , OI [ 2 ] ) ; br ( OG ) ; Nx = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; Ny = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; OG = clamp ( Nx * Nz , 0.0 , 1.0 ) + clamp ( Ny * OG , 0.0 , 1.0 ) ; bu ( OG ) ; gl_FragColor = vec4 ( OG , OH [ 3 ] + OI [ 3 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"if ( u_enable_hmd_stereo != 0 ) { if ( bM [ 0 ] < 0.5 ) { Nv = vec2 ( 2.0 * bM [ 0 ] , bM [ 1 ] ) ; Nw = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; Nu = 2.0 * u_distortion_params [ 3 ] ; Nt ( Nv , Nw , Nu , u_sampler_left ) ; } else { Nw = vec2 ( 2.0 * ( bM [ 0 ] - 0.5 ) , bM [ 1 ] ) ; Nv = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; Nu = 2.0 * u_distortion_params [ 3 ] ; Nt ( Nw , Nv , Nu , u_sampler_right ) ; } } else { gl_FragColor = texture2D ( u_sampler_left , bM ) ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",b:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",a:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 bM ; void main ( ) { vec2 Ng ; vec4 Nk , Nl ; float Nm ; Nm = texture2D ( u_depth , bM ) . x ; Nk = vec4 ( bM * 2.0 - 1.0 , 2.0 * Nm - 1.0 , 1.0 ) ; Nl = u_view_proj_inverse * Nk ; Nl = Nl / Nl . w ; Nl = u_view_proj_prev * Nl ; Nl /= Nl . w ; Ng = ( Nk . xy - Nl . xy ) / 4.0 + 0.5 ; Ng = clamp ( Ng , 0.0 , 1.0 ) ; gl_FragColor = V ( Ng ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"textline",a:["precision","PRECISION","float",";"]}]};a["include/math.glslv"]={type:"group",b:[{type:"var",name:"EPSILON",a:["0.0001"]},{type:"textline",a:"float a = 0.0 ; float b = 1.0 ; struct c { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool f ( vec3 d , vec3 e ) { return any ( lessThan ( abs ( d - e ) , vec3 ( EPSILON ) ) ) ; } vec3 i ( in vec4 g , in vec3 h ) { return h + 2.0 * cross ( g . xyz , cross ( g . xyz , h ) + g . w * h ) ; } vec4 k ( in vec4 j ) { return vec4 ( - j . xyz , j . w ) / dot ( j , j ) ; } vec3 p ( vec4 l , vec4 m , vec4 n ) { vec3 o ; o = n . xyz * l . w ; o = i ( m , o ) ; o += l . xyz * n . w ; return o ; } vec3 v ( vec4 q , vec4 r , vec4 s ) { vec4 t ; vec3 u ; u = s . xyz - q . xyz * s . w ; t = k ( r ) ; u = i ( t , u ) ; u /= q . w ; return u ; } mat4 w ( ) { return mat4 ( b , a , a , a , a , b , a , a , a , a , b , a , a , a , a , b ) ; } mat4 y ( float x ) { return mat4 ( b , a , a , a , a , cos ( x ) , sin ( x ) , a , a , - sin ( x ) , cos ( x ) , a , a , a , a , b ) ; } mat4 A ( float z ) { return mat4 ( cos ( z ) , a , - sin ( z ) , a , a , b , a , a , sin ( z ) , a , cos ( z ) , a , a , a , a , b ) ; } mat4 C ( float B ) { return mat4 ( cos ( B ) , sin ( B ) , a , a , - sin ( B ) , cos ( B ) , a , a , a , a , b , a , a , a , a , b ) ; } c E ( in c D ) { return c ( D . a , D . b , normalize ( D . c ) , normalize ( D . d ) , normalize ( D . e ) , D . f ) ; }".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",b:[{type:"textline",a:"vec3 L ( vec4 F ) { vec3 G ; float H , I , J ; H = F . x ; I = F . y ; J = F . w ; G . x = ( H + J ) / 2.0 ; G . y = ( I + J ) / 2.0 ; G . z = J ; return G ; }".split(" ")}]}}]},{type:"textline",a:"mat4 O ( mat3 M ) { mat4 N ; N [ 0 ] [ 0 ] = ( b - ( M [ 1 ] [ 2 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) + M [ 2 ] [ 0 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 1 ] = ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) + M [ 2 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 2 ] = ( M [ 1 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) - M [ 2 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) * M [ 1 ] [ 0 ] ; N [ 0 ] [ 3 ] = a ; N [ 1 ] [ 0 ] = ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) - M [ 2 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 1 ] = ( b - ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) + M [ 2 ] [ 0 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 2 ] = ( M [ 1 ] [ 2 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) + M [ 2 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) ) * M [ 1 ] [ 0 ] ; N [ 1 ] [ 3 ] = a ; N [ 2 ] [ 0 ] = ( M [ 1 ] [ 1 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) + M [ 2 ] [ 1 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 1 ] = ( M [ 1 ] [ 2 ] * ( M [ 2 ] [ 0 ] + M [ 2 ] [ 0 ] ) - M [ 2 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 2 ] = ( b - ( M [ 1 ] [ 1 ] * ( M [ 1 ] [ 1 ] + M [ 1 ] [ 1 ] ) + M [ 1 ] [ 2 ] * ( M [ 1 ] [ 2 ] + M [ 1 ] [ 2 ] ) ) ) * M [ 1 ] [ 0 ] ; N [ 2 ] [ 3 ] = a ; N [ 3 ] [ 0 ] = M [ 0 ] [ 0 ] ; N [ 3 ] [ 1 ] = M [ 0 ] [ 1 ] ; N [ 3 ] [ 2 ] = M [ 0 ] [ 2 ] ; N [ 3 ] [ 3 ] = 1.0 ; return N ; }".split(" ")}]};
a["include/std_enums.glsl"]={type:"group",b:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",a:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",a:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",a:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",a:["2"]},{type:"define",name:"SHADOW_SRC_NONE",a:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",a:["2"]},{type:"define",name:"SHADOW_SRC_MASK",a:["3"]},{type:"define",name:"SHADOW_DST_NONE",a:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",a:["2"]},
{type:"define",name:"SHADOW_DST_MASK",a:["3"]},{type:"define",name:"NO_SHADOWS",a:["1"]},{type:"define",name:"SHADOW_CASTING",a:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",a:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",a:["4"]},{type:"define",name:"SHADOW_MAPPING_BLEND",a:["5"]},{type:"define",name:"SPECULAR_PHONG",a:["1"]},{type:"define",name:"SPECULAR_COOKTORR",a:["2"]},{type:"define",name:"SPECULAR_WARDISO",a:["3"]},{type:"define",name:"SPECULAR_BLINN",a:["4"]},{type:"define",name:"SPECULAR_TOON",
a:["5"]},{type:"define",name:"DIFFUSE_LAMBERT",a:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",a:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",a:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",a:["4"]},{type:"define",name:"DIFFUSE_TOON",a:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",a:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",a:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",a:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",a:["3.0"]},{type:"define",name:"MIX",a:["0"]},{type:"define",
name:"ADD",a:["1"]},{type:"define",name:"SUBTRACT",a:["2"]},{type:"define",name:"MULTIPLY",a:["3"]},{type:"define",name:"SCREEN",a:["4"]},{type:"define",name:"OVERLAY",a:["5"]},{type:"define",name:"DIFFERENCE",a:["6"]},{type:"define",name:"DIVIDE",a:["7"]},{type:"define",name:"DARKEN",a:["8"]},{type:"define",name:"LIGHTEN",a:["9"]},{type:"define",name:"HUE",a:["10"]},{type:"define",name:"SATURATION",a:["11"]},{type:"define",name:"VALUE",a:["12"]},{type:"define",name:"COLOR",a:["13"]},{type:"define",
name:"SOFT_LIGHT",a:["14"]},{type:"define",name:"LINEAR_LIGHT",a:["15"]},{type:"define",name:"REFL_NONE",a:["0"]},{type:"define",name:"REFL_MIRRORMAP",a:["1"]},{type:"define",name:"REFL_PLANE",a:["2"]},{type:"define",name:"REFL_CUBE",a:["3"]},{type:"define",name:"INVERSE_QUADRATIC",a:["0"]},{type:"define",name:"LINEAR",a:["1"]},{type:"define",name:"QUADRATIC",a:["2"]},{type:"define",name:"HEMI",a:["1"]},{type:"define",name:"SPOT",a:["2"]},{type:"define",name:"POINT",a:["3"]},{type:"define",name:"SUN",
a:["4"]},{type:"define",name:"VT_WORLD_TO_WORLD",a:["0"]},{type:"define",name:"VT_WORLD_TO_OBJECT",a:["1"]},{type:"define",name:"VT_WORLD_TO_CAMERA",a:["2"]},{type:"define",name:"VT_OBJECT_TO_WORLD",a:["3"]},{type:"define",name:"VT_OBJECT_TO_OBJECT",a:["4"]},{type:"define",name:"VT_OBJECT_TO_CAMERA",a:["5"]},{type:"define",name:"VT_CAMERA_TO_WORLD",a:["6"]},{type:"define",name:"VT_CAMERA_TO_OBJECT",a:["7"]},{type:"define",name:"VT_CAMERA_TO_CAMERA",a:["8"]},{type:"define",name:"VT_POINT",a:["0"]},
{type:"define",name:"VT_VECTOR",a:["1"]},{type:"define",name:"VT_NORMAL",a:["2"]}]};a["include/pack.glslf"]={type:"group",b:[{type:"textline",a:"float P = 255.0 ; float Q = 0.0 ; float R = 1.0 ; vec4 V ( const in float S ) { vec4 T , U ; T = vec4 ( P * P * P , P * P , P , R ) ; U = vec4 ( Q , R / P , R / P , R / P ) ; T = fract ( S * T ) ; T -= T . xxyz * U ; return T ; } float Z ( const in vec4 W ) { vec4 X ; float Y ; X = vec4 ( R / ( P * P * P ) , R / ( P * P ) , R / P , R ) ; Y = dot ( W , X ) ; return Y ; } vec4 V ( const in vec2 _ ) { vec4 aa ; vec2 ab , ac ; ab = vec2 ( P , R ) ; ac = vec2 ( Q , R / P ) ; aa = fract ( _ . xxyy * ab . xyxy ) ; aa -= aa . xxzz * ac . xyxy ; if ( _ . r == R ) aa . rg = vec2 ( Q , R ) ; if ( _ . g == R ) aa . ba = vec2 ( Q , R ) ; return aa ; } vec2 ag ( const in vec4 ad ) { vec2 ae , af ; af = vec2 ( R / P , R ) ; ae . r = dot ( ad . rg , af ) ; ae . g = dot ( ad . ba , af ) ; return ae ; }".split(" ")}]};
a["include/procedural.glslf"]={type:"group",b:[{type:"textline",a:"float ah = 0.0 ; float ai = 1.0 ; vec4 ak ( vec4 aj ) { return aj - floor ( aj * ( ai / 289.0 ) ) * 289.0 ; } vec3 ak ( vec3 al ) { return al - floor ( al * ( ai / 289.0 ) ) * 289.0 ; } vec2 ak ( vec2 am ) { return am - floor ( am * ( ai / 289.0 ) ) * 289.0 ; } vec4 ao ( vec4 an ) { return an - floor ( an * ( ai / 7.0 ) ) * 7.0 ; } vec4 aq ( vec4 ap ) { return ak ( ( 34.0 * ap + 5.0 ) * ap ) ; }".split(" ")},{type:"define",name:"K",
a:["0.142857142857"]},{type:"define",name:"K2",a:["0.0714285714285"]},{type:"define",name:"JITTER",a:["0.7"]},{type:"textline",a:"vec2 ay ( vec2 ar ) { vec4 as , at , au , av ; vec2 aw , ax ; aw = ak ( floor ( ar ) ) ; ax = fract ( ar ) ; as = ax . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; at = ax . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; au = aq ( aw . x + vec4 ( ah , ai , ah , ai ) ) ; au = aq ( au + aw . y + vec4 ( ah , ah , ai , ai ) ) ; av = ao ( au ) * K + K2 ; au = ao ( floor ( au * K ) ) * K + K2 ; av = as + JITTER * av ; au = at + JITTER * au ; au = av * av + au * au ;".split(" ")},
{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"textline",a:"au . xy = min ( au . xy , au . zw ) ; au . x = min ( au . x , au . y ) ; return au . xx ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"au . xy = ( au . x < au . y ) ? au . xy : au . yx ; au . xz = ( au . x < au . z ) ? au . xz : au . zx ; au . xw = ( au . x < au . w ) ? au . xw : au . wx ; au . y = min ( au . y , au . z ) ; au . y = min ( au . y , au . w ) ; return sqrt ( au . xy ) ;".split(" ")}]}}]},
{type:"textline",a:"} vec3 aH ( vec2 az , float aA ) { vec4 aB , aC , aD , aE ; vec2 aF , aG ; aF = ak ( floor ( az ) ) ; aG = fract ( az ) ; aB = aG . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; aC = aG . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; aD = aq ( aF . x + vec4 ( ah , ai , ah , ai ) ) ; aD = aq ( aD + aF . y + vec4 ( ah , ah , ai , ai ) ) ; aE = ao ( aD ) * K + K2 ; aD = ao ( floor ( aD * K ) ) * K + K2 ; aE = aB + JITTER * aE ; aD = aC + JITTER * aD ; aC = aE * aE + aD * aD ; aE += aA ; aD += aA ; aB = aE * aE + aD * aD ; aE += aA ; aD += aA ; aD = aE * aE + aD * aD ; aC . xy = min ( aC . xy , aC . zw ) ; aC . x = min ( aC . x , aC . y ) ; aB . xy = min ( aB . xy , aB . zw ) ; aB . x = min ( aB . x , aB . y ) ; aD . xy = min ( aD . xy , aD . zw ) ; aD . x = min ( aD . x , aD . y ) ; return vec3 ( aC . x , aB . x , aD . x ) ; } vec3 aJ ( vec3 aI ) { return ak ( ( ( aI * 34.0 ) + ai ) * aI ) ; } float aU ( vec2 aK ) { vec3 aL , aM , aN , aO ; vec4 aP ; vec2 aQ , aR , aS ; const vec4 aT = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; aQ = floor ( aK + dot ( aK , aT . yy ) ) ; aR = aK - aQ + dot ( aQ , aT . xx ) ; aS = ( aR . x > aR . y ) ? vec2 ( ai , ah ) : vec2 ( ah , ai ) ; aP = aR . xyxy + aT . xxzz ; aP . xy -= aS ; aQ = ak ( aQ ) ; aL = aJ ( aJ ( aQ . y + vec3 ( ah , aS . y , ai ) ) + aQ . x + vec3 ( ah , aS . x , ai ) ) ; aM = max ( 0.5 - vec3 ( dot ( aR , aR ) , dot ( aP . xy , aP . xy ) , dot ( aP . zw , aP . zw ) ) , ah ) ; aM = aM * aM ; aM = aM * aM ; aL = 2.0 * fract ( aL * aT . www ) - ai ; aN = abs ( aL ) - 0.5 ; aO = floor ( aL + 0.5 ) ; aO = aL - aO ; aM *= 1.79284291400159 - 0.85373472095314 * ( aO * aO + aN * aN ) ; aL . x = aO . x * aR . x + aN . x * aR . y ; aL . yz = aO . yz * aP . xz + aN . yz * aP . yw ; return 130.0 * dot ( aM , aL ) ; } vec2 aY ( vec2 aV ) { float aW , aX ; aW = dot ( aV , vec2 ( 12.9898 , 78.233 ) ) ; aX = dot ( aV , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; aW = fract ( sin ( aW ) * 43758.5453 ) * 2.0 - ai ; aX = fract ( sin ( aX ) * 43758.5453 ) * 2.0 - ai ; return vec2 ( aW , aX ) ; }".split(" ")}]};
a["include/caustics.glslf"]={type:"group",b:[{type:"var",name:"CAUST_SPEED",a:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",a:["0.0"]},{type:"var",name:"CAUST_BRIGHT",a:["0.0"]},{type:"var",name:"SUN_NUM",a:["0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",a:["100.0"]},{type:"textline",a:"void bp ( inout vec3 aZ , float a_ , float ba , vec4 bb , vec3 bc , vec3 bd , vec3 be , vec4 bf , vec3 bg , float bh ) { float bi , bj , bk ; vec2 bl , bm ; vec3 bn ; vec4 bo ; if ( bh > CAUSTICS_VIEW_DISTANCE ) return ; bo = bf ; bn = bg + bc ; bn . xz = 10.0 * sin ( 0.1 * bn . xz ) ; bn = bn + 2.0 * cross ( - bo . xyz , cross ( - bo . xyz , bn ) + bo . w * bn ) ; bl = bn . xz ; bn = bd ; bi = max ( dot ( bc , bn ) , 0.0 ) ; bj = 0.025 ; bm = CAUST_SPEED * ba ; bl . s += 0.25 * sin ( dot ( bg + ba , vec3 ( 1.0 ) ) ) ; bl . t += 0.35 * ( - sin ( dot ( bg - ba , vec3 ( - 0.7 ) ) ) ) ; bl . st += 0.15 * cos ( 4.0 * a_ - bm . x ) + 1.5 * sin ( a_ - 0.3 * bm . y ) ; bk = CAUST_SCALE * ( 1.0 + max ( 0.1 * a_ , 0.0 ) ) ; bn = aH ( ( bl / bk ) , bj ) ; bn *= CAUST_BRIGHT ; bn *= bn ; bj = min ( 0.25 * a_ , - a_ ) + 1.0 ; bj = max ( bj , 0.0 ) ; bi = bb [ SUN_NUM ] * bi ; bk = max ( sign ( a_ ) , 0.0 ) ; bi = bi + max ( 0.5 * sign ( - bc . y ) * bk , 0.0 ) ; bi = min ( bi , 1.0 ) ; aZ += be * bn * bj * bi ; }".split(" ")}]};
a["include/color_util.glslf"]={type:"group",b:[{type:"define",name:"GAMMA",a:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",a:["1"]},{type:"textline",a:"void br ( inout vec3 bq ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",a:"bq = max ( vec3 ( 0.0 ) , bq ) ; bq = pow ( bq , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",a:"} void br ( inout float bs ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",
a:"bs = pow ( max ( 0.0 , bs ) , 2.2 ) ;".split(" ")}]}}]},{type:"textline",a:"} void bu ( inout vec3 bt ) {".split(" ")},{type:"condition",b:[{type:"if",d:["GAMMA"],group:{type:"group",b:[{type:"textline",a:"bt = max ( vec3 ( 0.0 ) , bt ) ; bt = pow ( bt , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",a:"} void bx ( inout vec3 bv , in float bw ) {".split(" ")},{type:"condition",b:[{type:"if",d:["PREMULTIPLY_ALPHA"],group:{type:"group",b:[{type:"textline",a:"bv = bv * bw ;".split(" ")}]}}]},
{type:"textline",a:"} float bB ( vec4 by ) { float bz ; vec3 bA ; bA = vec3 ( 0.299 , 0.587 , 0.114 ) ; bz = dot ( by . rgb , bA ) ; return bz ; }".split(" ")}]};a["include/shadow.glslf"]={type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",a:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",a:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const float bN = 0.1 ; const float bO = 0.1 ; const float bP = - 0.01 ; const float bQ = 0.05 ; vec4 bR = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 bS = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 bT = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 bU = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 bV = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 bW = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 bX = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 bY = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool ca ( vec2 bZ , float b_ ) { return all ( lessThanEqual ( bZ , vec2 ( 1.0 + b_ ) ) ) && all ( greaterThanEqual ( bZ , vec2 ( 0.0 - b_ ) ) ) ; } float cj ( float cb , float cc , mat2 cd , vec3 ce , float cf , PRECISION sampler2D cg ) { vec2 ch , ci ; ci . x = cb ; ci . y = cc ; ci = cd * ci ; ch = ce . xy + ci * cf / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"if ( ! ca ( ch , bP ) ) return 1.0 ; else".split(" ")}]}}]},{type:"textline",a:"return step ( ce . z , texture2D ( cg , ch ) . r ) ; } float cs ( vec3 ck , PRECISION sampler2D cl , float cm ) { mat2 cn ; float co , cp , cq ; co = 0.0 ; ck . z = clamp ( ck . z , 0.0 , 1.0 ) ; cp = aY ( ck . xy ) . x * M_PI ; cq = cos ( cp ) ; cp = sin ( cp ) ; cn = mat2 ( cq , cp , - cp , cq ) ; for ( int cr = 0 ; cr < 4 ; cr ++ ) { co += cj ( bR [ cr ] , bV [ cr ] , cn , ck , cm , cl ) ; co += cj ( bS [ cr ] , bW [ cr ] , cn , ck , cm , cl ) ; co += cj ( bT [ cr ] , bX [ cr ] , cn , ck , cm , cl ) ; co += cj ( bU [ cr ] , bY [ cr ] , cn , ck , cm , cl ) ; } return clamp ( co / 16.0 , 0.0 , 1.0 ) ; } float cH ( vec3 ct , PRECISION sampler2D cu , vec3 cv , PRECISION sampler2D cw , float cx , float cy , float cz ) { mat2 cA ; float cB , cC , cD , cE ; ct . z = clamp ( ct . z , 0.0 , 1.0 ) ; cv . z = clamp ( cv . z , 0.0 , 1.0 ) ; cB = 0.0 ; cC = 0.0 ; cD = aY ( ct . xy ) . x * M_PI ; cE = cos ( cD ) ; cD = sin ( cD ) ; cA = mat2 ( cE , cD , - cD , cE ) ; for ( int cF = 0 ; cF < 4 ; cF ++ ) { cB += cj ( bR [ cF ] , bV [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bS [ cF ] , bW [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bT [ cF ] , bX [ cF ] , cA , ct , cx , cu ) ; cB += cj ( bU [ cF ] , bY [ cF ] , cA , ct , cx , cu ) ; } for ( int cG = 0 ; cG < 4 ; cG ++ ) { cC += cj ( bR [ cG ] , bV [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bS [ cG ] , bW [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bT [ cG ] , bX [ cG ] , cA , cv , cy , cw ) ; cC += cj ( bU [ cG ] , bY [ cG ] , cA , cv , cy , cw ) ; } cB = mix ( cB , cC , cz ) ; cB /= 16.0 ; return clamp ( cB , 0.0 , 1.0 ) ; } float cL ( vec2 cI ) { float cJ , cK ; cJ = min ( cI . x , cI . y ) ; cK = min ( 1.0 - cI . x , 1.0 - cI . y ) ; return min ( cJ , cK ) ; } float cO ( float cM , float cN ) { if ( cN >= 0.0 && cN <= bO ) cM = ( cM - 1.0 ) / bO * cN + 1.0 ; return cM ; } float cZ ( vec3 cP , vec3 cQ , PRECISION sampler2D cR , PRECISION sampler2D cS , float cT , float cU , float cV , float cW ) { float cX , cY ;".split(" ")},
{type:"condition",b:[{type:"if",d:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",b:[{type:"textline",a:"cY = cL ( cP . xy ) ; if ( - cW > cV && cY >= 0.0 && cY <= bN && ca ( cQ . xy , 0.0 ) ) { cY = 1.0 - cY / bN ; cX = cH ( cP , cR , cQ , cS , cT , cU , cY ) ; } else".split(" ")}]}}]},{type:"textline",a:"cX = cs ( cP , cR , cT ) ; return cX ; } float dg ( vec3 c_ , PRECISION sampler2D da , float db , float dc , float dd ) { float de , df ; de = cs ( c_ , da , db ) ;".split(" ")},{type:"condition",
b:[{type:"if",d:["CSM_FADE_LAST_CASCADE"],group:{type:"group",b:[{type:"textline",a:"if ( - dd > dc ) { df = cL ( c_ . xy ) ; de = cO ( de , df ) ; }".split(" ")}]}}]},{type:"textline",a:"return de ; } vec4 dr ( float dh ) { vec3 di , dj , dk , dl ; float dm , dn , dp , dq ; dm = 1.0 ; di = bI . xyz / bI . w ; if ( bI . w < 0.0 ) di . z = 0.0 ;".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION1","NUM_CAST_LAMPS",1,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",
a:"dj = bJ . xyz / bJ . w ; if ( bJ . w < 0.0 ) dj . z = 0.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2","NUM_CAST_LAMPS",2,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dk = bK . xyz / bK . w ; if ( bK . w < 0.0 ) dk . z = 0.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3","NUM_CAST_LAMPS",3,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dl = bL . xyz / bL . w ; if ( bL . w < 0.0 ) dl . z = 0.0 ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",b:[{type:"textline",a:"if ( ca ( di . xy , 0.0 ) ) { dm = cZ ( di , dj , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , dh ) ; }".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"if ( ca ( di . xy , bQ ) ) { dm = dg ( di , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , dh ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",
d:["CSM_SECTION1"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dj . xy , 0.0 ) ) {".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",a:"dm = cZ ( dj , dk , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , dh ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dm = dg ( dj , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , dh ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dk . xy , 0.0 ) ) {".split(" ")},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"dm = cZ ( dk , dl , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , dh ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"dm = dg ( dk , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , dh ) ;".split(" ")}]}}]},
{type:"textline",a:["}"]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"else { if ( ca ( dl . xy , 0.0 ) ) dm = dg ( dl , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , dh ) ; }".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dn = cs ( dj , u_shadow_map1 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["dn","=","0.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dp = cs ( dk , u_shadow_map2 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["dp","=","0.0",";"]}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dq = cs ( dl , u_shadow_map3 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:["dq","=","1.0",";"]}]}}]},{type:"textline",a:"return vec4 ( dm , dn , dp , dq ) ; }".split(" ")}]}}]},{type:"textline",a:"vec4 du ( inout vec3 ds ) { vec4 dt ;".split(" ")},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dt = texture2DProj ( u_shadow_mask , bG ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"l_expr",e:2}],
group:{type:"group",b:[{type:"textline",a:"ds *= dt . a ;".split(" ")}]}}]},{type:"textline",a:["return","dt",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dt = dr ( bD . z ) ; return dt ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};
a["include/mirror.glslf"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"define",name:"REFL_BUMP",a:["0.1"]},{type:"textline",a:"float dB ( in vec3 dv , vec3 dw , float dx , float dy ) { float dz ; vec3 dA ; dA = normalize ( dw + dv ) ; dz = 1.0 - dot ( dv , dA ) ; dz = dy + ( 1.0 - dy ) * pow ( dz , dx ) ; return dz ; } void dP ( inout vec3 dC , vec3 dD , vec3 dE , float dF , mat4 dG ) { vec2 dH , dI ; float dJ , dK , dL ; vec3 dM , dN , dO ; dM = reflect ( - dD , dE ) ; dJ = u_fresnel_params [ 2 ] ; dK = u_fresnel_params [ 3 ] ; dL = 1.0 ; if ( dJ != 0.0 ) dL = dB ( dD , dM , dJ , dK ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dN = textureCube ( u_cube_reflection , dM ) . xyz ;".split(" ")}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["REFLECTION_PASS",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"dO = u_refl_plane . xyz * dot ( dE , u_refl_plane . xyz ) ; dO = dE - dO ; dH = ( dG * vec4 ( dO , 0.0 ) ) . xy ; dI = bG . xy / bG . z ; dI += dH * REFL_BUMP ; dN = texture2D ( u_plane_reflection , dI ) . rgb ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"dN = vec3 ( 1.0 ) ; dF = 0.0 ;".split(" ")}]}}]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"dN = textureCube ( u_mirrormap , dM ) . xyz ; dF = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",a:"br ( dN . rgb ) ; dC = mix ( dC , dN , dF * dL ) ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",b:[{type:"textline",a:"vec3 dS ( vec3 dQ ) { float dR ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SKY_TEXTURE"],group:{type:"group",b:[{type:"textline",a:"return textureCube ( u_sky_texture , dQ ) . rgb ;".split(" ")}]}},{type:"elif",d:["SKY_COLOR"],group:{type:"group",b:[{type:"textline",a:"dR = 0.5 * dQ . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , dR ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["include/refraction.glslf"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["REFRACTIVE"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_REFRACTION_CORRECTION"],group:{type:"group",b:[{type:"textline",a:"float dY ( in float dT , inout vec2 dU , in vec2 dV ) { float dW ; vec4 dX ; dX = texture2D ( u_scene_depth , dU ) ; dW = Z ( dX ) ; if ( dW < bH ) { dU = dV ; return dT ; } else { return dW ; } return dT ; }".split(" ")}]}}]},
{type:"textline",a:"vec3 ef ( in vec3 dZ , in vec2 d_ ) { vec3 ea ; float eb ; vec4 ec ; vec2 ed , ee ; ed = dZ . xy / dZ . z ; ee = ed + d_ ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_REFRACTION_CORRECTION"],group:{type:"group",b:[{type:"textline",a:"ec = texture2DProj ( u_scene_depth , dZ ) ; eb = Z ( ec ) ; dY ( eb , ee , ed ) ;".split(" ")}]}}]},{type:"textline",a:"ea = texture2D ( u_refractmap , ee ) . rgb ; br ( ea ) ; return ea ; }".split(" ")}]}}]}]};a["include/nodes.glslf"]={type:"group",
b:[{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",
a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NODE_TEX_ROW",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",
e:2}],group:{type:"group",b:[{type:"textline",a:["varying","vec3","eg",";"]}]}}]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float eh = 0.5 ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",b:[{type:"textline",a:"vec3 el ( in vec3 ei , in float ej ) { vec3 ek ; ek = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",b:[{type:"textline",a:"ek = ef ( bG , ei . xy * ej ) ;".split(" ")}]}},
{type:"elif",d:["HAS_REFRACT_TEXTURE"],group:{type:"group",b:[{type:"textline",a:"ek = texture2D ( u_refractmap , bG . xy / bG . z ) . rgb ; br ( ek ) ;".split(" ")}]}}]},{type:"textline",a:["return","ek",";","}"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 eq ( vec3 em ) { float en , eo ; vec4 ep ; ep = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; ep = mix ( vec4 ( em . bg , ep . wz ) , vec4 ( em . gb , ep . xy ) , step ( em . b , em . g ) ) ; ep = mix ( vec4 ( ep . xyw , em . r ) , vec4 ( em . r , ep . yzx ) , step ( ep . x , em . r ) ) ; en = ep . x - min ( ep . w , ep . y ) ; eo = 1.0e-10 ; return vec3 ( abs ( ep . z + ( ep . w - ep . y ) / ( 6.0 * en + eo ) ) , en / ( ep . x + eo ) , ep . x ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 eu ( vec3 er ) { vec3 es ; vec4 et ; et = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; es = abs ( fract ( vec3 ( er . r , er . r , er . r ) + et . xyz ) * 6.0 - et . www ) ; return er . b * mix ( et . xxx , clamp ( es - et . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , er . g ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec3 ew ( vec2 ev ) { return vec3 ( ev * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec2 ey ( vec3 ex ) { return vec2 ( ex . xy * eh + vec2 ( eh , eh ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",h:[{type:"node_out",name:"fq",qualifier:["vec3"],c:!0},{type:"node_out",name:"fr",qualifier:["float"],c:!0},{type:"node_out",name:"fs",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fq"],f:[{type:"textline",a:"fq = normalize ( fh . xyz ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fr"],f:[{type:"textline",a:"fr = abs ( fh . z ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_fs"],
f:[{type:"textline",a:"fs = length ( fh . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",h:[{type:"node_in",name:"ft",qualifier:["float"],c:!1},{type:"node_in",name:"fu",qualifier:["float"],c:!1},{type:"node_in",name:"fv",qualifier:["float"],c:!1},{type:"node_out",name:"fw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fw = vec3 ( ft , fu , fv ) ;".split(" ")}]},{type:"node",name:"COMBHSV",h:[{type:"node_in",name:"fx",qualifier:["float"],c:!1},{type:"node_in",name:"fy",qualifier:["float"],
c:!1},{type:"node_in",name:"fz",qualifier:["float"],c:!1},{type:"node_out",name:"fA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fA = eu ( vec3 ( fx , fy , fz ) ) ;".split(" ")}]},{type:"node",name:"EMPTY_UV",h:[{type:"node_out",name:"fB",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fB = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"EMPTY_VC",h:[{type:"node_out",name:"fC",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fC = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[{type:"node_out",name:"fD",qualifier:["vec3"],c:!1},{type:"node_param",name:"ez",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"fD = ew ( ez ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",h:[{type:"node_out",name:"fE",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fE = 2.0 * eg - vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_out",name:"fF",qualifier:["vec3"],c:!1},{type:"node_param",name:"eA",qualifier:["varying",
"vec3"],c:!1}],f:[{type:"textline",a:"fF = eA ; br ( fF ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_out",name:"fG",qualifier:["float"],c:!1},{type:"node_param",name:"eB",qualifier:["varying","float"],c:!1}],f:[{type:"textline",a:"fG = eB ; br ( fG ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_out",name:"fH",qualifier:["float"],c:!1},{type:"node_out",name:"fI",qualifier:["float"],c:!1},{type:"node_param",name:"eC",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",
a:"fH = eC [ 0 ] ; fI = eC [ 1 ] ; br ( fH ) ; br ( fI ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_out",name:"fJ",qualifier:["float"],c:!1},{type:"node_out",name:"fK",qualifier:["float"],c:!1},{type:"node_out",name:"fL",qualifier:["float"],c:!1},{type:"node_param",name:"eD",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:"fJ = eD [ 0 ] ; fK = eD [ 1 ] ; fL = eD [ 2 ] ; br ( fJ ) ; br ( fK ) ; br ( fL ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_NO",h:[{type:"node_out",
name:"fM",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fM = fk . xzy ; fM . y *= - 1.0 ;".split(" ")}]},{type:"node",name:"GEOMETRY_FB",h:[{type:"node_out",name:"fN",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["INVERT_FRONTFACING"],f:[{type:"textline",a:"fN = ( gl_FrontFacing ) ? ZERO_VALUE_NODES : UNITY_VALUE_NODES ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"fN = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]}]}]},{type:"node",
name:"GEOMETRY_VW",h:[{type:"node_out",name:"fO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fO = - ( eN * vec4 ( eM , 0.0 ) ) . xyz ;".split(" ")}]},{type:"node",name:"GEOMETRY_LO",h:[{type:"node_out",name:"fP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fP [ 0 ] = fh [ 0 ] ; fP [ 1 ] = fh [ 1 ] ; fP [ 2 ] = fh [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",h:[{type:"node_out",name:"fQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fQ = vec3 ( fl . r , - fl . b , fl . g ) ;".split(" ")}]},
{type:"node",name:"NEW_GEOMETRY",h:[{type:"node_out",name:"fR",qualifier:["vec3"],c:!1},{type:"node_out",name:"fS",qualifier:["vec3"],c:!1},{type:"node_out",name:"fT",qualifier:["vec3"],c:!1},{type:"node_out",name:"fU",qualifier:["vec3"],c:!1},{type:"node_out",name:"fV",qualifier:["vec3"],c:!1},{type:"node_out",name:"fW",qualifier:["vec3"],c:!1},{type:"node_out",name:"fX",qualifier:["float"],c:!1},{type:"node_out",name:"fY",qualifier:["float"],c:!1}],f:[{type:"textline",a:"fR = vec3 ( ZERO_VALUE_NODES ) ; fS = vec3 ( ZERO_VALUE_NODES ) ; fT = vec3 ( ZERO_VALUE_NODES ) ; fU = vec3 ( ZERO_VALUE_NODES ) ; fV = vec3 ( ZERO_VALUE_NODES ) ; fW = vec3 ( ZERO_VALUE_NODES ) ; fX = ZERO_VALUE_NODES ; fY = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"HUE_SAT",h:[{type:"node_in",name:"fZ",qualifier:["float"],c:!1},{type:"node_in",name:"f_",qualifier:["float"],c:!1},{type:"node_in",name:"ga",qualifier:["float"],c:!1},{type:"node_in",name:"gb",qualifier:["float"],c:!1},{type:"node_in",name:"gc",qualifier:["vec3"],c:!1},{type:"node_out",name:"gd",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fn = eq ( gc ) ; fn [ 0 ] += ( fZ - eh ) ; if ( fn [ 0 ] > UNITY_VALUE_NODES ) fn [ 0 ] -= UNITY_VALUE_NODES ; else if ( fn [ 0 ] < ZERO_VALUE_NODES ) fn [ 0 ] += UNITY_VALUE_NODES ; fn *= vec3 ( UNITY_VALUE_NODES , f_ , ga ) ; fn = mix ( vec3 ( UNITY_VALUE_NODES ) , mix ( vec3 ( ZERO_VALUE_NODES ) , fn , step ( vec3 ( ZERO_VALUE_NODES ) , fn ) ) , step ( fn , vec3 ( UNITY_VALUE_NODES ) ) ) ; gd = mix ( gc , eu ( fn ) , gb ) ;".split(" ")}]},
{type:"node",name:"INVERT",h:[{type:"node_in",name:"ge",qualifier:["float"],c:!1},{type:"node_in",name:"gf",qualifier:["vec3"],c:!1},{type:"node_out",name:"gg",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"gg = mix ( gf , vec3 ( UNITY_VALUE_NODES ) - gf , ge ) ;".split(" ")}]},{type:"node",name:"LAMP",h:[{type:"node_out",name:"gh",qualifier:["vec3"],c:!0},{type:"node_out",name:"gi",qualifier:["vec3"],c:!1},{type:"node_out",name:"gj",qualifier:["float"],c:!1},{type:"node_out",name:"gk",qualifier:["float"],
c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gh"],f:[{type:"textline",a:"gh = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",a:"fi = u_lamp_light_factors [ LAMP_INDEX ] ; fn = u_lamp_light_directions [ LAMP_INDEX ] ; fo = u_lamp_light_positions [ LAMP_INDEX ] ; fa = fi . z ; if ( fa != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",a:"gi = bC - fo ; gj = length ( gi ) ; gi = normalize ( gi ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_gk"],f:[{type:"textline",a:"gk = fa / ( fa + gj * gj ) ; fa = fi . x ; fb = fi . y ; if ( fa > - UNITY_VALUE_NODES ) { fc = dot ( - gi , fn ) ; fc *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fc - fa ) / fb ) ; gk *= fc ; }".split(" ")}]}]},{type:"textline",a:["}","else","{"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gi"],f:[{type:"textline",a:["gi","=","fn",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gj"],f:[{type:"textline",a:"gj = length ( fo - bC ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gk"],f:[{type:"textline",a:["gk","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",a:["}"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gi"],f:[{type:"textline",a:"gi . yz = vec2 ( - gi . z , gi . y ) ;".split(" ")}]}]}]},{type:"node",name:"NORMAL",h:[{type:"node_in",name:"gl",qualifier:["vec3"],c:!1},{type:"node_out",name:"gm",qualifier:["vec3"],c:!0},{type:"node_out",name:"gn",qualifier:["float"],c:!0},{type:"node_param",name:"eE",
qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gm"],f:[{type:"textline",a:["gm","=","eE",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_gn"],f:[{type:"textline",a:"gn = - dot ( gl , eE ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",h:[{type:"node_in",name:"go",qualifier:["vec3"],c:!1},{type:"node_out",name:"gp",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"gp = - ( eO * vec4 ( go , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",
name:"BSDF_ANISOTROPIC",h:[{type:"node_in",name:"gq",qualifier:["vec3"],c:!1},{type:"node_in",name:"gr",qualifier:["float"],c:!1},{type:"node_in",name:"gs",qualifier:["float"],c:!1},{type:"node_in",name:"gt",qualifier:["float"],c:!1},{type:"node_in",name:"gu",qualifier:["vec3"],c:!1},{type:"node_in",name:"gv",qualifier:["vec3"],c:!1},{type:"node_out",name:"gw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gw","=","gq",";"]},{type:"textline",a:"gr ; gs ; gt ; gu ; gv ;".split(" ")}]},{type:"node",
name:"BSDF_DIFFUSE",h:[{type:"node_in",name:"gx",qualifier:["vec3"],c:!1},{type:"node_in",name:"gy",qualifier:["float"],c:!1},{type:"node_in",name:"gz",qualifier:["vec3"],c:!1},{type:"node_out",name:"gA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gA","=","gx",";"]},{type:"textline",a:["gy",";","gz",";"]}]},{type:"node",name:"BSDF_GLASS",h:[{type:"node_in",name:"gB",qualifier:["vec3"],c:!1},{type:"node_in",name:"gC",qualifier:["float"],c:!1},{type:"node_in",name:"gD",qualifier:["float"],c:!1},
{type:"node_in",name:"gE",qualifier:["vec3"],c:!1},{type:"node_out",name:"gF",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gF","=","gB",";"]},{type:"textline",a:"gC ; gD ; gE ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",h:[{type:"node_in",name:"gG",qualifier:["vec3"],c:!1},{type:"node_in",name:"gH",qualifier:["float"],c:!1},{type:"node_in",name:"gI",qualifier:["vec3"],c:!1},{type:"node_out",name:"gJ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gJ","=","gG",";"]},{type:"textline",a:["gH",
";","gI",";"]}]},{type:"node",name:"BSDF_HAIR",h:[{type:"node_in",name:"gK",qualifier:["vec3"],c:!1},{type:"node_in",name:"gL",qualifier:["float"],c:!1},{type:"node_in",name:"gM",qualifier:["float"],c:!1},{type:"node_in",name:"gN",qualifier:["float"],c:!1},{type:"node_out",name:"gO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gO","=","gK",";"]},{type:"textline",a:"gL ; gM ; gN ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",h:[{type:"node_in",name:"gP",qualifier:["vec3"],c:!1},{type:"node_out",
name:"gQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gQ","=","gP",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",h:[{type:"node_in",name:"gR",qualifier:["vec3"],c:!1},{type:"node_in",name:"gS",qualifier:["vec3"],c:!1},{type:"node_out",name:"gT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["gT","=","gR",";"]},{type:"textline",a:["gS",";"]}]},{type:"node",name:"BSDF_REFRACTION",h:[{type:"node_in",name:"gU",qualifier:["vec3"],c:!1},{type:"node_in",name:"gV",qualifier:["float"],c:!1},{type:"node_in",
name:"gW",qualifier:["float"],c:!1},{type:"node_in",name:"gX",qualifier:["vec3"],c:!1},{type:"node_out",name:"gY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"gY [ 0 ] = gY [ 1 ] = gY [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"gU ; gV ; gW ; gX ;".split(" ")}]},{type:"node",name:"BSDF_TOON",h:[{type:"node_in",name:"gZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"g_",qualifier:["float"],c:!1},{type:"node_in",name:"ha",qualifier:["float"],c:!1},{type:"node_in",name:"hb",qualifier:["vec3"],
c:!1},{type:"node_out",name:"hc",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hc","=","gZ",";"]},{type:"textline",a:"g_ ; ha ; hb ;".split(" ")}]},{type:"node",name:"BSDF_VELVET",h:[{type:"node_in",name:"hd",qualifier:["vec3"],c:!1},{type:"node_in",name:"he",qualifier:["float"],c:!1},{type:"node_in",name:"hf",qualifier:["vec3"],c:!1},{type:"node_out",name:"hg",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hg","=","hd",";"]},{type:"textline",a:["he",";","hf",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",
h:[{type:"node_in",name:"hh",qualifier:["vec3"],c:!1},{type:"node_in",name:"hi",qualifier:["float"],c:!1},{type:"node_in",name:"hj",qualifier:["vec3"],c:!1},{type:"node_in",name:"hk",qualifier:["float"],c:!1},{type:"node_in",name:"hl",qualifier:["float"],c:!1},{type:"node_in",name:"hm",qualifier:["vec3"],c:!1},{type:"node_out",name:"hn",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hn [ 0 ] = hn [ 1 ] = hn [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"hh ; hj ; hk ; hl ; hm ; hi ;".split(" ")}]},
{type:"node",name:"EMISSION",h:[{type:"node_in",name:"ho",qualifier:["vec3"],c:!1},{type:"node_in",name:"hp",qualifier:["float"],c:!1},{type:"node_out",name:"hq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hq","=","ho",";"]},{type:"textline",a:["hp",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",h:[{type:"node_in",name:"hr",qualifier:["vec3"],c:!1},{type:"node_out",name:"hs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hs [ 0 ] = hs [ 1 ] = hs [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",
a:["hr",";"]}]},{type:"node",name:"HOLDOUT",h:[{type:"node_out",name:"ht",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ht [ 0 ] = ht [ 1 ] = ht [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",h:[{type:"node_in",name:"hu",qualifier:["vec3"],c:!1},{type:"node_in",name:"hv",qualifier:["float"],c:!1},{type:"node_out",name:"hw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hw [ 0 ] = hw [ 1 ] = hw [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hu",";",
"hv",";"]}]},{type:"node",name:"VOLUME_SCATTER",h:[{type:"node_in",name:"hx",qualifier:["vec3"],c:!1},{type:"node_in",name:"hy",qualifier:["float"],c:!1},{type:"node_in",name:"hz",qualifier:["float"],c:!1},{type:"node_out",name:"hA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hA [ 0 ] = hA [ 1 ] = hA [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"hx ; hy ; hz ;".split(" ")}]},{type:"node",name:"BUMP",h:[{type:"node_in",name:"hB",qualifier:["float"],c:!1},{type:"node_in",name:"hC",
qualifier:["float"],c:!1},{type:"node_in",name:"hD",qualifier:["float"],c:!1},{type:"node_in",name:"hE",qualifier:["vec3"],c:!1},{type:"node_out",name:"hF",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hF","=","hE",";"]},{type:"textline",a:"hB ; hC ; hD ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",h:[{type:"node_in",name:"hG",qualifier:["float"],c:!1},{type:"node_in",name:"hH",qualifier:["vec3"],c:!1},{type:"node_out",name:"hI",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["hI","=","hH",
";"]},{type:"textline",a:["hG",";"]}]},{type:"node",name:"VECT_TRANSFORM",h:[{type:"node_in",name:"hJ",qualifier:["vec3"],c:!1},{type:"node_out",name:"hK",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{type:"equal_expr",e:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{type:"equal_expr",e:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],f:[{type:"textline",a:["hK","=","hJ",";"]}]},{type:"node_else",
f:[{type:"node_condition",b:[{type:"node_if",d:["VECTOR_TYPE","VT_POINT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"fi = vec4 ( hJ , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"fi = vec4 ( hJ , ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eO * fi ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{type:"equal_expr",
e:2}],f:[{type:"textline",a:"hK = ( eR * fi ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eQ * fi ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eO * eQ * fi ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eP * fi ) . xyz ;".split(" ")}]},
{type:"node_elif",d:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = ( eR * eP * fi ) . xyz ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["VECTOR_TYPE","VT_NORMAL",{type:"equal_expr",e:2}],f:[{type:"textline",a:"hK = normalize ( hK ) ;".split(" ")}]}]}]}]}]},{type:"node",name:"BLACKBODY",h:[{type:"node_in",name:"hL",qualifier:["float"],c:!1},{type:"node_out",name:"hM",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hM [ 0 ] = hM [ 1 ] = hM [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["hL",";"]}]},{type:"node",name:"WAVELENGTH",h:[{type:"node_in",name:"hN",qualifier:["float"],c:!1},{type:"node_out",name:"hO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hO [ 0 ] = hO [ 1 ] = hO [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["hN",";"]}]},{type:"node",name:"SEPXYZ",h:[{type:"node_in",name:"hP",qualifier:["vec3"],c:!1},{type:"node_out",name:"hQ",qualifier:["float"],c:!1},{type:"node_out",name:"hR",qualifier:["float"],c:!1},{type:"node_out",name:"hS",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"hQ = hP [ 0 ] ; hR = hP [ 1 ] ; hS = hP [ 2 ] ;".split(" ")}]},{type:"node",name:"COMBXYZ",h:[{type:"node_in",name:"hT",qualifier:["float"],c:!1},{type:"node_in",name:"hU",qualifier:["float"],c:!1},{type:"node_in",name:"hV",qualifier:["float"],c:!1},{type:"node_out",name:"hW",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"hW [ 0 ] = hT ; hW [ 1 ] = hU ; hW [ 2 ] = hV ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",h:[{type:"node_in",name:"hX",
qualifier:["vec3"],c:!1},{type:"node_in",name:"hY",qualifier:["float"],c:!1},{type:"node_in",name:"hZ",qualifier:["float"],c:!1},{type:"node_out",name:"h_",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fc = hY - hZ * eh ; h_ = max ( ( UNITY_VALUE_NODES + hZ ) * hX + fc , vec3 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",h:[{type:"node_in",name:"ia",qualifier:["float"],c:!1},{type:"node_in",name:"ib",qualifier:["float"],c:!1},{type:"node_out",name:"ic",qualifier:["float"],
c:!1},{type:"node_out",name:"id",qualifier:["float"],c:!1},{type:"node_out",name:"ie",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ic = id = ie = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["ia",";","ib",";"]}]},{type:"node",name:"TEX_IMAGE",h:[{type:"node_in",name:"ig",qualifier:["vec3"],c:!1},{type:"node_out",name:"ih",qualifier:["vec3"],c:!1},{type:"node_out",name:"ii",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ih [ 0 ] = ih [ 1 ] = ih [ 2 ] = ZERO_VALUE_NODES ; ii = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:["ig",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",h:[{type:"node_in",name:"ij",qualifier:["vec3"],c:!1},{type:"node_out",name:"ik",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ik [ 0 ] = ik [ 1 ] = ik [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["ij",";"]}]},{type:"node",name:"TEX_SKY",h:[{type:"node_in",name:"il",qualifier:["vec3"],c:!1},{type:"node_out",name:"im",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"im [ 0 ] = im [ 1 ] = im [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["il",";"]}]},{type:"node",name:"TEX_NOISE",h:[{type:"node_in",name:"io",qualifier:["vec3"],c:!1},{type:"node_in",name:"ip",qualifier:["float"],c:!1},{type:"node_in",name:"iq",qualifier:["float"],c:!1},{type:"node_in",name:"ir",qualifier:["float"],c:!1},{type:"node_out",name:"is",qualifier:["vec3"],c:!1},{type:"node_out",name:"it",qualifier:["float"],c:!1}],f:[{type:"textline",a:"is [ 0 ] = is [ 1 ] = is [ 2 ] = ZERO_VALUE_NODES ; it = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
a:"io ; ip ; iq ; ir ;".split(" ")}]},{type:"node",name:"TEX_WAVE",h:[{type:"node_in",name:"iu",qualifier:["vec3"],c:!1},{type:"node_in",name:"iv",qualifier:["float"],c:!1},{type:"node_in",name:"iw",qualifier:["float"],c:!1},{type:"node_in",name:"ix",qualifier:["float"],c:!1},{type:"node_in",name:"iy",qualifier:["float"],c:!1},{type:"node_out",name:"iz",qualifier:["vec3"],c:!1},{type:"node_out",name:"iA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iz [ 0 ] = iz [ 1 ] = iz [ 2 ] = ZERO_VALUE_NODES ; iA = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"iu ; iv ; iw ; ix ; iy ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",h:[{type:"node_in",name:"iB",qualifier:["vec3"],c:!1},{type:"node_in",name:"iC",qualifier:["float"],c:!1},{type:"node_out",name:"iD",qualifier:["vec3"],c:!1},{type:"node_out",name:"iE",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iD [ 0 ] = iD [ 1 ] = iD [ 2 ] = ZERO_VALUE_NODES ; iE = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["iB",";","iC",";"]}]},{type:"node",name:"TEX_MUSGRAVE",h:[{type:"node_in",
name:"iF",qualifier:["vec3"],c:!1},{type:"node_in",name:"iG",qualifier:["float"],c:!1},{type:"node_in",name:"iH",qualifier:["float"],c:!1},{type:"node_in",name:"iI",qualifier:["float"],c:!1},{type:"node_in",name:"iJ",qualifier:["float"],c:!1},{type:"node_in",name:"iK",qualifier:["float"],c:!1},{type:"node_in",name:"iL",qualifier:["float"],c:!1},{type:"node_out",name:"iM",qualifier:["vec3"],c:!1},{type:"node_out",name:"iN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iM [ 0 ] = iM [ 1 ] = iM [ 2 ] = ZERO_VALUE_NODES ; iN = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"iF ; iG ; iH ; iI ; iJ ; iK ; iL ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",h:[{type:"node_in",name:"iO",qualifier:["vec3"],c:!1},{type:"node_out",name:"iP",qualifier:["vec3"],c:!1},{type:"node_out",name:"iQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iP [ 0 ] = iP [ 1 ] = iP [ 2 ] = ZERO_VALUE_NODES ; iQ = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["iO",";"]}]},{type:"node",name:"TEX_MAGIC",h:[{type:"node_in",name:"iR",qualifier:["vec3"],c:!1},{type:"node_in",
name:"iS",qualifier:["float"],c:!1},{type:"node_in",name:"iT",qualifier:["float"],c:!1},{type:"node_out",name:"iU",qualifier:["vec3"],c:!1},{type:"node_out",name:"iV",qualifier:["float"],c:!1}],f:[{type:"textline",a:"iU [ 0 ] = iU [ 1 ] = iU [ 2 ] = ZERO_VALUE_NODES ; iV = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"iR ; iS ; iT ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",h:[{type:"node_in",name:"iW",qualifier:["vec3"],c:!1},{type:"node_in",name:"iX",qualifier:["vec3"],c:!1},{type:"node_in",
name:"iY",qualifier:["vec3"],c:!1},{type:"node_in",name:"iZ",qualifier:["float"],c:!1},{type:"node_out",name:"i_",qualifier:["vec3"],c:!1},{type:"node_out",name:"ja",qualifier:["float"],c:!1}],f:[{type:"textline",a:"i_ [ 0 ] = i_ [ 1 ] = i_ [ 2 ] = ZERO_VALUE_NODES ; ja = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"iW ; iX ; iY ; iZ ;".split(" ")}]},{type:"node",name:"TEX_BRICK",h:[{type:"node_in",name:"jb",qualifier:["vec3"],c:!1},{type:"node_in",name:"jc",qualifier:["vec3"],c:!1},{type:"node_in",
name:"jd",qualifier:["vec3"],c:!1},{type:"node_in",name:"je",qualifier:["vec3"],c:!1},{type:"node_in",name:"jf",qualifier:["float"],c:!1},{type:"node_in",name:"jg",qualifier:["float"],c:!1},{type:"node_in",name:"jh",qualifier:["float"],c:!1},{type:"node_in",name:"ji",qualifier:["float"],c:!1},{type:"node_in",name:"jj",qualifier:["float"],c:!1},{type:"node_out",name:"jk",qualifier:["vec3"],c:!1},{type:"node_out",name:"jl",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jk [ 0 ] = jk [ 1 ] = jk [ 2 ] = ZERO_VALUE_NODES ; jl = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"jb ; jc ; jd ; je ; jf ; jg ; jh ; ji ; jj ;".split(" ")}]},{type:"node",name:"ADD_SHADER",h:[{type:"node_in",name:"jm",qualifier:["vec3"],c:!1},{type:"node_in",name:"jn",qualifier:["vec3"],c:!1},{type:"node_out",name:"jo",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jo = clamp ( jm + jn , vec3 ( ZERO_VALUE_NODES ) , vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",h:[{type:"node_in",name:"jp",qualifier:["float"],c:!1},{type:"node_in",name:"jq",
qualifier:["vec3"],c:!1},{type:"node_in",name:"jr",qualifier:["vec3"],c:!1},{type:"node_out",name:"js",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fc = clamp ( jp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; js = fc * jq + ( UNITY_VALUE_NODES - fc ) * jr ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[{type:"node_out",name:"jt",qualifier:["vec3"],c:!1},{type:"node_out",name:"ju",qualifier:["vec3"],c:!1},{type:"node_param",name:"eF",qualifier:["varying","vec2"],c:!1}],f:[{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_jt"],f:[{type:"textline",a:"jt = ew ( eF ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_ju"],f:[{type:"textline",a:"ju = vec3 ( eF , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_out",name:"jv",qualifier:["vec3"],c:!1},{type:"node_param",name:"eG",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"jv = vec3 ( eG , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",h:[{type:"node_out",
name:"jw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["jw","=","fm",";"]}]},{type:"node",name:"TEX_COORD_GE",h:[{type:"node_out",name:"jx",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["jx","=","eg",";"]}]},{type:"node",name:"TEX_COORD_OB",h:[{type:"node_out",name:"jy",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jy [ 0 ] = jy [ 1 ] = jy [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",h:[{type:"node_out",name:"jz",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"jz [ 0 ] = fh [ 0 ] ; jz [ 1 ] = fh [ 1 ] ; jz [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_WI",h:[{type:"node_out",name:"jA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jA [ 0 ] = jA [ 1 ] = jA [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",h:[{type:"node_out",name:"jB",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jB [ 0 ] = jB [ 1 ] = jB [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",h:[{type:"node_out",name:"jC",
qualifier:["vec3"],c:!1},{type:"node_param",name:"eH",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:"jC = vec3 ( eH , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",h:[{type:"node_out",name:"jD",qualifier:["float"],c:!1},{type:"node_out",name:"jE",qualifier:["float"],c:!1},{type:"node_out",name:"jF",qualifier:["float"],c:!1},{type:"node_out",name:"jG",qualifier:["vec3"],c:!1},{type:"node_out",name:"jH",qualifier:["float"],c:!1},{type:"node_out",name:"jI",qualifier:["vec3"],
c:!1},{type:"node_out",name:"jJ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jD = ZERO_VALUE_NODES ; jE = ZERO_VALUE_NODES ; jF = ZERO_VALUE_NODES ; jG = vec3 ( ZERO_VALUE_NODES ) ; jH = ZERO_VALUE_NODES ; jI = jG ; jJ = jG ;".split(" ")}]},{type:"node",name:"HAIR_INFO",h:[{type:"node_out",name:"jK",qualifier:["float"],c:!1},{type:"node_out",name:"jL",qualifier:["float"],c:!1},{type:"node_out",name:"jM",qualifier:["float"],c:!1},{type:"node_out",name:"jN",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"jK = ZERO_VALUE_NODES ; jL = ZERO_VALUE_NODES ; jM = ZERO_VALUE_NODES ; jN = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"OBJECT_INFO",h:[{type:"node_out",name:"jO",qualifier:["vec3"],c:!1},{type:"node_out",name:"jP",qualifier:["float"],c:!1},{type:"node_out",name:"jQ",qualifier:["float"],c:!1},{type:"node_out",name:"jR",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jP = ZERO_VALUE_NODES ; jQ = ZERO_VALUE_NODES ; jR = ZERO_VALUE_NODES ; jO = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"WIREFRAME",h:[{type:"node_in",name:"jS",qualifier:["float"],c:!1},{type:"node_out",name:"jT",qualifier:["float"],c:!1}],f:[{type:"textline",a:["jT","=","jS",";"]}]},{type:"node",name:"TANGENT",h:[{type:"node_out",name:"jU",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"jU = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",h:[{type:"node_in",name:"jV",qualifier:["float"],c:!1},{type:"node_in",name:"jW",qualifier:["vec3"],c:!1},{type:"node_out",name:"jX",
qualifier:["float"],c:!1},{type:"node_out",name:"jY",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jX = jY = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["jW",";","jV",";"]}]},{type:"node",name:"LIGHT_PATH",h:[{type:"node_out",name:"jZ",qualifier:["float"],c:!1},{type:"node_out",name:"j_",qualifier:["float"],c:!1},{type:"node_out",name:"ka",qualifier:["float"],c:!1},{type:"node_out",name:"kb",qualifier:["float"],c:!1},{type:"node_out",name:"kc",qualifier:["float"],c:!1},{type:"node_out",
name:"kd",qualifier:["float"],c:!1},{type:"node_out",name:"ke",qualifier:["float"],c:!1},{type:"node_out",name:"kf",qualifier:["float"],c:!1},{type:"node_out",name:"kg",qualifier:["float"],c:!1},{type:"node_out",name:"kh",qualifier:["float"],c:!1}],f:[{type:"textline",a:"jZ = j_ = ka = ZERO_VALUE_NODES ; kb = kc = kd = ZERO_VALUE_NODES ; ke = ke = kg = kh = ZERO_VALUE_NODES ; kf = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",h:[{type:"node_out",name:"ki",qualifier:["vec3"],c:!1},
{type:"node_out",name:"kj",qualifier:["vec3"],c:!1},{type:"node_out",name:"kk",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ki = kj = vec3 ( ZERO_VALUE_NODES ) ; kk = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"SCRIPT",h:[],f:[]},{type:"node",name:"CURVE_VEC",h:[{type:"node_in",name:"kl",qualifier:["float"],c:!1},{type:"node_in",name:"km",qualifier:["vec3"],c:!1},{type:"node_out",name:"kn",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["kn","=","km",";"]},{type:"node_condition",b:[{type:"node_if",
d:["READ_R"],f:[{type:"textline",a:"kn . r = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * km . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"kn . g = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * km . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"kn . b = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * km . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},
{type:"textline",a:"kn = mix ( km , kn , kl ) ;".split(" ")}]},{type:"node",name:"CURVE_RGB",h:[{type:"node_in",name:"ko",qualifier:["float"],c:!1},{type:"node_in",name:"kp",qualifier:["vec3"],c:!1},{type:"node_out",name:"kq",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["READ_A"],f:[{type:"textline",a:"fc = texture2D ( u_nodes_texture , vec2 ( kp . r , NODE_TEX_ROW ) ) . a ; fb = texture2D ( u_nodes_texture , vec2 ( kp . g , NODE_TEX_ROW ) ) . a ; fa = texture2D ( u_nodes_texture , vec2 ( kp . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:"fc = kp . r ; fb = kp . g ; fa = kp . b ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"kq . r = texture2D ( u_nodes_texture , vec2 ( fc , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"kq . r = fc ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"kq . g = texture2D ( u_nodes_texture , vec2 ( fb , NODE_TEX_ROW ) ) . g ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",a:"kq . g = fb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"kq . b = texture2D ( u_nodes_texture , vec2 ( fa , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"kq . b = fa ;".split(" ")}]}]},{type:"textline",a:"kq = mix ( kp , kq , ko ) ;".split(" ")}]},{type:"node",name:"VALTORGB",h:[{type:"node_in",name:"kr",qualifier:["float"],c:!1},{type:"node_out",name:"ks",qualifier:["vec3"],
c:!1},{type:"node_out",name:"kt",qualifier:["float"],c:!1}],f:[{type:"textline",a:"fi = texture2D ( u_nodes_texture , vec2 ( kr , NODE_TEX_ROW ) ) ; ks = fi . rgb ; kt = fi . a ;".split(" ")}]},{type:"node",name:"MAPPING",h:[{type:"node_in",name:"ku",qualifier:["vec3"],c:!1},{type:"node_out",name:"kv",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["kv","=","ku",";"]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",f:[{type:"textline",a:"kv = ( MAPPING_TRS_MATRIX * vec4 ( kv , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_SCALE",f:[{type:"textline",a:"kv = kv * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",f:[{type:"textline",a:"kv = kv + MAPPING_TRANSLATION ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",f:[{type:"textline",a:"kv = max ( kv , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",f:[{type:"textline",
a:"kv = min ( kv , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MAPPING_IS_NORMAL"],f:[{type:"textline",a:"kv = normalize ( kv ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",h:[{type:"node_in",name:"kw",qualifier:["float"],c:!1},{type:"node_in",name:"kx",qualifier:["float"],c:!1},{type:"node_out",name:"ky",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ky = kw + kx ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",
a:"ky = clamp ( ky , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",h:[{type:"node_in",name:"kz",qualifier:["float"],c:!1},{type:"node_in",name:"kA",qualifier:["float"],c:!1},{type:"node_out",name:"kB",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kB = kz - kA ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kB = clamp ( kB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",
name:"MATH_MULTIPLY",h:[{type:"node_in",name:"kC",qualifier:["float"],c:!1},{type:"node_in",name:"kD",qualifier:["float"],c:!1},{type:"node_out",name:"kE",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kE = kC * kD ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kE = clamp ( kE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",h:[{type:"node_in",name:"kF",qualifier:["float"],c:!1},{type:"node_in",name:"kG",
qualifier:["float"],c:!1},{type:"node_out",name:"kH",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kH = ( kG != ZERO_VALUE_NODES ) ? kF / kG : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kH = clamp ( kH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SINE",h:[{type:"node_in",name:"kI",qualifier:["float"],c:!1},{type:"node_in",name:"kJ",qualifier:["float"],c:!1},{type:"node_out",name:"kK",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"kK = sin ( kI ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kK = clamp ( kK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kJ",";"]}]},{type:"node",name:"MATH_COSINE",h:[{type:"node_in",name:"kL",qualifier:["float"],c:!1},{type:"node_in",name:"kM",qualifier:["float"],c:!1},{type:"node_out",name:"kN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kN = cos ( kL ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kN = clamp ( kN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kM",";"]}]},{type:"node",name:"MATH_TANGENT",h:[{type:"node_in",name:"kO",qualifier:["float"],c:!1},{type:"node_in",name:"kP",qualifier:["float"],c:!1},{type:"node_out",name:"kQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kQ = tan ( kO ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],
f:[{type:"textline",a:"kQ = clamp ( kQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kP",";"]}]},{type:"node",name:"MATH_ARCSINE",h:[{type:"node_in",name:"kR",qualifier:["float"],c:!1},{type:"node_in",name:"kS",qualifier:["float"],c:!1},{type:"node_out",name:"kT",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kT = ( kR <= UNITY_VALUE_NODES && kR >= - UNITY_VALUE_NODES ) ? asin ( kR ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kT = clamp ( kT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kS",";"]}]},{type:"node",name:"MATH_ARCCOSINE",h:[{type:"node_in",name:"kU",qualifier:["float"],c:!1},{type:"node_in",name:"kV",qualifier:["float"],c:!1},{type:"node_out",name:"kW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kW = ( kU <= UNITY_VALUE_NODES && kU >= - UNITY_VALUE_NODES ) ? acos ( kU ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"kW = clamp ( kW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kV",";"]}]},{type:"node",name:"MATH_ARCTANGENT",h:[{type:"node_in",name:"kX",qualifier:["float"],c:!1},{type:"node_in",name:"kY",qualifier:["float"],c:!1},{type:"node_out",name:"kZ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"kZ = atan ( kX ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",
a:"kZ = clamp ( kZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["kY",";"]}]},{type:"node",name:"MATH_POWER",h:[{type:"node_in",name:"k_",qualifier:["float"],c:!1},{type:"node_in",name:"la",qualifier:["float"],c:!1},{type:"node_out",name:"lb",qualifier:["float"],c:!1}],f:[{type:"textline",a:"if ( k_ < ZERO_VALUE_NODES && la != floor ( la ) ) lb = ZERO_VALUE_NODES ; else if ( la == ZERO_VALUE_NODES )".split(" ")},{type:"textline",a:"lb = UNITY_VALUE_NODES ; else if ( k_ < ZERO_VALUE_NODES ) lb = mix ( UNITY_VALUE_NODES , - UNITY_VALUE_NODES , sign ( mod ( - la , 2.0 ) ) ) * pow ( - k_ , la ) ; else if ( k_ == ZERO_VALUE_NODES ) lb = ZERO_VALUE_NODES ; else lb = pow ( k_ , la ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lb = clamp ( lb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",h:[{type:"node_in",name:"lc",qualifier:["float"],c:!1},{type:"node_in",name:"ld",qualifier:["float"],c:!1},{type:"node_out",name:"le",qualifier:["float"],c:!1}],f:[{type:"textline",a:"le = ( lc > ZERO_VALUE_NODES && ld > ZERO_VALUE_NODES ) ? log2 ( lc ) / log2 ( ld ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"le = clamp ( le , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",h:[{type:"node_in",name:"lf",qualifier:["float"],c:!1},{type:"node_in",name:"lg",qualifier:["float"],c:!1},{type:"node_out",name:"lh",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lh = min ( lf , lg ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lh = clamp ( lh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",h:[{type:"node_in",name:"li",qualifier:["float"],c:!1},{type:"node_in",name:"lj",qualifier:["float"],c:!1},{type:"node_out",name:"lk",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lk = max ( li , lj ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lk = clamp ( lk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",h:[{type:"node_in",name:"ll",qualifier:["float"],c:!1},
{type:"node_in",name:"lm",qualifier:["float"],c:!1},{type:"node_out",name:"ln",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ln = floor ( ll + eh ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"ln = clamp ( ln , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["lm",";"]}]},{type:"node",name:"MATH_LESS_THAN",h:[{type:"node_in",name:"lo",qualifier:["float"],c:!1},{type:"node_in",name:"lp",qualifier:["float"],c:!1},
{type:"node_out",name:"lq",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lq = ( lo < lp ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lq = clamp ( lq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",h:[{type:"node_in",name:"lr",qualifier:["float"],c:!1},{type:"node_in",name:"ls",qualifier:["float"],c:!1},{type:"node_out",name:"lt",qualifier:["float"],
c:!1}],f:[{type:"textline",a:"lt = ( lr > ls ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lt = clamp ( lt , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",h:[{type:"node_in",name:"lu",qualifier:["float"],c:!1},{type:"node_in",name:"lv",qualifier:["float"],c:!1},{type:"node_out",name:"lw",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lw = abs ( lv ) > 0.000001 ? mod ( lu , lv ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lw = clamp ( lw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",h:[{type:"node_in",name:"lx",qualifier:["float"],c:!1},{type:"node_in",name:"ly",qualifier:["float"],c:!1},{type:"node_out",name:"lz",qualifier:["float"],c:!1}],f:[{type:"textline",a:"lz = abs ( lx ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"lz = clamp ( lz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["ly",";"]}]},{type:"node",name:"MIX_RGB_MIX",h:[{type:"node_in",name:"lA",qualifier:["float"],c:!1},{type:"node_in",name:"lB",qualifier:["vec3"],c:!1},{type:"node_in",name:"lC",qualifier:["vec3"],c:!1},{type:"node_out",name:"lD",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lD = mix ( lB , lC , fa ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lD = clamp ( lD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",h:[{type:"node_in",name:"lE",qualifier:["float"],c:!1},{type:"node_in",name:"lF",qualifier:["vec3"],c:!1},{type:"node_in",name:"lG",qualifier:["vec3"],c:!1},{type:"node_out",name:"lH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lH = mix ( lF , lF + lG , fa ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lH = clamp ( lH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",h:[{type:"node_in",name:"lI",qualifier:["float"],c:!1},{type:"node_in",name:"lJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"lK",qualifier:["vec3"],c:!1},{type:"node_out",name:"lL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lL = mix ( lJ , lJ * lK , fa ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lL = clamp ( lL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",h:[{type:"node_in",name:"lM",qualifier:["float"],c:!1},{type:"node_in",name:"lN",qualifier:["vec3"],c:!1},{type:"node_in",name:"lO",qualifier:["vec3"],c:!1},{type:"node_out",name:"lP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lP = mix ( lN , lN - lO , fa ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lP = clamp ( lP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",h:[{type:"node_in",name:"lQ",qualifier:["float"],c:!1},{type:"node_in",name:"lR",qualifier:["vec3"],c:!1},{type:"node_in",name:"lS",qualifier:["vec3"],c:!1},{type:"node_out",name:"lT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; lT = vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( fb ) + fa * ( vec3 ( UNITY_VALUE_NODES ) - lS ) ) * ( vec3 ( UNITY_VALUE_NODES ) - lR ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lT = clamp ( lT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",h:[{type:"node_in",name:"lU",qualifier:["float"],c:!1},{type:"node_in",name:"lV",qualifier:["vec3"],c:!1},{type:"node_in",name:"lW",qualifier:["vec3"],c:!1},{type:"node_out",name:"lX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; lW += step ( lW , vec3 ( ZERO_VALUE_NODES ) ) ; lX = fb * lV + fa * lV / lW ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"lX = clamp ( lX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",h:[{type:"node_in",name:"lY",qualifier:["float"],c:!1},{type:"node_in",name:"lZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"l_",qualifier:["vec3"],c:!1},{type:"node_out",name:"ma",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( lY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; ma = mix ( lZ , abs ( lZ - l_ ) , fa ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"ma = clamp ( ma , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",h:[{type:"node_in",name:"mb",qualifier:["float"],c:!1},{type:"node_in",name:"mc",qualifier:["vec3"],c:!1},{type:"node_in",name:"md",qualifier:["vec3"],c:!1},{type:"node_out",name:"me",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; me = min ( mc . rgb , md . rgb * fa ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"me = clamp ( me , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",h:[{type:"node_in",name:"mf",qualifier:["float"],c:!1},{type:"node_in",name:"mg",qualifier:["vec3"],c:!1},{type:"node_in",name:"mh",qualifier:["vec3"],c:!1},{type:"node_out",name:"mi",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mi = max ( mg . rgb , mh . rgb * fa ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mi = clamp ( mi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",h:[{type:"node_in",name:"mj",qualifier:["float"],c:!1},{type:"node_in",name:"mk",qualifier:["vec3"],c:!1},{type:"node_in",name:"ml",qualifier:["vec3"],c:!1},{type:"node_out",name:"mm",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fo = vec3 ( UNITY_VALUE_NODES - fa ) ; mm = mix ( mk * ( fo + 2.0 * fa * ml ) , vec3 ( UNITY_VALUE_NODES ) - ( fo + 2.0 * fa * ( vec3 ( UNITY_VALUE_NODES ) - ml ) ) * ( vec3 ( UNITY_VALUE_NODES ) - mk ) , step ( eh , mk ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mm = clamp ( mm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",h:[{type:"node_in",name:"mn",qualifier:["float"],c:!1},{type:"node_in",name:"mo",qualifier:["vec3"],c:!1},{type:"node_in",name:"mp",qualifier:["vec3"],c:!1},{type:"node_out",name:"mq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fo = vec3 ( UNITY_VALUE_NODES ) - fa * mp ; fn = clamp ( mo / fo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mq = mix ( mix ( fn , vec3 ( UNITY_VALUE_NODES ) , step ( fo , vec3 ( ZERO_VALUE_NODES ) ) ) , mo , step ( mo , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mq = clamp ( mq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",h:[{type:"node_in",name:"mr",qualifier:["float"],c:!1},{type:"node_in",name:"ms",qualifier:["vec3"],c:!1},{type:"node_in",name:"mt",qualifier:["vec3"],c:!1},{type:"node_out",name:"mu",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fo = vec3 ( UNITY_VALUE_NODES - fa ) ; fo = fo + fa * mt ; fn = clamp ( vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( UNITY_VALUE_NODES ) - ms ) / fo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mu = mix ( fn , vec3 ( ZERO_VALUE_NODES ) , step ( fo , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mu = clamp ( mu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",h:[{type:"node_in",name:"mv",qualifier:["float"],c:!1},{type:"node_in",name:"mw",qualifier:["vec3"],c:!1},{type:"node_in",name:"mx",qualifier:["vec3"],c:!1},{type:"node_out",name:"my",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; my = mw ; fn = eq ( mx ) ; if ( fn . y != ZERO_VALUE_NODES ) { fo = eq ( my ) ; fo . x = fn . x ; fp = eu ( fo ) ; my = mix ( my , fp , fa ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"my = clamp ( my , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",h:[{type:"node_in",name:"mz",qualifier:["float"],c:!1},{type:"node_in",name:"mA",qualifier:["vec3"],c:!1},{type:"node_in",name:"mB",qualifier:["vec3"],c:!1},{type:"node_out",name:"mC",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; mC = mA ; fp = eq ( mC ) ; if ( fp . y != ZERO_VALUE_NODES ) { fo = eq ( mB ) ; fp . y = fb * fp . y + fa * fo . y ; mC = eu ( fp ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mC = clamp ( mC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",h:[{type:"node_in",name:"mD",qualifier:["float"],c:!1},{type:"node_in",name:"mE",qualifier:["vec3"],c:!1},{type:"node_in",name:"mF",qualifier:["vec3"],c:!1},{type:"node_out",name:"mG",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; fp = eq ( mE ) ; fo = eq ( mF ) ; fp . z = fb * fp . z + fa * fo . z ; mG = eu ( fp ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mG = clamp ( mG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",h:[{type:"node_in",name:"mH",qualifier:["float"],c:!1},{type:"node_in",name:"mI",qualifier:["vec3"],c:!1},{type:"node_in",name:"mJ",qualifier:["vec3"],c:!1},{type:"node_out",name:"mK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mK = mI ; fo = eq ( mJ ) ; if ( fo . y != ZERO_VALUE_NODES ) { fp = eq ( mK ) ; fp . x = fo . x ; fp . y = fo . y ; fn = eu ( fp ) ; mK = mix ( mK , fn , fa ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mK = clamp ( mK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",h:[{type:"node_in",name:"mL",qualifier:["float"],c:!1},{type:"node_in",name:"mM",qualifier:["vec3"],c:!1},{type:"node_in",name:"mN",qualifier:["vec3"],c:!1},{type:"node_out",name:"mO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = UNITY_VALUE_NODES - fa ; fn = mN + mM - mN * mM ; mO = mM * ( vec3 ( fb ) + vec3 ( fa ) * ( ( vec3 ( UNITY_VALUE_NODES ) - mM ) * mN + fn ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mO = clamp ( mO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",h:[{type:"node_in",name:"mP",qualifier:["float"],c:!1},{type:"node_in",name:"mQ",qualifier:["vec3"],c:!1},{type:"node_in",name:"mR",qualifier:["vec3"],c:!1},{type:"node_out",name:"mS",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fa = clamp ( mP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mS = mQ + fa * ( 2.0 * mR - vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"mS = clamp ( mS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",h:[{type:"node_in",name:"mT",qualifier:["vec3"],c:!1},{type:"node_in",name:"mU",qualifier:["float"],c:!1}],f:[{type:"textline",a:"eS = mT ; eW = mU ;".split(" ")}]},{type:"node",name:"MATERIAL_BEGIN",h:[{type:"node_in",name:"mV",qualifier:["vec3"],c:!1},{type:"node_in",name:"mW",qualifier:["vec3"],c:!1},{type:"node_in",
name:"mX",qualifier:["float"],c:!1},{type:"node_in",name:"mY",qualifier:["vec3"],c:!0},{type:"node_in",name:"mZ",qualifier:["float"],c:!0},{type:"node_out",name:"m_",qualifier:["vec3"],c:!1},{type:"node_out",name:"na",qualifier:["vec3"],c:!1},{type:"node_out",name:"nb",qualifier:["vec3"],c:!1},{type:"node_out",name:"nc",qualifier:["vec3"],c:!1},{type:"node_out",name:"nd",qualifier:["vec3"],c:!1},{type:"node_out",name:"ne",qualifier:["vec2"],c:!1},{type:"node_out",name:"nf",qualifier:["vec2"],c:!1},
{type:"node_out",name:"ng",qualifier:["vec4"],c:!1},{type:"node_param",name:"eI",qualifier:["const","vec2"],c:!1},{type:"node_param",name:"eJ",qualifier:["const","vec3"],c:!1}],f:[{type:"textline",a:"nb = clamp ( mV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"nc = eJ [ 0 ] * clamp ( mW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_NORMAL"],f:[{type:"textline",a:"nd = normalize ( mY ) ;".split(" ")},
{type:"textline",a:"nd . yz = vec2 ( nd . z , - nd . y ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:["nd","=","fm",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["SHADELESS_MAT",{type:"logic_negative_expr",e:1}],f:[{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"textline",a:"m_ = mZ * nb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"m_ = eZ * nb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",
a:["nb","*=","mX",";"]}]}]},{type:"textline",a:"na = e_ * u_environment_energy * dS ( nd ) ; ng = du ( nb ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],f:[{type:"textline",a:"ne = vec2 ( eI [ 0 ] , eI [ 1 ] ) ;".split(" ")},{type:"textline",a:"nf = vec2 ( eJ [ 1 ] , eJ [ 2 ] ) ;".split(" ")}]}]},{type:"textline",a:["eV","=","ng",";"]}]},{type:"node_else",f:[{type:"textline",a:"m_ = vec3 ( ZERO_VALUE_NODES ) ; na = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATERIAL_END",h:[{type:"node_in",name:"nh",qualifier:["vec4"],c:!1},{type:"node_in",name:"ni",qualifier:["vec3"],c:!1},{type:"node_in",name:"nj",qualifier:["vec3"],c:!1},{type:"node_in",name:"nk",qualifier:["float"],c:!0},{type:"node_in",name:"nl",qualifier:["float"],c:!0},{type:"node_in",name:"nm",qualifier:["float"],c:!0},{type:"node_out",name:"nn",qualifier:["vec3"],c:!0},{type:"node_out",name:"no",qualifier:["float"],c:!0},{type:"node_out",name:"np",qualifier:["vec3"],c:!0},
{type:"node_out",name:"nq",qualifier:["vec3"],c:!0},{type:"node_out",name:"nr",qualifier:["vec3"],c:!0},{type:"node_param",name:"eK",qualifier:["float"],c:!1},{type:"node_param",name:"eL",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nn"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",a:"nn = nh . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"nn = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{type:"non_equal_expr",e:2},{type:"logical_and_expr",e:2}],f:[{type:"node_condition",b:[{type:"node_if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],f:[{type:"textline",a:"dP ( nn , eM , nj , nk , eN ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"dP ( nn , eM , nj , nk , mat4 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",
a:["nn","+=","ni",";"]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_np"],f:[{type:"textline",a:["np","=","nj",";"]},{type:"textline",a:"np . yz = vec2 ( - np . z , np . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nq"],f:[{type:"textline",a:"nq = nh . rgb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_nr"],f:[{type:"textline",a:["nr","=","ni",";"]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_no"],f:[{type:"textline",a:"no = clamp ( nm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"fa = max ( max ( ni . r , ni . g ) , ni . b ) * nl ; no = clamp ( nm * ( UNITY_VALUE_NODES - fa ) + fa , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},{type:"node_else",f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_no"],f:[{type:"textline",a:"no = clamp ( eK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"fa = max ( max ( ni . r , ni . g ) , ni . b ) * eL ; no = eK * ( UNITY_VALUE_NODES - fa ) + fa ;".split(" ")}]}]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["eT","=","ni",";"]}]},{type:"node_else",f:[{type:"textline",a:"eT = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["eU","=","nj",";"]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",
name:"ns",qualifier:["vec3"],c:!1},{type:"node_in",name:"nt",qualifier:["vec3"],c:!1},{type:"node_in",name:"nu",qualifier:["vec3"],c:!1},{type:"node_out",name:"nv",qualifier:["vec4"],c:!1},{type:"node_out",name:"nw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"nv = vec4 ( ns + nu * nt , ZERO_VALUE_NODES ) ; nw = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"nx",qualifier:["vec4"],c:!1},{type:"node_out",name:"ny",qualifier:["vec3"],c:!1},
{type:"node_out",name:"nz",qualifier:["vec2"],c:!1},{type:"node_out",name:"nA",qualifier:["vec3"],c:!1},{type:"node_out",name:"nB",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nz = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",a:["nB","=","eh",";"]}]},{type:"node_else",f:[{type:"textline",a:["nB","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"nA = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",e:2}],f:[{type:"textline",a:"nA *= nx [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"fn = u_light_positions [ LAMP_IND ] ; ny = fn - fl ;".split(" ")},{type:"textline",a:"fa = length ( ny ) ; nA *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + fa * fa ) ; ny = normalize ( ny ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"fn = u_light_directions [ LAMP_IND ] ; fa = dot ( ny , fn ) ; fa *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fa - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; nA *= fa ;".split(" ")}]}]}]},{type:"node_else",f:[{type:"textline",a:"ny = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"nC",qualifier:["vec3"],c:!1},{type:"node_in",
name:"nD",qualifier:["vec2"],c:!1},{type:"node_in",name:"nE",qualifier:["vec3"],c:!1},{type:"node_in",name:"nF",qualifier:["float"],c:!1},{type:"node_in",name:"nG",qualifier:["vec2"],c:!1},{type:"node_out",name:"nH",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nH = ZERO_VALUE_NODES ; if ( nD . r != ZERO_VALUE_NODES ) { fa = ( UNITY_VALUE_NODES - nF ) * dot ( nE , nC ) + nF ; if ( nG [ 0 ] == ZERO_VALUE_NODES ) { nH = UNITY_VALUE_NODES ; } else { fa = UNITY_VALUE_NODES + abs ( fa ) ; fa = nG [ 1 ] + ( UNITY_VALUE_NODES - nG [ 1 ] ) * pow ( fa , nG [ 0 ] ) ; nH = clamp ( fa , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } nH = max ( nH , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"nI",qualifier:["vec3"],c:!1},{type:"node_in",name:"nJ",qualifier:["vec2"],c:!1},{type:"node_in",name:"nK",qualifier:["vec3"],c:!1},{type:"node_in",name:"nL",qualifier:["float"],c:!1},{type:"node_out",name:"nM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nM = ZERO_VALUE_NODES ; if ( nJ . r != ZERO_VALUE_NODES ) { fa = ( UNITY_VALUE_NODES - nL ) * dot ( nK , nI ) + nL ; nM = max ( fa , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"nN",qualifier:["vec3"],c:!1},{type:"node_in",name:"nO",qualifier:["vec2"],c:!1},{type:"node_in",name:"nP",qualifier:["vec3"],c:!1},{type:"node_in",name:"nQ",qualifier:["float"],c:!1},{type:"node_in",name:"nR",qualifier:["vec2"],c:!1},{type:"node_out",name:"nS",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nS = ZERO_VALUE_NODES ; if ( nO . r != ZERO_VALUE_NODES ) { fa = ( UNITY_VALUE_NODES - nQ ) * dot ( nP , nN ) + nQ ; if ( nR [ 0 ] > ZERO_VALUE_NODES ) { fb = max ( dot ( nP , eM ) , ZERO_VALUE_NODES ) ; fc = nR [ 0 ] * nR [ 0 ] ; fd = UNITY_VALUE_NODES - eh * ( fc / ( fc + 0.33 ) ) ; fn = nN - fa * nP ; fp = eM - fb * nP ;".split(" ")},
{type:"textline",a:"if ( length ( fn ) == ZERO_VALUE_NODES || length ( fp ) == ZERO_VALUE_NODES || abs ( fa ) > UNITY_VALUE_NODES || abs ( fb ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"nS = fa * fd ; else { fe = acos ( fa ) ; fb = acos ( fb ) ; fn = normalize ( fn ) ; fp = normalize ( fp ) ; ff = max ( fe , fb ) ; fg = min ( fe , fb ) ; fg *= 0.95 ; fb = max ( dot ( fn , fp ) , ZERO_VALUE_NODES ) ; fc = 0.45 * ( fc / ( fc + 0.09 ) ) ; nS = fa * ( fd + ( fc * fb * sin ( ff ) * tan ( fg ) ) ) ; } } else nS = fa ; nS = max ( nS , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"nT",qualifier:["vec3"],c:!1},{type:"node_in",name:"nU",qualifier:["vec2"],c:!1},{type:"node_in",name:"nV",qualifier:["vec3"],c:!1},{type:"node_in",name:"nW",qualifier:["float"],c:!1},{type:"node_in",name:"nX",qualifier:["vec2"],c:!1},{type:"node_out",name:"nY",qualifier:["float"],c:!1}],f:[{type:"textline",a:"nY = ZERO_VALUE_NODES ; if ( nU . r != ZERO_VALUE_NODES ) { fa = ( UNITY_VALUE_NODES - nW ) * dot ( nV , nT ) + nW ; fg = max ( dot ( nV , eM ) , ZERO_VALUE_NODES ) ; if ( nX [ 0 ] <= UNITY_VALUE_NODES ) nY = fa * pow ( max ( fg * fa , 0.1 ) , nX [ 0 ] - UNITY_VALUE_NODES ) ; else nY = fa * pow ( 1.0001 - fg , nX [ 0 ] - UNITY_VALUE_NODES ) ; nY = max ( nY , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"nZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"n_",qualifier:["vec2"],c:!1},{type:"node_in",name:"oa",qualifier:["vec3"],c:!1},{type:"node_in",name:"ob",qualifier:["float"],c:!1},{type:"node_in",name:"oc",qualifier:["vec2"],c:!1},{type:"node_out",name:"od",qualifier:["float"],c:!1}],f:[{type:"textline",a:"od = ZERO_VALUE_NODES ; if ( n_ . r != ZERO_VALUE_NODES ) { fg = ( UNITY_VALUE_NODES - ob ) * dot ( oa , nZ ) + ob ; fg = acos ( fg ) ; if ( fg < oc [ 0 ] ) od = UNITY_VALUE_NODES ; else if ( fg > ( oc [ 0 ] + oc [ 1 ] ) || oc [ 1 ] == ZERO_VALUE_NODES ) od = ZERO_VALUE_NODES ; else od = UNITY_VALUE_NODES - ( ( fg - oc [ 0 ] ) / oc [ 1 ] ) ; od = max ( od , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"oe",qualifier:["vec3"],c:!1},{type:"node_in",name:"of",qualifier:["vec2"],c:!1},{type:"node_in",name:"og",qualifier:["vec3"],c:!1},{type:"node_in",name:"oh",qualifier:["float"],c:!1},{type:"node_in",name:"oi",qualifier:["vec2"],c:!1},{type:"node_out",name:"oj",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oj = ZERO_VALUE_NODES ; if ( of . g == UNITY_VALUE_NODES ) { fp = normalize ( oe + eM ) ; oj = ( UNITY_VALUE_NODES - oh ) * max ( dot ( og , fp ) , ZERO_VALUE_NODES ) + oh ; oj = pow ( oj , oi [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"ok",qualifier:["vec3"],c:!1},{type:"node_in",name:"ol",qualifier:["vec2"],c:!1},{type:"node_in",name:"om",qualifier:["vec3"],c:!1},{type:"node_in",name:"on",qualifier:["vec2"],c:!1},{type:"node_out",name:"oo",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oo = ZERO_VALUE_NODES ; if ( ol . g == UNITY_VALUE_NODES ) { fp = normalize ( ok + eM ) ; fg = max ( dot ( om , fp ) , 0.001 ) ;".split(" ")},{type:"textline",a:"fa = max ( dot ( om , eM ) , 0.01 ) ; ff = max ( dot ( om , ok ) , 0.01 ) ; fg = tan ( acos ( fg ) ) ; fb = max ( on [ 0 ] , 0.001 ) ; oo = ff * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * fb * fb ) ) * ( exp ( - ( fg * fg ) / ( fb * fb ) ) / ( sqrt ( fa * ff ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"op",qualifier:["vec3"],c:!1},{type:"node_in",name:"oq",qualifier:["vec2"],c:!1},{type:"node_in",name:"or",qualifier:["vec3"],c:!1},{type:"node_in",name:"os",qualifier:["vec2"],c:!1},{type:"node_out",name:"ot",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ot = ZERO_VALUE_NODES ; if ( oq . g == UNITY_VALUE_NODES ) { fp = normalize ( op + eM ) ; ff = acos ( dot ( fp , or ) ) ; if ( ff < os [ 0 ] ) ot = UNITY_VALUE_NODES ; else if ( ff >= os [ 0 ] + os [ 1 ] || os [ 1 ] == ZERO_VALUE_NODES ) ot = ZERO_VALUE_NODES ; else ot = UNITY_VALUE_NODES - ( ff - os [ 0 ] ) / os [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"ou",qualifier:["vec3"],c:!1},{type:"node_in",name:"ov",qualifier:["vec2"],c:!1},{type:"node_in",name:"ow",qualifier:["vec3"],c:!1},{type:"node_in",name:"ox",qualifier:["float"],c:!1},{type:"node_in",name:"oy",qualifier:["vec2"],c:!1},{type:"node_out",name:"oz",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oz = ZERO_VALUE_NODES ; if ( ov . g == UNITY_VALUE_NODES ) { if ( oy [ 0 ] < UNITY_VALUE_NODES || oy [ 1 ] == ZERO_VALUE_NODES ) oz = ZERO_VALUE_NODES ; else { if ( oy [ 1 ] < 100.0 ) oy [ 1 ] = sqrt ( UNITY_VALUE_NODES / oy [ 1 ] ) ; else oy [ 1 ] = 10.0 / oy [ 1 ] ; fp = normalize ( eM + ou ) ; ff = ( UNITY_VALUE_NODES - ox ) * max ( dot ( ow , fp ) , ZERO_VALUE_NODES ) + ox ; if ( ff < ZERO_VALUE_NODES ) oz = ZERO_VALUE_NODES ; else { fa = max ( dot ( ow , eM ) , 0.01 ) ; fb = dot ( ow , ou ) ; if ( fb <= 0.01 ) oz = ZERO_VALUE_NODES ; else { fg = max ( dot ( eM , fp ) , 0.01 ) ; fc = UNITY_VALUE_NODES ; fa = ( 2.0 * ff * fa ) / fg ; fb = ( 2.0 * ff * fb ) / fg ; fb = min ( min ( fc , fa ) , fb ) ; fa = sqrt ( pow ( oy [ 0 ] , 2.0 ) + pow ( fg , 2.0 ) - UNITY_VALUE_NODES ) ; fg = pow ( fa - fg , 2.0 ) / pow ( fa + fg , 2.0 ) * ( UNITY_VALUE_NODES + pow ( fg * ( fa + fg ) - UNITY_VALUE_NODES , 2.0 ) / pow ( fg * ( fa - fg ) + UNITY_VALUE_NODES , 2.0 ) ) ; ff = acos ( ff ) ; oz = max ( fg * fb * exp ( - pow ( ff , 2.0 ) / ( 2.0 * pow ( oy [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"oA",qualifier:["vec4"],c:!1},{type:"node_in",name:"oB",qualifier:["vec3"],c:!1},{type:"node_in",name:"oC",qualifier:["float"],c:!1},{type:"node_in",name:"oD",qualifier:["float"],c:!1},{type:"node_in",name:"oE",qualifier:["vec3"],c:!1},{type:"node_in",name:"oF",qualifier:["vec3"],c:!1},{type:"node_in",name:"oG",qualifier:["vec4"],c:!1},{type:"node_in",name:"oH",qualifier:["vec3"],c:!1},{type:"node_in",name:"oI",qualifier:["vec3"],c:!1},{type:"node_in",
name:"oJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"oK",qualifier:["float"],c:!1},{type:"node_out",name:"oL",qualifier:["vec4"],c:!1},{type:"node_out",name:"oM",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_NODE_B4W_TRANSLUCENCY"],f:[{type:"textline",a:"if ( dot ( oE , oF ) * dot ( eM , oF ) < ZERO_VALUE_NODES ) { ff = oG . x ; fb = oG . y ; fg = oG . z ; fa = oG . w ;".split(" ")},{type:"textline",a:"fc = clamp ( abs ( dot ( oE , oF ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fd = clamp ( dot ( eM , - oE ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = pow ( fd , fb ) ;".split(" ")},
{type:"textline",a:"oL = oA + oK * vec4 ( oJ * fc * pow ( oH , vec3 ( ff ) ) , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"oL += fg * mix ( vec4 ( oH , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , fa ) * oK * vec4 ( oJ * fc * vec3 ( fb ) , UNITY_VALUE_NODES ) ; oM = oB ; } else {".split(" ")},{type:"textline",a:"oM = oB + oJ * oI * oD ; oL = oA + vec4 ( oJ * oH * oC , oD ) ; }".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"oM = oB + oJ * oI * oD ; oL = oA + vec4 ( oJ * oH * oC , oD ) ;".split(" ")}]}]}]},
{type:"node",name:"RGB",h:[{type:"node_out",name:"oN",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"oN = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",h:[{type:"node_in",name:"oO",qualifier:["vec3"],c:!1},{type:"node_out",name:"oP",qualifier:["float"],c:!1}],f:[{type:"textline",a:"oP = dot ( oO , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",h:[{type:"node_in",name:"oQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"oR",qualifier:["float"],c:!0},
{type:"node_out",name:"oS",qualifier:["float"],c:!0},{type:"node_out",name:"oT",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oR"],f:[{type:"textline",a:"oR = oQ . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oS"],f:[{type:"textline",a:"oS = oQ . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oT"],f:[{type:"textline",a:"oT = oQ . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",h:[{type:"node_in",name:"oU",
qualifier:["vec3"],c:!1},{type:"node_out",name:"oV",qualifier:["float"],c:!0},{type:"node_out",name:"oW",qualifier:["float"],c:!0},{type:"node_out",name:"oX",qualifier:["float"],c:!0}],f:[{type:"textline",a:"fp = eq ( oU ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oV"],f:[{type:"textline",a:"oV = fp . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_oW"],f:[{type:"textline",a:"oW = fp . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_oX"],f:[{type:"textline",a:"oX = fp . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",h:[{type:"node_in",name:"oY",qualifier:["float"],c:!1},{type:"node_in",name:"oZ",qualifier:["float"],c:!1},{type:"node_in",name:"o_",qualifier:["float"],c:!1},{type:"node_out",name:"pa",qualifier:["float"],c:!1}],f:[{type:"textline",a:"pa = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( oY - o_ ) * oZ ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",h:[{type:"node_in",name:"pb",qualifier:["vec3"],
c:!1},{type:"node_in",name:"pc",qualifier:["float"],c:!1},{type:"node_out",name:"pd",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"pd = pb ; if ( pd . x > ZERO_VALUE_NODES ) pd . x = pow ( pb . x , pc ) ; if ( pd . y > ZERO_VALUE_NODES ) pd . y = pow ( pb . y , pc ) ; if ( pd . z > ZERO_VALUE_NODES ) pd . z = pow ( pb . z , pc ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",h:[{type:"node_in",name:"pe",qualifier:["vec3"],c:!1},{type:"node_out",name:"pf",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"pf = max ( vec3 ( ZERO_VALUE_NODES ) , pe ) ; pf = pow ( pf , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",h:[{type:"node_in",name:"pg",qualifier:["vec3"],c:!1},{type:"node_out",name:"ph",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ph = max ( vec3 ( ZERO_VALUE_NODES ) , pg ) ; ph = pow ( ph , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",h:[{type:"node_out",name:"pi",qualifier:["vec3"],c:!1},{type:"node_out",name:"pj",qualifier:["vec3"],
c:!1},{type:"node_out",name:"pk",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pi"],f:[{type:"textline",a:"pi [ 2 ] = pi [ 1 ] = pi [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pj"],f:[{type:"textline",a:"pj [ 2 ] = pj [ 1 ] = pj [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pk"],f:[{type:"textline",a:["pk","=","ZERO_VALUE_NODES",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",
h:[{type:"node_in",name:"pl",qualifier:["vec3"],c:!1},{type:"node_out",name:"pm",qualifier:["vec3"],c:!0},{type:"node_out",name:"pn",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"],c:!1}],f:[{type:"textline",a:"fp = vec3 ( pl . x , pl . z , - pl . y ) ; fi = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , fp ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pm"],f:[{type:"textline",a:"pm = fi . xyz ; br ( pm ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pn"],f:[{type:"textline",a:"pn = fi . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",h:[{type:"node_in",name:"po",qualifier:["vec3"],c:!0},{type:"node_in",name:"pp",qualifier:["vec3"],c:!0},{type:"node_in",name:"pq",qualifier:["vec3"],c:!0},{type:"node_in",name:"pr",qualifier:["vec3"],c:!0},{type:"node_out",name:"ps",qualifier:["vec3"],c:!0},{type:"node_out",name:"pt",qualifier:["float"],c:!0},{type:"node_out",name:"pu",qualifier:["vec3"],
c:!0},{type:"node_out",name:"pv",qualifier:["float"],c:!0},{type:"node_out",name:"pw",qualifier:["vec3"],c:!0},{type:"node_out",name:"px",qualifier:["float"],c:!0},{type:"node_out",name:"py",qualifier:["vec3"],c:!0},{type:"node_out",name:"pz",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( po ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_ps"],f:[{type:"textline",a:"ps = fi . xyz ; br ( ps ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pt"],f:[{type:"textline",a:"pt = fi . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pp ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pu"],f:[{type:"textline",a:"pu = fi . xyz ; br ( pu ) ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_pv"],f:[{type:"textline",a:"pv = fi . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pq ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pw"],f:[{type:"textline",a:"pw = fi . xyz ; br ( pw ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_px"],f:[{type:"textline",a:"px = fi . w ;".split(" ")}]}]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_COLOR_var_texture , ey ( pr ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_py"],f:[{type:"textline",a:"py = fi . xyz ; br ( py ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pz"],f:[{type:"textline",a:"pz = fi . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",h:[{type:"node_in",name:"pA",qualifier:["vec3"],c:!0},{type:"node_in",name:"pB",qualifier:["vec3"],
c:!0},{type:"node_in",name:"pC",qualifier:["vec3"],c:!0},{type:"node_in",name:"pD",qualifier:["vec3"],c:!0},{type:"node_out",name:"pE",qualifier:["vec3"],c:!0},{type:"node_out",name:"pF",qualifier:["float"],c:!0},{type:"node_out",name:"pG",qualifier:["vec3"],c:!0},{type:"node_out",name:"pH",qualifier:["float"],c:!0},{type:"node_out",name:"pI",qualifier:["vec3"],c:!0},{type:"node_out",name:"pJ",qualifier:["float"],c:!0},{type:"node_out",name:"pK",qualifier:["vec3"],c:!0},{type:"node_out",name:"pL",
qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pA ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pE"],f:[{type:"textline",a:"pE = normalize ( fj * ( fi . xyz - eh ) ) ;".split(" ")},{type:"textline",a:"pE . yz = vec2 ( - pE . z , pE . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pF"],f:[{type:"textline",
a:"pF = fi . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pB ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pG"],f:[{type:"textline",a:"pG = normalize ( fj * ( fi . xyz - eh ) ) ;".split(" ")},{type:"textline",a:"pG . yz = vec2 ( - pG . z , pG . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pH"],f:[{type:"textline",a:"pH = fi . w ;".split(" ")}]}]}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pC ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pI"],f:[{type:"textline",a:"pI = normalize ( fj * ( fi . xyz - eh ) ) ;".split(" ")},{type:"textline",a:"pI . yz = vec2 ( - pI . z , pI . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pJ"],f:[{type:"textline",a:"pJ = fi . w ;".split(" ")}]}]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"fi = texture2D ( node_TEXTURE_NORMAL_var_texture , ey ( pD ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pK"],f:[{type:"textline",a:"pK = normalize ( fj * ( fi . xyz - eh ) ) ;".split(" ")},{type:"textline",a:"pK . yz = vec2 ( - pK . z , pK . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pL"],f:[{type:"textline",a:"pL = fi . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",h:[{type:"node_out",
name:"pM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"pM = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",h:[{type:"node_in",name:"pN",qualifier:["vec3"],c:!1},{type:"node_in",name:"pO",qualifier:["vec3"],c:!1},{type:"node_out",name:"pP",qualifier:["vec3"],c:!1},{type:"node_out",name:"pQ",qualifier:["float"],c:!0}],f:[{type:"textline",a:"pP = pN + pO ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pQ"],f:[{type:"textline",a:"pQ = ( abs ( pP [ 0 ] ) + abs ( pP [ 1 ] ) + abs ( pP [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_SUBTRACT",h:[{type:"node_in",name:"pR",qualifier:["vec3"],c:!1},{type:"node_in",name:"pS",qualifier:["vec3"],c:!1},{type:"node_out",name:"pT",qualifier:["vec3"],c:!1},{type:"node_out",name:"pU",qualifier:["float"],c:!0}],f:[{type:"textline",a:"pT = pR - pS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pU"],f:[{type:"textline",a:"pU = ( abs ( pT [ 0 ] ) + abs ( pT [ 1 ] ) + abs ( pT [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",
h:[{type:"node_in",name:"pV",qualifier:["vec3"],c:!1},{type:"node_in",name:"pW",qualifier:["vec3"],c:!1},{type:"node_out",name:"pX",qualifier:["vec3"],c:!1},{type:"node_out",name:"pY",qualifier:["float"],c:!0}],f:[{type:"textline",a:"pX = pV + pW ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pY"],f:[{type:"textline",a:"pY = length ( pX ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_pX"],f:[{type:"textline",a:"pX = normalize ( pX ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",h:[{type:"node_in",name:"pZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"p_",qualifier:["vec3"],c:!1},{type:"node_out",name:"qa",qualifier:["vec3"],c:!1},{type:"node_out",name:"qb",qualifier:["float"],c:!0}],f:[{type:"textline",a:"qa = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qb"],f:[{type:"textline",a:"qb = dot ( pZ , p_ ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",h:[{type:"node_in",
name:"qc",qualifier:["vec3"],c:!1},{type:"node_in",name:"qd",qualifier:["vec3"],c:!1},{type:"node_out",name:"qe",qualifier:["vec3"],c:!1},{type:"node_out",name:"qf",qualifier:["float"],c:!0}],f:[{type:"textline",a:"qe = cross ( qc , qd ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qf"],f:[{type:"textline",a:"qf = length ( qe ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",h:[{type:"node_in",name:"qg",qualifier:["vec3"],c:!1},{type:"node_in",name:"qh",qualifier:["vec3"],
c:!1},{type:"node_out",name:"qi",qualifier:["vec3"],c:!1},{type:"node_out",name:"qj",qualifier:["float"],c:!0}],f:[{type:"textline",a:"qi = normalize ( qg ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qj"],f:[{type:"textline",a:"qj = length ( qg ) ;".split(" ")}]}]},{type:"textline",a:["qh",";"]}]},{type:"node",name:"B4W_REFLECT",h:[{type:"node_in",name:"qk",qualifier:["vec3"],c:!1},{type:"node_in",name:"ql",qualifier:["vec3"],c:!1},{type:"node_out",name:"qm",qualifier:["vec3"],
c:!1}],f:[{type:"textline",a:"qm = reflect ( ( eP * vec4 ( qk , 0.0 ) ) . xyz , ql ) ;".split(" ")}]},{type:"node",name:"B4W_REFLECT_WORLD",h:[{type:"node_in",name:"qn",qualifier:["vec3"],c:!1},{type:"node_out",name:"qo",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"fp = vec3 ( - eM . x , eM . z , - eM . y ) ; qo = reflect ( fp , qn ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",h:[{type:"node_in",name:"qp",qualifier:["vec3"],c:!1},{type:"node_in",name:"qq",qualifier:["float"],c:!1},{type:"node_in",
name:"qr",qualifier:["const","float"],c:!1},{type:"node_in",name:"qs",qualifier:["const","float"],c:!1},{type:"node_out",name:"qt",qualifier:["vec3"],c:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"fb = length ( fh ) ; if ( fb < qs ) { eX = ey ( qp ) ; fb = clamp ( eh * ( qs - fb ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fb = qq * fb ;".split(" ")},{type:"textline",a:"fp = normalize ( eM * fj ) ;".split(" ")},{type:"textline",
a:"fc = UNITY_VALUE_NODES / qr ;".split(" ")},{type:"textline",a:"eY = fp . xy * fb / ( qr * fp . z ) ; fb = UNITY_VALUE_NODES ; fa = texture2D ( node_B4W_PARALLAX_var_texture , eX ) . a ;".split(" ")},{type:"textline",a:"for ( float qu = 1.0 ; qu <= qr ; qu ++ ) { if ( fa < fb ) { fb -= fc ; eX -= eY ; fa = texture2D ( node_B4W_PARALLAX_var_texture , eX ) . a ; } }".split(" ")},{type:"textline",a:"eY = eX + eY ; fc = texture2D ( node_B4W_PARALLAX_var_texture , eY ) . a - ( fb + fc ) ; fb = fa - fb ; fc = fb / ( fb - fc ) ;".split(" ")},
{type:"textline",a:"eX = fc * eY + ( UNITY_VALUE_NODES - fc ) * eX ; qt = ew ( eX ) ; } else qt = qp ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",h:[{type:"node_in",name:"qv",qualifier:["vec3"],c:!1},{type:"node_out",name:"qw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qw = clamp ( qv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",h:[{type:"node_in",name:"qx",qualifier:["vec3"],c:!1},{type:"node_in",name:"qy",qualifier:["float"],c:!1},{type:"node_out",
name:"qz",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qz = el ( qx , qy ) ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",h:[{type:"node_in",name:"qA",qualifier:["float"],c:!1},{type:"node_in",name:"qB",qualifier:["float"],c:!1},{type:"node_in",name:"qC",qualifier:["float"],c:!1},{type:"node_in",name:"qD",qualifier:["float"],c:!1},{type:"node_in",name:"qE",qualifier:["float"],c:!1},{type:"node_out",name:"qF",qualifier:["float"],c:!0},{type:"node_out",name:"qG",qualifier:["vec4"],c:!0}],
f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qF"],f:[{type:"textline",a:["qF","=","qA",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_qG"],f:[{type:"textline",a:"qG = vec4 ( qB , qC , qD , qE ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",h:[{type:"node_out",name:"qH",qualifier:["float"],c:!1}],f:[{type:"textline",a:["qH","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",h:[{type:"node_in",name:"qI",qualifier:["float"],c:!1},{type:"node_in",name:"qJ",qualifier:["float"],
c:!1},{type:"node_in",name:"qK",qualifier:["float"],c:!1},{type:"node_out",name:"qL",qualifier:["float"],c:!1}],f:[{type:"textline",a:"qL = smoothstep ( qJ , qK , qI ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",h:[{type:"node_in",name:"qM",qualifier:["vec3"],c:!1},{type:"node_in",name:"qN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"eS = qM ; eW = qN ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",h:[{type:"node_in",name:"qO",qualifier:["vec3"],c:!1},{type:"node_out",name:"qP",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"qP = ( qO . r + qO . g + qO . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",h:[{type:"node_in",name:"qQ",qualifier:["float"],c:!1},{type:"node_out",name:"qR",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"qR [ 0 ] = qQ ; qR [ 1 ] = qQ ; qR [ 2 ] = qQ ;".split(" ")}]},{type:"nodes_global"},{type:"textline",a:"void qS ( in vec3 eM , in mat4 eN , in mat4 eO , in mat4 eP , in mat4 eQ , in mat4 eR , out vec3 eS , out vec3 eT , out vec3 eU , out vec4 eV , out float eW ) { vec2 eX , eY ; float eZ , e_ , fa , fb , fc , fd , fe , ff , fg ; vec4 fh , fi ; mat3 fj ; vec3 fk , fl , fm , fn , fo , fp ; eS = vec3 ( ZERO_VALUE_NODES ) ; eT = vec3 ( ZERO_VALUE_NODES ) ; eU = vec3 ( ZERO_VALUE_NODES ) ; eV = vec4 ( ZERO_VALUE_NODES ) ; eW = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"fk = normalize ( bE ) ; fl = fk ;".split(" ")},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!",
"gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"fl = fl ; else fl = - fl ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"textline",a:["fm","=","fl",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["fm","=","fk",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_NO"],group:{type:"group",b:[{type:"textline",a:["fk","=",
"fl",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"fn = cross ( fl , bF . xyz ) * bF . w ; fj = mat3 ( bF . xyz , fn , fl ) ; fj = fj ;".split(" ")}]}}]},{type:"textline",a:"fl = bC ; fh = bD ; eZ = u_emit ; e_ = u_ambient ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/to_world.glslv"]={type:"group",b:[{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"define",name:"MAX_BILLBOARD_ANGLE",a:["(","M_PI",
"/","4.0",")"]},{type:"textline",a:"const vec3 qT = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",e:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"mat4 qZ ( vec3 qU , mat4 qV ) { vec3 qW , qX , qY ; qW = vec3 ( qV [ 0 ] [ 0 ] , qV [ 1 ] [ 0 ] , qV [ 2 ] [ 0 ] ) ; qX = vec3 ( qV [ 0 ] [ 1 ] , qV [ 1 ] [ 1 ] , qV [ 2 ] [ 1 ] ) ; qY = vec3 ( qV [ 0 ] [ 2 ] , qV [ 1 ] [ 2 ] , qV [ 2 ] [ 2 ] ) ; qX = cross ( qY , qW ) ; return mat4 ( vec4 ( qW , 0.0 ) , vec4 ( qX , 0.0 ) , vec4 ( qY , 0.0 ) , vec4 ( qU , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"mat4 re ( vec3 q_ , vec3 ra ) { vec3 rb , rc , rd ; rb = q_ - ra ; rb . y = 0.0 ; rb = normalize ( rb ) ; rc = normalize ( cross ( qT , rb ) ) ; rd = normalize ( cross ( rb , rc ) ) ; return mat4 ( vec4 ( rc , 0.0 ) , vec4 ( rd , 0.0 ) , vec4 ( rb , 0.0 ) , vec4 ( ra , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",b:[{type:"textline",a:"mat4 rm ( in vec3 rf , float rg , float rh , float ri , vec3 rj ) { float rk , rl ; rk = fract ( length ( rj ) / 0.17 ) ; rl = ri + rk / 10.0 ; rk = rk ; if ( ri != 0.0 ) rk /= ri ; rf *= 1.0 + 0.5 * sin ( rg ) ; rk = length ( rf ) * rh * sin ( 2.0 * 3.14 * rg * rl + rk ) ; return C ( rk ) ; }".split(" ")}]}}]},
{type:"textline",a:"mat4 ru ( in vec3 rn , in vec3 ro , in mat4 rp ) { vec3 rq ; float rr , rs ; mat4 rt ;".split(" ")},{type:"condition",b:[{type:"if",d:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",e:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"rt = qZ ( ro , rp ) ;".split(" ")}]}},{type:"elif",d:["BILLBOARD_RANDOM"],group:{type:"group",b:[{type:"textline",
a:"rr = fract ( ( ro . x * 1.43 + ro . y * 0.123 + ro . z * 6.1 ) ) ; rr = 2.0 * M_PI * rr ; rq = normalize ( vec3 ( rp [ 0 ] [ 2 ] , 0.0 , rp [ 2 ] [ 2 ] ) ) ; rs = acos ( rq [ 2 ] ) ; if ( rq [ 0 ] < 0.0 ) rs = 2.0 * M_PI - rs ; rs = rs - rr ; if ( rs < 0.0 ) rs = 2.0 * M_PI + rs ; rr = rr ; if ( rs <= MAX_BILLBOARD_ANGLE ) rr += rs ; else if ( rs <= M_PI - MAX_BILLBOARD_ANGLE ) rr += MAX_BILLBOARD_ANGLE * ( 2.0 * rs - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( rs <= M_PI + MAX_BILLBOARD_ANGLE ) rr += rs - M_PI ; else if ( rs <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) rr += MAX_BILLBOARD_ANGLE * ( 2.0 * rs - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else rr += rs - 2.0 * M_PI ; rt = A ( rr ) ; rt [ 3 ] = vec4 ( ro , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"rt = re ( rn , ro ) ;".split(" ")}]}}]},{type:"textline",a:["return","rt",";","}"]},{type:"condition",b:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"mat4 rA ( in vec3 rv , in vec3 rw , in mat4 rx , mat4 ry ) { mat4 rz ; rz = ru ( rv , rw , rx ) ; ry [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; rz = rz * ry ; return rz ; }".split(" ")}]}}]},
{type:"textline",a:"c rH ( in vec3 rB , in vec3 rC , in vec3 rD , in vec3 rE , in vec3 rF , in mat4 rG ) { rB = ( rG * vec4 ( rB , 1.0 ) ) . xyz ; rC = ( rG * vec4 ( rC , 1.0 ) ) . xyz ; rD = ( rG * vec4 ( rD , 0.0 ) ) . xyz ; rE = ( rG * vec4 ( rE , 0.0 ) ) . xyz ; rF = ( rG * vec4 ( rF , 0.0 ) ) . xyz ; return E ( c ( rB , rC , rD , rE , rF , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};a["include/scale_texcoord.glslv"]={type:"group",b:[{type:"textline",a:"vec2 rK ( vec2 rI , vec3 rJ ) { return ( rI + 0.5 ) * rJ . xy - 0.5 ; }".split(" ")}]};
a["include/skin.glslv"]={type:"group",b:[{type:"define",name:"SKIN_SLERP",a:["0"]},{type:"condition",b:[{type:"if",d:["SKINNED"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],group:{type:"group",b:[{type:"textline",a:"vec4 rR ( in vec4 rL , in vec4 rM , in float rN ) { float rO , rP , rQ ; rO = rL [ 0 ] * rM [ 0 ] + rL [ 1 ] * rM [ 1 ] + rL [ 2 ] * rM [ 2 ] + rL [ 3 ] * rM [ 3 ] ; if ( rO < 0.0 ) { rM *= - 1.0 ; rO = - rO ; } if ( abs ( rO ) >= 1.0 ) return rL ; rP = acos ( rO ) ; rO = sqrt ( 1.0 - rO * rO ) ; if ( abs ( rO ) < 0.001 ) return vec4 ( rL * 0.5 + rM * 0.5 ) ; rQ = sin ( ( 1.0 - rN ) * rP ) / rO ; rO = sin ( rN * rP ) / rO ; return rL * rQ + rM * rO ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"vec3 sc ( in vec3 rS , in vec4 rT , in vec4 rU , in vec4 rV , in vec4 rW , in float rX ) { vec4 rY , rZ ; vec3 r_ , sa , sb ; r_ = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( rS , 1.0 ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],group:{type:"group",b:[{type:"textline",a:"rY = rR ( rT , rU , rX ) ; rZ = mix ( rV , rW , rX ) ; sa = i ( rY , r_ ) ; sa = sa * rZ . w + rZ . xyz ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"sb = i ( rT , r_ ) ; r_ = i ( rU , r_ ) ; sb = sb * rV . w + rV . xyz ; r_ = r_ * rW . w + rW . xyz ; sa = mix ( sb , r_ , rX ) ;".split(" ")}]}}]},{type:"textline",a:"return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sa , 1.0 ) ) ; } vec3 sl ( in vec3 sd , in vec4 se , in vec4 sf , in float sg ) { vec4 sh ; vec3 si , sj , sk ; si = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sd , 0.0 ) ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["SKIN_SLERP"],
group:{type:"group",b:[{type:"textline",a:"sh = rR ( se , sf , sg ) ; sj = i ( sh , si ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"sk = i ( se , si ) ; si = i ( sf , si ) ; sj = mix ( sk , si , sg ) ;".split(" ")}]}}]},{type:"textline",a:"return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sj , 0.0 ) ) ; }".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"vec3 sc ( in vec3 sm , in vec4 sn , in vec4 so ) { vec3 sp ; sp = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sm , 1.0 ) ) ; sp = i ( sn , sp ) ; sp = sp * so . w + so . xyz ; return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sp , 1.0 ) ) ; } vec3 sl ( in vec3 sq , in vec4 sr ) { vec3 ss ; ss = p ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sq , 0.0 ) ) ; ss = i ( sr , ss ) ; return v ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( ss , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",a:"void sH ( inout vec3 st , inout vec3 su , inout vec3 sv , inout vec3 sw ) { int sx , sy ; vec4 sz ; vec3 sA , sB , sC , sD ; float sE , sF ;".split(" ")},{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:["sE","=","u_frame_factor",";"]}]}}]},{type:"textline",a:"if ( a_influence . y > 0.0 ) { sA = vec3 ( 0.0 , 0.0 , 0.0 ) ; sB = vec3 ( 0.0 , 0.0 , 0.0 ) ; sC = vec3 ( 0.0 , 0.0 , 0.0 ) ; sD = vec3 ( 0.0 , 0.0 , 0.0 ) ; sz = a_influence ; for ( int sG = 0 ; sG < 4 ; sG ++ ) { sx = int ( sz [ sG ] ) ; sF = fract ( sz [ sG ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"sA += sF * sc ( st , u_quatsb [ sx ] , u_quatsa [ sx ] , u_transb [ sx ] , u_transa [ sx ] , sE ) ; sB += sF * sl ( su , u_quatsb [ sx ] , u_quatsa [ sx ] , sE ) ; sC += sF * sl ( sv , u_quatsb [ sx ] , u_quatsa [ sx ] , sE ) ; sD += sF * sl ( sw , u_quatsb [ sx ] , u_quatsa [ sx ] , sE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"sA += sF * sc ( st , u_quatsb [ sx ] , u_transb [ sx ] ) ; sD += sF * sl ( sw , u_quatsb [ sx ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"sB += sF * sl ( su , u_quatsb [ sx ] ) ; sC += sF * sl ( sv , u_quatsb [ sx ] ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:"} st = sA ; sw = sD ;".split(" ")},{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"su = sB ; sv = sC ;".split(" ")}]}}]},{type:"textline",a:"} if ( ! ( a_influence . y > 0.0 ) ) { sy = int ( a_influence [ 0 ] - 1.0 ) ; if ( sy > - 1 ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",b:[{type:"textline",a:"st = sc ( st , u_quatsb [ sy ] , u_quatsa [ sy ] , u_transb [ sy ] , u_transa [ sy ] , sE ) ; su = sl ( su , u_quatsb [ sy ] , u_quatsa [ sy ] , sE ) ; sv = sl ( sv , u_quatsb [ sy ] , u_quatsa [ sy ] , sE ) ; sw = sl ( sw , u_quatsb [ sy ] , u_quatsa [ sy ] , sE ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"st = sc ( st , u_quatsb [ sy ] , u_transb [ sy ] ) ; sw = sl ( sw , u_quatsb [ sy ] ) ;".split(" ")},
{type:"condition",b:[{type:"if",d:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",e:1}],group:{type:"group",b:[{type:"textline",a:"su = sl ( su , u_quatsb [ sy ] ) ; sv = sl ( sv , u_quatsb [ sy ] ) ;".split(" ")}]}}]}]}}]},{type:"textline",a:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["WIND_BEND"],group:{type:"group",b:[{type:"textline",a:"void sS ( inout vec3 sI , in vec3 sJ , in float sK , in float sL , in float sM , in vec3 sN , in float sO ) { vec3 sP ; float sQ , sR ; sQ = length ( sJ ) ; sR = sL * ( 1.0 + 0.1 * fract ( sQ ) ) ; sQ = sK * sO * ( 1.0 + sin ( 2.0 * 3.14 * sM * sR + sQ ) ) ; sR = ( sI . y - sJ . y ) * abs ( sQ ) ; sR += 1.0 ; sR *= sR ; sR = sR * sR - sR ; sP = sI ; sP . xz += sN . xz * sR * sign ( sQ ) ; sP = sP - sJ ; if ( all ( equal ( sP , vec3 ( 0.0 ) ) ) ) sI = sJ ; else { sQ = length ( sI - sJ ) ; sI = sJ + normalize ( sP ) * sQ ; } }".split(" ")},
{type:"condition",b:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"vec4 sU ( vec4 sT ) { return sT * sT * ( 3.0 - 2.0 * sT ) ; } vec4 sW ( vec4 sV ) { return abs ( fract ( sV + 0.5 ) * 2.0 - 1.0 ) ; } vec4 sY ( vec4 sX ) { return sU ( sW ( sX ) ) ; } void to ( inout vec3 sZ , in float s_ , in vec3 ta , in vec3 tb , in vec3 tc , in float td , in float te , in float tf , in vec3 tg ) { vec3 th ; vec4 ti ; vec2 tj , tk ; float tl , tm , tn ; tl = dot ( tc , vec3 ( 1.0 ) ) ; tm = tl + tg . g ; tn = dot ( sZ , vec3 ( tg . g ) ) ; tj = ( s_ + vec2 ( tn , tm ) ) ; ti = ( ( fract ( ( tj . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( tb ) * td ; ti = sY ( ti ) ; tk = ti . xz + ti . yw ; tk . y = 0.5 - tk . y ; th = tk . xyx * tg . rbr * vec3 ( te * ta . x , tf , te * ta . z ) ; sZ += th ; }".split(" ")}]}}]},
{type:"textline",a:"void tv ( inout vec3 tp , inout vec3 tq , in vec3 tr ) { vec3 ts , tt , tu ; ts = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:"tt = tq ; tu = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tt = tp ; tu = tq ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",b:[{type:"condition",b:[{type:"if",
d:["DETAIL_BEND"],group:{type:"group",b:[{type:"textline",a:"to ( tt , u_time , tr , ts , tu , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",a:"sS ( tt , tu , au_wind_bending_amp , au_wind_bending_freq , u_time , ts , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"sS ( tt , tu , au_wind_bending_amp , au_wind_bending_freq , u_time , ts , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",b:[{type:"textline",a:"tp += tt - tq ; tq = tt ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"tp = tt ; tq = tu ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/nodes.glslv"]={type:"group",b:[{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2},"PARTICLE_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:"attribute vec3 a_orco_tex_coord ; varying vec3 eg ;".split(" ")}]}}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eG",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eG","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",h:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eF",
qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eF","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",name:"UVMAP",h:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"eH",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["eH","=","node_UVMAP_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_UV",h:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"ez",qualifier:["varying",
"vec2"],c:!1}],f:[{type:"textline",a:["ez","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_param",name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"],c:!1},{type:"node_param",name:"tw",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:["tw","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"],c:!1},{type:"node_param",
name:"tx",qualifier:["varying","float"],c:!1}],f:[{type:"textline",a:["tx","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"],c:!1},{type:"node_param",name:"ty",qualifier:["varying","vec2"],c:!1}],f:[{type:"textline",a:["ty","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",
qualifier:["attribute","vec3"],c:!1},{type:"node_param",name:"tz",qualifier:["varying","vec3"],c:!1}],f:[{type:"textline",a:["tz","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{type:"nodes_global"},{type:"textline",a:["void","tA","(",")","{"]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:["eg","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/dynamic_grass.glslv"]=
{type:"group",b:[{type:"var",name:"PRECISION",a:["lowp"]},{type:"condition",b:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",b:[{type:"textline",a:"vec2 tG ( vec3 tC , float tD , vec2 tE ) { vec2 tF ; tF = vec2 ( ( tC . x - tE . x ) / tD , - ( tC . z - tE . y ) / tD ) ; return fract ( tF ) ; } vec2 tK ( vec2 tH , float tI , vec2 tJ ) { return vec2 ( tH . x * tI , - tH . y * tI ) + tJ ; } c tL ( ) { return c ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } c ug ( vec3 tM , vec3 tN , vec3 tO , vec3 tP , vec3 tQ , PRECISION sampler2D tR , sampler2D tS , vec3 tT , float tU , vec3 tV , vec4 tW , mat4 tX ) { mat4 tY ; vec4 tZ ; vec2 t_ , ua , ub ; float uc , ud ; vec3 ue ; ue = i ( tW , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; uc = - ue . x ; ud = - ue . z ; t_ = vec2 ( tV . x + tU * ( - 1.0 - uc ) / 2.0 , tV . z + tU * ( 1.0 - ud ) / 2.0 ) ; ua = tG ( tQ , tU , t_ ) ; ud = tU / 2.0 ; ub = abs ( tK ( ua - vec2 ( 0.5 ) , tU , vec2 ( 0.0 ) ) ) ; ud = ud * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( ub ) > ud ) return tL ( ) ; ud = tU / tT . z ; ub = ( ua - vec2 ( 0.5 ) ) * ud + vec2 ( 0.5 ) ; ue = ue * ( tU / tT . z - 1.0 ) / 2.0 ; ub . x += ue . x ; ub . y -= ue . z ; tZ = texture2D ( tS , ub ) ; ud = tZ . r ; if ( ud < u_scale_threshold ) return tL ( ) ; uc = tT . y - tT . x ; uc = tT . y - texture2D ( tR , ub ) . r * uc ; ub = tM . xz - tQ . xz ; tQ . xz = tK ( ua , tU , t_ ) ; tQ . y = uc ; tM . xz = tQ . xz + ub ; tM . y *= ud ; tM . y += uc ; ue = tZ . gba ;".split(" ")},
{type:"condition",b:[{type:"if",d:["BILLBOARD"],group:{type:"group",b:[{type:"textline",a:"tM -= tQ ; tY = ru ( tV , tQ , tX ) ; c uf = rH ( tM , tQ , tN , tO , tP , tY ) ; uf . b = tQ ; uf . f = ue ; return E ( uf ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return E ( c ( tM , tQ , tN , tO , tP , ue ) ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/halo_color.glslf"]={type:"group",b:[{type:"var",name:"NUM_LINES",a:["0"]},{type:"var",name:"NUM_RINGS",
a:["0"]},{type:"var",name:"NUM_STARS",a:["0"]},{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"condition",b:[{type:"if",d:["NUM_RINGS","NUM_LINES",{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"const int uk = NUM_RINGS ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"const int uk = NUM_LINES ;".split(" ")}]}}]},{type:"textline",a:"float um ( float ul ) { return ul - floor ( ul * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_RINGS"],
group:{type:"group",b:[{type:"textline",a:"void uv ( inout float un , in float uo [ uk ] , in float up ) { float uq , ur , us , ut ; for ( int uu = 0 ; uu < NUM_RINGS ; uu ++ ) { uq = 40.0 * uo [ uu ] ; ur = 300.0 * ( um ( uq ) - 0.005 ) ; us = uq ; ut = abs ( us * ( u_halo_size * ur - up ) ) ; un += 1.0 - min ( ut , 1.0 ) ; } }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"void uE ( inout float uw , in float ux [ uk ] , in float uy ) { float uz , uA , uB , uC ; for ( int uD = 0 ; uD < NUM_LINES ; uD ++ ) { uz = ux [ uD ] ; uA = uz ; uB = 1000.0 * ( um ( uz ) - 0.005 ) ; uC = 20.0 * abs ( uA * bM . x + uB * bM . y ) ; uw += 1.0 - min ( uC , 1.0 ) ; } uw *= uy ; }".split(" ")}]}}]},
{type:"textline",a:"void uL ( inout float uF , in vec2 uG ) { float uH , uI , uJ , uK ; uI = atan ( uG . y , uG . x ) ; uI *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; uJ = cos ( uI ) ; uK = sin ( uI ) ; uI = ( uJ * uG . x + uK * uG . y ) * ( uJ * uG . y - uK * uG . x ) ; uH = abs ( uI ) ; if ( uH < 1.0 ) { uH = ( 0.01 * u_halo_size ) / ( uH ) ; uF *= sqrt ( min ( uH , 1.0 ) ) ; } } vec4 uU ( ) { vec4 uM ; vec3 uN ; float uO , uP , uQ , uR ; uO = ( bM . x * bM . x + bM . y * bM . y ) ; uP = sqrt ( uO ) ; uO = max ( 1.0 - uO , 0.0 ) ; uO = pow ( uO , u_halo_hardness ) ; uQ = u_diffuse_color . a ;".split(" ")},
{type:"condition",b:[{type:"if",d:["NUM_RINGS","NUM_LINES",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"float uS [ uk ] ; for ( int uT = 0 ; uT < uk ; uT ++ ) { uS [ uT ] = fract ( uj / float ( uT + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_RINGS"],group:{type:"group",b:[{type:"textline",a:"uR = 0.0 ; uv ( uR , uS , uP ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"uP = 0.0 ; uE ( uP , uS , uO ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["NUM_STARS"],group:{type:"group",b:[{type:"textline",a:"uL ( uO , bM ) ;".split(" ")}]}}]},{type:"textline",a:"uO *= uQ ; uN = u_diffuse_color . rgb ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_RINGS"],group:{type:"group",b:[{type:"textline",a:"uR *= uO ; uN += u_halo_rings_color * uR ; uO += uR ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_LINES"],group:{type:"group",b:[{type:"textline",a:"uP *= uQ ; uN += u_halo_lines_color * uP ; uO += uP ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["SKY_STARS"],group:{type:"group",b:[{type:"textline",a:"uO *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uP = u_halo_stars_blend * ( ui . y - u_halo_stars_height ) ; uO *= clamp ( uP , 0.0 , 1.0 ) ; uO *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},
{type:"textline",a:"uM = vec4 ( uN , uO ) ; return uM ; }".split(" ")}]};a["include/fog.glslf"]={type:"group",b:[{type:"var",name:"WAVES_HEIGHT",a:["0.0"]},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"textline",a:"void va ( inout vec3 uV , in float uW , in float uX , in vec4 uY ) { float uZ , u_ ; uZ = clamp ( ( uW - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["FOG_TYPE","QUADRATIC",{type:"equal_expr",e:2}],group:{type:"group",
b:[{type:"textline",a:["uZ","*=","uZ",";"]}]}},{type:"elif",d:["FOG_TYPE","LINEAR",{type:"equal_expr",e:2}],group:{type:"group",b:[]}},{type:"elif",d:["FOG_TYPE","INVERSE_QUADRATIC",{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"uZ = sqrt ( uZ ) ;".split(" ")}]}}]},{type:"textline",a:"if ( u_fog_params . w > 0.0 ) { if ( uX > u_fog_params . w ) uZ = 0.0 ; else { u_ = ( u_fog_params . w - max ( uX , 0.0 ) ) / u_fog_params . w ; uZ *= u_ * u_ ; } } uY . a = 1.0 - ( 1.0 - uZ ) * ( 1.0 - u_fog_params . x ) ; uV = mix ( uV , uY . rgb , uY . a ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:"vec3 vg ( in mat4 vb , in vec3 vc ) { vec3 vd , ve , vf ; vd = mix ( vb [ 0 ] . rgb , vb [ 1 ] . rgb , max ( sign ( vc . x ) , 0.0 ) ) ; ve = mix ( vb [ 2 ] . rgb , vb [ 3 ] . rgb , max ( sign ( vc . z ) , 0.0 ) ) ; vf = vec3 ( vb [ 0 ] . a , vb [ 1 ] . a , vb [ 2 ] . a ) ; ve = mix ( vd , ve , abs ( vc . z ) ) ; ve = mix ( ve , vf , abs ( vc . y ) ) ; br ( ve ) ; return ve ; }".split(" ")}]}}]},{type:"condition",
b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"void vi ( inout float vh ) { vh -= 0.5 ; vh = 4.0 * ( vh * vh * vh ) + 0.5 ; }".split(" ")},{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"void vt ( inout vec3 vj , in float vk , in vec3 vl , in float vm , in vec4 vn , in float vo ) { vec3 vp , vq ; float vr , vs ; vr = max ( vl . y , 0.0 ) ; vs = max ( vk - max ( vm / vr , 0.0 ) , 0.0 ) ; vs = vn . w * vs ; vp = vec3 ( 0.0 , 0.02 , 0.05 ) ; vq = vn . rgb ; vs = min ( vs , 1.0 ) ; vi ( vs ) ; vs *= clamp ( 2.0 - vo , 0.0 , 1.0 ) ; vp = mix ( vq , vp , min ( vr , 1.0 ) ) ; vm = clamp ( - vm * 0.03 , 0.0 , 0.8 ) ; vp *= 1.0 - vm ; vj = mix ( vj , vp , vs ) ; }".split(" ")}]}}]}]}}]},
{type:"textline",a:"void vA ( inout vec3 vu , float vv , vec3 vw , float vx ) { vec4 vy ; vec3 vz ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_FOG"],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",b:[{type:"textline",a:"vz = vg ( u_cube_fog , vw ) ; vy = vec4 ( vz , u_fog_color_density . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["vy","=","u_fog_color_density",";"]}]}}]},{type:"textline",a:"va ( vu , vv , bC . y , vy ) ;".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",b:[{type:"textline",a:"vt ( vu , vv , vw , u_cam_water_depth , u_underwater_fog_color_density , vx ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[]}}]},{type:"textline",a:["}"]}]};a["include/shadow.glslv"]={type:"group",b:[{type:"var",name:"SHADOW_TEX_RES",a:["0.0"]},{type:"condition",b:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",
e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 vJ ( mat4 vD , vec4 vE , mat4 vF ) { vec4 vG ; float vH ; vec2 vI ; vI = ( vD * vF [ 3 ] ) . xy ; vH = SHADOW_TEX_RES / 2.0 ; vI = floor ( vI * vH + 0.5 ) / vH - vI ; vG = vD * vE ; vG . xy += vI ; vG . xyz = 0.5 * ( vG . xyz + vG . w ) ; return vG ; } void vO ( vec3 vK , vec3 vL ) { vec4 vM ; mat4 vN ;".split(" ")},{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vN = O ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vM = vN * vec4 ( vK + u_normal_offset * vL , 1.0 ) ; bI = vJ ( u_p_light_matrix0 , vM , vN ) ;".split(" ")},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vN = O ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vM = vN * vec4 ( vK + u_normal_offset * vL , 1.0 ) ; bJ = vJ ( u_p_light_matrix1 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vN = O ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vM = vN * vec4 ( vK + u_normal_offset * vL , 1.0 ) ; bK = vJ ( u_p_light_matrix2 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["NUM_CAST_LAMPS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["MAC_OS_SHADOW_HACK"],group:{type:"group",b:[{type:"textline",a:"vN = O ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},
{type:"else",group:{type:"group",b:[{type:"textline",a:"vN = O ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",a:"vM = vN * vec4 ( vK + u_normal_offset * vL , 1.0 ) ; bL = vJ ( u_p_light_matrix3 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",b:[{type:"textline",a:"bJ = vJ ( u_p_light_matrix1 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",b:[{type:"textline",
a:"bK = vJ ( u_p_light_matrix2 , vM , vN ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",b:[{type:"textline",a:"bL = vJ ( u_p_light_matrix3 , vM , vN ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]}}]}]};a["include/lighting_nodes.glslf"]={type:"group",b:[{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",
a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float vP = 0.5 ;".split(" ")},{type:"node",name:"LIGHTING_BEGIN",h:[{type:"node_out",name:"wm",qualifier:["vec3"],c:!1},{type:"node_out",name:"wn",qualifier:["vec3"],c:!1},{type:"node_out",name:"wo",qualifier:["vec3"],c:!1},{type:"node_out",name:"wp",qualifier:["vec3"],
c:!0},{type:"node_out",name:"wq",qualifier:["vec3"],c:!0},{type:"node_out",name:"wr",qualifier:["vec2"],c:!0},{type:"node_out",name:"ws",qualifier:["vec2"],c:!0},{type:"node_out",name:"wt",qualifier:["vec4"],c:!0},{type:"node_out",name:"wu",qualifier:["float"],c:!0},{type:"node_out",name:"wv",qualifier:["vec4"],c:!0}],f:[{type:"textline",a:"wm = vQ ; wn = vR ; wo = vS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wp"],f:[{type:"textline",a:["wp","=","vT",";"]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_wq"],f:[{type:"textline",a:["wq","=","vV",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_ws"],f:[{type:"textline",a:["ws","=","vX",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wr"],f:[{type:"textline",a:["wr","=","vY",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wt"],f:[{type:"textline",a:["wt","=","vZ",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wu"],f:[{type:"textline",a:["wu","=","v_",";"]}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_wv"],f:[{type:"textline",a:["wv","=","wa",";"]}]}]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"ww",qualifier:["vec3"],c:!1},{type:"node_in",name:"wx",qualifier:["vec3"],c:!1},{type:"node_in",name:"wy",qualifier:["vec3"],c:!1},{type:"node_out",name:"wz",qualifier:["vec4"],c:!1},{type:"node_out",name:"wA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"wz = vec4 ( ww + wy * wx , ZERO_VALUE_NODES ) ; wA = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"wB",qualifier:["vec4"],c:!1},{type:"node_out",name:"wC",qualifier:["vec3"],c:!1},{type:"node_out",name:"wD",qualifier:["vec2"],c:!1},{type:"node_out",name:"wE",qualifier:["vec3"],c:!1},{type:"node_out",name:"wF",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wD = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",
a:["wF","=","vP",";"]}]},{type:"node_else",f:[{type:"textline",a:["wF","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"wE = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",e:2}],f:[{type:"textline",a:"wE *= wB [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",
e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"wk = u_light_positions [ LAMP_IND ] ; wC = wk - vU ;".split(" ")},{type:"textline",a:"wd = length ( wC ) ; wE *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + wd * wd ) ; wC = normalize ( wC ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"wk = u_light_directions [ LAMP_IND ] ; wd = dot ( wC , wk ) ; wd *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( wd - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; wE *= wd ;".split(" ")}]}]}]},
{type:"node_else",f:[{type:"textline",a:"wC = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"wG",qualifier:["vec3"],c:!1},{type:"node_in",name:"wH",qualifier:["vec2"],c:!1},{type:"node_in",name:"wI",qualifier:["vec3"],c:!1},{type:"node_in",name:"wJ",qualifier:["float"],c:!1},{type:"node_in",name:"wK",qualifier:["vec2"],c:!1},{type:"node_out",name:"wL",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wL = ZERO_VALUE_NODES ; if ( wH . r != ZERO_VALUE_NODES ) { wd = ( UNITY_VALUE_NODES - wJ ) * dot ( wI , wG ) + wJ ; if ( wK [ 0 ] == ZERO_VALUE_NODES ) { wL = UNITY_VALUE_NODES ; } else { wd = UNITY_VALUE_NODES + abs ( wd ) ; wd = wK [ 1 ] + ( UNITY_VALUE_NODES - wK [ 1 ] ) * pow ( wd , wK [ 0 ] ) ; wL = clamp ( wd , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } wL = max ( wL , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"wM",qualifier:["vec3"],c:!1},{type:"node_in",name:"wN",qualifier:["vec2"],c:!1},{type:"node_in",name:"wO",qualifier:["vec3"],c:!1},{type:"node_in",name:"wP",qualifier:["float"],c:!1},{type:"node_out",name:"wQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wQ = ZERO_VALUE_NODES ; if ( wN . r != ZERO_VALUE_NODES ) { wd = ( UNITY_VALUE_NODES - wP ) * dot ( wO , wM ) + wP ; wQ = max ( wd , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"wR",qualifier:["vec3"],c:!1},{type:"node_in",name:"wS",qualifier:["vec2"],c:!1},{type:"node_in",name:"wT",qualifier:["vec3"],c:!1},{type:"node_in",name:"wU",qualifier:["float"],c:!1},{type:"node_in",name:"wV",qualifier:["vec2"],c:!1},{type:"node_out",name:"wW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"wW = ZERO_VALUE_NODES ; if ( wS . r != ZERO_VALUE_NODES ) { wd = ( UNITY_VALUE_NODES - wU ) * dot ( wT , wR ) + wU ; if ( wV [ 0 ] > ZERO_VALUE_NODES ) { we = max ( dot ( wT , vW ) , ZERO_VALUE_NODES ) ; wf = wV [ 0 ] * wV [ 0 ] ; wg = UNITY_VALUE_NODES - vP * ( wf / ( wf + 0.33 ) ) ; wk = wR - wd * wT ; wl = vW - we * wT ;".split(" ")},
{type:"textline",a:"if ( length ( wk ) == ZERO_VALUE_NODES || length ( wl ) == ZERO_VALUE_NODES || abs ( wd ) > UNITY_VALUE_NODES || abs ( we ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"wW = wd * wg ; else { wh = acos ( wd ) ; we = acos ( we ) ; wk = normalize ( wk ) ; wl = normalize ( wl ) ; wi = max ( wh , we ) ; wj = min ( wh , we ) ; wj *= 0.95 ; we = max ( dot ( wk , wl ) , ZERO_VALUE_NODES ) ; wf = 0.45 * ( wf / ( wf + 0.09 ) ) ; wW = wd * ( wg + ( wf * we * sin ( wi ) * tan ( wj ) ) ) ; } } else wW = wd ; wW = max ( wW , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"wX",qualifier:["vec3"],c:!1},{type:"node_in",name:"wY",qualifier:["vec2"],c:!1},{type:"node_in",name:"wZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"w_",qualifier:["float"],c:!1},{type:"node_in",name:"xa",qualifier:["vec2"],c:!1},{type:"node_out",name:"xb",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xb = ZERO_VALUE_NODES ; if ( wY . r != ZERO_VALUE_NODES ) { wd = ( UNITY_VALUE_NODES - w_ ) * dot ( wZ , wX ) + w_ ; wj = max ( dot ( wZ , vW ) , ZERO_VALUE_NODES ) ; if ( xa [ 0 ] <= UNITY_VALUE_NODES ) xb = wd * pow ( max ( wj * wd , 0.1 ) , xa [ 0 ] - UNITY_VALUE_NODES ) ; else xb = wd * pow ( 1.0001 - wj , xa [ 0 ] - UNITY_VALUE_NODES ) ; xb = max ( xb , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"xc",qualifier:["vec3"],c:!1},{type:"node_in",name:"xd",qualifier:["vec2"],c:!1},{type:"node_in",name:"xe",qualifier:["vec3"],c:!1},{type:"node_in",name:"xf",qualifier:["float"],c:!1},{type:"node_in",name:"xg",qualifier:["vec2"],c:!1},{type:"node_out",name:"xh",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xh = ZERO_VALUE_NODES ; if ( xd . r != ZERO_VALUE_NODES ) { wj = ( UNITY_VALUE_NODES - xf ) * dot ( xe , xc ) + xf ; wj = acos ( wj ) ; if ( wj < xg [ 0 ] ) xh = UNITY_VALUE_NODES ; else if ( wj > ( xg [ 0 ] + xg [ 1 ] ) || xg [ 1 ] == ZERO_VALUE_NODES ) xh = ZERO_VALUE_NODES ; else xh = UNITY_VALUE_NODES - ( ( wj - xg [ 0 ] ) / xg [ 1 ] ) ; xh = max ( xh , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"xi",qualifier:["vec3"],c:!1},{type:"node_in",name:"xj",qualifier:["vec2"],c:!1},{type:"node_in",name:"xk",qualifier:["vec3"],c:!1},{type:"node_in",name:"xl",qualifier:["float"],c:!1},{type:"node_in",name:"xm",qualifier:["vec2"],c:!1},{type:"node_out",name:"xn",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xn = ZERO_VALUE_NODES ; if ( xj . g != ZERO_VALUE_NODES ) { wl = normalize ( xi + vW ) ; xn = ( UNITY_VALUE_NODES - xl ) * max ( dot ( xk , wl ) , ZERO_VALUE_NODES ) + xl ; xn = pow ( xn , xm [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"xo",qualifier:["vec3"],c:!1},{type:"node_in",name:"xp",qualifier:["vec2"],c:!1},{type:"node_in",name:"xq",qualifier:["vec3"],c:!1},{type:"node_in",name:"xr",qualifier:["vec2"],c:!1},{type:"node_out",name:"xs",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xs = ZERO_VALUE_NODES ; if ( xp . g != ZERO_VALUE_NODES ) { wl = normalize ( xo + vW ) ; wj = max ( dot ( xq , wl ) , 0.001 ) ;".split(" ")},{type:"textline",a:"wd = max ( dot ( xq , vW ) , 0.01 ) ; wi = max ( dot ( xq , xo ) , 0.01 ) ; wj = tan ( acos ( wj ) ) ; we = max ( xr [ 0 ] , 0.001 ) ; xs = wi * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * we * we ) ) * ( exp ( - ( wj * wj ) / ( we * we ) ) / ( sqrt ( wd * wi ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"xt",qualifier:["vec3"],c:!1},{type:"node_in",name:"xu",qualifier:["vec2"],c:!1},{type:"node_in",name:"xv",qualifier:["vec3"],c:!1},{type:"node_in",name:"xw",qualifier:["vec2"],c:!1},{type:"node_out",name:"xx",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xx = ZERO_VALUE_NODES ; if ( xu . g != ZERO_VALUE_NODES ) { wl = normalize ( xt + vW ) ; wi = acos ( dot ( wl , xv ) ) ; if ( wi < xw [ 0 ] ) xx = UNITY_VALUE_NODES ; else if ( wi >= xw [ 0 ] + xw [ 1 ] || xw [ 1 ] == ZERO_VALUE_NODES ) xx = ZERO_VALUE_NODES ; else xx = UNITY_VALUE_NODES - ( wi - xw [ 0 ] ) / xw [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"xy",qualifier:["vec3"],c:!1},{type:"node_in",name:"xz",qualifier:["vec2"],c:!1},{type:"node_in",name:"xA",qualifier:["vec3"],c:!1},{type:"node_in",name:"xB",qualifier:["float"],c:!1},{type:"node_in",name:"xC",qualifier:["vec2"],c:!1},{type:"node_out",name:"xD",qualifier:["float"],c:!1}],f:[{type:"textline",a:"xD = ZERO_VALUE_NODES ; if ( xz . g != ZERO_VALUE_NODES ) { if ( xC [ 0 ] < 1.0 || xC [ 1 ] == ZERO_VALUE_NODES ) xD = ZERO_VALUE_NODES ; else { if ( xC [ 1 ] < 100.0 ) xC [ 1 ] = sqrt ( 1.0 / xC [ 1 ] ) ; else xC [ 1 ] = 10.0 / xC [ 1 ] ; wl = normalize ( vW + xy ) ; wi = ( UNITY_VALUE_NODES - xB ) * max ( dot ( xA , wl ) , ZERO_VALUE_NODES ) + xB ; if ( wi < ZERO_VALUE_NODES ) xD = ZERO_VALUE_NODES ; else { wd = max ( dot ( xA , vW ) , 0.01 ) ; we = dot ( xA , xy ) ; if ( we <= 0.01 ) xD = ZERO_VALUE_NODES ; else { wj = max ( dot ( vW , wl ) , 0.01 ) ; wf = UNITY_VALUE_NODES ; wd = ( 2.0 * wi * wd ) / wj ; we = ( 2.0 * wi * we ) / wj ; we = min ( min ( wf , wd ) , we ) ; wd = sqrt ( pow ( xC [ 0 ] , 2.0 ) + pow ( wj , 2.0 ) - UNITY_VALUE_NODES ) ; wj = pow ( wd - wj , 2.0 ) / pow ( wd + wj , 2.0 ) * ( UNITY_VALUE_NODES + pow ( wj * ( wd + wj ) - UNITY_VALUE_NODES , 2.0 ) / pow ( wj * ( wd - wj ) + UNITY_VALUE_NODES , 2.0 ) ) ; wi = acos ( wi ) ; xD = max ( wj * we * exp ( - pow ( wi , 2.0 ) / ( 2.0 * pow ( xC [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"xE",qualifier:["vec4"],c:!1},{type:"node_in",name:"xF",qualifier:["vec3"],c:!1},{type:"node_in",name:"xG",qualifier:["float"],c:!1},{type:"node_in",name:"xH",qualifier:["float"],c:!1},{type:"node_in",name:"xI",qualifier:["vec3"],c:!1},{type:"node_in",name:"xJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"xK",qualifier:["vec4"],c:!1},{type:"node_in",name:"xL",qualifier:["vec3"],c:!1},{type:"node_in",name:"xM",qualifier:["vec3"],c:!1},{type:"node_in",
name:"xN",qualifier:["vec3"],c:!1},{type:"node_in",name:"xO",qualifier:["float"],c:!1},{type:"node_out",name:"xP",qualifier:["vec4"],c:!1},{type:"node_out",name:"xQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"xQ = xF + xN * xM * xH ; xP = xE + vec4 ( xN * xL * xG , xH ) ;".split(" ")}]},{type:"node",name:"LIGHTING_END",h:[{type:"node_in",name:"xR",qualifier:["vec4"],c:!1},{type:"node_in",name:"xS",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"wb = xR . rgb ; wc = xS ;".split(" ")}]},{type:"nodes_global"},
{type:"textline",a:"void xT ( vec3 vQ , vec3 vR , vec3 vS , vec3 vT , vec3 vU , vec3 vV , vec3 vW , vec2 vX , vec2 vY , vec4 vZ , float v_ , vec4 wa , out vec3 wb , out vec3 wc ) { float wd , we , wf , wg , wh , wi , wj ; vec3 wk , wl ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/particles_nodes.glslf"]={type:"group",b:[{type:"var",name:"MAPPING_TRS_MATRIX",a:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",
a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",a:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",a:["0.0"]},{type:"var",name:"RGB_IND",a:["0"]},{type:"var",name:"VALUE_IND",a:["0"]},{type:"var",name:"LAMP_INDEX",a:["0"]},{type:"var",name:"NUM_LIGHTS",a:["0"]},{type:"var",name:"LAMP_IND",a:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",a:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",a:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",
a:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",a:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",a:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",a:["0"]},{type:"var",name:"NODE_TEX_ROW",a:["0.0"]},{type:"define",name:"M_PI",a:["3.14159265359"]},{type:"textline",a:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float xU = 0.5 ;".split(" ")},{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR",
"USE_NODE_SEPHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 xZ ( vec3 xV ) { float xW , xX ; vec4 xY ; xY = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; xY = mix ( vec4 ( xV . bg , xY . wz ) , vec4 ( xV . gb , xY . xy ) , step ( xV . b , xV . g ) ) ; xY = mix ( vec4 ( xY . xyw , xV . r ) , vec4 ( xV . r , xY . yzx ) , step ( xY . x , xV . r ) ) ; xW = xY . x - min ( xY . w , xY . y ) ; xX = 1.0e-10 ; return vec3 ( abs ( xY . z + ( xY . w - xY . y ) / ( 6.0 * xW + xX ) ) , xW / ( xY . x + xX ) , xY . x ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",e:6}],group:{type:"group",b:[{type:"textline",a:"vec3 yc ( vec3 x_ ) { vec3 ya ; vec4 yb ; yb = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; ya = abs ( fract ( vec3 ( x_ . r , x_ . r , x_ . r ) + yb . xyz ) * 6.0 - yb . www ) ; return x_ . b * mix ( yb . xxx , clamp ( ya - yb . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , x_ . g ) ; }".split(" ")}]}}]},
{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec3 ye ( vec2 yd ) { return vec3 ( yd * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",e:3}],group:{type:"group",b:[{type:"textline",a:"vec2 yg ( vec3 yf ) { return vec2 ( yf . xy * xU + vec2 ( xU , xU ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",h:[{type:"node_out",name:"yV",qualifier:["vec3"],c:!0},{type:"node_out",name:"yW",qualifier:["float"],c:!0},{type:"node_out",name:"yX",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yV"],f:[{type:"textline",a:"yV = normalize ( yM . xyz ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yW"],f:[{type:"textline",a:"yW = abs ( yM . z ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_yX"],
f:[{type:"textline",a:"yX = length ( yM . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",h:[{type:"node_in",name:"yY",qualifier:["float"],c:!1},{type:"node_in",name:"yZ",qualifier:["float"],c:!1},{type:"node_in",name:"y_",qualifier:["float"],c:!1},{type:"node_out",name:"za",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"za = vec3 ( yY , yZ , y_ ) ;".split(" ")}]},{type:"node",name:"COMBHSV",h:[{type:"node_in",name:"zb",qualifier:["float"],c:!1},{type:"node_in",name:"zc",qualifier:["float"],
c:!1},{type:"node_in",name:"zd",qualifier:["float"],c:!1},{type:"node_out",name:"ze",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"ze = yc ( vec3 ( zb , zc , zd ) ) ;".split(" ")}]},{type:"node",name:"EMPTY_UV",h:[{type:"node_out",name:"zf",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zf = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"EMPTY_VC",h:[{type:"node_out",name:"zg",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zg = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[{type:"node_out",name:"zh",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zh = ye ( bM ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",h:[{type:"node_out",name:"zi",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zi = 2.0 * vec3 ( bM , ZERO_VALUE_NODES ) - vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_out",name:"zj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zj = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_out",name:"zk",qualifier:["float"],c:!1}],f:[{type:"textline",a:["zk","=","UNITY_VALUE_NODES",";"]}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_out",name:"zl",qualifier:["float"],c:!1},{type:"node_out",name:"zm",qualifier:["float"],c:!1}],f:[{type:"textline",a:"zl = UNITY_VALUE_NODES ; zm = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_out",name:"zn",qualifier:["float"],c:!1},{type:"node_out",name:"zo",qualifier:["float"],
c:!1},{type:"node_out",name:"zp",qualifier:["float"],c:!1}],f:[{type:"textline",a:"zn = UNITY_VALUE_NODES ; zo = UNITY_VALUE_NODES ; zp = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_NO",h:[{type:"node_out",name:"zq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zq = yP . xzy ; zq . y *= - 1.0 ;".split(" ")}]},{type:"node",name:"GEOMETRY_FB",h:[{type:"node_out",name:"zr",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["INVERT_FRONTFACING"],f:[{type:"textline",
a:"zr = ( gl_FrontFacing ) ? ZERO_VALUE_NODES : UNITY_VALUE_NODES ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"zr = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]}]}]},{type:"node",name:"GEOMETRY_VW",h:[{type:"node_out",name:"zs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zs = - ( yr * vec4 ( yq , 0.0 ) ) . xyz ;".split(" ")}]},{type:"node",name:"GEOMETRY_LO",h:[{type:"node_out",name:"zt",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zt [ 0 ] = yM [ 0 ] ; zt [ 1 ] = yM [ 1 ] ; zt [ 2 ] = yM [ 2 ] ;".split(" ")}]},
{type:"node",name:"GEOMETRY_GL",h:[{type:"node_out",name:"zu",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zu = vec3 ( yQ . r , - yQ . b , yQ . g ) ;".split(" ")}]},{type:"node",name:"NEW_GEOMETRY",h:[{type:"node_out",name:"zv",qualifier:["vec3"],c:!1},{type:"node_out",name:"zw",qualifier:["vec3"],c:!1},{type:"node_out",name:"zx",qualifier:["vec3"],c:!1},{type:"node_out",name:"zy",qualifier:["vec3"],c:!1},{type:"node_out",name:"zz",qualifier:["vec3"],c:!1},{type:"node_out",name:"zA",qualifier:["vec3"],
c:!1},{type:"node_out",name:"zB",qualifier:["float"],c:!1},{type:"node_out",name:"zC",qualifier:["float"],c:!1}],f:[{type:"textline",a:"zv = vec3 ( ZERO_VALUE_NODES ) ; zw = vec3 ( ZERO_VALUE_NODES ) ; zx = vec3 ( ZERO_VALUE_NODES ) ; zy = vec3 ( ZERO_VALUE_NODES ) ; zz = vec3 ( ZERO_VALUE_NODES ) ; zA = vec3 ( ZERO_VALUE_NODES ) ; zB = ZERO_VALUE_NODES ; zC = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"HUE_SAT",h:[{type:"node_in",name:"zD",qualifier:["float"],c:!1},{type:"node_in",name:"zE",
qualifier:["float"],c:!1},{type:"node_in",name:"zF",qualifier:["float"],c:!1},{type:"node_in",name:"zG",qualifier:["float"],c:!1},{type:"node_in",name:"zH",qualifier:["vec3"],c:!1},{type:"node_out",name:"zI",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yS = xZ ( zH ) ; yS [ 0 ] += ( zD - xU ) ; if ( yS [ 0 ] > UNITY_VALUE_NODES ) yS [ 0 ] -= UNITY_VALUE_NODES ; else if ( yS [ 0 ] < ZERO_VALUE_NODES ) yS [ 0 ] += UNITY_VALUE_NODES ; yS *= vec3 ( UNITY_VALUE_NODES , zE , zF ) ; yS = mix ( vec3 ( UNITY_VALUE_NODES ) , mix ( vec3 ( ZERO_VALUE_NODES ) , yS , step ( vec3 ( ZERO_VALUE_NODES ) , yS ) ) , step ( yS , vec3 ( UNITY_VALUE_NODES ) ) ) ; zI = mix ( zH , yc ( yS ) , zG ) ;".split(" ")}]},
{type:"node",name:"INVERT",h:[{type:"node_in",name:"zJ",qualifier:["float"],c:!1},{type:"node_in",name:"zK",qualifier:["vec3"],c:!1},{type:"node_out",name:"zL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zL = mix ( zK , vec3 ( UNITY_VALUE_NODES ) - zK , zJ ) ;".split(" ")}]},{type:"node",name:"LAMP",h:[{type:"node_out",name:"zM",qualifier:["vec3"],c:!0},{type:"node_out",name:"zN",qualifier:["vec3"],c:!1},{type:"node_out",name:"zO",qualifier:["float"],c:!1},{type:"node_out",name:"zP",qualifier:["float"],
c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zM"],f:[{type:"textline",a:"zM = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",a:"yN = u_lamp_light_factors [ LAMP_INDEX ] ; yS = u_lamp_light_directions [ LAMP_INDEX ] ; yT = u_lamp_light_positions [ LAMP_INDEX ] ; yF = yN . z ; if ( yF != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",a:"zN = bC - yT ; zO = length ( zN ) ; zN = normalize ( zN ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_zP"],f:[{type:"textline",a:"zP = yF / ( yF + zO * zO ) ; yF = yN . x ; yG = yN . y ; if ( yF > - UNITY_VALUE_NODES ) { yH = dot ( - zN , yS ) ; yH *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( yH - yF ) / yG ) ; zP *= yH ; }".split(" ")}]}]},{type:"textline",a:["}","else","{"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zN"],f:[{type:"textline",a:["zN","=","yS",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zO"],f:[{type:"textline",a:"zO = length ( yT - bC ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zP"],f:[{type:"textline",a:["zP","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",a:["}"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zN"],f:[{type:"textline",a:"zN . yz = vec2 ( - zN . z , zN . y ) ;".split(" ")}]}]}]},{type:"node",name:"NORMAL",h:[{type:"node_in",name:"zQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"zR",qualifier:["vec3"],c:!0},{type:"node_out",name:"zS",qualifier:["float"],c:!0},{type:"node_param",name:"yh",
qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zR"],f:[{type:"textline",a:["zR","=","yh",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_zS"],f:[{type:"textline",a:"zS = - dot ( zQ , yh ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",h:[{type:"node_in",name:"zT",qualifier:["vec3"],c:!1},{type:"node_out",name:"zU",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"zU = - ( ys * vec4 ( zT , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",
name:"BSDF_ANISOTROPIC",h:[{type:"node_in",name:"zV",qualifier:["vec3"],c:!1},{type:"node_in",name:"zW",qualifier:["float"],c:!1},{type:"node_in",name:"zX",qualifier:["float"],c:!1},{type:"node_in",name:"zY",qualifier:["float"],c:!1},{type:"node_in",name:"zZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"z_",qualifier:["vec3"],c:!1},{type:"node_out",name:"Aa",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Aa","=","zV",";"]},{type:"textline",a:"zW ; zX ; zY ; zZ ; z_ ;".split(" ")}]},{type:"node",
name:"BSDF_DIFFUSE",h:[{type:"node_in",name:"Ab",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ac",qualifier:["float"],c:!1},{type:"node_in",name:"Ad",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ae",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Ae","=","Ab",";"]},{type:"textline",a:["Ac",";","Ad",";"]}]},{type:"node",name:"BSDF_GLASS",h:[{type:"node_in",name:"Af",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ag",qualifier:["float"],c:!1},{type:"node_in",name:"Ah",qualifier:["float"],c:!1},
{type:"node_in",name:"Ai",qualifier:["vec3"],c:!1},{type:"node_out",name:"Aj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Aj","=","Af",";"]},{type:"textline",a:"Ag ; Ah ; Ai ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",h:[{type:"node_in",name:"Ak",qualifier:["vec3"],c:!1},{type:"node_in",name:"Al",qualifier:["float"],c:!1},{type:"node_in",name:"Am",qualifier:["vec3"],c:!1},{type:"node_out",name:"An",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["An","=","Ak",";"]},{type:"textline",a:["Al",
";","Am",";"]}]},{type:"node",name:"BSDF_HAIR",h:[{type:"node_in",name:"Ao",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ap",qualifier:["float"],c:!1},{type:"node_in",name:"Aq",qualifier:["float"],c:!1},{type:"node_in",name:"Ar",qualifier:["float"],c:!1},{type:"node_out",name:"As",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["As","=","Ao",";"]},{type:"textline",a:"Ap ; Aq ; Ar ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",h:[{type:"node_in",name:"At",qualifier:["vec3"],c:!1},{type:"node_out",
name:"Au",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Au","=","At",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",h:[{type:"node_in",name:"Av",qualifier:["vec3"],c:!1},{type:"node_in",name:"Aw",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ax",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Ax","=","Av",";"]},{type:"textline",a:["Aw",";"]}]},{type:"node",name:"BSDF_REFRACTION",h:[{type:"node_in",name:"Ay",qualifier:["vec3"],c:!1},{type:"node_in",name:"Az",qualifier:["float"],c:!1},{type:"node_in",
name:"AA",qualifier:["float"],c:!1},{type:"node_in",name:"AB",qualifier:["vec3"],c:!1},{type:"node_out",name:"AC",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AC [ 0 ] = AC [ 1 ] = AC [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"Ay ; Az ; AA ; AB ;".split(" ")}]},{type:"node",name:"BSDF_TOON",h:[{type:"node_in",name:"AD",qualifier:["vec3"],c:!1},{type:"node_in",name:"AE",qualifier:["float"],c:!1},{type:"node_in",name:"AF",qualifier:["float"],c:!1},{type:"node_in",name:"AG",qualifier:["vec3"],
c:!1},{type:"node_out",name:"AH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AH","=","AD",";"]},{type:"textline",a:"AE ; AF ; AG ;".split(" ")}]},{type:"node",name:"BSDF_VELVET",h:[{type:"node_in",name:"AI",qualifier:["vec3"],c:!1},{type:"node_in",name:"AJ",qualifier:["float"],c:!1},{type:"node_in",name:"AK",qualifier:["vec3"],c:!1},{type:"node_out",name:"AL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AL","=","AI",";"]},{type:"textline",a:["AJ",";","AK",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",
h:[{type:"node_in",name:"AM",qualifier:["vec3"],c:!1},{type:"node_in",name:"AN",qualifier:["float"],c:!1},{type:"node_in",name:"AO",qualifier:["vec3"],c:!1},{type:"node_in",name:"AP",qualifier:["float"],c:!1},{type:"node_in",name:"AQ",qualifier:["float"],c:!1},{type:"node_in",name:"AR",qualifier:["vec3"],c:!1},{type:"node_out",name:"AS",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AS [ 0 ] = AS [ 1 ] = AS [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"AM ; AO ; AP ; AQ ; AR ; AN ;".split(" ")}]},
{type:"node",name:"EMISSION",h:[{type:"node_in",name:"AT",qualifier:["vec3"],c:!1},{type:"node_in",name:"AU",qualifier:["float"],c:!1},{type:"node_out",name:"AV",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["AV","=","AT",";"]},{type:"textline",a:["AU",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",h:[{type:"node_in",name:"AW",qualifier:["vec3"],c:!1},{type:"node_out",name:"AX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AX [ 0 ] = AX [ 1 ] = AX [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",
a:["AW",";"]}]},{type:"node",name:"HOLDOUT",h:[{type:"node_out",name:"AY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"AY [ 0 ] = AY [ 1 ] = AY [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",h:[{type:"node_in",name:"AZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"A_",qualifier:["float"],c:!1},{type:"node_out",name:"Ba",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Ba [ 0 ] = Ba [ 1 ] = Ba [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["AZ",";",
"A_",";"]}]},{type:"node",name:"VOLUME_SCATTER",h:[{type:"node_in",name:"Bb",qualifier:["vec3"],c:!1},{type:"node_in",name:"Bc",qualifier:["float"],c:!1},{type:"node_in",name:"Bd",qualifier:["float"],c:!1},{type:"node_out",name:"Be",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Be [ 0 ] = Be [ 1 ] = Be [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:"Bb ; Bc ; Bd ;".split(" ")}]},{type:"node",name:"BUMP",h:[{type:"node_in",name:"Bf",qualifier:["float"],c:!1},{type:"node_in",name:"Bg",
qualifier:["float"],c:!1},{type:"node_in",name:"Bh",qualifier:["float"],c:!1},{type:"node_in",name:"Bi",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Bj","=","Bi",";"]},{type:"textline",a:"Bf ; Bg ; Bh ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",h:[{type:"node_in",name:"Bk",qualifier:["float"],c:!1},{type:"node_in",name:"Bl",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bm",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Bm","=","Bl",
";"]},{type:"textline",a:["Bk",";"]}]},{type:"node",name:"VECT_TRANSFORM",h:[{type:"node_in",name:"Bn",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bo",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{type:"equal_expr",e:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{type:"equal_expr",e:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],f:[{type:"textline",a:["Bo","=","Bn",";"]}]},{type:"node_else",
f:[{type:"node_condition",b:[{type:"node_if",d:["VECTOR_TYPE","VT_POINT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"yN = vec4 ( Bn , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"yN = vec4 ( Bn , ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( ys * yN ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{type:"equal_expr",
e:2}],f:[{type:"textline",a:"Bo = ( yv * yN ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( yu * yN ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( ys * yu * yN ) . xyz ;".split(" ")}]},{type:"node_elif",d:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( yt * yN ) . xyz ;".split(" ")}]},
{type:"node_elif",d:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = ( yv * yt * yN ) . xyz ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["VECTOR_TYPE","VT_NORMAL",{type:"equal_expr",e:2}],f:[{type:"textline",a:"Bo = normalize ( Bo ) ;".split(" ")}]}]}]}]}]},{type:"node",name:"BLACKBODY",h:[{type:"node_in",name:"Bp",qualifier:["float"],c:!1},{type:"node_out",name:"Bq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Bq [ 0 ] = Bq [ 1 ] = Bq [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["Bp",";"]}]},{type:"node",name:"WAVELENGTH",h:[{type:"node_in",name:"Br",qualifier:["float"],c:!1},{type:"node_out",name:"Bs",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Bs [ 0 ] = Bs [ 1 ] = Bs [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["Br",";"]}]},{type:"node",name:"SEPXYZ",h:[{type:"node_in",name:"Bt",qualifier:["vec3"],c:!1},{type:"node_out",name:"Bu",qualifier:["float"],c:!1},{type:"node_out",name:"Bv",qualifier:["float"],c:!1},{type:"node_out",name:"Bw",
qualifier:["float"],c:!1}],f:[{type:"textline",a:"Bu = Bt [ 0 ] ; Bv = Bt [ 1 ] ; Bw = Bt [ 2 ] ;".split(" ")}]},{type:"node",name:"COMBXYZ",h:[{type:"node_in",name:"Bx",qualifier:["float"],c:!1},{type:"node_in",name:"By",qualifier:["float"],c:!1},{type:"node_in",name:"Bz",qualifier:["float"],c:!1},{type:"node_out",name:"BA",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"BA [ 0 ] = Bx ; BA [ 1 ] = By ; BA [ 2 ] = Bz ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",h:[{type:"node_in",name:"BB",
qualifier:["vec3"],c:!1},{type:"node_in",name:"BC",qualifier:["float"],c:!1},{type:"node_in",name:"BD",qualifier:["float"],c:!1},{type:"node_out",name:"BE",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yH = BC - BD * xU ; BE = max ( ( UNITY_VALUE_NODES + BD ) * BB + yH , vec3 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",h:[{type:"node_in",name:"BF",qualifier:["float"],c:!1},{type:"node_in",name:"BG",qualifier:["float"],c:!1},{type:"node_out",name:"BH",qualifier:["float"],
c:!1},{type:"node_out",name:"BI",qualifier:["float"],c:!1},{type:"node_out",name:"BJ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BH = BI = BJ = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["BF",";","BG",";"]}]},{type:"node",name:"TEX_IMAGE",h:[{type:"node_in",name:"BK",qualifier:["vec3"],c:!1},{type:"node_out",name:"BL",qualifier:["vec3"],c:!1},{type:"node_out",name:"BM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BL [ 0 ] = BL [ 1 ] = BL [ 2 ] = ZERO_VALUE_NODES ; BM = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:["BK",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",h:[{type:"node_in",name:"BN",qualifier:["vec3"],c:!1},{type:"node_out",name:"BO",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"BO [ 0 ] = BO [ 1 ] = BO [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",a:["BN",";"]}]},{type:"node",name:"TEX_SKY",h:[{type:"node_in",name:"BP",qualifier:["vec3"],c:!1},{type:"node_out",name:"BQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"BQ [ 0 ] = BQ [ 1 ] = BQ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["BP",";"]}]},{type:"node",name:"TEX_NOISE",h:[{type:"node_in",name:"BR",qualifier:["vec3"],c:!1},{type:"node_in",name:"BS",qualifier:["float"],c:!1},{type:"node_in",name:"BT",qualifier:["float"],c:!1},{type:"node_in",name:"BU",qualifier:["float"],c:!1},{type:"node_out",name:"BV",qualifier:["vec3"],c:!1},{type:"node_out",name:"BW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"BV [ 0 ] = BV [ 1 ] = BV [ 2 ] = ZERO_VALUE_NODES ; BW = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
a:"BR ; BS ; BT ; BU ;".split(" ")}]},{type:"node",name:"TEX_WAVE",h:[{type:"node_in",name:"BX",qualifier:["vec3"],c:!1},{type:"node_in",name:"BY",qualifier:["float"],c:!1},{type:"node_in",name:"BZ",qualifier:["float"],c:!1},{type:"node_in",name:"B_",qualifier:["float"],c:!1},{type:"node_in",name:"Ca",qualifier:["float"],c:!1},{type:"node_out",name:"Cb",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cc",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cb [ 0 ] = Cb [ 1 ] = Cb [ 2 ] = ZERO_VALUE_NODES ; Cc = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"BX ; BY ; BZ ; B_ ; Ca ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",h:[{type:"node_in",name:"Cd",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ce",qualifier:["float"],c:!1},{type:"node_out",name:"Cf",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cg",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cf [ 0 ] = Cf [ 1 ] = Cf [ 2 ] = ZERO_VALUE_NODES ; Cg = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["Cd",";","Ce",";"]}]},{type:"node",name:"TEX_MUSGRAVE",h:[{type:"node_in",
name:"Ch",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ci",qualifier:["float"],c:!1},{type:"node_in",name:"Cj",qualifier:["float"],c:!1},{type:"node_in",name:"Ck",qualifier:["float"],c:!1},{type:"node_in",name:"Cl",qualifier:["float"],c:!1},{type:"node_in",name:"Cm",qualifier:["float"],c:!1},{type:"node_in",name:"Cn",qualifier:["float"],c:!1},{type:"node_out",name:"Co",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cp",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Co [ 0 ] = Co [ 1 ] = Co [ 2 ] = ZERO_VALUE_NODES ; Cp = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"Ch ; Ci ; Cj ; Ck ; Cl ; Cm ; Cn ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",h:[{type:"node_in",name:"Cq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cr",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cs",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cr [ 0 ] = Cr [ 1 ] = Cr [ 2 ] = ZERO_VALUE_NODES ; Cs = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:["Cq",";"]}]},{type:"node",name:"TEX_MAGIC",h:[{type:"node_in",name:"Ct",qualifier:["vec3"],c:!1},{type:"node_in",
name:"Cu",qualifier:["float"],c:!1},{type:"node_in",name:"Cv",qualifier:["float"],c:!1},{type:"node_out",name:"Cw",qualifier:["vec3"],c:!1},{type:"node_out",name:"Cx",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Cw [ 0 ] = Cw [ 1 ] = Cw [ 2 ] = ZERO_VALUE_NODES ; Cx = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"Ct ; Cu ; Cv ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",h:[{type:"node_in",name:"Cy",qualifier:["vec3"],c:!1},{type:"node_in",name:"Cz",qualifier:["vec3"],c:!1},{type:"node_in",
name:"CA",qualifier:["vec3"],c:!1},{type:"node_in",name:"CB",qualifier:["float"],c:!1},{type:"node_out",name:"CC",qualifier:["vec3"],c:!1},{type:"node_out",name:"CD",qualifier:["float"],c:!1}],f:[{type:"textline",a:"CC [ 0 ] = CC [ 1 ] = CC [ 2 ] = ZERO_VALUE_NODES ; CD = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",a:"Cy ; Cz ; CA ; CB ;".split(" ")}]},{type:"node",name:"TEX_BRICK",h:[{type:"node_in",name:"CE",qualifier:["vec3"],c:!1},{type:"node_in",name:"CF",qualifier:["vec3"],c:!1},{type:"node_in",
name:"CG",qualifier:["vec3"],c:!1},{type:"node_in",name:"CH",qualifier:["vec3"],c:!1},{type:"node_in",name:"CI",qualifier:["float"],c:!1},{type:"node_in",name:"CJ",qualifier:["float"],c:!1},{type:"node_in",name:"CK",qualifier:["float"],c:!1},{type:"node_in",name:"CL",qualifier:["float"],c:!1},{type:"node_in",name:"CM",qualifier:["float"],c:!1},{type:"node_out",name:"CN",qualifier:["vec3"],c:!1},{type:"node_out",name:"CO",qualifier:["float"],c:!1}],f:[{type:"textline",a:"CN [ 0 ] = CN [ 1 ] = CN [ 2 ] = ZERO_VALUE_NODES ; CO = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",a:"CE ; CF ; CG ; CH ; CI ; CJ ; CK ; CL ; CM ;".split(" ")}]},{type:"node",name:"ADD_SHADER",h:[{type:"node_in",name:"CP",qualifier:["vec3"],c:!1},{type:"node_in",name:"CQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"CR",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CR = clamp ( CP + CQ , vec3 ( ZERO_VALUE_NODES ) , vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",h:[{type:"node_in",name:"CS",qualifier:["float"],c:!1},{type:"node_in",name:"CT",
qualifier:["vec3"],c:!1},{type:"node_in",name:"CU",qualifier:["vec3"],c:!1},{type:"node_out",name:"CV",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yH = clamp ( CS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; CV = yH * CT + ( UNITY_VALUE_NODES - yH ) * CU ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[{type:"node_out",name:"CW",qualifier:["vec3"],c:!1},{type:"node_out",name:"CX",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CW"],f:[{type:"textline",a:"CW = ye ( bM ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_CX"],f:[{type:"textline",a:"CX = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_out",name:"CY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"CY = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",h:[{type:"node_out",name:"CZ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["CZ","=","yR",";"]}]},{type:"node",name:"TEX_COORD_GE",h:[{type:"node_out",name:"C_",
qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"C_ = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_OB",h:[{type:"node_out",name:"Da",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Da [ 0 ] = Da [ 1 ] = Da [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",h:[{type:"node_out",name:"Db",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Db [ 0 ] = yM [ 0 ] ; Db [ 1 ] = yM [ 1 ] ; Db [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_WI",
h:[{type:"node_out",name:"Dc",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dc [ 0 ] = Dc [ 1 ] = Dc [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",h:[{type:"node_out",name:"Dd",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dd [ 0 ] = Dd [ 1 ] = Dd [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",h:[{type:"node_out",name:"De",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"De = vec3 ( bM , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",
h:[{type:"node_out",name:"Df",qualifier:["float"],c:!1},{type:"node_out",name:"Dg",qualifier:["float"],c:!1},{type:"node_out",name:"Dh",qualifier:["float"],c:!1},{type:"node_out",name:"Di",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dj",qualifier:["float"],c:!1},{type:"node_out",name:"Dk",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dl",qualifier:["vec3"],c:!1},{type:"node_param",name:"yi",qualifier:["varying","vec4"],c:!0},{type:"node_param",name:"yj",qualifier:["varying","vec3"],c:!0},{type:"node_param",
name:"yk",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"yl",qualifier:["varying","vec3"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["PARTICLE_BATCH"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Df"],f:[{type:"textline",a:"Df = yi [ 0 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dg"],f:[{type:"textline",a:"Dg = yi [ 1 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dh"],f:[{type:"textline",a:"Dh = yi [ 2 ] ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Di"],f:[{type:"textline",a:"Di = vec3 ( yj . r , - yj . b , yj . g ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dj"],f:[{type:"textline",a:"Dj = yi [ 3 ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dk"],f:[{type:"textline",a:"Dk = vec3 ( yk . r , - yk . b , yk . g ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Dl"],f:[{type:"textline",a:"Dl = vec3 ( yl . r , - yl . b , yl . g ) ;".split(" ")}]}]}]},
{type:"node_else",f:[{type:"textline",a:"Df = ZERO_VALUE_NODES ; Dg = ZERO_VALUE_NODES ; Dh = ZERO_VALUE_NODES ; Di = vec3 ( ZERO_VALUE_NODES ) ; Dj = ZERO_VALUE_NODES ; Dk = Di ; Dl = Di ;".split(" ")}]}]}]},{type:"node",name:"HAIR_INFO",h:[{type:"node_out",name:"Dm",qualifier:["float"],c:!1},{type:"node_out",name:"Dn",qualifier:["float"],c:!1},{type:"node_out",name:"Do",qualifier:["float"],c:!1},{type:"node_out",name:"Dp",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dm = ZERO_VALUE_NODES ; Dn = ZERO_VALUE_NODES ; Do = ZERO_VALUE_NODES ; Dp = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",h:[{type:"node_out",name:"Dq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dr",qualifier:["float"],c:!1},{type:"node_out",name:"Ds",qualifier:["float"],c:!1},{type:"node_out",name:"Dt",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Dr = ZERO_VALUE_NODES ; Ds = ZERO_VALUE_NODES ; Dt = ZERO_VALUE_NODES ; Dq = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",h:[{type:"node_in",name:"Du",qualifier:["float"],c:!1},{type:"node_out",name:"Dv",
qualifier:["float"],c:!1}],f:[{type:"textline",a:["Dv","=","Du",";"]}]},{type:"node",name:"TANGENT",h:[{type:"node_out",name:"Dw",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Dw = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",h:[{type:"node_in",name:"Dx",qualifier:["float"],c:!1},{type:"node_in",name:"Dy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Dz",qualifier:["float"],c:!1},{type:"node_out",name:"DA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Dz = DA = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",a:["Dy",";","Dx",";"]}]},{type:"node",name:"LIGHT_PATH",h:[{type:"node_out",name:"DB",qualifier:["float"],c:!1},{type:"node_out",name:"DC",qualifier:["float"],c:!1},{type:"node_out",name:"DD",qualifier:["float"],c:!1},{type:"node_out",name:"DE",qualifier:["float"],c:!1},{type:"node_out",name:"DF",qualifier:["float"],c:!1},{type:"node_out",name:"DG",qualifier:["float"],c:!1},{type:"node_out",name:"DH",qualifier:["float"],c:!1},{type:"node_out",name:"DI",qualifier:["float"],c:!1},{type:"node_out",
name:"DJ",qualifier:["float"],c:!1},{type:"node_out",name:"DK",qualifier:["float"],c:!1}],f:[{type:"textline",a:"DB = DC = DD = ZERO_VALUE_NODES ; DE = DF = DG = ZERO_VALUE_NODES ; DH = DH = DJ = DK = ZERO_VALUE_NODES ; DI = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",h:[{type:"node_out",name:"DL",qualifier:["vec3"],c:!1},{type:"node_out",name:"DM",qualifier:["vec3"],c:!1},{type:"node_out",name:"DN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"DL = DM = vec3 ( ZERO_VALUE_NODES ) ; DN = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",h:[],f:[]},{type:"node",name:"CURVE_VEC",h:[{type:"node_in",name:"DO",qualifier:["float"],c:!1},{type:"node_in",name:"DP",qualifier:["vec3"],c:!1},{type:"node_out",name:"DQ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["DQ","=","DP",";"]},{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"DQ . r = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * DP . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["READ_G"],f:[{type:"textline",a:"DQ . g = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * DP . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"DQ . b = ( texture2D ( u_nodes_texture , vec2 ( 0.5 * DP . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{type:"textline",a:"DQ = mix ( DP , DQ , DO ) ;".split(" ")}]},{type:"node",name:"CURVE_RGB",h:[{type:"node_in",name:"DR",qualifier:["float"],
c:!1},{type:"node_in",name:"DS",qualifier:["vec3"],c:!1},{type:"node_out",name:"DT",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["READ_A"],f:[{type:"textline",a:"yH = texture2D ( u_nodes_texture , vec2 ( DS . r , NODE_TEX_ROW ) ) . a ; yG = texture2D ( u_nodes_texture , vec2 ( DS . g , NODE_TEX_ROW ) ) . a ; yF = texture2D ( u_nodes_texture , vec2 ( DS . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"yH = DS . r ; yG = DS . g ; yF = DS . b ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["READ_R"],f:[{type:"textline",a:"DT . r = texture2D ( u_nodes_texture , vec2 ( yH , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DT . r = yH ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["READ_G"],f:[{type:"textline",a:"DT . g = texture2D ( u_nodes_texture , vec2 ( yG , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DT . g = yG ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["READ_B"],f:[{type:"textline",a:"DT . b = texture2D ( u_nodes_texture , vec2 ( yF , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"DT . b = yF ;".split(" ")}]}]},{type:"textline",a:"DT = mix ( DS , DT , DR ) ;".split(" ")}]},{type:"node",name:"VALTORGB",h:[{type:"node_in",name:"DU",qualifier:["float"],c:!1},{type:"node_out",name:"DV",qualifier:["vec3"],c:!1},{type:"node_out",name:"DW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yN = texture2D ( u_nodes_texture , vec2 ( DU , NODE_TEX_ROW ) ) ; DV = yN . rgb ; DW = yN . a ;".split(" ")}]},
{type:"node",name:"MAPPING",h:[{type:"node_in",name:"DX",qualifier:["vec3"],c:!1},{type:"node_out",name:"DY",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["DY","=","DX",";"]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",f:[{type:"textline",a:"DY = ( MAPPING_TRS_MATRIX * vec4 ( DY , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_SCALE",f:[{type:"textline",a:"DY = DY * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",f:[{type:"textline",a:"DY = DY + MAPPING_TRANSLATION ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",f:[{type:"textline",a:"DY = max ( DY , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",f:[{type:"textline",a:"DY = min ( DY , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MAPPING_IS_NORMAL"],f:[{type:"textline",a:"DY = normalize ( DY ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_ADD",h:[{type:"node_in",name:"DZ",qualifier:["float"],c:!1},{type:"node_in",name:"D_",qualifier:["float"],c:!1},{type:"node_out",name:"Ea",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ea = DZ + D_ ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ea = clamp ( Ea , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",h:[{type:"node_in",name:"Eb",qualifier:["float"],c:!1},{type:"node_in",
name:"Ec",qualifier:["float"],c:!1},{type:"node_out",name:"Ed",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ed = Eb - Ec ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ed = clamp ( Ed , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",h:[{type:"node_in",name:"Ee",qualifier:["float"],c:!1},{type:"node_in",name:"Ef",qualifier:["float"],c:!1},{type:"node_out",name:"Eg",qualifier:["float"],c:!1}],f:[{type:"textline",
a:"Eg = Ee * Ef ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Eg = clamp ( Eg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",h:[{type:"node_in",name:"Eh",qualifier:["float"],c:!1},{type:"node_in",name:"Ei",qualifier:["float"],c:!1},{type:"node_out",name:"Ej",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ej = ( Ei != ZERO_VALUE_NODES ) ? Eh / Ei : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ej = clamp ( Ej , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SINE",h:[{type:"node_in",name:"Ek",qualifier:["float"],c:!1},{type:"node_in",name:"El",qualifier:["float"],c:!1},{type:"node_out",name:"Em",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Em = sin ( Ek ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Em = clamp ( Em , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["El",";"]}]},{type:"node",name:"MATH_COSINE",h:[{type:"node_in",name:"En",qualifier:["float"],c:!1},{type:"node_in",name:"Eo",qualifier:["float"],c:!1},{type:"node_out",name:"Ep",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ep = cos ( En ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ep = clamp ( Ep , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Eo",";"]}]},{type:"node",name:"MATH_TANGENT",
h:[{type:"node_in",name:"Eq",qualifier:["float"],c:!1},{type:"node_in",name:"Er",qualifier:["float"],c:!1},{type:"node_out",name:"Es",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Es = tan ( Eq ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Es = clamp ( Es , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Er",";"]}]},{type:"node",name:"MATH_ARCSINE",h:[{type:"node_in",name:"Et",qualifier:["float"],c:!1},{type:"node_in",
name:"Eu",qualifier:["float"],c:!1},{type:"node_out",name:"Ev",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ev = ( Et <= UNITY_VALUE_NODES && Et >= - UNITY_VALUE_NODES ) ? asin ( Et ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ev = clamp ( Ev , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Eu",";"]}]},{type:"node",name:"MATH_ARCCOSINE",h:[{type:"node_in",name:"Ew",qualifier:["float"],
c:!1},{type:"node_in",name:"Ex",qualifier:["float"],c:!1},{type:"node_out",name:"Ey",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ey = ( Ew <= UNITY_VALUE_NODES && Ew >= - UNITY_VALUE_NODES ) ? acos ( Ew ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Ey = clamp ( Ey , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["Ex",";"]}]},{type:"node",name:"MATH_ARCTANGENT",h:[{type:"node_in",name:"Ez",
qualifier:["float"],c:!1},{type:"node_in",name:"EA",qualifier:["float"],c:!1},{type:"node_out",name:"EB",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EB = atan ( Ez ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EB = clamp ( EB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["EA",";"]}]},{type:"node",name:"MATH_POWER",h:[{type:"node_in",name:"EC",qualifier:["float"],c:!1},{type:"node_in",name:"ED",qualifier:["float"],
c:!1},{type:"node_out",name:"EE",qualifier:["float"],c:!1}],f:[{type:"textline",a:"if ( EC < ZERO_VALUE_NODES && ED != floor ( ED ) ) EE = ZERO_VALUE_NODES ; else if ( ED == ZERO_VALUE_NODES )".split(" ")},{type:"textline",a:"EE = UNITY_VALUE_NODES ; else if ( EC < ZERO_VALUE_NODES ) EE = mix ( UNITY_VALUE_NODES , - UNITY_VALUE_NODES , sign ( mod ( - ED , 2.0 ) ) ) * pow ( - EC , ED ) ; else if ( EC == ZERO_VALUE_NODES ) EE = ZERO_VALUE_NODES ; else EE = pow ( EC , ED ) ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EE = clamp ( EE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",h:[{type:"node_in",name:"EF",qualifier:["float"],c:!1},{type:"node_in",name:"EG",qualifier:["float"],c:!1},{type:"node_out",name:"EH",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EH = ( EF > ZERO_VALUE_NODES && EG > ZERO_VALUE_NODES ) ? log2 ( EF ) / log2 ( EG ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",
b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EH = clamp ( EH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",h:[{type:"node_in",name:"EI",qualifier:["float"],c:!1},{type:"node_in",name:"EJ",qualifier:["float"],c:!1},{type:"node_out",name:"EK",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EK = min ( EI , EJ ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EK = clamp ( EK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",h:[{type:"node_in",name:"EL",qualifier:["float"],c:!1},{type:"node_in",name:"EM",qualifier:["float"],c:!1},{type:"node_out",name:"EN",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EN = max ( EL , EM ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EN = clamp ( EN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",h:[{type:"node_in",name:"EO",qualifier:["float"],c:!1},
{type:"node_in",name:"EP",qualifier:["float"],c:!1},{type:"node_out",name:"EQ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EQ = floor ( EO + xU ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EQ = clamp ( EQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["EP",";"]}]},{type:"node",name:"MATH_LESS_THAN",h:[{type:"node_in",name:"ER",qualifier:["float"],c:!1},{type:"node_in",name:"ES",qualifier:["float"],c:!1},
{type:"node_out",name:"ET",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ET = ( ER < ES ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"ET = clamp ( ET , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",h:[{type:"node_in",name:"EU",qualifier:["float"],c:!1},{type:"node_in",name:"EV",qualifier:["float"],c:!1},{type:"node_out",name:"EW",qualifier:["float"],
c:!1}],f:[{type:"textline",a:"EW = ( EU > EV ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EW = clamp ( EW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",h:[{type:"node_in",name:"EX",qualifier:["float"],c:!1},{type:"node_in",name:"EY",qualifier:["float"],c:!1},{type:"node_out",name:"EZ",qualifier:["float"],c:!1}],f:[{type:"textline",a:"EZ = abs ( EY ) > 0.000001 ? mod ( EX , EY ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"EZ = clamp ( EZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",h:[{type:"node_in",name:"E_",qualifier:["float"],c:!1},{type:"node_in",name:"Fa",qualifier:["float"],c:!1},{type:"node_out",name:"Fb",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Fb = abs ( E_ ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MATH_USE_CLAMP"],f:[{type:"textline",a:"Fb = clamp ( Fb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",a:["Fa",";"]}]},{type:"node",name:"MIX_RGB_MIX",h:[{type:"node_in",name:"Fc",qualifier:["float"],c:!1},{type:"node_in",name:"Fd",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fe",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ff",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Ff = mix ( Fd , Fe , yF ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ff = clamp ( Ff , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",h:[{type:"node_in",name:"Fg",qualifier:["float"],c:!1},{type:"node_in",name:"Fh",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fi",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fj",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fj = mix ( Fh , Fh + Fi , yF ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fj = clamp ( Fj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",h:[{type:"node_in",name:"Fk",qualifier:["float"],c:!1},{type:"node_in",name:"Fl",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fm",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fn",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fn = mix ( Fl , Fl * Fm , yF ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fn = clamp ( Fn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",h:[{type:"node_in",name:"Fo",qualifier:["float"],c:!1},{type:"node_in",name:"Fp",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fr",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Fr = mix ( Fp , Fp - Fq , yF ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fr = clamp ( Fr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",h:[{type:"node_in",name:"Fs",qualifier:["float"],c:!1},{type:"node_in",name:"Ft",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fu",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fv",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fs , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; Fv = vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( yG ) + yF * ( vec3 ( UNITY_VALUE_NODES ) - Fu ) ) * ( vec3 ( UNITY_VALUE_NODES ) - Ft ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fv = clamp ( Fv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",h:[{type:"node_in",name:"Fw",qualifier:["float"],c:!1},{type:"node_in",name:"Fx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Fy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Fz",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Fw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; Fy += step ( Fy , vec3 ( ZERO_VALUE_NODES ) ) ; Fz = yG * Fx + yF * Fx / Fy ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Fz = clamp ( Fz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",h:[{type:"node_in",name:"FA",qualifier:["float"],c:!1},{type:"node_in",name:"FB",qualifier:["vec3"],c:!1},{type:"node_in",name:"FC",qualifier:["vec3"],c:!1},{type:"node_out",name:"FD",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FD = mix ( FB , abs ( FB - FC ) , yF ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FD = clamp ( FD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",h:[{type:"node_in",name:"FE",qualifier:["float"],c:!1},{type:"node_in",name:"FF",qualifier:["vec3"],c:!1},{type:"node_in",name:"FG",qualifier:["vec3"],c:!1},{type:"node_out",name:"FH",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FH = min ( FF . rgb , FG . rgb * yF ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FH = clamp ( FH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",h:[{type:"node_in",name:"FI",qualifier:["float"],c:!1},{type:"node_in",name:"FJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"FK",qualifier:["vec3"],c:!1},{type:"node_out",name:"FL",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FL = max ( FJ . rgb , FK . rgb * yF ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FL = clamp ( FL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",h:[{type:"node_in",name:"FM",qualifier:["float"],c:!1},{type:"node_in",name:"FN",qualifier:["vec3"],c:!1},{type:"node_in",name:"FO",qualifier:["vec3"],c:!1},{type:"node_out",name:"FP",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yT = vec3 ( UNITY_VALUE_NODES - yF ) ; FP = mix ( FN * ( yT + 2.0 * yF * FO ) , vec3 ( UNITY_VALUE_NODES ) - ( yT + 2.0 * yF * ( vec3 ( UNITY_VALUE_NODES ) - FO ) ) * ( vec3 ( UNITY_VALUE_NODES ) - FN ) , step ( xU , FN ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FP = clamp ( FP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",h:[{type:"node_in",name:"FQ",qualifier:["float"],c:!1},{type:"node_in",name:"FR",qualifier:["vec3"],c:!1},{type:"node_in",name:"FS",qualifier:["vec3"],c:!1},{type:"node_out",name:"FT",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yT = vec3 ( UNITY_VALUE_NODES ) - yF * FS ; yS = clamp ( FR / yT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FT = mix ( mix ( yS , vec3 ( UNITY_VALUE_NODES ) , step ( yT , vec3 ( ZERO_VALUE_NODES ) ) ) , FR , step ( FR , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FT = clamp ( FT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",h:[{type:"node_in",name:"FU",qualifier:["float"],c:!1},{type:"node_in",name:"FV",qualifier:["vec3"],c:!1},{type:"node_in",name:"FW",qualifier:["vec3"],c:!1},{type:"node_out",name:"FX",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yT = vec3 ( UNITY_VALUE_NODES - yF ) ; yT = yT + yF * FW ; yS = clamp ( vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( UNITY_VALUE_NODES ) - FV ) / yT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; FX = mix ( yS , vec3 ( ZERO_VALUE_NODES ) , step ( yT , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"FX = clamp ( FX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",h:[{type:"node_in",name:"FY",qualifier:["float"],c:!1},{type:"node_in",name:"FZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"F_",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ga",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( FY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Ga = FZ ; yS = xZ ( F_ ) ; if ( yS . y != ZERO_VALUE_NODES ) { yT = xZ ( Ga ) ; yT . x = yS . x ; yU = yc ( yT ) ; Ga = mix ( Ga , yU , yF ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ga = clamp ( Ga , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",h:[{type:"node_in",name:"Gb",qualifier:["float"],c:!1},{type:"node_in",name:"Gc",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gd",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ge",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; Ge = Gc ; yU = xZ ( Ge ) ; if ( yU . y != ZERO_VALUE_NODES ) { yT = xZ ( Gd ) ; yU . y = yG * yU . y + yF * yT . y ; Ge = yc ( yU ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Ge = clamp ( Ge , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",h:[{type:"node_in",name:"Gf",qualifier:["float"],c:!1},{type:"node_in",name:"Gg",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gh",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gi",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; yU = xZ ( Gg ) ; yT = xZ ( Gh ) ; yU . z = yG * yU . z + yF * yT . z ; Gi = yc ( yU ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Gi = clamp ( Gi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",h:[{type:"node_in",name:"Gj",qualifier:["float"],c:!1},{type:"node_in",name:"Gk",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gl",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gm",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Gm = Gk ; yT = xZ ( Gl ) ; if ( yT . y != ZERO_VALUE_NODES ) { yU = xZ ( Gm ) ; yU . x = yT . x ; yU . y = yT . y ; yS = yc ( yU ) ; Gm = mix ( Gm , yS , yF ) ; }".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Gm = clamp ( Gm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",h:[{type:"node_in",name:"Gn",qualifier:["float"],c:!1},{type:"node_in",name:"Go",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gp",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gq",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = UNITY_VALUE_NODES - yF ; yS = Gp + Go - Gp * Go ; Gq = Go * ( vec3 ( yG ) + vec3 ( yF ) * ( ( vec3 ( UNITY_VALUE_NODES ) - Go ) * Gp + yS ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Gq = clamp ( Gq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",h:[{type:"node_in",name:"Gr",qualifier:["float"],c:!1},{type:"node_in",name:"Gs",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gt",qualifier:["vec3"],c:!1},{type:"node_out",name:"Gu",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yF = clamp ( Gr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; Gu = Gs + yF * ( 2.0 * Gt - vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")},
{type:"node_condition",b:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",a:"Gu = clamp ( Gu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",h:[{type:"node_in",name:"Gv",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gw",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yw = Gv ; yA = Gw ;".split(" ")}]},{type:"node",name:"MATERIAL_BEGIN",h:[{type:"node_in",name:"Gx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Gy",qualifier:["vec3"],c:!1},{type:"node_in",
name:"Gz",qualifier:["float"],c:!1},{type:"node_in",name:"GA",qualifier:["vec3"],c:!0},{type:"node_in",name:"GB",qualifier:["float"],c:!0},{type:"node_out",name:"GC",qualifier:["vec3"],c:!1},{type:"node_out",name:"GD",qualifier:["vec3"],c:!1},{type:"node_out",name:"GE",qualifier:["vec3"],c:!1},{type:"node_out",name:"GF",qualifier:["vec3"],c:!1},{type:"node_out",name:"GG",qualifier:["vec3"],c:!1},{type:"node_out",name:"GH",qualifier:["vec2"],c:!1},{type:"node_out",name:"GI",qualifier:["vec2"],c:!1},
{type:"node_out",name:"GJ",qualifier:["vec4"],c:!1},{type:"node_param",name:"ym",qualifier:["const","vec2"],c:!0},{type:"node_param",name:"yn",qualifier:["const","vec3"],c:!1}],f:[{type:"textline",a:"GE = clamp ( Gx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"GF = yn [ 0 ] * clamp ( Gy , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_NORMAL"],f:[{type:"textline",a:"GG = normalize ( GA ) ;".split(" ")},
{type:"textline",a:"GG . yz = vec2 ( GG . z , - GG . y ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:["GG","=","yR",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["SHADELESS_MAT",{type:"logic_negative_expr",e:1}],f:[{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"textline",a:"GC = GB * GE ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"GC = yD * GE ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",
a:["GE","*=","Gz",";"]}]}]},{type:"textline",a:"GD = yE * u_environment_energy * dS ( GG ) ; GJ = vec4 ( 1.0 ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],f:[{type:"textline",a:"GH = vec2 ( ym [ 0 ] , ym [ 1 ] ) ;".split(" ")},{type:"textline",a:"GI = vec2 ( yn [ 1 ] , yn [ 2 ] ) ;".split(" ")}]}]},{type:"textline",a:["yz","=","GJ",";"]}]},{type:"node_else",f:[{type:"textline",a:"GC = vec3 ( ZERO_VALUE_NODES ) ; GD = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATERIAL_END",h:[{type:"node_in",name:"GK",qualifier:["vec4"],c:!1},{type:"node_in",name:"GL",qualifier:["vec3"],c:!1},{type:"node_in",name:"GM",qualifier:["vec3"],c:!1},{type:"node_in",name:"GN",qualifier:["float"],c:!0},{type:"node_in",name:"GO",qualifier:["float"],c:!0},{type:"node_in",name:"GP",qualifier:["float"],c:!0},{type:"node_out",name:"GQ",qualifier:["vec3"],c:!0},{type:"node_out",name:"GR",qualifier:["float"],c:!0},{type:"node_out",name:"GS",qualifier:["vec3"],c:!0},
{type:"node_out",name:"GT",qualifier:["vec3"],c:!0},{type:"node_out",name:"GU",qualifier:["vec3"],c:!0},{type:"node_param",name:"yo",qualifier:["float"],c:!1},{type:"node_param",name:"yp",qualifier:["float"],c:!1}],f:[{type:"textline",a:["GN",";"]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GQ"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",a:"GQ = GK . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"GQ = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["GQ","+=","GL",";"]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GS"],f:[{type:"textline",a:["GS","=","GM",";"]},{type:"textline",a:"GS . yz = vec2 ( - GS . z , GS . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["MATERIAL_EXT"],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GT"],f:[{type:"textline",a:"GT = GK . rgb ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_GU"],f:[{type:"textline",a:["GU","=","GL",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GR"],f:[{type:"textline",a:"GR = clamp ( GP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"yF = max ( max ( GL . r , GL . g ) , GL . b ) * GO ; GR = clamp ( GP * ( UNITY_VALUE_NODES - yF ) + yF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},{type:"node_else",
f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_GR"],f:[{type:"textline",a:"GR = clamp ( yo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:"yF = max ( max ( GL . r , GL . g ) , GL . b ) * yp ; GR = yo * ( UNITY_VALUE_NODES - yF ) + yF ;".split(" ")}]}]}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",a:["yx","=","GL",";"]}]},{type:"node_else",
f:[{type:"textline",a:"yx = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",a:["yy","=","GM",";"]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"GV",qualifier:["vec3"],c:!1},{type:"node_in",name:"GW",qualifier:["vec3"],c:!1},{type:"node_in",name:"GX",qualifier:["vec3"],c:!1},{type:"node_out",name:"GY",qualifier:["vec4"],c:!1},{type:"node_out",name:"GZ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"GY = vec4 ( GV + GX * GW , ZERO_VALUE_NODES ) ; GZ = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"G_",qualifier:["vec4"],c:!1},{type:"node_out",name:"Ha",qualifier:["vec3"],c:!1},{type:"node_out",name:"Hb",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hc",qualifier:["vec3"],c:!1},{type:"node_out",name:"Hd",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hb = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","HEMI",{type:"equal_expr",e:2}],f:[{type:"textline",
a:["Hd","=","xU",";"]}]},{type:"node_else",f:[{type:"textline",a:["Hd","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",a:"Hc = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_SHADOW_MAP_IND",1,{type:"negative_expr",e:1},{type:"non_equal_expr",e:2}],f:[{type:"textline",a:"Hc *= G_ [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2},"LAMP_TYPE","POINT",{type:"equal_expr",
e:2},{type:"logical_or_expr",e:2}],f:[{type:"textline",a:"yS = u_light_positions [ LAMP_IND ] ; Ha = yS - yQ ;".split(" ")},{type:"textline",a:"yF = length ( Ha ) ; Hc *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + yF * yF ) ; Ha = normalize ( Ha ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["LAMP_TYPE","SPOT",{type:"equal_expr",e:2}],f:[{type:"textline",a:"yS = u_light_directions [ LAMP_IND ] ; yF = dot ( Ha , yS ) ; yF *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( yF - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; Hc *= yF ;".split(" ")}]}]}]},
{type:"node_else",f:[{type:"textline",a:"Ha = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"He",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hf",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hg",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hh",qualifier:["float"],c:!1},{type:"node_in",name:"Hi",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hj",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hj = ZERO_VALUE_NODES ; if ( Hf . r != ZERO_VALUE_NODES ) { yF = ( UNITY_VALUE_NODES - Hh ) * dot ( Hg , He ) + Hh ; if ( Hi [ 0 ] == ZERO_VALUE_NODES ) { Hj = UNITY_VALUE_NODES ; } else { yF = UNITY_VALUE_NODES + abs ( yF ) ; yF = Hi [ 1 ] + ( UNITY_VALUE_NODES - Hi [ 1 ] ) * pow ( yF , Hi [ 0 ] ) ; Hj = clamp ( yF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } Hj = max ( Hj , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"Hk",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hl",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hm",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hn",qualifier:["float"],c:!1},{type:"node_out",name:"Ho",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ho = ZERO_VALUE_NODES ; if ( Hl . r != ZERO_VALUE_NODES ) { yF = ( UNITY_VALUE_NODES - Hn ) * dot ( Hm , Hk ) + Hn ; Ho = max ( yF , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"Hp",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hq",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hr",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hs",qualifier:["float"],c:!1},{type:"node_in",name:"Ht",qualifier:["vec2"],c:!1},{type:"node_out",name:"Hu",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Hu = ZERO_VALUE_NODES ; if ( Hq . r != ZERO_VALUE_NODES ) { yF = ( UNITY_VALUE_NODES - Hs ) * dot ( Hr , Hp ) + Hs ; if ( Ht [ 0 ] > ZERO_VALUE_NODES ) { yG = max ( dot ( Hr , yq ) , ZERO_VALUE_NODES ) ; yH = Ht [ 0 ] * Ht [ 0 ] ; yI = UNITY_VALUE_NODES - xU * ( yH / ( yH + 0.33 ) ) ; yS = Hp - yF * Hr ; yU = yq - yG * Hr ;".split(" ")},
{type:"textline",a:"if ( length ( yS ) == ZERO_VALUE_NODES || length ( yU ) == ZERO_VALUE_NODES || abs ( yF ) > UNITY_VALUE_NODES || abs ( yG ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",a:"Hu = yF * yI ; else { yJ = acos ( yF ) ; yG = acos ( yG ) ; yS = normalize ( yS ) ; yU = normalize ( yU ) ; yK = max ( yJ , yG ) ; yL = min ( yJ , yG ) ; yL *= 0.95 ; yG = max ( dot ( yS , yU ) , ZERO_VALUE_NODES ) ; yH = 0.45 * ( yH / ( yH + 0.09 ) ) ; Hu = yF * ( yI + ( yH * yG * sin ( yK ) * tan ( yL ) ) ) ; } } else Hu = yF ; Hu = max ( Hu , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"Hv",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hw",qualifier:["vec2"],c:!1},{type:"node_in",name:"Hx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Hy",qualifier:["float"],c:!1},{type:"node_in",name:"Hz",qualifier:["vec2"],c:!1},{type:"node_out",name:"HA",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HA = ZERO_VALUE_NODES ; if ( Hw . r != ZERO_VALUE_NODES ) { yF = ( UNITY_VALUE_NODES - Hy ) * dot ( Hx , Hv ) + Hy ; yL = max ( dot ( Hx , yq ) , ZERO_VALUE_NODES ) ; if ( Hz [ 0 ] <= UNITY_VALUE_NODES ) HA = yF * pow ( max ( yL * yF , 0.1 ) , Hz [ 0 ] - UNITY_VALUE_NODES ) ; else HA = yF * pow ( 1.0001 - yL , Hz [ 0 ] - UNITY_VALUE_NODES ) ; HA = max ( HA , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"HB",qualifier:["vec3"],c:!1},{type:"node_in",name:"HC",qualifier:["vec2"],c:!1},{type:"node_in",name:"HD",qualifier:["vec3"],c:!1},{type:"node_in",name:"HE",qualifier:["float"],c:!1},{type:"node_in",name:"HF",qualifier:["vec2"],c:!1},{type:"node_out",name:"HG",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HG = ZERO_VALUE_NODES ; if ( HC . r != ZERO_VALUE_NODES ) { yL = ( UNITY_VALUE_NODES - HE ) * dot ( HD , HB ) + HE ; yL = acos ( yL ) ; if ( yL < HF [ 0 ] ) HG = UNITY_VALUE_NODES ; else if ( yL > ( HF [ 0 ] + HF [ 1 ] ) || HF [ 1 ] == ZERO_VALUE_NODES ) HG = ZERO_VALUE_NODES ; else HG = UNITY_VALUE_NODES - ( ( yL - HF [ 0 ] ) / HF [ 1 ] ) ; HG = max ( HG , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"HH",qualifier:["vec3"],c:!1},{type:"node_in",name:"HI",qualifier:["vec2"],c:!1},{type:"node_in",name:"HJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"HK",qualifier:["float"],c:!1},{type:"node_in",name:"HL",qualifier:["vec2"],c:!1},{type:"node_out",name:"HM",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HM = ZERO_VALUE_NODES ; if ( HI . g == UNITY_VALUE_NODES ) { yU = normalize ( HH + yq ) ; HM = ( UNITY_VALUE_NODES - HK ) * max ( dot ( HJ , yU ) , ZERO_VALUE_NODES ) + HK ; HM = pow ( HM , HL [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"HN",qualifier:["vec3"],c:!1},{type:"node_in",name:"HO",qualifier:["vec2"],c:!1},{type:"node_in",name:"HP",qualifier:["vec3"],c:!1},{type:"node_in",name:"HQ",qualifier:["vec2"],c:!1},{type:"node_out",name:"HR",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HR = ZERO_VALUE_NODES ; if ( HO . g == UNITY_VALUE_NODES ) { yU = normalize ( HN + yq ) ; yL = max ( dot ( HP , yU ) , 0.001 ) ;".split(" ")},{type:"textline",a:"yF = max ( dot ( HP , yq ) , 0.01 ) ; yK = max ( dot ( HP , HN ) , 0.01 ) ; yL = tan ( acos ( yL ) ) ; yG = max ( HQ [ 0 ] , 0.001 ) ; HR = yK * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * yG * yG ) ) * ( exp ( - ( yL * yL ) / ( yG * yG ) ) / ( sqrt ( yF * yK ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"HS",qualifier:["vec3"],c:!1},{type:"node_in",name:"HT",qualifier:["vec2"],c:!1},{type:"node_in",name:"HU",qualifier:["vec3"],c:!1},{type:"node_in",name:"HV",qualifier:["vec2"],c:!1},{type:"node_out",name:"HW",qualifier:["float"],c:!1}],f:[{type:"textline",a:"HW = ZERO_VALUE_NODES ; if ( HT . g == UNITY_VALUE_NODES ) { yU = normalize ( HS + yq ) ; yK = acos ( dot ( yU , HU ) ) ; if ( yK < HV [ 0 ] ) HW = UNITY_VALUE_NODES ; else if ( yK >= HV [ 0 ] + HV [ 1 ] || HV [ 1 ] == ZERO_VALUE_NODES ) HW = ZERO_VALUE_NODES ; else HW = UNITY_VALUE_NODES - ( yK - HV [ 0 ] ) / HV [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"HX",qualifier:["vec3"],c:!1},{type:"node_in",name:"HY",qualifier:["vec2"],c:!1},{type:"node_in",name:"HZ",qualifier:["vec3"],c:!1},{type:"node_in",name:"H_",qualifier:["float"],c:!1},{type:"node_in",name:"Ia",qualifier:["vec2"],c:!1},{type:"node_out",name:"Ib",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ib = ZERO_VALUE_NODES ; if ( HY . g == UNITY_VALUE_NODES ) { if ( Ia [ 0 ] < UNITY_VALUE_NODES || Ia [ 1 ] == ZERO_VALUE_NODES ) Ib = ZERO_VALUE_NODES ; else { if ( Ia [ 1 ] < 100.0 ) Ia [ 1 ] = sqrt ( UNITY_VALUE_NODES / Ia [ 1 ] ) ; else Ia [ 1 ] = 10.0 / Ia [ 1 ] ; yU = normalize ( yq + HX ) ; yK = ( UNITY_VALUE_NODES - H_ ) * max ( dot ( HZ , yU ) , ZERO_VALUE_NODES ) + H_ ; if ( yK < ZERO_VALUE_NODES ) Ib = ZERO_VALUE_NODES ; else { yF = max ( dot ( HZ , yq ) , 0.01 ) ; yG = dot ( HZ , HX ) ; if ( yG <= 0.01 ) Ib = ZERO_VALUE_NODES ; else { yL = max ( dot ( yq , yU ) , 0.01 ) ; yH = UNITY_VALUE_NODES ; yF = ( 2.0 * yK * yF ) / yL ; yG = ( 2.0 * yK * yG ) / yL ; yG = min ( min ( yH , yF ) , yG ) ; yF = sqrt ( pow ( Ia [ 0 ] , 2.0 ) + pow ( yL , 2.0 ) - UNITY_VALUE_NODES ) ; yL = pow ( yF - yL , 2.0 ) / pow ( yF + yL , 2.0 ) * ( UNITY_VALUE_NODES + pow ( yL * ( yF + yL ) - UNITY_VALUE_NODES , 2.0 ) / pow ( yL * ( yF - yL ) + UNITY_VALUE_NODES , 2.0 ) ) ; yK = acos ( yK ) ; Ib = max ( yL * yG * exp ( - pow ( yK , 2.0 ) / ( 2.0 * pow ( Ia [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"Ic",qualifier:["vec4"],c:!1},{type:"node_in",name:"Id",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ie",qualifier:["float"],c:!1},{type:"node_in",name:"If",qualifier:["float"],c:!1},{type:"node_in",name:"Ig",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ih",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ii",qualifier:["vec4"],c:!1},{type:"node_in",name:"Ij",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ik",qualifier:["vec3"],c:!1},{type:"node_in",
name:"Il",qualifier:["vec3"],c:!1},{type:"node_in",name:"Im",qualifier:["float"],c:!1},{type:"node_out",name:"In",qualifier:["vec4"],c:!1},{type:"node_out",name:"Io",qualifier:["vec3"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_NODE_B4W_TRANSLUCENCY"],f:[{type:"textline",a:"if ( dot ( Ig , Ih ) * dot ( yq , Ih ) < ZERO_VALUE_NODES ) { yK = Ii . x ; yG = Ii . y ; yL = Ii . z ; yF = Ii . w ;".split(" ")},{type:"textline",a:"yH = clamp ( abs ( dot ( Ig , Ih ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yI = clamp ( dot ( yq , - Ig ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = pow ( yI , yG ) ;".split(" ")},
{type:"textline",a:"In = Ic + Im * vec4 ( Il * yH * pow ( Ij , vec3 ( yK ) ) , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",a:"In += yL * mix ( vec4 ( Ij , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , yF ) * Im * vec4 ( Il * yH * vec3 ( yG ) , UNITY_VALUE_NODES ) ; Io = Id ; } else {".split(" ")},{type:"textline",a:"Io = Id + Il * Ik * If ; In = Ic + vec4 ( Il * Ij * Ie , If ) ; }".split(" ")}]},{type:"node_else",f:[{type:"textline",a:"Io = Id + Il * Ik * If ; In = Ic + vec4 ( Il * Ij * Ie , If ) ;".split(" ")}]}]}]},
{type:"node",name:"RGB",h:[{type:"node_out",name:"Ip",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Ip = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",h:[{type:"node_in",name:"Iq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Ir",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Ir = dot ( Iq , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",h:[{type:"node_in",name:"Is",qualifier:["vec3"],c:!1},{type:"node_out",name:"It",qualifier:["float"],c:!0},
{type:"node_out",name:"Iu",qualifier:["float"],c:!0},{type:"node_out",name:"Iv",qualifier:["float"],c:!0}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_It"],f:[{type:"textline",a:"It = Is . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Iu"],f:[{type:"textline",a:"Iu = Is . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Iv"],f:[{type:"textline",a:"Iv = Is . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",h:[{type:"node_in",name:"Iw",
qualifier:["vec3"],c:!1},{type:"node_out",name:"Ix",qualifier:["float"],c:!0},{type:"node_out",name:"Iy",qualifier:["float"],c:!0},{type:"node_out",name:"Iz",qualifier:["float"],c:!0}],f:[{type:"textline",a:"yU = xZ ( Iw ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ix"],f:[{type:"textline",a:"Ix = yU . r ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Iy"],f:[{type:"textline",a:"Iy = yU . g ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_Iz"],f:[{type:"textline",a:"Iz = yU . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",h:[{type:"node_in",name:"IA",qualifier:["float"],c:!1},{type:"node_in",name:"IB",qualifier:["float"],c:!1},{type:"node_in",name:"IC",qualifier:["float"],c:!1},{type:"node_out",name:"ID",qualifier:["float"],c:!1}],f:[{type:"textline",a:"ID = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( IA - IC ) * IB ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",h:[{type:"node_in",name:"IE",qualifier:["vec3"],
c:!1},{type:"node_in",name:"IF",qualifier:["float"],c:!1},{type:"node_out",name:"IG",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"IG = IE ; if ( IG . x > ZERO_VALUE_NODES ) IG . x = pow ( IE . x , IF ) ; if ( IG . y > ZERO_VALUE_NODES ) IG . y = pow ( IE . y , IF ) ; if ( IG . z > ZERO_VALUE_NODES ) IG . z = pow ( IE . z , IF ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",h:[{type:"node_in",name:"IH",qualifier:["vec3"],c:!1},{type:"node_out",name:"II",qualifier:["vec3"],c:!1}],f:[{type:"textline",
a:"II = max ( vec3 ( ZERO_VALUE_NODES ) , IH ) ; II = pow ( II , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",h:[{type:"node_in",name:"IJ",qualifier:["vec3"],c:!1},{type:"node_out",name:"IK",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"IK = max ( vec3 ( ZERO_VALUE_NODES ) , IJ ) ; IK = pow ( IK , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",h:[{type:"node_out",name:"IL",qualifier:["vec3"],c:!1},{type:"node_out",name:"IM",qualifier:["vec3"],
c:!1},{type:"node_out",name:"IN",qualifier:["float"],c:!1}],f:[{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IL"],f:[{type:"textline",a:"IL [ 2 ] = IL [ 1 ] = IL [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IM"],f:[{type:"textline",a:"IM [ 2 ] = IM [ 1 ] = IM [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IN"],f:[{type:"textline",a:["IN","=","ZERO_VALUE_NODES",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",
h:[{type:"node_in",name:"IO",qualifier:["vec3"],c:!1},{type:"node_out",name:"IP",qualifier:["vec3"],c:!0},{type:"node_out",name:"IQ",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"],c:!1}],f:[{type:"textline",a:"yU = vec3 ( IO . x , IO . z , - IO . y ) ; yN = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , yU ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IP"],f:[{type:"textline",a:"IP = yN . xyz ; br ( IP ) ;".split(" ")}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IQ"],f:[{type:"textline",a:"IQ = yN . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",h:[{type:"node_in",name:"IR",qualifier:["vec3"],c:!0},{type:"node_in",name:"IS",qualifier:["vec3"],c:!0},{type:"node_in",name:"IT",qualifier:["vec3"],c:!0},{type:"node_in",name:"IU",qualifier:["vec3"],c:!0},{type:"node_out",name:"IV",qualifier:["vec3"],c:!0},{type:"node_out",name:"IW",qualifier:["float"],c:!0},{type:"node_out",name:"IX",qualifier:["vec3"],
c:!0},{type:"node_out",name:"IY",qualifier:["float"],c:!0},{type:"node_out",name:"IZ",qualifier:["vec3"],c:!0},{type:"node_out",name:"I_",qualifier:["float"],c:!0},{type:"node_out",name:"Ja",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jb",qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_COLOR_var_texture , yg ( IR ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",
d:["USE_OUT_IV"],f:[{type:"textline",a:"IV = yN . xyz ; br ( IV ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IW"],f:[{type:"textline",a:"IW = yN . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_COLOR_var_texture , yg ( IS ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IX"],f:[{type:"textline",a:"IX = yN . xyz ; br ( IX ) ;".split(" ")}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_IY"],f:[{type:"textline",a:"IY = yN . w ;".split(" ")}]}]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_COLOR_var_texture , yg ( IT ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_IZ"],f:[{type:"textline",a:"IZ = yN . xyz ; br ( IZ ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_I_"],f:[{type:"textline",a:"I_ = yN . w ;".split(" ")}]}]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_COLOR_var_texture , yg ( IU ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ja"],f:[{type:"textline",a:"Ja = yN . xyz ; br ( Ja ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jb"],f:[{type:"textline",a:"Jb = yN . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",h:[{type:"node_in",name:"Jc",qualifier:["vec3"],c:!0},{type:"node_in",name:"Jd",qualifier:["vec3"],
c:!0},{type:"node_in",name:"Je",qualifier:["vec3"],c:!0},{type:"node_in",name:"Jf",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jg",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jh",qualifier:["float"],c:!0},{type:"node_out",name:"Ji",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jj",qualifier:["float"],c:!0},{type:"node_out",name:"Jk",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jl",qualifier:["float"],c:!0},{type:"node_out",name:"Jm",qualifier:["vec3"],c:!0},{type:"node_out",name:"Jn",
qualifier:["float"],c:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_NORMAL_var_texture , yg ( Jc ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jg"],f:[{type:"textline",a:"Jg = normalize ( yO * ( yN . xyz - xU ) ) ;".split(" ")},{type:"textline",a:"Jg . yz = vec2 ( - Jg . z , Jg . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jh"],f:[{type:"textline",
a:"Jh = yN . w ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_uv2"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_NORMAL_var_texture , yg ( Jd ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ji"],f:[{type:"textline",a:"Ji = normalize ( yO * ( yN . xyz - xU ) ) ;".split(" ")},{type:"textline",a:"Ji . yz = vec2 ( - Ji . z , Ji . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jj"],f:[{type:"textline",a:"Jj = yN . w ;".split(" ")}]}]}]}]},
{type:"node_condition",b:[{type:"node_if",d:["USE_uv3"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_NORMAL_var_texture , yg ( Je ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jk"],f:[{type:"textline",a:"Jk = normalize ( yO * ( yN . xyz - xU ) ) ;".split(" ")},{type:"textline",a:"Jk . yz = vec2 ( - Jk . z , Jk . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jl"],f:[{type:"textline",a:"Jl = yN . w ;".split(" ")}]}]}]}]},{type:"node_condition",
b:[{type:"node_if",d:["USE_uv4"],f:[{type:"textline",a:"yN = texture2D ( node_TEXTURE_NORMAL_var_texture , yg ( Jf ) ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jm"],f:[{type:"textline",a:"Jm = normalize ( yO * ( yN . xyz - xU ) ) ;".split(" ")},{type:"textline",a:"Jm . yz = vec2 ( - Jm . z , Jm . y ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jn"],f:[{type:"textline",a:"Jn = yN . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",h:[{type:"node_out",
name:"Jo",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Jo = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",h:[{type:"node_in",name:"Jp",qualifier:["vec3"],c:!1},{type:"node_in",name:"Jq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jr",qualifier:["vec3"],c:!1},{type:"node_out",name:"Js",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jr = Jp + Jq ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Js"],f:[{type:"textline",a:"Js = ( abs ( Jr [ 0 ] ) + abs ( Jr [ 1 ] ) + abs ( Jr [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_SUBTRACT",h:[{type:"node_in",name:"Jt",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ju",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jv",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jw",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jv = Jt - Ju ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jw"],f:[{type:"textline",a:"Jw = ( abs ( Jv [ 0 ] ) + abs ( Jv [ 1 ] ) + abs ( Jv [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",
h:[{type:"node_in",name:"Jx",qualifier:["vec3"],c:!1},{type:"node_in",name:"Jy",qualifier:["vec3"],c:!1},{type:"node_out",name:"Jz",qualifier:["vec3"],c:!1},{type:"node_out",name:"JA",qualifier:["float"],c:!0}],f:[{type:"textline",a:"Jz = Jx + Jy ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JA"],f:[{type:"textline",a:"JA = length ( Jz ) ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Jz"],f:[{type:"textline",a:"Jz = normalize ( Jz ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",h:[{type:"node_in",name:"JB",qualifier:["vec3"],c:!1},{type:"node_in",name:"JC",qualifier:["vec3"],c:!1},{type:"node_out",name:"JD",qualifier:["vec3"],c:!1},{type:"node_out",name:"JE",qualifier:["float"],c:!0}],f:[{type:"textline",a:"JD = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JE"],f:[{type:"textline",a:"JE = dot ( JB , JC ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",h:[{type:"node_in",
name:"JF",qualifier:["vec3"],c:!1},{type:"node_in",name:"JG",qualifier:["vec3"],c:!1},{type:"node_out",name:"JH",qualifier:["vec3"],c:!1},{type:"node_out",name:"JI",qualifier:["float"],c:!0}],f:[{type:"textline",a:"JH = cross ( JF , JG ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JI"],f:[{type:"textline",a:"JI = length ( JH ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",h:[{type:"node_in",name:"JJ",qualifier:["vec3"],c:!1},{type:"node_in",name:"JK",qualifier:["vec3"],
c:!1},{type:"node_out",name:"JL",qualifier:["vec3"],c:!1},{type:"node_out",name:"JM",qualifier:["float"],c:!0}],f:[{type:"textline",a:"JL = normalize ( JJ ) ;".split(" ")},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_JM"],f:[{type:"textline",a:"JM = length ( JJ ) ;".split(" ")}]}]},{type:"textline",a:["JK",";"]}]},{type:"node",name:"B4W_REFLECT",h:[{type:"node_in",name:"JN",qualifier:["vec3"],c:!1},{type:"node_in",name:"JO",qualifier:["vec3"],c:!1},{type:"node_out",name:"JP",qualifier:["vec3"],
c:!1}],f:[{type:"textline",a:"JP = reflect ( ( yt * vec4 ( JN , 0.0 ) ) . xyz , JO ) ;".split(" ")}]},{type:"node",name:"B4W_REFLECT_WORLD",h:[{type:"node_in",name:"JQ",qualifier:["vec3"],c:!1},{type:"node_out",name:"JR",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"yU = vec3 ( - yq . x , yq . z , - yq . y ) ; JR = reflect ( yU , JQ ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",h:[{type:"node_in",name:"JS",qualifier:["vec3"],c:!1},{type:"node_in",name:"JT",qualifier:["float"],c:!1},{type:"node_in",
name:"JU",qualifier:["const","float"],c:!1},{type:"node_in",name:"JV",qualifier:["const","float"],c:!1},{type:"node_out",name:"JW",qualifier:["vec3"],c:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"],c:!1}],f:[{type:"textline",a:"yG = length ( yM ) ; if ( yG < JV ) { yB = yg ( JS ) ; yG = clamp ( xU * ( JV - yG ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; yG = JT * yG ;".split(" ")},{type:"textline",a:"yU = normalize ( yq * yO ) ;".split(" ")},{type:"textline",
a:"yH = UNITY_VALUE_NODES / JU ;".split(" ")},{type:"textline",a:"yC = yU . xy * yG / ( JU * yU . z ) ; yG = UNITY_VALUE_NODES ; yF = texture2D ( node_B4W_PARALLAX_var_texture , yB ) . a ;".split(" ")},{type:"textline",a:"for ( float JX = 1.0 ; JX <= JU ; JX ++ ) { if ( yF < yG ) { yG -= yH ; yB -= yC ; yF = texture2D ( node_B4W_PARALLAX_var_texture , yB ) . a ; } }".split(" ")},{type:"textline",a:"yC = yB + yC ; yH = texture2D ( node_B4W_PARALLAX_var_texture , yC ) . a - ( yG + yH ) ; yG = yF - yG ; yH = yG / ( yG - yH ) ;".split(" ")},
{type:"textline",a:"yB = yH * yC + ( UNITY_VALUE_NODES - yH ) * yB ; JW = ye ( yB ) ; } else JW = JS ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",h:[{type:"node_in",name:"JY",qualifier:["vec3"],c:!1},{type:"node_out",name:"JZ",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"JZ = clamp ( JY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",h:[{type:"node_in",name:"J_",qualifier:["vec3"],c:!1},{type:"node_in",name:"Ka",qualifier:["float"],c:!1},{type:"node_out",
name:"Kb",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:["Kb","=","J_",";"]}]},{type:"node",name:"B4W_TRANSLUCENCY",h:[{type:"node_in",name:"Kc",qualifier:["float"],c:!1},{type:"node_in",name:"Kd",qualifier:["float"],c:!1},{type:"node_in",name:"Ke",qualifier:["float"],c:!1},{type:"node_in",name:"Kf",qualifier:["float"],c:!1},{type:"node_in",name:"Kg",qualifier:["float"],c:!1},{type:"node_out",name:"Kh",qualifier:["float"],c:!0},{type:"node_out",name:"Ki",qualifier:["vec4"],c:!0}],f:[{type:"node_condition",
b:[{type:"node_if",d:["USE_OUT_Kh"],f:[{type:"textline",a:["Kh","=","Kc",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["USE_OUT_Ki"],f:[{type:"textline",a:"Ki = vec4 ( Kd , Ke , Kf , Kg ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",h:[{type:"node_out",name:"Kj",qualifier:["float"],c:!1}],f:[{type:"textline",a:["Kj","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",h:[{type:"node_in",name:"Kk",qualifier:["float"],c:!1},{type:"node_in",name:"Kl",qualifier:["float"],c:!1},{type:"node_in",
name:"Km",qualifier:["float"],c:!1},{type:"node_out",name:"Kn",qualifier:["float"],c:!1}],f:[{type:"textline",a:"Kn = smoothstep ( Kl , Km , Kk ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",h:[{type:"node_in",name:"Ko",qualifier:["vec3"],c:!1},{type:"node_in",name:"Kp",qualifier:["float"],c:!1}],f:[{type:"textline",a:"yw = Ko ; yA = Kp ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",h:[{type:"node_in",name:"Kq",qualifier:["vec3"],c:!1},{type:"node_out",name:"Kr",qualifier:["float"],c:!1}],
f:[{type:"textline",a:"Kr = ( Kq . r + Kq . g + Kq . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",h:[{type:"node_in",name:"Ks",qualifier:["float"],c:!1},{type:"node_out",name:"Kt",qualifier:["vec3"],c:!1}],f:[{type:"textline",a:"Kt [ 0 ] = Ks ; Kt [ 1 ] = Ks ; Kt [ 2 ] = Ks ;".split(" ")}]},{type:"nodes_global"},{type:"textline",a:"void Ku ( in vec3 yq , in mat4 yr , in mat4 ys , in mat4 yt , in mat4 yu , in mat4 yv , out vec3 yw , out vec3 yx , out vec3 yy , out vec4 yz , out float yA ) { vec2 yB , yC ; float yD , yE , yF , yG , yH , yI , yJ , yK , yL ; vec4 yM , yN ; mat3 yO ; vec3 yP , yQ , yR , yS , yT , yU ; yw = vec3 ( ZERO_VALUE_NODES ) ; yx = vec3 ( ZERO_VALUE_NODES ) ; yy = vec3 ( ZERO_VALUE_NODES ) ; yz = vec4 ( ZERO_VALUE_NODES ) ; yA = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:5}],group:{type:"group",b:[{type:"textline",a:"yP = normalize ( bE ) ; yQ = yP ;".split(" ")},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["INVERT_FRONTFACING"],group:{type:"group",b:[{type:"textline",a:["if","(","!",
"gl_FrontFacing",")"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["if","(","gl_FrontFacing",")"]}]}}]},{type:"textline",a:"yQ = yQ ; else yQ = - yQ ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",b:[{type:"textline",a:["yR","=","yQ",";"]}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:["yR","=","yP",";"]}]}}]},{type:"condition",b:[{type:"if",d:["USE_NODE_GEOMETRY_NO"],group:{type:"group",b:[{type:"textline",a:["yP","=",
"yQ",";"]}]}}]}]}}]},{type:"condition",b:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",b:[{type:"textline",a:"yS = cross ( yQ , bF . xyz ) * bF . w ; yO = mat3 ( bF . xyz , yS , yQ ) ; yO = yO ;".split(" ")}]}}]},{type:"textline",a:"yQ = bC ; yM = bD ; yD = u_emit ; yE = u_ambient ;".split(" ")},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/particles.glslv"]={type:"group",b:[{type:"var",name:"EPSILON",a:["0.0001"]},{type:"textline",a:"struct Kw { float a ; vec3 b ; float c ; vec3 d ; float e ; vec3 f ; vec3 g ; float h ; } ;".split(" ")},
{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"void KC ( inout vec3 Kx , float Ky , vec4 Kz , vec4 KA ) { float KB ; KB = KA . x - Kz . x ; KB = ( Ky - Kz . x ) / KB ; Kx = mix ( Kx , KA . yzw , clamp ( KB , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec3 KI ( float KD , float KE , vec4 KF [ COLOR_RAMP_LENGTH ] ) { vec3 KG ; float KH ; KH = KD / KE ; KG = KF [ 0 ] . yzw ;".split(" ")},
{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",1,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KC ( KG , KH , KF [ 0 ] , KF [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",2,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KC ( KG , KH , KF [ 1 ] , KF [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KC ( KG , KH , KF [ 2 ] , KF [ 3 ] ) ;".split(" ")}]}}]},
{type:"textline",a:["return","KG",";","}"]}]}}]},{type:"textline",a:"float KQ ( float KJ , float KK , float KL , float KM ) { float KN , KO , KP ; KN = max ( 0.01 , min ( KK , KL ) ) ; KO = max ( 0.01 , min ( KK , KM ) ) ; KP = KK - KO ; KO = clamp ( KJ / KN , 0.0 , 1.0 ) - step ( KP , KJ ) * ( KJ - KP ) / KO ; return KO ; } Kw KY ( ) { mat4 KR ; vec3 KS , KT ; float KU , KV , KW ; Kw KX ; KV = a_p_data [ 0 ] ; KW = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { KU = mod ( u_p_time , u_p_length ) - KW ; if ( KU < 0.0 ) KU += u_p_length ; } if ( u_p_cyclic != 1 ) { KU = u_p_time - KW ; } if ( KU < 0.0 || KU >= KV ) { KX . a = 0.0001 ; KX . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( KU < 0.0 || KU >= KV ) ) {".split(" ")},
{type:"condition",b:[{type:"if",d:["WORLD_SPACE"],group:{type:"group",b:[{type:"textline",a:"KS = a_position ; KT = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KR = O ( u_model_tsr ) ; KS = ( KR * vec4 ( a_position , 1.0 ) ) . xyz ; KT = ( KR * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",a:"KT = u_p_nfactor * KT ; KT += a_p_vels . xyz ; KT . y -= u_p_gravity * KU / 2.0 ; KV = max ( u_p_mass , EPSILON ) ; KT += ( u_p_wind_fac * u_wind / KV ) * KU / 2.0 ; KX . h = KU ; KX . f = KT ; KX . g = a_normal * a_p_vels . w ; KX . b = KS + KT * KU ; KX . e = a_p_vels . w * KU ;".split(" ")},
{type:"condition",b:[{type:"if",d:["USE_COLOR_RAMP"],group:{type:"group",b:[{type:"textline",a:"KX . a = texture2D ( u_color_ramp_tex , vec2 ( KU / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"KX . a = 1.0 ;".split(" ")}]}}]},{type:"condition",b:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"KX . d = KI ( KU , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",
b:[{type:"textline",a:"KX . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",a:"KX . c = KQ ( KU , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return KX ; }".split(" ")}]};a["include/particles_nodes.glslv"]={type:"group",b:[{type:"node",name:"TEX_COORD_UV",h:[],f:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[],f:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]},{type:"node",name:"UVMAP",h:[],f:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]},
{type:"node",name:"GEOMETRY_UV",h:[],f:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",h:[{type:"node_param",name:"yi",qualifier:["varying","vec4"],c:!0},{type:"node_param",name:"yj",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"yk",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"yl",qualifier:["varying","vec3"],c:!0},{type:"node_param",name:"node_PARTICLE_INFO_var_a_p_indices",qualifier:["attribute","float"],c:!0}],f:[{type:"node_condition",
b:[{type:"node_if",d:["PART_INFO_SIZE"],f:[{type:"textline",a:"yi [ 3 ] = Lc ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_AGE"],f:[{type:"textline",a:"yi [ 1 ] = Lb ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_LT"],f:[{type:"textline",a:"yi [ 2 ] = Le ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_LOC"],f:[{type:"textline",a:["yj","=","KZ",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_IND"],
f:[{type:"textline",a:"yi [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_VEL"],f:[{type:"textline",a:["yk","=","K_",";"]}]}]},{type:"node_condition",b:[{type:"node_if",d:["PART_INFO_A_VEL"],f:[{type:"textline",a:["yl","=","La",";"]}]}]}]},{type:"nodes_global"},{type:"textline",a:"void Lf ( in vec3 KZ , in vec3 K_ , in vec3 La , in float Lb , in float Lc , in vec2 Ld , in float Le ) {".split(" ")},{type:"condition",b:[{type:"if",
d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"bM = Ld + 0.5 ;".split(" ")}]}}]},{type:"nodes_main"},{type:"textline",a:["}"]}]};a["include/blending.glslf"]={type:"group",b:[{type:"textline",a:"float Lh = 0.0 ; float Li = 1.0 ; vec3 Ln ( vec3 Lj ) { float Lk , Ll ; vec4 Lm ; Lm = vec4 ( Lh , - Li / 3.0 , 2.0 / 3.0 , - Li ) ; Lm = mix ( vec4 ( Lj . bg , Lm . wz ) , vec4 ( Lj . gb , Lm . xy ) , step ( Lj . b , Lj . g ) ) ; Lm = mix ( vec4 ( Lm . xyw , Lj . r ) , vec4 ( Lj . r , Lm . yzx ) , step ( Lm . x , Lj . r ) ) ; Lk = Lm . x - min ( Lm . w , Lm . y ) ; Ll = 1.0e-10 ; return vec3 ( abs ( Lm . z + ( Lm . w - Lm . y ) / ( 6.0 * Lk + Ll ) ) , Lk / ( Lm . x + Ll ) , Lm . x ) ; } vec3 Lr ( vec3 Lo ) { vec3 Lp ; vec4 Lq ; Lq = vec4 ( Li , 2.0 / 3.0 , Li / 3.0 , 3.0 ) ; Lp = abs ( fract ( vec3 ( Lo . r , Lo . r , Lo . r ) + Lq . xyz ) * 6.0 - Lq . www ) ; return Lo . b * mix ( Lq . xxx , clamp ( Lp - Lq . xxx , Lh , Li ) , Lo . g ) ; } vec3 Lv ( vec3 Ls , vec3 Lt , float Lu ) { return mix ( Ls , Lt , Lu ) ; } vec3 Lz ( vec3 Lw , vec3 Lx , float Ly ) { return Ly * Lw + Lx ; } vec3 LD ( vec3 LA , vec3 LB , float LC ) { return LB - LC * LA ; } vec3 LI ( vec3 LE , vec3 LF , float LG ) { float LH ; LH = Li - LG ; return ( vec3 ( LH ) + LG * LE ) * LF ; } vec3 LN ( vec3 LJ , vec3 LK , float LL ) { vec3 LM ; LM = vec3 ( Li - LL ) ; return vec3 ( Li ) - ( LM + LL * ( vec3 ( Li ) - LJ ) ) * ( vec3 ( Li ) - LK ) ; } vec3 LS ( vec3 LO , vec3 LP , float LQ ) { vec3 LR ; LR = vec3 ( Li - LQ ) ; return mix ( LP * ( LR + 2.0 * LQ * LO ) , vec3 ( Li ) - ( LR + 2.0 * LQ * ( vec3 ( Li ) - LO ) ) * ( vec3 ( Li ) - LP ) , step ( 0.5 , LP ) ) ; } vec3 LW ( vec3 LT , vec3 LU , float LV ) { return mix ( LU , abs ( LT - LU ) , LV ) ; } vec3 L_ ( vec3 LX , vec3 LY , float LZ ) { return mix ( LY , LY / ( LX + step ( LX , vec3 ( Lh ) ) ) , LZ ) ; } vec3 Md ( vec3 Ma , vec3 Mb , float Mc ) { return mix ( Mb , min ( Ma , Mb ) , Mc ) ; } vec3 Mh ( vec3 Me , vec3 Mf , float Mg ) { return max ( Mg * Me , Mf ) ; } vec3 Mn ( vec3 Mi , vec3 Mj , float Mk ) { vec3 Ml , Mm ; Ml = Ln ( Mj ) ; if ( Ml . y != Lh ) { Mm = Ln ( Mi ) ; Mm = Lr ( vec3 ( Ml . x , Mm . yz ) ) ; return mix ( Mi , Mm , Mk ) ; } return Mi ; } vec3 Mt ( vec3 Mo , vec3 Mp , float Mq ) { vec3 Mr , Ms ; Mr = Ln ( Mo ) ; if ( Mr . y != Lh ) { Ms = Ln ( Mp ) ; return Lr ( vec3 ( Mr . x , mix ( Mr . y , Ms . y , Mq ) , Mr . z ) ) ; } return Mo ; } vec3 Mz ( vec3 Mu , vec3 Mv , float Mw ) { vec3 Mx , My ; Mx = Ln ( Mu ) ; My = Ln ( Mv ) ; return Lr ( vec3 ( Mx . xy , mix ( Mx . z , My . z , Mw ) ) ) ; } vec3 MF ( vec3 MA , vec3 MB , float MC ) { vec3 MD , ME ; MD = Ln ( MB ) ; if ( MD . y != Lh ) { ME = Ln ( MA ) ; ME = Lr ( vec3 ( MD . xy , ME . z ) ) ; return mix ( MA , ME , MC ) ; } return MA ; } vec3 MK ( vec3 MG , vec3 MH , float MI ) { vec3 MJ ; MJ = vec3 ( Li ) - ( vec3 ( Li ) - MH ) * ( vec3 ( Li ) - MG ) ; return mix ( MG , ( ( vec3 ( Li ) - MG ) * MH * MG ) + MG * MJ , MI ) ; } vec3 MO ( vec3 ML , vec3 MM , float MN ) { return ML + MN * ( 2.0 * MM - Li ) ; } float MU ( float MP , float MQ , float MR , float MS ) { float MT ; MT = Li - MS ; return ( MT + MR * MP ) * MQ ; } float M_ ( float MV , float MW , float MX , float MY ) { float MZ ; MZ = Li - MY ; return Li - ( MZ + MX * ( Li - MV ) ) * ( Li - MW ) ; } float Nf ( float Na , float Nb , float Nc , float Nd ) { float Ne ; Ne = Li - Nd ; return mix ( Nb * ( Ne + 2.0 * Nc * Na ) , Li - ( Ne + 2.0 * Nc * ( Li - Na ) ) * ( Li - Nb ) , step ( 0.5 , Nb ) ) ; }".split(" ")}]};
a["include/fxaa.glslf"]={type:"group",b:[{type:"condition",b:[{type:"ifndef",name:"FXAA_PS3",group:{type:"group",b:[{type:"define",name:"FXAA_PS3",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_360",group:{type:"group",b:[{type:"define",name:"FXAA_360",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_360_OPT",group:{type:"group",b:[{type:"define",name:"FXAA_360_OPT",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_PC",group:{type:"group",b:[{type:"define",name:"FXAA_PC",
a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_PC_CONSOLE",group:{type:"group",b:[{type:"define",name:"FXAA_PC_CONSOLE",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GLSL_120",group:{type:"group",b:[{type:"define",name:"FXAA_GLSL_120",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GLSL_130",group:{type:"group",b:[{type:"define",name:"FXAA_GLSL_130",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_3",group:{type:"group",b:[{type:"define",
name:"FXAA_HLSL_3",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_4",group:{type:"group",b:[{type:"define",name:"FXAA_HLSL_4",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_HLSL_5",group:{type:"group",b:[{type:"define",name:"FXAA_HLSL_5",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GREEN_AS_LUMA",group:{type:"group",b:[{type:"define",name:"FXAA_GREEN_AS_LUMA",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_EARLY_EXIT",group:{type:"group",
b:[{type:"define",name:"FXAA_EARLY_EXIT",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_DISCARD",group:{type:"group",b:[{type:"define",name:"FXAA_DISCARD",a:["0"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_FAST_PIXEL_OFFSET",group:{type:"group",b:[{type:"condition",b:[{type:"ifdef",name:"GL_EXT_gpu_shader4",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_NV_gpu_shader5",group:{type:"group",b:[{type:"define",
name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_ARB_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_FAST_PIXEL_OFFSET",group:{type:"group",b:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",a:["0"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GATHER4_ALPHA",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:["FXAA_HLSL_5",1,{type:"equal_expr",e:2}],
group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_ARB_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifdef",name:"GL_NV_gpu_shader5",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["1"]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_GATHER4_ALPHA",group:{type:"group",b:[{type:"define",name:"FXAA_GATHER4_ALPHA",a:["0"]}]}}]}]}}]},{type:"condition",
b:[{type:"ifndef",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:[0],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["4.0"]}]}}]},{type:"condition",b:[{type:"if",d:[0],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",a:["2.0"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",
name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",group:{type:"group",b:[{type:"condition",b:[{type:"if",d:[1],group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",a:["0.125"]}]}},{type:"else",group:{type:"group",b:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",a:["0.25"]}]}}]}]}}]},{type:"condition",b:[{type:"ifndef",name:"FXAA_QUALITY_PRESET",group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PRESET",a:["12"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
10,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["3"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P1",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",11,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["4"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},
{type:"define",name:"FXAA_QUALITY_P2",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",12,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["5"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["12.0"]}]}}]},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",13,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["6"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
14,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["7"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["12.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
15,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["8"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["12.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",20,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["3"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P1",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",21,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["4"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",
name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",22,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["5"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",
name:"FXAA_QUALITY_P4",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",23,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["6"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["8.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",24,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["7"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["3.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["8.0"]}]}}]},{type:"condition",
b:[{type:"if",d:["FXAA_QUALITY_PRESET",25,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["8"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P7",
a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",26,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["9"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",
a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",27,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["10"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",
a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",28,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["11"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",
a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",
29,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["12"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",
name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P11",a:["8.0"]}]}}]},{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PRESET",39,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"define",name:"FXAA_QUALITY_PS",a:["12"]},{type:"define",name:"FXAA_QUALITY_P0",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P2",a:["1.0"]},{type:"define",
name:"FXAA_QUALITY_P3",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P4",a:["1.0"]},{type:"define",name:"FXAA_QUALITY_P5",a:["1.5"]},{type:"define",name:"FXAA_QUALITY_P6",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",a:["2.0"]},{type:"define",name:"FXAA_QUALITY_P10",a:["4.0"]},{type:"define",name:"FXAA_QUALITY_P11",a:["8.0"]}]}}]},{type:"var",name:"FXAA_QUALITY_P12",a:["0.0"]},{type:"textline",a:"float NB ( float NA ) { return clamp ( NA , 0.0 , 1.0 ) ; }".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_BLEND4WEB",1,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"vec4 NE ( sampler2D NC , vec2 ND ) { return texture2D ( NC , ND ) ; } vec4 NJ ( sampler2D NF , vec2 NG , vec2 NH , vec2 NI ) { return texture2D ( NF , NG + ( NH * NI ) ) ; }".split(" ")}]}}]},{type:"textline",a:"vec4 Op ( vec2 NK , sampler2D NL , vec2 NM , float NN , float NO , float NP ) { bool NQ , NR , NS , NT , NU ; float NV , NW , NX , NY , NZ , N_ , Oa , Ob , Oc , Od , Oe , Of , Og , Oh , Oi ; vec4 Oj ; vec2 Ok , Ol , Om , On , Oo ; Ok . x = NK . x ; Ok . y = NK . y ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_GATHER4_ALPHA",1,{type:"equal_expr",e:2}],group:{type:"group",b:[]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"Oj = NE ( NL , Ok ) ; NV = bB ( Oj ) ; NW = bB ( NJ ( NL , Ok , vec2 ( 0 , 1 ) , NM . xy ) ) ; NX = bB ( NJ ( NL , Ok , vec2 ( 1 , 0 ) , NM . xy ) ) ; NY = bB ( NJ ( NL , Ok , vec2 ( 0 , - 1 ) , NM . xy ) ) ; NZ = bB ( NJ ( NL , Ok , vec2 ( - 1 , 0 ) , NM . xy ) ) ;".split(" ")}]}}]},{type:"textline",a:"N_ = max ( NW , NV ) ; Oa = min ( NW , NV ) ; N_ = max ( NX , N_ ) ; Oa = min ( NX , Oa ) ; Ob = max ( NY , NZ ) ; Oc = min ( NY , NZ ) ; N_ = max ( Ob , N_ ) ; Oa = min ( Oc , Oa ) ; Oc = N_ * NO ; Oa = N_ - Oa ; Oc = max ( NP , Oc ) ; NQ = Oa < Oc ; if ( NQ ) return Oj ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_GATHER4_ALPHA",0,{type:"equal_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"Oc = bB ( NJ ( NL , Ok , vec2 ( - 1 , - 1 ) , NM . xy ) ) ; N_ = bB ( NJ ( NL , Ok , vec2 ( 1 , 1 ) , NM . xy ) ) ; Ob = bB ( NJ ( NL , Ok , vec2 ( 1 , - 1 ) , NM . xy ) ) ; Od = bB ( NJ ( NL , Ok , vec2 ( - 1 , 1 ) , NM . xy ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[]}}]},{type:"textline",a:"Oe = NY + NW ; Of = NZ + NX ; Oa = 1.0 / Oa ; Og = Oe + Of ; Oe = ( - 2.0 * NV ) + Oe ; Of = ( - 2.0 * NV ) + Of ; Oh = Ob + N_ ; Ob = Oc + Ob ; Oi = ( - 2.0 * NX ) + Oh ; Ob = ( - 2.0 * NY ) + Ob ; Oc = Oc + Od ; N_ = Od + N_ ; Oi = ( abs ( Oe ) * 2.0 ) + abs ( Oi ) ; Ob = ( abs ( Of ) * 2.0 ) + abs ( Ob ) ; Of = ( - 2.0 * NZ ) + Oc ; N_ = ( - 2.0 * NW ) + N_ ; Oi = abs ( Of ) + Oi ; Ob = abs ( N_ ) + Ob ; Oh = Oc + Oh ; Oc = NM . x ; NQ = Oi >= Ob ; Oh = Og * 2.0 + Oh ; if ( ! NQ ) NY = NZ ; if ( ! NQ ) NW = NX ; if ( NQ ) Oc = NM . y ; Oh = ( Oh * ( 1.0 / 12.0 ) ) - NV ; NX = NY - NV ; NZ = NW - NV ; NY = NY + NV ; NW = NW + NV ; NR = abs ( NX ) >= abs ( NZ ) ; NZ = max ( abs ( NX ) , abs ( NZ ) ) ; if ( NR ) Oc = - Oc ; Oa = NB ( abs ( Oh ) * Oa ) ; Ol . x = Ok . x ; Ol . y = Ok . y ; Om . x = ( ! NQ ) ? 0.0 : NM . x ; Om . y = ( NQ ) ? 0.0 : NM . y ; if ( ! NQ ) Ol . x += Oc * 0.5 ; if ( NQ ) Ol . y += Oc * 0.5 ; On . x = Ol . x - Om . x * FXAA_QUALITY_P0 ; On . y = Ol . y - Om . y * FXAA_QUALITY_P0 ; Oo . x = Ol . x + Om . x * FXAA_QUALITY_P0 ; Oo . y = Ol . y + Om . y * FXAA_QUALITY_P0 ; Oh = ( ( - 2.0 ) * Oa ) + 3.0 ; NX = bB ( NE ( NL , On ) ) ; Oa = Oa * Oa ; Og = bB ( NE ( NL , Oo ) ) ; if ( ! NR ) NY = NW ; NZ = NZ * 1.0 / 4.0 ; NW = NV - NY * 0.5 ; Oa = Oh * Oa ; NR = NW < 0.0 ; NX -= NY * 0.5 ; Og -= NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P1 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P1 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P1 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P1 ; if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P2 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P2 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P2 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P2 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",3,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P3 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P3 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P3 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P3 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",4,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P4 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P4 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P4 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P4 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",5,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P5 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P5 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P5 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P5 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",6,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P6 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P6 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P6 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P6 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",7,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P7 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P7 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P7 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P7 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",8,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P8 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P8 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P8 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P8 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",9,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P9 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P9 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P9 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P9 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",10,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P10 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P10 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P10 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P10 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",11,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P11 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P11 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P11 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P11 ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_QUALITY_PS",12,{type:"g_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"if ( NU ) { if ( ! NS ) NX = bB ( NE ( NL , On . xy ) ) ; if ( ! NT ) Og = bB ( NE ( NL , Oo . xy ) ) ; if ( ! NS ) NX = NX - NY * 0.5 ; if ( ! NT ) Og = Og - NY * 0.5 ; NS = abs ( NX ) >= NZ ; NT = abs ( Og ) >= NZ ; if ( ! NS ) On . x -= Om . x * FXAA_QUALITY_P12 ; if ( ! NS ) On . y -= Om . y * FXAA_QUALITY_P12 ; NU = ( ! NS ) || ( ! NT ) ; if ( ! NT ) Oo . x += Om . x * FXAA_QUALITY_P12 ; if ( ! NT ) Oo . y += Om . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:["}"]}]}}]},{type:"textline",a:"} NZ = Ok . x - On . x ; NY = Oo . x - Ok . x ; if ( ! NQ ) NZ = Ok . y - On . y ; if ( ! NQ ) NY = Oo . y - Ok . y ; NT = ( NX < 0.0 ) != NR ; NX = ( NY + NZ ) ; NR = ( Og < 0.0 ) != NR ; NX = 1.0 / NX ; NS = NZ < NY ; NY = min ( NZ , NY ) ; NR = NS ? NT : NR ; Oa = Oa * Oa ; NX = ( NY * ( - NX ) ) + 0.5 ; Oa = Oa * NN ; NX = NR ? NX : 0.0 ; Oa = max ( NX , Oa ) ; if ( ! NQ ) Ok . x += Oa * Oc ; if ( NQ ) Ok . y += Oa * Oc ;".split(" ")},
{type:"condition",b:[{type:"if",d:["FXAA_DISCARD",1,{type:"equal_expr",e:2},"FXAA_BLEND4WEB",1,{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",b:[{type:"textline",a:"return NE ( NL , Ok ) ;".split(" ")}]}},{type:"else",group:{type:"group",b:[{type:"textline",a:"return vec4 ( NE ( NL , Ok ) . xyz , NV ) ;".split(" ")}]}}]},{type:"textline",a:["}"]}]};a["include/depth_fetch.glslf"]={type:"group",b:[{type:"textline",a:"float Ow ( in sampler2D Oq , in vec2 Or , in vec2 Os ) { float Ot , Ou , Ov ; Ot = texture2D ( Oq , Or ) . r ; Ou = Os . x ; Ov = Os . y ; Ou = 2.0 * Ou / ( Ou + Ov - ( 2.0 * Ot - 1.0 ) * ( Ov - Ou ) ) ; return Ou ; }".split(" ")}]}};b4w.module.__data=function(a,l){function m(a,c){cc[c.id]=null;oa[c.id]=null}function b(a,c,b){var d;a instanceof ArrayBuffer&&(a=Ca.hE(a));d=a.width;a=a.height;pa.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),c);-1==c.indexOf(Za)&&b&&pa.warn("image",c,"is not from app root.")}function e(a,c,b,d,e,f){(d=c.cg)||ra.l("Nothing requested");E.cd([{id:d,type:E.tk,url:d}],function(d,f,h,g){if(d){pa.log("%cLOAD METADATA","color: #616",g);f=ra.AH(d.b4w_format_version);
switch(ra.xI(f,Ea.Lj)){case -1:f[0]<Ea.Lj[0]?ra.l("JSON version is too old relative to B4W engine: "+ra.Ii(f)+", required: "+ra.Ii(Ea.Lj)+". Reexport scene with the latest B4W addon to fix it."):pa.warn("JSON version is a bit old relative to B4W engine: "+ +ra.Ii(f)+", required: "+ra.Ii(Ea.Lj)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>Ea.Lj[0]?ra.l("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
pa.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Ea.qx=f;for(var k in d)a[k]=d[k];c.gb&&(Fa=Aa.Uq(a.scenes));(d=a.binaries[0].binfile)?c.uB=d:(Q.Ss(c,"load_binaries"),Q.Ss(c,"prepare_bindata"));Ea.Af||Q.Ss(c,"mobile_media_start");Ea.antialiasing&&Ea.smaa||Q.Ss(c,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(c.gb&&"PRIMARY"==k.type||"ALL"==k.type)&&
pa.eO(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(c.gb&&"PRIMARY"==k.type||"ALL"==k.type)&&pa.fO(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");e(c,b)}else Q.XA(c)},null,function(a){f(c,b,a)})}function x(a,c,b,d,e,f){(d=fa(c.cg)+c.uB)||ra.l("Binary data is missing");E.cd([{id:d,type:E.pp,url:d}],function(d,
f,h,g){d?(pa.log("%cLOAD BINARY","color: #616",g),a.bin_data=d,d=r(d),f=ra.AH(a.b4w_format_version),d[0]!=f[0]&&ra.l("BIN version does not match to JSON version: "+ra.Ii(d)+", required: "+ra.Ii(Ea.Lj)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&pa.warn("BIN version does not match to JSON version: "+ +ra.Ii(d)+", required: "+ra.Ii(Ea.Lj)+". Some compatibility issues can occur. Reexport scene to fix it."),e(c,b)):Q.XA(c)},null,function(a){f(c,b,a)})}function k(a,c,b,d,e){Ja.wM()&&
e(c,b)}function B(a,c,b,d,e){d=a.bin_data;var f=a.binaries[0],h=a.objects,g=a.meshes;a=a.actions;for(var k=ra.pM(),n=r(d),n=5<=n[0]&&4<n[1]?12:0,m=["indices"],l=["normal","tangent"],p=["color","group"],v=["position","texcoord","texcoord2"],q=0;q<g.length;q++)for(var t=g[q].submeshes,u=0;u<t.length;u++)for(var z in t[u]){var y=t[u][z][1];if(-1!=m.indexOf(z)){var A=4*t[u][z][0]+f["int"]+n,B=t[u],C=z,x=d;if(k)var aa=new Uint32Array(x,A,y);else for(var aa=new Uint32Array(y),x=new DataView(x),I=0;I<y;I++)aa[I]=
x.getUint32(A+4*I,!0);B[C]=aa}else if(-1!=v.indexOf(z))A=4*t[u][z][0]+f["float"]+n,t[u][z]=w(d,A,y,k);else if(-1!=l.indexOf(z)){A=2*t[u][z][0]+f["short"]+n;B=t[u];C=z;x=d;aa=new Float32Array(y);x=new DataView(x);for(I=0;I<y;I++)aa[I]=x.getInt16(A+2*I,!0)/32767;B[C]=aa}else if(-1!=p.indexOf(z)){A=2*t[u][z][0]+f.ushort+n;B=t[u];C=z;x=d;aa=new Float32Array(y);x=new DataView(x);for(I=0;I<y;I++)aa[I]=x.getUint16(A+2*I,!0)/65535;B[C]=aa}}for(z=0;z<h.length;z++)for(g=h[z].particle_systems,m=0;m<g.length;m++)l=
g[m],l.transforms=w(d,4*l.transforms[0]+f["float"]+n,l.transforms[1],k);for(h=0;h<a.length;h++){z=a[h];g=z.fcurves;m=z.frame_range;p=m[0];v=m[1];q=ga.SO(p,v);m=null;0>q&&(q=0);var u=t=!1,H;for(H in g)t|=-1<H.indexOf("rotation_euler"),u|=-1<H.indexOf("rotation_quaternion");l=[];for(H in g)if(t&&u&&-1<H.indexOf("rotation_euler"))delete g[H];else{var y=g[H],D;for(D in y)A=y[D],B=w(d,f["float"]+4*A.bin_data_pos[0]+n,A.bin_data_pos[1],k),C=new Float32Array(q),null===m&&(m=new Int8Array(q)),ga.sL(A,B,C,
m,p,v),A.Yd=C;-1<H.indexOf("rotation_euler")&&(ga.mO(g[H]),l.push(H))}for(p=0;p<l.length;p++)v=l[p],q=v.replace("euler","quaternion"),g[q]=g[v],delete g[v];z.JK=m}e(c,b)}function r(a){var c=new Uint8Array(a,0,4),b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];for(var d=0;d<c.length;d++)if("B4WB"[d]!=String.fromCharCode(c[d])){b=5;a=4;break}return[b,a]}function w(a,c,b,d){if(d)d=new Float32Array(a,c,b);else{d=new Float32Array(b);a=new DataView(a);for(var e=0;e<b;e++)d[e]=a.getFloat32(c+
4*e,!0)}return d}function f(a,c,b,d,e){var f=a.cameras,h=a.groups,g=a.materials,k=a.meshes,n=a.node_groups,m=a.objects,l=a.particles,p=a.scenes,v=a.speakers,r=a.lamps,t=a.textures,w=a.worlds;n||(pa.warn('"node_groups" datablock undefined. reexport main scene.'),n=a.node_groups=[]);for(var y="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),A={},B=0;B<y.length;B++)for(var C=a[y[B]],x=0;x<C.length;x++){var aa=
C[x];A[aa.uuid]=aa}for(var D=0;D<p.length;D++){for(var E=p[D],M=E.objects,O=0;O<M.length;O++)I(M,O,A);E.camera&&I(E,"camera",A);E.world&&I(E,"world",A)}for(D=0;D<h.length;D++)for(var K=h[D].objects,O=0;O<K.length;O++)I(K,O,A);for(D=0;D<m.length;D++){var J=m[D];J.dupli_group&&I(J,"dupli_group",A);J.parent&&I(J,"parent",A);J.dg_parent&&I(J,"dg_parent",A);if(J.animation_data){var F=J.animation_data;F.action&&I(F,"action",A);if(F.nla_tracks)for(O=0;O<F.nla_tracks.length;O++)for(var V=F.nla_tracks[O],
G=0;G<V.strips.length;G++)V.strips[G].action&&I(V.strips[G],"action",A)}switch(J.type){case "MESH":J.data||ra.l("mesh not found for object "+J.name);I(J,"data",A);for(var T=!1,L=J.modifiers,O=0;O<L.length;O++){var N=L[O];"ARMATURE"==N.type?(T&&pa.warn('Object "'+J.name+'" has more than one armature modifiers. Only the first one will be used.'),T=!0,I(N,"object",A)):"CURVE"==N.type&&I(N,"object",A)}var fa=J.particle_systems;if(fa)for(O=0;O<fa.length;O++)I(fa[O],"settings",A);break;case "ARMATURE":I(J,
"data",A);for(var ea=J.pose.bones,Q=J.data.bones,O=0;O<ea.length;O++){var R=ea[O];R.bone=Q[R.bone];var Y=R.constraints;if(Y)for(G=0;G<Y.length;G++){var W=Y[G];W.target&&I(W,"target",A)}for(var S=R.parent_recursive,G=0;G<S.length;G++)S[G]=ea[S[G]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":I(J,"data",A)}if(Y=J.constraints)for(O=0;O<Y.length;O++)W=Y[O],W.target&&I(W,"target",A);var ba=J.lod_levels;if(ba)for(O=0;O<ba.length;O++){var ia=ba[O];ia.object&&I(ia,"object",A)}}for(D=0;D<k.length;D++)for(var va=
k[D].materials,O=0;O<va.length;O++)I(va,O,A);for(D=0;D<g.length;D++){for(var U=g[D],Z=U.texture_slots,O=0;O<Z.length;O++)I(Z[O],"texture",A);var la=U.node_tree;la&&H(la,A)}for(D=0;D<n.length;D++)(la=n[D].node_tree)&&H(la,A);for(D=0;D<t.length;D++){var X=t[D],ha=X.type;"IMAGE"!=ha&&"ENVIRONMENT_MAP"!=ha||I(X,"image",A)}for(D=0;D<f.length;D++){var ja=f[D];ja.dof_object&&I(ja,"dof_object",A)}for(D=0;D<v.length;D++){var ka=v[D];ka.sound&&I(ka,"sound",A);if(ka.animation_data&&(F=ka.animation_data,F.action&&
I(F,"action",A),F.nla_tracks))for(O=0;O<F.nla_tracks.length;O++)for(V=F.nla_tracks[O],G=0;G<V.strips.length;G++)V.strips[G].action&&I(V.strips[G],"action",A)}for(D=0;D<l.length;D++){for(var da=l[D],Z=da.texture_slots,O=0;O<Z.length;O++)I(Z[O],"texture",A);da.dupli_group&&I(da,"dupli_group",A);da.dupli_object&&I(da,"dupli_object",A)}for(D=0;D<r.length;D++){var Ca=r[D];if(Ca.animation_data&&(F=Ca.animation_data,F.action&&I(F,"action",A),F.nla_tracks))for(O=0;O<F.nla_tracks.length;O++)for(V=F.nla_tracks[O],
G=0;G<V.strips.length;G++)V.strips[G].action&&I(V.strips[G],"action",A)}for(D=0;D<w.length;D++){var ua=w[D];if(Z=ua.texture_slots)for(O=0;O<Z.length;O++)I(Z[O],"texture",A);if(ua.animation_data&&(F=ua.animation_data,F.action&&I(F,"action",A),F.nla_tracks))for(O=0;O<F.nla_tracks.length;O++)for(V=F.nla_tracks[O],G=0;G<V.strips.length;G++)V.strips[G].action&&I(V.strips[G],"action",A)}ca.kM(a);for(var na=a.textures,Ba=c.gb?a.scenes[0].b4w_anisotropic_filtering:Fa.b4w_anisotropic_filtering,ta=0;ta<na.length;ta++)c.gb||
"SCENE"!=na[ta].b4w_source_type||(na[ta].b4w_source_id=""),Da.sN(na[ta],Ba,a.scenes,c.id);for(var qa={},sa=a.objects,wa=0;wa<sa.length;wa++){var za=sa[wa];if("MESH"===za.type&&!za.particle_systems.length)for(var Ea=za.data,Ga=Ea.name,Ha=Ea.submeshes,Ja=Ea.materials,Va=0;Va<Ha.length;Va++)0!==Ha[Va].base_length||qa[Ga]||(Ja[Va]&&pa.warn('material "'+Ja[Va].name+'" is not assigned to any face (object "'+za.name+'").'),qa[Ga]=!0)}for(var Oa=a.meshes,Ma=0;Ma<Oa.length;Ma++){var Sa=Oa[Ma];Sa.materials.length||
Sa.uv_textures.length&&pa.warn('mesh "'+Sa.name+'" has a UV map but has no exported material.')}a.materials.push(ca.bN());for(var Za=a.meshes,$a=ra.Mc("name","DEFAULT",a.materials),eb=0;eb<Za.length;eb++){var ya=Za[eb];0==ya.materials.length&&ya.materials.push($a)}for(var ib=a.actions,db=c.id,jb=0;jb<ib.length;jb++){var Na=ib[jb];Na.KK=db;ga.SK(Na)}for(var kb=a.scenes,Bb=0;Bb<kb.length;Bb++){for(var xb=kb[Bb],Pa=[],Xa=[],wb=kb[Bb].objects,Ya=0;Ya<wb.length;Ya++){var tb=wb[Ya];u(wb,tb,null,Pa,Xa);
var Ub=tb.dupli_group;if(Ub)for(var ab=Ub.objects,bb=0;bb<ab.length;bb++)u(ab,ab[bb],tb,Pa,Xa)}for(Ya=0;Ya<Xa.length;Ya++)for(var lb=Xa[Ya],qb=[xb],Cb=0;Cb<qb.length;Cb++){for(var Eb=qb[Cb].objects,Ob=0;Ob<Eb.length;Ob++){var cc=Eb[Ob].dupli_group;if(cc){var xc=cc.objects,Vb=xc.indexOf(lb);-1<Vb&&xc.splice(Vb,1)}}var Vb=Eb.indexOf(lb);-1<Vb&&Eb.splice(Vb,1)}for(Ya=0;Ya<Pa.length;Ya++)ra.mL(Pa[Ya][0],Pa[Ya][1])}!c.gb&&1<a.scenes.length&&(a.scenes=[Aa.Uq(a.scenes)],pa.warn("loading data contains multiple scenes.",
"Only the first one will be loaded."));var jc=c.gb?Fa:Aa.Uq(a.scenes);Ka.eS(Fa.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Fa),1),a.scenes.unshift(Fa));for(var Vc=0;Vc<a.scenes.length;Vc++){var kc=a.scenes[Vc];kc.j={};kc.VA=kc==jc;kc.LK=c.gb;fb.enabled&&kc.b4w_enable_physics&&(c.gb||!P.vs(Fa)&&kc==Aa.Uq(a))&&P.KP(kc);c.gb?kc.b4w_enable_audio&&ma.oB(kc):kc.b4w_enable_audio&&!Fa.Va&&ma.oB(Fa)}for(var sc=0;sc<a.scenes.length;sc++){for(var yc=a.scenes[sc],bc=q(yc),Hc=0;Hc<bc.length;Hc++){var Wb=
bc[Hc];xa.lM(Wb,yc,a)&&(Wb.Bc||(Wb.Bc=[]),Wb.Bc.push(c.gb?yc:Fa))}for(var hc=bc,lc=0;lc<hc.length;lc++){var Db=hc[lc];if(Db.Bc&&"WORLD"!=Db.type)for(var yd=Db.particle_systems,Lc=0;Lc<yd.length;Lc++){var Wc=yd[Lc].settings;if("HAIR"==Wc.type)if("OBJECT"==Wc.render_type){var Xc=Wc.dupli_object;Xc.Bc||(Xc.Bc=Db.Bc.slice())}else if("GROUP"==Wc.render_type)for(var Yc=Wc.dupli_group,hd=0;hd<Yc.objects.length;hd++)Xc=Yc.objects[hd],Xc.Bc||(Xc.Bc=Db.Bc.slice())}}}for(var jd=a.scenes,Qc=[],Lb=0;Lb<jd.length;Lb++)z(jd[Lb].objects,
0,c.gb,Qc);oa[c.id]=[];for(Lb=0;Lb<Qc.length;Lb++)for(var zd=Qc[Lb],zc=0;zc<zd.length;zc++)for(var Zc=zd[zc],$c=0;$c<Zc.length;$c++)oa[c.id].push(Zc[$c]);for(var ad=a.particles,Lb=0;Lb<ad.length;Lb++){var Ac=ad[Lb].dupli_object;Ac&&(Ac.UA=!0,oa[c.id].push(Ac));var Ad=ad[Lb].dupli_group;if(Ad)for(var kd=Ad.objects,zc=0;zc<kd.length;zc++)Ac=kd[zc],Ac.UA=!0,oa[c.id].push(Ac)}for(var Mc=oa[c.id],Lb=Mc.length-1;0<=Lb;Lb--)Mc[Lb].Bc||Mc.splice(Lb,1);for(var ld=oa[c.id],sc=0;sc<ld.length;sc++)if(Wb=ld[sc],
!c.gb&&Wb.parent&&-1<uc.indexOf(Wb.parent.type)&&(Wb.parent=""),"MESH"==Wb.type){var Nc=ca.pL(Wb);Nc&&(a.meshes.push(Nc),Wb.data=Nc)}for(var bd=0;bd<a.scenes.length;bd++){var md=a.scenes[bd],Rc=md.world;Rc.Bc||(Rc.Bc=[]);Rc.Bc.push(c.gb?md:Fa)}for(var cd=0;cd<a.scenes.length;cd++){var dd=a.scenes[cd];if(dd.b4w_use_logic_editor){var sd=q(dd);ca.yL(sd,dd)}}e(c,b)}function q(a){var c=[];g(a.objects,"ALL",c);return c}function g(a,c,b){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=c&&c!=e.type||b.push(e);
(e=e.dupli_group)&&g(e.objects,c,b)}}function z(a,c,b,d){d[c]=d[c]||[];for(var e=d[c],f=0;f<a.length;f++){var h=a[f],g=ia(h);e[g]=e[g]||[];(b||-1==uc.indexOf(h.type))&&-1==e[g].indexOf(h)&&e[g].push(h);(h=h.dupli_group)&&z(h.objects,c+1,b,d)}}function A(a,c,b){var d=[];a=oa[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==b||"ALL"==b)for(var h=0;h<f.Bc.length;h++)c==f.Bc[h]&&d.push(f)}return d}function J(a,c,b,d,e){var f=oa[c.id],h=a.worlds;d=c.id;for(var g=0;g<f.length;g++){for(var k=f[g],n=
da.tn(k.name,k.type,k.origin_name),m=0;m<k.Bc.length;m++)da.Tm(n,k.Bc[m]);k.ya=n;xa.Fi(k,n);n.g.Ad=d;n.mo=k.UA||!1}for(d=0;d<h.length;d++){g=h[d];k="%meta_world%"+g.name;k=da.tn(k,"WORLD",k);for(n=0;n<g.Bc.length;n++)da.Tm(k,g.Bc[n]);g.ya=k;xa.dU(g,k)}d=xa.Vh(c.id);for(g=0;g<f.length;g++)k=f[g],n=k.ya,ta.Fi(k,n);for(g=0;g<h.length;g++)k=h[g],ta.Fi(k,k.ya);if(c.gb)for(h=c.id,g=0;g<a.scenes.length;g++)for(var k=a.scenes[g],n=0,m=xa.Gb(k,"LAMP",h),l=0;l<m.length;l++)da.aa(m[l],k).Ij=n++;for(g=0;g<f.length;g++)k=
f[g],n=k.ya,n.mo||(xa.ST(k,n),Ma.p(n));for(a=0;a<f.length;a++)if(h=f[a],g=h.ya,da.hc(g)&&(k=h.lod_levels.length))for(n=g,m=0;m<k;m++)if(l=h.lod_levels[m].object){l=l.ya;l.g.xl=g.g.xl;n.g.ei=h.lod_levels[m].distance;l.g.uo=h.lod_levels[m].distance;if(h.lod_levels[m+1])l.g.ei=h.lod_levels[m+1].distance;else{l.g.Gr=!0;l.g.ei=xa.Yz;break}n.g.Gr=!1;n=l}else{n.g.Gr=!0;n.g.ei=h.lod_levels[m].distance;break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(h=a.dq)){var h=h.g,g=a.g.Ik,k=[],p;for(p in g)n=
g[p],k.push(4*n.$v,4*n.Mh);h.qF.push(k);h.Rs.push(a.g)}f=p=-1;a=ga.GD();for(h=0;h<d.length;h++)g=d[h],k=g.g,da.hc(g)&&k.ql&&(g=k.eh,g>p&&(p=g),a>=g&&g>f&&(f=g));for(h=0;h<d.length;h++)g=d[h],k=g.g,da.hc(g)&&k.ql&&(k.Sn=!0,p<a?k.eh=p:k.eh<=a?k.eh=f:(pa.warn('too many bones for "'+g.name+'" / '+k.eh+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),k.eh=p,k.Sn=!1),k.Sn=k.Sn&&!Eb.aD);for(p=0;p<d.length;p++)if(f=d[p],f.Ed)if(a=f.Vd,"CHASSIS"==a.Id){f.n=
{};f.n.Rn=a.Rn;f.n.Zm=a.Zm;f.n.ez=a.ez;f.n.gz=a.gz;f.n.fz=a.fz;f.n.Lz=a.Lz;f.n.ny=a.ny;f.n.vx=a.vx;f.n.Xk=0;f.n.Ym=1;f.n.im=0;f.n.speed=0;f.n.$j=[];f.n.Fo=[];f.n.km=null;g=(h=da.xf(f))?da.Gw(h,d):d;for(h=0;h<g.length;h++)k=g[h],k.Ed&&(n=k.Vd,P.OP(k)&&a.name==n.name?(n=P.JU(k.Vd.Id),f.n.$j[n]=k,f.n.Fo[n]=new Float32Array(8)):P.PE(k)&&a.name==n.name?(f.n.km=k,f.n.jm=n.jm,f.n.ap=n.ap,f.n.jo=n.jo,n=Ga.invert(f.g.i,Ga.create()),k=Ga.multiply(n,k.g.i,n),f.n.yH=k,n=new Float32Array([1,0,0]),Ga.Tc(n,k,n),
f.n.xH=n):P.OE(k)&&a.name==n.name?(f.n.Yy=k,f.n.Zo=n.Zo,f.n.zl=n.zl,n=Ga.invert(f.g.i,Ga.create()),k=Ga.multiply(n,k.g.i,n),f.n.uH=k,n=new Float32Array([1,0,0]),Ga.Tc(n,k,n),f.n.tH=n):P.QE(k)&&a.name==n.name&&(f.n.iz=k,f.n.zn=n.zn,n=Ga.invert(f.g.i,Ga.create()),k=Ga.multiply(n,k.g.i,n),f.n.IH=k,n=new Float32Array([1,0,0]),Ga.Tc(n,k,n),f.n.HH=n));4!=f.n.$j.length&&ra.l("Not enough wheels for chassis "+f.name)}else if("HULL"==a.Id)for(f.n={},f.n.$j=[],f.n.Fo=[],f.n.Rn=a.Rn,f.n.Zm=a.Zm,f.n.qj=a.qj,f.n.qk=
a.qk,f.n.rk=a.rk,f.n.Xk=0,f.n.Ym=1,f.n.im=0,f.n.speed=0,f.n.km=null,g=(h=da.xf(f))?da.Gw(h,d):d,h=0;h<g.length;h++)k=g[h],k.Ed&&(n=k.Vd,P.NP(k)&&a.name==n.name?(f.n.$j.push(k),f.n.Fo.push(new Float32Array(8))):P.PE(k)&&a.name==n.name?(f.n.km=k,f.n.jm=n.jm,f.n.ap=n.ap,f.n.jo=n.jo,n=Ga.invert(f.g.i,Ga.create()),k=Ga.multiply(n,k.g.i,n),f.n.yH=k,n=new Float32Array([1,0,0]),Ga.Tc(n,k,n),f.n.xH=n):P.OE(k)&&a.name==n.name?(f.n.Yy=k,f.n.Zo=n.Zo,f.n.zl=n.zl,n=Ga.invert(f.g.i,Ga.create()),k=Ga.multiply(n,
k.g.i,n),f.n.uH=k,n=new Float32Array([1,0,0]),Ga.Tc(n,k,n),f.n.tH=n):P.QE(k)&&a.name==n.name&&(f.n.iz=k,f.n.zn=n.zn,n=Ga.invert(f.g.i,Ga.create()),k=Ga.multiply(n,k.g.i,n),f.n.IH=k,n=new Float32Array([1,0,0]),Ga.Tc(n,k,n),f.n.HH=n));for(p=0;p<d.length;p++)if(f=d[p],f.Gj&&(a=f.Zk,"MAIN_BODY"==a.Id))for(f.Se={},f.Se.qj=a.qj,f.Se.qk=a.qk,f.Se.rk=a.rk,f.Se.lq=[],h=(h=da.xf(f))?da.Gw(h,d):d,g=0;g<h.length;g++)k=h[g],k.Gj&&(n=k.Zk,P.QP(k)&&a.name==n.name&&(f.Se.lq.push(k),k.OL=k.Zk.GH));e(c,b)}function N(a,
c,d,b,e){for(b=0;b<a.scenes.length;b++){var f=a.scenes[b];f.Hh=f.camera.ya}for(b=0;b<a.scenes.length;b++){var f=c.gb?a.scenes[b]:Fa,h=c.gb?xa.Gb(f,"LAMP",c.id):xa.Gb(f,"LAMP",0),g=xa.Gb(f,"ALL",c.id),k=A(c.id,f,"MESH"),n=A(c.id,f,"EMPTY");A(c.id,f,"WORLD");c.gb&&Aa.YK(f,g,h,k,n);for(var g=!1,m=0;m<n.length;m++)for(var l=n[m].ya,p=l.A,v=0;v<p.length;v++){var q=p[v].Ta,r=Aa.hI(q,l);f.name==q.name&&(g=g||r)}c.gb&&f.j.nc&&!g&&pa.warn('Scene "'+f.name+'" has water but has no wind.');n=[];Aa.zs(f);ka.LO(f,
k,h,n);m=A(c.id,f,"LINE");ka.KO(f,m);l=Aa.Jw(f);if(c.gb){m=f.j.Ts;if(m.zR||m.procedural_skydome)g=f.world.ya,ka.cL(f,m,g),ka.Kv(g,l,f);Aa.gD(l)}for(m=0;m<k.length;m++)ka.Kv(k[m].ya,l,f);for(m=0;m<n.length;m++)ka.Kv(n[m],l,f),xa.TQ(n[m]);g=xa.Gb(f,"ALL",c.id);Aa.zL(f,g,h);for(m=0;m<g.length;m++)l=g[m],l.g.Qf&&xa.uz(l),da.sM(l)&&(l.AF=!0)}Aa.ZK(Fa,a.textures,c.id);c.gb&&Fa.j.Am.length&&(c.Vw=!0);b=a.materials;if(wa.Yv&&Ea.qI)for(a=0;a<b.length;a++){k=b[a];m=k.texture_slots;for(f=0;f<m.length;f++)if(n=
m[f],l=n.texture,"IMAGE"==l.type||"ENVIRONMENT_MAP"==l.type)h=l.image,h.Xd||(-1<h.filepath.indexOf(".dds")?h.Xd=!0:(h.Xd=!l.b4w_disable_compression&&!n.use_map_normal&&"ENVIRONMENT_MAP"!=l.type&&!l.b4w_shore_dist_map&&"MOVIE"!=h.source,h.Xd&&(h.filepath+=".dds")));if(f=k.node_tree)for(k=f.nodes,f=0;f<k.length;f++)h=k[f],"TEXTURE"==h.type&&(m=h.texture)&&(h=m.image)&&!h.Xd&&(h.Xd=m.j.Xp&&!m.b4w_disable_compression&&"MOVIE"!=h.source&&"ENVIRONMENT_MAP"!=m.type,h.Xd&&(h.filepath+=".dds"))}else for(a=
a.images,b=0;b<a.length;b++)f=a[b],f.Xd=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds"));e(c,d)}function F(a,c,b,d,e){d=a.groups;for(var f=a.objects,h={},g={},k={},n={},m=0;m<d.length;m++){var l=d[m];h[l.uuid]=l;k[l.uuid]=l}for(m=0;m<f.length;m++)l=f[m],g[l.uuid]=l,n[l.uuid]=l;a=a.scenes;for(m=0;m<a.length;m++)G(a[m].objects,null,n,k,null);for(var p in k)p in h||d.push(k[p]);for(p in n)p in g||f.push(n[p]);e(c,b)}function G(a,c,b,d,e){for(var f=[],h=0;h<a.length;h++){var g=a[h],k=b[g.uuid];
if(g=k.proxy){c&&-1==f.indexOf(g.uuid)&&f.push(g.uuid);for(var n=b[g.uuid],m=n.constraints,g=0;g<m.length;g++){var l=ra.Ph(m[g]);l.name+="_CLONE";k.constraints.push(l)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(n.animation_data=ra.Ph(k.animation_data)),n.b4w_use_default_animation=k.b4w_use_default_animation,n.b4w_auto_skel_anim=k.b4w_auto_skel_anim,n.b4w_anim_behavior=k.b4w_anim_behavior,n.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(h=0;h<f.length;h++)k=ra.fP(a,
f[h]),-1<k&&a.splice(k,1);f={};if(c)for(h=0;h<a.length;h++)g=a[h],k=b[g.uuid],m=ra.Ph(k),n="origin_name"in k?k.origin_name:k.name,m.name=da.fD(c.name,n),m.origin_name=n,m.dg_parent={uuid:c.uuid},D(m),b[m.uuid]=m,f[g.uuid]=m.uuid,g.uuid=m.uuid,e&&e[k.uuid]&&(m.b4w_cluster_data=e[k.uuid]);for(h=0;h<a.length;h++)g=a[h],k=b[g.uuid],k.dupli_group&&(g=k.dupli_group,e=d[g.uuid],m=ra.Ph(e),m.name=ra.cp(e.name+"_CLONE"),m.uuid=Ba.yE("Group"+m.name),d[m.uuid]=m,g.uuid=m.uuid,G(m.objects,k,b,d,k.b4w_cluster_data));
if(c)for(h=0;h<a.length;h++){g=a[h];k=b[g.uuid];k.parent&&k.parent.uuid in f?k.parent.uuid=f[k.parent.uuid]:k.parent&&(pa.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);m=k.constraints;for(g=0;g<m.length;g++)c=m[g],c.target&&c.target.uuid in f&&(c.target.uuid=f[c.target.uuid]);if(c=k.pose)for(d=c.bones,g=0;g<d.length;g++)if(e=d[g].constraints)for(m=0;m<e.length;m++)c=e[m],c.target&&c.target.uuid in f&&(c.target.uuid=f[c.target.uuid]);c=k.modifiers;
for(g=0;g<c.length;g++)d=c[g],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(g=0;g<k.length;g++)c=k[g],c.object&&c.object.uuid in f&&(c.object.uuid=f[c.object.uuid])}for(var p in f)Ha[p]=f[p]}function D(a){a.uuid=Ba.yE("Object"+a.name)}function H(a,c){for(var b=a.nodes,e=0;e<b.length;e++){var f=b[e];"TEXTURE"==f.type&&f.texture&&I(f,"texture",c);"LAMP"==f.type&&f.lamp&&(f.lamp.uuid in Ha&&(f.lamp.uuid=Ha[f.lamp.uuid]),c[f.lamp.uuid]||(f.lamp=null));
"GROUP"==f.type&&f.node_group&&I(f,"node_group",c)}f=a.links;for(e=0;e<f.length;e++){var g=f[e];d(g,"from_node",b);d(g,"to_node",b);h(g,"from_socket",g.from_node.outputs);h(g,"to_socket",g.to_node.inputs)}if(b=a.animation_data)if(b.action&&I(b,"action",c),b.nla_tracks)for(e=0;e<b.nla_tracks.length;e++)for(f=b.nla_tracks[e],g=0;g<f.strips.length;g++)f.strips[g].action&&I(f.strips[g],"action",c)}function I(a,c,b){(b=b[a[c].uuid])||pa.error("Dangling link found:",c,a);a[c]=b}function d(a,c,b){b=ra.Mc("name",
a[c].name,b);a[c]=b}function h(a,c,b){b=ra.Mc("identifier",a[c].identifier,b);a[c]=b}function v(a,d,e,f,h,g){f=fa(d.cg);for(var k=a.images,n={},m=[],l=0;l<k.length;l++){var p=k[l],v=p.uuid;if("FILE"===p.source||"MOVIE"===p.source){var q=c(p,a.textures);if(!q.length)pa.warn("image ",p.name," has no users.");else if(!q[0].b4w_shore_dist_map){q=ra.vo(f+p.filepath);if("FILE"===p.source){var r=p.Xd?E.pp:E.qp,t=E.$o(q),u=t[1].toLowerCase();if(!E.rM(u)){pa.error("image ",p.name," has unsupported format.");
continue}wa.wx&&Ea.mt&&("dds"==t[1]?(q=E.$o(t[0]),q=q[0]+".min50."+q[1]+".dds"):q=t[0]+".min50."+t[1])}else if("MOVIE"===p.source)if(Ea.To)t=E.$o(q),q=t[0]+".altconv.seq",r=E.rp;else{var t=E.$o(q),u=t[1].toLowerCase(),w=ma.MN(u);if(""==w){pa.error("failed to load video file (unsupported format)",q);continue}q=w!=u?t[0]+".altconv."+w:t[0]+"."+t[1];r=E.sp}m.push({id:v,type:r,url:q});n[v]=p}}}if(m.length){var z=0;E.cd(m,function(f,h,k,l){if(f){if(k==E.sp||k==E.rp){if(k==E.sp)var p=f.videoWidth,v=f.videoHeight;
else p=f.images[0].width,v=f.images[0].height;pa.log("%cLOAD VIDEO "+p+"x"+v,"color: #"+(2048<p||2048<v?"a00":1024<p||1024<v?"aa0":"0a0"),l);-1==l.indexOf(Za)&&pa.warn("video",l,"is not from app root.")}else b(f,l,!0);h=n[h];l=c(h,a.textures);for(p=0;p<l.length;p++){var v=l[p],q=v.image.filepath;k==E.rp?(v.j.ty=f.Wg,Da.lt(v.j,f.images,h.Xd,q,d.id)):Da.lt(v.j,f,h.Xd,q,d.id)}}f=++z/m.length;g(d,e,f)},function(){pa.log("%cLOADED ALL IMAGES","color: #0a0");h(d,e)})}else h(d,e)}function M(a,c,b,d,e){a=
Aa.PD();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var h=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(h=!1);ta.YT(f,h,c.id)}}e(c,b)}function c(a,c){for(var b=[],d=0;d<c.length;d++){var e=c[d];e.image===a&&b.push(e)}return b}function p(a,c,b,d,e,f){a=fa(c.cg);var h=[],g={};d=xa.Vh(c.id);for(var k=0;k<d.length;k++){var n=d[k];if(R(n)){var m=n.P.Gi;"BACKGROUND_MUSIC"==ma.Nw(n)?(m=ra.xw(),c.Tw=!0):"NONE"!=ma.Nw(n)&&Ea.Yw&&(c.Xw=!0);if(!(m in g)){g[m]=[];var l=ra.vo(a+n.P.cg);switch(ma.sH(n)){case ma.xt:var p=
E.Uz;break;case ma.Sz:p=E.Vz}var v=E.$o(l),q=v[1].toLowerCase(),r=ma.KN(q);""!=r?(l=r!=q?v[0]+".altconv."+r:v[0]+"."+v[1],h.push({id:m,type:p,url:l})):pa.error("failed to load audio file (unsupported format)",l)}g[m].push(n)}}if(h.length){var t=0;E.cd(h,function(a,d,e,k){if(a)for(pa.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(Za)&&pa.warn("sound",k,"is not from app root."),d=g[d],e=0;e<d.length;e++)ma.bU(d[e],a);a=++t/h.length;f(c,b,a)},function(){pa.log("%cLOADED ALL SOUNDS","color: #0aa");
e(c,b)})}else e(c,b)}function R(a){return da.Hj(a)&&ma.sH(a)!=ma.Tz}function K(a,c,b){a=xa.Gb(a,"SPEAKER",c);for(c=0;c<a.length;c++){var d=a[c];da.Hj(d)&&(ma.JE(d)||b)&&ma.ZF(d)}}function t(a,c){for(var b=a.j.Am,d=0;d<b.length;d++){var e=b[d].j;a.b4w_use_nla&&b[d].b4w_nla_video||!b[d].use_auto_refresh||c!=e.Bh||(Da.xG(e.name,c),Da.aG(e.name,c))}}function y(a,c,b,d,e){ta.start();pa.log("%cSTART NLA","color: #0a0");e(c,b)}function u(a,c,b,d,e){if(c.lod_levels&&c.lod_levels.length)for(var f=c.lod_levels.length,
h=0;h<f;h++){var g=c.lod_levels[h],k=g.object;if(k){var n=ra.hn(k);n.name=c.name+"_LOD_"+String(h+1);n.b4w_cluster_data=c.b4w_cluster_data;D(n);n.lod_levels=[];b&&(n.dg_parent=b);d.push([a,n]);e.push(k);g.object=n}}}function C(a,c,b,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!P.yM(a.scenes[f])){d=!1;break}d&&(e(c,b),pa.log("%cPHYSICS READY","color: #0a0"))}function L(a,c,b,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(c.gb)var h=P.vs(f);else h=P.vs(Fa)||P.vs(f),f=Fa;if(fb.enabled&&
h)for(h=0;h<xb.length;h++)for(var g=xa.Gb(f,xb[h],c.id),k=0;k<g.length;k++){var n=g[k];n.g.Ad==c.id&&(P.Dk(n,f),c.gF&&P.ea(n)&&P.gw(n))}}e(c,b)}function n(a,d,e,f,h){var g={};f=[];for(var k=a.scenes,n=0;n<a.scenes.length;n++){var m=k[n];if(m.j.nc&&(m=m.j.nc.wi)&&"FILE"===m.source){var l=m.uuid,p=ra.vo(fa(d.cg)+m.filepath);f.push({id:l,type:m.Xd?E.pp:E.qp,url:p});g[l]=m}}f.length?E.cd(f,function(e,f,h,n){if(e){b(e,n,!0);f=g[f];n=c(f,a.textures);for(h=0;h<n.length;h++){var m=n[h];Da.lt(m.j,e,f.Xd,m.image.filepath,
d.id)}for(h=0;h<k.length;h++)if(n=k[h],n.j.nc&&(m=n.j.nc.wi,m===f)){var l=e,p=document.createElement("canvas"),m=f.size[0],v=f.size[1];p.width=m;p.height=v;p=p.getContext("2d");p.drawImage(l,0,0);l=p.getImageData(0,0,m,v).data;p=new Float32Array(4);p[0]=1/16581375;p[1]=1/65025;p[2]=1/255;p[3]=1;for(var m=m*v,v=new Float32Array(m),q=0;q<m;q++)v[q]=p[1]*l[4*q+2]+p[2]*l[4*q+3];n.j.Py=v}}else for(f=g[f],h=0;h<k.length;h++)n=k[h],m=n.j.nc.wi,m===f&&(n.j.nc.wi=null,pa.warn("image",m.filepath," was not found. Disabling water shore effects."))},
function(){h(d,e)}):h(d,e)}function T(a,c,d,e,f){e=a.scenes[0];a=[];for(var h=["SMAA_EDGE_DETECTION","SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING","SMAA_RESOLVE"],g=0;g<h.length;g++){var k=Aa.qa(e,h[g]);k&&a.push(k)}if(a.length){e=[];g=E.qp;e.push({id:"SEARCH_TEXTURE",type:g,cg:S.qd.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:g,url:S.qd.smaa_area_texture_path});for(g=0;g<a.length;g++)if(h=a[g],"SMAA_BLENDING_WEIGHT_CALCULATION"==h.type){a=h.Ga;for(g=0;g<a.length;g++)if(h=
a[g],"u_search_tex"==h.to)var n=h.Ja;else if("u_area_tex"==h.to)var m=h.Ja;break}e.length?E.cd(e,function(a,d,e,f){a&&(b(a,f,!1),d="SEARCH_TEXTURE"==d?n:m,d.source="IMAGE",d.RW=!0,Da.lt(d,a,-1!=f.indexOf(".dds")?1:0,f,c.id),Da.Ay(d,Da.F,Da.F))},function(){f(c,d)}):f(c,d)}else f(c,d)}function O(a,c,d,b){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];c.gb||(e=Fa);for(var f=xa.Gb(e,"LAMP",c.id),h=0;h<f.length;h++){var g=f[h];g.g.Ad==c.id&&b.Mu.push({Ta:e,Ca:g})}f=xa.Gb(e,"ALL",c.id);for(h=0;h<f.length;h++)g=
f[h],"LAMP"!=g.type&&g.g.Ad==c.id&&(c.gF&&da.hc(g)&&Aa.dn(g,!0),b.Mu.push({Ta:e,Ca:g}))}}function V(a,c,d,b,e,f){var h=b.Mu;e=b.JF;if(h.length){a=h[e].Ca;var g=h[e].Ta;e=da.aa(a,g);Aa.Dk(g,a,!1);!a.anchor||g.j.fo||g.j.anaglyph_use||va.append(a);b=++b.JF/h.length;h=e.Ng;if(null!=a.g.Qe&&h){var k=ib.copy(a.g.Yc.O,jb);Aa.gI(h,k)}h=a.Lo;if(h.length&&g.j.pg)for(g=Ga.q(a.g.i),a=Ga.B(a.g.i),e=e.og,k=0;k<e.length;k++)Aa.kI(e[k],g,a),da.lI(h,e[k].k.kc)}else b=1;f(c,d,b)}function Y(a,c,d,b,e){if(c.gb){b=Aa.xj();
var f=Aa.PD();for(a=0;a<f.length;a++){var h=f[a];Aa.nR(h,b);h.b4w_use_logic_editor&&ua.IP(h,c.id)}Aa.zs(b)}else Aa.mI(Fa);b=xa.Vh(c.id);xa.TT(b);for(f=0;f<b.length;f++)for(h=b[f],a=0;a<h.A.length;a++)for(var g=h.A[a].X,k=0;k<g.length;k++)null==g[k].rb&&g.splice(k--,1);e(c,d)}function la(a,c,d,b,e){if(c.gb)for(b=0;b<a.scenes.length;b++)t(a.scenes[b],c.id),K(a.scenes[b],c.id);else t(Fa,c.id),K(Fa,c.id);e(c,d)}function W(a,c,b,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;Ea.media_auto_activation&&
(c.Vw||c.Tw||c.Xw)?Sa||ba(a,e,c,b):e(c,b)}function ba(a,c,b,d){function e(){if(!g){g=!0;b.Vw&&(Da.play(),Da.pause(),Da.reset());if(b.Tw){if(b.gb)for(var f=0;f<a.scenes.length;f++)K(a.scenes[f],b.id,!0);else K(Fa,b.id,!0);ma.pause()}b.Xw&&ma.$F();aa();c(b,d)}}var f=Oa.parentElement;tb=f.style.zIndex;f.style.zIndex="999";Sa=document.createElement("div");Sa.style.position="relative";Sa.style.height="88px";Sa.style.width="88px";var h=Math.round(Oa.offsetWidth/2-44);Sa.style.top=Math.round(Oa.offsetHeight/
2-44).toString()+"px";Sa.style.left=h.toString()+"px";Sa.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Sa.style.backgroundSize="88px";qa=document.createElement("div");qa.style.position="relative";qa.style.height=Oa.offsetHeight.toString()+"px";qa.style.width=Oa.offsetWidth.toString()+"px";qa.style.background="rgba(0, 0, 0, 0.5)";qa.style.zIndex="999";f.appendChild(qa);qa.appendChild(Sa);Sa.addEventListener("touchstart",e,!1);Sa.addEventListener("click",e,!1);var g=!1}function aa(){if(Sa){var a=Oa.parentElement;a.style.zIndex=tb;qa.removeChild(Sa);a.removeChild(qa);Sa=qa=null;tb=0}}function fa(a){(a=
a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ea(a){ga.Xb(a)&&ga.remove(a);sa.xR(a);xa.rq(a);X.pq(a)&&X.Oo(a);P.ea(a)&&P.No(a);Aa.yR(a);da.Hj(a)&&ma.TS(a);va.MP(a)&&va.remove(a)}function ia(a){var c=ga.qD(a);return(a=c&&c.parent==a?null:a.parent||c)?1+ia(a):0}var va=l("__anchors"),ga=l("__animation"),E=l("__assets"),ka=l("__batch"),S=l("__config"),X=l("__controls"),Ca=l("__dds"),ha=l("__debug"),ja=l("__extensions"),Z=l("__input"),Q=l("__loader"),Ba=l("__md5"),ta=l("__nla"),ua=l("__logic_nodes"),
sa=l("__particles"),U=l("__nodemat"),xa=l("__objects"),da=l("__obj_util"),P=l("__physics"),pa=l("__print"),ca=l("__reformer"),za=l("__renderer"),Aa=l("__scenes"),ma=l("__sfx"),Ja=l("__shaders"),Da=l("__textures"),Ka=l("__time"),Ma=l("__transform"),Ga=l("__tsr"),ra=l("__util"),ib=l("__vec3"),Ea=S.v,wa=S.Ne,fb=S.r,Eb=S.Zi,na=S.P,cc=null,oa=null,Za="",Fa=null,Ha={},jb=new Float32Array(3),Sa=null,qa=null,tb=0,eb=!1,uc=["LAMP","CAMERA"],xb=["MESH","CAMERA","EMPTY"],Oa=null;a.ig=function(a){return Q.ig(a)};
a.update=function(){Q.ZT(cc)};a.CS=function(a){Oa=a};a.QT=function(a,c){if(Sa){qa.style.height=c.toString()+"px";qa.style.width=a.toString()+"px";var b=Math.round(a/2-44);Sa.style.top=Math.round(c/2-44).toString()+"px";Sa.style.left=b.toString()+"px"}};a.load=function(a,c,b,d,h){var g={load_main:{Ab:Q.Ni,Mb:!1,L:[],Qb:!1,Sb:500,jc:!1,Vb:e},duplicate_objects:{Ab:Q.ud,Mb:!1,L:["load_main"],Qb:!1,Sb:50,jc:!1,Vb:F},load_binaries:{Ab:Q.Ni,Mb:!1,L:["load_main"],Qb:!1,Sb:500,jc:!1,Vb:x},wait_for_shaders:{Ab:Q.ud,
Mb:!1,L:[],Qb:!1,Sb:50,jc:!0,Nh:k},prepare_bindata:{Ab:Q.ud,Mb:!1,L:["duplicate_objects","load_binaries"],Qb:!1,Sb:100,jc:!1,Vb:B},prepare_bpy_data:{Ab:Q.ud,Mb:!1,L:["duplicate_objects","prepare_bindata"],Qb:!1,Sb:100,jc:!1,Vb:f},process_objects:{Ab:Q.ud,Mb:!1,L:["prepare_bpy_data"],Qb:!1,Sb:150,jc:!1,Vb:J},process_scenes:{Ab:Q.ud,Mb:!1,L:["process_objects","wait_for_shaders"],Qb:!1,Sb:300,jc:!1,Vb:N},load_smaa_textures:{Ab:Q.Ni,Mb:!1,L:["process_scenes"],Qb:!1,Sb:30,jc:!0,Vb:T},load_shoremap:{Ab:Q.Ni,
Mb:!1,L:["process_scenes"],Qb:!1,Sb:30,jc:!0,Vb:n},load_textures:{Ab:Q.Ni,Mb:!0,L:["process_scenes"],Qb:!0,Sb:500,jc:!1,Vb:v},update_scenes_nla:{Ab:Q.ud,Mb:!1,L:["process_scenes","load_textures"],Qb:!1,Sb:50,jc:!1,Vb:M},wait_physics_workers:{Ab:Q.ud,Mb:!1,L:["load_shoremap"],Qb:!1,Sb:20,jc:!1,Nh:C},add_physics_objects:{Ab:Q.ud,Mb:!1,L:["wait_physics_workers"],Qb:!1,Sb:50,jc:!1,Vb:L},add_objects:{Ab:Q.ud,Mb:!1,L:["add_physics_objects"],Qb:!1,Sb:600,jc:!1,Vb:O,Nh:V,bn:Y,cn:{Mu:[],JF:0}},load_speakers:{Ab:Q.Ni,
Mb:!0,L:["add_objects"],Qb:!0,Sb:100,jc:!1,Vb:p},mobile_media_start:{Ab:Q.ud,Mb:!1,L:["load_textures","update_scenes_nla","load_speakers"],Qb:!0,Sb:5,jc:!1,Vb:W,Nh:W},synchronize_media:{Ab:Q.ud,Mb:!0,L:["mobile_media_start"],Qb:!0,Sb:50,jc:!1,Vb:la},start_nla:{Ab:Q.ud,Mb:!0,L:["mobile_media_start"],Qb:!1,Sb:5,jc:!0,Vb:y}},l=Q.UD();l||(l=Q.jN(),cc={},oa={},Ha={});cc[l.wg.length]={};return Q.tN(g,a,c,b,m,d||na.pB,Ea.do_not_load_resources,h)};a.kt=function(a){var c=Q.UD();if(!c||!c.wg.length||a&&!Q.pT(c.wg[a]))pa.error("Unable to unload data!");
else{if(0==a)pa.log("%cUNLOAD ALL","color: #00a"),va.ha(),ga.ha(),ma.ha(),ta.ha(),ka.ha(),Aa.ha(),Q.ha(),X.ha(),P.ha(),xa.ha(),ra.ha(),za.ha(),U.ha(),Ja.ha(),ja.ha(),E.ha(),Da.ha(),ua.ha(),sa.ha(),Z.ha(),ha.ha(),oa=null,Ha={},cc=Fa=null,eb=!1;else{pa.log("%cUNLOAD DATA "+a,"color: #00a");ga.vR(a);for(var c=xa.Vh(xa.oc),b=0;b<c.length;b++){var d=c[b];da.Kw(d)!=a&&xa.Wr(d,!1,!1,!1,!1)}c=xa.Vh(a);for(b=c.length-1;0<=b;b--)d=c[b],ea(d),xa.No(d);c=xa.Vh(xa.oc);for(b=0;b<c.length;b++)xa.Wr(c[b],!0,!0,!0,
!0)}aa()}};a.mR=ea;a.OG=function(a){Za=a};a.aB=function(){eb||Ea.media_auto_activation||(Da.play(),Da.pause(),Da.reset(),K(Fa,xa.oc,!0),ma.pause(),Ea.Yw&&ma.$F(),eb=!0)}};b4w.module.__controls=function(a,l){function m(a,c){c||(c=z.le());return{type:a,value:0,la:null,element:c,Da:!1,key:0,pb:"",Yf:!1,Bv:null,Av:function(){},zv:null,XB:function(){},yi:null,from:new Float32Array(3),to:new Float32Array(3),DE:!1,rr:!1,Io:0,qG:function(){},axis:"",Ce:0,sm:new Float32Array(3),qs:new Float32Array(4),threshold:0,jG:new Float32Array(4),gq:0,fq:0,BG:0,hq:0,re:0,repeat:!1,qB:!1,uj:0,callback:function(){}}}function b(a){a||(a=z.le());for(var c=0;c<K.length;c++){var b=K[c];if(a==
b.element)return b}b={element:a,tl:!0,ol:!1,Dr:!0,zx:0,Ax:0,Bl:0,Cl:0,Nf:new Float32Array(2),Sd:new Float32Array(2),Of:new Float32Array(2),De:new Float32Array(2),dt:0,qz:0,YH:0,bd:new Uint8Array(256),ut:0,sy:null,ex:!1,lE:G.create(),nr:0,mr:0,lr:0,Rw:0,Qw:0,kr:Infinity,O_:null,nh:{},OF:function(a){b.ex||(A.uP(a,b.lE),b.ex=!0)},NF:function(a){a=d.copy(a,u);b.lr=a[0];b.mr=a[1];b.nr=a[2];Infinity==b.kr&&(b.kr=a[0],b.Qw=a[1],b.Rw=a[2])},xF:function(a){b.ut+=a*h.LQ},tF:function(a){var c=A.da(A.Oc,b.element),
c=A.Yh(c,A.Fh,t);b.zx=c[0];b.Ax=c[1];b.Bl=c[0];b.Cl=c[1];b.ol=!0;b.which=a},vF:function(){var a=A.da(A.Oc,b.element),a=A.Yh(a,A.Fh,t),a=z.tq(a[0],a[1],t);b.sy=J.ks(a[0],a[1])},WH:function(a){1==a.length&&(a=z.tq(a[0].clientX,a[0].clientY,t),b.sy=J.ks(a[0],a[1]))},wF:function(){b.ol=!1},uF:function(a){if(!v.qr||b.ol)b.Bl=a[0],b.Cl=a[1]},UE:function(a){2!=b.bd[a]&&(b.bd[a]=1,b.tl=!1)},WE:function(){for(var a=0;a<b.bd.length;a++)0!=b.bd[a]&&(b.bd[a]=3,b.tl=!1)},XE:function(a){1==b.bd[a]?b.bd[a]=0:(b.tl&=
0,b.bd[a]=3)},XH:function(a){b.Dr=!1;if(1==a.length)b.Nf[0]=a[0].clientX,b.Nf[1]=-1,b.Of[0]=a[0].clientY,b.Of[1]=-1;else if(1<a.length){b.dt=b.qz=f(a);b.Nf[0]=a[0].clientX;b.Nf[1]=a[1].clientX;b.Of[0]=a[0].clientY;b.Of[1]=a[1].clientY;var c=a[0];a=a[1];b.YH=Math.atan2(c.clientY-a.clientY,c.clientX-a.clientX)}b.Sd.set(b.Nf);b.De.set(b.Of)},VH:function(a){1===a.length?(b.Sd[0]=a[0].clientX,b.Sd[1]=-1,b.De[0]=a[0].clientY,b.De[1]=-1):1<a.length&&(b.Sd[0]=a[0].clientX,b.Sd[1]=a[1].clientX,b.De[0]=a[0].clientY,
b.De[1]=a[1].clientY,b.dt=f(a))},UH:function(a){0==a.length&&(b.Dr=!0)}};K.push(b);return b}function e(a,c){if(c in a.nh&&0<a.nh[c])a.nh[c]+=1;else switch(a.nh[c]=1,c){case "orientation_quat":var b=A.da(A.Uf);b&&A.Xc(b,A.uk,a.OF);break;case "orientation_angles":(b=A.da(A.Uf))&&A.Xc(b,A.uk,a.NF);break;case "mouse_wheel":(b=A.da(A.Oc,a.element))&&A.Xc(b,A.Jm,a.xF);break;case "mouse_down_which":(b=A.da(A.Oc,a.element))&&A.Xc(b,A.Pi,a.tF);break;case "mouse_select":(b=A.da(A.Oc,a.element))&&A.Xc(b,A.Pi,
a.vF);break;case "touch_select":(b=A.da(A.nf,a.element))&&A.Xc(b,A.Si,a.WH);break;case "mouse_up_which":(b=A.da(A.Oc,a.element))&&A.Xc(b,A.Im,a.wF);break;case "mouse_location":(b=A.da(A.Oc,a.element))&&A.Xc(b,A.Fh,a.uF);break;case "keyboard_downed_keys":if(b=A.da(A.Dm,a.element))A.Xc(b,A.Gm,a.UE),A.Xc(b,A.dA,a.WE),A.Xc(b,A.Hm,a.XE);break;case "touch_start":(b=A.da(A.nf,a.element))&&A.Xc(b,A.Si,a.XH);break;case "touch_move":(b=A.da(A.nf,a.element))&&A.Xc(b,A.Mm,a.VH);break;case "touch_end":(b=A.da(A.nf,
a.element))&&A.Xc(b,A.Lm,a.UH)}}function x(a,c){if(!(!c in a.nh)&&0<a.nh[c]&&(--a.nh[c],!a.nh[c]))switch(c){case "orientation_quat":var b=A.da(A.Uf);b&&A.$c(b,A.Hp,a.OF);break;case "orientation_angles":(b=A.da(A.Uf))&&A.$c(b,A.uk,a.NF);break;case "mouse_wheel":(b=A.da(A.Oc,a.element))&&A.$c(b,A.Jm,a.xF);break;case "mouse_down_which":(b=A.da(A.Oc,a.element))&&A.$c(b,A.Pi,a.tF);break;case "mouse_select":(b=A.da(A.Oc,a.element))&&A.$c(b,A.Pi,a.vF);break;case "touch_select":(b=A.da(A.nf,a.element))&&
A.$c(b,A.Si,a.WH);break;case "mouse_up_which":(b=A.da(A.Oc,a.element))&&A.$c(b,A.Im,a.wF);break;case "mouse_location":(b=A.da(A.Oc,a.element))&&A.$c(b,A.Fh,a.uF);break;case "keyboard_downed_keys":if(b=A.da(A.Dm,a.element))A.$c(b,A.Gm,a.UE),A.$c(b,A.dA,a.WE),A.$c(b,A.Hm,a.XE);break;case "touch_start":(b=A.da(A.nf,a.element))&&A.$c(b,A.Si,a.XH);break;case "touch_move":(b=A.da(A.nf,a.element))&&A.$c(b,A.Mm,a.VH);break;case "touch_end":(b=A.da(A.nf,a.element))&&A.$c(b,A.Lm,a.UH)}}function k(a,c){a.value=
Number(c)}function B(a){for(var c=a.ri,b=a.RR,d=0;d<c.length;d++)b[d]=c[d].value;return a.xQ(b)}function r(a,b){a=a||c;var d=a.Lf;if(d){var e=a.ck;if(b){var f=d[b];if(f){for(var h=f.ri,g=0;g<h.length;g++){var k=h[g],m;m=p.indexOf(k);m=-1<m?R[m]:[];1==m.length?(w(k),k=p.indexOf(k),-1<k?(p.splice(k,1),R.splice(k,1)):I.l("Sensors cache is corrupted")):1<m.length&&m.splice(m.indexOf(f),1)}delete d[b];g=e.indexOf(f);-1<g?e.splice(g,1):I.l("Incorrect manifolds array");Object.getOwnPropertyNames(d).length||
(d=M.indexOf(a),-1<d?M.splice(d,1):N.error("Wrong object"))}}else{e=[];for(b in d)e.push(b);for(g=0;g<e.length;g++)r(a,e[g])}C=!0}}function w(a){switch(a.type){case 90:F.fy(a.Bv,a.pb,a.Av);a.Da=!0;break;case 100:F.xv(a.zv);a.Da=!0;break;case 110:F.gy(a.Io);a.Da=!0;break;case 140:a.Da=!0;break;case 20:var c=b(a.element);x(c,"keyboard_downed_keys");a.Da=!0;break;case 30:c=b(a.element);x(c,"mouse_wheel");a.Da=!0;break;case 40:c=b(a.element);x(c,"mouse_down_which");x(c,"mouse_up_which");x(c,"mouse_location");
a.Da=!0;break;case 50:c=b(a.element);x(c,"mouse_down_which");x(c,"mouse_up_which");a.Da=!0;break;case 60:c=b(a.element);x(c,"touch_start");x(c,"touch_move");x(c,"touch_end");a.Da=!0;break;case 70:c=b(a.element);x(c,"touch_start");x(c,"touch_move");a.Da=!0;break;case 75:c=b(a.element);x(c,"touch_start");x(c,"touch_move");a.Da=!0;break;case 80:c=b(a.element);x(c,"touch_start");x(c,"touch_end");a.Da=!0;break;case 170:c=b(a.element);x(c,"mouse_select");x(c,"touch_select");x(c,"touch_start");x(c,"touch_end");
x(c,"mouse_down_which");x(c,"mouse_up_which");a.Da=!0;break;case 180:case 190:c=b(a.element);x(c,"orientation_angles");a.Da=!0;break;case 200:c=b(a.element);x(c,"orientation_quat");a.Da=!0;break;case 210:case 220:a.Da=!0}}function f(a){var c=a[0],b=a[1];a=c.clientX-b.clientX;c=c.clientY-b.clientY;return Math.sqrt(a*a+c*c)}function q(a){return 0==a?A.da(A.vp):1==a?A.da(A.Et):2==a?A.da(A.Ft):A.da(A.Gt)}var g=l("__config"),z=l("__container"),A=l("__input"),J=l("__objects"),N=l("__print"),F=l("__physics"),
G=l("__quat"),D=l("__time"),H=l("__tsr"),I=l("__util"),d=l("__vec3");l("__vec4");var h=g.controls,v=g.v,M=[],c={},p=[],R=[],K=[],t=new Float32Array(2),y=new Float32Array(2),u=d.create();G.create();var C=!1,L=0;a.Cg=10;a.Ua=20;a.Bt=30;a.mf=40;a.Bg=50;a.At=60;a.Pp=0;a.Op=1;a.Np=2;a.Du=3;a.update=function(e,f){for(var h=0;h<p.length;h++){var g=p[h],m=e,l=f;if(l)switch(g.type){case 120:var r=g.yi,u=H.q(r.g.i),r=H.B(r.g.i),w=d.dist(g.sm,u),z=g.jG;G.invert(g.qs,z);G.multiply(r,z,z);G.normalize(z,z);z=Math.abs(2*
Math.acos(z[3]));w/=l;g.gq=I.mc(w,g.gq,l,.3);g.la[0]=w;w=z/l;g.fq=I.mc(w,g.fq,l,.3);g.la[1]=w;g.gq>=g.threshold||g.fq>=g.BG?k(g,1):k(g,0);d.copy(u,g.sm);G.copy(r,g.qs);g.Ce=m;break;case 130:r=g.yi;u=H.q(r.g.i);r=Math.abs(u[1]-g.sm[1])/l;g.hq=I.mc(r,g.hq,l,.3);g.la=r;g.hq>=g.threshold?k(g,1):k(g,0);d.copy(u,g.sm);g.Ce=m;break;case 140:!g.Da&&0<=g.re&&m-g.Ce>=g.re&&(k(g,1),g.repeat?g.Ce=m:g.re=-g.re);break;case 150:g.Ce||(g.Ce=m);k(g,m-g.Ce);g.Ce=m;break;case 160:k(g,m);break;case 180:l=b(g.element);
g.la[0]=l.nr-l.Rw;g.la[1]=l.mr-l.Qw;g.la[2]=l.lr-l.kr;break;case 190:l=b(g.element);g.la[0]=l.nr;g.la[1]=l.mr;g.la[2]=l.lr;break;case 200:l=b(g.element);G.copy(l.lE,g.la);break;case 210:m=A.da(A.td);A.Yh(m,A.Ip,g.la);break;case 220:m=A.da(A.td);A.Yh(m,A.Jp,g.la);break;case 240:m=q(g.uj);g.value=A.eP(m,g.key);break;case 250:m=q(g.uj);g.value=A.dP(m,g.key);break;case 230:k(g,g.callback());break;case 30:l=b(g.element);k(g,l.ut);break;case 40:l=b(g.element);if(!v.qr||l.ol)switch(m=l.Bl-l.zx,u=l.Cl-l.Ax,
g.axis){case "X":k(g,m);g.la=l.Bl;break;case "Y":k(g,u);g.la=l.Cl;break;case "XY":r=Math.sqrt(m*m+u*u),k(g,r),g.la[0]=l.Bl,g.la[1]=l.Cl}break;case 50:l=b(g.element);k(g,l.ol);g.la=l.which;break;case 170:l=b(g.element);g.qB&&!l.ol&&l.Dr||l.sy!=g.yi?k(g,0):k(g,1);break;case 20:l=b(g.element);g.la=l.bd[g.key];1==g.la||l.bd[0]&&16==g.key?k(g,1):g.la&&3!=g.la||k(g,0);break;case 60:l=b(g.element);-1==l.Sd[1]&&-1==l.De[1]?(m=l.Sd[0]-l.Nf[0],u=l.De[0]-l.Of[0],r=Math.sqrt(m*m+u*u),-1!=l.Nf[1]&&-1!=l.Of[1]&&
(w=l.Sd[0]-l.Nf[1],l=l.De[0]-l.Of[1],z=Math.sqrt(w*w+l*l),z<r&&(m=w,u=l,r=z)),g.la=a.Pp):(u=t,u[0]=(l.Sd[0]+l.Sd[1])/2,u[1]=(l.De[0]+l.De[1])/2,r=y,r[0]=(l.Nf[0]+l.Nf[1])/2,r[1]=(l.Of[0]+l.Of[1])/2,m=u[0]-r[0],u=u[1]-r[1],r=Math.sqrt(m*m+u*u),g.la=a.Np);switch(g.axis){case "X":k(g,m);break;case "Y":k(g,u);break;case "XY":k(g,r)}break;case 70:l=b(g.element);m=l.dt-l.qz;g.la=a.Op;k(g,m);break;case 75:l=b(g.element);-1!=l.Sd[1]&&(m=Math.atan2(l.De[0]-l.De[1],l.Sd[0]-l.Sd[1]),g.la=a.Du,k(g,m-l.YH));break;
case 80:l=b(g.element),l.Dr?k(g,0):k(g,1)}}for(h=0;h<M.length;h++)for(l=M[h],g=l.ck,m=0;m<g.length;m++)if(u=g[m],u.fI!=L){u.fI=L;z=u;r=0;switch(z.type){case a.Cg:r=(w=B(z))?1:0;break;case a.Ua:r=z.bh;(w=B(z))?(r=1,z.bh=1):1==r?(r=-1,z.bh=-1):r=0;break;case a.Bt:r=z.bh;(w=B(z))&&-1==r?(r=1,z.bh=1):w||1!=r?r=0:(r=-1,z.bh=-1);break;case a.mf:r=z.bh;(w=B(z))&&-1==r?(r=1,z.bh=1):w||1!=r?r=0:(r=0,z.bh=-1);break;case a.Bg:w=B(z);z.ZE!=w?(r=1,z.ZE=w):r=0;break;case a.At:for(var w=z.ri,z=z.bQ,x=0;x<w.length;x++){var D=
w[x].value;r||D==z[x]||(r=1);z[x]=D}break;default:I.l("Wrong sensor manifold type: "+z.type)}if(r&&(w=l==c?null:l,C=!1,u.callback(w,u.id,r,u.aM),C)){h=-1;break}}for(h=0;h<M.length;h++)for(l=M[h],g=l.ck,m=0;m<g.length;m++)for(u=g[m],l=u.ri,u=0;u<l.length;u++)switch(r=l[u],r.type){case 30:k(r,0);break;case 40:k(r,0);break;case 60:k(r,0);break;case 70:k(r,0);break;case 75:k(r,0);break;case 80:k(r,0);break;case 140:k(r,0)}for(h=0;h<K.length;h++){g=K[h];if(!g.tl){for(m=0;m<g.bd.length;m++)1==g.bd[m]?g.bd[m]=
2:3==g.bd[m]&&(g.bd[m]=0);g.tl=!0}g.ut=0;g.zx=g.Bl;g.Ax=g.Cl;g.bd[0]=!1;g.Nf.set(g.Sd);g.Of.set(g.De);g.qz=g.dt;g.Rw=g.nr;g.Qw=g.mr;g.kr=g.lr;g.ex=!1}L++};a.Jv=function(a){var c=m(10);k(c,a);return c};a.dc=function(a){var c=m(20,document);c.key=a;c.Da=!0;return c};a.Dq=function(a,c){var b=m(240,document);c=c||A.BD();b.uj=c;b.key=a;b.Da=!0;return b};a.Mk=function(a,c){var b=m(250,document);c=void 0==c?A.BD():c;b.uj=c;b.key=a;b.Da=!0;return b};a.Iv=function(a,c,b){if(!a||!F.ea(a))return N.error("Wrong collision object"),
null;var d=m(90);d.Bv=a;d.pb=c;d.Yf=b;d.la={coll_obj:null,coll_pos:b?new Float32Array(3):null,coll_norm:b?new Float32Array(3):null,coll_dist:0};d.Av=function(a,c,b,e,f){k(d,a);a=d.la;a.coll_obj=c;d.Yf&&(a.coll_pos.set(b),a.coll_norm.set(e),a.coll_dist=f)};d.Da=!0;return d};a.gC=function(a){if(!a||!a.r)return N.error("Wrong collision impulse object"),null;var c=m(100);c.zv=a;c.XB=function(a){k(c,a)};c.Da=!0;return c};a.nC=function(a,c,b,d,e,f,h){var g=m(110);g.yi=a;g.from=c;g.to=b;g.pb=d;g.DE=e;g.Yf=
f;g.rr=h;g.la={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Io:0};g.qG=function(a,c,b,d,e,f){g.DE?k(g,-1==c?0:1):k(g,c);g.la.hit_fract=c;g.la.obj_hit=b;g.la.hit_time=d;g.Yf&&(g.la.hit_pos.set(e),g.la.hit_norm.set(f))};g.Da=!0;return g};a.sn=function(a){a=m(50,a);a.Da=!0;return a};a.Mv=function(a){a=m(30,a);a.Da=!0;return a};a.Ok=function(a,c){var b=m(40,c);b.axis=a||"XY";b.la="XY"==b.axis?new Float32Array(2):0;b.Da=!0;return b};a.Fq=function(a,c){var b=
m(60,c);b.axis=a||"XY";b.la=0;b.Da=!0;return b};a.Ov=function(a){a=m(70,a);a.la=0;a.Da=!0;return a};a.rC=function(a){a=m(75,a);a.la=0;a.Da=!0;return a};a.qC=function(a){a=m(80,a);a.la=0;a.Da=!0;return a};a.mC=function(a,c,b){if(!a)return N.error("Wrong collision object"),null;var d=m(120);d.yi=a;var e=H.q(a.g.i);a=H.B(a.g.i);d.jG=new Float32Array(4);d.sm=new Float32Array(e);d.qs=new Float32Array(a);d.gq=0;d.fq=0;d.threshold=c||.1;d.BG=b||.1;d.Ce=0;d.la=new Float32Array([0,0]);return d};a.sC=function(a,
c){if(!a)return N.error("Wrong collision object"),null;var b=m(130);b.yi=a;var d=H.B(a.g.i);b.sm=new Float32Array(H.q(a.g.i));b.qs=new Float32Array(d);b.hq=0;b.threshold=c||1;b.Ce=0;b.la=0;return b};a.pC=function(a,c){var b=m(140);b.re=a;b.repeat=c;b.Da=!0;return b};a.wG=function(a,b,d,e){a=a||c;a=a.Lf;if(!a||!a[b])return N.error("reset_timer_sensor(): wrong object"),null;b=a[b].ri[d];if(!b)return N.error("reset_timer_sensor(): sensor not found"),null;b.Ce=D.ao();b.re=e};a.Cq=function(){var a=m(150);
a.Ce=0;return a};a.iC=function(){var a=m(180,window);a.la=new Float32Array(3);A.da(A.Uf)?k(a,1):k(a,0);a.Da=!0;return a};a.hC=function(){var a=m(190,window);a.la=new Float32Array(3);A.da(A.Uf)?k(a,1):k(a,0);a.Da=!0;return a};a.jC=function(){var a=m(200,window);a.la=G.create();A.da(A.Uf)?k(a,1):k(a,0);a.Da=!0;return a};a.lC=function(){var a=m(210,window);a.la=G.create();A.da(A.td)?k(a,1):k(a,0);a.Da=!0;return a};a.kC=function(){var a=m(220,window);a.la=d.create();A.da(A.td)?k(a,1):k(a,0);a.Da=!0;return a};
a.oC=function(){return m(160)};a.Eq=function(a,c){var b=m(170);b.yi=a;b.qB=c;b.Da=!0;return b};a.Hv=function(a,c){var b=m(230);b.callback=a;k(b,c);return b};a.QR=k;a.Xe=function(a,b,d){a=a||c;a=a.Lf;if(!a||!a[b])return N.error("get_sensor_value(): wrong object"),null;b=a[b].ri[d];return b?b.value:(N.error("get_sensor_value(): sensor not found"),null)};a.gg=function(a,b,d){a=a||c;a=a.Lf;if(!a||!a[b])return N.error("get_sensor_payload(): wrong object"),null;b=a[b].ri[d];return b?b.la:(N.error("get_sensor_payload(): sensor not found"),
null)};a.ha=function(){M=[];c={};for(var a=0;a<p.length;a++)w(p[a]);p.length=0;R.length=0};a.pq=function(a,b){a=a||c;if(!a.Lf)return!1;if(b&&a.Lf[b])return!0;if(!b)for(var d in a.Lf)return!0;return!1};a.ja=function(a,d,f,h,g,k,m){a=a||c;a.ck=a.ck||[];a.Lf=a.Lf||{};var l=a.Lf,v=a.ck;l[d]&&r(a,d);f={id:d,type:f,ri:h.slice(0),xQ:g,RR:Array(h.length),callback:k,aM:m,bh:-1,ZE:0,bQ:Array(h.length),fI:-1};l[d]=f;v.push(f);-1==M.indexOf(a)&&M.push(a);h=f.ri;for(a=0;a<h.length;a++){l=d=h[a];if(l.Da){switch(l.type){case 90:F.Su(l.Bv,
l.pb,l.Av,l.Yf);break;case 100:F.Uu(l.zv,l.XB);break;case 110:l.Io=F.bq(l.yi,l.from,l.to,l.pb,l.qG,!1,!1,l.Yf,l.rr);l.la.Io=l.Io;break;case 140:l.Ce=D.ao();0>l.re&&(l.re=-l.re);break;case 20:v=b(l.element);e(v,"keyboard_downed_keys");break;case 30:v=b(l.element);e(v,"mouse_wheel");break;case 40:v=b(l.element);e(v,"mouse_down_which");e(v,"mouse_up_which");e(v,"mouse_location");break;case 50:v=b(l.element);e(v,"mouse_down_which");e(v,"mouse_up_which");break;case 60:v=b(l.element);e(v,"touch_start");
e(v,"touch_move");e(v,"touch_end");break;case 70:v=b(l.element);e(v,"touch_start");e(v,"touch_move");break;case 75:v=b(l.element);e(v,"touch_start");e(v,"touch_move");break;case 80:v=b(l.element);e(v,"touch_start");e(v,"touch_end");break;case 170:v=b(l.element);e(v,"mouse_select");e(v,"touch_select");e(v,"touch_start");e(v,"touch_end");e(v,"mouse_down_which");e(v,"mouse_up_which");break;case 180:case 190:v=b(l.element);e(v,"orientation_angles");break;case 200:v=b(l.element);e(v,"orientation_quat");
break;case 240:0==l.uj?A.da(A.vp):1==l.uj?A.da(A.Et):2==l.uj?A.da(A.Ft):A.da(A.Gt)}l.Da=!1}l=p.indexOf(d);-1==l?(p.push(d),R.push([f])):R[l].push(f)}C=!0};a.CC=function(a){for(var c=0;c<a.length;c++)if(!a[c])return a[c];return a[a.length-1]};a.DC=function(a){for(var c=0;c<a.length;c++)if(a[c])return a[c];return a[a.length-1]};a.Oo=r;a.reset=function(){for(var a=0;a<M.length;a++){var c=M[a],b=c.Lf,c=c.ck,d;for(d in b)delete b[d];c.length=0}for(a=0;a<p.length;a++)w(p[a]);M.length=0;p.length=0;R.length=
0};a.debug=function(){N.log(String(M.length)+" objects with manifolds",M);N.log(String(p.length)+" sensors",p);for(var a=[],c=[],b=0;b<p.length;b++){var d=p[b];90==d.type&&a.push(d);110==d.type&&c.push(d)}N.log(String(a.length)+" collision sensors",a);N.log(String(c.length)+" ray sensors",c)}};b4w.module.__loader=function(a,l){function m(e,f,d,h){var k=D,l=N.create(),c;for(c in f){var m=b(f[c]);(h&&m.Qb||!e&&m.jc)&&g(m);N.C(l,m)}for(c in f)for(m=f[c],m.name=c,e=0;e<m.L.length;e++)N.m(l,f[m.L[e]],m,null);f=b({name:"out",Ab:a.XI,Vb:function(a,c,b,d,e){c.gb&&(k.$y=!0);J(c)||(c.status=2);c.hF(c.id,!0);e(c,b);F.log("%cTHREAD "+c.id+": LOADED CALLBACK","color: #f0f;")},Sb:5});if(d)d=N.$n(l);else{c=N.clone(l);do{d=N.$n(c);m=[];for(e=0;e<d.length;e++){h=d[e];var q=N.Ra(c,h);q.Mb&&m.push(h)}for(e=
0;e<m.length;e++)N.Kf(c,m[e]);m.length&&N.wv(c)}while(m.length)}N.C(l,f);for(e=0;e<d.length;e++)h=d[e],q=N.Ra(l,h),f.L.push(q.name),N.m(l,q,f,null);return l}function b(a){a.Mb=a.Mb||!1;a.Ab||0===a.Ab||(a.Ab=a.ud);a.L=a.L||[];a.Fj=a.Fj||!1;a.Sy=a.Sy||!1;a.Sb=a.Sb||0;a.Qb=a.Qb||!1;a.jc=a.jc||!1;a.status=0;a.X_=0;a.px=0;a.cn=a.cn||null;return a}function e(a,b){for(var d=[],e=[],f=0;f<b.length;f++){var g=b[f];N.Ra(a.ug,g).Fj&&(N.Ci(a.ug,g,function(c){var e=!0;N.xg(a.ug,c,function(a,c){if(!c.Fj)return e=
!1,1});e&&-1==d.indexOf(c)&&-1==b.indexOf(c)&&d.push(c)}),e.push(f))}for(f=e.length-1;0<=f;f--)b.splice(e[f],1);return d}function x(a){function b(c,d){var e=N.Ra(a.ug,c),f=N.Ra(a.ug,d),h=f.Ab-e.Ab;0==h&&(h=e.Mb-f.Mb);return h}var d=[],f=a.uh,g=!1;do{var k=e(a,f);d.push.apply(d,f);0<k.length&&(g=!0);f=k}while(0<k.length);g&&d.sort(b);a.uh=d;return a.uh.length}function k(a,b,d){if(b.Sy)return b.Fj=!0,r(a,b),!1;if(!b.Vb&&!b.Nh&&!b.bn)return r(a,b),!1;if(0==b.status&&(b.status++,b.Vb))return b.Vb(d,a,
b,b.cn,r,w),!0;if(1==b.status){if(b.Nh)return b.Nh(d,a,b,b.cn,r,w),!0;b.status++}return 2==b.status&&(b.status++,b.bn)?(b.bn(d,a,b,b.cn,r,w),!0):!1}function B(a){if(0==a.Xs)return 100;var b=0;N.ma(a.ug,function(d,e){a.do_not_load_resources&&e.Qb||(b+=e.px*e.Sb)});return G.trunc(100*b/a.Xs)}function r(a,b){b.Fj=!0;b.status=3;f(a,b,1)}function w(a,b,d){1>d?f(a,b,d):b.status++}function f(a,b,d){var e=D;if(b.Vb||b.Nh||b.bn)if(b.px=d,b=B(a),a.wC!=b||1==d)a.Zy(b,performance.now()-a.QH),a.wC=b,e.sx=!0}function q(a,
b){var d=null;N.ma(a.ug,function(a,e){if(e.name==b)return d=e,1});return d}function g(a){a.Sy=!0;a.px=1}function z(a){a.Zy=null;a.Cv=null;a.ug=null;a.uh=null}function A(){return 0==D.Wp}function J(a){return a&&(3==a.status||4==a.status)}var N=l("__graph"),F=l("__print"),G=l("__util");a.ud=0;a.Ni=1;a.XI=2;var D=null;a.UD=function(){return D};a.jN=function(){var a={wg:[],Vv:0,Wp:0,$y:!1,sx:!1};return D=a};a.tN=function(a,b,d,e,f,g,c,k){var l=D,q=l.wg.length,r={id:q,gb:0==q,status:0,cg:b,uB:"",hF:d||
function(){},gF:k||!1,S2:g,QH:0,wC:0,Xs:0,ly:!1,Zy:e||function(){},Cv:f||function(){},ug:null,uh:null,Vw:!1,Tw:!1,Xw:!1};a=m(r.gb,a,g,c);r.ug=a;b=[];d=N.lP(a);for(e=0;e<d.length;e++)b.push(d[e]);r.uh=b;N.ma(a,function(a,c){!(c.Vb||c.Nh||c.bn)||r.do_not_load_resources&&c.Qb||(r.Xs+=c.Sb)});l.wg.push(r);l.Wp++;return r.id};a.ZT=function(b){var e=D;if(e&&!A())if(e.sx)e.sx=!1;else{var d=performance.now();do{var f=e.wg[e.Vv],g=b[f.id];if(!J(f))if(0==f.status&&(f.status=1,f.QH=performance.now(),f.Zy(0,
0)),x(f)){var l=f,c=l.uh.length;do{var m=N.Ra(l.ug,l.uh[0]),q=k(l,m,g);m.Ab==a.Ni&&(l.ly=!0);m=l.uh.shift();l.uh.push(m);c--}while(!q&&0!=c)}else l=e,c=f,c.Cv(g,c),c.status=3,l.Wp--,z(c);e.$y&&(e.Vv=(e.Vv+1)%e.wg.length);if(f.ly){f.ly=!1;break}}while(16>performance.now()-d)}};a.XA=function(a){var b=D;a.Cv(null,a);a.status=3;b.Wp--;z(a);a.status=4;a.gb&&(b.$y=!0);a.hF(a.id,!1)};a.X1=w;a.Ss=function(a,b){var d=q(a,b);null!==d&&g(d)};a.Fj=A;a.pT=J;a.ig=function(a){var b=D;if(!b)return!1;a|=0;return b.wg[a]&&
(3==b.wg[a].status||2==b.wg[a].status)};a.tP=function(){F.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.ha=function(){D=null}};b4w.module.__md5=function(a){function l(a,k){var l=a[0],f=a[1],q=a[2],g=a[3],l=b(l,f,q,g,k[0],7,-680876936),g=b(g,l,f,q,k[1],12,-389564586),q=b(q,g,l,f,k[2],17,606105819),f=b(f,q,g,l,k[3],22,-1044525330),l=b(l,f,q,g,k[4],7,-176418897),g=b(g,l,f,q,k[5],12,1200080426),q=b(q,g,l,f,k[6],17,-1473231341),f=b(f,q,g,l,k[7],22,-45705983),l=b(l,f,q,g,k[8],7,1770035416),g=b(g,l,f,q,k[9],12,-1958414417),q=b(q,g,l,f,k[10],17,-42063),f=b(f,q,g,l,k[11],22,-1990404162),l=b(l,f,q,g,k[12],7,1804603682),g=b(g,l,f,q,
k[13],12,-40341101),q=b(q,g,l,f,k[14],17,-1502002290),f=b(f,q,g,l,k[15],22,1236535329),l=e(l,f,q,g,k[1],5,-165796510),g=e(g,l,f,q,k[6],9,-1069501632),q=e(q,g,l,f,k[11],14,643717713),f=e(f,q,g,l,k[0],20,-373897302),l=e(l,f,q,g,k[5],5,-701558691),g=e(g,l,f,q,k[10],9,38016083),q=e(q,g,l,f,k[15],14,-660478335),f=e(f,q,g,l,k[4],20,-405537848),l=e(l,f,q,g,k[9],5,568446438),g=e(g,l,f,q,k[14],9,-1019803690),q=e(q,g,l,f,k[3],14,-187363961),f=e(f,q,g,l,k[8],20,1163531501),l=e(l,f,q,g,k[13],5,-1444681467),g=
e(g,l,f,q,k[2],9,-51403784),q=e(q,g,l,f,k[7],14,1735328473),f=e(f,q,g,l,k[12],20,-1926607734),l=m(f^q^g,l,f,k[5],4,-378558),g=m(l^f^q,g,l,k[8],11,-2022574463),q=m(g^l^f,q,g,k[11],16,1839030562),f=m(q^g^l,f,q,k[14],23,-35309556),l=m(f^q^g,l,f,k[1],4,-1530992060),g=m(l^f^q,g,l,k[4],11,1272893353),q=m(g^l^f,q,g,k[7],16,-155497632),f=m(q^g^l,f,q,k[10],23,-1094730640),l=m(f^q^g,l,f,k[13],4,681279174),g=m(l^f^q,g,l,k[0],11,-358537222),q=m(g^l^f,q,g,k[3],16,-722521979),f=m(q^g^l,f,q,k[6],23,76029189),l=
m(f^q^g,l,f,k[9],4,-640364487),g=m(l^f^q,g,l,k[12],11,-421815835),q=m(g^l^f,q,g,k[15],16,530742520),f=m(q^g^l,f,q,k[2],23,-995338651),l=x(l,f,q,g,k[0],6,-198630844),g=x(g,l,f,q,k[7],10,1126891415),q=x(q,g,l,f,k[14],15,-1416354905),f=x(f,q,g,l,k[5],21,-57434055),l=x(l,f,q,g,k[12],6,1700485571),g=x(g,l,f,q,k[3],10,-1894986606),q=x(q,g,l,f,k[10],15,-1051523),f=x(f,q,g,l,k[1],21,-2054922799),l=x(l,f,q,g,k[8],6,1873313359),g=x(g,l,f,q,k[15],10,-30611744),q=x(q,g,l,f,k[6],15,-1560198380),f=x(f,q,g,l,k[13],
21,1309151649),l=x(l,f,q,g,k[4],6,-145523070),g=x(g,l,f,q,k[11],10,-1120210379),q=x(q,g,l,f,k[2],15,718787259),f=x(f,q,g,l,k[9],21,-343485551);a[0]=l+a[0]&4294967295;a[1]=f+a[1]&4294967295;a[2]=q+a[2]&4294967295;a[3]=g+a[3]&4294967295}function m(a,b,e,f,k,g){b=(b+a&4294967295)+(f+g&4294967295)&4294967295;return(b<<k|b>>>32-k)+e&4294967295}function b(a,b,e,f,k,g,l){return m(b&e|~b&f,a,b,k,g,l)}function e(a,b,e,f,k,g,l){return m(b&f|e&~f,a,b,k,g,l)}function x(a,b,e,f,k,g,l){return m(e^(b|~f),a,b,k,
g,l)}var k="0123456789abcdef".split("");a.yE=function(a){var b=a,e=b.length;a=[1732584193,-271733879,-1732584194,271733878];var f;for(f=64;f<=b.length;f+=64){for(var m=b.substring(f-64,f),g=[],z=void 0,z=0;64>z;z+=4)g[z>>2]=m.charCodeAt(z)+(m.charCodeAt(z+1)<<8)+(m.charCodeAt(z+2)<<16)+(m.charCodeAt(z+3)<<24);l(a,g)}b=b.substring(f-64);m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(f=0;f<b.length;f++)m[f>>2]|=b.charCodeAt(f)<<(f%4<<3);m[f>>2]|=128<<(f%4<<3);if(55<f)for(l(a,m),f=0;16>f;f++)m[f]=0;m[14]=8*
e;l(a,m);for(b=0;b<a.length;b++){e=a[b];f="";for(m=0;4>m;m++)f+=k[e>>8*m+4&15]+k[e>>8*m&15];a[b]=f}return a.join("")}};b4w.module.__logic_nodes=function(a,l){function m(){return function(a,c,b,d){b=d[0];var e=d[1];d=d[2];if(-2==b.state){for(var f=0;f<b.xs;f++)if(G.Xe(a,c,f))for(var h=0;h<b.ws.length;h++)if(b.ws[h]==f){e.Oj==b.MH?(N.bi(e.ga)&&(b.state=-1),d.Be.oe||(b.state=1,b.Wo=b.Kr[h])):(b.state=1,b.Wo=b.Kr[h]);return}b.state=0}}}function b(){return function(a,c,b,d){b=d[0];var e=d[1];d=d[2];for(var f=0;f<b.xs;f++)if(G.Xe(a,c,f)&&f==b.GG){if(N.bi(e.ga)&&e.Oj==b.MH)b.state=-1;else if(!d.Be.oe||b.T.no_wait)b.state=
1;return}b.state=0}}function e(a,c){return{name:a.name,type:a.type,label:a.label,xa:a.slot_idx_order,Wo:a.slot_idx_jump,pa:a.frame_range[0],La:a.frame_range[1],vO:a.frame_range_mask?a.frame_range_mask[0]:!0,tO:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,xs:-1,GG:-1,XQ:a.param_name,VQ:a.operation,Nj:a.mute,Fn:a.object,Ca:null,xb:null,Fb:null,qb:{},Me:a.anim_name,Lb:H.zc,ZQ:a.parse_json_vars,YQ:a.parse_json_paths,Nc:a.objects_paths,Hx:a.nodes_paths,Pb:a.floats,T:a.bools,Y:a.variables,vh:a.strings,
tx:a.materials_names,jH:a.shader_nd_type,ee:a.common_usage_names,$N:a.encode_json_vars,ZN:a.encode_json_paths,MH:c,fG:ba[a.type]?ba[a.type]:r,ps:!1,bt:0,ws:null,oQ:a.links,Kr:[]}}function x(a,c,b){return a[0]?c[a[1]]:b[a[1]]}function k(a,c,b,d){a[0]?c[a[1]]=d:b[a[1]]=d}function B(a,c,b){switch(c.state){case 2:b.Z=a.xa}}function r(a,c,b){switch(c.state){case 1:J.error("Unknown node type: "+a.type);break;case 2:b.Z=a.xa}}function w(a){return z.gc(z.Ic,a.Fn||[],0)}function f(a,c){var b=a.b4w_logic_nodes,
d=c.dd;c.state=1;for(var f=0;f<b.length;f++){var h={K:[],Be:{Ta:a,Z:0,oe:!1,nz:f,s:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};d.push(h);for(var g=d[d.length-1],k=b[f],n=0;n<k.length;n++){var l=e(k[n],g);g.K.push(l)}for(k=0;k<g.K.length;k++)l=g.K[k],l.fG(l,c,h.Be,0,0)}var b=a.timeline_markers,m;for(m in b)c.Xo.push(b[m]);c.Xo.sort(function(a,c){return a-c});c.state=2;L.push(c)}function q(a,c){switch(c){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}function g(a){switch(typeof a){case "string":return q(a,
1);case "number":return q(a,0);default:return q(a,1)}}var z=l("__objects"),A=l("__scenes"),J=l("__print"),N=l("__nla"),F=l("__config"),G=l("__controls"),D=l("__util"),H=l("__animation"),I=l("__assets"),d=l("__batch"),h=l("__geometry"),v=l("__time"),M=l("__camera"),c=l("__vec3"),p=l("__physics"),R=l("__transform"),K=l("__sfx"),t=l("__mat3"),y=l("__mat4"),u=l("__tsr"),C=l("__quat"),L=[],n={},T=new Float32Array(4);new Float32Array(4);var O=new Float32Array(3),V=new Float32Array(3),Y=new Float32Array(2),
la=new Float32Array(9),W=new Float32Array(16);a.CJ=0;a.DJ=1;a.nA=0;a.pA=1;a.oA=2;a.qA=3;a.rA=4;a.mA=5;a.AJ=0;a.BJ=1;var ba={ENTRYPOINT:function(a,c,b){switch(c.state){case 2:b.Z=a.xa}},HIDE:function(a,c,b){switch(c.state){case 1:a.Ca=w(a);break;case 2:A.dn(a.Ca,!0),b.Z=a.xa}},SHOW:function(a,c,b){switch(c.state){case 1:a.Ca=w(a);break;case 2:A.dn(a.Ca,!1),b.Z=a.xa}},PAGEPARAM:function(a,c,b){switch(c.state){case 2:var d=a.Y.vd;c=c.s;var e=b.s,f;a:{f=a.XQ;var h=a.Pb.ptp,g=a.T.hsh,n=F.get("url_params");
if(n&&f in n)f=Number(n[f]);else{if(g=g?location.hash:location.search)for(g=g.slice(1).split("&"),n=0;n<g.length;n++){var l=g[n].split("=");if(1<l.length&&l[0]==f){f=q(l[1],h);break a}}f=0}}k(d,c,e,f);b.Z=a.xa}},SWITCH_SELECT:function(a,c,b){switch(c.state){case 1:a:{b=c.dd[b.nz];var d=z.er();a.ws=[];a.Kr=[];for(var e in a.Nc){var f=z.gc(z.Ic,a.Nc[e],0),h=d.indexOf(f);if(-1==h){J.error("logic script error: non-selectable object:",a.Nc[e][a.Nc[e].length-1]);break a}a.ws.push(h);a.Kr.push(a.oQ[e])}a.state=
-1;a.xs=d.length;e=[];for(h=0;h<d.length;h++)e.push(G.Eq(d[h],!0));G.ja(f,"LOGIC_NODES_SWITCH_SELECT_"+a.label,G.mf,e,G.DC,m(),[a,c,b])}break;case 2:if(-1==a.state){c=c.dd[b.nz].K;for(f=0;f<c.length;f++)d=c[f],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}-1<a.state&&(b.Z=a.state?a.Wo:a.xa,a.state=-1)}},SELECT:function(a,c,d){switch(c.state){case 1:d=c.dd[d.nz];var e=w(a),f=z.er(),h=f.indexOf(e);if(-1==h)J.error("logic script error: non-selectable object:",a.Fn[a.Fn.length-1]);else{a.state=-1;
a.xs=f.length;a.GG=h;for(var h=[],g=0;g<f.length;g++)h.push(G.Eq(f[g],!0));G.ja(e,"LOGIC_NODES_SELECT_"+a.label,G.mf,h,G.DC,b(),[a,c,d])}break;case 2:if(-1<a.state){d.Z=a.state?a.Wo:a.xa;a.state=-1;break}a.T.not_wait&&(d.Z=a.xa)}},PLAY:function(a,c,b,d){switch(c.state){case 1:N.zH();a.state=-1;a.T.not_wait||(a.T.not_wait=!1);break;case 2:switch(a.state){case -1:if(N.bi(c.ga))if(c.Tv==c.Oj&&b.oe)break;else{var e=c.Oj;if(e){e.Be.Z=e.K[e.Be.Z].xa;e.K[e.Be.Z].state=-1;for(var e=c.Oj.K,f=0;f<e.length;f++){var h=
e[f];"PLAY"==h.type&&(h.state=-1)}}}b.oe=!a.T.not_wait;c.Oj=c.Tv;a.state=0;a.vO&&(N.pS(a.pa),N.UG(d));if(a.tO)N.Iy(a.La);else{d=N.Zn(d);var e=-1,g;for(g in c.Xo)if(d<c.Xo[g]){e=g;break}0<=e?N.Iy(c.Xo[e]):N.Iy(N.DD())}N.iR();a.T.not_wait&&(b.Z=a.xa,a.state=-1,b.oe=!1);break;case 0:N.bi()||(b.Z=a.xa,a.state=-1,b.oe=!1);break;case 1:b.Z=a.xa;a.state=-1;c.Oj=null;b.oe=!1;break;default:D.l("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,c,b){switch(c.state){case 2:window.location.href=a.T.url?
q(x(a.Y.url,c.s,b.s),1):a.vh.url,c.state=3}},MATH:function(a,c,b){switch(c.state){case 2:var d=-1==a.Y.v1[1]?a.Pb.inp1:q(x(a.Y.v1,c.s,b.s),0),e=-1==a.Y.v2[1]?a.Pb.inp2:q(x(a.Y.v2,c.s,b.s),0),f=0;switch(a.VQ){case "ADD":f=d+e;break;case "MUL":f=d*e;break;case "SUB":f=d-e;break;case "DIV":0==e&&D.l("Division by zero in Logic script");f=d/e;break;case "RAND":f=Math.random()*(e-d)+d}k(a.Y.vd,c.s,b.s,f);b.Z=a.xa}},CONDJUMP:function(a,c,b){switch(c.state){case 2:var d=a.T.str?1:0,e=a.T.str?a.vh:a.Pb,f=
-1==a.Y.v1[1]?e.inp1:q(x(a.Y.v1,c.s,b.s),d);c=-1==a.Y.v2[1]?e.inp2:q(x(a.Y.v2,c.s,b.s),d);d=!1;switch(a.ee.condition){case 5:f==c&&(d=!0);break;case 4:f!=c&&(d=!0);break;case 3:f<c&&(d=!0);break;case 2:f>c&&(d=!0);break;case 1:f<=c&&(d=!0);break;case 0:f>=c&&(d=!0)}b.Z=d?a.Wo:a.xa}},REGSTORE:function(a,c,b){switch(c.state){case 2:k([a.T.gl||a.Y.vd[0],a.Y.vd[1]],c.s,b.s,(1==a.ee.variable_type?a.vh:a.Pb).inp1),b.Z=a.xa}},PLAY_ANIM:function(a,c,b){switch(c.state){case 1:a.Ca=a.T.env?z.hr(a.Fn[0],0):
w(a);break;case 2:switch(0!=a.state||H.bi(a.Ca,a.Lb)||(a.state=1),a.state){case -1:for(var d in c.dd){var e=c.dd[d].Be.Z;-1!=e&&(e=c.dd[d].K[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.Ca==a.Ca&&(e.state=1))}c=a.ee.param_anim_behavior;if(""==a.Me)H.cq(a.Ca),H.Uo(a.Ca,c,a.Lb);else{a:{for(e=d=0;8>e;e++){var f=a.Ca.W[e];if(f&&f.Fg&&f.Fg==a.Me)if(0==d)d=1;else{d=!1;break a}}d=1==d?!0:!1}d||(a.Lb=H.OS(a.Ca,a.Me),H.apply(a.Ca,a.Me,a.Lb),H.Uo(a.Ca,c,a.Lb))}a.T.not_wait||(b.oe=!0);H.play(a.Ca,null,a.Lb);
a.state=0;a.T.not_wait&&(b.Z=a.xa,a.state=-1);break;case 0:break;case 1:a.T.not_wait||(b.oe=!1);b.Z=a.xa;a.state=-1;break;default:D.l("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:B,SEND_REQ:function(a,c,b){function d(a,e,f,h,g){a=JSON.stringify(a);k(g[0].Y.dst,c.s,b.s,a);g[0].state=1}switch(c.state){case 2:switch(a.state){case -1:a.state=0;var e=a.T.url?q(x(a.Y.url,c.s,b.s),1):a.vh.url,f={};a.T.ct&&(f["Content-Type"]=a.vh.ct);"GET"==a.ee.request_type?I.cd([{id:e,type:I.tk,url:e,ji:f,Ib:[a,
b.s]}],d,null,null,null):"POST"==a.ee.request_type&&I.cd([{id:e,type:I.tk,url:e,ji:f,rg:"POST",Sl:I.tk,Zj:q(x(a.Y.dst1,c.s,b.s),1),Ib:[a,b.s]}],d,null,null,null);break;case 1:a.state=-1,b.Z=a.xa}}},INHERIT_MAT:function(a,c,b){switch(c.state){case 1:for(c=0;2>c;c++)a.qb["id"+c]=z.gc(z.Ic,a.Nc["id"+c],0);break;case 2:d.HP(a.qb.id0,a.tx.id0,a.qb.id1,a.tx.id1),b.Z=a.xa}},SET_SHADER_NODE_PARAM:function(a,c,b){switch(c.state){case 1:a.Nc.id0&&(a.qb.id0=z.gc(z.Ic,a.Nc.id0,0),a.Hx.id0.unshift(a.tx.id0));
break;case 2:"ShaderNodeRGB"==a.jH&&d.Fy(a.qb.id0,a.Hx.id0,a.T.id0?q(x(a.Y.id0,c.s,b.s),0):a.Pb.id0,a.T.id1?q(x(a.Y.id1,c.s,b.s),0):a.Pb.id1,a.T.id2?q(x(a.Y.id2,c.s,b.s),0):a.Pb.id2),"ShaderNodeValue"==a.jH&&d.Gy(a.qb.id0,a.Hx.id0,a.T.id0?q(x(a.Y.id0,c.s,b.s),0):a.Pb.id0),b.Z=a.xa}},DELAY:function(a,c,b,d,e){switch(c.state){case 2:-1==a.state?(a.state=0,a.bt=0,b.oe=!0):0==a.state&&(a.bt+=e,(a.T.dl?q(x(a.Y.dl,c.s,b.s),0):a.Pb.dl)<a.bt&&(a.state=-1,b.Z=a.xa,b.oe=!1))}},APPLY_SHAPE_KEY:function(a,c,
b){switch(c.state){case 1:c=a.qb.id0=z.gc(z.Ic,a.Nc.id0,0);b=a.ee.sk;h.uv(c)?h.yP(c,b)||(J.error("Wrong key name:",b),a.Nj=!0):(J.error("No shape keys in object:",c.name),a.Nj=!0);break;case 2:h.rL(a.qb.id0,a.ee.sk,a.T.skv?q(x(a.Y.skv,c.s,b.s),0):a.Pb.skv),b.Z=a.xa}},OUTLINE:function(a,c,b){switch(c.state){case 1:var d=a.qb.id0=z.gc(z.Ic,a.Nc.id0,0);d&&d.g&&d.g.ic||(J.error("Can't evaluate 'Outline' logic node: wrong object"),a.Nj=!0);break;case 2:d=a.qb.id0;switch(a.ee.outline_operation){case "PLAY":c=
d.g.Ll;z.Fk(d,c.Ml,c.Nl,c.Ol);break;case "STOP":z.rq(d);break;case "INTENSITY":d.g.lh=a.T["in"]?q(x(a.Y["in"],c.s,b.s),0):a.Pb["in"]}b.Z=a.xa}},MOVE_CAMERA:function(a,b,d){function e(a,b,d,f){switch(M.Wh(a)){case M.bb:M.Vo(a,b,d);break;case M.xc:case M.Vf:R.sh(a,f);break;case M.yc:c.sub(d,b,O),c.normalize(O,O),M.Fs(a,d),d=b=0,V[0]=O[0],V[1]=0,V[2]=O[2],b=c.dot(V,O),d=Math.acos(b/(c.length(V)*c.length(O))),b=O[2]?Math.atan(O[0]/O[2]):0<O[0]?0:Math.PI,0<O[2]&&0<O[0]?Y[1]=-(Math.PI+Y[1]):0<O[2]&&0>O[0]?
Y[1]=-(Math.PI+Y[1]):0>O[2]&&0>O[0]?(Y[0]+=Math.PI,b=-(Math.PI-b)):0>O[2]&&0<O[0]&&(Y[0]+=Math.PI,b-=Math.PI),M.Ro(a,b+Math.PI,-d,!0,!0)}R.p(a);p.u(a)}function f(a,c,b,d){y.lookAt(c,b,D.wc,W);y.invert(W,W);y.rotateX(W,Math.PI/2,W);t.fromMat4(W,la);C.fromMat3(la,T);C.normalize(T,T);u.rh(c,u.Pc(a.g.i),T,d)}switch(b.state){case 1:a.qb.ca=z.gc(z.Ic,a.Nc.id0,0);a.qb.tr=z.gc(z.Ic,a.Nc.id1,0);a.qb.ta=z.gc(z.Ic,a.Nc.id2,0);a.state=-1;a.Fb={$H:new Float32Array(3),ZH:new Float32Array(3),bx:new Float32Array(3),
kz:new Float32Array(3),KH:new Float32Array(3),ax:new Float32Array(3),Ei:new Float32Array(8),yg:new Float32Array(8),io:new Float32Array(8)};break;case 2:var h=a.qb.ca,g=u.q(a.qb.tr.g.i),k=u.q(a.qb.ta.g.i);switch(a.state){case -1:b=a.T.dur?q(x(a.Y.dur,b.s,d.s),0):a.Pb.dur;if(0==b){f(h,g,k,a.Fb.yg);e(h,g,k,a.Fb.yg);d.Z=a.xa;break}c.copy(u.q(h.g.i),a.Fb.$H);var n=M.Wh(h);n==M.yc?c.copy(h.g.wb,a.Fb.kz):n==M.Vf||n==M.xc?(u.copy(h.g.i,a.Fb.Ei),f(h,g,k,a.Fb.yg)):c.copy(h.g.pivot,a.Fb.kz);c.copy(g,a.Fb.ZH);
c.copy(k,a.Fb.KH);a.state=0;var l=v.Bk(0,1,1E3*b,function(b){A.za()&&(n==M.Vf||n==M.xc?u.cx(a.Fb.Ei,a.Fb.yg,D.gk(b),a.Fb.io):(a.Fb.ax=c.lerp(a.Fb.kz,a.Fb.KH,D.gk(b),a.Fb.ax),a.Fb.bx=c.lerp(a.Fb.$H,a.Fb.ZH,D.gk(b),a.Fb.bx)),e(h,a.Fb.bx,a.Fb.ax,a.Fb.io),1==b&&(a.state=1))});break;case 1:v.qq(l),a.state=-1,d.Z=a.xa}}},SET_CAMERA_MOVE_STYLE:function(a,c,b){switch(c.state){case 2:c=A.fl(b.Ta),R.p(c),p.u(c),b.Z=a.xa}},MOVE_TO:function(a,c,b){function d(a,c){R.sh(a,c);R.p(a);p.u(a)}switch(c.state){case 1:a.qb.ob=
z.gc(z.Ic,a.Nc.id0,0);a.qb.de=z.gc(z.Ic,a.Nc.id1,0);a.state=-1;a.xb={HC:new Float32Array(8),bw:new Float32Array(8),CE:new Float32Array(8)};break;case 2:var e=a.qb.ob;u.copy(a.qb.ob.g.i,a.xb.HC);u.copy(a.qb.de.g.i,a.xb.bw);switch(a.state){case -1:c=a.T.dur?q(x(a.Y.dur,c.s,b.s),0):a.Pb.dur;if(0==c){d(e,a.xb.bw);b.Z=a.xa;break}a.state=0;var f=v.Bk(0,1,1E3*c,function(c){A.za()&&(a.xb.B_=u.cx(a.xb.HC,a.xb.bw,D.gk(c),a.xb.CE),d(e,a.xb.CE),1==c&&(a.state=1))});break;case 1:v.qq(f),a.state=-1,b.Z=a.xa}}},
TRANSFORM_OBJECT:function(a,c,b){function d(a,c,b){0==b?R.sh(a,c):R.Ks(a,c);R.p(a);p.u(a)}switch(c.state){case 1:a.qb.ob=z.gc(z.Ic,a.Nc.id0,0);a.state=-1;a.xb={Us:0,Ei:new Float32Array(8),yg:new Float32Array(8),io:new Float32Array(8)};break;case 2:var e=a.qb.ob;switch(a.state){case -1:V[0]=a.T.trx?q(x(a.Y.trx,c.s,b.s),0):a.Pb.trx;V[1]=a.T["try"]?q(x(a.Y["try"],c.s,b.s),0):a.Pb["try"];V[2]=a.T.trz?q(x(a.Y.trz,c.s,b.s),0):a.Pb.trz;O[0]=a.T.rox?q(x(a.Y.rox,c.s,b.s),0):a.Pb.rox;O[1]=a.T.roy?q(x(a.Y.roy,
c.s,b.s),0):a.Pb.roy;O[2]=a.T.roz?q(x(a.Y.roz,c.s,b.s),0):a.Pb.roz;var f=a.T.sc?x(a.Y.sc,c.s,b.s):a.Pb.sc;if(a.T["try"]||a.T.trz)Y[1]=-V[1],V[1]=V[2],V[2]=Y[1];if(a.T.roy||a.T.roz)Y[1]=-O[1],O[1]=O[2],O[2]=Y[1];D.Th(O,T);u.rh(V,f,T,a.xb.yg);a.xb.Us=a.ee.space_type;switch(a.xb.Us){case 0:R.bo(e,a.xb.Ei);break;case 1:R.co(e,a.xb.Ei);break;case 2:R.co(e,a.xb.Ei),u.multiply(a.xb.Ei,a.xb.yg,a.xb.yg)}c=a.T.dur?q(x(a.Y.dur,c.s,b.s),0):a.Pb.dur;if(0==c){d(e,a.xb.yg,a.xb.Us);b.Z=a.xa;break}a.state=0;f=v.Bk(0,
1,1E3*c,function(c){A.za()&&(u.cx(a.xb.Ei,a.xb.yg,D.gk(c),a.xb.io),d(e,a.xb.io,a.xb.Us),1==c&&(a.state=1))});break;case 1:v.qq(f),a.state=-1,b.Z=a.xa}}},SPEAKER_PLAY:function(a,c,b){switch(c.state){case 1:a.Ca=z.gc(z.Ic,a.Nc.id0,0);void 0==a.T.not_wait&&(a.T.not_wait=!0);break;case 2:switch(K.VP(a.Ca)||0!=a.state||(a.state=1),a.state){case -1:for(var d in c.dd){var e=c.dd[d].Be.Z;-1!=e&&(e=c.dd[d].K[e],"SPEAKER_PLAY"==e.type&&e!=a&&0==e.state&&e.Ca==a.Ca&&(e.state=1))}a.T.not_wait||(b.oe=!0);K.ZF(a.Ca);
a.state=0;break;case 0:a.T.not_wait&&(b.Z=a.xa,a.state=-1);break;case 1:a.T.not_wait||(b.oe=!1);b.Z=a.xa;a.state=-1;break;default:D.l("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,c,b){switch(c.state){case 1:a.Ca=z.gc(z.Ic,a.Nc.id0,0);break;case 2:K.stop(a.Ca),b.Z=a.xa}},STOP_ANIM:function(a,c,b){switch(c.state){case 1:a.Ca=a.T.env?z.hr(a.Fn[0],0):w(a);break;case 2:H.stop(a.Ca,H.Km),a.T.rst&&H.By(a.Ca,H.Km),b.Z=a.xa}},STOP_TIMELINE:function(a,c,b,d){switch(c.state){case 2:a.T.rst&&
N.UG(d),N.zH(),b.Z=a.xa}},CONSOLE_PRINT:function(a,c,b){switch(c.state){case 2:var d={},e;for(e in a.Y)d[a.Y[e][1]]=x(a.Y[e],c.s,b.s);J.log(a.ee.msg,JSON.stringify(d));b.Z=a.xa}},STRING:function(a,c,b){switch(c.state){case 2:var d=a.T.id0?q(x(a.Y.id0,c.s,b.s),1):a.vh.id0,e=a.T.id1?q(x(a.Y.id1,c.s,b.s),1):a.vh.id1,f=0;switch(a.Pb.sop){case 0:f=d+e;break;case 1:f=d.indexOf(e);break;case 2:f=d.replace(e,a.T.id2?q(x(a.Y.id2,c.s,b.s),1):a.vh.id2);break;case 3:f=d.substring(0,d.indexOf(e));k(a.Y.dst1,c.s,
b.s,d.substring(d.indexOf(e)+1,d.length));""==x(vars.dst,c.s,b.s)&&(f=x(vars.dst1,c.s,b.s),k(vars.dst1,c.s,b.s,""));break;case 4:switch(a.ee.condition){case 5:f=d==e?1:0;break;case 4:f=d!=e?1:0;break;case 3:f=d<e?1:0;break;case 2:f=d>e?1:0;break;case 1:f=d<=e?1:0;break;case 0:f=d>=e?1:0}}k(a.Y.dst,c.s,b.s,f);b.Z=a.xa}},GET_TIMELINE:function(a,c,b,d){switch(c.state){case 2:d=a.T.nla?q(N.Zn(d),0):q(v.Zn(d),0),k(a.Y.vd,c.s,b.s,d),b.Z=a.xa}},JSON:function(a,c,b){function d(a,c,b,e){for(var f=0;f<c.length;f++){for(var h=
c[f].split("."),k=a,n=b[f],l=0;l<h.length&&(k=k[h[l]],void 0!==k&&null!==k);l++);k=g(k);e[n]=k}}function e(a,c,b,d){d||(d={});for(var f=0;f<c.length;f++){var h=c[f].split("."),k=d,n=b[f];if(!(!n in a)){for(var l=0;l<h.length-1;l++)void 0===k[h[l]]&&(k[h[l]]=isNaN(h[l+1])?{}:[]),k=k[h[l]];k[h[h.length-1]]=g(a[n])}}}switch(c.state){case 2:switch(a.ee.json_operation){case "PARSE":try{var f=JSON.parse(q(x(a.Y.jsn,c.s,b.s),1));d(f,a.YQ,a.ZQ,b.s)}catch(h){J.error("logic script error: non valid JSON string")}break;
case "ENCODE":f={},e(b.s,a.ZN,a.$N,f),f=q(JSON.stringify(f),1),k(a.Y.jsn,c.s,b.s,f)}b.Z=a.xa}},JS_CALLBACK:function(a,c,b){switch(c.state){case 2:for(var d=a.T.cb?q(x(a.Y.cb,c.s,b.s),1):a.vh.cb,e=[],f=0,h="id"+f,l=a.ee.js_cb_params;h in l;)h=0==l[h]?z.gc(z.Ic,a.Nc[h],0):x(a.Y[h],c.s,b.s),e.push(h),f++,h="id"+f;l=[];f=0;for(h="out"+f;h in a.Y;)h=x(a.Y[h],c.s,b.s),l.push(h),f++,h="out"+f;if(d in n)for(n[d](e,l),d=0;d<l.length;d++)h="out"+d,h in a.Y&&k(a.Y[h],c.s,b.s,g(l[d]));else J.error("logic script error: no custom callback with id "+
d);b.Z=a.xa}},EMPTY:B};a.IP=function(a,c){var b={Ad:c,FG:a.name,state:0,Oj:null,Ta:a,Tv:null,dd:[],Xo:[],s:{}};a.oW=b;f(a,b)};a.update=function(a,c){var b=N.nP();if(!(0>=b))for(var d=0;d<L.length;d++)for(var e=d,f=a,h=c,g=b,k=L[e],n=0;n<L[e].dd.length;n++){k.Tv=L[e].dd[n];var l=L[e].dd[n],m=k,p=f,v=h,q=g,r=l.K;if(r.length){for(var t=0;t<r.length;t++)r[t].ps=!1;for(t=0;t<r.length;t++){if(0<=l.Be.Z)var u=r[l.Be.Z];else break;if(u.ps)break;if(u.Nj)if("ENTRYPOINT"==u.type)break;else l.Be.Z=u.xa,u.ps=
!0;else u.fG(u,m,l.Be,p,v,q),u.ps=!0}}}};a.sW=function(a,c){n[a]=c};a.C0=function(a){delete n[a]};a.O0=function(a,c){for(var b=0;b<L.length;b++)if(L[b].FG==a){for(var b=L[b],d=0;d<b.dd.length;d++){var e=b.dd[d].K[0];if(e.name==c){e.T.js&&(e.Nj=!1);b.dd[d].Be.Z=0;break}}break}};a.ha=function(){L.length=0;n={}}};b4w.module.__reformer=function(a,l){function m(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},e("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},e("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},e("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",e("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,e("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,e("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,e("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,e("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,e("node material",a,"diffuse_intensity"));"specular_shader"in a||(a.specular_shader="COOKTORR",e("node material",a,"specular_shader"));"specular_ior"in a||(a.specular_ior=4,e("node material",a,"specular_ior"));"specular_hardness"in
a||(a.specular_hardness=50,e("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,e("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,e("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,e("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,e("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",e("node material",
a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,e("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,e("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,e("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,e("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name=
"B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",e("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",e("node "+a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",e("node "+a.type,a,"vector_type"))}}function b(a){if(a=a.nla_tracks)for(var b=0;b<a.length;b++)for(var d=a[b],f=0;f<d.strips.length;f++){var g=d.strips[f];"action"in g||(g.action=null,e("strip",g,"action"));"action_frame_start"in g||(g.action_frame_start=
0,e("strip",g,"action_frame_start"));"action_frame_end"in g||(g.action_frame_end=g.frame_end-g.frame_start,e("strip",g,"action_frame_end"));"repeat"in g||(g.repeat=1,e("strip",g,"repeat"));"use_reverse"in g||(g.use_reverse=!1,e("strip",g,"use_reverse"));"scale"in g||(g.scale=1,e("strip",g,"scale"))}}function e(a,b,d){d=d+">>"+a;d in D||(D[d]={az:[],vG:"undefined",type:a});D[d].az.push(b.name)}function x(a,b,d){d=d+">>"+a;d in D||(D[d]={az:[],vG:"deprecated",type:a});D[d].az.push(b.name)}function k(a){q.warn(a)}
function B(a,b){b||(b=a.name+"_COPY");var d=a.materials,e=a.submeshes;a.materials=null;a.submeshes=null;var f=z.Ph(a);a.materials=d;a.submeshes=e;f.name=b;f.materials=a.materials.slice(0);f.submeshes=[];for(d=0;d<e.length;d++){var g=z.hn(e[d]);f.submeshes.push(g)}return f}var r=l("__boundings"),w=l("__curve"),f=l("__mat4"),q=l("__print"),g=l("__quat"),z=l("__util"),A=l("__vec3"),J=l("__vec4"),N=l("__logic_nodes"),F=l("__animation"),G=[5,4],D={};a.PB=function(a){return-1!=z.xI(a,G)};a.kM=function(a){D=
{};var f=a.worlds;if(0==f.length){q.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var d={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};
f.push(d)}for(var f=a.worlds,h=0;h<f.length;h++){d=f[h];"use_sky_blend"in d||(e("world",d,"use_sky_blend"),d.use_sky_blend=!1);"use_sky_paper"in d||(e("world",d,"use_sky_paper"),d.use_sky_paper=!1);"use_sky_real"in d||(e("world",d,"use_sky_real"),d.use_sky_real=!1);"b4w_sky_settings"in d&&"rayleigh_brightness"in d.b4w_sky_settings||(e("world",d,"rayleigh_brightness"),d.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,
spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in d||(e("world",d,"fog_settings"),d.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in d&&(d.fog_settings.use_custom_color=!0,d.fog_settings.color=d.b4w_fog_color),"b4w_fog_density"in d&&0<d.b4w_fog_density&&(d.fog_settings.depth=1/d.b4w_fog_density));
"render_sky"in d.b4w_sky_settings||(e("world",d,"render_sky"),d.b4w_sky_settings.render_sky=!1);for(var g=d.texture_slots,l=0;l<g.length;l++){var c=g[l];"blend_type"in c||(c.blend_type="MIX",e("world_texture_slot",c,"blend_type"));"use_map_blend"in c||(c.use_map_blend=!1,e("world_texture_slot",c,"use_map_blend"));"use_map_horizon"in c||(c.use_map_horizon=!0,e("world_texture_slot",c,"use_map_horizon"));"use_map_zenith_up"in c||(c.use_map_zenith_up=!1,e("world_texture_slot",c,"use_map_zenith_up"));
"use_rgb_to_intensity"in c||(c.use_rgb_to_intensity=!1,e("world_texture_slot",c,"use_rgb_to_intensity"));"invert"in c||(c.invert=!1,e("world_texture_slot",c,"invert"));"color"in c||(c.color=[1,0,1],e("world_texture_slot",c,"color"));"blend_factor"in c||(c.blend_factor=0,e("world_texture_slot",c,"blend_factor"));"horizon_factor"in c||(c.horizon_factor=1,e("world_texture_slot",c,"horizon_factor"));"zenith_up_factor"in c||(c.zenith_up_factor=0,e("world_texture_slot",c,"zenith_up_factor"));"zenith_down_factor"in
c||(c.zenith_down_factor=0,e("world_texture_slot",c,"zenith_down_factor"));"default_value"in c||(c.default_value=1,e("world_texture_slot",c,"default_value"))}"b4w_use_default_animation"in d||(e("world",d,"b4w_use_default_animation"),d.b4w_use_default_animation=!1);"b4w_anim_behavior"in d||(e("world",d,"b4w_anim_behavior"),d.b4w_anim_behavior="CYCLIC")}l=a.scenes;for(h=0;h<l.length;h++)g=l[h],c=g.world,"timeline_markers"in g||(g.timeline_markers=null,e("scene",g,"timeline_markers")),"b4w_reflection_quality"in
g||(g.b4w_reflection_quality="MEDIUM",e("scene",g,"b4w_reflection_quality")),"b4w_use_nla"in g||(g.b4w_use_nla=!1,e("scene",g,"b4w_use_nla")),"fps"in g||(g.fps=24,e("scene",g,"fps")),"b4w_nla_cyclic"in g||(g.b4w_nla_cyclic=!1,e("scene",g,"b4w_nla_cyclic")),"b4w_logic_nodes"in g||(g.b4w_logic_nodes=[],e("scene",g,"b4w_logic_nodes")),"b4w_detect_collisions"in g&&(x("scene",g,"b4w_detect_collisions"),delete g.b4w_detect_collisions),"audio_doppler_speed"in g||(g.audio_doppler_speed=343.3),"audio_doppler_factor"in
g||(g.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in g||(g.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},e("scene",g,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in g||(g.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in g||(g.b4w_enable_bloom=!1,e("scene",g,"b4w_enable_bloom")),"b4w_enable_motion_blur"in g||(g.b4w_enable_motion_blur=!1,e("scene",g,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in g||(g.b4w_enable_color_correction=
!1,e("scene",g,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in g||(g.b4w_antialiasing_quality="MEDIUM",e("scene",g,"b4w_antialiasing_quality")),"b4w_tags"in g||(g.b4w_tags={title:"",description:""},e("scene",g,"b4w_tags")),"b4w_enable_object_selection"in g||(g.b4w_enable_object_selection="AUTO",e("scene",g,"b4w_enable_object_selection")),"b4w_enable_outlining"in g||(g.b4w_enable_outlining="AUTO",e("scene",g,"b4w_enable_outlining")),"b4w_enable_glow_materials"in g||(g.b4w_enable_glow_materials=
"AUTO",e("scene",g,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in g||(g.b4w_enable_anchors_visibility="AUTO",e("scene",g,"b4w_enable_anchors_visibility")),"b4w_outline_color"in g||(g.b4w_outline_color=[1,1,1],e("scene",g,"b4w_outline_color")),"b4w_outline_factor"in g||(g.b4w_outline_factor="b4w_glow_factor"in g?g.b4w_glow_factor:1,e("scene",g,"b4w_outline_factor")),"b4w_shadow_settings"in g||(e("scene",g,"b4w_shadow_settings"),f=c.b4w_shadow_settings,g.b4w_shadow_settings=f?f:{csm_resolution:2048,
self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),f=g.b4w_shadow_settings,"csm_resolution"in f||(e("scene",g,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"self_shadow_polygon_offset"in f||(e("scene",g,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in f||
(e("scene",g,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(e("scene",g,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(e("scene",g,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(e("scene",g,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(e("scene",g,"b4w_shadow_settings.first_cascade_blur_radius"),f.first_cascade_blur_radius=
3),"csm_last_cascade_border"in f||(e("scene",g,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(e("scene",g,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(e("scene",g,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(e("scene",g,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),"b4w_ssao_settings"in g||(e("scene",
g,"b4w_ssao_settings"),f=c.b4w_ssao_settings,g.b4w_ssao_settings=f?f:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),f=g.b4w_ssao_settings,"dist_factor"in f||(e("scene",g,"b4w_ssao_settings.dist_factor"),f.dist_factor=0),"samples"in f||(e("scene",g,"b4w_ssao_settings.samples"),f.samples=16),"hemisphere"in f||(e("scene",g,"b4w_ssao_settings.hemisphere"),f.hemisphere=!1),"blur_depth"in f||(e("scene",g,"b4w_ssao_settings.blur_depth"),f.blur_depth=!1),"blur_discard_value"in
f||(e("scene",g,"b4w_ssao_settings.blur_discard_value"),f.blur_discard_value=1),"b4w_bloom_settings"in g||(e("scene",g,"b4w_bloom_settings"),f=c.b4w_bloom_settings,g.b4w_bloom_settings=f?f:{key:.2,blur:4,edge_lum:1}),"key"in g.b4w_bloom_settings||(e("scene",g,"b4w_bloom_settings.key"),g.b4w_bloom_settings.key=.2),"blur"in g.b4w_bloom_settings||(e("scene",g,"b4w_bloom_settings.blur"),g.b4w_bloom_settings.blur=4),"edge_lum"in g.b4w_bloom_settings||(e("scene",g,"b4w_bloom_settings.edge_lum"),g.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in g||(e("scene",g,"b4w_motion_blur_settings"),f=c.b4w_motion_blur_settings,g.b4w_motion_blur_settings=f?f:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in g.b4w_motion_blur_settings||(e("scene",g,"b4w_motion_blur_settings.motion_blur_factor"),g.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in g.b4w_motion_blur_settings||(e("scene",g,"b4w_motion_blur_settings.motion_blur_decay_threshold"),g.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in g||(e("scene",g,"b4w_color_correction_settings"),f=c.b4w_color_correction_settings,g.b4w_color_correction_settings=f?f:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in g||(e("scene",g,"b4w_god_rays_settings"),f=c.b4w_god_rays_settings,g.b4w_god_rays_settings=f?f:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in g.b4w_god_rays_settings||(e("scene",g,"b4w_god_rays_settings.steps_per_pass"),g.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in g||(e("scene",g,"b4w_glow_settings"),g.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},f=g.b4w_glow_settings,"b4w_render_glow_over_blend"in c&&(f.render_glow_over_blend=c.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in c&&(f.small_glow_mask_coeff=c.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in c&&(f.large_glow_mask_coeff=c.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
c&&(f.small_glow_mask_width=c.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in c&&(f.large_glow_mask_width=c.b4w_large_glow_mask_width)),c=g.b4w_render_shadows,"AUTO"!=c&&"OFF"!=c&&"ON"!=c&&(g.b4w_render_shadows=c?"ON":"OFF"),c=g.b4w_render_reflections,"OFF"!=c&&"ON"!=c&&(g.b4w_render_reflections=c?"ON":"OFF"),c=g.b4w_render_refractions,"AUTO"!=c&&"OFF"!=c&&"ON"!=c&&(g.b4w_render_refractions=c?"ON":"OFF"),"b4w_render_dynamic_grass"in g||(e("scene",g,"b4w_render_dynamic_grass"),g.b4w_render_dynamic_grass=
"AUTO"),g.b4w_nla_script&&x("scene",g,"b4w_nla_script");g=a.meshes;for(h=0;h<g.length;h++){c=g[h];c.b4w_bounding_box||(e("mesh",c,"b4w_bounding_box"),c.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});c.b4w_bounding_box_source||(e("mesh",c,"b4w_bounding_box_source"),c.b4w_bounding_box_source=c.b4w_bounding_box);c.uv_textures||(e("mesh",c,"uv_textures"),c.uv_textures=[]);c.b4w_bounding_sphere_center||(c.b4w_bounding_sphere_center=[0,0,0]);c.b4w_bounding_cylinder_center||(c.b4w_bounding_cylinder_center=
[0,0,0]);c.b4w_bounding_ellipsoid_center||(c.b4w_bounding_ellipsoid_center=[0,0,0]);c.b4w_bounding_ellipsoid_axes||(l=c.b4w_bounding_box,c.b4w_bounding_ellipsoid_axes=[(l.max_x-l.min_x)/2,(l.max_y-l.min_y)/2,(l.max_z-l.min_z)/2]);"b4w_shape_keys"in c||(c.b4w_shape_keys=[],e("mesh",c,"b4w_shape_keys"));l=!0;for(f=0;f<c.submeshes.length;f++)d=c.submeshes[f],"boundings"in d||(l=!1,d.boundings={bounding_ellipsoid_axes:c.b4w_bounding_ellipsoid_axes,bounding_ellipsoid_center:c.b4w_bounding_ellipsoid_center,
bounding_box:{max_x:c.b4w_bounding_box.max_x,max_y:c.b4w_bounding_box.max_y,max_z:c.b4w_bounding_box.max_z,min_x:c.b4w_bounding_box.min_x,min_y:c.b4w_bounding_box.min_y,min_z:c.b4w_bounding_box.min_z}});l||e("mesh",c,"submesh_bd");for(var l=c,f=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],d=null,p=0;p<f.length;p++)l[f[p]]&&(d?(l[f[p]]=!1,q.warn('WARNING property "'+f[p]+'" of object "'+l.name+'" has been set to "false". Foreground property "'+
d+'" already exists.')):d=f[p]);for(l=0;l<c.b4w_vertex_anim.length;l++)f=c.b4w_vertex_anim[l],"allow_nla"in f||(e('mesh["b4w_vertex_anim"]',c,"allow_nla"),f.allow_nla=!0)}l=a.cameras;for(h=0;h<l.length;h++)g=l[h],g.type||(g.type="PERSP",e("camera",g,"type")),"b4w_eye_target_dist"in g&&(delete g.b4w_eye_target_dist,x("camera",g,"b4w_eye_target_dist")),"b4w_hover_zero_level"in g||(g.b4w_hover_zero_level=0,e("camera",g,"b4w_hover_zero_level")),"b4w_trans_velocity"in g||(g.b4w_trans_velocity=1,e("camera",
g,"b4w_trans_velocity")),"b4w_rot_velocity"in g||(g.b4w_rot_velocity=1,e("camera",g,"b4w_rot_velocity")),"b4w_zoom_velocity"in g||(g.b4w_zoom_velocity=.1,e("camera",g,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in g||(g.b4w_use_target_distance_limits=g.b4w_use_distance_limits||!1,e("camera",g,"b4w_use_target_distance_limits")),"b4w_use_zooming"in g||(g.b4w_use_zooming=g.b4w_use_distance_limits||!1,e("camera",g,"b4w_use_zooming")),"b4w_distance_min"in g||(g.b4w_distance_min=1,e("camera",
g,"b4w_distance_min")),"b4w_distance_max"in g||(g.b4w_distance_max=100,e("camera",g,"b4w_distance_max")),"b4w_horizontal_translation_min"in g||(g.b4w_horizontal_translation_min=-100,e("camera",g,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in g||(g.b4w_horizontal_translation_max=100,e("camera",g,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in g||(g.b4w_vertical_translation_min=-100,e("camera",g,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in
g||(g.b4w_vertical_translation_max=100,e("camera",g,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in g||(g.b4w_use_horizontal_clamping=!1,e("camera",g,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in g||(g.b4w_rotation_left_limit=-Math.PI,e("camera",g,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in g||(g.b4w_rotation_right_limit=Math.PI,e("camera",g,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in g||(g.b4w_horizontal_clamping_type="LOCAL",e("camera",
g,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in g||(g.b4w_use_vertical_clamping=!1,e("camera",g,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in g||(g.b4w_rotation_down_limit=-Math.PI/2,e("camera",g,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in g||(g.b4w_rotation_up_limit=Math.PI/2,e("camera",g,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in g||(g.b4w_vertical_clamping_type="LOCAL",e("camera",g,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in g||(g.b4w_hover_angle_min=
Math.PI/6,e("camera",g,"b4w_hover_angle_min")),"b4w_hover_angle_max"in g||(g.b4w_hover_angle_max=Math.PI/6,e("camera",g,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in g||(g.b4w_enable_hover_hor_rotation=!0,e("camera",g,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in g||(g.b4w_use_panning=!0,e("camera",g,"b4w_use_panning")),"b4w_use_pivot_limits"in g||(g.b4w_use_pivot_limits=!1,g.b4w_pivot_z_min=0,g.b4w_pivot_z_max=10,e("camera",g,"b4w_use_pivot_limits"));l=a.lamps;for(h=0;h<l.length;h++)g=
l[h],"b4w_generate_shadows"in g||(g.b4w_generate_shadows=!1,e("lamp",g,"b4w_generate_shadows")),"b4w_dynamic_intensity"in g||(g.b4w_dynamic_intensity=!1,e("lamp",g,"b4w_dynamic_intensity")),"use_diffuse"in g||(g.use_diffuse=!0,e("lamp",g,"use_diffuse")),"use_specular"in g||(g.use_specular=!0,e("lamp",g,"use_specular")),"clip_start"in g||(g.clip_start=.1,e("lamp",g,"clip_start")),"clip_end"in g||(g.clip_end=30,e("lamp",g,"clip_end"));l=a.speakers;for(h=0;h<l.length;h++)g=l[h],"b4w_behavior"in g||(g.b4w_behavior=
g.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in g||(g.b4w_disable_doppler=!1),"b4w_delay"in g||(g.b4w_delay=0),"b4w_delay_random"in g||(g.b4w_delay_random=0),"b4w_volume_random"in g||(g.b4w_volume_random=0),"b4w_pitch_random"in g||(g.b4w_pitch_random=0),"b4w_fade_in"in g||(g.b4w_fade_in=0),"b4w_fade_out"in g||(g.b4w_fade_out=0),"b4w_loop"in g||(g.b4w_loop=!1),"b4w_loop_count"in g||(g.b4w_loop_count=0),"b4w_loop_count_random"in g||(g.b4w_loop_count_random=0),"b4w_playlist_id"in
g||(g.b4w_playlist_id=""),g.animation_data&&b(g.animation_data);l=a.textures;for(h=0;h<l.length;h++)g=l[h],"b4w_anisotropic_filtering"in g||(g.b4w_anisotropic_filtering="OFF",e("texture",g,"b4w_anisotropic_filtering")),"b4w_water_foam"in g||(g.b4w_water_foam=!1,e("texture",g,"b4w_water_foam")),"b4w_foam_uv_freq"in g||(g.b4w_foam_uv_freq=[1,1],e("texture",g,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in g||(g.b4w_foam_uv_magnitude=[1,1],e("texture",g,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in
g||(g.b4w_parallax_steps=5,e("material",g,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in g||(g.b4w_parallax_lod_dist=10,e("material",g,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in g||(g.b4w_shore_dist_map=!1,e("texture",g,"b4w_shore_dist_map")),"b4w_shore_boundings"in g||(g.b4w_shore_boundings=new Float32Array(4),g.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],e("texture",g,"b4w_shore_boundings")),"b4w_max_shore_dist"in g||(g.b4w_max_shore_dist=100,e("texture",g,"b4w_max_shore_dist")),"b4w_disable_compression"in
g||(g.b4w_disable_compression=!1,e("texture",g,"b4w_disable_compression")),"b4w_source_type"in g||(g.b4w_source_type="",e("texture",g,"b4w_source_type")),"b4w_source_id"in g||(g.b4w_source_id="",e("texture",g,"b4w_source_id")),"b4w_source_size"in g||(g.b4w_source_size=1024,e("texture",g,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in g||(g.b4w_enable_canvas_mipmapping=!0,e("texture",g,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in g||(g.b4w_nla_video=!1,e("texture",g,"b4w_nla_video"));f=
a.materials;for(h=0;h<f.length;h++){d=f[h];"ALPHA_ANTIALIASING"==d.game_settings.alpha_blend&&(d.game_settings.alpha_blend="CLIP");"b4w_node_mat_type"in d&&x("material",d,"b4w_node_mat_type");"b4w_skydome"in d&&x("material",d,"b4w_skydome");"b4w_procedural_skydome"in d&&x("material",d,"b4w_procedural_skydome");"b4w_lens_flares"in d||(d.b4w_lens_flares=!1,e("material",d,"b4w_lens_flares"));"LENS_FLARES"===d.name&&(d.b4w_lens_flares||q.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),
d.b4w_lens_flares=!0);d.b4w_water&&("b4w_water_shore_smoothing"in d||(d.b4w_water_shore_smoothing=!1,e("material",d,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in d||(d.b4w_water_dynamic=!1,e("material",d,"b4w_water_dynamic")),"b4w_waves_height"in d||(d.b4w_waves_height=1,e("material",d,"b4w_waves_height")),"b4w_waves_length"in d||(d.b4w_waves_length=1,e("material",d,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in d||(d.b4w_water_dst_noise_scale0=.05,e("material",d,"b4w_water_dst_noise_scale0")),
"b4w_water_dst_noise_scale1"in d||(d.b4w_water_dst_noise_scale1=.03,e("material",d,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in d||(d.b4w_water_dst_noise_freq0=1.3,e("material",d,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in d||(d.b4w_water_dst_noise_freq1=1,e("material",d,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in d||(d.b4w_water_dir_min_shore_fac=.4,e("material",d,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in d||(d.b4w_water_dir_freq=.5,
e("material",d,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in d||(d.b4w_water_dir_noise_scale=.05,e("material",d,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in d||(d.b4w_water_dir_noise_freq=.07,e("material",d,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in d||(d.b4w_water_dir_min_noise_fac=.5,e("material",d,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in d||(d.b4w_water_dst_min_fac=.2,e("material",d,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in d||
(d.b4w_water_waves_hor_fac=5,e("material",d,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in d||(d.b4w_water_absorb_factor=6,e("material",d,"b4w_water_absorb_factor")),"b4w_water_fog_color"in d||(d.b4w_water_fog_color=new Float32Array(3),d.b4w_water_fog_color=[.5,.7,.7],e("material",d,"b4w_water_fog_color")),"b4w_foam_factor"in d||(d.b4w_foam_factor=5,e("material",d,"b4w_foam_factor")),"b4w_generated_mesh"in d||(d.b4w_generated_mesh=!1,e("material",d,"b4w_generated_mesh")),"b4w_water_num_cascads"in
d||(d.b4w_water_num_cascads=5,e("material",d,"b4w_water_num_cascads")),"b4w_water_subdivs"in d||(d.b4w_water_subdivs=64,e("material",d,"b4w_water_subdivs")),"b4w_water_detailed_dist"in d||(d.b4w_water_detailed_dist=1E3,e("material",d,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in d||(d.b4w_water_enable_caust=!1,e("material",d,"b4w_water_enable_caust")),"b4w_water_caust_scale"in d||(d.b4w_water_caust_scale=.25,e("material",d,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in d||(d.b4w_water_caust_brightness=
.5,e("material",d,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in d||(d.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in d||(d.b4w_dynamic_grass_color="");"diffuse_intensity"in d||(d.diffuse_intensity=1,e("material",d,"diffuse_intensity"));"b4w_use_ghost"in d||(d.b4w_use_ghost=!1);"b4w_collision_margin"in d||(d.b4w_collision_margin=.04,e("material",d,"b4w_collision_margin"));"b4w_collision_group"in d||(d.b4w_collision_group=128,e("material",d,"b4w_collision_group"));"b4w_collision_mask"in
d||(d.b4w_collision_mask=127,e("material",d,"b4w_collision_mask"));"b4w_do_not_render"in d||(d.b4w_do_not_render=!1,e("material",d,"b4w_do_not_render"));"HALO"!=d.type||"b4w_halo_sky_stars"in d||(d.b4w_halo_sky_stars=!1,e("material",d,"b4w_halo_sky_stars"));"HALO"!=d.type||"b4w_halo_stars_blend_height"in d||(d.b4w_halo_stars_blend_height=10,e("material",d,"b4w_halo_stars_blend_height"));"HALO"!=d.type||"b4w_halo_stars_min_height"in d||(d.b4w_halo_stars_min_height=0,e("material",d,"b4w_halo_stars_min_height"));
"specular_shader"in d||(d.specular_shader="COOKTORR",e("material",d,"specular_shader"));"diffuse_shader"in d||(d.diffuse_shader="LAMBERT",e("material",d,"diffuse_shader"));"roughness"in d||(d.roughness=.5,e("material",d,"roughness"));"diffuse_fresnel"in d||(d.diffuse_fresnel=.1,e("material",d,"diffuse_fresnel"));"diffuse_fresnel_factor"in d||(d.diffuse_fresnel_factor=.5,e("material",d,"diffuse_fresnel_factor"));"specular_slope"in d||(d.specular_slope=.2,e("material",d,"specular_slope"));"specular_toon_size"in
d||(d.specular_toon_size=.5,e("material",d,"specular_toon_size"));"specular_toon_smooth"in d||(d.specular_toon_smooth=.1,e("material",d,"specular_toon_smooth"));"specular_alpha"in d||(d.specular_alpha=1,e("material",d,"specular_alpha"));"b4w_wettable"in d||(d.b4w_wettable=!1,e("material",d,"b4w_wettable"));"b4w_refractive"in d||(d.b4w_refractive=!1,e("material",d,"b4w_refractive"));"b4w_refr_bump"in d||(d.b4w_refr_bump=0,e("material",d,"b4w_refr_bump"));"b4w_shallow_water_col"in d||(d.b4w_shallow_water_col=
[0,.8,.3],e("material",d,"b4w_shallow_water_col"));"b4w_shore_water_col"in d||(d.b4w_shore_water_col=[0,.9,.2],e("material",d,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in d||(d.b4w_shallow_water_col_fac=1,e("material",d,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in d||(d.b4w_shore_water_col_fac=.5,e("material",d,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in d||(d.b4w_water_sss_strength=5.9,e("material",d,"b4w_water_sss_strength"));"b4w_water_sss_width"in d||(d.b4w_water_sss_width=
.45,e("material",d,"b4w_water_sss_width"));"b4w_render_above_all"in d||(d.b4w_render_above_all=!1,e("material",d,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in d||(d.b4w_water_norm_uv_velocity=.05,e("material",d,"b4w_water_norm_uv_velocity"));"specular_ior"in d||(d.specular_ior=1,e("material",d,"specular_ior"));"darkness"in d||(d.darkness=0,e("material",d,"darkness"));"diffuse_toon_size"in d||(d.diffuse_toon_size=0,e("material",d,"diffuse_toon_size"));"diffuse_toon_smooth"in d||(d.diffuse_toon_smooth=
0,e("material",d,"diffuse_toon_smooth"));g=d.texture_slots;for(l=0;l<g.length;l++)c=g[l],"blend_type"in c||(c.blend_type="MIX",e("texture_slot",c,"blend_type"));if(d.node_tree){g=d.node_tree.nodes;for(l=0;l<g.length;l++)m(g[l]);d.node_tree.animation_data&&b(d.node_tree.animation_data)}}c=a.node_groups;for(h=0;h<c.length;h++)for(g=c[h].node_tree.nodes,l=0;l<g.length;l++)m(g[l]);g=a.objects;for(h=0;h<g.length;h++){c=g[h];switch(c.type){case "MESH":"b4w_dynamic_geometry"in c||(c.b4w_dynamic_geometry=
!1);"b4w_reflexible"in c||(c.b4w_reflexible=!1);"b4w_reflexible_only"in c||(c.b4w_reflexible_only=!1);"b4w_reflective"in c||(c.b4w_reflective=!1);"b4w_reflection_type"in c||(c.b4w_reflection_type="PLANE",e("object",c,"b4w_reflection_type"));"b4w_wind_bending"in c||(c.b4w_wind_bending=!1,e("object",c,"b4w_wind_bending"));"b4w_wind_bending_angle"in c||(c.b4w_wind_bending_angle=10,c.b4w_wind_bending_freq=.25,e("object",c,"wind bending params"));"b4w_detail_bending_amp"in c||(c.b4w_detail_bending_amp=
.1,c.b4w_branch_bending_amp=.3,e("object",c,"detail bending params"));"b4w_detail_bending_freq"in c||(c.b4w_detail_bending_freq=1,e("object",c,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in c||(c.b4w_main_bend_stiffness_col="",e("object",c,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in c||(c.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},e("object",c,"b4w_detail_bend_colors"));"b4w_caustics"in c||(c.b4w_caustics=!1);"vertex_groups"in
c&&c.vertex_groups.length&&c.data&&0==c.data.vertex_groups.length&&(c.data.vertex_groups=c.vertex_groups,delete c.vertex_groups,e("object",c,"vertex_groups"));"b4w_vertex_anim"in c&&c.b4w_vertex_anim.length&&c.data&&0==c.data.b4w_vertex_anim.length&&(c.data.b4w_vertex_anim=c.b4w_vertex_anim,delete c.b4w_vertex_anim,e("object",c,"b4w_vertex_anim"));"b4w_do_not_render"in c||(c.b4w_do_not_render=!1);"use_ghost"in c.game||(c.game.use_ghost=!1);"use_sleep"in c.game||(c.game.use_sleep=!1);"velocity_min"in
c.game||(c.game.velocity_min=0);"velocity_max"in c.game||(c.game.velocity_max=0);"collision_group"in c.game||(c.game.collision_group=1);"collision_mask"in c.game||(c.game.collision_mask=255);l=c;f=l.game;d=f.collision_bounds_type;f.use_collision_bounds&&"BOX"!=d&&"CYLINDER"!=d&&"CONE"!=d&&"SPHERE"!=d&&"CAPSULE"!=d&&"EMPTY"!=d&&(q.error("Wrong collision bounds type "+d+". Disable physics for object "+l.name),l.b4w_collision=!1,l.b4w_floating=!1,l.b4w_vehicle=!1,l.b4w_character=!1);"b4w_vehicle_settings"in
c?c.b4w_vehicle_settings&&("steering_ratio"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.steering_ratio=10),"steering_max"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.steering_max=1),"inverse_control"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.inverse_control=!1),"force_max"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.force_max=1500),"brake_max"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.brake_max=100),"speed_ratio"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.speed_ratio=
.027),"max_speed_angle"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in
c.b4w_vehicle_settings||(c.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.floating_factor=3),"floating_factor"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.water_lin_damp=
.9),"water_rot_damp"in c.b4w_vehicle_settings||(c.b4w_vehicle_settings.water_rot_damp=.9)):(c.b4w_vehicle_settings=null,e("object",c,"b4w_vehicle_settings"));"b4w_floating_settings"in c?c.b4w_floating_settings&&("floating_factor"in c.b4w_floating_settings||(c.b4w_floating_settings.floating_factor=3),"water_lin_damp"in c.b4w_floating_settings||(c.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in c.b4w_floating_settings||(c.b4w_floating_settings.water_rot_damp=.8)):(c.b4w_floating_settings=
null,e("object",c,"b4w_floating_settings"));"b4w_character_settings"in c?c.b4w_character_settings&&("walk_speed"in c.b4w_character_settings||(c.b4w_character_settings.walk_speed=4),"run_speed"in c.b4w_character_settings||(c.b4w_character_settings.run_speed=8),"step_height"in c.b4w_character_settings||(c.b4w_character_settings.step_height=.25),"jump_strength"in c.b4w_character_settings||(c.b4w_character_settings.jump_strength=5),"waterline"in c.b4w_character_settings||(c.b4w_character_settings.waterline=
0)):(c.b4w_character_settings=null,e("object",c,"b4w_character_settings"));"b4w_selectable"in c||(c.b4w_selectable=!1,e("object",c,"b4w_selectable"));"b4w_outlining"in c||(c.b4w_outlining=!1,e("object",c,"b4w_outlining"));"b4w_outline_on_select"in c||(c.b4w_outline_on_select=!1,e("object",c,"b4w_outline_on_select"));"b4w_billboard"in c||(c.b4w_billboard=!1,e("object",c,"b4w_billboard"));"b4w_billboard_geometry"in c||(c.b4w_billboard_geometry="SPHERICAL",e("object",c,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in
c||(c.b4w_pres_glob_orientation=!1,e("object",c,"b4w_pres_glob_orientation"));"b4w_outline_settings"in c||("b4w_glow_settings"in c?c.b4w_outline_settings=c.b4w_glow_settings:(c.b4w_outline_settings={},c.b4w_outline_settings.outline_duration=1,c.b4w_outline_settings.outline_period=1,c.b4w_outline_settings.outline_relapses=0),e("object",c,"b4w_outline_settings"));"b4w_lod_transition"in c||(c.b4w_lod_transition=.01,e("object",c,"b4w_lod_transition"));"lod_levels"in c||(c.lod_levels=[],e("object",c,"lod_levels"));
"b4w_animation_mixing"in c||(c.b4w_animation_mixing=!1,e("object",c,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in c||(c.b4w_anchor=null,e("object",c,"b4w_anchor")),!c.b4w_anchor||"max_width"in c.b4w_anchor||(c.b4w_anchor.max_width=250)}"collision_margin"in c.game||(c.game.collision_margin=.04,e("object",c,"collision_margin"));"b4w_anim_behavior"in c||(c.b4w_anim_behavior=c.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",e("object",c,"b4w_anim_behavior"));if(!("rotation_quaternion"in c)){l=
[0,0,0,1];z.Th(c.rotation_euler,l);var f=l,d=l[0],p=l[1],r=l[2];f[0]=l[3];f[1]=d;f[2]=p;f[3]=r;c.rotation_quaternion=l;e("object",c,"rotation_quaternion")}"webgl_do_not_batch"in c&&(c.b4w_do_not_batch=c.webgl_do_not_batch)&&x("object",c,"webgl_do_not_batch");"b4w_shadow_cast_only"in c||(c.b4w_shadow_cast_only=!1,e("object",c,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in c||(c.b4w_correct_bounding_offset="AUTO",e("object",c,"b4w_correct_bounding_offset"));f=c.particle_systems;for(l=0;l<
f.length;l++)d=f[l],p=d.settings,"use_rotation_dupli"in p||(p.use_rotation_dupli=!1,e("particle_settings",p,"use_rotation_dupli")),"use_whole_group"in p||(p.use_whole_group=!1,e("particle_settings",p,"use_whole_group")),d.transforms||(d.transforms=new Float32Array,e("particle_system",d,"transforms")),"b4w_billboard_align"in p||(p.b4w_billboard_align="VIEW",e("particle_settings",p,"b4w_billboard_align")),"b4w_dynamic_grass"in p||(p.b4w_dynamic_grass=!1,e("object",p,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in
p||(p.b4w_dynamic_grass_scale_threshold=.01,e("object",p,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in p||(p.b4w_initial_rand_rotation=!1,e("particle_settings",p,"b4w_initial_rand_rotation")),"b4w_rotation_type"in p||(p.b4w_rotation_type="Z",e("particle_settings",p,"b4w_rotation_type")),"b4w_rand_rotation_strength"in p||(p.b4w_rand_rotation_strength=1,e("particle_settings",p,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in p||(p.b4w_hair_billboard=!1,e("particle_settings",
p,"b4w_hair_billboard")),"b4w_hair_billboard_type"in p||(p.b4w_hair_billboard_type="BASIC",e("particle_settings",p,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in p||(p.b4w_hair_billboard_jitter_amp=0,e("particle_settings",p,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in p||(p.b4w_hair_billboard_jitter_freq=0,e("particle_settings",p,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in p||(p.b4w_hair_billboard_geometry="SPHERICAL",e("particle_settings",
p,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in p||(p.b4w_wind_bend_inheritance="PARENT",e("particle_settings",p,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in p||(p.b4w_shadow_inheritance="PARENT",e("particle_settings",p,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in p||(p.b4w_reflection_inheritance="PARENT",e("particle_settings",p,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in p||(p.b4w_vcol_from_name="",e("particle_settings",p,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in p||(p.b4w_vcol_to_name="",e("particle_settings",p,"b4w_vcol_to_name")),"b4w_coordinate_system"in p||(p.b4w_coordinate_system="LOCAL",e("particle_settings",p,"b4w_coordinate_system")),"b4w_allow_nla"in p||(p.b4w_allow_nla=!0,e("particle_settings",p,"b4w_allow_nla")),"b4w_enable_soft_particles"in p||(p.b4w_enable_soft_particles=!1,e("particle_settings",p,"b4w_enable_soft_particles")),"b4w_particles_softness"in p||(p.b4w_particles_softness=1,e("particle_settings",p,"b4w_particles_softness")),
"billboard_tilt"in p||(p.billboard_tilt=0,e("particle_settings",p,"billboard_tilt")),"billboard_tilt_random"in p||(p.billboard_tilt_random=0,e("particle_settings",p,"billboard_tilt_random")),"use_rotations"in p||(p.use_rotations=!1,e("particle_settings",p,"use_rotations"));"constraints"in c||(c.constraints=[],e("object",c,"constraints"));f=c.modifiers;for(l=0;l<f.length;l++){a:{d=f[l];switch(d.type){case "ARRAY":if(!("fit_type"in d)){q.error("WARNING Incomplete modifier "+String(d.type)+' for "'+
c.name+'", reexport "'+a.b4w_filepath_blend+'" scene');d=!1;break a}}d=!0}d||(f.splice(l,1),l--)}"animation_data"in c||(c.animation_data={action:null,nla_tracks:[]},e("object",c,"animation_data"));c.animation_data&&("action"in c.animation_data||(c.animation_data.action=null,k("no action in animation data "+c.name)),"nla_tracks"in c.animation_data||(c.animation_data.nla_tracks=[],k("no NLA in animation data "+c.name)),b(c.animation_data));"b4w_collision_id"in c||(c.b4w_collision_id="",e("object",c,
"b4w_collision_id"));"b4w_viewport_alignment"in c||(c.b4w_viewport_alignment=null,e("object",c,"b4w_viewport_alignment"));"pinverse_tsr"in c||(c.pinverse_tsr=null,e("object",c,"pinverse_tsr"));"b4w_cluster_data"in c||(c.b4w_cluster_data={cluster_id:-1},e("object",c,"b4w_cluster_data"));(0>c.scale[0]||0>c.scale[1]||0>c.scale[2])&&k('negative scale for object "'+c.name+'", can lead to some errors');l=c.scale;0==l[0]&&0==l[1]&&0==l[2]?l=!0:(f=Math.abs((l[1]-l[2])/l[1]),l=.005>Math.abs((l[0]-l[1])/l[0])&&
.005>f);l||k("non-uniform scale for object "+c.name)}for(var w in D)h=D[w],l=w.match(/.*?(?=>>|$)/i)[0],q.warn('Property "'+String(l)+'" is '+h.vG+' for "'+h.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.gM=function(a,b){"num_channels"in a||(a.num_channels=1,k('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.pL=function(a){var b;a:{b=a.modifiers;for(var d=0;d<b.length;d++){var e=b[d].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=!1}if(!b)return null;
b=B(a.data,a.data.name+"_MOD");a=a.modifiers;for(d=0;d<a.length;d++){var k=a[d];switch(k.type){case "ARRAY":for(var e=b,l=k,c=0,m=0,q=0,x=new Float32Array(16),k=[],t=1;t<l.count;t++){l.use_constant_offset&&(c+=l.constant_offset_displace[0],m+=l.constant_offset_displace[1],q+=l.constant_offset_displace[2]);if(l.use_relative_offset)var y=e.b4w_bounding_box,c=c+(y.max_x-y.min_x)*l.relative_offset_displace[0],m=m+(y.max_y-y.min_y)*l.relative_offset_displace[1],q=q+(y.max_z-y.min_z)*l.relative_offset_displace[2];
z.sT(c,m,q,x);for(var u=y=B(e),C=x,D=0;D<u.submeshes.length;D++){var n=u.submeshes[D];z.Rl(n.position,C,n.position,0);z.zU(n.normal,C,n.normal);z.jT(n.tangent,C,n.tangent)}k.push(y)}for(t=0;t<k.length;t++)for(l=e,c=k[t],m=0;m<l.submeshes.length;m++){q=l.submeshes[m];x=c.submeshes[m];y=q.base_length;u=q.indices.length;q.base_length+=x.base_length;for(var F in q)if("base_length"!=F&&"boundings"!=F)if("indices"==F)for(q[F]=z.xT(q[F],x[F]),C=u;C<q.indices.length;C++)q.indices[C]+=y;else"vertex_colors"!=
F&&(q[F]=z.rO(q[F],x[F]))}break;case "CURVE":for(var e=b,t=w.oN(k.object),l=new Float32Array(16),m=t.ai?4:3,c=new Float32Array(m),m=new Float32Array(m),q=new Float32Array(3),x=new Float32Array(4),y=new Float32Array(4),u=new Float32Array(3),C=new Float32Array(3),D=new Float32Array(3),n=new Float32Array(4),G=new Float32Array(4),N=0;N<e.submeshes.length;N++){var Y=e.submeshes[N],la=Y.position,W=Y.normal,Y=Y.tangent,ba;a:{ba=k.deform_axis;switch(ba){case "POS_X":case "NEG_X":ba=0;break a;case "POS_Y":case "NEG_Y":ba=
1;break a;case "POS_Z":case "NEG_Z":ba=2;break a;default:z.l("Wrong deform axis value "+ba)}ba=void 0}u[0]=0;u[1]=0;u[2]=0;u[ba]=1;for(var aa=w.XS(t),fa=0;fa<la.length/3;fa++){D[0]=la[3*fa];D[1]=la[3*fa+1];D[2]=la[3*fa+2];var ea=D[ba],ia=w.WS(t,ea);w.YS(t,ia,c);q[0]=c[0];q[1]=c[1];q[2]=c[2];w.VS(t,ia,m);C[0]=m[0];C[1]=0;C[2]=m[2];A.normalize(C,C);g.rotationTo(u,C,x);0>ea?(c[0]=C[0],c[1]=C[1],c[2]=C[2],A.scale(c,ea,c),A.add(q,c,q)):ea>aa&&(c[0]=C[0],c[1]=C[1],c[2]=C[2],A.scale(c,ea-aa,c),A.add(q,c,
q));f.fromRotationTranslation(x,q,l);t.ai&&(g.setAxisAngle(u,c[3],y),A.transformQuat(D,y,D));D[ba]=0;A.transformMat4(D,l,D);la[3*fa]=D[0];la[3*fa+1]=D[1];la[3*fa+2]=D[2];W.length&&(n[0]=W[3*fa],n[1]=W[3*fa+1],n[2]=W[3*fa+2],n[3]=0,J.transformMat4(n,l,n),W[3*fa]=n[0],W[3*fa+1]=n[1],W[3*fa+2]=n[2]);Y.length&&(G[0]=Y[3*fa],G[1]=Y[3*fa+1],G[2]=Y[3*fa+2],G[3]=0,J.transformMat4(G,l,G),Y[3*fa]=G[0],Y[3*fa+1]=G[1],Y[3*fa+2]=G[2])}}}r.tR(b)}return b};a.bN=function(){return{name:"DEFAULT",uuid:z.xw(),use_nodes:!1,
diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,
b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],
b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.yL=function(a,b){function d(c,b){for(var d in c){var e=c[d],f=e[0];if(1<e.length)for(var g=1;g<e.length;g++)f+="*"+e[g];for(g=0;g<a.length;g++)if(e=a[g],e.name==f)for(var h in b)e[h]=b[h]}}for(var e=b.b4w_logic_nodes,f=0;f<e.length;f++)for(var g=e[f],c=0;c<g.length;c++){var l=g[c],m={register1:"variable1",register2:"variable2",registerd:"variabled"},q;for(q in m)q in l&&(l[m[q]]=l[q]);for(var r in l.variables)"boolean"!=
typeof l.variables[r][0]&&(l.variables[r]=[!1,l.variables[r]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(l.type)&&("variable1"in l&&(l.variables.v1=[!1,l.variable1]),"variable2"in l&&(l.variables.v2=[!1,l.variable2]),"variabled"in l&&(l.variables.vd=[!1,l.variabled]));switch(l.type){case "SELECT":for(var z=0;z<a.length;z++)m=a[z],m.name==l.object&&(m.b4w_selectable=!0);l.bools||(l.bools={});l.bools.not_wait||(l.bools.not_wait=!1);k('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":d(l.objects_paths,
{b4w_selectable:!0});if(l.links instanceof Array){k('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var m={},u=0;for(z in l.objects_paths)m[z]=l.links[u],u++;l.links=m}break;case "SELECT_PLAY":k('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');l.mute=!0;break;case "SELECT_PLAY_ANIM":k('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":d(l.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":d(l.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":d(l.objects_paths,{b4w_do_not_batch:!0});break;case "OUTLINE":d(l.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":l.condition&&(l.common_usage_names.condition=l.condition);if("cnd"in l.floats)l.common_usage_names.condition=l.floats.cnd;else switch(l.common_usage_names.condition){case "GEQUAL":l.common_usage_names.condition=N.nA;break;case "LEQUAL":l.common_usage_names.condition=
N.pA;break;case "GREATER":l.common_usage_names.condition=N.oA;break;case "LESS":l.common_usage_names.condition=N.qA;break;case "NOTEQUAL":l.common_usage_names.condition=N.rA;break;case "EQUAL":l.common_usage_names.condition=N.mA}void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);l.bools||(l.bools={});void 0===l.bools.str&&(l.bools.str=!1,l.floats.inp1=l.input1,l.floats.inp2=l.input2);break;case "SEND_REQ":l.bools||(l.bools={});l.strings||(l.strings={});void 0===l.bools.ct&&
(l.bools.ct=!1);void 0!=l.url&&(l.bools.url=!1,l.strings.url=l.url);break;case "MATH":void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);void 0!=l.input1&&(l.floats.inp1=l.input1);void 0!=l.input2&&(l.floats.inp2=l.input2);break;case "REGSTORE":l.floats||(l.floats={});l.strings||(l.strings={});void 0!=l.number1&&(l.input1=l.number1);if(void 0!=l.input1)switch(typeof l.input1){case "number":l.floats.inp1=l.input1;l.common_usage_names.variable_type="NUMBER";break;default:l.strings.inp1=
l.input1,l.common_usage_names.variable_type="STRING"}switch(l.common_usage_names.variable_type){case "NUMBER":l.common_usage_names.variable_type=N.CJ;break;case "STRING":l.common_usage_names.variable_type=N.DJ}break;case "PAGEPARAM":l.bools||(l.bools={});void 0===l.bools.hsh&&(l.bools.hsh=!1);l.floats||(l.floats={});void 0===l.floats.ptp&&(l.floats.ptp=0);break;case "PLAY_ANIM":d(l.objects_paths,{b4w_do_not_batch:!0});l.bools||(l.bools={});void 0===l.bools.env&&(l.bools.env=!1);(m=l.common_usage_names.param_anim_behavior)||
(m="FINISH_STOP");l.common_usage_names.param_anim_behavior=F.Ou(m);break;case "STOP_ANIM":l.bools||(l.bools={});void 0===l.bools.env&&(l.bools.env=!1);break;case "STRING":if("cnd"in l.floats)l.common_usage_names.condition=l.floats.cnd;else switch(l.common_usage_names.condition){case "GEQUAL":l.common_usage_names.condition=N.nA;break;case "LEQUAL":l.common_usage_names.condition=N.pA;break;case "GREATER":l.common_usage_names.condition=N.oA;break;case "LESS":l.common_usage_names.condition=N.qA;break;
case "NOTEQUAL":l.common_usage_names.condition=N.rA;break;case "EQUAL":l.common_usage_names.condition=N.mA}break;case "REDIRECT":void 0!=l.url&&(l.bools.url=!1,l.strings.url=l.url);break;case "ENTRYPOINT":l.bools||(l.bools={});void 0===l.bools.js&&(l.bools.js=!1);l.bools.js&&(l.mute=!0);break;case "JS_CALLBACK":for(q in l=l.common_usage_names.js_cb_params,l)switch(l[q]){case "OBJECT":l[q]=N.AJ;break;case "VARIABLE":l[q]=N.BJ}}}}};b4w.module.__curve=function(a,l){function m(a,b,e,g,k){var l=g.length;k||(k=new Float32Array(l));for(var m=l+a,r=new Float32Array(m),x=1;x<=m-1;x++)r[x-1]=b>=e[x-1]&&b<e[x+1-1]?1:0;for(var B=2;B<=a;B++)for(x=1;x<=m-B;x++)r[x-1]=(0!=r[x-1]?(b-e[x-1])*r[x-1]/(e[x+B-1-1]-e[x-1]):0)+(0!=r[x+1-1]?(e[x+B-1]-b)*r[x+1-1]/(e[x+B-1]-e[x+1-1]):0);b==e[m-1]&&(r[l-1]=1);a=0;for(x=1;x<=l;x++)a+=r[x-1]*g[x-1];for(x=1;x<=l;x++)k[x-1]=0!=a?r[x-1]*g[x-1]/a:0;return k}function b(a){a=a.Fr;return a[a.length-1]}function e(a){a=
a.vC;return a[a.length-1]}function x(a,b,e,g,l,m,r,B){var F=a+(b-a)/2,G=k(F,g,l,m,r)-e;B=B?B:.01;return Math.abs(G)<B?F:0<G?x(a,F,e,g,l,m,r,B):x(F,b,e,g,l,m,r,B)}function k(a,b,e,g,k){var l=1-a;return b*l*l*l+3*e*l*l*a+3*g*l*a*a+k*a*a*a}l("__print");var B=l("__util"),r=l("__vec3");a.oN=function(a){var b={},e=a.data;a=e.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var g=a.order_u;b.ii=g;a=a.points;var k=a.length/5,l=[],r=k+g,k=k+2;l[0]=0;for(var x=2;x<=r;x++)l[x-1]=x>g&&x<k?l[x-
2]+1:l[x-2];b.Fr=l;"2D"==e.dimensions?b.ai=!1:"3D"==e.dimensions?b.ai=!0:B.l("Wrong curve dimensions");g=[];l=[];for(e=0;e<a.length;e+=5)g.push(a[e]),g.push(a[e+1]),g.push(a[e+2]),b.ai&&g.push(a[e+3]),l.push(a[e+4]);b.Gv=g;b.Kz=l;a=[];for(var e=b.Gv,g=b.ai?4:3,l=b.Kz,r=b.Fr,k=b.ii,x=e.length/g,F=x+k,G=0,D=r[F-1]/999,H=0;1E3>H;H++){5E-6>r[F-1]-G&&(G=r[F-1]);for(var I=m(k,G,r,l),d=0;d<g;d++)for(var h=a[g*H+d]=0;h<x;h++)a[g*H+d]+=I[h]*e[g*h+d];G+=D}g=b.ai?4:3;l=new Float32Array(1E3);l[0]=0;for(e=1;1E3>
e;e+=1)r=a[(e-1)*g],k=a[(e-1)*g+1],x=a[(e-1)*g+2],F=a[e*g],G=a[e*g+1],D=a[e*g+2],l[e]=l[e-1]+Math.sqrt((F-r)*(F-r)+(G-k)*(G-k)+(D-x)*(D-x));b.vC=l;return b};a.YS=function(a,e,k){k||(k=[]);var g=e,l=Math.max(g,0);e=l=Math.min(g,b(a));var g=a.Gv,l=a.ai?4:3,r=a.Kz,x=a.Fr,B=a.ii;a=g.length/l;var F=a+B;5E-6>x[F-1]-e&&(e=x[F-1]);F=new Float32Array(a);m(B,e,x,r,F);for(e=0;e<l;e++)for(r=k[e]=0;r<a;r++)k[e]+=F[r]*g[l*r+e]};a.VS=function(a,b,e){e||(e=[]);var g=a.Gv,k=a.ai?4:3,l=a.Kz,m=a.Fr,r=a.ii;a=g.length/
k;var x=a+r;5E-6>m[x-1]-b&&(b=m[x-1]);var x=new Float32Array(a),B=b;b=x;var D=l.length;b||(b=new Float32Array(D));var H=new Float32Array(D),I=new Float32Array(D),d=H,h=I;d||(d=new Float32Array(D));h||(h=new Float32Array(D));for(var v=D+r,M=new Float32Array(v),c=new Float32Array(v),p=1;p<=v-1;p++)M[p-1]=B>=m[p-1]&&B<m[p+1-1]?1:0;B==m[v-1]&&(M[D-1]=1);for(var R=2;R<=r;R++)for(p=1;p<=v-R;p++){var K=0!=M[p-1]?M[p-1]/(m[p+R-1-1]-m[p-1]):0,t=0!=M[p+1-1]?-M[p+1-1]/(m[p+R-1]-m[p+1-1]):0,y=0!=c[p-1]?(B-m[p-
1])*c[p-1]/(m[p+R-1-1]-m[p-1]):0,u=0!=c[p+1-1]?(m[p+R-1]-B)*c[p+1-1]/(m[p+R-1]-m[p+1-1]):0;M[p-1]=(0!=M[p-1]?(B-m[p-1])*M[p-1]/(m[p+R-1-1]-m[p-1]):0)+(0!=M[p+1-1]?(m[p+R-1]-B)*M[p+1-1]/(m[p+R-1]-m[p+1-1]):0);c[p-1]=K+t+y+u}for(p=1;p<=D;p++)d[p-1]=M[p-1],h[p-1]=c[p-1];m=0;for(r=1;r<=D;r++)m+=H[r-1]*l[r-1];B=0;for(r=1;r<=D;r++)B+=I[r-1]*l[r-1];for(r=1;r<=D;r++)b[r-1]=0!=m?I[r-1]*l[r-1]/m+H[r-1]*l[r-1]*B/(m*m):0;for(l=0;l<k;l++)for(m=e[l]=0;m<a;m++)e[l]+=x[m]*g[k*m+l]};a.U1=b;a.XS=e;a.WS=function(a,
f){if(0>=f)return 0;var k=b(a);if(f>=e(a))return k;var g=a.vC,l=B.jq(g,f,0,g.length-1);return k*(l+(f-g[l])/(g[l+1]-g[l]))/1E3};a.Jr=function(a,b,e,g,k){return e+(k-g)*(a-e)/(b-g)};a.eF=function(a,b,e){var g=b[0];b=b[1];e=(e[1]-b)/(e[0]-g);return e*a+(b-e*g)};a.sB=function(a,b,e,g,l,m){return k(x(0,1,a,b[0],e[0],g[0],l[0],m),b[1],e[1],g[1],l[1])};a.nv=function(a,b,e,g,k){var l=new Float32Array(3),m=new Float32Array(3),x=new Float32Array(3),B=new Float32Array(3),G=new Float32Array(3),D=new Float32Array(3);
r.copy(a[1],m);null==b?(r.copy(e[1],x),l[0]=2*m[0]-x[0],l[1]=2*m[1]-x[1]):r.copy(b[1],l);null==e?(r.copy(b[1],l),x[0]=2*m[0]-l[0],x[1]=2*m[1]-l[1]):r.copy(e[1],x);r.subtract(m,l,B);r.subtract(x,m,G);b=r.length(B);e=r.length(G);0==b&&(b=1);0==e&&(e=1);if("AUTO"==g||"AUTO"==k)D[0]=G[0]/e+B[0]/b,D[1]=G[1]/e+B[1]/b,l=2.5614*r.length(D),0!=l&&("AUTO"==g&&r.scaleAndAdd(m,D,-(b/l),a[0]),"AUTO"==k&&r.scaleAndAdd(m,D,e/l,a[2]));"VECTOR"==g&&r.scaleAndAdd(m,B,-1/3,a[0]);"VECTOR"==k&&r.scaleAndAdd(m,G,1/3,a[2])};
a.LM=function(a,b,e,g){var k=[],l=[],m,r,x;k[0]=a[0]-b[0];k[1]=a[1]-b[1];l[0]=g[0]-e[0];l[1]=g[1]-e[1];x=g[0]-a[0];m=Math.abs(k[0]);r=Math.abs(l[0]);0!=m+r&&m+r>x&&(m=x/(m+r),b[0]=a[0]-m*k[0],b[1]=a[1]-m*k[1],e[0]=g[0]-m*l[0],e[1]=g[1]-m*l[1])}};b4w.module.camera=function(a,l){function m(a,e){f.kb("camera.set_pivot","camera.target_set_trans_pivot");b.sa(a)?(J.copy(e,a.g.pivot),g.p(a),w.u(a)):f.error("set_pivot(): Wrong object or camera move style")}var b=l("__camera");l("__config");var e=l("__constraints"),x=l("__container"),k=l("__mat4"),B=l("__math"),r=l("__obj_util"),w=l("__physics"),f=l("__print"),q=l("__scenes"),g=l("__transform"),z=l("__tsr"),A=l("__util"),J=l("__vec3"),N=l("__vec4"),F=new Float32Array(2),G=new Float32Array(3),D=new Float32Array(3);
new Float32Array(4);new Float32Array(9);var H={},I={};a.Vf=b.Vf;a.bb=b.bb;a.xc=b.xc;a.yc=b.yc;a.c2=function(a,e){if(r.ka(a)){b.vt(a);a.g.lb=b.Vf;if(e){var k=e.pos||z.q(a.g.i);e.look_at?b.Gs(a,k,e.look_at):g.lc(a,k)}g.p(a);w.u(a);b.ho(a)}else f.error("static_setup(): Wrong camera object")};a.a2=function(a,e,k){b.rl(a)?(e=e||z.q(a.g.i),k?b.Gs(a,e,k):g.lc(a,e),g.p(a),w.u(a)):f.error("static_set_look_at(): Wrong camera object or camera move style")};a.b2=function(a,e){b.rl(a)?(g.sg(a,e),g.p(a),w.u(a)):
f.error("static_set_rotation(): Wrong camera object or camera move style")};a.Z1=function(a,e){if(!b.rl(a))return f.error("static_get_rotation(): Wrong camera object or camera move style"),null;e=e||new Float32Array(4);return g.jl(a,e)};a.lY=function(a,e){r.ka(a)?e&&e.horiz_rot_lim&&("number"!=typeof e.horiz_rot_lim.left||"number"!=typeof e.horiz_rot_lim.right)?f.error("eye_setup(): Wrong horizontal limits object."):e&&e.vert_rot_lim&&("number"!=typeof e.vert_rot_lim.down||"number"!=typeof e.vert_rot_lim.up)?
f.error("eye_setup(): Wrong vertical limits object."):(b.vt(a),a.g.lb=b.xc,e&&b.DS(a,e.pos||z.q(a.g.i),e.look_at,e.horiz_rot_lim,e.vert_rot_lim),g.p(a),w.u(a),b.ho(a)):f.error("eye_setup(): Wrong camera object")};a.kY=function(a,h,k){b.Hb(a)?(h=h||z.q(a.g.i),k?b.mS(a,h,k):g.lc(a,h),e.Rh(a,a.g.hf,!0),g.p(a),w.u(a)):f.error("eye_set_look_at(): Wrong camera object or camera move style")};a.Pn=function(a,e,k){var l,c;b.Hb(a)?(b.Qo(a,e,k,l||!1,c||!1),g.p(a),w.u(a)):f.error("eye_rotate(): Wrong camera object or camera move style")};
a.kO=function(a,e){b.Hb(a)?!e||"number"==typeof e.down&&"number"==typeof e.up?(b.eH(a,e),g.p(a),w.u(a)):f.error("eye_set_vertical_limits(): Incorrect limits object."):f.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.jY=function(a,e,g){if(!b.Hb(a))return f.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.va?(e=e||{},g?(e.down=a.va.Uk,e.up=a.va.um):(e.down=a.va.down,e.up=a.va.up),e.camera_space=g||!1,e):null};a.jO=function(a,
e){b.Hb(a)?!e||"number"==typeof e.left&&"number"==typeof e.right?(b.TG(a,e),g.p(a),w.u(a)):f.error("eye_set_horizontal_limits(): Incorrect limits object."):f.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.iY=function(a,e,g){if(!b.Hb(a))return f.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.$a?(e=e||{},g?(e.left=a.$a.vl,e.right=a.$a.Ul):(e.left=a.$a.left,e.right=a.$a.right),e.camera_space=g||!1,e):null};a.n2=function(a,
e){if(r.ka(a))if(!e.horiz_rot_lim||"number"==typeof e.horiz_rot_lim.left&&"number"==typeof e.horiz_rot_lim.right)if(!e.vert_rot_lim||"number"==typeof e.vert_rot_lim.down&&"number"==typeof e.vert_rot_lim.up){if(e.dist_lim){if("number"!=typeof e.dist_lim.min||"number"!=typeof e.dist_lim.max||e.dist_lim.min>e.dist_lim.max){f.error("target_setup(): Wrong distance limits object");return}e.dist_lim.min=Math.max(e.dist_lim.min,0);e.dist_lim.max=Math.max(e.dist_lim.max,0)}e.Eo&&("number"!=typeof e.Eo.min_y||
"number"!=typeof e.Eo.max_y||e.Eo.min_y>e.Eo.max_y)?f.error("target_setup(): Wrong pivot limits object"):(b.vt(a),a.g.lb=b.bb,b.FS(a,e.pos||z.q(a.g.i),e.pivot,e.horiz_rot_lim,e.vert_rot_lim,e.dist_lim,e.Eo,e.use_panning||!1),g.p(a),w.u(a),b.ho(a))}else f.error("target_setup(): Wrong vertical limits object");else f.error("target_setup(): Wrong horizontal limits object");else f.error("target_setup(): Wrong camera object")};a.bp=function(a,e,k){var l,c;b.sa(a)?(b.us(a,e,k,l||!1,c||!1),g.p(a),w.u(a)):
f.error("target_rotate(): Wrong camera object or camera move style")};a.m2=function(a,e,k){b.sa(a)?(e=e||z.q(a.g.i),k=k||a.g.pivot,b.Vo(a,e,k),g.p(a),w.u(a)):f.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.l2=function(a,e){b.sa(a)?(b.sS(a,e),g.p(a),w.u(a)):f.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.mT=function(a,e){if(b.sa(a)){var k=g.Jl(a,a.g.pivot),l=Math.max(0,e);g.Ff(a,0,l-k,0);g.p(a);w.u(a)}else f.error("target_set_distance(): Wrong camera object or camera move style")};
a.jz=function(a){return b.sa(a)?g.Jl(a,a.g.pivot):(f.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.p2=function(a,e){if(b.sa(a)){var k=g.br(e,!1,G),l=g.cr(e),c=q.o(),c=r.aa(a,c).U[0],c=b.kD(c)/2,l=l/Math.sin(c),c=g.Jl(a,k);b.Vo(a,z.q(a.g.i),k);g.p(a);g.Ff(a,0,l-c,0);g.p(a);w.u(a)}else f.error("target_zoom_object(): Wrong camera object or camera move style")};a.kT=function(a,e){if(!b.sa(a))return f.error("target_get_pivot(): Wrong camera object or camera move style"),
null;e=e||new Float32Array(3);J.copy(a.g.pivot,e);return e};a.LH=function(a,e){if(b.sa(a)){if(e){if("number"!=typeof e.min||"number"!=typeof e.max||e.min>e.max){f.error("target_set_distance_limits(): Wrong limits object");return}e.min=Math.max(e.min,0);e.max=Math.max(e.max,0)}b.YR(a,e);g.p(a);w.u(a)}else f.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.g2=function(a,e){if(!b.sa(a))return f.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var g=a.g;return g.fb?(e=e||{},e.min=g.fb.min,e.max=g.fb.max,e):null};a.oT=function(a,e){b.sa(a)?!e||"number"==typeof e.down&&"number"==typeof e.up?(b.eH(a,e),g.p(a),w.u(a)):f.error("target_set_vertical_limits(): Wrong limits object"):f.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.j2=function(a,e,g){if(!b.sa(a))return f.error("target_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.va?(e=e||{},g?(e.down=a.va.Uk,e.up=a.va.um):
(e.down=a.va.down,e.up=a.va.up),e.camera_space=g||!1,e):null};a.nT=function(a,e){b.sa(a)?!e||"number"==typeof e.left&&"number"==typeof e.right?(b.TG(a,e),g.p(a),w.u(a)):f.error("target_set_horizontal_limits(): Wrong limits object"):f.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.h2=function(a,e,g){if(!b.sa(a))return f.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.g;return a.$a?(e=e||{},g?(e.left=a.$a.vl,e.right=a.$a.Ul):
(e.left=a.$a.left,e.right=a.$a.right),e.camera_space=g||!1,e):null};a.k2=function(a,e){b.sa(a)?e&&("number"!=typeof e.min_y||"number"!=typeof e.max_y||e.min_y>e.max_y)?f.error("target_set_pivot_limits(): Wrong limits object"):(b.oS(a,e),g.p(a),w.u(a)):f.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.i2=function(a,e){if(!b.sa(a))return f.error("target_get_pivot_limits(): Wrong camera object or camera move style"),null;var g=a.g;return g.cf?(e=e||{},e.min_y=g.cf.min_y,
e.max_y=g.cf.max_y,e):null};a.lT=function(a,e,k){if(b.sa(a)){var l=a.g;l.use_panning&&(G[0]=e,G[1]=0,G[2]=k,z.Tc(G,l.i,G),J.add(l.pivot,G,l.pivot),e=z.q(l.i),J.add(e,G,e),g.p(a),w.u(a))}else f.error("target_pan_pivot(): wrong object")};a.o2=function(a,e){if(!b.sa(a))return f.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.g.use_panning=e};a.u_=function(d,e){a.GP(d,{pos:e.pos,pivot:e.pivot});var f="undefined"==typeof e.dist_interval?0:Math.max(e.dist_interval,0),k=
"undefined"==typeof e.angle_interval?0:Math.max(e.angle_interval,0),c="undefined"==typeof e.t?.5:A.S(e.t,0,1),l=a.zE(d,H);l.min=Math.max(l.min-c*f,0);l.max+=(1-c)*f;f=a.AE(d,I);f.down=A.S(f.down+c*k,-Math.PI/2,0);f.up=A.S(f.up-(1-c)*k,-Math.PI/2,0);b.or(d,l);b.pr(d,f);g.p(d);w.u(d);b.ho(d)};a.GP=function(a,e){if(r.ka(a)){if(e.dist_lim){if("number"!=typeof e.dist_lim.min||"number"!=typeof e.dist_lim.max||e.dist_lim.min>e.dist_lim.max){f.error("hover_setup(): Wrong distance limits object");return}e.dist_lim.min=
Math.max(e.dist_lim.min,0);e.dist_lim.max=Math.max(e.dist_lim.max,0)}e.hover_angle_lim&&("number"!=typeof e.hover_angle_lim.down||"number"!=typeof e.hover_angle_lim.up||e.hover_angle_lim.down<e.hover_angle_lim.up)?f.error("hover_setup(): Wrong hover angle limits object"):e.horiz_trans_lim&&("number"!=typeof e.horiz_trans_lim.min||"number"!=typeof e.horiz_trans_lim.max||e.horiz_trans_lim.min>e.horiz_trans_lim.max)?f.error("hover_setup(): Wrong horizontal translation limits object"):e.vert_trans_lim&&
("number"!=typeof e.vert_trans_lim.min||"number"!=typeof e.vert_trans_lim.max||e.vert_trans_lim.min>e.vert_trans_lim.max)?f.error("hover_setup(): Wrong vertical translation limits object"):(b.vt(a),a.g.lb=b.yc,b.ES(a,e.pos||z.q(a.g.i),e.pivot,e.dist_lim,e.hover_angle_lim,e.horiz_trans_lim,e.vert_trans_lim,e.enable_horiz_rot||!1),g.p(a),w.u(a),b.ho(a))}else f.error("hover_setup(): Wrong camera object")};a.BE=function(a,e,k){var l,c;b.Ia(a)?(b.Ro(a,e,k,l||!1,c||!1),g.p(a),w.u(a)):f.error("hover_rotate(): Wrong camera object or camera move style")};
a.t_=function(a,e){b.Ia(a)?(b.Fs(a,e),g.p(a),w.u(a)):f.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.r_=function(a,e){if(!b.Ia(a))return f.error("hover_get_pivot(): Wrong camera object or camera move style"),null;e=e||new Float32Array(3);J.copy(a.g.wb,e);return e};a.DP=function(a){return b.Ia(a)?g.Jl(a,a.g.wb):(f.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.pr=function(a,e){b.Ia(a)?"number"!=typeof e.down||"number"!=typeof e.up||
e.down<e.up?f.error("hover_set_vertical_limits(): Wrong limits object"):(b.pr(a,e),g.p(a),w.u(a)):f.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.AE=function(a,e){if(!b.Ia(a))return f.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var g=a.g;e=e||{};e.down=g.va.down;e.up=g.va.up;return e};a.or=function(a,e){b.Ia(a)?"number"!=typeof e.min||"number"!=typeof e.max||e.min>e.max?f.error("hover_set_distance_limits(): Wrong limits object"):
(e.min=Math.max(e.min,0),e.max=Math.max(e.max,0),b.or(a,e),g.p(a),w.u(a)):f.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.zE=function(a,e){if(!b.Ia(a))return f.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var g=a.g;e=e||{};e.min=g.fb.min;e.max=g.fb.max;return e};a.FP=function(a,e){b.Ia(a)?e&&("number"!=typeof e.min||"number"!=typeof e.max||e.min>e.max)?f.error("hover_set_vert_trans_limits(): Wrong limits object"):(b.yS(a,e),
g.p(a),w.u(a)):f.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.s_=function(a,e){if(!b.Ia(a))return f.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var g=a.g;return g.Lc?(e=e||{},e.min=g.Lc.min,e.max=g.Lc.max,e):null};a.EP=function(a,e){b.Ia(a)?e&&("number"!=typeof e.min||"number"!=typeof e.max||e.min>e.max)?f.error("hover_set_horiz_trans_limits(): Wrong limits object"):(b.hS(a,e),g.p(a),w.u(a)):f.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};
a.q_=function(a,e){if(!b.Ia(a))return f.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var g=a.g;return g.Kc?(e=e||{},e.min=g.Kc.min,e.max=g.Kc.max,e):null};a.v_=function(a,e){if(!b.Ia(a))return f.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.g.Ln=e};a.rl=b.rl;a.sa=b.sa;a.Hb=b.Hb;a.Ia=b.Ia;a.Ey=function(a,e){if(!r.ka(a))return f.error("set_move_style(): Wrong camera object"),!1;if(e!=b.Vf&&e!=b.xc&&e!=b.bb&&e!=b.yc)return f.error("set_move_style(): Wrong move style"),
!1;b.Ey(a,e);g.p(a);w.u(a);return!0};a.Wh=function(a){return r.ka(a)?b.Wh(a):(f.error("get_move_style(): Wrong camera object"),null)};a.lc=function(a,e){if(r.ka(a)){var k=a.g;if(b.sa(a)){var l=z.q(k.i),l=J.subtract(e,l,G);J.add(l,k.pivot,k.pivot)}else b.Ia(a)&&(l=z.q(k.i),l=J.subtract(e,l,G),J.add(l,k.wb,k.wb));g.lc(a,e);g.p(a);w.u(a)}else f.error("set_translation(): Wrong camera object")};a.yf=function(a,b){if(!r.ka(a))return f.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);
return g.yf(a,b)};a.K0=function(a,e,k,l,c){r.ka(a)?(l=l||!1,c=c||!1,b.sa(a)?b.us(a,e,k,l,c):b.Hb(a)?b.Qo(a,e,k,l,c):b.Ia(a)?b.Ro(a,e,k,l,c):b.rl(a)?f.warn("rotate_camera(): not supported for STATIC cameras"):f.error("rotate_camera(): Wrong camera move style"),g.p(a),w.u(a)):f.error("rotate_camera(): Wrong camera object")};a.wS=function(a,b){if(r.ka(a)){var e=a.g;"number"==typeof b.trans&&(e.lp=A.S(b.trans,0,Infinity));"number"==typeof b.rot&&(e.kp=A.S(b.rot,0,Infinity));"number"==typeof b.zoom&&(e.mp=
A.S(b.zoom,0,.99))}else f.error("set_velocities(): Wrong camera object")};a.hg=function(a,b){if(!r.ka(a))return f.error("get_velocities(): Wrong camera object"),null;var e=a.g;b=b||{};b.trans=e.lp;b.rot=e.kp;b.zoom=e.mp;return b};a.K_=function(a){return r.ka(a)?0<=A.Cb(z.B(a.g.i),A.md,G)[1]:(f.error("is_look_up(): Wrong camera object"),!1)};a.hl=function(a,e){if(!r.ka(a))return f.error("get_camera_angles(): Wrong camera object"),null;e=e||new Float32Array(2);b.hl(a,e);return e};a.Zq=function(a,e){if(!r.ka(a))return f.error("get_camera_angles_char(): Wrong camera object"),
null;e=e||new Float32Array(2);b.Zq(a,e);return e};a.bH=function(a,e){if(r.ka(a))for(var g=q.o(),g=r.aa(a,g).U,k=0;k<g.length;k++){var c=g[k];c.type!=b.cc&&c.type!=b.pc&&c.type!=b.wd&&c.type!=b.xd||b.rS(c,e,c.gf)}else f.error("set_stereo_distance(): Wrong camera object")};a.$D=function(a){if(!r.ka(a))return f.error("get_stereo_distance(): Wrong camera object"),0;var e=q.o();a=r.aa(a,e).U;for(e=0;e<a.length;e++){var g=a[e];if(g.type==b.cc||g.type==b.pc)return g.mm}return 0};a.zy=function(a,e){if(r.ka(a)){var g=
q.o(),g=r.aa(a,g).U;b.zy(g,e)}else f.error("set_eye_distance(): Wrong camera object")};a.VY=function(a){if(!r.ka(a))return f.error("get_eye_distance(): Wrong camera object"),0;var e=q.o();a=r.aa(a,e).U;for(e=0;e<a.length;e++){var g=a[e];if(g.type==b.cc||g.type==b.pc||g.type==b.wd||g.type==b.xd)return g.gf}return 0};a.G1=function(a,b){r.ka(a)?(J.copy(b,a.g.hf),g.p(a),w.u(a)):f.error("set_vertical_axis(): Wrong camera object")};a.UZ=function(a,b){if(r.ka(a))return b||(b=J.create()),J.copy(a.g.hf,b),
b;f.error("get_vertical_axis(): Wrong camera object")};a.u2=function(a,e,g,l){if(r.ka(a)){var c=q.o();a=r.aa(a,c).U;for(c=0;c<a.length;c++){var m=a[c];m.kc||b.si(m,m.ib);var z=G;z[0]=-e;z[1]=-g;z[2]=0;k.translate(m.Bb,z,m.Bb);k.rotateZ(m.Bb,l,m.Bb);b.BB(m);b.mv(m)}}else f.error("translate_view(): Wrong camera object")};a.WZ=function(a,b){if(!r.ka(a))return f.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);A.Cb(z.B(a.g.i),A.md,b);return b};a.aP=function(a){if(!r.ka(a))return f.error("get_fov(): Wrong camera object"),
0;var b=q.o();a=r.aa(a,b).U;return A.jb(a[0].Bd)};a.b1=function(a,e){if(r.ka(a))for(var g=q.o(),g=r.aa(a,g).U,k=0;k<g.length;k++){var c=g[k];c.Bd=A.Ld(e);c.kc||b.si(c,c.ib);b.BB(c);b.mv(c)}else f.error("set_fov(): Wrong camera object")};a.Dy=function(a,e,g){var k;if(!(k=r.ka(a)))a:{if(r.ka(a)){k=q.o();k=r.aa(a,k).U;for(var c=0;c<k.length;c++){var l=k[c];if(l.type==b.wd||l.type==b.xd){k=!0;break a}}}else f.error("is_hmd_camera(): Wrong camera object");k=!1}k?e&&g&&b.Dy(a,e,g):f.error("set_hmd_fov(): Wrong camera object")};
a.Rh=function(a,b,k){r.ka(a)?(b=b||a.g.hf,e.Rh(a,b,k||!1),g.p(a),w.u(a)):f.error("correct_up(): Wrong camera object")};a.r1=function(a,e){if(r.ka(a)&&b.Cr(a)){var g=a.g;if(b.sa(a)){var k=z.q(g.i),k=J.dist(k,g.pivot);g.ml=e/2*g.ll/k}else b.Ia(a)?(k=z.q(g.i),k=J.distance(k,g.wb),g.ml=e/2*g.ll/k):(g=q.o(),r.aa(a,g).U[0].top=e/2);b.UT(a)}else f.error("set_ortho_scale(): Wrong camera object")};a.xZ=function(a){if(!r.ka(a)||!b.Cr(a))return f.error("get_ortho_scale(): Wrong camera object"),0;var e=q.o();
return 2*r.aa(a,e).U[0].top};a.Cr=function(a){return r.ka(a)?b.Cr(a):(f.error("is_ortho_camera(): Wrong camera object"),!1)};a.WW=function(a,e,k,l){if(!r.ka(a))return f.error("calc_ray(): Wrong camera object"),null;var c=q.o(),m=r.aa(a,c).U[0];l&&3==l.length?f.fc('dest parameter in the function "calc_ray" should be type of parametric line.'):l=l||new Float32Array(6);switch(m.type){case b.Vc:case b.Dg:case b.cc:case b.pc:var w=Math.tan(m.Bd*Math.PI/360),K=w*m.ib,c=G;e=x.an(e,k,F,m);c[0]=(2*e[0]/m.width-
1)*K;c[1]=-1;c[2]=(2*e[1]/m.height-1)*w;z.Tc(c,a.g.i,c);J.normalize(c,c);3==l.length?J.copy(c,l):(a=g.yf(a,D),B.XG(l,a),B.Hy(l,c));return l;case b.Wd:return c=G,e=x.an(e,k,F,m),c[0]=(2*e[0]/m.width-1)*m.top*m.ib,c[1]=0,c[2]=(2*e[1]/m.height-1)*m.top,z.Fc(c,a.g.i,c),J.copy(c,l),J.transformQuat(A.md,z.B(a.g.i),c),B.Hy(l,c),l;default:return f.error("calc_ray(): Non-compatible camera"),l}};a.Wx=function(a,e,g){if(!r.ka(a))return f.error("project_point(): Wrong camera object"),null;g=g||new Float32Array(2);
return b.Wx(a,e,g)};a.c_=function(a){return(b.sa(a)||b.Ia(a))&&null!==a.g.fb};a.l_=function(a){return(b.Hb(a)||b.sa(a)||b.Ia(a))&&null!==a.g.va};a.k_=function(a){f.kb("has_vertical_limits","has_vertical_rot_limits");return b.sa(a)||b.Hb(a)?null!==a.g.va:(f.error("has_vertical_limits(): Wrong camera object"),!1)};a.e_=function(a){return(b.sa(a)||b.Hb(a))&&null!==a.g.$a};a.d_=function(a){f.kb("has_horizontal_limits","has_horizontal_rot_limits");return b.sa(a)||b.Hb(a)?null!==a.g.$a:(f.error("has_horizontal_limits(): Wrong camera object"),
!1)};a.m_=function(a){return b.Ia(a)&&null!==a.g.Lc};a.f_=function(a){return b.Ia(a)&&null!==a.g.Kc};a.$_=function(a,e,k){f.kb("move_pivot","target_pan_pivot");if(b.sa(a)){var l=a.g;if(l.use_panning){var c=z.q(l.i),m=J.subtract(c,l.pivot,D);G[0]=e;G[1]=0;G[2]=k;J.scale(G,J.len(m),G);z.Tc(G,l.i,G);J.add(l.pivot,G,l.pivot);J.add(c,G,c);g.p(a);w.u(a)}}else f.error("move_pivot(): wrong object")};a.F1=function(a,b){f.kb("set_velocity_params","set_velocities");if(r.ka(a)){var e=a.g;e.lp=A.S(b[0],0,Infinity);
e.kp=A.S(b[1],0,Infinity);e.mp=A.S(b[2],0,.99)}else f.error("set_velocity_params(): Wrong camera object")};a.TZ=function(a,b){f.kb("get_velocity_params","get_velocities");if(!r.ka(a))return f.error("get_velocity_params(): Wrong camera object"),null;b=b||new Float32Array(3);var e=a.g;b[0]=e.lp;b[1]=e.kp;b[2]=e.mp;return b};a.rX=function(a){f.fc('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');
r.ka(a)?b.sa(a)||b.Hb(a)?a.g.$a=null:b.Ia(a)&&(a.g.Kc=null):f.error("clear_horizontal_limits(): Wrong camera object")};a.vX=function(a){f.fc('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');r.ka(a)?b.sa(a)||b.Hb(a)?a.g.va=null:b.Ia(a)&&(a.g.Lc=null):f.error("clear_vertical_limits(): Wrong camera object")};a.sX=function(){f.fc("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};
a.Gs=function(a,h,k,l){f.bg("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);l=l||a.g.hf;b.Gs(a,h,k);e.Rh(a,l,!0);g.p(a);w.u(a)};a.Qo=function(a,e,k,l,c){f.bg("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);b.Hb(a)?(b.Qo(a,e,k,l,c),g.p(a),w.u(a)):f.error("rotate_eye_camera(): wrong object")};a.us=function(a,e,k,l,c){f.bg("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);b.sa(a)?(b.us(a,e,k,l,c),g.p(a),w.u(a)):f.error("rotate_target_camera(): wrong object")};
a.Vo=function(a,e,k){f.kb("camera.set_trans_pivot","camera.target_set_trans_pivot");b.sa(a)?(b.Vo(a,e,k),g.p(a),w.u(a)):f.error("set_trans_pivot(): Wrong object or camera move style")};a.T2=function(a,e){f.kb("camera.zoom_object","camera.target_zoom_object");if(b.sa(a)){g.br(e,!1,G);m(a,G);g.p(a);var k=g.cr(e),l=q.o(),l=r.aa(a,l).U[0],l=b.kD(l)/2,k=k/Math.sin(l),l=g.Jl(a,G);g.Ff(a,0,k-l,0);g.p(a);w.u(a)}else f.error("zoom_object(): wrong object")};a.s1=m;a.Ro=function(a,e,k,l,c){f.kb("camera.rotate_hover_camera",
"camera.hover_rotate");b.Ia(a)?(b.Ro(a,e,k,l,c),g.p(a),w.u(a)):f.error("rotate_hover_camera(): wrong object")};a.kZ=function(a,e){f.kb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!b.Ia(a))return f.error("get_hover_cam_pivot(): wrong object"),null;e||(e=new Float32Array(3));J.copy(a.g.wb,e);return e};a.zD=function(a,e){f.kb("camera.get_eye","camera.get_translation");return r.ka(a)?b.zD(a,e):(f.error("get_eye(): Wrong object"),null)};a.AZ=function(a,e){f.kb("camera.get_pivot","camera.target_get_pivot");
if(!b.sa(a))return f.error("get_pivot(): Wrong object or camera move style"),null;e||(e=new Float32Array(3));J.copy(a.g.pivot,e);return e};a.p_=function(a,e){f.kb("camera.hover_cam_set_translation","camera.set_translation");if(b.Ia(a)){var k=a.g,l=J.subtract(e,z.q(k.i),G);J.add(l,k.wb,k.wb);g.lc(a,e);g.p(a);w.u(a)}else f.error("hover_cam_set_translation(): wrong object")};a.Fs=function(a,e){f.kb("camera.set_hover_pivot","camera.hover_set_pivot_translation");b.Ia(a)?(b.Fs(a,e),g.p(a),w.u(a)):f.error("set_hover_pivot(): Wrong object or camera move style")};
a.jZ=function(a,e){f.kb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!b.Ia(a))return f.error("get_hover_angle_limits(): wrong object"),null;e=e||new Float32Array(2);e[0]=a.g.va.down;e[1]=a.g.va.up;return e};a.HY=function(a,e){f.bg("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!b.Ia(a)&&!b.sa(a))return f.error("get_cam_dist_limits(): wrong object"),null;if(a.g.fb)e=e||new Float32Array(2),e[0]=a.g.fb.max,e[1]=a.g.fb.min;
else return null;return e};a.JW=function(d,e,k,l){f.bg("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);if(b.sa(d)){var c=H;c.down=e;c.up=k;c.camera_space=l==g.wk;a.oT(d,c)}else b.Hb(d)?(c=H,c.down=e,c.up=k,c.camera_space=l==g.wk,a.kO(d,c)):b.Ia(d)?(c=H,c.min=e,c.max=k,a.FP(d,c)):f.error("apply_vertical_limits(): wrong object")};a.GW=function(b,e,g){f.kb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");
H.down=e;H.up=g;a.pr(b,H)};a.DW=function(d,e,g){f.bg("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(b.sa(d)){var k=H;k.min=e;k.max=g;a.LH(d,k)}else b.Ia(d)?(k=H,k.min=e,k.max=g,a.or(d,k)):f.error("apply_distance_limits(): wrong object")};a.pX=function(b){f.kb("camera.clear_distance_limits","camera.target_set_distance_limits");a.LH(b,null)};a.VZ=function(a,e){f.bg("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits",
"camera.hover_get_vert_trans_limits"]);if(!b.sa(a)&&!b.Hb(a)&&!b.Ia(a))return f.error("get_vertical_limits(): wrong object"),null;var g=a.g;e=e||new Float32Array(2);if(b.Hb(a)||b.sa(a)){if(g.va)return e[0]=g.va.down,e[1]=g.va.up,e}else if(b.Ia(a)&&g.Lc)return e[0]=g.Lc.min,e[1]=g.Lc.max,e;return null};a.FW=function(d,e,k,l){f.bg("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(b.sa(d)){var c=H;c.left=
e;c.right=k;c.camera_space=l==g.wk;a.nT(d,c)}else b.Hb(d)?(c=H,c.left=e,c.right=k,c.camera_space=l==g.wk,a.jO(d,c)):b.Ia(d)?(c=H,c.min=e,c.max=k,a.EP(d,c)):f.error("apply_horizontal_limits(): wrong object")};a.iZ=function(a,e){f.bg("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!b.sa(a)&&!b.Hb(a)&&!b.Ia(a))return f.error("get_horizontal_limits(): wrong object"),null;var g=a.g;e=e||new Float32Array(2);
if(b.Hb(a)||b.sa(a)){if(g.$a)return e[0]=g.$a.left,e[1]=g.$a.right,e}else if(b.Ia(a)&&g.Kc)return e[0]=g.Kc.min,e[1]=g.Kc.max,e;return null};a.hZ=function(a,b){if(!r.ka(a))return f.error("get_frustum_planes(): Wrong camera object"),null;var e=q.o(),e=r.aa(a,e).U[0].cl;N.copy(e.left,b.left);N.copy(e.right,b.right);N.copy(e.top,b.top);N.copy(e.bottom,b.bottom);N.copy(e.near,b.near);N.copy(e.far,b.far);return b}};b4w.module.config=function(a,l){var m=l("__config");a.Ri=m.Ri;a.Qi=m.Qi;a.vk=m.vk;a.Eu=m.Eu;a.set=m.set;a.get=m.get;a.reset=m.reset;a.Ow=m.Ow};b4w.module.constraints=function(a,l){var m=l("__camera"),b=l("__constraints"),e=l("__obj_util"),x=l("__physics"),k=l("__print"),B=l("__transform");a.zW=function(a,e,f,k,g){g=g||1;e instanceof Array&&2==e.length?b.dL(a,e[0],e[1],f,k,g):b.fB(a,e,f,k,g);B.p(a);x.u(a)};a.xW=function(a,e,f,k){b.bL(a,e,f,k);B.p(a);x.u(a)};a.yW=function(a,e,f,l,g,z,A,J){m.Hb(a)?(g=g||-Math.PI/2,z=z||Math.PI/2,A=A||Math.PI/2,J=J||-Math.PI/2,b.aL(a,e,f,l,g,z,A,J),B.p(a),x.u(a)):k.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.wW=function(a,e,f,l){if(m.Hb(a)){if(!l||0>l)l=.25;b.$K(a,e,f,l);B.p(a);x.u(a)}else k.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.fL=function(a,e){b.gL(a,e);B.p(a);x.u(a)};a.rW=function(a,e,f){b.VK(a,e,f);B.p(a);x.u(a)};a.AW=function(a,e,f,k){b.hL(a,e,f,k);B.p(a);x.u(a)};a.BW=function(a,e){3==e.length?b.lL(a,e):b.kL(a,e);B.p(a);x.u(a)};a.uW=function(a,e,f,k){3==e.length?b.XK(a,e,f,k):b.WK(a,e,f,k);B.p(a);x.u(a)};a.Tu=function(a,e,f){b.Tu(a,e,f);
B.p(a);x.u(a)};a.remove=function(a){a.zb&&b.remove(a)};a.dr=function(a){k.kb("constraints.get_parent","objects.get_parent");return e.dr(a)}};b4w.module.container=function(a,l){var m=l("__container"),b=l("__print");a.$q=m.$q;a.tD=m.tD;a.le=m.le;a.xr=function(a,l){2!=arguments.length?b.error("insert_to_container(): two arguments required"):a&&l&&m.xr(a,l)};a.IG=m.IG;a.eI=m.eI;a.tq=m.tq;a.sw=m.sw;a.resize=function(a,l,k){a&&l||b.warn("Wrong canvas container dimensions: "+a+"x"+l+". Zero dimensions aren't allowed. Resized to: "+m.Dt+"x"+m.Ct+".");m.resize(a,l,k)};a.oi=m.oi};b4w.module.controls=function(a,l){var m=l("__controls"),b=l("__print");a.Cg=m.Cg;a.Ua=m.Ua;a.Bt=m.Bt;a.mf=m.mf;a.Bg=m.Bg;a.At=m.At;a.sV=8;a.cW=9;a.AV=13;a.$V=16;a.wV=17;a.qV=18;a.WV=19;a.uV=20;a.CV=27;a.bW=32;a.hA=37;a.kA=38;a.iA=39;a.gA=40;a.hV=49;a.iV=50;a.jV=51;a.kV=52;a.lV=53;a.mV=54;a.nV=55;a.oV=56;a.pV=57;a.eA=65;a.rV=66;a.qJ=67;a.fA=68;a.zV=69;a.rJ=70;a.EV=71;a.GV=72;a.HV=73;a.IV=74;a.sJ=75;a.tJ=76;a.JV=77;a.KV=78;a.VV=79;a.vJ=80;a.YV=81;a.wJ=82;a.jA=83;a.yJ=84;a.dW=85;a.eW=86;a.lA=87;a.fW=
88;a.gW=89;a.hW=90;a.LV=96;a.MV=97;a.NV=98;a.OV=99;a.PV=100;a.QV=101;a.RV=102;a.SV=103;a.TV=104;a.UV=105;a.yV=110;a.ZV=186;a.BV=187;a.vV=188;a.xV=189;a.XV=190;a.DV=191;a.FV=192;a.uJ=219;a.tV=220;a.xJ=221;a.aW=222;a.Pp=m.Pp;a.Op=m.Op;a.Np=m.Np;a.Du=m.Du;a.Dq=m.Dq;a.Mk=m.Mk;a.Jv=m.Jv;a.dc=m.dc;a.Iv=function(a,b,k){return m.Iv(a,b||"ANY",k||!1)};a.gC=m.gC;a.nC=function(a,b,k,l,r,w,f){return m.nC(a,b,k,l||"ANY",r||!1,w||!1,f||!1)};a.sn=m.sn;a.Mv=m.Mv;a.Ok=m.Ok;a.Fq=m.Fq;a.Ov=m.Ov;a.rC=m.rC;a.qC=m.qC;
a.mC=m.mC;a.sC=m.sC;a.hC=m.hC;a.jC=m.jC;a.iC=m.iC;a.lC=m.lC;a.kC=m.kC;a.pC=function(a,b){return m.pC(a,b||!1)};a.wG=m.wG;a.Cq=m.Cq;a.oC=m.oC;a.Eq=function(a,b){return m.Eq(a,b||!1)};a.Hv=function(a,b){return m.Hv(a,b||0)};a.W0=function(a,b){m.QR(a,b)};a.PY=function(a){return a.value};a.Xe=m.Xe;a.gg=m.gg;a.ja=function(a,b,k,l,r,w,f){r=r||m.CC;m.ja(a,b,k,l,r,w,void 0===f?null:f)};a.Nk=function(a,b,k,l,r){var w;l=m.dc(l);m.ja(a,b,k,[l],m.CC,r,void 0===w?null:w)};a.mX=function(a){return m.pq(a,null)};
a.pq=m.pq;a.Oo=m.Oo;a.reset=m.reset;a.y0=function(){b.fc("controls.register_keyboard_events() deprecated")};a.z0=function(){b.fc("controls.register_mouse_events() deprecated")};a.B0=function(){b.fc("controls.register_wheel_events() deprecated")};a.A0=function(){b.fc("controls.register_touch_events() deprecated")};a.x0=function(){b.fc("controls.register_device_orientation() deprecated")};a.B2=function(){b.fc("controls.unregister_keyboard_events() deprecated")};a.C2=function(){b.fc("controls.unregister_mouse_events() deprecated")};
a.E2=function(){b.fc("controls.unregister_wheel_events() deprecated")};a.D2=function(){b.fc("controls.unregister_touch_events() deprecated")};a.A2=function(){b.fc("controls.unregister_device_orientation() deprecated")}};b4w.module.data=function(a,l){var m=l("__data"),b=l("__loader");l("__print");a.load=m.load;a.kt=function(a){m.kt(a|0)};a.OG=m.OG;a.ig=m.ig;a.J_=b.Fj;a.T_=m.load;a.ha=a.kt;a.aB=m.aB};b4w.module.debug=function(a,l){function m(a){var c={};if(!a)return c;a=a.split("\n");for(var b=0;b<a.length;b++){var d=a[b];if(-1!=d.search(new RegExp(/^[A-Z.]+ /))){var e=d.split(" ")[0];e in c||(c[e]=0);c[e]++}}b=a=0;for(e in c)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":b+=c[e];break;default:a+=c[e]}c.ALU_OPS=a;c.TEX_OPS=b;return c}function b(a,c){var b=new XMLHttpRequest;b.open("POST",a,!1);b.send(c);
if(200==b.status)return b.responseText;throw"Error POST XHR: "+b.status;}function e(a){a.sort(function(a,c){return c.vw.ALU_OPS-a.vw.ALU_OPS});for(var c=0;c<a.length;c++){var b=a[c],d=b.vw,e=b.EU,f=x(b.xN),f=f?"\t\t("+f.join(", ")+")":"\t\t(NA)";N.groupCollapsed("FRAG --\x3e","ALU",d.ALU_OPS,"TEX",d.TEX_OPS,"\t\tVERT --\x3e","ALU",e.ALU_OPS,"TEX",e.TEX_OPS,f);N.groupCollapsed("directives");for(var f=b.Tb.Rg,g=0;g<f.length;g++){var k=f[g];N.log(k[0],k[1])}N.groupEnd();N.groupCollapsed("vert src");
N.log(b.DU);N.groupEnd();N.groupCollapsed("vert stats");for(var h in e)"ALU_OPS"!=h&&"TEX_OPS"!=h&&N.log(h,e[h]);N.groupEnd();N.groupCollapsed("frag src");N.log(b.AO);N.groupEnd();N.groupCollapsed("frag stats");for(h in d)"ALU_OPS"!=h&&"TEX_OPS"!=h&&N.log(h,d[h]);N.groupEnd();N.groupEnd()}}function x(a){for(var c=G.Xn(),b=0;b<c.length;b++)for(var d=c[b],e=z.Gb(d,"MESH",z.oc),f=0;f<e.length;f++){var g=A.aa(e[f],d);if(g&&g.X.length)for(var g=g.X,k=0;k<g.length;k++){var h=g[k];if(h.rb==a&&h.Df.length)return h.Df}}return null}
function k(a,b){function d(){M.push(d);c=b;return a.apply(a,arguments)}return d}function B(a,c,b){if(typeof c!=typeof a)throw"Wrong expected data type.";if(a.length!=c.length)throw"Wrong expected vector length.";b=b?b:1E-6;for(var d=0;d<a.length;d++)if(c[d]>a[d]+b||c[d]<a[d]-b)throw"Wrong result.";}l("__config");var r=l("__controls"),w=l("__container"),f=l("__debug"),q=l("__extensions"),g=l("__loader"),z=l("__objects"),A=l("__obj_util"),J=l("__physics"),N=l("__print"),F=l("__renderer"),G=l("__scenes"),
D=l("__scenegraph"),H=l("__sfx"),I=l("__shaders"),d=l("__textures"),h=l("__util"),v=l("__vec3"),M=[],c="",p=!0,R=new Float32Array(2);a.zp=f.zp;a.Kt=f.Kt;a.Ap=f.Ap;a.Jt=f.Jt;a.yp=f.yp;a.It=f.It;a.Ht=f.Ht;a.Fm=f.Fm;a.t0=function(){J.EN()};a.s0=function(a){N.log("O",J.oO(a));for(var c=J.OO().Kb.D,b=0;b<c.length;b++){var d=c[b];d.r.J==a&&N.log("B",d)}};a.P2=function(){for(var a=G.o(),c=z.Gb(a,"MESH",z.oc),a=[G.qa(a,"MAIN_OPAQUE"),G.qa(a,"MAIN_BLEND"),G.qa(a,"MAIN_GLOW")],b=0;b<a.length;b++){var d=a[b],
e=d.D;if(e.length){N.group(d.type,"DYNAMIC");for(var f=0;f<c.length;f++){var g=c[f],k=g.g;if("DYNAMIC"==k.type)for(var h=0;h<e.length;h++){var l=e[h];if(l.ec&&l.mg==k){N.rx(g.name,g);break}}}N.groupEnd();N.groupCollapsed(d.type,"STATIC");for(f=0;f<c.length;f++)if(g=c[f],k=g.g,"DYNAMIC"!=k.type)for(h=0;h<e.length;h++)if(l=e[h],l.ec&&l.mg==k){N.rx(g.name,g);break}N.groupEnd()}}};a.k0=function(a){for(var c=G.o(),b=z.Gb(c,"MESH",z.oc),d=0;d<b.length;d++){var e=b[d];if(e.name==a){N.log("Object",e);for(var f=
G.Bw(c),g=0;g<f.length;g++){for(var k=f[g],h=k.D,l=[],m=0;m<h.length;m++)h[m].mg==e.g&&l.push(h[m]);N.log("Subscene "+k.type,l)}}}};a.l0=function(){var a=G.o();console.log("Armatures: "+z.Gb(a,"ARMATURE",z.oc).length);console.log("Cameras: "+z.Gb(a,"CAMERA",z.oc).length);console.log("Curves: "+z.Gb(a,"CURVE",z.oc).length);console.log("Empties: "+z.Gb(a,"EMPTY",z.oc).length);console.log("Lamps: "+z.Gb(a,"LAMP",z.oc).length);console.log("Meshes: "+z.Gb(a,"MESH",z.oc).length);console.log("Speakers: "+
z.Gb(a,"SPEAKER",z.oc).length)};a.Kx=function(){for(var a=0,c=G.o(),c=[G.qa(c,"MAIN_OPAQUE"),G.qa(c,"MAIN_BLEND"),G.qa(c,"MAIN_GLOW")],b=0;b<c.length;b++){var d=c[b];if(d)for(var d=d.D,e=0;e<d.length;e++){var f=d[e].G;f&&(a+=f.Kx)}}return a};a.wo=function(){for(var a=0,c=G.o(),c=[G.qa(c,"MAIN_OPAQUE"),G.qa(c,"MAIN_BLEND"),G.qa(c,"MAIN_GLOW")],b=0;b<c.length;b++){var d=c[b];if(d)for(var d=d.D,e=0;e<d.length;e++){var f=d[e].G;f&&(a+=f.wo)}}return a};a.e0=function(){for(var a=G.o(),c=[G.qa(a,"MAIN_OPAQUE"),
G.qa(a,"MAIN_BLEND"),G.qa(a,"MAIN_GLOW")],b=0,d=0;d<c.length;d++){var e=c[d];e&&(b+=e.D.length)}a=G.DH(a,["MAIN_PLANE_REFLECT","MAIN_PLANE_REFLECT_BLEND","MAIN_CUBE_REFLECT","MAIN_CUBE_REFLECT_BLEND"]);for(d=0;d<a.length;d++)e=a[d],b="MAIN_PLANE_REFLECT"==e.type||"MAIN_PLANE_REFLECT_BLEND"==e.type?b+e.D.length:b+6*e.D.length;return b};a.h0=function(){return h.Yn(I.uD())};a.EY=function(){for(var a=G.o(),c=G.Bw(a),a={},b=0;b<c.length;b++){var d=c[b];if("SINK"!=d.type&&"DEBUG_VIEW"!=d.type)for(var e=
d.D,f=0;f<e.length;f++){var g=e[f].G,k=e[f].mg;g&&("COLOR_PICKING"!=d.type&&"OUTLINE_MASK"!=d.type||k.Zr||k.Yr)&&(a[g.id]=g)}}var e=d=b=c=0,h;for(h in a)g=a[h],g=g.oa,g.Hq&&(d++,e+=g.Hq/1048576),c++,b+=g.BC/1048576;return{vbo_number:c,vbo_memory:b,ibo_number:d,ibo_memory:e}};a.i0=function(){for(var a=[],c=0,b=G.o(),b=[G.qa(b,"MAIN_OPAQUE"),G.qa(b,"MAIN_BLEND"),G.qa(b,"MAIN_GLOW")],d=0;d<b.length;d++){var e=b[d];if(e)for(var e=e.D,f=0;f<e.length;f++){var g=e[f].G;if(g)for(var g=g.fa,k=0;k<g.length;k++){var h=
g[k];if("IMAGE"===h.source||"ENVIRONMENT_MAP"===h.source){var l=h.hb;-1===a.indexOf(l)&&(a.push(l),h=h.width*h.height*4/1048576/h.Dv,h*=1.3333,c+=h)}}}}return{number:a.length,memory:c}};a.g0=function(){for(var a=[],c=0,b=G.o(),b=G.Bw(b),e=0;e<b.length;e++){var f=b[e];if("SINK"!=f.type){var g=f.k,k=[g.Wb,g.he];k.push.apply(k,f.vg);for(f=0;f<k.length;f++){var h=k[f];d.sl(h)&&-1==a.indexOf(h)&&(a.push(h),c+=g.width*g.height*d.oP(h))}}}return{number:a.length,memory:c/1024/1024}};a.zQ=function(){var a=
G.o();(a=G.qa(a,"MAIN_OPAQUE"))&&G.jF(a.k,a,[1,1,0])};a.CQ=function(){var a=G.o(),c=G.qa(a,"MAIN_OPAQUE"),a=G.DH(a,["SHADOW_CAST"]);if(c)for(var b=0;b<a.length;b++){var d=a[b],e;switch(b){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}G.jF(d.k,c,e)}};a.Q0=function(){for(var a=G.Xn(),c=0;c<a.length;c++)N.log("\n"+D.BN(G.Jw(a[c])))};a.R0=function(){};a.W_=function(){N.log("\n"+g.tP())};a.yX=r.debug;a.j0=function(a,c){return v.dist(m_tsr.q(a.g.i),m_tsr.q(c.g.i))};
a.yF=f.yF;a.Tq=f.Tq;a.dG=f.dG;a.Tx=f.Tx;a.oY=function(a,c){function b(){f.Tq("FBRES",a());setTimeout(b,c)}c||(c=16);b()};a.MW=function(){var a=new Float32Array(3),c=new Float32Array([0,0,0,1]),b=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),k=new Float32Array([0,0,-1]);if(!h.Qh(a,h.IA))throw"Wrong VEC3_IDENT";if(!h.Qh(c,h.Fu))throw"Wrong QUAT4_IDENT";if(!h.Qh(b,h.Ke))throw"Wrong AXIS_X";if(!h.Qh(d,h.wc))throw"Wrong AXIS_Y";
if(!h.Qh(e,h.lf))throw"Wrong AXIS_Z";if(!h.Qh(f,h.zt))throw"Wrong AXIS_MX";if(!h.Qh(g,h.md))throw"Wrong AXIS_MY";if(!h.Qh(k,h.Oi))throw"Wrong AXIS_MZ";};a.c0=function(){for(var a=H.mP(),c=0;c<a.length;c++){var b=a[c];"BACKGROUND_MUSIC"==H.Nw(b)&&H.Nj(b,!0)}};a.LB=function(a){f.LB(a)};a.Z0=function(a){var c=G.o();if(c=G.qa(c,"DEBUG_VIEW")){if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case f.zp:case f.Kt:case f.Ap:case f.Jt:case f.yp:case f.It:case f.Ht:case f.Fm:G.VR(c,a.debug_view_mode);
break;default:N.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&G.UR(c,a.debug_colors_seed);"number"==typeof a.ER&&G.qS(c,a.ER);"object"==typeof a.wireframe_edge_color&&G.BS(c,a.wireframe_edge_color)}else N.error("Debugging is not available on the scene.")};a.UY=function(){return N.ZO()};a.ZZ=function(){return N.qP()};a.WB=function(){return N.WB()};a.pW=function(a){var c=I.uD(),d=0,f;for(f in c)a&&-1===f.indexOf(a)||d++;var d="of "+d+" analyzing...",g={};for(f in c)if(!a||
-1!==f.indexOf(a)){var k=c[f],h;var l=k.Fz;h=k.bD;var p=q.Fw();if(p){l=p.getTranslatedShaderSource(l);h=p.getTranslatedShaderSource(h);l=l.replace("#version","#version 400 //");h=h.replace("#version","#version 400 //");var p=b("/nvidia_vert",l),r=m(p),z=b("/nvidia_frag",h),v=m(z);h={DU:l,Q2:p,EU:r,AO:h,sY:z,vw:v}}else N.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),h=void 0;p=k.Tb;l=p.zm+" + "+p.al;h.xN=k;h.Tb=p;k=g[l]=g[l]||[];k.push(h);N.log(d)}for(l in g)N.group("%c"+
l,"color: #800"),k=g[l],e(k),N.groupEnd()};a.PC=f.PC;a.q2=function(a){if(q.Hw()){var c=D.fN();G.gD(c);for(var b=D.Ob(c,"PERFORMANCE"),c=0;10>c;c++)F.Vk(b);window.setTimeout(function(){f.pR(b);a(b.tf)},100)}else a(-1)};a.Y1=function(a){M=[];p=!0;a=l(a);for(var c in a)"function"===typeof a[c]&&(a[c]=k(a[c],c))};a.eX=function(){return p};a.test=function(a,c){try{return c(),!0}catch(b){return p=!1,console.error(a+" test was failed. ",b),!1}};a.u0=function(a){var c=w.dE(),b=w.cE(),d=c/2,e=b/2;w.resize(c,
b,!1);c=G.o().j.Pa;(b=D.pO(c))||h.l("Couldn't find onscreen subscene");c=b.k;d=w.an(d,e,R,b.k);d[1]=c.height-d[1];d=F.by(c.Ve,d[0],d[1]);B(a,d)};a.bY=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+c;};a.cY=B;a.aY=function(a,c,b){if("number"!=typeof c)throw"Wrong expected data type.";b=b?b:1E-6;if(c>a+b||c<a-b)throw"Wrong result.";};a.$X=function(a,c){if(a!==c)throw"Wrong result.";};a.stat=function(a){a=l(a);for(var c in a)-1==M.indexOf(a[c])&&console.warn(c+
" function wasn't called.")};a.m0=function(a){if(!Boolean(a))throw"Wrong result. Function: "+c;}};b4w.module.input=function(a,l){function m(a){var b=e.da(e.td);if(!b||!b.Jf)return!1;if(A)return!0;var k=e.Yh(b,e.YI,g),l=e.Yh(b,e.ZI,z);x.Dy(a,k,l);if(k=e.gr(b,N))l=f.o(),a=r.aa(a,l).U,x.zy(a,k);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};e.gr(e.Kp)!==e.zu&&(a.distortion_coefs=[b.distortion_coefs[0],b.distortion_coefs[1]],a.chromatic_aberration_coefs=[b.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]],
b.Bm||(b.Kh&&b.$h&&b.Lh?a.base_line_factor=(b.Kh-b.Lh)/b.$h:b.Lh||(a.base_line_factor=b.Kh/b.$h)),b.Dj&&b.Cm&&!b.Bm&&(a.inter_lens_factor=b.Dj/b.Cm),J.enabled||(k=1+b.distortion_coefs[0]+b.distortion_coefs[1],f.zF(k,k)));f.Es(a);B.oi(!0);e.ky(b);return A=!0}function b(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],e=0;e<a.length;e++)a[e]&&b.push(e);return b}var e=l("__input"),x=l("__camera"),k=l("__config"),B=l("__container"),
r=l("__obj_util"),w=l("__print"),f=l("__scenes"),q=l("__vec4"),g=q.create(),z=q.create(),A=!1,J=k.Jq;a.Zt=e.Zt;a.$t=e.$t;a.bu=e.bu;a.au=e.au;a.nu=e.nu;a.Vt=e.Vt;a.Wt=e.Wt;a.gu=e.gu;a.pu=e.pu;a.Gp=e.Gp;a.ou=e.ou;a.Fp=e.Fp;a.qu=e.qu;a.ru=e.ru;a.Xt=e.Xt;a.Yt=e.Yt;a.cu=e.cu;a.du=e.du;a.eu=e.eu;a.fu=e.fu;a.hu=e.hu;a.iu=e.iu;a.ju=e.ju;a.ku=e.ku;a.lu=e.lu;a.mu=e.mu;a.Bp=e.Bp;a.Cp=e.Cp;a.Dp=e.Dp;a.Ep=e.Ep;a.Pt=e.Pt;a.Qt=e.Qt;a.Rt=e.Rt;a.St=e.St;a.Tt=e.Tt;a.Ut=e.Ut;a.Nt=e.Nt;a.Ot=e.Ot;a.Ip=e.Ip;a.Jp=e.Jp;
a.Kp=e.Kp;a.aA=e.aA;a.bA=e.bA;a.$z=e.$z;a.zu=e.zu;var N=e.vu;a.vu=N;a.uu=e.uu;a.su=e.su;a.xu=e.xu;a.yu=e.yu;a.wu=e.wu;a.tu=e.tu;a.Fh=e.Fh;a.Pi=e.Pi;a.Im=e.Im;a.Jm=e.Jm;a.Hm=e.Hm;a.Gm=e.Gm;a.Si=e.Si;a.Mm=e.Mm;a.Lm=e.Lm;a.Hp=e.Hp;a.uk=e.uk;var F={};F[e.td]=[e.Ip,e.Jp];F[e.Oc]=[e.Fh];var G={};G[e.td]=[e.Kp];var D={};D[e.Oc]=[e.Fh,e.Pi,e.Im,e.Jm];D[e.Dm]=[e.Hm,e.Gm];D[e.nf]=[e.Si,e.Mm,e.Lm];D[e.Uf]=[e.Hp,e.uk];var H={};H[e.td]=[e.uu,e.vu,e.su,e.xu,e.yu,e.wu,e.tu];a.Uf=e.Uf;a.td=e.td;a.Oc=e.Oc;a.Dm=e.Dm;
a.nf=e.nf;a.rv=e.rv;a.da=e.da;a.hz=function(a,b){a&&e.hz(a,b)};a.w0=function(){w.fc("input.register_device() deprecated")};a.ky=function(a){a&&a.type==e.td?e.ky(a):w.error("reset_device is undefined for device.")};a.Yh=function(a,b,f){if(a&&a.type in F&&0<=F[a.type].indexOf(b))return e.Yh(a,b,f);w.error("device hasn't param: ",b)};a.gr=function(a,b){if(a&&a.type in G&&0<=G[a.type].indexOf(b))return e.gr(a,b);w.error("device hasn't param: ",b)};a.Xc=function(a,b,f){if(a&&a.type in D&&0<=D[a.type].indexOf(b))return e.Xc(a,
b,f);w.error("device hasn't param: ",b)};a.$c=function(a,b,f){if(a&&a.type in D&&0<=D[a.type].indexOf(b))return e.$c(a,b,f);w.error("device hasn't param: ",b)};a.xy=function(a,b,f){if(a&&a.type in H&&0<=H[a.type].indexOf(b))return e.xy(a,b,f);w.error("device hasn't config: ",b)};a.H0=function(){if(f.za()){var a=f.fl(f.o());if(a&&(m(a),a=e.da(e.td))&&(a=a.He))if(a.capabilities.canPresent){var b=B.$q();a.requestPresent([{source:b}]).then(function(){},function(){w.error("HMD fullscreen request failed.")})}else w.error("HMD fullscreen request failed.")}};
a.ZX=m;a.PX=function(){var a=e.da(e.td);if(!(A||a&&a.Jf))return!1;f.Es({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);f.zF(a,a);B.oi();return!0};a.d1=function(a,d,f){b();switch(a){case 0:a=e.vp;break;case 1:a=e.Et;break;case 2:a=e.Ft;break;case 3:a=e.Gt;break;default:a=e.vp}a=e.da(a);e.xy(a,d,f)};a.OD=e.OD;a.HD=e.HD;a.oM=b};b4w.module.main=function(a,l){function m(){}function b(){}function e(){}function x(){window.performance||(t.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(t.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});T.cH(0)}function k(a,c){for(var b=null,d=c?S:ka,e=0;e<d.length;e++){var f=d[e];try{b=a.getContext(f,W)}catch(g){}if(b)break}b&&F.LN(b);return b}function B(a,c,e){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();t.error("WebGL context lost");w()},!1);d.xe(e);var f=d.QD();f&&t.log("%cRENDERER INFO:","color: #00a",e.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(f.UNMASKED_RENDERER_WEBGL));y.xe(e);h.xe(e);n.xe(e);L.xe(e);I.xe(e);G.xe(e);H.CS(a);G.zf(a,c);u.hH(a.width,a.height,1);C.zf();b=g();q()}function r(){m=function(){}}function w(){f()||(ia=performance.now()/1E3,C.pause(),K.pause(),n.pause(),z.pause())}function f(){return va<ia}function q(){var a="HMD"===ba.stereo&&
v.gE();a?a.requestAnimationFrame(q):X(q);var d=performance.now()/1E3;ea||(ea=d);var e=d-ea;if(!(e<1/ba.Ef)){for(var g=T.ao(),k=0;k<ga.length;k++)ga[k](g,e);f()||(va>ea&&(e-=va-Math.max(ia,ea)),g+=e,T.cH(g),I.update(),J.update(),H.update(),k=e,H.ig()&&(M.reset(),O.update(k),p.update(g,k),c.update(g,k),C.update(g,k),k&&A.update(k),H.ig()&&(K.update(g,k),H.ig()&&(v.update(g),D.update(g,k),H.ig()&&(z.update(),R.update(g,k),la.update(),m(k,g),H.ig()&&(u.update(g,k),z.pI(),E&&(E(aa.toDataURL()),E=null)))))),
b(e));ea=d;a&&a.isPresenting&&a.submitFrame()}}function g(){var a=60,c=0,b=ba.ZC,d=ba.sO;return function(f){f<1/ba.Ef||(a=V.mc(1/f,a,f,b),f=K.bP(),c=(c+1)%d,0==c&&e(Math.round(a),f))}}var z=l("__anchors"),A=l("__animation"),J=l("__assets"),N=l("__config"),F=l("__compat"),G=l("__container"),D=l("__controls"),H=l("__data"),I=l("__debug"),d=l("__extensions"),h=l("__geometry"),v=l("__input"),M=l("__hud"),c=l("__nla"),p=l("__logic_nodes"),R=l("__objects"),K=l("__physics"),t=l("__print"),y=l("__renderer"),
u=l("__scenes"),C=l("__sfx"),L=l("__shaders"),n=l("__textures"),T=l("__time"),O=l("__transform"),V=l("__util"),Y=l("__version"),la=l("__particles"),W=N.context,ba=N.v,aa=null,fa=null,ea=0,ia=0,va=0,ga=[],E=null,ka=["webgl","experimental-webgl"],S=["webgl2","experimental-webgl2"],X=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,
1E3/ba.Ef)}}();a.zf=function(a,c){N.nS();t.xS(ba.console_verbose);var b=Y.Cz()+" "+Y.type()+" ("+Y.Xv()+")";t.log("%cINIT ENGINE","color: #00a",b);if(!window.WebGLRenderingContext)return null;x();aa=a;c?(M.zf(c),fa=c):(N.v.show_hud_debug_info=!1,N.P.Pr=!1);F.oL();F.vv("Chrome")||F.vv("Firefox")||(ba.ld=!1);b=k(a,ba.ld);!b&&ba.ld&&(ba.ld=!1,b=k(a,!1));if(!b)return null;t.log("%cINIT WEBGL "+(ba.ld?"2":"1"),"color: #00a");B(aa,fa,b);N.qL();F.gS(b);L.qQ();ba.qr&&(a.style["touch-action"]="none");t.log("%cSET PRECISION:",
"color: #00a",ba.precision);return b};a.resize=function(a,c,b){t.kb("main.resize","container.resize");G.resize(a,c,b)};a.cS=function(a){e=a};a.qX=function(){e=function(){}};a.w1=function(a){m=a};a.uX=function(){r()};a.a_=function(){t.kb("main.global_timeline","time.get_timeline");return T.ao()};a.pause=w;a.oh=function(){f()&&(va=performance.now()/1E3,C.oh(),K.oh(),n.play(!0),z.oh())};a.po=f;a.reset=function(){H.kt(0);fa=aa=null;va=ia=ea=0;e=function(){};b=function(){};m=function(){};ga.length=0;T.reset()};
a.YW=function(a){E=a};a.LY=function(){t.kb("main.get_canvas_elem","container.get_canvas");return aa};a.cw=function(){return F.cw()};a.Sm=function(a){for(var c=0;c<ga.length;c++)if(ga[c]==a)return;ga.push(a)};a.wR=function(a){for(var c=0;c<ga.length;c++)if(ga[c]==a){ga.splice(c,1);break}}};b4w.module.physics=function(a,l){l("__config");var m=l("__ipc"),b=l("__physics"),e=l("__print"),x=l("__util");a.TI=0;a.PU=1;a.OU=2;a.Wz=3;a.KC=function(a){b.ea(a)?b.KC(a):e.error("No physics for object "+a.name)};a.gw=function(a){b.ea(a)?b.gw(a):e.error("No physics for object "+a.name)};a.i_=function(a){return b.ea(a)};a.Uw=function(a){return b.Uw(a)};a.vE=function(a){return b.vE(a)};a.SG=function(a,l){b.ea(a)?b.SG(a,l):e.error("No physics for object "+a.name)};a.Y0=function(a,l,m){b.ea(a)?b.M("set_damping",
a.r.J,l,m):e.error("No physics for object "+a.name)};a.I0=function(a){if(b.ea(a)){var l=a.If;b.M("set_damping",a.r.J,l.Wv,l.py)}else e.error("No physics for object "+a.name)};a.Is=function(a,l,m){b.ea(a)?b.Is(a,l,m):e.error("No physics for object "+a.name)};a.u=function(a){b.ea(a)?b.u(a):e.error("No physics for object "+a.name)};a.kB=function(a,l,m,w){b.ea(a)?b.kB(a,l,m,w):e.error("No physics for object "+a.name)};a.lB=function(a,l,m,w){b.ea(a)?b.lB(a,l,m,w):e.error("No physics for object "+a.name)};
a.Vu=function(a,l,m,w){b.ea(a)?b.Vu(a,l,m,w,!1):e.error("No physics for object "+a.name)};a.EW=function(a,l,m,w){b.ea(a)?b.Vu(a,l,m,w,!0):e.error("No physics for object "+a.name)};a.jB=function(a,l,m,w){b.ea(a)?b.jB(a,l,m,w):e.error("No physics for object "+a.name)};a.ym=function(a,l){b.ea(a)?(b.Fd(a)||b.Gd(a)||e.error("Wrong object"),b.ym(a,x.S(l,-1,1))):e.error("No physics for object "+a.name)};a.N2=function(a,l,m){if(b.ea(a)){b.Fd(a)||b.Gd(a)||e.error("Wrong object");l=x.S(l,0,1);var w=a.n.Xk;
-1==m||1==m?w=Math.max(-1,Math.min(w+m*l,1)):0==m&&0<=w?(w-=l,w=Math.max(0,w)):0==m&&0>w?(w+=l,w=Math.min(0,w)):e.error("Wrong steering direction");b.ym(a,x.S(w,-1,1))}else e.error("No physics for object "+a.name)};a.xm=function(a,l){b.ea(a)?(b.Fd(a)||b.Gd(a)||e.error("Wrong object"),b.xm(a,x.S(l,-1,1))):e.error("No physics for object "+a.name)};a.M2=function(a,l,m){if(b.ea(a)){b.Fd(a)||b.Gd(a)||e.error("Wrong object");l=x.S(l,0,1);var w=a.n.im;-1==m||1==m?w=Math.max(-1,Math.min(w+m*l,1)):0==m&&0<=
w?(w-=l,w=Math.max(0,w)):0==m&&0>w?(w+=l,w=Math.min(0,w)):e.error("Wrong steering direction");b.xm(a,x.S(w,-1,1))}else e.error("No physics for object "+a.name)};a.Bz=function(a,l){b.ea(a)?(b.Fd(a)||b.Gd(a)||e.error("Wrong object"),b.Bz(a,x.S(l,0,1))):e.error("No physics for object "+a.name)};a.L2=function(a,l){if(b.ea(a)){b.Fd(a)||b.Gd(a)||e.error("Wrong object");l=x.S(l,-1,1);var m=a.n.Ym;b.Bz(a,x.S(m+m*l,0,1))}else e.error("No physics for object "+a.name)};a.Fd=function(a){return b.Fd(a)};a.Gd=
function(a){return b.Gd(a)};a.QZ=function(a){if(!b.ea(a))return e.error("No physics for object "+a.name),null;if(b.Fd(a)||b.Gd(a))return a.Vd.name;e.error("Wrong object");return null};a.SZ=function(a){if(!b.ea(a))return e.error("No physics for object "+a.name),null;if(b.Fd(a)||b.Gd(a))return a.n.Xk;e.error("Wrong object");return null};a.RZ=function(a){if(!b.ea(a))return e.error("No physics for object "+a.name),null;if(b.Fd(a)||b.Gd(a))return a.n.im;e.error("Wrong object")};a.PZ=function(a){if(!b.ea(a))return e.error("No physics for object "+
a.name),null;if(b.Fd(a)||b.Gd(a))return a.n.Ym;e.error("Wrong object")};a.bE=function(a){if(!b.ea(a))return e.error("No physics for object "+a.name),null;if(b.Fd(a)||b.Gd(a))return b.bE(a);e.error("Wrong object")};a.Ze=function(a){return b.Ze(a)};a.wy=function(a,l,m){b.ea(a)?b.wy(a,l,m):e.error("No physics for object "+a.name)};a.Bs=function(a,l){b.ea(a)?b.Bs(a,l):e.error("No physics for object "+a.name)};a.NG=function(a,l){b.ea(a)?b.NG(a,l):e.error("No physics for object "+a.name)};a.MG=function(a,
l){b.ea(a)?b.MG(a,l):e.error("No physics for object "+a.name)};a.JG=function(a,l){b.ea(a)?b.JG(a,l):e.error("No physics for object "+a.name)};a.IB=function(a){b.ea(a)?b.IB(a):e.error("No physics for object "+a.name)};a.JB=function(a,l,m){b.ea(a)?b.JB(a,l,m):e.error("No physics for object "+a.name)};a.Cs=function(a,l,m){b.ea(a)?b.Cs(a,l,m):e.error("No physics for object "+a.name)};a.LG=function(a,l){b.ea(a)?b.LG(a,l):e.error("No physics for object "+a.name)};a.KG=function(a,l){b.ea(a)?b.KG(a,l):e.error("No physics for object "+
a.name)};a.Su=function(a,l,m,w){b.ea(a)?b.Su(a,l,m,w||!1):e.error("No physics for object "+a.name)};a.fy=function(a,l,m){b.ea(a)?b.fy(a,l||"ANY",m):e.error("No physics for object "+a.name)};a.Uu=function(a,l){b.ea(a)?b.Uu(a,l):e.error("No physics for object "+a.name)};a.xv=function(a){b.ea(a)?b.xv(a):e.error("No physics for object "+a.name)};a.bq=function(a,l,m,w,f,q){a=a||null;if(null==a||b.ea(a))return b.bq(a,l,m,w,f,q||!1,!1,!1,!1);e.error("No physics for object "+a.name)};a.vW=function(a,l,m,
w,f,q,g,z,A){a=a||null;if(null==a||b.ea(a))return b.bq(a,l,m,w,f,q||!1,g||!1,z||!1,A||!1);e.error("No physics for object "+a.name)};a.gy=function(a){b.NE(a)?b.gy(a):e.error("Wrong ray test ID")};a.GB=function(a,l,m){b.NE(a)?b.GB(a,l,m):e.error("Wrong ray test ID")};a.gB=function(a,l,m,w,f,q,g,z,A,x){b.ea(l)&&b.ea(f)?b.gB(a,l,m,w,f,q,g,z,A,x):e.error("Wrong objects")};a.VB=function(a){b.ea(a)&&b.wP(a)?b.VB(a):e.error("Wrong object")};a.hG=function(a,l,m,w,f,q){b.ea(a)&&b.ea(w)?b.hG(a,l,m,w,f,q):e.error("Wrong objects")};
a.rP=m.rP};b4w.module.scenes=function(a,l){var m=l("__batch"),b=l("__camera"),e=l("__data"),x=l("__graph"),k=l("__objects"),B=l("__obj_util"),r=l("__physics"),w=l("__print"),f=l("__scenes"),q=l("__util");a.oc=k.oc;a.zs=function(a){var b=f.Xn();f.zs(q.Mc("name",a,b))};a.o=function(){return f.za()?f.o().name:""};a.GZ=function(){for(var a=f.Xn(),b=[],e=0;e<a.length;e++)b.push(a[e].name);return b};a.Aw=function(){if(f.za())return f.fl(f.o());w.error("No active scene");return!1};a.rZ=function(a,b){var e=k.gc(k.Mt,
a,b|0);if(e)return e;w.error("get object "+a+": not found")};a.pZ=function(a,b,e){if(a=k.gc(k.Lt,a,b,e|0))return a;w.error("get object "+b+": not found")};a.qZ=function(a,b){var e=k.gc(k.Ic,a,b|0);if(e)return e;w.error("get object "+a+": not found")};a.hr=function(a,b){var e=k.hr(a,b|0);if(e)return e;w.error("get object "+a+": not found")};a.Kw=function(a){return B.Kw(a)};a.ks=k.ks;a.o0=function(a){return a&&a.g&&a.g.ic};a.WG=function(a,b){a&&a.g&&a.g.ic?k.WG(a,b):w.error("set_outline_intensity(): wrong object")};
a.zZ=function(a){if(a&&a.g&&a.g.ic)return a.g.lh;w.error("get_outline_intensity(): wrong object")};a.Fk=function(a,b,e,f){a&&a.g&&a.g.ic?k.Fk(a,b,e,f):w.error("apply_outline_anim(): wrong object")};a.HW=function(a){if(a&&a.g&&a.g.ic){var b=a.g.Ll;k.Fk(a,b.Ml,b.Nl,b.Ol)}else w.error("apply_outline_anim_def(): wrong object")};a.rq=function(a){a&&a.g&&a.g.ic?k.rq(a):w.error("clear_outline_anim(): wrong object")};a.VG=f.VG;a.yZ=function(a){var b=f.o();if(b=f.qa(b,"OUTLINE"))return a=a||new Float32Array(3),
a.set(b.kh),a};a.Es=function(a){f.za()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),f.Es(a)):w.error("No active scene")};a.HZ=function(){if(!f.za())return w.error("No active scene"),
!1;var a=f.o(),b=f.qa(a,"SHADOW_CAST");if(!b)return null;var e=a.j.Rc,k=f.qa(a,"MAIN_OPAQUE"),l=f.qa(a,"SHADOW_RECEIVE"),m={};m.csm_resolution=e.csm_resolution;m.self_shadow_polygon_offset=b.self_shadow_polygon_offset;l&&(m.self_shadow_normal_offset=l.self_shadow_normal_offset);m.enable_csm=e.enable_csm;m.csm_num=e.csm_num;m.csm_first_cascade_border=e.csm_first_cascade_border;m.first_cascade_blur_radius=e.first_cascade_blur_radius;m.csm_last_cascade_border=e.csm_last_cascade_border;m.last_cascade_blur_radius=
e.last_cascade_blur_radius;m.fade_last_cascade=e.fade_last_cascade;m.blend_between_cascades=e.blend_between_cascades;e.enable_csm?(m.csm_borders=f.WO(a,k.k),m.blur_radii=new Float32Array(e.csm_num),m.blur_radii.set(k.k.gs.subarray(0,e.csm_num))):(m.csm_borders=null,m.blur_radii=null);return m};a.B1=function(a){if(f.za()){var e=f.o();"number"==typeof a.self_shadow_polygon_offset&&x.ma(e.j.Pa,function(b,e){"SHADOW_CAST"===e.type&&(e.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var k=f.qa(e,
"SHADOW_RECEIVE");k&&("number"==typeof a.self_shadow_normal_offset&&(k.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(k.pcf_blur_radius=a.pcf_blur_radius));var l=f.qa(e,"MAIN_BLEND");l&&("number"==typeof a.self_shadow_normal_offset&&(l.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(l.pcf_blur_radius=a.pcf_blur_radius),l.ra=!0);l=e.j.Rc;"number"==typeof a.csm_first_cascade_border&&(l.csm_first_cascade_border=
a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(l.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(l.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(l.last_cascade_blur_radius=a.last_cascade_blur_radius);if(k){for(var q=k.D,r=0;r<q.length;r++){var G=q[r];G.mg.Qd&&(G=G.G,m.mB(G,l),m.Uc(G))}k.ra=!0}k=B.aa(e.Hh,e).U;for(r=0;r<k.length;r++)b.vz(k[r],l);f.ry(e)}else w.error("No active scene")};
a.yD=function(){if(!f.za())return w.error("No active scene"),!1;var a=f.o();return f.yD(a)};a.yy=function(a,b,e){if(f.za()){var k=f.o(),l=f.qa(k,"MAIN_OPAQUE");f.yy(k,a||0==a?parseFloat(a):l.Tg,b||0==b?b:l.ne,e||0==e?e:l.Je)}else w.error("No active scene")};a.CD=function(a){if(!f.za())return w.error("No active scene"),!1;var b=f.o();return f.CD(b,a)};a.Cy=function(a){if(f.za()){var b=f.o();f.Cy(b,a)}else w.error("No active scene")};a.YD=function(){if(!f.za())return w.error("No active scene"),!1;var a=
f.o();return f.YD(a)};a.aH=function(a){if(f.za()){var b=f.o();f.aH(b,a)}else w.error("No active scene")};a.MY=function(){if(!f.za())return w.error("No active scene"),null;var a=f.o(),a=f.qa(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.U0=function(a){if(f.za()){var b=f.o();if(b=f.qa(b,"COMPOSITING"))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=
a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.ra=!0}else w.error("No active scene")};a.WD=function(){if(!f.za())return w.error("No active scene"),!1;var a=f.o();return f.WD(a)};a.ZG=function(a){if(f.za()){var b=f.o();f.ZG(b,a)}else w.error("No active scene")};a.wD=function(){if(!f.za())return w.error("No active scene"),!1;var a=f.o();return f.qa(a,"DOF")?f.wD(a):null};a.PG=function(a){if(f.za()){var b=f.o();f.PG(b,a)}else w.error("No active scene")};
a.FD=function(){if(!f.za())return w.error("No active scene"),!1;var a=f.o();return f.qa(a,"GOD_RAYS")?f.FD(a):null};a.RG=function(a){if(f.za()){var b=f.o();f.RG(b,a)}else w.error("No active scene")};a.pD=function(){if(!f.za())return w.error("No active scene"),!1;var a=f.o();return f.qa(a,"BLOOM")?f.pD(a):null};a.HG=function(a){if(f.za()){var b=f.o();f.HG(b,a)}else w.error("No active scene")};a.ED=function(){if(!f.za())return w.error("No active scene"),!1;var a=f.o();return f.qa(a,"GLOW_COMBINE")?
f.ED(a):null};a.QG=function(a){if(f.za()){var b=f.o();f.QG(b,a)}else w.error("No active scene")};a.iE=function(){if(!f.za())return w.error("No active scene"),!1;var a=f.o();return f.iE(a)};a.gH=function(a){if(f.za()){var b=f.o();k.gH(b,a)}else w.error("No active scene")};a.fE=function(a,b){if(!f.za())return w.error("No active scene"),0;var e=f.o();return e.j.nc?f.fE(e,a,b):(w.error("No water parameters on the active scene"),0)};a.fH=function(a){if(f.za()){var b=f.o();f.fH(b,a)}else w.error("No active scene")};
a.eE=function(a){if(f.za()){var b=f.o();f.eE(b,a)}else w.error("No active scene")};a.I2=function(){if(f.za()){var a=f.o();f.mI(a)}else w.error("No active scene")};a.AP=function(a){var b;b=b||!1;!B.hc(a)&&!B.Ej(a)||B.Ea(a)?b?f.dn(a,!0):f.HB(a,!0):w.error("show/hide is only supported for dynamic objects.")};a.MS=function(a){var b;b=b||!1;!B.hc(a)&&!B.Ej(a)||B.Ea(a)?b?f.dn(a,!1):f.HB(a,!1):w.error("show/hide is only supported for dynamic objects.")};a.dx=function(a){if(B.ko(a)||B.Ej(a)||B.nl(a))return f.dx(a);
w.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.Er=function(a){return a.g.Er};a.iX=function(a){w.kb("scenes.check_object","scenes.check_object_by_name");return f.za()?k.UQ(a,f.o()):(w.error("No active scene"),!1)};a.lX=function(a,b){return k.gc(k.Mt,a,b|0)?!0:!1};a.jX=function(a,b,e){return k.gc(k.Lt,a,b,e|0)?!0:!1};a.kX=function(a,b){return k.gc(k.Ic,a,b|0)?!0:!1};a.Vh=function(a,b){var e=f.o();a||(a="ALL");b||0===b||(b=k.oc);return k.Gb(e,a,b)};a.uZ=function(a){return a?
a.Tj:(w.error("Wrong object name"),"")};a.vZ=function(a){if(!a)return w.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Tj),a=B.xf(a);return b.reverse()};a.wZ=function(a){return a&&a.type?a.type:(w.error("Wrong object"),"UNDEFINED")};a.tZ=function(a){w.kb("scenes.get_object_dg_parent","objects.get_dg_parent");return B.xf(a)};a.sZ=function(a){return a.zd.slice(0)};a.AD=function(){for(var a=k.Gb(f.o(),"MESH",k.oc),b=0;b<a.length;b++){var e=a[b];if(r.Ze(e))return e}return null};a.VD=function(a,
b){b||0===b||(b=1);if(!f.za())return w.error("No active scene"),!1;var e=f.o();return f.VD(e,a,b)};a.rD=function(){return f.rD()};a.NZ=function(a){return B.hc(a)?a.g.type:null};a.yj=function(){if(!f.za())return w.error("No active scene"),!1;var a=f.o();return f.yj(a)};a.Dk=function(a,b){if(a.g.HE){if(b)var e=f.Xn(),e=q.Mc("name",b,e);else e=f.o();f.Dk(e,a,!0)}else w.error('object "'+a.name+'" has been created not by coping.')};a.No=function(a){(B.hc(a)||B.Ej(a))&&B.Ea(a)?(k.Wr(a,!1,a.g.IE,!1,!1),
e.mR(a),k.Wr(a,!0,!0,!0,!0),k.No(a)):w.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.kF=function(a){var b=f.o();if(b.timeline_markers&&a in b.timeline_markers)return f.kF(b,a);w.error('"'+a+'" marker not found.');return 0};a.oZ=function(){var a=f.o();return(a=f.qa(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.m1=function(a){var b=f.o();(b=f.qa(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=
a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):w.error("The motion blur subscene doesn't exist.")};a.XW=function(){var a=f.o();return Boolean(f.qa(a,"COLOR_PICKING"))}};b4w.module.transform=function(a,l){var m=l("__obj_util"),b=l("__physics"),e=l("__print"),x=l("__quat"),k=l("__transform"),B=l("__tsr"),r=l("__util"),w=new Float32Array(4),f=new Float32Array(3),q=new Float32Array(4);a.wk=k.wk;a.HA=k.HA;a.lc=function(a,l,q,r){m.Ea(a)?(f[0]=l,f[1]=q,f[2]=r,k.lc(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Js=function(a,l,q,r){m.Ea(a)?(f[0]=l,f[1]=q,f[2]=r,k.Js(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.vS=function(a,f){m.Ea(a)?(k.lc(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.E1=function(a,f){m.Ea(a)?(k.Js(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.D1=function(a,l,q,w,x){m.Ea(a)?(f[0]=l,f[1]=q,f[2]=w,r.Fc(f,1,B.B(x.g.i),B.q(x.g.i),f),k.lc(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.yf=function(a,b){b||(b=new Float32Array(3));k.yf(a,b);return b};a.aE=function(a,b){b||(b=new Float32Array(3));k.aE(a,
b);return b};a.sg=function(a,f,l,r,w){m.Ea(a)?(q[0]=f,q[1]=l,q[2]=r,q[3]=w,k.sg(a,q),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Hs=function(a,f,l,r,w){m.Ea(a)?(q[0]=f,q[1]=l,q[2]=r,q[3]=w,k.Hs(a,q),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.A1=function(a,f){m.Ea(a)?(k.sg(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.z1=function(a,f){m.Ea(a)?(k.Hs(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.jl=function(a,b){b||(b=new Float32Array(4));k.jl(a,b);return b};a.RD=function(a,b){b||(b=new Float32Array(4));k.RD(a,b);return b};a.Jy=function(a,l,q,r){m.Ea(a)?(f[0]=l,f[1]=q,f[2]=r,k.Jy(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Ky=function(a,l,q,r){m.Ea(a)?(f[0]=l,f[1]=q,f[2]=r,k.Ky(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.y1=function(a,f){m.Ea(a)?(k.Jy(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.x1=function(a,f){m.Ea(a)?(k.Ky(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.ve=function(a,b){m.Ea(a)?(k.ve(a,b),k.p(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Ly=function(a,b){m.Ea(a)?(k.Ly(a,b),k.p(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Pc=function(a){return k.Pc(a)};a.TD=function(a){return k.TD(a)};a.VX=function(a){if("EMPTY"!=a.type)e.error("Wrong object: "+a.name);else{for(var f=0;f<a.zd.length;f++)if(!m.Ea(a.zd[f])){e.error('Wrong object: "'+
a.zd[f].name+'" is not dynamic.');return}k.lc(a,[0,0,0]);k.sg(a,[0,0,0,1]);k.ve(a,1);k.p(a);b.u(a)}};a.cr=function(a){return m.hc(a)?k.cr(a):(e.error("Wrong object: "+a.name),0)};a.br=function(a,b,f){return m.hc(a)?k.br(a,b,f):(e.error("Wrong object: "+a.name),null)};a.Ff=function(a,f,l,q){m.Ea(a)?(k.Ff(a,f,l,q),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.L0=function(a,f){if(m.Ea(a)){var l=x.setAxisAngle(r.Ke,f,q);k.oy(a,l);k.p(a);b.u(a)}else e.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.M0=function(a,f){if(m.Ea(a)){var l=x.setAxisAngle(r.wc,f,q);k.oy(a,l);k.p(a);b.u(a)}else e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.N0=function(a,f){if(m.Ea(a)){var l=x.setAxisAngle(r.lf,f,q);k.oy(a,l);k.p(a);b.u(a)}else e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.MD=function(a){return k.MD(a)};a.sh=function(a,f){m.Ea(a)?(k.sh(a,f),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Ks=function(a,f){m.Ea(a)?(k.Ks(a,f),k.p(a),
b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.bo=function(a,b){b||(b=new Float32Array(8));k.bo(a,b);return b};a.co=function(a,b){b||(b=new Float32Array(8));k.co(a,b);return b};a.distance=function(a,b){return k.distance(a,b)};a.k1=function(a,f){m.Ea(a)?(B.Xg(f,w),k.sh(a,w),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.l1=function(a,f){m.Ea(a)?(B.Xg(f,w),k.Ks(a,w),k.p(a),b.u(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.mZ=function(a,b){b||
(b=new Float32Array(16));k.bo(a,w);B.RH(w,b);return b};a.nZ=function(a,b){b||(b=new Float32Array(16));k.co(a,w);B.RH(w,b);return b}};b4w.module.util=function(a,l){var m=l("__compat"),b=l("__obj_util"),e=l("__print"),x=l("__quat"),k=l("__util"),B=l("__vec3"),r=new Float32Array(6);a.Ke=new Float32Array([1,0,0]);a.wc=new Float32Array([0,1,0]);a.lf=new Float32Array([0,0,1]);a.zt=new Float32Array([-1,0,0]);a.md=new Float32Array([0,-1,0]);a.Oi=new Float32Array([0,0,-1]);a.JA=k.JA;a.QA=k.QA;a.RA=k.RA;a.LA=k.LA;a.NA=k.NA;a.TA=k.TA;a.KA=k.KA;a.PA=k.PA;a.Ju=k.Ju;a.MA=k.MA;a.OA=k.OA;a.SA=k.SA;a.mY=function(a){return new Float32Array(a||0)};
a.assert=k.assert;a.YE=k.YE;a.Mc=k.Mc;a.Nr=function(a){return k.Nr(a)};a.Th=function(a,b){b||(b=new Float32Array(4));return k.Th(a,b)};a.Mx=function(a,b,e){e||(e=x.create());return k.Mx(a,b,e)};a.mG=function(a,b,e){e||(e=B.create());return k.mG(a,b,e)};a.lG=function(a,b){b||(b=new Float32Array(3));return k.lG(a,b)};a.sign=k.sign;a.S=k.S;a.Cb=k.Cb;a.b_=function(a,b){return k.Zx(a,k.md,k.wc,k.Oi,b)};a.ov=function(a,b){return k.ov(a,b)};a.Zx=function(a,b,l,g,m){return 0!=B.dot(l,g)?(e.error("Wrong in-plane direction"),
null):k.Zx(a,b,l,g,m)};a.xE=k.xE;a.mc=k.mc;a.bm=k.bm;a.di=k.di;a.cC=k.cC;a.kG=k.kG;a.oG=k.oG;a.RI=k.RI;a.ox=function(a,b,l,g,m){e.kb("util.line_plane_intersect","math.line_plane_intersect");r[0]=l[0];r[1]=l[1];r[2]=l[2];r[3]=g[0];r[4]=g[1];r[5]=g[2];return k.ox(a,b,r,m)};a.hc=function(a){e.kb("util.is_mesh","objects.is_mesh");return b.hc(a)};a.$g=function(a){e.kb("util.is_armature","objects.is_armature");return b.$g(a)};a.Eg=k.Eg;a.qf=k.qf;a.gk=k.gk;a.lerp=k.lerp;a.jb=k.jb;a.Ld=k.Ld;a.dw=k.dw;a.no=
m.no};"object"==typeof module&&module.nw&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,l){l("__print");var m=l("__version");a.version=m.version;a.Cz=m.Cz;a.type=m.type;a.xC=m.xC;a.Xv=m.Xv};"object"==typeof module&&module.nw&&b4w.module.version(exports);b4w.module.objects=function(a,l){var m=l("__geometry"),b=l("__objects"),e=l("__batch"),x=l("__obj_util"),k=l("__print"),B=l("__scenes");a.yj=function(a){if(a)return b.yj(a)};a.copy=function(a,e,f){return x.hc(a)?x.Ea(a)?m.uE(a)||m.uv(a)||!f?-1==b.Gb(B.o(),"MESH",b.oc).indexOf(a)?(k.error('object "'+a.name+'" does not belong to the active scene.'),!1):b.copy(a,e||"",f):(k.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),!1):(k.error('object "'+a.name+'" is not dynamic.'),!1):
(k.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.Gy=function(a,b,f){x.ko(a)?e.Gy(a,b,f):k.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.LD=function(a,b){return x.ko(a)?e.LD(a,b):(k.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null)};a.Fy=function(a,b,f,l,g){x.ko(a)?e.Fy(a,b,f,l,g):k.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.KD=function(a,b,f){if(!x.ko(a))return k.error('The type of the object "'+
a.name+'" is not "MESH" or it is not dynamic.'),null;f||(f=new Float32Array(3));return e.KD(a,b,f)};a.uz=function(a){x.hc(a)?m.uE(a)||m.uv(a)?b.uz(a):k.error('object "'+a.name+'" has not dynamic geometry.'):k.error('The type of the object "'+a.name+'" is not "MESH".')};a.dr=x.dr;a.xf=x.xf;a.hc=x.hc;a.$g=x.$g;a.Hj=x.Hj;a.ka=x.ka;a.nl=x.nl;a.Ej=x.Ej;a.ME=x.ME;a.qo=x.qo;a.er=function(){return b.er()};a.ND=function(){return b.ND()}};b4w.module.preloader=function(a,l){var m=l("app"),b,e,x,k,B,r,w,f,q,g=null;a.mN=function(){var a={bg_color:"#ffffff",bar_color:"#556",background_container_id:"background_image_container",canvas_container_id:"main_canvas_container",preloader_fadeout:!0},f=null,l=null,m="#bf9221",q="#000",w;for(w in a)switch(w){case "canvas_container_id":f=a.canvas_container_id;break;case "background_container_id":l=a.background_container_id;break;case "bg_color":q=a.bg_color;break;case "bar_color":m=a.bar_color;break;
case "preloader_fadeout":b=a.preloader_fadeout}a=document.createElement("div");w=document.createElement("div");a.id="simple_preloader_container";var D=document.createElement("div"),H=document.createElement("div"),l=document.getElementById(l);g=document.getElementById(f);a.style.cssText="z-index: 4;background-color: "+q+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";w.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";
D.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+m+";border-radius: 0px;";H.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+w.appendChild(D);w.appendChild(H);a.appendChild(w);document.body.appendChild(a);e="SIMPLE";x=a;k=D;B=H;r=l};a.EX=function(a){var b=null,f=null,k="rgba(0,0,0,0)",l="",m="",
q="rgba(0,0,0,0)",H;for(H in a)switch(H){case "canvas_container_id":b=a.canvas_container_id;break;case "background_container_id":f=a.background_container_id;break;case "frame_bg_color":k=a.frame_bg_color;break;case "bg_color":q=a.bg_color;break;case "frame_class":l=a.frame_class;break;case "anim_elem_class":m=a.anim_elem_class}a=document.createElement("div");H=document.createElement("div");var I=document.createElement("div"),d=document.createElement("div"),f=document.getElementById(f);g=document.getElementById(b);
a.style.cssText="z-index: 4;background-color: "+q+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";H.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+k+";";I.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";d.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";
I.className=m;H.appendChild(I);H.className=l;H.appendChild(d);a.appendChild(H);g.appendChild(a);e="ROTATION";x=a;w=I;B=d;r=f};a.BX=function(a){var b=a.preloader_width,b=b/(b-a.img_width),l=document.getElementById(a.preloader_bar_id),m=document.getElementById(a.fill_band_id),w=document.getElementById(a.preloader_caption_id),G=document.getElementById(a.preloader_container_id),D=document.getElementById(a.background_container_id);g=document.getElementById(a.canvas_container_id);e="ADVANCED";k=l;f=m;q=
b;B=w;x=G;r=D};a.XT=function(a){B.innerHTML=a+"%";"SIMPLE"==e&&(k.style.width=a+"%");"ADVANCED"==e&&(k.style.width=a/q+"%",f.style.width=100-a+"%");"ROTATION"==e&&(w.style.transform="rotate("+a+"deg)");100==a&&(b?(m.Rv(r,"opacity",1,0,1500,null,null,function(){r.parentNode.removeChild(r)}),m.Rv(x,"opacity",1,0,1E3,null,null,function(){x.parentNode.removeChild(x)})):(x.parentNode.removeChild(x),r&&r.parentNode.removeChild(r)))}};b4w.register("guitar_presentation",function(a,l){function m(a,f){f?(g.mN(),B.load(A+"guitar_presentation.json",e,b,!0)):console.log("b4w init failure")}function b(a){g.XT(a)}function e(a,b){if(b){console.log("App started: "+(new Date).toString());console.log(typeof q);var e=document.getElementsByTagName("script");console.log("Used javascript file: "+e[e.length-1].src.toString());x.YN();e=w.Vh();console.log("Number of objects in the scene: "+e.length.toString());for(var g,k=0;k<e.length;k++){g=e[k];
var l=f.yj(g);l&&console.log("Object in scene #"+k+": % Name >>> "+g.name+"% Type: >>> "+l.category);"ButtonToWeb"==g.name&&(w.AP(g),w.MS(g))}document.getElementById("enter_link").onclick=function(){var a=document.getElementById("welcome_container");a.parentElement.removeChild(a)}}else console.log("b4w load failure")}var x=l("app"),k=l("config"),B=l("data"),r=l("version"),w=l("scenes"),f=l("objects"),q=l("__logic_nodes"),g=l("preloader");l("transform");var z="DEBUG"===r.type(),A=k.Ow()+"guitar_presentation/";
a.zf=function(){x.zf({canvas_container_id:"main_canvas_container",callback:m,show_fps:z,console_verbose:z,autoresize:!0})}});b4w.require("guitar_presentation").zf();var Gd=["b4w","$","jQuery"],Hd=[],Od;for(Od in window)-1!=Gd.indexOf(Od)||Od in Bd||Hd.push(Od);Hd.length&&console.error("globals detected:",Hd);
